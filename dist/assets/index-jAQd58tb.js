function r5(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Doe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function es(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ux={exports:{}},xu={},fx={exports:{}},gt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OS;function n5(){if(OS)return gt;OS=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function x(J){return J===null||typeof J!="object"?null:(J=m&&J[m]||J["@@iterator"],typeof J=="function"?J:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,g={};function b(J,O,ae){this.props=J,this.context=O,this.refs=g,this.updater=ae||v}b.prototype.isReactComponent={},b.prototype.setState=function(J,O){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,O,"setState")},b.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function N(){}N.prototype=b.prototype;function _(J,O,ae){this.props=J,this.context=O,this.refs=g,this.updater=ae||v}var S=_.prototype=new N;S.constructor=_,y(S,b.prototype),S.isPureReactComponent=!0;var C=Array.isArray,T=Object.prototype.hasOwnProperty,k={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function D(J,O,ae){var ee,L={},V=null,se=null;if(O!=null)for(ee in O.ref!==void 0&&(se=O.ref),O.key!==void 0&&(V=""+O.key),O)T.call(O,ee)&&!P.hasOwnProperty(ee)&&(L[ee]=O[ee]);var U=arguments.length-2;if(U===1)L.children=ae;else if(1<U){for(var W=Array(U),X=0;X<U;X++)W[X]=arguments[X+2];L.children=W}if(J&&J.defaultProps)for(ee in U=J.defaultProps,U)L[ee]===void 0&&(L[ee]=U[ee]);return{$$typeof:e,type:J,key:V,ref:se,props:L,_owner:k.current}}function R(J,O){return{$$typeof:e,type:J.type,key:O,ref:J.ref,props:J.props,_owner:J._owner}}function G(J){return typeof J=="object"&&J!==null&&J.$$typeof===e}function M(J){var O={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(ae){return O[ae]})}var H=/\/+/g;function z(J,O){return typeof J=="object"&&J!==null&&J.key!=null?M(""+J.key):O.toString(36)}function ne(J,O,ae,ee,L){var V=typeof J;(V==="undefined"||V==="boolean")&&(J=null);var se=!1;if(J===null)se=!0;else switch(V){case"string":case"number":se=!0;break;case"object":switch(J.$$typeof){case e:case t:se=!0}}if(se)return se=J,L=L(se),J=ee===""?"."+z(se,0):ee,C(L)?(ae="",J!=null&&(ae=J.replace(H,"$&/")+"/"),ne(L,O,ae,"",function(X){return X})):L!=null&&(G(L)&&(L=R(L,ae+(!L.key||se&&se.key===L.key?"":(""+L.key).replace(H,"$&/")+"/")+J)),O.push(L)),1;if(se=0,ee=ee===""?".":ee+":",C(J))for(var U=0;U<J.length;U++){V=J[U];var W=ee+z(V,U);se+=ne(V,O,ae,W,L)}else if(W=x(J),typeof W=="function")for(J=W.call(J),U=0;!(V=J.next()).done;)V=V.value,W=ee+z(V,U++),se+=ne(V,O,ae,W,L);else if(V==="object")throw O=String(J),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.");return se}function Q(J,O,ae){if(J==null)return J;var ee=[],L=0;return ne(J,ee,"","",function(V){return O.call(ae,V,L++)}),ee}function le(J){if(J._status===-1){var O=J._result;O=O(),O.then(function(ae){(J._status===0||J._status===-1)&&(J._status=1,J._result=ae)},function(ae){(J._status===0||J._status===-1)&&(J._status=2,J._result=ae)}),J._status===-1&&(J._status=0,J._result=O)}if(J._status===1)return J._result.default;throw J._result}var ue={current:null},fe={transition:null},K={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:fe,ReactCurrentOwner:k};function me(){throw Error("act(...) is not supported in production builds of React.")}return gt.Children={map:Q,forEach:function(J,O,ae){Q(J,function(){O.apply(this,arguments)},ae)},count:function(J){var O=0;return Q(J,function(){O++}),O},toArray:function(J){return Q(J,function(O){return O})||[]},only:function(J){if(!G(J))throw Error("React.Children.only expected to receive a single React element child.");return J}},gt.Component=b,gt.Fragment=r,gt.Profiler=a,gt.PureComponent=_,gt.StrictMode=n,gt.Suspense=f,gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K,gt.act=me,gt.cloneElement=function(J,O,ae){if(J==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+J+".");var ee=y({},J.props),L=J.key,V=J.ref,se=J._owner;if(O!=null){if(O.ref!==void 0&&(V=O.ref,se=k.current),O.key!==void 0&&(L=""+O.key),J.type&&J.type.defaultProps)var U=J.type.defaultProps;for(W in O)T.call(O,W)&&!P.hasOwnProperty(W)&&(ee[W]=O[W]===void 0&&U!==void 0?U[W]:O[W])}var W=arguments.length-2;if(W===1)ee.children=ae;else if(1<W){U=Array(W);for(var X=0;X<W;X++)U[X]=arguments[X+2];ee.children=U}return{$$typeof:e,type:J.type,key:L,ref:V,props:ee,_owner:se}},gt.createContext=function(J){return J={$$typeof:s,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},J.Provider={$$typeof:i,_context:J},J.Consumer=J},gt.createElement=D,gt.createFactory=function(J){var O=D.bind(null,J);return O.type=J,O},gt.createRef=function(){return{current:null}},gt.forwardRef=function(J){return{$$typeof:l,render:J}},gt.isValidElement=G,gt.lazy=function(J){return{$$typeof:h,_payload:{_status:-1,_result:J},_init:le}},gt.memo=function(J,O){return{$$typeof:d,type:J,compare:O===void 0?null:O}},gt.startTransition=function(J){var O=fe.transition;fe.transition={};try{J()}finally{fe.transition=O}},gt.unstable_act=me,gt.useCallback=function(J,O){return ue.current.useCallback(J,O)},gt.useContext=function(J){return ue.current.useContext(J)},gt.useDebugValue=function(){},gt.useDeferredValue=function(J){return ue.current.useDeferredValue(J)},gt.useEffect=function(J,O){return ue.current.useEffect(J,O)},gt.useId=function(){return ue.current.useId()},gt.useImperativeHandle=function(J,O,ae){return ue.current.useImperativeHandle(J,O,ae)},gt.useInsertionEffect=function(J,O){return ue.current.useInsertionEffect(J,O)},gt.useLayoutEffect=function(J,O){return ue.current.useLayoutEffect(J,O)},gt.useMemo=function(J,O){return ue.current.useMemo(J,O)},gt.useReducer=function(J,O,ae){return ue.current.useReducer(J,O,ae)},gt.useRef=function(J){return ue.current.useRef(J)},gt.useState=function(J){return ue.current.useState(J)},gt.useSyncExternalStore=function(J,O,ae){return ue.current.useSyncExternalStore(J,O,ae)},gt.useTransition=function(){return ue.current.useTransition()},gt.version="18.3.1",gt}var FS;function pc(){return FS||(FS=1,fx.exports=n5()),fx.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DS;function a5(){if(DS)return xu;DS=1;var e=pc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(l,f,d){var h,m={},x=null,v=null;d!==void 0&&(x=""+d),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(v=f.ref);for(h in f)n.call(f,h)&&!i.hasOwnProperty(h)&&(m[h]=f[h]);if(l&&l.defaultProps)for(h in f=l.defaultProps,f)m[h]===void 0&&(m[h]=f[h]);return{$$typeof:t,type:l,key:x,ref:v,props:m,_owner:a.current}}return xu.Fragment=r,xu.jsx=s,xu.jsxs=s,xu}var IS;function i5(){return IS||(IS=1,ux.exports=a5()),ux.exports}var o=i5(),j=pc();const zl=es(j),s5=r5({__proto__:null,default:zl},[j]);var e0={},dx={exports:{}},Un={},hx={exports:{}},mx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MS;function o5(){return MS||(MS=1,(function(e){function t(fe,K){var me=fe.length;fe.push(K);e:for(;0<me;){var J=me-1>>>1,O=fe[J];if(0<a(O,K))fe[J]=K,fe[me]=O,me=J;else break e}}function r(fe){return fe.length===0?null:fe[0]}function n(fe){if(fe.length===0)return null;var K=fe[0],me=fe.pop();if(me!==K){fe[0]=me;e:for(var J=0,O=fe.length,ae=O>>>1;J<ae;){var ee=2*(J+1)-1,L=fe[ee],V=ee+1,se=fe[V];if(0>a(L,me))V<O&&0>a(se,L)?(fe[J]=se,fe[V]=me,J=V):(fe[J]=L,fe[ee]=me,J=ee);else if(V<O&&0>a(se,me))fe[J]=se,fe[V]=me,J=V;else break e}}return K}function a(fe,K){var me=fe.sortIndex-K.sortIndex;return me!==0?me:fe.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var f=[],d=[],h=1,m=null,x=3,v=!1,y=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(fe){for(var K=r(d);K!==null;){if(K.callback===null)n(d);else if(K.startTime<=fe)n(d),K.sortIndex=K.expirationTime,t(f,K);else break;K=r(d)}}function C(fe){if(g=!1,S(fe),!y)if(r(f)!==null)y=!0,le(T);else{var K=r(d);K!==null&&ue(C,K.startTime-fe)}}function T(fe,K){y=!1,g&&(g=!1,N(D),D=-1),v=!0;var me=x;try{for(S(K),m=r(f);m!==null&&(!(m.expirationTime>K)||fe&&!M());){var J=m.callback;if(typeof J=="function"){m.callback=null,x=m.priorityLevel;var O=J(m.expirationTime<=K);K=e.unstable_now(),typeof O=="function"?m.callback=O:m===r(f)&&n(f),S(K)}else n(f);m=r(f)}if(m!==null)var ae=!0;else{var ee=r(d);ee!==null&&ue(C,ee.startTime-K),ae=!1}return ae}finally{m=null,x=me,v=!1}}var k=!1,P=null,D=-1,R=5,G=-1;function M(){return!(e.unstable_now()-G<R)}function H(){if(P!==null){var fe=e.unstable_now();G=fe;var K=!0;try{K=P(!0,fe)}finally{K?z():(k=!1,P=null)}}else k=!1}var z;if(typeof _=="function")z=function(){_(H)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,Q=ne.port2;ne.port1.onmessage=H,z=function(){Q.postMessage(null)}}else z=function(){b(H,0)};function le(fe){P=fe,k||(k=!0,z())}function ue(fe,K){D=b(function(){fe(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(fe){fe.callback=null},e.unstable_continueExecution=function(){y||v||(y=!0,le(T))},e.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<fe?Math.floor(1e3/fe):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(fe){switch(x){case 1:case 2:case 3:var K=3;break;default:K=x}var me=x;x=K;try{return fe()}finally{x=me}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(fe,K){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var me=x;x=fe;try{return K()}finally{x=me}},e.unstable_scheduleCallback=function(fe,K,me){var J=e.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?J+me:J):me=J,fe){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=me+O,fe={id:h++,callback:K,priorityLevel:fe,startTime:me,expirationTime:O,sortIndex:-1},me>J?(fe.sortIndex=me,t(d,fe),r(f)===null&&fe===r(d)&&(g?(N(D),D=-1):g=!0,ue(C,me-J))):(fe.sortIndex=O,t(f,fe),y||v||(y=!0,le(T))),fe},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(fe){var K=x;return function(){var me=x;x=K;try{return fe.apply(this,arguments)}finally{x=me}}}})(mx)),mx}var RS;function l5(){return RS||(RS=1,hx.exports=o5()),hx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LS;function c5(){if(LS)return Un;LS=1;var e=pc(),t=l5();function r(c){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+c,p=1;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(c,u){s(c,u),s(c+"Capture",u)}function s(c,u){for(a[c]=u,c=0;c<u.length;c++)n.add(u[c])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function x(c){return f.call(m,c)?!0:f.call(h,c)?!1:d.test(c)?m[c]=!0:(h[c]=!0,!1)}function v(c,u,p,w){if(p!==null&&p.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return w?!1:p!==null?!p.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function y(c,u,p,w){if(u===null||typeof u>"u"||v(c,u,p,w))return!0;if(w)return!1;if(p!==null)switch(p.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function g(c,u,p,w,E,A,I){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=w,this.attributeNamespace=E,this.mustUseProperty=p,this.propertyName=c,this.type=u,this.sanitizeURL=A,this.removeEmptyString=I}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){b[c]=new g(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var u=c[0];b[u]=new g(u,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){b[c]=new g(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){b[c]=new g(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){b[c]=new g(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){b[c]=new g(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){b[c]=new g(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){b[c]=new g(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){b[c]=new g(c,5,!1,c.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function _(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var u=c.replace(N,_);b[u]=new g(u,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var u=c.replace(N,_);b[u]=new g(u,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var u=c.replace(N,_);b[u]=new g(u,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){b[c]=new g(c,1,!1,c.toLowerCase(),null,!1,!1)}),b.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){b[c]=new g(c,1,!1,c.toLowerCase(),null,!0,!0)});function S(c,u,p,w){var E=b.hasOwnProperty(u)?b[u]:null;(E!==null?E.type!==0:w||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(y(u,p,E,w)&&(p=null),w||E===null?x(u)&&(p===null?c.removeAttribute(u):c.setAttribute(u,""+p)):E.mustUseProperty?c[E.propertyName]=p===null?E.type===3?!1:"":p:(u=E.attributeName,w=E.attributeNamespace,p===null?c.removeAttribute(u):(E=E.type,p=E===3||E===4&&p===!0?"":""+p,w?c.setAttributeNS(w,u,p):c.setAttribute(u,p))))}var C=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),k=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),G=Symbol.for("react.provider"),M=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),Q=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),fe=Symbol.iterator;function K(c){return c===null||typeof c!="object"?null:(c=fe&&c[fe]||c["@@iterator"],typeof c=="function"?c:null)}var me=Object.assign,J;function O(c){if(J===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);J=u&&u[1]||""}return`
`+J+c}var ae=!1;function ee(c,u){if(!c||ae)return"";ae=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Se){var w=Se}Reflect.construct(c,[],u)}else{try{u.call()}catch(Se){w=Se}c.call(u.prototype)}else{try{throw Error()}catch(Se){w=Se}c()}}catch(Se){if(Se&&w&&typeof Se.stack=="string"){for(var E=Se.stack.split(`
`),A=w.stack.split(`
`),I=E.length-1,ie=A.length-1;1<=I&&0<=ie&&E[I]!==A[ie];)ie--;for(;1<=I&&0<=ie;I--,ie--)if(E[I]!==A[ie]){if(I!==1||ie!==1)do if(I--,ie--,0>ie||E[I]!==A[ie]){var ce=`
`+E[I].replace(" at new "," at ");return c.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",c.displayName)),ce}while(1<=I&&0<=ie);break}}}finally{ae=!1,Error.prepareStackTrace=p}return(c=c?c.displayName||c.name:"")?O(c):""}function L(c){switch(c.tag){case 5:return O(c.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return c=ee(c.type,!1),c;case 11:return c=ee(c.type.render,!1),c;case 1:return c=ee(c.type,!0),c;default:return""}}function V(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case P:return"Fragment";case k:return"Portal";case R:return"Profiler";case D:return"StrictMode";case z:return"Suspense";case ne:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case M:return(c.displayName||"Context")+".Consumer";case G:return(c._context.displayName||"Context")+".Provider";case H:var u=c.render;return c=c.displayName,c||(c=u.displayName||u.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case Q:return u=c.displayName||null,u!==null?u:V(c.type)||"Memo";case le:u=c._payload,c=c._init;try{return V(c(u))}catch{}}return null}function se(c){var u=c.type;switch(c.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=u.render,c=c.displayName||c.name||"",u.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(u);case 8:return u===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function U(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function W(c){var u=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function X(c){var u=W(c)?"checked":"value",p=Object.getOwnPropertyDescriptor(c.constructor.prototype,u),w=""+c[u];if(!c.hasOwnProperty(u)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var E=p.get,A=p.set;return Object.defineProperty(c,u,{configurable:!0,get:function(){return E.call(this)},set:function(I){w=""+I,A.call(this,I)}}),Object.defineProperty(c,u,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(I){w=""+I},stopTracking:function(){c._valueTracker=null,delete c[u]}}}}function de(c){c._valueTracker||(c._valueTracker=X(c))}function F(c){if(!c)return!1;var u=c._valueTracker;if(!u)return!0;var p=u.getValue(),w="";return c&&(w=W(c)?c.checked?"true":"false":c.value),c=w,c!==p?(u.setValue(c),!0):!1}function Pe(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Ae(c,u){var p=u.checked;return me({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??c._wrapperState.initialChecked})}function We(c,u){var p=u.defaultValue==null?"":u.defaultValue,w=u.checked!=null?u.checked:u.defaultChecked;p=U(u.value!=null?u.value:p),c._wrapperState={initialChecked:w,initialValue:p,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function Ue(c,u){u=u.checked,u!=null&&S(c,"checked",u,!1)}function Te(c,u){Ue(c,u);var p=U(u.value),w=u.type;if(p!=null)w==="number"?(p===0&&c.value===""||c.value!=p)&&(c.value=""+p):c.value!==""+p&&(c.value=""+p);else if(w==="submit"||w==="reset"){c.removeAttribute("value");return}u.hasOwnProperty("value")?jt(c,u.type,p):u.hasOwnProperty("defaultValue")&&jt(c,u.type,U(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(c.defaultChecked=!!u.defaultChecked)}function lt(c,u,p){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var w=u.type;if(!(w!=="submit"&&w!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+c._wrapperState.initialValue,p||u===c.value||(c.value=u),c.defaultValue=u}p=c.name,p!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,p!==""&&(c.name=p)}function jt(c,u,p){(u!=="number"||Pe(c.ownerDocument)!==c)&&(p==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+p&&(c.defaultValue=""+p))}var Yt=Array.isArray;function Ct(c,u,p,w){if(c=c.options,u){u={};for(var E=0;E<p.length;E++)u["$"+p[E]]=!0;for(p=0;p<c.length;p++)E=u.hasOwnProperty("$"+c[p].value),c[p].selected!==E&&(c[p].selected=E),E&&w&&(c[p].defaultSelected=!0)}else{for(p=""+U(p),u=null,E=0;E<c.length;E++){if(c[E].value===p){c[E].selected=!0,w&&(c[E].defaultSelected=!0);return}u!==null||c[E].disabled||(u=c[E])}u!==null&&(u.selected=!0)}}function Ua(c,u){if(u.dangerouslySetInnerHTML!=null)throw Error(r(91));return me({},u,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function On(c,u){var p=u.value;if(p==null){if(p=u.children,u=u.defaultValue,p!=null){if(u!=null)throw Error(r(92));if(Yt(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),p=u}c._wrapperState={initialValue:U(p)}}function Lr(c,u){var p=U(u.value),w=U(u.defaultValue);p!=null&&(p=""+p,p!==c.value&&(c.value=p),u.defaultValue==null&&c.defaultValue!==p&&(c.defaultValue=p)),w!=null&&(c.defaultValue=""+w)}function rr(c){var u=c.textContent;u===c._wrapperState.initialValue&&u!==""&&u!==null&&(c.value=u)}function Fn(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qr(c,u){return c==null||c==="http://www.w3.org/1999/xhtml"?Fn(u):c==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var nr,En=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,p,w,E){MSApp.execUnsafeLocalFunction(function(){return c(u,p,w,E)})}:c})(function(c,u){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=u;else{for(nr=nr||document.createElement("div"),nr.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=nr.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;u.firstChild;)c.appendChild(u.firstChild)}});function ut(c,u){if(u){var p=c.firstChild;if(p&&p===c.lastChild&&p.nodeType===3){p.nodeValue=u;return}}c.textContent=u}var At={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oe=["Webkit","ms","Moz","O"];Object.keys(At).forEach(function(c){oe.forEach(function(u){u=u+c.charAt(0).toUpperCase()+c.substring(1),At[u]=At[c]})});function ke(c,u,p){return u==null||typeof u=="boolean"||u===""?"":p||typeof u!="number"||u===0||At.hasOwnProperty(c)&&At[c]?(""+u).trim():u+"px"}function Ke(c,u){c=c.style;for(var p in u)if(u.hasOwnProperty(p)){var w=p.indexOf("--")===0,E=ke(p,u[p],w);p==="float"&&(p="cssFloat"),w?c.setProperty(p,E):c[p]=E}}var et=me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ze(c,u){if(u){if(et[c]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(r(137,c));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(r(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(r(61))}if(u.style!=null&&typeof u.style!="object")throw Error(r(62))}}function at(c,u){if(c.indexOf("-")===-1)return typeof u.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sr=null;function hr(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Zr=null,qn=null,Dn=null;function In(c){if(c=tu(c)){if(typeof Zr!="function")throw Error(r(280));var u=c.stateNode;u&&(u=pd(u),Zr(c.stateNode,c.type,u))}}function ao(c){qn?Dn?Dn.push(c):Dn=[c]:qn=c}function Fc(){if(qn){var c=qn,u=Dn;if(Dn=qn=null,In(c),u)for(c=0;c<u.length;c++)In(u[c])}}function Si(c,u){return c(u)}function Xf(){}var Dc=!1;function Yf(c,u,p){if(Dc)return c(u,p);Dc=!0;try{return Si(c,u,p)}finally{Dc=!1,(qn!==null||Dn!==null)&&(Xf(),Fc())}}function io(c,u){var p=c.stateNode;if(p===null)return null;var w=pd(p);if(w===null)return null;p=w[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(c=c.type,w=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!w;break e;default:c=!1}if(c)return null;if(p&&typeof p!="function")throw Error(r(231,u,typeof p));return p}var Ic=!1;if(l)try{var Ni={};Object.defineProperty(Ni,"passive",{get:function(){Ic=!0}}),window.addEventListener("test",Ni,Ni),window.removeEventListener("test",Ni,Ni)}catch{Ic=!1}function Tm(c,u,p,w,E,A,I,ie,ce){var Se=Array.prototype.slice.call(arguments,3);try{u.apply(p,Se)}catch(Oe){this.onError(Oe)}}var so=!1,dl=null,B=!1,Z=null,q={onError:function(c){so=!0,dl=c}};function Y(c,u,p,w,E,A,I,ie,ce){so=!1,dl=null,Tm.apply(q,arguments)}function te(c,u,p,w,E,A,I,ie,ce){if(Y.apply(this,arguments),so){if(so){var Se=dl;so=!1,dl=null}else throw Error(r(198));B||(B=!0,Z=Se)}}function re(c){var u=c,p=c;if(c.alternate)for(;u.return;)u=u.return;else{c=u;do u=c,(u.flags&4098)!==0&&(p=u.return),c=u.return;while(c)}return u.tag===3?p:null}function ye(c){if(c.tag===13){var u=c.memoizedState;if(u===null&&(c=c.alternate,c!==null&&(u=c.memoizedState)),u!==null)return u.dehydrated}return null}function _e(c){if(re(c)!==c)throw Error(r(188))}function ve(c){var u=c.alternate;if(!u){if(u=re(c),u===null)throw Error(r(188));return u!==c?null:c}for(var p=c,w=u;;){var E=p.return;if(E===null)break;var A=E.alternate;if(A===null){if(w=E.return,w!==null){p=w;continue}break}if(E.child===A.child){for(A=E.child;A;){if(A===p)return _e(E),c;if(A===w)return _e(E),u;A=A.sibling}throw Error(r(188))}if(p.return!==w.return)p=E,w=A;else{for(var I=!1,ie=E.child;ie;){if(ie===p){I=!0,p=E,w=A;break}if(ie===w){I=!0,w=E,p=A;break}ie=ie.sibling}if(!I){for(ie=A.child;ie;){if(ie===p){I=!0,p=A,w=E;break}if(ie===w){I=!0,w=A,p=E;break}ie=ie.sibling}if(!I)throw Error(r(189))}}if(p.alternate!==w)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?c:u}function be(c){return c=ve(c),c!==null?we(c):null}function we(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var u=we(c);if(u!==null)return u;c=c.sibling}return null}var Fe=t.unstable_scheduleCallback,$e=t.unstable_cancelCallback,Ve=t.unstable_shouldYield,Me=t.unstable_requestPaint,Ie=t.unstable_now,dt=t.unstable_getCurrentPriorityLevel,Bt=t.unstable_ImmediatePriority,Ut=t.unstable_UserBlockingPriority,mr=t.unstable_NormalPriority,oo=t.unstable_LowPriority,ls=t.unstable_IdlePriority,ai=null,Br=null;function Mc(c){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(ai,c,void 0,(c.current.flags&128)===128)}catch{}}var pr=Math.clz32?Math.clz32:b6,v6=Math.log,y6=Math.LN2;function b6(c){return c>>>=0,c===0?32:31-(v6(c)/y6|0)|0}var Jf=64,Qf=4194304;function Rc(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function Zf(c,u){var p=c.pendingLanes;if(p===0)return 0;var w=0,E=c.suspendedLanes,A=c.pingedLanes,I=p&268435455;if(I!==0){var ie=I&~E;ie!==0?w=Rc(ie):(A&=I,A!==0&&(w=Rc(A)))}else I=p&~E,I!==0?w=Rc(I):A!==0&&(w=Rc(A));if(w===0)return 0;if(u!==0&&u!==w&&(u&E)===0&&(E=w&-w,A=u&-u,E>=A||E===16&&(A&4194240)!==0))return u;if((w&4)!==0&&(w|=p&16),u=c.entangledLanes,u!==0)for(c=c.entanglements,u&=w;0<u;)p=31-pr(u),E=1<<p,w|=c[p],u&=~E;return w}function w6(c,u){switch(c){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S6(c,u){for(var p=c.suspendedLanes,w=c.pingedLanes,E=c.expirationTimes,A=c.pendingLanes;0<A;){var I=31-pr(A),ie=1<<I,ce=E[I];ce===-1?((ie&p)===0||(ie&w)!==0)&&(E[I]=w6(ie,u)):ce<=u&&(c.expiredLanes|=ie),A&=~ie}}function Pm(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function cw(){var c=Jf;return Jf<<=1,(Jf&4194240)===0&&(Jf=64),c}function Om(c){for(var u=[],p=0;31>p;p++)u.push(c);return u}function Lc(c,u,p){c.pendingLanes|=u,u!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,u=31-pr(u),c[u]=p}function N6(c,u){var p=c.pendingLanes&~u;c.pendingLanes=u,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=u,c.mutableReadLanes&=u,c.entangledLanes&=u,u=c.entanglements;var w=c.eventTimes;for(c=c.expirationTimes;0<p;){var E=31-pr(p),A=1<<E;u[E]=0,w[E]=-1,c[E]=-1,p&=~A}}function Fm(c,u){var p=c.entangledLanes|=u;for(c=c.entanglements;p;){var w=31-pr(p),E=1<<w;E&u|c[w]&u&&(c[w]|=u),p&=~E}}var Tt=0;function uw(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var fw,Dm,dw,hw,mw,Im=!1,ed=[],cs=null,us=null,fs=null,Bc=new Map,$c=new Map,ds=[],E6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pw(c,u){switch(c){case"focusin":case"focusout":cs=null;break;case"dragenter":case"dragleave":us=null;break;case"mouseover":case"mouseout":fs=null;break;case"pointerover":case"pointerout":Bc.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":$c.delete(u.pointerId)}}function Uc(c,u,p,w,E,A){return c===null||c.nativeEvent!==A?(c={blockedOn:u,domEventName:p,eventSystemFlags:w,nativeEvent:A,targetContainers:[E]},u!==null&&(u=tu(u),u!==null&&Dm(u)),c):(c.eventSystemFlags|=w,u=c.targetContainers,E!==null&&u.indexOf(E)===-1&&u.push(E),c)}function _6(c,u,p,w,E){switch(u){case"focusin":return cs=Uc(cs,c,u,p,w,E),!0;case"dragenter":return us=Uc(us,c,u,p,w,E),!0;case"mouseover":return fs=Uc(fs,c,u,p,w,E),!0;case"pointerover":var A=E.pointerId;return Bc.set(A,Uc(Bc.get(A)||null,c,u,p,w,E)),!0;case"gotpointercapture":return A=E.pointerId,$c.set(A,Uc($c.get(A)||null,c,u,p,w,E)),!0}return!1}function xw(c){var u=lo(c.target);if(u!==null){var p=re(u);if(p!==null){if(u=p.tag,u===13){if(u=ye(p),u!==null){c.blockedOn=u,mw(c.priority,function(){dw(p)});return}}else if(u===3&&p.stateNode.current.memoizedState.isDehydrated){c.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}c.blockedOn=null}function td(c){if(c.blockedOn!==null)return!1;for(var u=c.targetContainers;0<u.length;){var p=Rm(c.domEventName,c.eventSystemFlags,u[0],c.nativeEvent);if(p===null){p=c.nativeEvent;var w=new p.constructor(p.type,p);Sr=w,p.target.dispatchEvent(w),Sr=null}else return u=tu(p),u!==null&&Dm(u),c.blockedOn=p,!1;u.shift()}return!0}function gw(c,u,p){td(c)&&p.delete(u)}function k6(){Im=!1,cs!==null&&td(cs)&&(cs=null),us!==null&&td(us)&&(us=null),fs!==null&&td(fs)&&(fs=null),Bc.forEach(gw),$c.forEach(gw)}function zc(c,u){c.blockedOn===u&&(c.blockedOn=null,Im||(Im=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,k6)))}function Wc(c){function u(E){return zc(E,c)}if(0<ed.length){zc(ed[0],c);for(var p=1;p<ed.length;p++){var w=ed[p];w.blockedOn===c&&(w.blockedOn=null)}}for(cs!==null&&zc(cs,c),us!==null&&zc(us,c),fs!==null&&zc(fs,c),Bc.forEach(u),$c.forEach(u),p=0;p<ds.length;p++)w=ds[p],w.blockedOn===c&&(w.blockedOn=null);for(;0<ds.length&&(p=ds[0],p.blockedOn===null);)xw(p),p.blockedOn===null&&ds.shift()}var hl=C.ReactCurrentBatchConfig,rd=!0;function j6(c,u,p,w){var E=Tt,A=hl.transition;hl.transition=null;try{Tt=1,Mm(c,u,p,w)}finally{Tt=E,hl.transition=A}}function C6(c,u,p,w){var E=Tt,A=hl.transition;hl.transition=null;try{Tt=4,Mm(c,u,p,w)}finally{Tt=E,hl.transition=A}}function Mm(c,u,p,w){if(rd){var E=Rm(c,u,p,w);if(E===null)ep(c,u,w,nd,p),pw(c,w);else if(_6(E,c,u,p,w))w.stopPropagation();else if(pw(c,w),u&4&&-1<E6.indexOf(c)){for(;E!==null;){var A=tu(E);if(A!==null&&fw(A),A=Rm(c,u,p,w),A===null&&ep(c,u,w,nd,p),A===E)break;E=A}E!==null&&w.stopPropagation()}else ep(c,u,w,null,p)}}var nd=null;function Rm(c,u,p,w){if(nd=null,c=hr(w),c=lo(c),c!==null)if(u=re(c),u===null)c=null;else if(p=u.tag,p===13){if(c=ye(u),c!==null)return c;c=null}else if(p===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;c=null}else u!==c&&(c=null);return nd=c,null}function vw(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dt()){case Bt:return 1;case Ut:return 4;case mr:case oo:return 16;case ls:return 536870912;default:return 16}default:return 16}}var hs=null,Lm=null,ad=null;function yw(){if(ad)return ad;var c,u=Lm,p=u.length,w,E="value"in hs?hs.value:hs.textContent,A=E.length;for(c=0;c<p&&u[c]===E[c];c++);var I=p-c;for(w=1;w<=I&&u[p-w]===E[A-w];w++);return ad=E.slice(c,1<w?1-w:void 0)}function id(c){var u=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&u===13&&(c=13)):c=u,c===10&&(c=13),32<=c||c===13?c:0}function sd(){return!0}function bw(){return!1}function Xn(c){function u(p,w,E,A,I){this._reactName=p,this._targetInst=E,this.type=w,this.nativeEvent=A,this.target=I,this.currentTarget=null;for(var ie in c)c.hasOwnProperty(ie)&&(p=c[ie],this[ie]=p?p(A):A[ie]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?sd:bw,this.isPropagationStopped=bw,this}return me(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=sd)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=sd)},persist:function(){},isPersistent:sd}),u}var ml={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bm=Xn(ml),Hc=me({},ml,{view:0,detail:0}),A6=Xn(Hc),$m,Um,Vc,od=me({},Hc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wm,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Vc&&(Vc&&c.type==="mousemove"?($m=c.screenX-Vc.screenX,Um=c.screenY-Vc.screenY):Um=$m=0,Vc=c),$m)},movementY:function(c){return"movementY"in c?c.movementY:Um}}),ww=Xn(od),T6=me({},od,{dataTransfer:0}),P6=Xn(T6),O6=me({},Hc,{relatedTarget:0}),zm=Xn(O6),F6=me({},ml,{animationName:0,elapsedTime:0,pseudoElement:0}),D6=Xn(F6),I6=me({},ml,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),M6=Xn(I6),R6=me({},ml,{data:0}),Sw=Xn(R6),L6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function U6(c){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(c):(c=$6[c])?!!u[c]:!1}function Wm(){return U6}var z6=me({},Hc,{key:function(c){if(c.key){var u=L6[c.key]||c.key;if(u!=="Unidentified")return u}return c.type==="keypress"?(c=id(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?B6[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wm,charCode:function(c){return c.type==="keypress"?id(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?id(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),W6=Xn(z6),H6=me({},od,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nw=Xn(H6),V6=me({},Hc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wm}),K6=Xn(V6),G6=me({},ml,{propertyName:0,elapsedTime:0,pseudoElement:0}),q6=Xn(G6),X6=me({},od,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),Y6=Xn(X6),J6=[9,13,27,32],Hm=l&&"CompositionEvent"in window,Kc=null;l&&"documentMode"in document&&(Kc=document.documentMode);var Q6=l&&"TextEvent"in window&&!Kc,Ew=l&&(!Hm||Kc&&8<Kc&&11>=Kc),_w=" ",kw=!1;function jw(c,u){switch(c){case"keyup":return J6.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cw(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var pl=!1;function Z6(c,u){switch(c){case"compositionend":return Cw(u);case"keypress":return u.which!==32?null:(kw=!0,_w);case"textInput":return c=u.data,c===_w&&kw?null:c;default:return null}}function eF(c,u){if(pl)return c==="compositionend"||!Hm&&jw(c,u)?(c=yw(),ad=Lm=hs=null,pl=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Ew&&u.locale!=="ko"?null:u.data;default:return null}}var tF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Aw(c){var u=c&&c.nodeName&&c.nodeName.toLowerCase();return u==="input"?!!tF[c.type]:u==="textarea"}function Tw(c,u,p,w){ao(w),u=dd(u,"onChange"),0<u.length&&(p=new Bm("onChange","change",null,p,w),c.push({event:p,listeners:u}))}var Gc=null,qc=null;function rF(c){qw(c,0)}function ld(c){var u=bl(c);if(F(u))return c}function nF(c,u){if(c==="change")return u}var Pw=!1;if(l){var Vm;if(l){var Km="oninput"in document;if(!Km){var Ow=document.createElement("div");Ow.setAttribute("oninput","return;"),Km=typeof Ow.oninput=="function"}Vm=Km}else Vm=!1;Pw=Vm&&(!document.documentMode||9<document.documentMode)}function Fw(){Gc&&(Gc.detachEvent("onpropertychange",Dw),qc=Gc=null)}function Dw(c){if(c.propertyName==="value"&&ld(qc)){var u=[];Tw(u,qc,c,hr(c)),Yf(rF,u)}}function aF(c,u,p){c==="focusin"?(Fw(),Gc=u,qc=p,Gc.attachEvent("onpropertychange",Dw)):c==="focusout"&&Fw()}function iF(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return ld(qc)}function sF(c,u){if(c==="click")return ld(u)}function oF(c,u){if(c==="input"||c==="change")return ld(u)}function lF(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var za=typeof Object.is=="function"?Object.is:lF;function Xc(c,u){if(za(c,u))return!0;if(typeof c!="object"||c===null||typeof u!="object"||u===null)return!1;var p=Object.keys(c),w=Object.keys(u);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var E=p[w];if(!f.call(u,E)||!za(c[E],u[E]))return!1}return!0}function Iw(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function Mw(c,u){var p=Iw(c);c=0;for(var w;p;){if(p.nodeType===3){if(w=c+p.textContent.length,c<=u&&w>=u)return{node:p,offset:u-c};c=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Iw(p)}}function Rw(c,u){return c&&u?c===u?!0:c&&c.nodeType===3?!1:u&&u.nodeType===3?Rw(c,u.parentNode):"contains"in c?c.contains(u):c.compareDocumentPosition?!!(c.compareDocumentPosition(u)&16):!1:!1}function Lw(){for(var c=window,u=Pe();u instanceof c.HTMLIFrameElement;){try{var p=typeof u.contentWindow.location.href=="string"}catch{p=!1}if(p)c=u.contentWindow;else break;u=Pe(c.document)}return u}function Gm(c){var u=c&&c.nodeName&&c.nodeName.toLowerCase();return u&&(u==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||u==="textarea"||c.contentEditable==="true")}function cF(c){var u=Lw(),p=c.focusedElem,w=c.selectionRange;if(u!==p&&p&&p.ownerDocument&&Rw(p.ownerDocument.documentElement,p)){if(w!==null&&Gm(p)){if(u=w.start,c=w.end,c===void 0&&(c=u),"selectionStart"in p)p.selectionStart=u,p.selectionEnd=Math.min(c,p.value.length);else if(c=(u=p.ownerDocument||document)&&u.defaultView||window,c.getSelection){c=c.getSelection();var E=p.textContent.length,A=Math.min(w.start,E);w=w.end===void 0?A:Math.min(w.end,E),!c.extend&&A>w&&(E=w,w=A,A=E),E=Mw(p,A);var I=Mw(p,w);E&&I&&(c.rangeCount!==1||c.anchorNode!==E.node||c.anchorOffset!==E.offset||c.focusNode!==I.node||c.focusOffset!==I.offset)&&(u=u.createRange(),u.setStart(E.node,E.offset),c.removeAllRanges(),A>w?(c.addRange(u),c.extend(I.node,I.offset)):(u.setEnd(I.node,I.offset),c.addRange(u)))}}for(u=[],c=p;c=c.parentNode;)c.nodeType===1&&u.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<u.length;p++)c=u[p],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var uF=l&&"documentMode"in document&&11>=document.documentMode,xl=null,qm=null,Yc=null,Xm=!1;function Bw(c,u,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Xm||xl==null||xl!==Pe(w)||(w=xl,"selectionStart"in w&&Gm(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Yc&&Xc(Yc,w)||(Yc=w,w=dd(qm,"onSelect"),0<w.length&&(u=new Bm("onSelect","select",null,u,p),c.push({event:u,listeners:w}),u.target=xl)))}function cd(c,u){var p={};return p[c.toLowerCase()]=u.toLowerCase(),p["Webkit"+c]="webkit"+u,p["Moz"+c]="moz"+u,p}var gl={animationend:cd("Animation","AnimationEnd"),animationiteration:cd("Animation","AnimationIteration"),animationstart:cd("Animation","AnimationStart"),transitionend:cd("Transition","TransitionEnd")},Ym={},$w={};l&&($w=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function ud(c){if(Ym[c])return Ym[c];if(!gl[c])return c;var u=gl[c],p;for(p in u)if(u.hasOwnProperty(p)&&p in $w)return Ym[c]=u[p];return c}var Uw=ud("animationend"),zw=ud("animationiteration"),Ww=ud("animationstart"),Hw=ud("transitionend"),Vw=new Map,Kw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ms(c,u){Vw.set(c,u),i(u,[c])}for(var Jm=0;Jm<Kw.length;Jm++){var Qm=Kw[Jm],fF=Qm.toLowerCase(),dF=Qm[0].toUpperCase()+Qm.slice(1);ms(fF,"on"+dF)}ms(Uw,"onAnimationEnd"),ms(zw,"onAnimationIteration"),ms(Ww,"onAnimationStart"),ms("dblclick","onDoubleClick"),ms("focusin","onFocus"),ms("focusout","onBlur"),ms(Hw,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jc));function Gw(c,u,p){var w=c.type||"unknown-event";c.currentTarget=p,te(w,u,void 0,c),c.currentTarget=null}function qw(c,u){u=(u&4)!==0;for(var p=0;p<c.length;p++){var w=c[p],E=w.event;w=w.listeners;e:{var A=void 0;if(u)for(var I=w.length-1;0<=I;I--){var ie=w[I],ce=ie.instance,Se=ie.currentTarget;if(ie=ie.listener,ce!==A&&E.isPropagationStopped())break e;Gw(E,ie,Se),A=ce}else for(I=0;I<w.length;I++){if(ie=w[I],ce=ie.instance,Se=ie.currentTarget,ie=ie.listener,ce!==A&&E.isPropagationStopped())break e;Gw(E,ie,Se),A=ce}}}if(B)throw c=Z,B=!1,Z=null,c}function Ht(c,u){var p=u[sp];p===void 0&&(p=u[sp]=new Set);var w=c+"__bubble";p.has(w)||(Xw(u,c,2,!1),p.add(w))}function Zm(c,u,p){var w=0;u&&(w|=4),Xw(p,c,w,u)}var fd="_reactListening"+Math.random().toString(36).slice(2);function Qc(c){if(!c[fd]){c[fd]=!0,n.forEach(function(p){p!=="selectionchange"&&(hF.has(p)||Zm(p,!1,c),Zm(p,!0,c))});var u=c.nodeType===9?c:c.ownerDocument;u===null||u[fd]||(u[fd]=!0,Zm("selectionchange",!1,u))}}function Xw(c,u,p,w){switch(vw(u)){case 1:var E=j6;break;case 4:E=C6;break;default:E=Mm}p=E.bind(null,u,p,c),E=void 0,!Ic||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(E=!0),w?E!==void 0?c.addEventListener(u,p,{capture:!0,passive:E}):c.addEventListener(u,p,!0):E!==void 0?c.addEventListener(u,p,{passive:E}):c.addEventListener(u,p,!1)}function ep(c,u,p,w,E){var A=w;if((u&1)===0&&(u&2)===0&&w!==null)e:for(;;){if(w===null)return;var I=w.tag;if(I===3||I===4){var ie=w.stateNode.containerInfo;if(ie===E||ie.nodeType===8&&ie.parentNode===E)break;if(I===4)for(I=w.return;I!==null;){var ce=I.tag;if((ce===3||ce===4)&&(ce=I.stateNode.containerInfo,ce===E||ce.nodeType===8&&ce.parentNode===E))return;I=I.return}for(;ie!==null;){if(I=lo(ie),I===null)return;if(ce=I.tag,ce===5||ce===6){w=A=I;continue e}ie=ie.parentNode}}w=w.return}Yf(function(){var Se=A,Oe=hr(p),De=[];e:{var Ce=Vw.get(c);if(Ce!==void 0){var He=Bm,Xe=c;switch(c){case"keypress":if(id(p)===0)break e;case"keydown":case"keyup":He=W6;break;case"focusin":Xe="focus",He=zm;break;case"focusout":Xe="blur",He=zm;break;case"beforeblur":case"afterblur":He=zm;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":He=ww;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":He=P6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":He=K6;break;case Uw:case zw:case Ww:He=D6;break;case Hw:He=q6;break;case"scroll":He=A6;break;case"wheel":He=Y6;break;case"copy":case"cut":case"paste":He=M6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":He=Nw}var Ye=(u&4)!==0,xr=!Ye&&c==="scroll",xe=Ye?Ce!==null?Ce+"Capture":null:Ce;Ye=[];for(var he=Se,ge;he!==null;){ge=he;var Re=ge.stateNode;if(ge.tag===5&&Re!==null&&(ge=Re,xe!==null&&(Re=io(he,xe),Re!=null&&Ye.push(Zc(he,Re,ge)))),xr)break;he=he.return}0<Ye.length&&(Ce=new He(Ce,Xe,null,p,Oe),De.push({event:Ce,listeners:Ye}))}}if((u&7)===0){e:{if(Ce=c==="mouseover"||c==="pointerover",He=c==="mouseout"||c==="pointerout",Ce&&p!==Sr&&(Xe=p.relatedTarget||p.fromElement)&&(lo(Xe)||Xe[Ei]))break e;if((He||Ce)&&(Ce=Oe.window===Oe?Oe:(Ce=Oe.ownerDocument)?Ce.defaultView||Ce.parentWindow:window,He?(Xe=p.relatedTarget||p.toElement,He=Se,Xe=Xe?lo(Xe):null,Xe!==null&&(xr=re(Xe),Xe!==xr||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):(He=null,Xe=Se),He!==Xe)){if(Ye=ww,Re="onMouseLeave",xe="onMouseEnter",he="mouse",(c==="pointerout"||c==="pointerover")&&(Ye=Nw,Re="onPointerLeave",xe="onPointerEnter",he="pointer"),xr=He==null?Ce:bl(He),ge=Xe==null?Ce:bl(Xe),Ce=new Ye(Re,he+"leave",He,p,Oe),Ce.target=xr,Ce.relatedTarget=ge,Re=null,lo(Oe)===Se&&(Ye=new Ye(xe,he+"enter",Xe,p,Oe),Ye.target=ge,Ye.relatedTarget=xr,Re=Ye),xr=Re,He&&Xe)t:{for(Ye=He,xe=Xe,he=0,ge=Ye;ge;ge=vl(ge))he++;for(ge=0,Re=xe;Re;Re=vl(Re))ge++;for(;0<he-ge;)Ye=vl(Ye),he--;for(;0<ge-he;)xe=vl(xe),ge--;for(;he--;){if(Ye===xe||xe!==null&&Ye===xe.alternate)break t;Ye=vl(Ye),xe=vl(xe)}Ye=null}else Ye=null;He!==null&&Yw(De,Ce,He,Ye,!1),Xe!==null&&xr!==null&&Yw(De,xr,Xe,Ye,!0)}}e:{if(Ce=Se?bl(Se):window,He=Ce.nodeName&&Ce.nodeName.toLowerCase(),He==="select"||He==="input"&&Ce.type==="file")var Je=nF;else if(Aw(Ce))if(Pw)Je=oF;else{Je=iF;var rt=aF}else(He=Ce.nodeName)&&He.toLowerCase()==="input"&&(Ce.type==="checkbox"||Ce.type==="radio")&&(Je=sF);if(Je&&(Je=Je(c,Se))){Tw(De,Je,p,Oe);break e}rt&&rt(c,Ce,Se),c==="focusout"&&(rt=Ce._wrapperState)&&rt.controlled&&Ce.type==="number"&&jt(Ce,"number",Ce.value)}switch(rt=Se?bl(Se):window,c){case"focusin":(Aw(rt)||rt.contentEditable==="true")&&(xl=rt,qm=Se,Yc=null);break;case"focusout":Yc=qm=xl=null;break;case"mousedown":Xm=!0;break;case"contextmenu":case"mouseup":case"dragend":Xm=!1,Bw(De,p,Oe);break;case"selectionchange":if(uF)break;case"keydown":case"keyup":Bw(De,p,Oe)}var nt;if(Hm)e:{switch(c){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else pl?jw(c,p)&&(ft="onCompositionEnd"):c==="keydown"&&p.keyCode===229&&(ft="onCompositionStart");ft&&(Ew&&p.locale!=="ko"&&(pl||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&pl&&(nt=yw()):(hs=Oe,Lm="value"in hs?hs.value:hs.textContent,pl=!0)),rt=dd(Se,ft),0<rt.length&&(ft=new Sw(ft,c,null,p,Oe),De.push({event:ft,listeners:rt}),nt?ft.data=nt:(nt=Cw(p),nt!==null&&(ft.data=nt)))),(nt=Q6?Z6(c,p):eF(c,p))&&(Se=dd(Se,"onBeforeInput"),0<Se.length&&(Oe=new Sw("onBeforeInput","beforeinput",null,p,Oe),De.push({event:Oe,listeners:Se}),Oe.data=nt))}qw(De,u)})}function Zc(c,u,p){return{instance:c,listener:u,currentTarget:p}}function dd(c,u){for(var p=u+"Capture",w=[];c!==null;){var E=c,A=E.stateNode;E.tag===5&&A!==null&&(E=A,A=io(c,p),A!=null&&w.unshift(Zc(c,A,E)),A=io(c,u),A!=null&&w.push(Zc(c,A,E))),c=c.return}return w}function vl(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function Yw(c,u,p,w,E){for(var A=u._reactName,I=[];p!==null&&p!==w;){var ie=p,ce=ie.alternate,Se=ie.stateNode;if(ce!==null&&ce===w)break;ie.tag===5&&Se!==null&&(ie=Se,E?(ce=io(p,A),ce!=null&&I.unshift(Zc(p,ce,ie))):E||(ce=io(p,A),ce!=null&&I.push(Zc(p,ce,ie)))),p=p.return}I.length!==0&&c.push({event:u,listeners:I})}var mF=/\r\n?/g,pF=/\u0000|\uFFFD/g;function Jw(c){return(typeof c=="string"?c:""+c).replace(mF,`
`).replace(pF,"")}function hd(c,u,p){if(u=Jw(u),Jw(c)!==u&&p)throw Error(r(425))}function md(){}var tp=null,rp=null;function np(c,u){return c==="textarea"||c==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var ap=typeof setTimeout=="function"?setTimeout:void 0,xF=typeof clearTimeout=="function"?clearTimeout:void 0,Qw=typeof Promise=="function"?Promise:void 0,gF=typeof queueMicrotask=="function"?queueMicrotask:typeof Qw<"u"?function(c){return Qw.resolve(null).then(c).catch(vF)}:ap;function vF(c){setTimeout(function(){throw c})}function ip(c,u){var p=u,w=0;do{var E=p.nextSibling;if(c.removeChild(p),E&&E.nodeType===8)if(p=E.data,p==="/$"){if(w===0){c.removeChild(E),Wc(u);return}w--}else p!=="$"&&p!=="$?"&&p!=="$!"||w++;p=E}while(p);Wc(u)}function ps(c){for(;c!=null;c=c.nextSibling){var u=c.nodeType;if(u===1||u===3)break;if(u===8){if(u=c.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return c}function Zw(c){c=c.previousSibling;for(var u=0;c;){if(c.nodeType===8){var p=c.data;if(p==="$"||p==="$!"||p==="$?"){if(u===0)return c;u--}else p==="/$"&&u++}c=c.previousSibling}return null}var yl=Math.random().toString(36).slice(2),ii="__reactFiber$"+yl,eu="__reactProps$"+yl,Ei="__reactContainer$"+yl,sp="__reactEvents$"+yl,yF="__reactListeners$"+yl,bF="__reactHandles$"+yl;function lo(c){var u=c[ii];if(u)return u;for(var p=c.parentNode;p;){if(u=p[Ei]||p[ii]){if(p=u.alternate,u.child!==null||p!==null&&p.child!==null)for(c=Zw(c);c!==null;){if(p=c[ii])return p;c=Zw(c)}return u}c=p,p=c.parentNode}return null}function tu(c){return c=c[ii]||c[Ei],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function bl(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(r(33))}function pd(c){return c[eu]||null}var op=[],wl=-1;function xs(c){return{current:c}}function Vt(c){0>wl||(c.current=op[wl],op[wl]=null,wl--)}function zt(c,u){wl++,op[wl]=c.current,c.current=u}var gs={},cn=xs(gs),Mn=xs(!1),co=gs;function Sl(c,u){var p=c.type.contextTypes;if(!p)return gs;var w=c.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===u)return w.__reactInternalMemoizedMaskedChildContext;var E={},A;for(A in p)E[A]=u[A];return w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=u,c.__reactInternalMemoizedMaskedChildContext=E),E}function Rn(c){return c=c.childContextTypes,c!=null}function xd(){Vt(Mn),Vt(cn)}function e2(c,u,p){if(cn.current!==gs)throw Error(r(168));zt(cn,u),zt(Mn,p)}function t2(c,u,p){var w=c.stateNode;if(u=u.childContextTypes,typeof w.getChildContext!="function")return p;w=w.getChildContext();for(var E in w)if(!(E in u))throw Error(r(108,se(c)||"Unknown",E));return me({},p,w)}function gd(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||gs,co=cn.current,zt(cn,c),zt(Mn,Mn.current),!0}function r2(c,u,p){var w=c.stateNode;if(!w)throw Error(r(169));p?(c=t2(c,u,co),w.__reactInternalMemoizedMergedChildContext=c,Vt(Mn),Vt(cn),zt(cn,c)):Vt(Mn),zt(Mn,p)}var _i=null,vd=!1,lp=!1;function n2(c){_i===null?_i=[c]:_i.push(c)}function wF(c){vd=!0,n2(c)}function vs(){if(!lp&&_i!==null){lp=!0;var c=0,u=Tt;try{var p=_i;for(Tt=1;c<p.length;c++){var w=p[c];do w=w(!0);while(w!==null)}_i=null,vd=!1}catch(E){throw _i!==null&&(_i=_i.slice(c+1)),Fe(Bt,vs),E}finally{Tt=u,lp=!1}}return null}var Nl=[],El=0,yd=null,bd=0,ma=[],pa=0,uo=null,ki=1,ji="";function fo(c,u){Nl[El++]=bd,Nl[El++]=yd,yd=c,bd=u}function a2(c,u,p){ma[pa++]=ki,ma[pa++]=ji,ma[pa++]=uo,uo=c;var w=ki;c=ji;var E=32-pr(w)-1;w&=~(1<<E),p+=1;var A=32-pr(u)+E;if(30<A){var I=E-E%5;A=(w&(1<<I)-1).toString(32),w>>=I,E-=I,ki=1<<32-pr(u)+E|p<<E|w,ji=A+c}else ki=1<<A|p<<E|w,ji=c}function cp(c){c.return!==null&&(fo(c,1),a2(c,1,0))}function up(c){for(;c===yd;)yd=Nl[--El],Nl[El]=null,bd=Nl[--El],Nl[El]=null;for(;c===uo;)uo=ma[--pa],ma[pa]=null,ji=ma[--pa],ma[pa]=null,ki=ma[--pa],ma[pa]=null}var Yn=null,Jn=null,Jt=!1,Wa=null;function i2(c,u){var p=ya(5,null,null,0);p.elementType="DELETED",p.stateNode=u,p.return=c,u=c.deletions,u===null?(c.deletions=[p],c.flags|=16):u.push(p)}function s2(c,u){switch(c.tag){case 5:var p=c.type;return u=u.nodeType!==1||p.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(c.stateNode=u,Yn=c,Jn=ps(u.firstChild),!0):!1;case 6:return u=c.pendingProps===""||u.nodeType!==3?null:u,u!==null?(c.stateNode=u,Yn=c,Jn=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(p=uo!==null?{id:ki,overflow:ji}:null,c.memoizedState={dehydrated:u,treeContext:p,retryLane:1073741824},p=ya(18,null,null,0),p.stateNode=u,p.return=c,c.child=p,Yn=c,Jn=null,!0):!1;default:return!1}}function fp(c){return(c.mode&1)!==0&&(c.flags&128)===0}function dp(c){if(Jt){var u=Jn;if(u){var p=u;if(!s2(c,u)){if(fp(c))throw Error(r(418));u=ps(p.nextSibling);var w=Yn;u&&s2(c,u)?i2(w,p):(c.flags=c.flags&-4097|2,Jt=!1,Yn=c)}}else{if(fp(c))throw Error(r(418));c.flags=c.flags&-4097|2,Jt=!1,Yn=c}}}function o2(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Yn=c}function wd(c){if(c!==Yn)return!1;if(!Jt)return o2(c),Jt=!0,!1;var u;if((u=c.tag!==3)&&!(u=c.tag!==5)&&(u=c.type,u=u!=="head"&&u!=="body"&&!np(c.type,c.memoizedProps)),u&&(u=Jn)){if(fp(c))throw l2(),Error(r(418));for(;u;)i2(c,u),u=ps(u.nextSibling)}if(o2(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(317));e:{for(c=c.nextSibling,u=0;c;){if(c.nodeType===8){var p=c.data;if(p==="/$"){if(u===0){Jn=ps(c.nextSibling);break e}u--}else p!=="$"&&p!=="$!"&&p!=="$?"||u++}c=c.nextSibling}Jn=null}}else Jn=Yn?ps(c.stateNode.nextSibling):null;return!0}function l2(){for(var c=Jn;c;)c=ps(c.nextSibling)}function _l(){Jn=Yn=null,Jt=!1}function hp(c){Wa===null?Wa=[c]:Wa.push(c)}var SF=C.ReactCurrentBatchConfig;function ru(c,u,p){if(c=p.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(r(309));var w=p.stateNode}if(!w)throw Error(r(147,c));var E=w,A=""+c;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===A?u.ref:(u=function(I){var ie=E.refs;I===null?delete ie[A]:ie[A]=I},u._stringRef=A,u)}if(typeof c!="string")throw Error(r(284));if(!p._owner)throw Error(r(290,c))}return c}function Sd(c,u){throw c=Object.prototype.toString.call(u),Error(r(31,c==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":c))}function c2(c){var u=c._init;return u(c._payload)}function u2(c){function u(xe,he){if(c){var ge=xe.deletions;ge===null?(xe.deletions=[he],xe.flags|=16):ge.push(he)}}function p(xe,he){if(!c)return null;for(;he!==null;)u(xe,he),he=he.sibling;return null}function w(xe,he){for(xe=new Map;he!==null;)he.key!==null?xe.set(he.key,he):xe.set(he.index,he),he=he.sibling;return xe}function E(xe,he){return xe=ks(xe,he),xe.index=0,xe.sibling=null,xe}function A(xe,he,ge){return xe.index=ge,c?(ge=xe.alternate,ge!==null?(ge=ge.index,ge<he?(xe.flags|=2,he):ge):(xe.flags|=2,he)):(xe.flags|=1048576,he)}function I(xe){return c&&xe.alternate===null&&(xe.flags|=2),xe}function ie(xe,he,ge,Re){return he===null||he.tag!==6?(he=ax(ge,xe.mode,Re),he.return=xe,he):(he=E(he,ge),he.return=xe,he)}function ce(xe,he,ge,Re){var Je=ge.type;return Je===P?Oe(xe,he,ge.props.children,Re,ge.key):he!==null&&(he.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===le&&c2(Je)===he.type)?(Re=E(he,ge.props),Re.ref=ru(xe,he,ge),Re.return=xe,Re):(Re=Kd(ge.type,ge.key,ge.props,null,xe.mode,Re),Re.ref=ru(xe,he,ge),Re.return=xe,Re)}function Se(xe,he,ge,Re){return he===null||he.tag!==4||he.stateNode.containerInfo!==ge.containerInfo||he.stateNode.implementation!==ge.implementation?(he=ix(ge,xe.mode,Re),he.return=xe,he):(he=E(he,ge.children||[]),he.return=xe,he)}function Oe(xe,he,ge,Re,Je){return he===null||he.tag!==7?(he=bo(ge,xe.mode,Re,Je),he.return=xe,he):(he=E(he,ge),he.return=xe,he)}function De(xe,he,ge){if(typeof he=="string"&&he!==""||typeof he=="number")return he=ax(""+he,xe.mode,ge),he.return=xe,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case T:return ge=Kd(he.type,he.key,he.props,null,xe.mode,ge),ge.ref=ru(xe,null,he),ge.return=xe,ge;case k:return he=ix(he,xe.mode,ge),he.return=xe,he;case le:var Re=he._init;return De(xe,Re(he._payload),ge)}if(Yt(he)||K(he))return he=bo(he,xe.mode,ge,null),he.return=xe,he;Sd(xe,he)}return null}function Ce(xe,he,ge,Re){var Je=he!==null?he.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return Je!==null?null:ie(xe,he,""+ge,Re);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case T:return ge.key===Je?ce(xe,he,ge,Re):null;case k:return ge.key===Je?Se(xe,he,ge,Re):null;case le:return Je=ge._init,Ce(xe,he,Je(ge._payload),Re)}if(Yt(ge)||K(ge))return Je!==null?null:Oe(xe,he,ge,Re,null);Sd(xe,ge)}return null}function He(xe,he,ge,Re,Je){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return xe=xe.get(ge)||null,ie(he,xe,""+Re,Je);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case T:return xe=xe.get(Re.key===null?ge:Re.key)||null,ce(he,xe,Re,Je);case k:return xe=xe.get(Re.key===null?ge:Re.key)||null,Se(he,xe,Re,Je);case le:var rt=Re._init;return He(xe,he,ge,rt(Re._payload),Je)}if(Yt(Re)||K(Re))return xe=xe.get(ge)||null,Oe(he,xe,Re,Je,null);Sd(he,Re)}return null}function Xe(xe,he,ge,Re){for(var Je=null,rt=null,nt=he,ft=he=0,zr=null;nt!==null&&ft<ge.length;ft++){nt.index>ft?(zr=nt,nt=null):zr=nt.sibling;var Nt=Ce(xe,nt,ge[ft],Re);if(Nt===null){nt===null&&(nt=zr);break}c&&nt&&Nt.alternate===null&&u(xe,nt),he=A(Nt,he,ft),rt===null?Je=Nt:rt.sibling=Nt,rt=Nt,nt=zr}if(ft===ge.length)return p(xe,nt),Jt&&fo(xe,ft),Je;if(nt===null){for(;ft<ge.length;ft++)nt=De(xe,ge[ft],Re),nt!==null&&(he=A(nt,he,ft),rt===null?Je=nt:rt.sibling=nt,rt=nt);return Jt&&fo(xe,ft),Je}for(nt=w(xe,nt);ft<ge.length;ft++)zr=He(nt,xe,ft,ge[ft],Re),zr!==null&&(c&&zr.alternate!==null&&nt.delete(zr.key===null?ft:zr.key),he=A(zr,he,ft),rt===null?Je=zr:rt.sibling=zr,rt=zr);return c&&nt.forEach(function(js){return u(xe,js)}),Jt&&fo(xe,ft),Je}function Ye(xe,he,ge,Re){var Je=K(ge);if(typeof Je!="function")throw Error(r(150));if(ge=Je.call(ge),ge==null)throw Error(r(151));for(var rt=Je=null,nt=he,ft=he=0,zr=null,Nt=ge.next();nt!==null&&!Nt.done;ft++,Nt=ge.next()){nt.index>ft?(zr=nt,nt=null):zr=nt.sibling;var js=Ce(xe,nt,Nt.value,Re);if(js===null){nt===null&&(nt=zr);break}c&&nt&&js.alternate===null&&u(xe,nt),he=A(js,he,ft),rt===null?Je=js:rt.sibling=js,rt=js,nt=zr}if(Nt.done)return p(xe,nt),Jt&&fo(xe,ft),Je;if(nt===null){for(;!Nt.done;ft++,Nt=ge.next())Nt=De(xe,Nt.value,Re),Nt!==null&&(he=A(Nt,he,ft),rt===null?Je=Nt:rt.sibling=Nt,rt=Nt);return Jt&&fo(xe,ft),Je}for(nt=w(xe,nt);!Nt.done;ft++,Nt=ge.next())Nt=He(nt,xe,ft,Nt.value,Re),Nt!==null&&(c&&Nt.alternate!==null&&nt.delete(Nt.key===null?ft:Nt.key),he=A(Nt,he,ft),rt===null?Je=Nt:rt.sibling=Nt,rt=Nt);return c&&nt.forEach(function(t5){return u(xe,t5)}),Jt&&fo(xe,ft),Je}function xr(xe,he,ge,Re){if(typeof ge=="object"&&ge!==null&&ge.type===P&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case T:e:{for(var Je=ge.key,rt=he;rt!==null;){if(rt.key===Je){if(Je=ge.type,Je===P){if(rt.tag===7){p(xe,rt.sibling),he=E(rt,ge.props.children),he.return=xe,xe=he;break e}}else if(rt.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===le&&c2(Je)===rt.type){p(xe,rt.sibling),he=E(rt,ge.props),he.ref=ru(xe,rt,ge),he.return=xe,xe=he;break e}p(xe,rt);break}else u(xe,rt);rt=rt.sibling}ge.type===P?(he=bo(ge.props.children,xe.mode,Re,ge.key),he.return=xe,xe=he):(Re=Kd(ge.type,ge.key,ge.props,null,xe.mode,Re),Re.ref=ru(xe,he,ge),Re.return=xe,xe=Re)}return I(xe);case k:e:{for(rt=ge.key;he!==null;){if(he.key===rt)if(he.tag===4&&he.stateNode.containerInfo===ge.containerInfo&&he.stateNode.implementation===ge.implementation){p(xe,he.sibling),he=E(he,ge.children||[]),he.return=xe,xe=he;break e}else{p(xe,he);break}else u(xe,he);he=he.sibling}he=ix(ge,xe.mode,Re),he.return=xe,xe=he}return I(xe);case le:return rt=ge._init,xr(xe,he,rt(ge._payload),Re)}if(Yt(ge))return Xe(xe,he,ge,Re);if(K(ge))return Ye(xe,he,ge,Re);Sd(xe,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,he!==null&&he.tag===6?(p(xe,he.sibling),he=E(he,ge),he.return=xe,xe=he):(p(xe,he),he=ax(ge,xe.mode,Re),he.return=xe,xe=he),I(xe)):p(xe,he)}return xr}var kl=u2(!0),f2=u2(!1),Nd=xs(null),Ed=null,jl=null,mp=null;function pp(){mp=jl=Ed=null}function xp(c){var u=Nd.current;Vt(Nd),c._currentValue=u}function gp(c,u,p){for(;c!==null;){var w=c.alternate;if((c.childLanes&u)!==u?(c.childLanes|=u,w!==null&&(w.childLanes|=u)):w!==null&&(w.childLanes&u)!==u&&(w.childLanes|=u),c===p)break;c=c.return}}function Cl(c,u){Ed=c,mp=jl=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&u)!==0&&(Ln=!0),c.firstContext=null)}function xa(c){var u=c._currentValue;if(mp!==c)if(c={context:c,memoizedValue:u,next:null},jl===null){if(Ed===null)throw Error(r(308));jl=c,Ed.dependencies={lanes:0,firstContext:c}}else jl=jl.next=c;return u}var ho=null;function vp(c){ho===null?ho=[c]:ho.push(c)}function d2(c,u,p,w){var E=u.interleaved;return E===null?(p.next=p,vp(u)):(p.next=E.next,E.next=p),u.interleaved=p,Ci(c,w)}function Ci(c,u){c.lanes|=u;var p=c.alternate;for(p!==null&&(p.lanes|=u),p=c,c=c.return;c!==null;)c.childLanes|=u,p=c.alternate,p!==null&&(p.childLanes|=u),p=c,c=c.return;return p.tag===3?p.stateNode:null}var ys=!1;function yp(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function h2(c,u){c=c.updateQueue,u.updateQueue===c&&(u.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function Ai(c,u){return{eventTime:c,lane:u,tag:0,payload:null,callback:null,next:null}}function bs(c,u,p){var w=c.updateQueue;if(w===null)return null;if(w=w.shared,(bt&2)!==0){var E=w.pending;return E===null?u.next=u:(u.next=E.next,E.next=u),w.pending=u,Ci(c,p)}return E=w.interleaved,E===null?(u.next=u,vp(w)):(u.next=E.next,E.next=u),w.interleaved=u,Ci(c,p)}function _d(c,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194240)!==0)){var w=u.lanes;w&=c.pendingLanes,p|=w,u.lanes=p,Fm(c,p)}}function m2(c,u){var p=c.updateQueue,w=c.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var E=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var I={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};A===null?E=A=I:A=A.next=I,p=p.next}while(p!==null);A===null?E=A=u:A=A.next=u}else E=A=u;p={baseState:w.baseState,firstBaseUpdate:E,lastBaseUpdate:A,shared:w.shared,effects:w.effects},c.updateQueue=p;return}c=p.lastBaseUpdate,c===null?p.firstBaseUpdate=u:c.next=u,p.lastBaseUpdate=u}function kd(c,u,p,w){var E=c.updateQueue;ys=!1;var A=E.firstBaseUpdate,I=E.lastBaseUpdate,ie=E.shared.pending;if(ie!==null){E.shared.pending=null;var ce=ie,Se=ce.next;ce.next=null,I===null?A=Se:I.next=Se,I=ce;var Oe=c.alternate;Oe!==null&&(Oe=Oe.updateQueue,ie=Oe.lastBaseUpdate,ie!==I&&(ie===null?Oe.firstBaseUpdate=Se:ie.next=Se,Oe.lastBaseUpdate=ce))}if(A!==null){var De=E.baseState;I=0,Oe=Se=ce=null,ie=A;do{var Ce=ie.lane,He=ie.eventTime;if((w&Ce)===Ce){Oe!==null&&(Oe=Oe.next={eventTime:He,lane:0,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null});e:{var Xe=c,Ye=ie;switch(Ce=u,He=p,Ye.tag){case 1:if(Xe=Ye.payload,typeof Xe=="function"){De=Xe.call(He,De,Ce);break e}De=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=Ye.payload,Ce=typeof Xe=="function"?Xe.call(He,De,Ce):Xe,Ce==null)break e;De=me({},De,Ce);break e;case 2:ys=!0}}ie.callback!==null&&ie.lane!==0&&(c.flags|=64,Ce=E.effects,Ce===null?E.effects=[ie]:Ce.push(ie))}else He={eventTime:He,lane:Ce,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},Oe===null?(Se=Oe=He,ce=De):Oe=Oe.next=He,I|=Ce;if(ie=ie.next,ie===null){if(ie=E.shared.pending,ie===null)break;Ce=ie,ie=Ce.next,Ce.next=null,E.lastBaseUpdate=Ce,E.shared.pending=null}}while(!0);if(Oe===null&&(ce=De),E.baseState=ce,E.firstBaseUpdate=Se,E.lastBaseUpdate=Oe,u=E.shared.interleaved,u!==null){E=u;do I|=E.lane,E=E.next;while(E!==u)}else A===null&&(E.shared.lanes=0);xo|=I,c.lanes=I,c.memoizedState=De}}function p2(c,u,p){if(c=u.effects,u.effects=null,c!==null)for(u=0;u<c.length;u++){var w=c[u],E=w.callback;if(E!==null){if(w.callback=null,w=p,typeof E!="function")throw Error(r(191,E));E.call(w)}}}var nu={},si=xs(nu),au=xs(nu),iu=xs(nu);function mo(c){if(c===nu)throw Error(r(174));return c}function bp(c,u){switch(zt(iu,u),zt(au,c),zt(si,nu),c=u.nodeType,c){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Qr(null,"");break;default:c=c===8?u.parentNode:u,u=c.namespaceURI||null,c=c.tagName,u=Qr(u,c)}Vt(si),zt(si,u)}function Al(){Vt(si),Vt(au),Vt(iu)}function x2(c){mo(iu.current);var u=mo(si.current),p=Qr(u,c.type);u!==p&&(zt(au,c),zt(si,p))}function wp(c){au.current===c&&(Vt(si),Vt(au))}var ar=xs(0);function jd(c){for(var u=c;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===c)break;for(;u.sibling===null;){if(u.return===null||u.return===c)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Sp=[];function Np(){for(var c=0;c<Sp.length;c++)Sp[c]._workInProgressVersionPrimary=null;Sp.length=0}var Cd=C.ReactCurrentDispatcher,Ep=C.ReactCurrentBatchConfig,po=0,ir=null,Tr=null,$r=null,Ad=!1,su=!1,ou=0,NF=0;function un(){throw Error(r(321))}function _p(c,u){if(u===null)return!1;for(var p=0;p<u.length&&p<c.length;p++)if(!za(c[p],u[p]))return!1;return!0}function kp(c,u,p,w,E,A){if(po=A,ir=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Cd.current=c===null||c.memoizedState===null?jF:CF,c=p(w,E),su){A=0;do{if(su=!1,ou=0,25<=A)throw Error(r(301));A+=1,$r=Tr=null,u.updateQueue=null,Cd.current=AF,c=p(w,E)}while(su)}if(Cd.current=Od,u=Tr!==null&&Tr.next!==null,po=0,$r=Tr=ir=null,Ad=!1,u)throw Error(r(300));return c}function jp(){var c=ou!==0;return ou=0,c}function oi(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $r===null?ir.memoizedState=$r=c:$r=$r.next=c,$r}function ga(){if(Tr===null){var c=ir.alternate;c=c!==null?c.memoizedState:null}else c=Tr.next;var u=$r===null?ir.memoizedState:$r.next;if(u!==null)$r=u,Tr=c;else{if(c===null)throw Error(r(310));Tr=c,c={memoizedState:Tr.memoizedState,baseState:Tr.baseState,baseQueue:Tr.baseQueue,queue:Tr.queue,next:null},$r===null?ir.memoizedState=$r=c:$r=$r.next=c}return $r}function lu(c,u){return typeof u=="function"?u(c):u}function Cp(c){var u=ga(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=c;var w=Tr,E=w.baseQueue,A=p.pending;if(A!==null){if(E!==null){var I=E.next;E.next=A.next,A.next=I}w.baseQueue=E=A,p.pending=null}if(E!==null){A=E.next,w=w.baseState;var ie=I=null,ce=null,Se=A;do{var Oe=Se.lane;if((po&Oe)===Oe)ce!==null&&(ce=ce.next={lane:0,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null}),w=Se.hasEagerState?Se.eagerState:c(w,Se.action);else{var De={lane:Oe,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null};ce===null?(ie=ce=De,I=w):ce=ce.next=De,ir.lanes|=Oe,xo|=Oe}Se=Se.next}while(Se!==null&&Se!==A);ce===null?I=w:ce.next=ie,za(w,u.memoizedState)||(Ln=!0),u.memoizedState=w,u.baseState=I,u.baseQueue=ce,p.lastRenderedState=w}if(c=p.interleaved,c!==null){E=c;do A=E.lane,ir.lanes|=A,xo|=A,E=E.next;while(E!==c)}else E===null&&(p.lanes=0);return[u.memoizedState,p.dispatch]}function Ap(c){var u=ga(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=c;var w=p.dispatch,E=p.pending,A=u.memoizedState;if(E!==null){p.pending=null;var I=E=E.next;do A=c(A,I.action),I=I.next;while(I!==E);za(A,u.memoizedState)||(Ln=!0),u.memoizedState=A,u.baseQueue===null&&(u.baseState=A),p.lastRenderedState=A}return[A,w]}function g2(){}function v2(c,u){var p=ir,w=ga(),E=u(),A=!za(w.memoizedState,E);if(A&&(w.memoizedState=E,Ln=!0),w=w.queue,Tp(w2.bind(null,p,w,c),[c]),w.getSnapshot!==u||A||$r!==null&&$r.memoizedState.tag&1){if(p.flags|=2048,cu(9,b2.bind(null,p,w,E,u),void 0,null),Ur===null)throw Error(r(349));(po&30)!==0||y2(p,u,E)}return E}function y2(c,u,p){c.flags|=16384,c={getSnapshot:u,value:p},u=ir.updateQueue,u===null?(u={lastEffect:null,stores:null},ir.updateQueue=u,u.stores=[c]):(p=u.stores,p===null?u.stores=[c]:p.push(c))}function b2(c,u,p,w){u.value=p,u.getSnapshot=w,S2(u)&&N2(c)}function w2(c,u,p){return p(function(){S2(u)&&N2(c)})}function S2(c){var u=c.getSnapshot;c=c.value;try{var p=u();return!za(c,p)}catch{return!0}}function N2(c){var u=Ci(c,1);u!==null&&Ga(u,c,1,-1)}function E2(c){var u=oi();return typeof c=="function"&&(c=c()),u.memoizedState=u.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:lu,lastRenderedState:c},u.queue=c,c=c.dispatch=kF.bind(null,ir,c),[u.memoizedState,c]}function cu(c,u,p,w){return c={tag:c,create:u,destroy:p,deps:w,next:null},u=ir.updateQueue,u===null?(u={lastEffect:null,stores:null},ir.updateQueue=u,u.lastEffect=c.next=c):(p=u.lastEffect,p===null?u.lastEffect=c.next=c:(w=p.next,p.next=c,c.next=w,u.lastEffect=c)),c}function _2(){return ga().memoizedState}function Td(c,u,p,w){var E=oi();ir.flags|=c,E.memoizedState=cu(1|u,p,void 0,w===void 0?null:w)}function Pd(c,u,p,w){var E=ga();w=w===void 0?null:w;var A=void 0;if(Tr!==null){var I=Tr.memoizedState;if(A=I.destroy,w!==null&&_p(w,I.deps)){E.memoizedState=cu(u,p,A,w);return}}ir.flags|=c,E.memoizedState=cu(1|u,p,A,w)}function k2(c,u){return Td(8390656,8,c,u)}function Tp(c,u){return Pd(2048,8,c,u)}function j2(c,u){return Pd(4,2,c,u)}function C2(c,u){return Pd(4,4,c,u)}function A2(c,u){if(typeof u=="function")return c=c(),u(c),function(){u(null)};if(u!=null)return c=c(),u.current=c,function(){u.current=null}}function T2(c,u,p){return p=p!=null?p.concat([c]):null,Pd(4,4,A2.bind(null,u,c),p)}function Pp(){}function P2(c,u){var p=ga();u=u===void 0?null:u;var w=p.memoizedState;return w!==null&&u!==null&&_p(u,w[1])?w[0]:(p.memoizedState=[c,u],c)}function O2(c,u){var p=ga();u=u===void 0?null:u;var w=p.memoizedState;return w!==null&&u!==null&&_p(u,w[1])?w[0]:(c=c(),p.memoizedState=[c,u],c)}function F2(c,u,p){return(po&21)===0?(c.baseState&&(c.baseState=!1,Ln=!0),c.memoizedState=p):(za(p,u)||(p=cw(),ir.lanes|=p,xo|=p,c.baseState=!0),u)}function EF(c,u){var p=Tt;Tt=p!==0&&4>p?p:4,c(!0);var w=Ep.transition;Ep.transition={};try{c(!1),u()}finally{Tt=p,Ep.transition=w}}function D2(){return ga().memoizedState}function _F(c,u,p){var w=Es(c);if(p={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null},I2(c))M2(u,p);else if(p=d2(c,u,p,w),p!==null){var E=kn();Ga(p,c,w,E),R2(p,u,w)}}function kF(c,u,p){var w=Es(c),E={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null};if(I2(c))M2(u,E);else{var A=c.alternate;if(c.lanes===0&&(A===null||A.lanes===0)&&(A=u.lastRenderedReducer,A!==null))try{var I=u.lastRenderedState,ie=A(I,p);if(E.hasEagerState=!0,E.eagerState=ie,za(ie,I)){var ce=u.interleaved;ce===null?(E.next=E,vp(u)):(E.next=ce.next,ce.next=E),u.interleaved=E;return}}catch{}finally{}p=d2(c,u,E,w),p!==null&&(E=kn(),Ga(p,c,w,E),R2(p,u,w))}}function I2(c){var u=c.alternate;return c===ir||u!==null&&u===ir}function M2(c,u){su=Ad=!0;var p=c.pending;p===null?u.next=u:(u.next=p.next,p.next=u),c.pending=u}function R2(c,u,p){if((p&4194240)!==0){var w=u.lanes;w&=c.pendingLanes,p|=w,u.lanes=p,Fm(c,p)}}var Od={readContext:xa,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},jF={readContext:xa,useCallback:function(c,u){return oi().memoizedState=[c,u===void 0?null:u],c},useContext:xa,useEffect:k2,useImperativeHandle:function(c,u,p){return p=p!=null?p.concat([c]):null,Td(4194308,4,A2.bind(null,u,c),p)},useLayoutEffect:function(c,u){return Td(4194308,4,c,u)},useInsertionEffect:function(c,u){return Td(4,2,c,u)},useMemo:function(c,u){var p=oi();return u=u===void 0?null:u,c=c(),p.memoizedState=[c,u],c},useReducer:function(c,u,p){var w=oi();return u=p!==void 0?p(u):u,w.memoizedState=w.baseState=u,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:u},w.queue=c,c=c.dispatch=_F.bind(null,ir,c),[w.memoizedState,c]},useRef:function(c){var u=oi();return c={current:c},u.memoizedState=c},useState:E2,useDebugValue:Pp,useDeferredValue:function(c){return oi().memoizedState=c},useTransition:function(){var c=E2(!1),u=c[0];return c=EF.bind(null,c[1]),oi().memoizedState=c,[u,c]},useMutableSource:function(){},useSyncExternalStore:function(c,u,p){var w=ir,E=oi();if(Jt){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),Ur===null)throw Error(r(349));(po&30)!==0||y2(w,u,p)}E.memoizedState=p;var A={value:p,getSnapshot:u};return E.queue=A,k2(w2.bind(null,w,A,c),[c]),w.flags|=2048,cu(9,b2.bind(null,w,A,p,u),void 0,null),p},useId:function(){var c=oi(),u=Ur.identifierPrefix;if(Jt){var p=ji,w=ki;p=(w&~(1<<32-pr(w)-1)).toString(32)+p,u=":"+u+"R"+p,p=ou++,0<p&&(u+="H"+p.toString(32)),u+=":"}else p=NF++,u=":"+u+"r"+p.toString(32)+":";return c.memoizedState=u},unstable_isNewReconciler:!1},CF={readContext:xa,useCallback:P2,useContext:xa,useEffect:Tp,useImperativeHandle:T2,useInsertionEffect:j2,useLayoutEffect:C2,useMemo:O2,useReducer:Cp,useRef:_2,useState:function(){return Cp(lu)},useDebugValue:Pp,useDeferredValue:function(c){var u=ga();return F2(u,Tr.memoizedState,c)},useTransition:function(){var c=Cp(lu)[0],u=ga().memoizedState;return[c,u]},useMutableSource:g2,useSyncExternalStore:v2,useId:D2,unstable_isNewReconciler:!1},AF={readContext:xa,useCallback:P2,useContext:xa,useEffect:Tp,useImperativeHandle:T2,useInsertionEffect:j2,useLayoutEffect:C2,useMemo:O2,useReducer:Ap,useRef:_2,useState:function(){return Ap(lu)},useDebugValue:Pp,useDeferredValue:function(c){var u=ga();return Tr===null?u.memoizedState=c:F2(u,Tr.memoizedState,c)},useTransition:function(){var c=Ap(lu)[0],u=ga().memoizedState;return[c,u]},useMutableSource:g2,useSyncExternalStore:v2,useId:D2,unstable_isNewReconciler:!1};function Ha(c,u){if(c&&c.defaultProps){u=me({},u),c=c.defaultProps;for(var p in c)u[p]===void 0&&(u[p]=c[p]);return u}return u}function Op(c,u,p,w){u=c.memoizedState,p=p(w,u),p=p==null?u:me({},u,p),c.memoizedState=p,c.lanes===0&&(c.updateQueue.baseState=p)}var Fd={isMounted:function(c){return(c=c._reactInternals)?re(c)===c:!1},enqueueSetState:function(c,u,p){c=c._reactInternals;var w=kn(),E=Es(c),A=Ai(w,E);A.payload=u,p!=null&&(A.callback=p),u=bs(c,A,E),u!==null&&(Ga(u,c,E,w),_d(u,c,E))},enqueueReplaceState:function(c,u,p){c=c._reactInternals;var w=kn(),E=Es(c),A=Ai(w,E);A.tag=1,A.payload=u,p!=null&&(A.callback=p),u=bs(c,A,E),u!==null&&(Ga(u,c,E,w),_d(u,c,E))},enqueueForceUpdate:function(c,u){c=c._reactInternals;var p=kn(),w=Es(c),E=Ai(p,w);E.tag=2,u!=null&&(E.callback=u),u=bs(c,E,w),u!==null&&(Ga(u,c,w,p),_d(u,c,w))}};function L2(c,u,p,w,E,A,I){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(w,A,I):u.prototype&&u.prototype.isPureReactComponent?!Xc(p,w)||!Xc(E,A):!0}function B2(c,u,p){var w=!1,E=gs,A=u.contextType;return typeof A=="object"&&A!==null?A=xa(A):(E=Rn(u)?co:cn.current,w=u.contextTypes,A=(w=w!=null)?Sl(c,E):gs),u=new u(p,A),c.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=Fd,c.stateNode=u,u._reactInternals=c,w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=E,c.__reactInternalMemoizedMaskedChildContext=A),u}function $2(c,u,p,w){c=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,w),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,w),u.state!==c&&Fd.enqueueReplaceState(u,u.state,null)}function Fp(c,u,p,w){var E=c.stateNode;E.props=p,E.state=c.memoizedState,E.refs={},yp(c);var A=u.contextType;typeof A=="object"&&A!==null?E.context=xa(A):(A=Rn(u)?co:cn.current,E.context=Sl(c,A)),E.state=c.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(Op(c,u,A,p),E.state=c.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(u=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),u!==E.state&&Fd.enqueueReplaceState(E,E.state,null),kd(c,p,E,w),E.state=c.memoizedState),typeof E.componentDidMount=="function"&&(c.flags|=4194308)}function Tl(c,u){try{var p="",w=u;do p+=L(w),w=w.return;while(w);var E=p}catch(A){E=`
Error generating stack: `+A.message+`
`+A.stack}return{value:c,source:u,stack:E,digest:null}}function Dp(c,u,p){return{value:c,source:null,stack:p??null,digest:u??null}}function Ip(c,u){try{console.error(u.value)}catch(p){setTimeout(function(){throw p})}}var TF=typeof WeakMap=="function"?WeakMap:Map;function U2(c,u,p){p=Ai(-1,p),p.tag=3,p.payload={element:null};var w=u.value;return p.callback=function(){$d||($d=!0,Yp=w),Ip(c,u)},p}function z2(c,u,p){p=Ai(-1,p),p.tag=3;var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var E=u.value;p.payload=function(){return w(E)},p.callback=function(){Ip(c,u)}}var A=c.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(p.callback=function(){Ip(c,u),typeof w!="function"&&(Ss===null?Ss=new Set([this]):Ss.add(this));var I=u.stack;this.componentDidCatch(u.value,{componentStack:I!==null?I:""})}),p}function W2(c,u,p){var w=c.pingCache;if(w===null){w=c.pingCache=new TF;var E=new Set;w.set(u,E)}else E=w.get(u),E===void 0&&(E=new Set,w.set(u,E));E.has(p)||(E.add(p),c=HF.bind(null,c,u,p),u.then(c,c))}function H2(c){do{var u;if((u=c.tag===13)&&(u=c.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return c;c=c.return}while(c!==null);return null}function V2(c,u,p,w,E){return(c.mode&1)===0?(c===u?c.flags|=65536:(c.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(u=Ai(-1,1),u.tag=2,bs(p,u,1))),p.lanes|=1),c):(c.flags|=65536,c.lanes=E,c)}var PF=C.ReactCurrentOwner,Ln=!1;function _n(c,u,p,w){u.child=c===null?f2(u,null,p,w):kl(u,c.child,p,w)}function K2(c,u,p,w,E){p=p.render;var A=u.ref;return Cl(u,E),w=kp(c,u,p,w,A,E),p=jp(),c!==null&&!Ln?(u.updateQueue=c.updateQueue,u.flags&=-2053,c.lanes&=~E,Ti(c,u,E)):(Jt&&p&&cp(u),u.flags|=1,_n(c,u,w,E),u.child)}function G2(c,u,p,w,E){if(c===null){var A=p.type;return typeof A=="function"&&!nx(A)&&A.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(u.tag=15,u.type=A,q2(c,u,A,w,E)):(c=Kd(p.type,null,w,u,u.mode,E),c.ref=u.ref,c.return=u,u.child=c)}if(A=c.child,(c.lanes&E)===0){var I=A.memoizedProps;if(p=p.compare,p=p!==null?p:Xc,p(I,w)&&c.ref===u.ref)return Ti(c,u,E)}return u.flags|=1,c=ks(A,w),c.ref=u.ref,c.return=u,u.child=c}function q2(c,u,p,w,E){if(c!==null){var A=c.memoizedProps;if(Xc(A,w)&&c.ref===u.ref)if(Ln=!1,u.pendingProps=w=A,(c.lanes&E)!==0)(c.flags&131072)!==0&&(Ln=!0);else return u.lanes=c.lanes,Ti(c,u,E)}return Mp(c,u,p,w,E)}function X2(c,u,p){var w=u.pendingProps,E=w.children,A=c!==null?c.memoizedState:null;if(w.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},zt(Ol,Qn),Qn|=p;else{if((p&1073741824)===0)return c=A!==null?A.baseLanes|p:p,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:c,cachePool:null,transitions:null},u.updateQueue=null,zt(Ol,Qn),Qn|=c,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=A!==null?A.baseLanes:p,zt(Ol,Qn),Qn|=w}else A!==null?(w=A.baseLanes|p,u.memoizedState=null):w=p,zt(Ol,Qn),Qn|=w;return _n(c,u,E,p),u.child}function Y2(c,u){var p=u.ref;(c===null&&p!==null||c!==null&&c.ref!==p)&&(u.flags|=512,u.flags|=2097152)}function Mp(c,u,p,w,E){var A=Rn(p)?co:cn.current;return A=Sl(u,A),Cl(u,E),p=kp(c,u,p,w,A,E),w=jp(),c!==null&&!Ln?(u.updateQueue=c.updateQueue,u.flags&=-2053,c.lanes&=~E,Ti(c,u,E)):(Jt&&w&&cp(u),u.flags|=1,_n(c,u,p,E),u.child)}function J2(c,u,p,w,E){if(Rn(p)){var A=!0;gd(u)}else A=!1;if(Cl(u,E),u.stateNode===null)Id(c,u),B2(u,p,w),Fp(u,p,w,E),w=!0;else if(c===null){var I=u.stateNode,ie=u.memoizedProps;I.props=ie;var ce=I.context,Se=p.contextType;typeof Se=="object"&&Se!==null?Se=xa(Se):(Se=Rn(p)?co:cn.current,Se=Sl(u,Se));var Oe=p.getDerivedStateFromProps,De=typeof Oe=="function"||typeof I.getSnapshotBeforeUpdate=="function";De||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(ie!==w||ce!==Se)&&$2(u,I,w,Se),ys=!1;var Ce=u.memoizedState;I.state=Ce,kd(u,w,I,E),ce=u.memoizedState,ie!==w||Ce!==ce||Mn.current||ys?(typeof Oe=="function"&&(Op(u,p,Oe,w),ce=u.memoizedState),(ie=ys||L2(u,p,ie,w,Ce,ce,Se))?(De||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(u.flags|=4194308)):(typeof I.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=w,u.memoizedState=ce),I.props=w,I.state=ce,I.context=Se,w=ie):(typeof I.componentDidMount=="function"&&(u.flags|=4194308),w=!1)}else{I=u.stateNode,h2(c,u),ie=u.memoizedProps,Se=u.type===u.elementType?ie:Ha(u.type,ie),I.props=Se,De=u.pendingProps,Ce=I.context,ce=p.contextType,typeof ce=="object"&&ce!==null?ce=xa(ce):(ce=Rn(p)?co:cn.current,ce=Sl(u,ce));var He=p.getDerivedStateFromProps;(Oe=typeof He=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(ie!==De||Ce!==ce)&&$2(u,I,w,ce),ys=!1,Ce=u.memoizedState,I.state=Ce,kd(u,w,I,E);var Xe=u.memoizedState;ie!==De||Ce!==Xe||Mn.current||ys?(typeof He=="function"&&(Op(u,p,He,w),Xe=u.memoizedState),(Se=ys||L2(u,p,Se,w,Ce,Xe,ce)||!1)?(Oe||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(w,Xe,ce),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(w,Xe,ce)),typeof I.componentDidUpdate=="function"&&(u.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof I.componentDidUpdate!="function"||ie===c.memoizedProps&&Ce===c.memoizedState||(u.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||ie===c.memoizedProps&&Ce===c.memoizedState||(u.flags|=1024),u.memoizedProps=w,u.memoizedState=Xe),I.props=w,I.state=Xe,I.context=ce,w=Se):(typeof I.componentDidUpdate!="function"||ie===c.memoizedProps&&Ce===c.memoizedState||(u.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||ie===c.memoizedProps&&Ce===c.memoizedState||(u.flags|=1024),w=!1)}return Rp(c,u,p,w,A,E)}function Rp(c,u,p,w,E,A){Y2(c,u);var I=(u.flags&128)!==0;if(!w&&!I)return E&&r2(u,p,!1),Ti(c,u,A);w=u.stateNode,PF.current=u;var ie=I&&typeof p.getDerivedStateFromError!="function"?null:w.render();return u.flags|=1,c!==null&&I?(u.child=kl(u,c.child,null,A),u.child=kl(u,null,ie,A)):_n(c,u,ie,A),u.memoizedState=w.state,E&&r2(u,p,!0),u.child}function Q2(c){var u=c.stateNode;u.pendingContext?e2(c,u.pendingContext,u.pendingContext!==u.context):u.context&&e2(c,u.context,!1),bp(c,u.containerInfo)}function Z2(c,u,p,w,E){return _l(),hp(E),u.flags|=256,_n(c,u,p,w),u.child}var Lp={dehydrated:null,treeContext:null,retryLane:0};function Bp(c){return{baseLanes:c,cachePool:null,transitions:null}}function eS(c,u,p){var w=u.pendingProps,E=ar.current,A=!1,I=(u.flags&128)!==0,ie;if((ie=I)||(ie=c!==null&&c.memoizedState===null?!1:(E&2)!==0),ie?(A=!0,u.flags&=-129):(c===null||c.memoizedState!==null)&&(E|=1),zt(ar,E&1),c===null)return dp(u),c=u.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((u.mode&1)===0?u.lanes=1:c.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(I=w.children,c=w.fallback,A?(w=u.mode,A=u.child,I={mode:"hidden",children:I},(w&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=I):A=Gd(I,w,0,null),c=bo(c,w,p,null),A.return=u,c.return=u,A.sibling=c,u.child=A,u.child.memoizedState=Bp(p),u.memoizedState=Lp,c):$p(u,I));if(E=c.memoizedState,E!==null&&(ie=E.dehydrated,ie!==null))return OF(c,u,I,w,ie,E,p);if(A){A=w.fallback,I=u.mode,E=c.child,ie=E.sibling;var ce={mode:"hidden",children:w.children};return(I&1)===0&&u.child!==E?(w=u.child,w.childLanes=0,w.pendingProps=ce,u.deletions=null):(w=ks(E,ce),w.subtreeFlags=E.subtreeFlags&14680064),ie!==null?A=ks(ie,A):(A=bo(A,I,p,null),A.flags|=2),A.return=u,w.return=u,w.sibling=A,u.child=w,w=A,A=u.child,I=c.child.memoizedState,I=I===null?Bp(p):{baseLanes:I.baseLanes|p,cachePool:null,transitions:I.transitions},A.memoizedState=I,A.childLanes=c.childLanes&~p,u.memoizedState=Lp,w}return A=c.child,c=A.sibling,w=ks(A,{mode:"visible",children:w.children}),(u.mode&1)===0&&(w.lanes=p),w.return=u,w.sibling=null,c!==null&&(p=u.deletions,p===null?(u.deletions=[c],u.flags|=16):p.push(c)),u.child=w,u.memoizedState=null,w}function $p(c,u){return u=Gd({mode:"visible",children:u},c.mode,0,null),u.return=c,c.child=u}function Dd(c,u,p,w){return w!==null&&hp(w),kl(u,c.child,null,p),c=$p(u,u.pendingProps.children),c.flags|=2,u.memoizedState=null,c}function OF(c,u,p,w,E,A,I){if(p)return u.flags&256?(u.flags&=-257,w=Dp(Error(r(422))),Dd(c,u,I,w)):u.memoizedState!==null?(u.child=c.child,u.flags|=128,null):(A=w.fallback,E=u.mode,w=Gd({mode:"visible",children:w.children},E,0,null),A=bo(A,E,I,null),A.flags|=2,w.return=u,A.return=u,w.sibling=A,u.child=w,(u.mode&1)!==0&&kl(u,c.child,null,I),u.child.memoizedState=Bp(I),u.memoizedState=Lp,A);if((u.mode&1)===0)return Dd(c,u,I,null);if(E.data==="$!"){if(w=E.nextSibling&&E.nextSibling.dataset,w)var ie=w.dgst;return w=ie,A=Error(r(419)),w=Dp(A,w,void 0),Dd(c,u,I,w)}if(ie=(I&c.childLanes)!==0,Ln||ie){if(w=Ur,w!==null){switch(I&-I){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(w.suspendedLanes|I))!==0?0:E,E!==0&&E!==A.retryLane&&(A.retryLane=E,Ci(c,E),Ga(w,c,E,-1))}return rx(),w=Dp(Error(r(421))),Dd(c,u,I,w)}return E.data==="$?"?(u.flags|=128,u.child=c.child,u=VF.bind(null,c),E._reactRetry=u,null):(c=A.treeContext,Jn=ps(E.nextSibling),Yn=u,Jt=!0,Wa=null,c!==null&&(ma[pa++]=ki,ma[pa++]=ji,ma[pa++]=uo,ki=c.id,ji=c.overflow,uo=u),u=$p(u,w.children),u.flags|=4096,u)}function tS(c,u,p){c.lanes|=u;var w=c.alternate;w!==null&&(w.lanes|=u),gp(c.return,u,p)}function Up(c,u,p,w,E){var A=c.memoizedState;A===null?c.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:E}:(A.isBackwards=u,A.rendering=null,A.renderingStartTime=0,A.last=w,A.tail=p,A.tailMode=E)}function rS(c,u,p){var w=u.pendingProps,E=w.revealOrder,A=w.tail;if(_n(c,u,w.children,p),w=ar.current,(w&2)!==0)w=w&1|2,u.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=u.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&tS(c,p,u);else if(c.tag===19)tS(c,p,u);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===u)break e;for(;c.sibling===null;){if(c.return===null||c.return===u)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}w&=1}if(zt(ar,w),(u.mode&1)===0)u.memoizedState=null;else switch(E){case"forwards":for(p=u.child,E=null;p!==null;)c=p.alternate,c!==null&&jd(c)===null&&(E=p),p=p.sibling;p=E,p===null?(E=u.child,u.child=null):(E=p.sibling,p.sibling=null),Up(u,!1,E,p,A);break;case"backwards":for(p=null,E=u.child,u.child=null;E!==null;){if(c=E.alternate,c!==null&&jd(c)===null){u.child=E;break}c=E.sibling,E.sibling=p,p=E,E=c}Up(u,!0,p,null,A);break;case"together":Up(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Id(c,u){(u.mode&1)===0&&c!==null&&(c.alternate=null,u.alternate=null,u.flags|=2)}function Ti(c,u,p){if(c!==null&&(u.dependencies=c.dependencies),xo|=u.lanes,(p&u.childLanes)===0)return null;if(c!==null&&u.child!==c.child)throw Error(r(153));if(u.child!==null){for(c=u.child,p=ks(c,c.pendingProps),u.child=p,p.return=u;c.sibling!==null;)c=c.sibling,p=p.sibling=ks(c,c.pendingProps),p.return=u;p.sibling=null}return u.child}function FF(c,u,p){switch(u.tag){case 3:Q2(u),_l();break;case 5:x2(u);break;case 1:Rn(u.type)&&gd(u);break;case 4:bp(u,u.stateNode.containerInfo);break;case 10:var w=u.type._context,E=u.memoizedProps.value;zt(Nd,w._currentValue),w._currentValue=E;break;case 13:if(w=u.memoizedState,w!==null)return w.dehydrated!==null?(zt(ar,ar.current&1),u.flags|=128,null):(p&u.child.childLanes)!==0?eS(c,u,p):(zt(ar,ar.current&1),c=Ti(c,u,p),c!==null?c.sibling:null);zt(ar,ar.current&1);break;case 19:if(w=(p&u.childLanes)!==0,(c.flags&128)!==0){if(w)return rS(c,u,p);u.flags|=128}if(E=u.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),zt(ar,ar.current),w)break;return null;case 22:case 23:return u.lanes=0,X2(c,u,p)}return Ti(c,u,p)}var nS,zp,aS,iS;nS=function(c,u){for(var p=u.child;p!==null;){if(p.tag===5||p.tag===6)c.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},zp=function(){},aS=function(c,u,p,w){var E=c.memoizedProps;if(E!==w){c=u.stateNode,mo(si.current);var A=null;switch(p){case"input":E=Ae(c,E),w=Ae(c,w),A=[];break;case"select":E=me({},E,{value:void 0}),w=me({},w,{value:void 0}),A=[];break;case"textarea":E=Ua(c,E),w=Ua(c,w),A=[];break;default:typeof E.onClick!="function"&&typeof w.onClick=="function"&&(c.onclick=md)}ze(p,w);var I;p=null;for(Se in E)if(!w.hasOwnProperty(Se)&&E.hasOwnProperty(Se)&&E[Se]!=null)if(Se==="style"){var ie=E[Se];for(I in ie)ie.hasOwnProperty(I)&&(p||(p={}),p[I]="")}else Se!=="dangerouslySetInnerHTML"&&Se!=="children"&&Se!=="suppressContentEditableWarning"&&Se!=="suppressHydrationWarning"&&Se!=="autoFocus"&&(a.hasOwnProperty(Se)?A||(A=[]):(A=A||[]).push(Se,null));for(Se in w){var ce=w[Se];if(ie=E?.[Se],w.hasOwnProperty(Se)&&ce!==ie&&(ce!=null||ie!=null))if(Se==="style")if(ie){for(I in ie)!ie.hasOwnProperty(I)||ce&&ce.hasOwnProperty(I)||(p||(p={}),p[I]="");for(I in ce)ce.hasOwnProperty(I)&&ie[I]!==ce[I]&&(p||(p={}),p[I]=ce[I])}else p||(A||(A=[]),A.push(Se,p)),p=ce;else Se==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ie=ie?ie.__html:void 0,ce!=null&&ie!==ce&&(A=A||[]).push(Se,ce)):Se==="children"?typeof ce!="string"&&typeof ce!="number"||(A=A||[]).push(Se,""+ce):Se!=="suppressContentEditableWarning"&&Se!=="suppressHydrationWarning"&&(a.hasOwnProperty(Se)?(ce!=null&&Se==="onScroll"&&Ht("scroll",c),A||ie===ce||(A=[])):(A=A||[]).push(Se,ce))}p&&(A=A||[]).push("style",p);var Se=A;(u.updateQueue=Se)&&(u.flags|=4)}},iS=function(c,u,p,w){p!==w&&(u.flags|=4)};function uu(c,u){if(!Jt)switch(c.tailMode){case"hidden":u=c.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?c.tail=null:p.sibling=null;break;case"collapsed":p=c.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?u||c.tail===null?c.tail=null:c.tail.sibling=null:w.sibling=null}}function fn(c){var u=c.alternate!==null&&c.alternate.child===c.child,p=0,w=0;if(u)for(var E=c.child;E!==null;)p|=E.lanes|E.childLanes,w|=E.subtreeFlags&14680064,w|=E.flags&14680064,E.return=c,E=E.sibling;else for(E=c.child;E!==null;)p|=E.lanes|E.childLanes,w|=E.subtreeFlags,w|=E.flags,E.return=c,E=E.sibling;return c.subtreeFlags|=w,c.childLanes=p,u}function DF(c,u,p){var w=u.pendingProps;switch(up(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fn(u),null;case 1:return Rn(u.type)&&xd(),fn(u),null;case 3:return w=u.stateNode,Al(),Vt(Mn),Vt(cn),Np(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(c===null||c.child===null)&&(wd(u)?u.flags|=4:c===null||c.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Wa!==null&&(Zp(Wa),Wa=null))),zp(c,u),fn(u),null;case 5:wp(u);var E=mo(iu.current);if(p=u.type,c!==null&&u.stateNode!=null)aS(c,u,p,w,E),c.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!w){if(u.stateNode===null)throw Error(r(166));return fn(u),null}if(c=mo(si.current),wd(u)){w=u.stateNode,p=u.type;var A=u.memoizedProps;switch(w[ii]=u,w[eu]=A,c=(u.mode&1)!==0,p){case"dialog":Ht("cancel",w),Ht("close",w);break;case"iframe":case"object":case"embed":Ht("load",w);break;case"video":case"audio":for(E=0;E<Jc.length;E++)Ht(Jc[E],w);break;case"source":Ht("error",w);break;case"img":case"image":case"link":Ht("error",w),Ht("load",w);break;case"details":Ht("toggle",w);break;case"input":We(w,A),Ht("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!A.multiple},Ht("invalid",w);break;case"textarea":On(w,A),Ht("invalid",w)}ze(p,A),E=null;for(var I in A)if(A.hasOwnProperty(I)){var ie=A[I];I==="children"?typeof ie=="string"?w.textContent!==ie&&(A.suppressHydrationWarning!==!0&&hd(w.textContent,ie,c),E=["children",ie]):typeof ie=="number"&&w.textContent!==""+ie&&(A.suppressHydrationWarning!==!0&&hd(w.textContent,ie,c),E=["children",""+ie]):a.hasOwnProperty(I)&&ie!=null&&I==="onScroll"&&Ht("scroll",w)}switch(p){case"input":de(w),lt(w,A,!0);break;case"textarea":de(w),rr(w);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(w.onclick=md)}w=E,u.updateQueue=w,w!==null&&(u.flags|=4)}else{I=E.nodeType===9?E:E.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Fn(p)),c==="http://www.w3.org/1999/xhtml"?p==="script"?(c=I.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof w.is=="string"?c=I.createElement(p,{is:w.is}):(c=I.createElement(p),p==="select"&&(I=c,w.multiple?I.multiple=!0:w.size&&(I.size=w.size))):c=I.createElementNS(c,p),c[ii]=u,c[eu]=w,nS(c,u,!1,!1),u.stateNode=c;e:{switch(I=at(p,w),p){case"dialog":Ht("cancel",c),Ht("close",c),E=w;break;case"iframe":case"object":case"embed":Ht("load",c),E=w;break;case"video":case"audio":for(E=0;E<Jc.length;E++)Ht(Jc[E],c);E=w;break;case"source":Ht("error",c),E=w;break;case"img":case"image":case"link":Ht("error",c),Ht("load",c),E=w;break;case"details":Ht("toggle",c),E=w;break;case"input":We(c,w),E=Ae(c,w),Ht("invalid",c);break;case"option":E=w;break;case"select":c._wrapperState={wasMultiple:!!w.multiple},E=me({},w,{value:void 0}),Ht("invalid",c);break;case"textarea":On(c,w),E=Ua(c,w),Ht("invalid",c);break;default:E=w}ze(p,E),ie=E;for(A in ie)if(ie.hasOwnProperty(A)){var ce=ie[A];A==="style"?Ke(c,ce):A==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ce!=null&&En(c,ce)):A==="children"?typeof ce=="string"?(p!=="textarea"||ce!=="")&&ut(c,ce):typeof ce=="number"&&ut(c,""+ce):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(a.hasOwnProperty(A)?ce!=null&&A==="onScroll"&&Ht("scroll",c):ce!=null&&S(c,A,ce,I))}switch(p){case"input":de(c),lt(c,w,!1);break;case"textarea":de(c),rr(c);break;case"option":w.value!=null&&c.setAttribute("value",""+U(w.value));break;case"select":c.multiple=!!w.multiple,A=w.value,A!=null?Ct(c,!!w.multiple,A,!1):w.defaultValue!=null&&Ct(c,!!w.multiple,w.defaultValue,!0);break;default:typeof E.onClick=="function"&&(c.onclick=md)}switch(p){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return fn(u),null;case 6:if(c&&u.stateNode!=null)iS(c,u,c.memoizedProps,w);else{if(typeof w!="string"&&u.stateNode===null)throw Error(r(166));if(p=mo(iu.current),mo(si.current),wd(u)){if(w=u.stateNode,p=u.memoizedProps,w[ii]=u,(A=w.nodeValue!==p)&&(c=Yn,c!==null))switch(c.tag){case 3:hd(w.nodeValue,p,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&hd(w.nodeValue,p,(c.mode&1)!==0)}A&&(u.flags|=4)}else w=(p.nodeType===9?p:p.ownerDocument).createTextNode(w),w[ii]=u,u.stateNode=w}return fn(u),null;case 13:if(Vt(ar),w=u.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Jt&&Jn!==null&&(u.mode&1)!==0&&(u.flags&128)===0)l2(),_l(),u.flags|=98560,A=!1;else if(A=wd(u),w!==null&&w.dehydrated!==null){if(c===null){if(!A)throw Error(r(318));if(A=u.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(r(317));A[ii]=u}else _l(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;fn(u),A=!1}else Wa!==null&&(Zp(Wa),Wa=null),A=!0;if(!A)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=p,u):(w=w!==null,w!==(c!==null&&c.memoizedState!==null)&&w&&(u.child.flags|=8192,(u.mode&1)!==0&&(c===null||(ar.current&1)!==0?Pr===0&&(Pr=3):rx())),u.updateQueue!==null&&(u.flags|=4),fn(u),null);case 4:return Al(),zp(c,u),c===null&&Qc(u.stateNode.containerInfo),fn(u),null;case 10:return xp(u.type._context),fn(u),null;case 17:return Rn(u.type)&&xd(),fn(u),null;case 19:if(Vt(ar),A=u.memoizedState,A===null)return fn(u),null;if(w=(u.flags&128)!==0,I=A.rendering,I===null)if(w)uu(A,!1);else{if(Pr!==0||c!==null&&(c.flags&128)!==0)for(c=u.child;c!==null;){if(I=jd(c),I!==null){for(u.flags|=128,uu(A,!1),w=I.updateQueue,w!==null&&(u.updateQueue=w,u.flags|=4),u.subtreeFlags=0,w=p,p=u.child;p!==null;)A=p,c=w,A.flags&=14680066,I=A.alternate,I===null?(A.childLanes=0,A.lanes=c,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=I.childLanes,A.lanes=I.lanes,A.child=I.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=I.memoizedProps,A.memoizedState=I.memoizedState,A.updateQueue=I.updateQueue,A.type=I.type,c=I.dependencies,A.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),p=p.sibling;return zt(ar,ar.current&1|2),u.child}c=c.sibling}A.tail!==null&&Ie()>Fl&&(u.flags|=128,w=!0,uu(A,!1),u.lanes=4194304)}else{if(!w)if(c=jd(I),c!==null){if(u.flags|=128,w=!0,p=c.updateQueue,p!==null&&(u.updateQueue=p,u.flags|=4),uu(A,!0),A.tail===null&&A.tailMode==="hidden"&&!I.alternate&&!Jt)return fn(u),null}else 2*Ie()-A.renderingStartTime>Fl&&p!==1073741824&&(u.flags|=128,w=!0,uu(A,!1),u.lanes=4194304);A.isBackwards?(I.sibling=u.child,u.child=I):(p=A.last,p!==null?p.sibling=I:u.child=I,A.last=I)}return A.tail!==null?(u=A.tail,A.rendering=u,A.tail=u.sibling,A.renderingStartTime=Ie(),u.sibling=null,p=ar.current,zt(ar,w?p&1|2:p&1),u):(fn(u),null);case 22:case 23:return tx(),w=u.memoizedState!==null,c!==null&&c.memoizedState!==null!==w&&(u.flags|=8192),w&&(u.mode&1)!==0?(Qn&1073741824)!==0&&(fn(u),u.subtreeFlags&6&&(u.flags|=8192)):fn(u),null;case 24:return null;case 25:return null}throw Error(r(156,u.tag))}function IF(c,u){switch(up(u),u.tag){case 1:return Rn(u.type)&&xd(),c=u.flags,c&65536?(u.flags=c&-65537|128,u):null;case 3:return Al(),Vt(Mn),Vt(cn),Np(),c=u.flags,(c&65536)!==0&&(c&128)===0?(u.flags=c&-65537|128,u):null;case 5:return wp(u),null;case 13:if(Vt(ar),c=u.memoizedState,c!==null&&c.dehydrated!==null){if(u.alternate===null)throw Error(r(340));_l()}return c=u.flags,c&65536?(u.flags=c&-65537|128,u):null;case 19:return Vt(ar),null;case 4:return Al(),null;case 10:return xp(u.type._context),null;case 22:case 23:return tx(),null;case 24:return null;default:return null}}var Md=!1,dn=!1,MF=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function Pl(c,u){var p=c.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(w){cr(c,u,w)}else p.current=null}function Wp(c,u,p){try{p()}catch(w){cr(c,u,w)}}var sS=!1;function RF(c,u){if(tp=rd,c=Lw(),Gm(c)){if("selectionStart"in c)var p={start:c.selectionStart,end:c.selectionEnd};else e:{p=(p=c.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var E=w.anchorOffset,A=w.focusNode;w=w.focusOffset;try{p.nodeType,A.nodeType}catch{p=null;break e}var I=0,ie=-1,ce=-1,Se=0,Oe=0,De=c,Ce=null;t:for(;;){for(var He;De!==p||E!==0&&De.nodeType!==3||(ie=I+E),De!==A||w!==0&&De.nodeType!==3||(ce=I+w),De.nodeType===3&&(I+=De.nodeValue.length),(He=De.firstChild)!==null;)Ce=De,De=He;for(;;){if(De===c)break t;if(Ce===p&&++Se===E&&(ie=I),Ce===A&&++Oe===w&&(ce=I),(He=De.nextSibling)!==null)break;De=Ce,Ce=De.parentNode}De=He}p=ie===-1||ce===-1?null:{start:ie,end:ce}}else p=null}p=p||{start:0,end:0}}else p=null;for(rp={focusedElem:c,selectionRange:p},rd=!1,Ge=u;Ge!==null;)if(u=Ge,c=u.child,(u.subtreeFlags&1028)!==0&&c!==null)c.return=u,Ge=c;else for(;Ge!==null;){u=Ge;try{var Xe=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var Ye=Xe.memoizedProps,xr=Xe.memoizedState,xe=u.stateNode,he=xe.getSnapshotBeforeUpdate(u.elementType===u.type?Ye:Ha(u.type,Ye),xr);xe.__reactInternalSnapshotBeforeUpdate=he}break;case 3:var ge=u.stateNode.containerInfo;ge.nodeType===1?ge.textContent="":ge.nodeType===9&&ge.documentElement&&ge.removeChild(ge.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Re){cr(u,u.return,Re)}if(c=u.sibling,c!==null){c.return=u.return,Ge=c;break}Ge=u.return}return Xe=sS,sS=!1,Xe}function fu(c,u,p){var w=u.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var E=w=w.next;do{if((E.tag&c)===c){var A=E.destroy;E.destroy=void 0,A!==void 0&&Wp(u,p,A)}E=E.next}while(E!==w)}}function Rd(c,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var p=u=u.next;do{if((p.tag&c)===c){var w=p.create;p.destroy=w()}p=p.next}while(p!==u)}}function Hp(c){var u=c.ref;if(u!==null){var p=c.stateNode;switch(c.tag){case 5:c=p;break;default:c=p}typeof u=="function"?u(c):u.current=c}}function oS(c){var u=c.alternate;u!==null&&(c.alternate=null,oS(u)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(u=c.stateNode,u!==null&&(delete u[ii],delete u[eu],delete u[sp],delete u[yF],delete u[bF])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function lS(c){return c.tag===5||c.tag===3||c.tag===4}function cS(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||lS(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function Vp(c,u,p){var w=c.tag;if(w===5||w===6)c=c.stateNode,u?p.nodeType===8?p.parentNode.insertBefore(c,u):p.insertBefore(c,u):(p.nodeType===8?(u=p.parentNode,u.insertBefore(c,p)):(u=p,u.appendChild(c)),p=p._reactRootContainer,p!=null||u.onclick!==null||(u.onclick=md));else if(w!==4&&(c=c.child,c!==null))for(Vp(c,u,p),c=c.sibling;c!==null;)Vp(c,u,p),c=c.sibling}function Kp(c,u,p){var w=c.tag;if(w===5||w===6)c=c.stateNode,u?p.insertBefore(c,u):p.appendChild(c);else if(w!==4&&(c=c.child,c!==null))for(Kp(c,u,p),c=c.sibling;c!==null;)Kp(c,u,p),c=c.sibling}var en=null,Va=!1;function ws(c,u,p){for(p=p.child;p!==null;)uS(c,u,p),p=p.sibling}function uS(c,u,p){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(ai,p)}catch{}switch(p.tag){case 5:dn||Pl(p,u);case 6:var w=en,E=Va;en=null,ws(c,u,p),en=w,Va=E,en!==null&&(Va?(c=en,p=p.stateNode,c.nodeType===8?c.parentNode.removeChild(p):c.removeChild(p)):en.removeChild(p.stateNode));break;case 18:en!==null&&(Va?(c=en,p=p.stateNode,c.nodeType===8?ip(c.parentNode,p):c.nodeType===1&&ip(c,p),Wc(c)):ip(en,p.stateNode));break;case 4:w=en,E=Va,en=p.stateNode.containerInfo,Va=!0,ws(c,u,p),en=w,Va=E;break;case 0:case 11:case 14:case 15:if(!dn&&(w=p.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){E=w=w.next;do{var A=E,I=A.destroy;A=A.tag,I!==void 0&&((A&2)!==0||(A&4)!==0)&&Wp(p,u,I),E=E.next}while(E!==w)}ws(c,u,p);break;case 1:if(!dn&&(Pl(p,u),w=p.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=p.memoizedProps,w.state=p.memoizedState,w.componentWillUnmount()}catch(ie){cr(p,u,ie)}ws(c,u,p);break;case 21:ws(c,u,p);break;case 22:p.mode&1?(dn=(w=dn)||p.memoizedState!==null,ws(c,u,p),dn=w):ws(c,u,p);break;default:ws(c,u,p)}}function fS(c){var u=c.updateQueue;if(u!==null){c.updateQueue=null;var p=c.stateNode;p===null&&(p=c.stateNode=new MF),u.forEach(function(w){var E=KF.bind(null,c,w);p.has(w)||(p.add(w),w.then(E,E))})}}function Ka(c,u){var p=u.deletions;if(p!==null)for(var w=0;w<p.length;w++){var E=p[w];try{var A=c,I=u,ie=I;e:for(;ie!==null;){switch(ie.tag){case 5:en=ie.stateNode,Va=!1;break e;case 3:en=ie.stateNode.containerInfo,Va=!0;break e;case 4:en=ie.stateNode.containerInfo,Va=!0;break e}ie=ie.return}if(en===null)throw Error(r(160));uS(A,I,E),en=null,Va=!1;var ce=E.alternate;ce!==null&&(ce.return=null),E.return=null}catch(Se){cr(E,u,Se)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)dS(u,c),u=u.sibling}function dS(c,u){var p=c.alternate,w=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Ka(u,c),li(c),w&4){try{fu(3,c,c.return),Rd(3,c)}catch(Ye){cr(c,c.return,Ye)}try{fu(5,c,c.return)}catch(Ye){cr(c,c.return,Ye)}}break;case 1:Ka(u,c),li(c),w&512&&p!==null&&Pl(p,p.return);break;case 5:if(Ka(u,c),li(c),w&512&&p!==null&&Pl(p,p.return),c.flags&32){var E=c.stateNode;try{ut(E,"")}catch(Ye){cr(c,c.return,Ye)}}if(w&4&&(E=c.stateNode,E!=null)){var A=c.memoizedProps,I=p!==null?p.memoizedProps:A,ie=c.type,ce=c.updateQueue;if(c.updateQueue=null,ce!==null)try{ie==="input"&&A.type==="radio"&&A.name!=null&&Ue(E,A),at(ie,I);var Se=at(ie,A);for(I=0;I<ce.length;I+=2){var Oe=ce[I],De=ce[I+1];Oe==="style"?Ke(E,De):Oe==="dangerouslySetInnerHTML"?En(E,De):Oe==="children"?ut(E,De):S(E,Oe,De,Se)}switch(ie){case"input":Te(E,A);break;case"textarea":Lr(E,A);break;case"select":var Ce=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!A.multiple;var He=A.value;He!=null?Ct(E,!!A.multiple,He,!1):Ce!==!!A.multiple&&(A.defaultValue!=null?Ct(E,!!A.multiple,A.defaultValue,!0):Ct(E,!!A.multiple,A.multiple?[]:"",!1))}E[eu]=A}catch(Ye){cr(c,c.return,Ye)}}break;case 6:if(Ka(u,c),li(c),w&4){if(c.stateNode===null)throw Error(r(162));E=c.stateNode,A=c.memoizedProps;try{E.nodeValue=A}catch(Ye){cr(c,c.return,Ye)}}break;case 3:if(Ka(u,c),li(c),w&4&&p!==null&&p.memoizedState.isDehydrated)try{Wc(u.containerInfo)}catch(Ye){cr(c,c.return,Ye)}break;case 4:Ka(u,c),li(c);break;case 13:Ka(u,c),li(c),E=c.child,E.flags&8192&&(A=E.memoizedState!==null,E.stateNode.isHidden=A,!A||E.alternate!==null&&E.alternate.memoizedState!==null||(Xp=Ie())),w&4&&fS(c);break;case 22:if(Oe=p!==null&&p.memoizedState!==null,c.mode&1?(dn=(Se=dn)||Oe,Ka(u,c),dn=Se):Ka(u,c),li(c),w&8192){if(Se=c.memoizedState!==null,(c.stateNode.isHidden=Se)&&!Oe&&(c.mode&1)!==0)for(Ge=c,Oe=c.child;Oe!==null;){for(De=Ge=Oe;Ge!==null;){switch(Ce=Ge,He=Ce.child,Ce.tag){case 0:case 11:case 14:case 15:fu(4,Ce,Ce.return);break;case 1:Pl(Ce,Ce.return);var Xe=Ce.stateNode;if(typeof Xe.componentWillUnmount=="function"){w=Ce,p=Ce.return;try{u=w,Xe.props=u.memoizedProps,Xe.state=u.memoizedState,Xe.componentWillUnmount()}catch(Ye){cr(w,p,Ye)}}break;case 5:Pl(Ce,Ce.return);break;case 22:if(Ce.memoizedState!==null){pS(De);continue}}He!==null?(He.return=Ce,Ge=He):pS(De)}Oe=Oe.sibling}e:for(Oe=null,De=c;;){if(De.tag===5){if(Oe===null){Oe=De;try{E=De.stateNode,Se?(A=E.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(ie=De.stateNode,ce=De.memoizedProps.style,I=ce!=null&&ce.hasOwnProperty("display")?ce.display:null,ie.style.display=ke("display",I))}catch(Ye){cr(c,c.return,Ye)}}}else if(De.tag===6){if(Oe===null)try{De.stateNode.nodeValue=Se?"":De.memoizedProps}catch(Ye){cr(c,c.return,Ye)}}else if((De.tag!==22&&De.tag!==23||De.memoizedState===null||De===c)&&De.child!==null){De.child.return=De,De=De.child;continue}if(De===c)break e;for(;De.sibling===null;){if(De.return===null||De.return===c)break e;Oe===De&&(Oe=null),De=De.return}Oe===De&&(Oe=null),De.sibling.return=De.return,De=De.sibling}}break;case 19:Ka(u,c),li(c),w&4&&fS(c);break;case 21:break;default:Ka(u,c),li(c)}}function li(c){var u=c.flags;if(u&2){try{e:{for(var p=c.return;p!==null;){if(lS(p)){var w=p;break e}p=p.return}throw Error(r(160))}switch(w.tag){case 5:var E=w.stateNode;w.flags&32&&(ut(E,""),w.flags&=-33);var A=cS(c);Kp(c,A,E);break;case 3:case 4:var I=w.stateNode.containerInfo,ie=cS(c);Vp(c,ie,I);break;default:throw Error(r(161))}}catch(ce){cr(c,c.return,ce)}c.flags&=-3}u&4096&&(c.flags&=-4097)}function LF(c,u,p){Ge=c,hS(c)}function hS(c,u,p){for(var w=(c.mode&1)!==0;Ge!==null;){var E=Ge,A=E.child;if(E.tag===22&&w){var I=E.memoizedState!==null||Md;if(!I){var ie=E.alternate,ce=ie!==null&&ie.memoizedState!==null||dn;ie=Md;var Se=dn;if(Md=I,(dn=ce)&&!Se)for(Ge=E;Ge!==null;)I=Ge,ce=I.child,I.tag===22&&I.memoizedState!==null?xS(E):ce!==null?(ce.return=I,Ge=ce):xS(E);for(;A!==null;)Ge=A,hS(A),A=A.sibling;Ge=E,Md=ie,dn=Se}mS(c)}else(E.subtreeFlags&8772)!==0&&A!==null?(A.return=E,Ge=A):mS(c)}}function mS(c){for(;Ge!==null;){var u=Ge;if((u.flags&8772)!==0){var p=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:dn||Rd(5,u);break;case 1:var w=u.stateNode;if(u.flags&4&&!dn)if(p===null)w.componentDidMount();else{var E=u.elementType===u.type?p.memoizedProps:Ha(u.type,p.memoizedProps);w.componentDidUpdate(E,p.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var A=u.updateQueue;A!==null&&p2(u,A,w);break;case 3:var I=u.updateQueue;if(I!==null){if(p=null,u.child!==null)switch(u.child.tag){case 5:p=u.child.stateNode;break;case 1:p=u.child.stateNode}p2(u,I,p)}break;case 5:var ie=u.stateNode;if(p===null&&u.flags&4){p=ie;var ce=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":ce.autoFocus&&p.focus();break;case"img":ce.src&&(p.src=ce.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var Se=u.alternate;if(Se!==null){var Oe=Se.memoizedState;if(Oe!==null){var De=Oe.dehydrated;De!==null&&Wc(De)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}dn||u.flags&512&&Hp(u)}catch(Ce){cr(u,u.return,Ce)}}if(u===c){Ge=null;break}if(p=u.sibling,p!==null){p.return=u.return,Ge=p;break}Ge=u.return}}function pS(c){for(;Ge!==null;){var u=Ge;if(u===c){Ge=null;break}var p=u.sibling;if(p!==null){p.return=u.return,Ge=p;break}Ge=u.return}}function xS(c){for(;Ge!==null;){var u=Ge;try{switch(u.tag){case 0:case 11:case 15:var p=u.return;try{Rd(4,u)}catch(ce){cr(u,p,ce)}break;case 1:var w=u.stateNode;if(typeof w.componentDidMount=="function"){var E=u.return;try{w.componentDidMount()}catch(ce){cr(u,E,ce)}}var A=u.return;try{Hp(u)}catch(ce){cr(u,A,ce)}break;case 5:var I=u.return;try{Hp(u)}catch(ce){cr(u,I,ce)}}}catch(ce){cr(u,u.return,ce)}if(u===c){Ge=null;break}var ie=u.sibling;if(ie!==null){ie.return=u.return,Ge=ie;break}Ge=u.return}}var BF=Math.ceil,Ld=C.ReactCurrentDispatcher,Gp=C.ReactCurrentOwner,va=C.ReactCurrentBatchConfig,bt=0,Ur=null,Nr=null,tn=0,Qn=0,Ol=xs(0),Pr=0,du=null,xo=0,Bd=0,qp=0,hu=null,Bn=null,Xp=0,Fl=1/0,Pi=null,$d=!1,Yp=null,Ss=null,Ud=!1,Ns=null,zd=0,mu=0,Jp=null,Wd=-1,Hd=0;function kn(){return(bt&6)!==0?Ie():Wd!==-1?Wd:Wd=Ie()}function Es(c){return(c.mode&1)===0?1:(bt&2)!==0&&tn!==0?tn&-tn:SF.transition!==null?(Hd===0&&(Hd=cw()),Hd):(c=Tt,c!==0||(c=window.event,c=c===void 0?16:vw(c.type)),c)}function Ga(c,u,p,w){if(50<mu)throw mu=0,Jp=null,Error(r(185));Lc(c,p,w),((bt&2)===0||c!==Ur)&&(c===Ur&&((bt&2)===0&&(Bd|=p),Pr===4&&_s(c,tn)),$n(c,w),p===1&&bt===0&&(u.mode&1)===0&&(Fl=Ie()+500,vd&&vs()))}function $n(c,u){var p=c.callbackNode;S6(c,u);var w=Zf(c,c===Ur?tn:0);if(w===0)p!==null&&$e(p),c.callbackNode=null,c.callbackPriority=0;else if(u=w&-w,c.callbackPriority!==u){if(p!=null&&$e(p),u===1)c.tag===0?wF(vS.bind(null,c)):n2(vS.bind(null,c)),gF(function(){(bt&6)===0&&vs()}),p=null;else{switch(uw(w)){case 1:p=Bt;break;case 4:p=Ut;break;case 16:p=mr;break;case 536870912:p=ls;break;default:p=mr}p=kS(p,gS.bind(null,c))}c.callbackPriority=u,c.callbackNode=p}}function gS(c,u){if(Wd=-1,Hd=0,(bt&6)!==0)throw Error(r(327));var p=c.callbackNode;if(Dl()&&c.callbackNode!==p)return null;var w=Zf(c,c===Ur?tn:0);if(w===0)return null;if((w&30)!==0||(w&c.expiredLanes)!==0||u)u=Vd(c,w);else{u=w;var E=bt;bt|=2;var A=bS();(Ur!==c||tn!==u)&&(Pi=null,Fl=Ie()+500,vo(c,u));do try{zF();break}catch(ie){yS(c,ie)}while(!0);pp(),Ld.current=A,bt=E,Nr!==null?u=0:(Ur=null,tn=0,u=Pr)}if(u!==0){if(u===2&&(E=Pm(c),E!==0&&(w=E,u=Qp(c,E))),u===1)throw p=du,vo(c,0),_s(c,w),$n(c,Ie()),p;if(u===6)_s(c,w);else{if(E=c.current.alternate,(w&30)===0&&!$F(E)&&(u=Vd(c,w),u===2&&(A=Pm(c),A!==0&&(w=A,u=Qp(c,A))),u===1))throw p=du,vo(c,0),_s(c,w),$n(c,Ie()),p;switch(c.finishedWork=E,c.finishedLanes=w,u){case 0:case 1:throw Error(r(345));case 2:yo(c,Bn,Pi);break;case 3:if(_s(c,w),(w&130023424)===w&&(u=Xp+500-Ie(),10<u)){if(Zf(c,0)!==0)break;if(E=c.suspendedLanes,(E&w)!==w){kn(),c.pingedLanes|=c.suspendedLanes&E;break}c.timeoutHandle=ap(yo.bind(null,c,Bn,Pi),u);break}yo(c,Bn,Pi);break;case 4:if(_s(c,w),(w&4194240)===w)break;for(u=c.eventTimes,E=-1;0<w;){var I=31-pr(w);A=1<<I,I=u[I],I>E&&(E=I),w&=~A}if(w=E,w=Ie()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*BF(w/1960))-w,10<w){c.timeoutHandle=ap(yo.bind(null,c,Bn,Pi),w);break}yo(c,Bn,Pi);break;case 5:yo(c,Bn,Pi);break;default:throw Error(r(329))}}}return $n(c,Ie()),c.callbackNode===p?gS.bind(null,c):null}function Qp(c,u){var p=hu;return c.current.memoizedState.isDehydrated&&(vo(c,u).flags|=256),c=Vd(c,u),c!==2&&(u=Bn,Bn=p,u!==null&&Zp(u)),c}function Zp(c){Bn===null?Bn=c:Bn.push.apply(Bn,c)}function $F(c){for(var u=c;;){if(u.flags&16384){var p=u.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var w=0;w<p.length;w++){var E=p[w],A=E.getSnapshot;E=E.value;try{if(!za(A(),E))return!1}catch{return!1}}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===c)break;for(;u.sibling===null;){if(u.return===null||u.return===c)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function _s(c,u){for(u&=~qp,u&=~Bd,c.suspendedLanes|=u,c.pingedLanes&=~u,c=c.expirationTimes;0<u;){var p=31-pr(u),w=1<<p;c[p]=-1,u&=~w}}function vS(c){if((bt&6)!==0)throw Error(r(327));Dl();var u=Zf(c,0);if((u&1)===0)return $n(c,Ie()),null;var p=Vd(c,u);if(c.tag!==0&&p===2){var w=Pm(c);w!==0&&(u=w,p=Qp(c,w))}if(p===1)throw p=du,vo(c,0),_s(c,u),$n(c,Ie()),p;if(p===6)throw Error(r(345));return c.finishedWork=c.current.alternate,c.finishedLanes=u,yo(c,Bn,Pi),$n(c,Ie()),null}function ex(c,u){var p=bt;bt|=1;try{return c(u)}finally{bt=p,bt===0&&(Fl=Ie()+500,vd&&vs())}}function go(c){Ns!==null&&Ns.tag===0&&(bt&6)===0&&Dl();var u=bt;bt|=1;var p=va.transition,w=Tt;try{if(va.transition=null,Tt=1,c)return c()}finally{Tt=w,va.transition=p,bt=u,(bt&6)===0&&vs()}}function tx(){Qn=Ol.current,Vt(Ol)}function vo(c,u){c.finishedWork=null,c.finishedLanes=0;var p=c.timeoutHandle;if(p!==-1&&(c.timeoutHandle=-1,xF(p)),Nr!==null)for(p=Nr.return;p!==null;){var w=p;switch(up(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&xd();break;case 3:Al(),Vt(Mn),Vt(cn),Np();break;case 5:wp(w);break;case 4:Al();break;case 13:Vt(ar);break;case 19:Vt(ar);break;case 10:xp(w.type._context);break;case 22:case 23:tx()}p=p.return}if(Ur=c,Nr=c=ks(c.current,null),tn=Qn=u,Pr=0,du=null,qp=Bd=xo=0,Bn=hu=null,ho!==null){for(u=0;u<ho.length;u++)if(p=ho[u],w=p.interleaved,w!==null){p.interleaved=null;var E=w.next,A=p.pending;if(A!==null){var I=A.next;A.next=E,w.next=I}p.pending=w}ho=null}return c}function yS(c,u){do{var p=Nr;try{if(pp(),Cd.current=Od,Ad){for(var w=ir.memoizedState;w!==null;){var E=w.queue;E!==null&&(E.pending=null),w=w.next}Ad=!1}if(po=0,$r=Tr=ir=null,su=!1,ou=0,Gp.current=null,p===null||p.return===null){Pr=1,du=u,Nr=null;break}e:{var A=c,I=p.return,ie=p,ce=u;if(u=tn,ie.flags|=32768,ce!==null&&typeof ce=="object"&&typeof ce.then=="function"){var Se=ce,Oe=ie,De=Oe.tag;if((Oe.mode&1)===0&&(De===0||De===11||De===15)){var Ce=Oe.alternate;Ce?(Oe.updateQueue=Ce.updateQueue,Oe.memoizedState=Ce.memoizedState,Oe.lanes=Ce.lanes):(Oe.updateQueue=null,Oe.memoizedState=null)}var He=H2(I);if(He!==null){He.flags&=-257,V2(He,I,ie,A,u),He.mode&1&&W2(A,Se,u),u=He,ce=Se;var Xe=u.updateQueue;if(Xe===null){var Ye=new Set;Ye.add(ce),u.updateQueue=Ye}else Xe.add(ce);break e}else{if((u&1)===0){W2(A,Se,u),rx();break e}ce=Error(r(426))}}else if(Jt&&ie.mode&1){var xr=H2(I);if(xr!==null){(xr.flags&65536)===0&&(xr.flags|=256),V2(xr,I,ie,A,u),hp(Tl(ce,ie));break e}}A=ce=Tl(ce,ie),Pr!==4&&(Pr=2),hu===null?hu=[A]:hu.push(A),A=I;do{switch(A.tag){case 3:A.flags|=65536,u&=-u,A.lanes|=u;var xe=U2(A,ce,u);m2(A,xe);break e;case 1:ie=ce;var he=A.type,ge=A.stateNode;if((A.flags&128)===0&&(typeof he.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(Ss===null||!Ss.has(ge)))){A.flags|=65536,u&=-u,A.lanes|=u;var Re=z2(A,ie,u);m2(A,Re);break e}}A=A.return}while(A!==null)}SS(p)}catch(Je){u=Je,Nr===p&&p!==null&&(Nr=p=p.return);continue}break}while(!0)}function bS(){var c=Ld.current;return Ld.current=Od,c===null?Od:c}function rx(){(Pr===0||Pr===3||Pr===2)&&(Pr=4),Ur===null||(xo&268435455)===0&&(Bd&268435455)===0||_s(Ur,tn)}function Vd(c,u){var p=bt;bt|=2;var w=bS();(Ur!==c||tn!==u)&&(Pi=null,vo(c,u));do try{UF();break}catch(E){yS(c,E)}while(!0);if(pp(),bt=p,Ld.current=w,Nr!==null)throw Error(r(261));return Ur=null,tn=0,Pr}function UF(){for(;Nr!==null;)wS(Nr)}function zF(){for(;Nr!==null&&!Ve();)wS(Nr)}function wS(c){var u=_S(c.alternate,c,Qn);c.memoizedProps=c.pendingProps,u===null?SS(c):Nr=u,Gp.current=null}function SS(c){var u=c;do{var p=u.alternate;if(c=u.return,(u.flags&32768)===0){if(p=DF(p,u,Qn),p!==null){Nr=p;return}}else{if(p=IF(p,u),p!==null){p.flags&=32767,Nr=p;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Pr=6,Nr=null;return}}if(u=u.sibling,u!==null){Nr=u;return}Nr=u=c}while(u!==null);Pr===0&&(Pr=5)}function yo(c,u,p){var w=Tt,E=va.transition;try{va.transition=null,Tt=1,WF(c,u,p,w)}finally{va.transition=E,Tt=w}return null}function WF(c,u,p,w){do Dl();while(Ns!==null);if((bt&6)!==0)throw Error(r(327));p=c.finishedWork;var E=c.finishedLanes;if(p===null)return null;if(c.finishedWork=null,c.finishedLanes=0,p===c.current)throw Error(r(177));c.callbackNode=null,c.callbackPriority=0;var A=p.lanes|p.childLanes;if(N6(c,A),c===Ur&&(Nr=Ur=null,tn=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Ud||(Ud=!0,kS(mr,function(){return Dl(),null})),A=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||A){A=va.transition,va.transition=null;var I=Tt;Tt=1;var ie=bt;bt|=4,Gp.current=null,RF(c,p),dS(p,c),cF(rp),rd=!!tp,rp=tp=null,c.current=p,LF(p),Me(),bt=ie,Tt=I,va.transition=A}else c.current=p;if(Ud&&(Ud=!1,Ns=c,zd=E),A=c.pendingLanes,A===0&&(Ss=null),Mc(p.stateNode),$n(c,Ie()),u!==null)for(w=c.onRecoverableError,p=0;p<u.length;p++)E=u[p],w(E.value,{componentStack:E.stack,digest:E.digest});if($d)throw $d=!1,c=Yp,Yp=null,c;return(zd&1)!==0&&c.tag!==0&&Dl(),A=c.pendingLanes,(A&1)!==0?c===Jp?mu++:(mu=0,Jp=c):mu=0,vs(),null}function Dl(){if(Ns!==null){var c=uw(zd),u=va.transition,p=Tt;try{if(va.transition=null,Tt=16>c?16:c,Ns===null)var w=!1;else{if(c=Ns,Ns=null,zd=0,(bt&6)!==0)throw Error(r(331));var E=bt;for(bt|=4,Ge=c.current;Ge!==null;){var A=Ge,I=A.child;if((Ge.flags&16)!==0){var ie=A.deletions;if(ie!==null){for(var ce=0;ce<ie.length;ce++){var Se=ie[ce];for(Ge=Se;Ge!==null;){var Oe=Ge;switch(Oe.tag){case 0:case 11:case 15:fu(8,Oe,A)}var De=Oe.child;if(De!==null)De.return=Oe,Ge=De;else for(;Ge!==null;){Oe=Ge;var Ce=Oe.sibling,He=Oe.return;if(oS(Oe),Oe===Se){Ge=null;break}if(Ce!==null){Ce.return=He,Ge=Ce;break}Ge=He}}}var Xe=A.alternate;if(Xe!==null){var Ye=Xe.child;if(Ye!==null){Xe.child=null;do{var xr=Ye.sibling;Ye.sibling=null,Ye=xr}while(Ye!==null)}}Ge=A}}if((A.subtreeFlags&2064)!==0&&I!==null)I.return=A,Ge=I;else e:for(;Ge!==null;){if(A=Ge,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:fu(9,A,A.return)}var xe=A.sibling;if(xe!==null){xe.return=A.return,Ge=xe;break e}Ge=A.return}}var he=c.current;for(Ge=he;Ge!==null;){I=Ge;var ge=I.child;if((I.subtreeFlags&2064)!==0&&ge!==null)ge.return=I,Ge=ge;else e:for(I=he;Ge!==null;){if(ie=Ge,(ie.flags&2048)!==0)try{switch(ie.tag){case 0:case 11:case 15:Rd(9,ie)}}catch(Je){cr(ie,ie.return,Je)}if(ie===I){Ge=null;break e}var Re=ie.sibling;if(Re!==null){Re.return=ie.return,Ge=Re;break e}Ge=ie.return}}if(bt=E,vs(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(ai,c)}catch{}w=!0}return w}finally{Tt=p,va.transition=u}}return!1}function NS(c,u,p){u=Tl(p,u),u=U2(c,u,1),c=bs(c,u,1),u=kn(),c!==null&&(Lc(c,1,u),$n(c,u))}function cr(c,u,p){if(c.tag===3)NS(c,c,p);else for(;u!==null;){if(u.tag===3){NS(u,c,p);break}else if(u.tag===1){var w=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Ss===null||!Ss.has(w))){c=Tl(p,c),c=z2(u,c,1),u=bs(u,c,1),c=kn(),u!==null&&(Lc(u,1,c),$n(u,c));break}}u=u.return}}function HF(c,u,p){var w=c.pingCache;w!==null&&w.delete(u),u=kn(),c.pingedLanes|=c.suspendedLanes&p,Ur===c&&(tn&p)===p&&(Pr===4||Pr===3&&(tn&130023424)===tn&&500>Ie()-Xp?vo(c,0):qp|=p),$n(c,u)}function ES(c,u){u===0&&((c.mode&1)===0?u=1:(u=Qf,Qf<<=1,(Qf&130023424)===0&&(Qf=4194304)));var p=kn();c=Ci(c,u),c!==null&&(Lc(c,u,p),$n(c,p))}function VF(c){var u=c.memoizedState,p=0;u!==null&&(p=u.retryLane),ES(c,p)}function KF(c,u){var p=0;switch(c.tag){case 13:var w=c.stateNode,E=c.memoizedState;E!==null&&(p=E.retryLane);break;case 19:w=c.stateNode;break;default:throw Error(r(314))}w!==null&&w.delete(u),ES(c,p)}var _S;_S=function(c,u,p){if(c!==null)if(c.memoizedProps!==u.pendingProps||Mn.current)Ln=!0;else{if((c.lanes&p)===0&&(u.flags&128)===0)return Ln=!1,FF(c,u,p);Ln=(c.flags&131072)!==0}else Ln=!1,Jt&&(u.flags&1048576)!==0&&a2(u,bd,u.index);switch(u.lanes=0,u.tag){case 2:var w=u.type;Id(c,u),c=u.pendingProps;var E=Sl(u,cn.current);Cl(u,p),E=kp(null,u,w,c,E,p);var A=jp();return u.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Rn(w)?(A=!0,gd(u)):A=!1,u.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,yp(u),E.updater=Fd,u.stateNode=E,E._reactInternals=u,Fp(u,w,c,p),u=Rp(null,u,w,!0,A,p)):(u.tag=0,Jt&&A&&cp(u),_n(null,u,E,p),u=u.child),u;case 16:w=u.elementType;e:{switch(Id(c,u),c=u.pendingProps,E=w._init,w=E(w._payload),u.type=w,E=u.tag=qF(w),c=Ha(w,c),E){case 0:u=Mp(null,u,w,c,p);break e;case 1:u=J2(null,u,w,c,p);break e;case 11:u=K2(null,u,w,c,p);break e;case 14:u=G2(null,u,w,Ha(w.type,c),p);break e}throw Error(r(306,w,""))}return u;case 0:return w=u.type,E=u.pendingProps,E=u.elementType===w?E:Ha(w,E),Mp(c,u,w,E,p);case 1:return w=u.type,E=u.pendingProps,E=u.elementType===w?E:Ha(w,E),J2(c,u,w,E,p);case 3:e:{if(Q2(u),c===null)throw Error(r(387));w=u.pendingProps,A=u.memoizedState,E=A.element,h2(c,u),kd(u,w,null,p);var I=u.memoizedState;if(w=I.element,A.isDehydrated)if(A={element:w,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},u.updateQueue.baseState=A,u.memoizedState=A,u.flags&256){E=Tl(Error(r(423)),u),u=Z2(c,u,w,p,E);break e}else if(w!==E){E=Tl(Error(r(424)),u),u=Z2(c,u,w,p,E);break e}else for(Jn=ps(u.stateNode.containerInfo.firstChild),Yn=u,Jt=!0,Wa=null,p=f2(u,null,w,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(_l(),w===E){u=Ti(c,u,p);break e}_n(c,u,w,p)}u=u.child}return u;case 5:return x2(u),c===null&&dp(u),w=u.type,E=u.pendingProps,A=c!==null?c.memoizedProps:null,I=E.children,np(w,E)?I=null:A!==null&&np(w,A)&&(u.flags|=32),Y2(c,u),_n(c,u,I,p),u.child;case 6:return c===null&&dp(u),null;case 13:return eS(c,u,p);case 4:return bp(u,u.stateNode.containerInfo),w=u.pendingProps,c===null?u.child=kl(u,null,w,p):_n(c,u,w,p),u.child;case 11:return w=u.type,E=u.pendingProps,E=u.elementType===w?E:Ha(w,E),K2(c,u,w,E,p);case 7:return _n(c,u,u.pendingProps,p),u.child;case 8:return _n(c,u,u.pendingProps.children,p),u.child;case 12:return _n(c,u,u.pendingProps.children,p),u.child;case 10:e:{if(w=u.type._context,E=u.pendingProps,A=u.memoizedProps,I=E.value,zt(Nd,w._currentValue),w._currentValue=I,A!==null)if(za(A.value,I)){if(A.children===E.children&&!Mn.current){u=Ti(c,u,p);break e}}else for(A=u.child,A!==null&&(A.return=u);A!==null;){var ie=A.dependencies;if(ie!==null){I=A.child;for(var ce=ie.firstContext;ce!==null;){if(ce.context===w){if(A.tag===1){ce=Ai(-1,p&-p),ce.tag=2;var Se=A.updateQueue;if(Se!==null){Se=Se.shared;var Oe=Se.pending;Oe===null?ce.next=ce:(ce.next=Oe.next,Oe.next=ce),Se.pending=ce}}A.lanes|=p,ce=A.alternate,ce!==null&&(ce.lanes|=p),gp(A.return,p,u),ie.lanes|=p;break}ce=ce.next}}else if(A.tag===10)I=A.type===u.type?null:A.child;else if(A.tag===18){if(I=A.return,I===null)throw Error(r(341));I.lanes|=p,ie=I.alternate,ie!==null&&(ie.lanes|=p),gp(I,p,u),I=A.sibling}else I=A.child;if(I!==null)I.return=A;else for(I=A;I!==null;){if(I===u){I=null;break}if(A=I.sibling,A!==null){A.return=I.return,I=A;break}I=I.return}A=I}_n(c,u,E.children,p),u=u.child}return u;case 9:return E=u.type,w=u.pendingProps.children,Cl(u,p),E=xa(E),w=w(E),u.flags|=1,_n(c,u,w,p),u.child;case 14:return w=u.type,E=Ha(w,u.pendingProps),E=Ha(w.type,E),G2(c,u,w,E,p);case 15:return q2(c,u,u.type,u.pendingProps,p);case 17:return w=u.type,E=u.pendingProps,E=u.elementType===w?E:Ha(w,E),Id(c,u),u.tag=1,Rn(w)?(c=!0,gd(u)):c=!1,Cl(u,p),B2(u,w,E),Fp(u,w,E,p),Rp(null,u,w,!0,c,p);case 19:return rS(c,u,p);case 22:return X2(c,u,p)}throw Error(r(156,u.tag))};function kS(c,u){return Fe(c,u)}function GF(c,u,p,w){this.tag=c,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ya(c,u,p,w){return new GF(c,u,p,w)}function nx(c){return c=c.prototype,!(!c||!c.isReactComponent)}function qF(c){if(typeof c=="function")return nx(c)?1:0;if(c!=null){if(c=c.$$typeof,c===H)return 11;if(c===Q)return 14}return 2}function ks(c,u){var p=c.alternate;return p===null?(p=ya(c.tag,u,c.key,c.mode),p.elementType=c.elementType,p.type=c.type,p.stateNode=c.stateNode,p.alternate=c,c.alternate=p):(p.pendingProps=u,p.type=c.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=c.flags&14680064,p.childLanes=c.childLanes,p.lanes=c.lanes,p.child=c.child,p.memoizedProps=c.memoizedProps,p.memoizedState=c.memoizedState,p.updateQueue=c.updateQueue,u=c.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=c.sibling,p.index=c.index,p.ref=c.ref,p}function Kd(c,u,p,w,E,A){var I=2;if(w=c,typeof c=="function")nx(c)&&(I=1);else if(typeof c=="string")I=5;else e:switch(c){case P:return bo(p.children,E,A,u);case D:I=8,E|=8;break;case R:return c=ya(12,p,u,E|2),c.elementType=R,c.lanes=A,c;case z:return c=ya(13,p,u,E),c.elementType=z,c.lanes=A,c;case ne:return c=ya(19,p,u,E),c.elementType=ne,c.lanes=A,c;case ue:return Gd(p,E,A,u);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case G:I=10;break e;case M:I=9;break e;case H:I=11;break e;case Q:I=14;break e;case le:I=16,w=null;break e}throw Error(r(130,c==null?c:typeof c,""))}return u=ya(I,p,u,E),u.elementType=c,u.type=w,u.lanes=A,u}function bo(c,u,p,w){return c=ya(7,c,w,u),c.lanes=p,c}function Gd(c,u,p,w){return c=ya(22,c,w,u),c.elementType=ue,c.lanes=p,c.stateNode={isHidden:!1},c}function ax(c,u,p){return c=ya(6,c,null,u),c.lanes=p,c}function ix(c,u,p){return u=ya(4,c.children!==null?c.children:[],c.key,u),u.lanes=p,u.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},u}function XF(c,u,p,w,E){this.tag=u,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Om(0),this.expirationTimes=Om(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Om(0),this.identifierPrefix=w,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function sx(c,u,p,w,E,A,I,ie,ce){return c=new XF(c,u,p,ie,ce),u===1?(u=1,A===!0&&(u|=8)):u=0,A=ya(3,null,null,u),c.current=A,A.stateNode=c,A.memoizedState={element:w,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},yp(A),c}function YF(c,u,p){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:k,key:w==null?null:""+w,children:c,containerInfo:u,implementation:p}}function jS(c){if(!c)return gs;c=c._reactInternals;e:{if(re(c)!==c||c.tag!==1)throw Error(r(170));var u=c;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Rn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(r(171))}if(c.tag===1){var p=c.type;if(Rn(p))return t2(c,p,u)}return u}function CS(c,u,p,w,E,A,I,ie,ce){return c=sx(p,w,!0,c,E,A,I,ie,ce),c.context=jS(null),p=c.current,w=kn(),E=Es(p),A=Ai(w,E),A.callback=u??null,bs(p,A,E),c.current.lanes=E,Lc(c,E,w),$n(c,w),c}function qd(c,u,p,w){var E=u.current,A=kn(),I=Es(E);return p=jS(p),u.context===null?u.context=p:u.pendingContext=p,u=Ai(A,I),u.payload={element:c},w=w===void 0?null:w,w!==null&&(u.callback=w),c=bs(E,u,I),c!==null&&(Ga(c,E,I,A),_d(c,E,I)),I}function Xd(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function AS(c,u){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var p=c.retryLane;c.retryLane=p!==0&&p<u?p:u}}function ox(c,u){AS(c,u),(c=c.alternate)&&AS(c,u)}function JF(){return null}var TS=typeof reportError=="function"?reportError:function(c){console.error(c)};function lx(c){this._internalRoot=c}Yd.prototype.render=lx.prototype.render=function(c){var u=this._internalRoot;if(u===null)throw Error(r(409));qd(c,u,null,null)},Yd.prototype.unmount=lx.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var u=c.containerInfo;go(function(){qd(null,c,null,null)}),u[Ei]=null}};function Yd(c){this._internalRoot=c}Yd.prototype.unstable_scheduleHydration=function(c){if(c){var u=hw();c={blockedOn:null,target:c,priority:u};for(var p=0;p<ds.length&&u!==0&&u<ds[p].priority;p++);ds.splice(p,0,c),p===0&&xw(c)}};function cx(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function Jd(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function PS(){}function QF(c,u,p,w,E){if(E){if(typeof w=="function"){var A=w;w=function(){var Se=Xd(I);A.call(Se)}}var I=CS(u,w,c,0,null,!1,!1,"",PS);return c._reactRootContainer=I,c[Ei]=I.current,Qc(c.nodeType===8?c.parentNode:c),go(),I}for(;E=c.lastChild;)c.removeChild(E);if(typeof w=="function"){var ie=w;w=function(){var Se=Xd(ce);ie.call(Se)}}var ce=sx(c,0,!1,null,null,!1,!1,"",PS);return c._reactRootContainer=ce,c[Ei]=ce.current,Qc(c.nodeType===8?c.parentNode:c),go(function(){qd(u,ce,p,w)}),ce}function Qd(c,u,p,w,E){var A=p._reactRootContainer;if(A){var I=A;if(typeof E=="function"){var ie=E;E=function(){var ce=Xd(I);ie.call(ce)}}qd(u,I,c,E)}else I=QF(p,u,c,E,w);return Xd(I)}fw=function(c){switch(c.tag){case 3:var u=c.stateNode;if(u.current.memoizedState.isDehydrated){var p=Rc(u.pendingLanes);p!==0&&(Fm(u,p|1),$n(u,Ie()),(bt&6)===0&&(Fl=Ie()+500,vs()))}break;case 13:go(function(){var w=Ci(c,1);if(w!==null){var E=kn();Ga(w,c,1,E)}}),ox(c,1)}},Dm=function(c){if(c.tag===13){var u=Ci(c,134217728);if(u!==null){var p=kn();Ga(u,c,134217728,p)}ox(c,134217728)}},dw=function(c){if(c.tag===13){var u=Es(c),p=Ci(c,u);if(p!==null){var w=kn();Ga(p,c,u,w)}ox(c,u)}},hw=function(){return Tt},mw=function(c,u){var p=Tt;try{return Tt=c,u()}finally{Tt=p}},Zr=function(c,u,p){switch(u){case"input":if(Te(c,p),u=p.name,p.type==="radio"&&u!=null){for(p=c;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<p.length;u++){var w=p[u];if(w!==c&&w.form===c.form){var E=pd(w);if(!E)throw Error(r(90));F(w),Te(w,E)}}}break;case"textarea":Lr(c,p);break;case"select":u=p.value,u!=null&&Ct(c,!!p.multiple,u,!1)}},Si=ex,Xf=go;var ZF={usingClientEntryPoint:!1,Events:[tu,bl,pd,ao,Fc,ex]},pu={findFiberByHostInstance:lo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},e5={bundleType:pu.bundleType,version:pu.version,rendererPackageName:pu.rendererPackageName,rendererConfig:pu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=be(c),c===null?null:c.stateNode},findFiberByHostInstance:pu.findFiberByHostInstance||JF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zd.isDisabled&&Zd.supportsFiber)try{ai=Zd.inject(e5),Br=Zd}catch{}}return Un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZF,Un.createPortal=function(c,u){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cx(u))throw Error(r(200));return YF(c,u,null,p)},Un.createRoot=function(c,u){if(!cx(c))throw Error(r(299));var p=!1,w="",E=TS;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(E=u.onRecoverableError)),u=sx(c,1,!1,null,null,p,!1,w,E),c[Ei]=u.current,Qc(c.nodeType===8?c.parentNode:c),new lx(u)},Un.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var u=c._reactInternals;if(u===void 0)throw typeof c.render=="function"?Error(r(188)):(c=Object.keys(c).join(","),Error(r(268,c)));return c=be(u),c=c===null?null:c.stateNode,c},Un.flushSync=function(c){return go(c)},Un.hydrate=function(c,u,p){if(!Jd(u))throw Error(r(200));return Qd(null,c,u,!0,p)},Un.hydrateRoot=function(c,u,p){if(!cx(c))throw Error(r(405));var w=p!=null&&p.hydratedSources||null,E=!1,A="",I=TS;if(p!=null&&(p.unstable_strictMode===!0&&(E=!0),p.identifierPrefix!==void 0&&(A=p.identifierPrefix),p.onRecoverableError!==void 0&&(I=p.onRecoverableError)),u=CS(u,null,c,1,p??null,E,!1,A,I),c[Ei]=u.current,Qc(c),w)for(c=0;c<w.length;c++)p=w[c],E=p._getVersion,E=E(p._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[p,E]:u.mutableSourceEagerHydrationData.push(p,E);return new Yd(u)},Un.render=function(c,u,p){if(!Jd(u))throw Error(r(200));return Qd(null,c,u,!1,p)},Un.unmountComponentAtNode=function(c){if(!Jd(c))throw Error(r(40));return c._reactRootContainer?(go(function(){Qd(null,null,c,!1,function(){c._reactRootContainer=null,c[Ei]=null})}),!0):!1},Un.unstable_batchedUpdates=ex,Un.unstable_renderSubtreeIntoContainer=function(c,u,p,w){if(!Jd(p))throw Error(r(200));if(c==null||c._reactInternals===void 0)throw Error(r(38));return Qd(c,u,p,!1,w)},Un.version="18.3.1-next-f1338f8080-20240426",Un}var BS;function l4(){if(BS)return dx.exports;BS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),dx.exports=c5(),dx.exports}var $S;function u5(){if($S)return e0;$S=1;var e=l4();return e0.createRoot=e.createRoot,e0.hydrateRoot=e.hydrateRoot,e0}var f5=u5();/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ot=(e,t)=>{const r=j.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:l="",children:f,...d},h)=>j.createElement("svg",{ref:h,...d5,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:["lucide",`lucide-${h5(e)}`,l].join(" "),...d},[...t.map(([m,x])=>j.createElement(m,x)),...Array.isArray(f)?f:[f]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m5=ot("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=ot("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=ot("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=ot("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=ot("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=ot("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x5=ot("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x1=ot("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=ot("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=ot("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g5=ot("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=ot("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=ot("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=ot("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y5=ot("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=ot("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g1=ot("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b5=ot("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v1=ot("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=ot("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S5=ot("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=ot("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=ot("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N5=ot("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E5=ot("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=ot("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uv=ot("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k5=ot("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=ot("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y1=ot("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=ot("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=ot("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j5=ot("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=ot("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=ot("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=ot("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=ot("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=ot("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=ot("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C5=ot("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=ot("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=ot("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A5=ot("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=ot("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=ot("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=ot("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T5=ot("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b1=ot("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=ot("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),x4="entetesConfig",P5={eleves:{header:"Liste des élèves",footer:"Signature du Directeur",logo:"",logoMinistere:"",pays:"République de Côte d'Ivoire",ministere:"Ministère de l'Éducation Nationale et de l'Alphabétisation",etablissement:"Nom de l'établissement",columns:["Matricule","Nom & Prénom","Date de naissance"],mention:!1},recu:{header:"Reçu de paiement",footer:"Aucun remboursement n'est possible après encaissement.",logo:"",columns:["Nom","Montant","Date","Classe"]},transport:{header:"Fiche de renseignement transport",footer:"",logo:"",columns:["Nom","Classe","Montant","Versement"]}};function Bs(){try{const e=localStorage.getItem(x4);if(e)return JSON.parse(e)}catch{}return P5}function zo(e){return Bs()[e]}function qu(e){localStorage.setItem(x4,JSON.stringify(e))}class Hl{static instance;constructor(){this.initializeDefaultData()}addHistorique(t){const r=this.getAll("historiques"),n=new Date().toISOString(),a=Object.assign({},t,{id:Date.now().toString()+Math.random().toString(36).substr(2,6),date:n,createdAt:n,updatedAt:n});return r.push(a),localStorage.setItem("historiques",JSON.stringify(r)),a}static getInstance(){return Hl.instance||(Hl.instance=new Hl),Hl.instance}initializeDefaultData(){if(["ecole","matieres","classes","enseignants","fraisScolaires","eleves","paiements","notes","moyennesGenerales","utilisateurs","compositions","historiques","compta"].forEach(r=>{localStorage.getItem(r)||localStorage.setItem(r,JSON.stringify([]))}),!localStorage.getItem("utilisateurs")){const r={id:"1",nom:"ADMIN",prenoms:"Système",nomUtilisateur:"admin",role:"Admin",actif:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};localStorage.setItem("utilisateurs",JSON.stringify([r]))}if(!localStorage.getItem("ecole")||JSON.parse(localStorage.getItem("ecole")||"[]").length===0){const r=new Date().toISOString(),n={nom:"École Primaire Excellence",codeEtablissement:"EPE2025",adresse:"Abidjan, Côte d'Ivoire",telephone:"+225 XX XX XX XX XX",email:"contact@ecole.ci",logo:"",devise:"FCFA",anneeScolaireActive:new Date().getFullYear()+"-"+(new Date().getFullYear()+1),compositions:[],createdAt:r,updatedAt:r};this.create("ecole",n)}try{const r=Bs(),n=this.getAll("ecole")?.[0];if(n){const a=r.eleves&&typeof r.eleves.etablissement=="string"?r.eleves.etablissement:"",i=r.recu&&typeof r.recu.etablissement=="string"?r.recu.etablissement:"",s=f=>!f||f.toLowerCase().includes("nom de")||f.toLowerCase().includes("établissement");let l=!1;s(a)&&(r.eleves.etablissement=n.nom||r.eleves.etablissement,r.eleves.logo=n.logo||r.eleves.logo,l=!0),s(i)&&(r.recu.etablissement=n.nom||r.recu.etablissement||"",r.recu.logo=n.logo||r.recu.logo||"",l=!0),l&&qu(r)}}catch{}}getAll(t){try{const r=localStorage.getItem(t);return r?JSON.parse(r):[]}catch(r){return console.error(`Erreur lors du chargement de ${t}:`,r),[]}}getById(t,r){return this.getAll(t).find(a=>a.id===r)||null}create(t,r){const n=this.getAll(t),a=new Date().toISOString(),i=Object.assign({},r,{id:this.generateId(),createdAt:a,updatedAt:a});n.push(i),localStorage.setItem(t,JSON.stringify(n));try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return i}update(t,r,n){const a=this.getAll(t),i=a.findIndex(s=>s.id===r);if(i!==-1){a[i]={...a[i],...n,updatedAt:new Date().toISOString()},localStorage.setItem(t,JSON.stringify(a));try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return a[i]}return null}delete(t,r){const n=this.getAll(t),a=n.filter(i=>i.id!==r);if(a.length!==n.length){localStorage.setItem(t,JSON.stringify(a));try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return!0}return!1}generateId(){return Date.now().toString()+Math.random().toString(36).substr(2,9)}generateMatricule(){const t=this.getAll("eleves"),r=new Date().getFullYear().toString().substr(2,2),n=(t.length+1).toString().padStart(4,"0");return`${r}${n}`}search(t,r,n){const a=this.getAll(t);if(!r)return a;const i=r.toLowerCase();return a.filter(s=>n.some(l=>{const f=s[l];return f&&f.toString().toLowerCase().includes(i)}))}exportData(){const t=["ecole","matieres","classes","enseignants","eleves","fraisScolaires","paiements","notes","moyennesGenerales","utilisateurs","compositions","historiques","compta"],r={};return t.forEach(n=>{r[n]=this.getAll(n)}),JSON.stringify(r,null,2)}importData(t){try{const r=JSON.parse(t);Object.entries(r).forEach(([n,a])=>{localStorage.setItem(n,JSON.stringify(a))});try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return!0}catch(r){return console.error("Erreur lors de l'importation des données:",r),!1}}resetData(){localStorage.clear(),this.initializeDefaultData();try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}}}const pe=Hl.getInstance(),O5=Object.freeze(Object.defineProperty({__proto__:null,db:pe},Symbol.toStringTag,{value:"Module"})),Il="klasnet_licence",US="klasnet_last_check",px="klasnet_time_check",zS=`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoI1o4BX9ixXBWDH+KRGv
L8YdNrzhmTUiy1fJKAqyiA+JT9NCh0fL1xhnLundf0sGbTN6Cd91OkKbxbzpa99S
uWNzd9ISVYZXFFgVfQfBAyUDcjCQxPiypQT9K4aLTJQqf0H4gh985VzvwiwCM0C9
b2NwlCN304JU949CLJhIaExhIuuP0uvYC0heNwp6HjHYClppEmLoEgM3xE6hj/jW
nTraasw8aUSuDqn0dnrxnhRT1pD0ADDVHxfzaUKA0jKmuv2uvBhNvUrWCl9FoyDd
A7nMXmDJG5pnTkKmnNA3eU4ArY1uZsRVYss7iOR6gUa4f/XV8FUhtz00irZC54fW
PwIDAQAB
-----END PUBLIC KEY-----`;class Vl{static instance;publicKeyPem;static getInstance(){return Vl.instance||(Vl.instance=new Vl(zS)),Vl.instance}constructor(t){this.publicKeyPem=t||zS}async verifyJwtAndGetPayload(t){const[r,n,a]=t.split(".");if(!r||!n||!a)throw new Error("Invalid JWT format");const s=new TextEncoder().encode(`${r}.${n}`),l=this.base64UrlToUint8Array(a),f=await this.importPublicKey(this.publicKeyPem);if(!await crypto.subtle.verify("RSASSA-PKCS1-v1_5",f,l,s))throw new Error("Invalid signature");const h=atob(n.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(h)}checkTimeManipulation(){try{const t=localStorage.getItem(px),r=Date.now();if(t){const n=parseInt(t);if(r<n-3600*1e3)return console.warn("Manipulation de date détectée"),!1}return localStorage.setItem(px,r.toString()),!0}catch(t){return console.error("Erreur vérification anti-triche:",t),!1}}async checkLicenceStatus(){if(!this.checkTimeManipulation())return{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()};try{const t=localStorage.getItem(Il);if(!t)return this.createTrialLicence();if((t.match(/\./g)||[]).length===2)try{const r=await this.verifyJwtAndGetPayload(t),n=r.exp&&Number(r.exp)?new Date(Number(r.exp)*1e3):null,a=new Date,i=n?Math.ceil((n.getTime()-a.getTime())/(1e3*60*60*24)):0,s=this.getCurrentEcoleId(),l=r.sub||"";if(l&&!this.isEcoleMatch(l,s))return console.warn(`Licence sub mismatch: token for ${l} but this installation is ${s}`),{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()};const f={isValid:!!n&&i>0,isExpired:!n||i<=0,daysRemaining:Math.max(0,i),type:r.type||"inconnue",dateExpiration:n?n.toISOString():"",lastCheck:new Date().toISOString()};return localStorage.setItem(US,f.lastCheck),f}catch(r){return console.warn("Licence JWT invalide ou signature incorrecte",r),{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()}}else try{const r=JSON.parse(atob(t));let n=null;r.exp&&(typeof r.exp=="number"?n=new Date(r.exp>1e12?r.exp:r.exp*1e3):n=new Date(r.exp));const a=new Date,i=n?Math.ceil((n.getTime()-a.getTime())/(1e3*60*60*24)):0;return{isValid:!!n&&i>0,isExpired:!n||i<=0,daysRemaining:Math.max(0,i),type:r.type||"essai",dateExpiration:n?n.toISOString():"",lastCheck:new Date().toISOString()}}catch{return{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()}}}catch(t){return console.error("Erreur vérification licence:",t),{isValid:!1,isExpired:!0,daysRemaining:0,type:"erreur",dateExpiration:"",lastCheck:new Date().toISOString()}}}createTrialLicence(){const t=new Date,r=new Date(t.getTime()+10080*60*1e3),a={sub:"ECOLE_ESSAI_"+Date.now(),type:"essai",iat:Math.floor(t.getTime()/1e3),exp:r.toISOString()},i=btoa(JSON.stringify(a));return localStorage.setItem(Il,i),{isValid:!0,isExpired:!1,daysRemaining:7,type:"essai",dateExpiration:r.toISOString(),lastCheck:new Date().toISOString()}}activateLicence(t){return localStorage.setItem(Il,t),{success:!0,message:"Licence enregistrée. Actualisez le statut pour vérifier la validité."}}async updateLicenceFromServer(){try{const t=await fetch("/api/licence/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentKey:localStorage.getItem(Il),ecoleId:this.getCurrentEcoleId()})});if(t.ok){const r=await t.json();if(r.newKey)return localStorage.setItem(Il,r.newKey),!0}}catch{console.log("Mise à jour licence impossible (hors ligne)")}return!1}getCurrentEcoleId(){return pe.getAll("ecole")[0]?.codeEtablissement||"ECOLE_DEFAULT"}normalizeId(t){return t?t.toString().toUpperCase().replace(/[^A-Z0-9]/g,""):""}hasCommonNumericSeq(t,r,n=4){const a=t.match(/\d+/g)||[],i=r.match(/\d+/g)||[];for(const s of a)for(const l of i){if(s===l&&s.length>=n)return!0;if(s.length>=n&&l.length>=n){const f=s.slice(-n),d=l.slice(-n);if(f===d)return!0}}return!1}isEcoleMatch(t,r){const n=this.normalizeId(t),a=this.normalizeId(r);if(!n||!a)return!1;if(n===a||n.includes(a)||a.includes(n)||this.hasCommonNumericSeq(n,a,4))return!0;const i=n.slice(-6),s=a.slice(-6);return!!(i&&s&&i===s)}resetLicence(){localStorage.removeItem(Il),localStorage.removeItem(US),localStorage.removeItem(px)}async importPublicKey(t){const r=t.replace(/-----BEGIN PUBLIC KEY-----|-----END PUBLIC KEY-----|\n/g,""),n=Uint8Array.from(atob(r),a=>a.charCodeAt(0));return await crypto.subtle.importKey("spki",n.buffer,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!1,["verify"])}base64UrlToUint8Array(t){let r=t.replace(/-/g,"+").replace(/_/g,"/");const n=r.length%4;n&&(r+="=".repeat(4-n));const a=atob(r),i=new Uint8Array(a.length);for(let s=0;s<a.length;++s)i[s]=a.charCodeAt(s);return i}}const Mi=Vl.getInstance(),g4=j.createContext({showToast:()=>{}});function Xr(){return j.useContext(g4)}function F5({children:e}){const[t,r]=j.useState([]),n=(l,f="info")=>{const d=Date.now();r(h=>[...h,{id:d,type:f,message:l}]),setTimeout(()=>{r(h=>h.filter(m=>m.id!==d))},4e3)},a=l=>{r(f=>f.filter(d=>d.id!==l))},i=l=>{switch(l){case"success":return o.jsx(Oa,{className:"h-5 w-5 text-green-600"});case"error":return o.jsx(ti,{className:"h-5 w-5 text-red-600"});default:return o.jsx(d4,{className:"h-5 w-5 text-blue-600"})}},s=l=>{switch(l){case"success":return"bg-white border-green-200 text-green-800";case"error":return"bg-white border-red-200 text-red-800";default:return"bg-white border-blue-200 text-blue-800"}};return o.jsxs(g4.Provider,{value:{showToast:n},children:[e,o.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(l=>o.jsxs("div",{className:`flex items-center space-x-3 px-4 py-3 rounded-lg border shadow-lg max-w-sm ${s(l.type)}`,children:[i(l.type),o.jsx("span",{className:"flex-1 text-sm font-medium",children:l.message}),o.jsx("button",{onClick:()=>a(l.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(qs,{className:"h-4 w-4"})})]},l.id))})]})}function v4(){const{showToast:e}=Xr(),[t,r]=j.useState(null),[n,a]=j.useState({nom:"",codeEtablissement:"",adresse:"",telephone:"",email:"",logo:"",devise:"FCFA",anneeScolaireActive:new Date().getFullYear()+"-"+(new Date().getFullYear()+1)}),[i,s]=j.useState(!1),[l,f]=j.useState(()=>({}));j.useEffect(()=>{const m=pe.getAll("ecole")[0];m&&(r(m),a({nom:m.nom||"",codeEtablissement:m.codeEtablissement||"",adresse:m.adresse||"",telephone:m.telephone||"",email:m.email||"",logo:m.logo||"",devise:m.devise||"FCFA",anneeScolaireActive:m.anneeScolaireActive||new Date().getFullYear()+"-"+(new Date().getFullYear()+1)}))},[]);const d=m=>{const x=m.target.files?.[0];if(x){const v=new FileReader;v.onload=y=>{a(g=>({...g,logo:y.target?.result}))},v.readAsDataURL(x)}},h=async()=>{const m={};if((!n.nom||n.nom.trim().length<3)&&(m.nom="Entrez le nom complet de l'établissement (min. 3 caractères)."),(!n.codeEtablissement||n.codeEtablissement.trim().length<2)&&(m.codeEtablissement="Entrez un code établissement valide."),f(m),Object.keys(m).length>0){try{e("Veuillez corriger les erreurs du formulaire","error")}catch{}return}s(!0);try{if(t){const x=pe.update("ecole",t.id,n);if(x){r(x),e("Configuration de l'école mise à jour","success");try{const v=Bs();v.eleves&&(v.eleves.etablissement=n.nom||v.eleves.etablissement,v.eleves.logo=n.logo||v.eleves.logo),v.recu&&(v.recu.etablissement=n.nom||v.recu.etablissement||"",v.recu.logo=n.logo||v.recu.logo),qu(v)}catch{}}}else{const x=pe.create("ecole",n);r(x),e("Configuration de l'école créée","success");try{window.dispatchEvent(new CustomEvent("ecole:created",{detail:{ecole:x}}))}catch{}try{Mi.createTrialLicence&&Mi.createTrialLicence()}catch{}try{const v=Bs();v.eleves&&(v.eleves.etablissement=n.nom||v.eleves.etablissement,v.eleves.logo=n.logo||v.eleves.logo),v.recu&&(v.recu.etablissement=n.nom||v.recu.etablissement||"",v.recu.logo=n.logo||v.recu.logo),qu(v)}catch{}}}catch{e("Erreur lors de la sauvegarde","error")}finally{s(!1)}};return o.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(c4,{className:"h-6 w-6 text-gray-600"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Configuration de l'École"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Paramètres généraux et informations de l'établissement"})]})]})}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Informations de l'établissement"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Ces informations apparaîtront sur tous les documents imprimés"})]}),o.jsxs("div",{className:"p-6 space-y-8",children:[o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"lg:col-span-1",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Logo de l'école"}),o.jsx("div",{className:"relative",children:o.jsxs("div",{className:"w-full h-48 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center relative overflow-hidden group hover:border-gray-400 transition-colors",children:[n.logo?o.jsxs(o.Fragment,{children:[o.jsx("img",{src:n.logo,alt:"Logo école",className:"w-full h-full object-contain"}),o.jsx("button",{onClick:()=>a(m=>({...m,logo:""})),className:"absolute top-2 right-2 p-1 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors",children:o.jsx(qs,{className:"h-4 w-4 text-gray-600"})})]}):o.jsxs("div",{className:"text-center",children:[o.jsx(Ls,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-gray-500 text-sm",children:"Cliquez pour ajouter un logo"}),o.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"PNG, JPG jusqu'à 5MB"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:d,className:"absolute inset-0 opacity-0 cursor-pointer"})]})})]}),o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom complet de l'établissement ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.nom,onChange:m=>a(x=>({...x,nom:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"Ex: École Primaire Excellence"}),l.nom&&o.jsx("div",{className:"text-sm text-red-600 mt-1",children:l.nom})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Code établissement ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.codeEtablissement,onChange:m=>a(x=>({...x,codeEtablissement:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"Ex: ECOLE001, EPE2025..."}),l.codeEtablissement&&o.jsx("div",{className:"text-sm text-red-600 mt-1",children:l.codeEtablissement}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Code unique d'identification de votre établissement"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Devise"}),o.jsxs("select",{value:n.devise,onChange:m=>a(x=>({...x,devise:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",children:[o.jsx("option",{value:"FCFA",children:"FCFA"}),o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"USD",children:"USD"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Année scolaire active"}),o.jsx("input",{type:"text",value:n.anneeScolaireActive,onChange:m=>a(x=>({...x,anneeScolaireActive:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"2025-2026"})]})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Coordonnées de contact"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Téléphone"}),o.jsx("input",{type:"tel",value:n.telephone,onChange:m=>a(x=>({...x,telephone:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"+225 XX XX XX XX XX"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email (optionnel)"}),o.jsx("input",{type:"email",value:n.email,onChange:m=>a(x=>({...x,email:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"contact@ecole.ci"})]})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse complète"}),o.jsx("textarea",{value:n.adresse,onChange:m=>a(x=>({...x,adresse:m.target.value})),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors resize-none",placeholder:"Adresse complète de l'établissement"})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Aperçu sur les documents"}),o.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[n.logo&&o.jsx("img",{src:n.logo,alt:"Logo",className:"h-16 mx-auto mb-4"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("h4",{className:"text-xl font-bold text-gray-900",children:n.nom||"Nom de l'école"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Code: ",n.codeEtablissement||"CODE_ECOLE"]}),o.jsx("p",{className:"text-gray-600",children:n.adresse||"Adresse de l'école"}),o.jsxs("p",{className:"text-gray-600",children:[n.telephone||"Téléphone",n.email&&` • ${n.email}`]})]})]})})]}),o.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:o.jsxs("button",{onClick:h,disabled:i||Object.keys(l).length>0,className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 focus:ring-2 focus:ring-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[i?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Gs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:i?"Sauvegarde...":"Enregistrer la configuration"})]})})]})]})]})}function D5({children:e}){const[t,r]=j.useState(null),[n,a]=j.useState(!1),[i,s]=j.useState(""),[l,f]=j.useState(!1),[d,h]=j.useState(""),[m,x]=j.useState(!1);j.useEffect(()=>{v();const g=setInterval(v,3600*1e3),b=()=>{x(!1),v()};return window.addEventListener("ecole:created",b),()=>{clearInterval(g),window.removeEventListener("ecole:created",b)}},[]);const v=async()=>{await Mi.updateLicenceFromServer();const g=await Mi.checkLicenceStatus();r(g)},y=()=>{if(!i.trim()){h("Veuillez entrer une clé de licence");return}f(!0);try{const g=Mi.activateLicence(i.trim());g.success?(h(g.message),s(""),setTimeout(()=>{a(!1),v()},2e3)):h(g.message)}catch{h("Erreur lors de l'activation de la licence")}finally{f(!1)}};return t?t.isValid&&!t.isExpired?o.jsxs(o.Fragment,{children:[e,t.daysRemaining<=7&&o.jsx("div",{className:"fixed bottom-4 right-4 bg-white border border-gray-200 rounded-lg shadow-lg p-4 max-w-sm",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(I0,{className:"h-5 w-5 text-amber-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold text-gray-900",children:"Licence expire bientôt"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Plus que ",t.daysRemaining," jour(s)"]})]})]})})]}):m?o.jsx(v4,{}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 max-w-lg w-full",children:[o.jsxs("div",{className:"p-8 text-center border-b border-gray-200",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:o.jsx(p4,{className:"h-8 w-8 text-gray-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Licence Expirée"}),o.jsx("p",{className:"text-gray-600",children:"Votre licence KlasNet a expiré"})]}),o.jsxs("div",{className:"p-8 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[o.jsx(ti,{className:"h-5 w-5 text-red-600"}),o.jsx("h3",{className:"font-semibold text-gray-900",children:"Statut de la licence"})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Type:"}),o.jsx("span",{className:"font-medium text-gray-900 capitalize",children:t.type})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Expiration:"}),o.jsx("span",{className:"font-medium text-gray-900",children:t.dateExpiration?new Date(t.dateExpiration).toLocaleDateString("fr-FR"):"Non définie"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Jours restants:"}),o.jsx("span",{className:"font-bold text-red-600",children:t.daysRemaining})]})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:()=>x(!0),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[o.jsx(R0,{className:"h-5 w-5"}),o.jsx("span",{children:"Configurer l'application"})]}),o.jsxs("button",{onClick:()=>a(!n),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:[o.jsx(M0,{className:"h-5 w-5"}),o.jsx("span",{children:"Activer une nouvelle licence"})]})]}),n&&o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Activation manuelle"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Clé de licence"}),o.jsx("textarea",{value:i,onChange:g=>s(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors resize-none font-mono text-sm",rows:4,placeholder:"Collez votre clé de licence ici..."})]}),d&&o.jsx("div",{className:`p-4 rounded-lg ${d.includes("succès")?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:o.jsxs("div",{className:"flex items-center space-x-2",children:[d.includes("succès")?o.jsx(Oa,{className:"h-5 w-5"}):o.jsx(ti,{className:"h-5 w-5"}),o.jsx("span",{className:"text-sm",children:d})]})}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:()=>{a(!1),s(""),h("")},className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:y,disabled:l||!i.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:[l?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(M0,{className:"h-4 w-4"}),o.jsx("span",{children:l?"Activation...":"Activer"})]})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Besoin d'une licence ?"}),o.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[o.jsxs("p",{children:["📞 ",o.jsx("strong",{children:"Téléphone:"})," +2250555863953"]}),o.jsxs("p",{children:["📧 ",o.jsx("strong",{children:"Email:"})," Non disponible"]}),o.jsxs("p",{children:["🌐 ",o.jsx("strong",{children:"Site web:"})," Non disponible"]})]})]})]}),o.jsx("div",{className:"bg-gray-50 px-8 py-4 text-center border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-gray-500",children:"© 2025 KlasNet - Logiciel de Gestion Scolaire"})})]})}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 max-w-md w-full mx-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Vérification de la licence"}),o.jsx("p",{className:"text-gray-600",children:"Veuillez patienter..."})]})})})}const w1="current_user_id";function Rh(){const e=pe.getAll("utilisateurs"),t={"poupouya@ecole.local":"eyemon2024",directeur:"director2024",enseignant:"teacher2024",poupouya:"eyemon2024"};try{window.localStorage.setItem("__pw_map__",JSON.stringify(t)),console.log("Mots de passe forcés:",t)}catch(l){console.error("Erreur stockage mots de passe:",l)}const r=["poupouya@ecole.local","directeur","enseignant","poupouya"],n=e.map(l=>l.nomUtilisateur),a=r.filter(l=>!n.includes(l)),i=new Date().toISOString();[{nom:"POUPOUYA",prenoms:"Mme",nomUtilisateur:"poupouya@ecole.local",role:"Secrétaire",actif:!0},{nom:"POUPOUYA",prenoms:"Mme",nomUtilisateur:"poupouya",role:"Secrétaire",actif:!0},{nom:"DIRECTEUR",prenoms:"M.",nomUtilisateur:"directeur",role:"Admin",actif:!0},{nom:"ENSEIGNANT",prenoms:"M.",nomUtilisateur:"enseignant",role:"Enseignant",actif:!0},{nom:"TEACHER",prenoms:"Prof",nomUtilisateur:"teacher",role:"Enseignant",actif:!0}].forEach(l=>{a.includes(l.nomUtilisateur)&&(console.log("Création utilisateur:",l.nomUtilisateur),pe.create("utilisateurs",{...l,createdAt:i}))})}function y4(e,t){Rh();const r={"poupouya@ecole.local":"eyemon2024",directeur:"director2024",enseignant:"teacher2024",poupouya:"eyemon2024"};try{window.localStorage.setItem("__pw_map__",JSON.stringify(r))}catch(s){console.error("Erreur stockage mots de passe:",s)}const n=r;if(console.log("Tentative de connexion:",e),console.log("Mots de passe disponibles:",Object.keys(n)),console.log("Mot de passe fourni:",t),console.log("Mot de passe attendu:",n[e]),n[e]!==t)return null;const i=pe.getAll("utilisateurs").find(s=>s.nomUtilisateur===e&&s.actif)||null;if(console.log("Utilisateur trouvé:",i),i){try{window.localStorage.setItem(w1,i.id)}catch{}return i}return null}function S1(){try{window.localStorage.removeItem(w1)}catch{}}function Lh(){Rh();try{const e=window.localStorage.getItem(w1);return e?pe.getById("utilisateurs",e):null}catch{return null}}function b4(e,t,r){try{const n=JSON.parse(String(window.localStorage.getItem("__pw_map__")||"{}"));return typeof r<"u"&&n[e]!==r?!1:(n[e]=t,window.localStorage.setItem("__pw_map__",JSON.stringify(n)),!0)}catch{return!1}}function w4(e,t,r){try{const n=JSON.parse(String(window.localStorage.getItem("__pw_map__")||"{}"));if(n[t]||typeof r<"u"&&n[e]!==r)return!1;const i=pe.getAll("utilisateurs").find(s=>s.nomUtilisateur===e);return i?(pe.update("utilisateurs",i.id,{nomUtilisateur:t}),n[e]&&(n[t]=n[e],delete n[e],window.localStorage.setItem("__pw_map__",JSON.stringify(n))),!0):!1}catch{return!1}}const Fs={seedUsers:Rh,login:y4,logout:S1,getCurrentUser:Lh,changePassword:b4,changeUsername:w4},WS=Object.freeze(Object.defineProperty({__proto__:null,changePassword:b4,changeUsername:w4,default:Fs,getCurrentUser:Lh,login:y4,logout:S1,seedUsers:Rh},Symbol.toStringTag,{value:"Module"}));function yt(e){if(!e)return"";const t=(e.nom||"").toString().trim(),r=(e.prenoms||"").toString().trim();return!t&&!r?"":t?r?`${t} ${r}`:t:r}function T0(e){if(!e)return"";const t=(e.nom||"").toString().trim(),r=(e.prenoms||"").toString().trim();return!t&&!r?"":r?`${r} ${t}`:t}function I5({onLogin:e}){const[t,r]=j.useState(""),[n,a]=j.useState(""),[i,s]=j.useState(!1),[l,f]=j.useState(!1),{showToast:d}=Xr(),h=async m=>{if(m.preventDefault(),!t||!n){d("Veuillez remplir tous les champs","error");return}f(!0);try{const x=Fs.login(t,n);x?(d(`Bienvenue ${yt(x)}`,"success"),e(x)):d("Nom d'utilisateur ou mot de passe incorrect","error")}catch{d("Erreur de connexion","error")}finally{f(!1)}};return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 w-full max-w-md",children:[o.jsxs("div",{className:"p-8 text-center border-b border-gray-200",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-900 rounded-lg flex items-center justify-center mx-auto mb-4",children:o.jsx(m4,{className:"h-8 w-8 text-white"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"KlasNet"}),o.jsx("p",{className:"text-gray-600",children:"Gestion Scolaire"})]}),o.jsx("div",{className:"p-8",children:o.jsxs("form",{onSubmit:h,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom d'utilisateur"}),o.jsxs("div",{className:"relative",children:[o.jsx(Uo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:t,onChange:m=>r(m.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"votre_nom_utilisateur",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(E5,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:i?"text":"password",value:n,onChange:m=>a(m.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"••••••••",required:!0}),o.jsx("button",{type:"button",onClick:()=>s(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?o.jsx(y5,{className:"h-5 w-5"}):o.jsx(f4,{className:"h-5 w-5"})})]})]}),o.jsx("button",{type:"submit",disabled:l,className:"w-full bg-gray-900 text-white py-3 px-4 rounded-lg font-medium hover:bg-gray-800 focus:ring-2 focus:ring-gray-900 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Connexion..."]}):"Se connecter"})]})}),o.jsx("div",{className:"bg-gray-50 px-8 py-4 text-center border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-gray-500",children:"© 2025 KlasNet - Gestion Scolaire Côte d'Ivoire"})})]})})}function M5({currentUser:e,onLogout:t,onNavigate:r,currentPage:n,onShowGuide:a}){const[i,s]=j.useState(new Date),[l,f]=j.useState(!1),[d,h]=j.useState(!1),m=j.useRef(null),x=g=>g?g.charAt(0).toUpperCase()+g.slice(1).toLowerCase():"";j.useEffect(()=>{const g=setInterval(()=>s(new Date),1e3);return()=>clearInterval(g)},[]),j.useEffect(()=>{const g=N=>{const _=N.target;m.current&&!m.current.contains(_)&&f(!1)},b=N=>{N.key==="Escape"&&f(!1)};return document.addEventListener("mousedown",g),document.addEventListener("keydown",b),()=>{document.removeEventListener("mousedown",g),document.removeEventListener("keydown",b)}},[]);const v=[{id:"dashboard",label:"Tableau de bord"},{id:"eleves",label:"Élèves"},{id:"enseignants",label:"Enseignants"},{id:"classes",label:"Classes"},{id:"matieres",label:"Matières"},{id:"finances",label:"Finances"},{id:"notes",label:"Notes"},{id:"config",label:"Configuration"},{id:"comptabilite",label:"Comptabilité"}],y=()=>f(g=>!g);return o.jsxs("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:[o.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-900 rounded-lg flex items-center justify-center",children:o.jsx(m4,{className:"h-5 w-5 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"KlasNet"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Gestion Scolaire"})]})]}),o.jsx("div",{className:"hidden lg:block bg-gray-50 px-3 py-1 rounded-md border border-gray-200",children:o.jsx("div",{className:"text-xs text-gray-500",children:i.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})})]}),o.jsx("nav",{className:"hidden md:flex space-x-1",children:v.map(g=>o.jsx("button",{onClick:()=>{try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:g.id}}))}catch{r(g.id)}},className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${n===g.id?"bg-gray-900 text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:g.label},g.id))}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{className:"hidden md:block px-3 py-1 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",onClick:()=>a&&a(),children:"Guide"}),o.jsxs("div",{className:"relative",ref:m,children:[o.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 px-3 py-2 rounded-md transition-colors",onClick:y,children:[e&&e.avatar?o.jsx("img",{src:e.avatar,alt:"avatar",className:"h-8 w-8 rounded-full object-cover border border-gray-200"}):o.jsx("div",{className:"h-8 w-8 bg-gray-100 rounded-full flex items-center justify-center border border-gray-200",children:o.jsx(Uo,{className:"h-4 w-4 text-gray-500"})}),o.jsxs("div",{className:"hidden sm:block text-sm text-gray-700",children:[o.jsx("div",{className:"font-medium",children:yt(e)}),o.jsx("div",{className:"text-xs text-gray-500",children:x(e?.role)})]})]}),l&&o.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-md shadow-lg z-50",children:[o.jsx("button",{onClick:()=>{f(!1);try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"profil"}}))}catch{r("profil")}},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Profil"}),o.jsx("button",{onClick:()=>{f(!1);try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"parametres"}}))}catch{r("parametres")}},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Paramètres"}),o.jsx("div",{className:"border-t border-gray-200"}),o.jsx("button",{onClick:t,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Déconnexion"})]})]}),o.jsx("button",{className:"md:hidden p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors",onClick:()=>h(!d),children:d?o.jsx(qs,{className:"h-5 w-5"}):o.jsx(k5,{className:"h-5 w-5"})})]})]})}),d&&o.jsx("div",{className:"md:hidden border-t border-gray-200 bg-white",children:o.jsxs("div",{className:"px-4 py-2 space-y-1",children:[v.map(g=>o.jsx("button",{onClick:()=>{try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:g.id}}))}catch{r(g.id)}h(!1)},className:`w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors ${n===g.id?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-50"}`,children:g.label},g.id)),o.jsx("button",{className:"w-full text-left px-3 py-2 text-sm text-gray-600 hover:bg-gray-50 rounded-md transition-colors",onClick:()=>{a&&a(),h(!1)},children:"Guide"})]})})]})}function gc({open:e,title:t="Quitter sans sauvegarder ?",description:r="Vous avez des modifications non sauvegardées. Voulez-vous vraiment quitter et perdre vos changements ?",onConfirm:n,onCancel:a}){return e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),o.jsx("p",{className:"text-sm text-gray-600 mt-2",children:r}),o.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[o.jsx("button",{onClick:a,className:"px-4 py-2 rounded-md bg-gray-100 text-gray-700",children:"Retour"}),o.jsx("button",{onClick:n,className:"px-4 py-2 rounded-md bg-red-600 text-white",children:"Quitter sans sauvegarder"})]})]})}):null}function S4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=S4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function It(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=S4(e))&&(n&&(n+=" "),n+=t);return n}var xx={},gx={},HS;function R5(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(gx)),gx}var vx={},VS;function N4(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(vx)),vx}var yx={},KS;function E4(){return KS||(KS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(yx)),yx}var bx={},GS;function N1(){return GS||(GS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],a=r.length;if(a===0)return n;let i=0,s="",l="",f=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const d=r[i];l?d==="\\"&&i+1<a?(i++,s+=r[i]):d===l?l="":s+=d:f?d==='"'||d==="'"?l=d:d==="]"?(f=!1,n.push(s),s=""):s+=d:d==="["?(f=!0,s&&(n.push(s),s="")):d==="."?s&&(n.push(s),s=""):s+=d,i++}return s&&n.push(s),n}e.toPath=t})(bx)),bx}var qS;function E1(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=R5(),r=N4(),n=E4(),a=N1();function i(l,f,d){if(l==null)return d;switch(typeof f){case"string":{if(t.isUnsafeProperty(f))return d;const h=l[f];return h===void 0?r.isDeepKey(f)?i(l,a.toPath(f),d):d:h}case"number":case"symbol":{typeof f=="number"&&(f=n.toKey(f));const h=l[f];return h===void 0?d:h}default:{if(Array.isArray(f))return s(l,f,d);if(Object.is(f?.valueOf(),-0)?f="-0":f=String(f),t.isUnsafeProperty(f))return d;const h=l[f];return h===void 0?d:h}}}function s(l,f,d){if(f.length===0)return d;let h=l;for(let m=0;m<f.length;m++){if(h==null||t.isUnsafeProperty(f[m]))return d;h=h[f[m]]}return h===void 0?d:h}e.get=i})(xx)),xx}var wx,XS;function L5(){return XS||(XS=1,wx=E1().get),wx}var B5=L5();const Wo=es(B5);var Sx={exports:{}},Rt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YS;function $5(){if(YS)return Rt;YS=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),v=Symbol.for("react.client.reference");function y(g){if(typeof g=="object"&&g!==null){var b=g.$$typeof;switch(b){case e:switch(g=g.type,g){case r:case a:case n:case f:case d:case x:return g;default:switch(g=g&&g.$$typeof,g){case s:case l:case m:case h:return g;case i:return g;default:return b}}case t:return b}}}return Rt.ContextConsumer=i,Rt.ContextProvider=s,Rt.Element=e,Rt.ForwardRef=l,Rt.Fragment=r,Rt.Lazy=m,Rt.Memo=h,Rt.Portal=t,Rt.Profiler=a,Rt.StrictMode=n,Rt.Suspense=f,Rt.SuspenseList=d,Rt.isContextConsumer=function(g){return y(g)===i},Rt.isContextProvider=function(g){return y(g)===s},Rt.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===e},Rt.isForwardRef=function(g){return y(g)===l},Rt.isFragment=function(g){return y(g)===r},Rt.isLazy=function(g){return y(g)===m},Rt.isMemo=function(g){return y(g)===h},Rt.isPortal=function(g){return y(g)===t},Rt.isProfiler=function(g){return y(g)===a},Rt.isStrictMode=function(g){return y(g)===n},Rt.isSuspense=function(g){return y(g)===f},Rt.isSuspenseList=function(g){return y(g)===d},Rt.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===r||g===a||g===n||g===f||g===d||typeof g=="object"&&g!==null&&(g.$$typeof===m||g.$$typeof===h||g.$$typeof===s||g.$$typeof===i||g.$$typeof===l||g.$$typeof===v||g.getModuleId!==void 0)},Rt.typeOf=y,Rt}var JS;function U5(){return JS||(JS=1,Sx.exports=$5()),Sx.exports}var z5=U5(),Kr=e=>e===0?0:e>0?1:-1,ca=e=>typeof e=="number"&&e!=+e,jo=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Ze=e=>(typeof e=="number"||e instanceof Number)&&!ca(e),vi=e=>Ze(e)||typeof e=="string",W5=0,Xu=e=>{var t=++W5;return"".concat(e||"").concat(t)},bn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ze(t)&&typeof t!="string")return n;var i;if(jo(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return ca(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},_4=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function on(e,t,r){return Ze(e)&&Ze(t)?e+r*(t-e):t}function H5(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Wo(n,t))===r)}var qr=e=>e===null||typeof e>"u",Sf=e=>qr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),V5=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function _1(e){if(typeof e!="string")return!1;var t=V5;return t.includes(e)}var K5=["viewBox","children"],QS=["points","pathLength"],Nx={svg:K5,polygon:QS,polyline:QS},G5=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(j.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{_1(a)&&(n[a]=(i=>r[a](r,i)))}),n},q5=(e,t,r)=>n=>(e(t,r,n),null),Nf=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];_1(a)&&typeof i=="function"&&(n||(n={}),n[a]=q5(i,t,r))}),n},X5=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function k4(e){if(typeof e!="string")return!1;var t=X5;return t.includes(e)}function tl(e){var t=Object.entries(e).filter(r=>{var[n]=r;return k4(n)});return Object.fromEntries(t)}var ZS=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",eN=null,Ex=null,j4=e=>{if(e===eN&&Array.isArray(Ex))return Ex;var t=[];return j.Children.forEach(e,r=>{qr(r)||(z5.isFragment(r)?t=t.concat(j4(r.props.children)):t.push(r))}),Ex=t,eN=e,t};function k1(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>ZS(a)):n=[ZS(t)],j4(e).forEach(a=>{var i=Wo(a,"type.displayName")||Wo(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var Y5=(e,t,r,n)=>{var a;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(a=n&&Nx?.[n])!==null&&a!==void 0?a:[],s=t.startsWith("data-"),l=typeof e!="function"&&(!!n&&i.includes(t)||k4(t)),f=!!r&&_1(t);return s||l||f},jr=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(j.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var s;Y5((s=n)===null||s===void 0?void 0:s[i],i,t,r)&&(a[i]=n[i])}),a},J5=["children","width","height","viewBox","className","style","title","desc"];function fv(){return fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fv.apply(null,arguments)}function Q5(e,t){if(e==null)return{};var r,n,a=Z5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Z5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var j1=j.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:l,title:f,desc:d}=e,h=Q5(e,J5),m=i||{width:n,height:a,x:0,y:0},x=It("recharts-surface",s);return j.createElement("svg",fv({},jr(h,!0,"svg"),{className:x,width:n,height:a,style:l,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),j.createElement("title",null,f),j.createElement("desc",null,d),r)}),eD=["children","className"];function dv(){return dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dv.apply(null,arguments)}function tD(e,t){if(e==null)return{};var r,n,a=rD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Kn=j.forwardRef((e,t)=>{var{children:r,className:n}=e,a=tD(e,eD),i=It("recharts-layer",n);return j.createElement("g",dv({className:i},jr(a,!0),{ref:t}),r)}),C4=l4(),A4=j.createContext(null),nD=()=>j.useContext(A4);function Wt(e){return function(){return e}}const T4=Math.cos,L0=Math.sin,ri=Math.sqrt,B0=Math.PI,Bh=2*B0,hv=Math.PI,mv=2*hv,So=1e-6,aD=mv-So;function P4(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function iD(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return P4;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class sD{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?P4:iD(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,f=n-t,d=a-r,h=s-t,m=l-r,x=h*h+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(x>So)if(!(Math.abs(m*f-d*h)>So)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let v=n-s,y=a-l,g=f*f+d*d,b=v*v+y*y,N=Math.sqrt(g),_=Math.sqrt(x),S=i*Math.tan((hv-Math.acos((g+x-b)/(2*N*_)))/2),C=S/_,T=S/N;Math.abs(C-1)>So&&this._append`L${t+C*h},${r+C*m}`,this._append`A${i},${i},0,0,${+(m*v>h*y)},${this._x1=t+T*f},${this._y1=r+T*d}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),f=n*Math.sin(a),d=t+l,h=r+f,m=1^s,x=s?a-i:i-a;this._x1===null?this._append`M${d},${h}`:(Math.abs(this._x1-d)>So||Math.abs(this._y1-h)>So)&&this._append`L${d},${h}`,n&&(x<0&&(x=x%mv+mv),x>aD?this._append`A${n},${n},0,1,${m},${t-l},${r-f}A${n},${n},0,1,${m},${this._x1=d},${this._y1=h}`:x>So&&this._append`A${n},${n},0,${+(x>=hv)},${m},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function C1(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new sD(t)}function A1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function O4(e){this._context=e}O4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $h(e){return new O4(e)}function F4(e){return e[0]}function D4(e){return e[1]}function I4(e,t){var r=Wt(!0),n=null,a=$h,i=null,s=C1(l);e=typeof e=="function"?e:e===void 0?F4:Wt(e),t=typeof t=="function"?t:t===void 0?D4:Wt(t);function l(f){var d,h=(f=A1(f)).length,m,x=!1,v;for(n==null&&(i=a(v=s())),d=0;d<=h;++d)!(d<h&&r(m=f[d],d,f))===x&&((x=!x)?i.lineStart():i.lineEnd()),x&&i.point(+e(m,d,f),+t(m,d,f));if(v)return i=null,v+""||null}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Wt(+f),l):e},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Wt(+f),l):t},l.defined=function(f){return arguments.length?(r=typeof f=="function"?f:Wt(!!f),l):r},l.curve=function(f){return arguments.length?(a=f,n!=null&&(i=a(n)),l):a},l.context=function(f){return arguments.length?(f==null?n=i=null:i=a(n=f),l):n},l}function t0(e,t,r){var n=null,a=Wt(!0),i=null,s=$h,l=null,f=C1(d);e=typeof e=="function"?e:e===void 0?F4:Wt(+e),t=typeof t=="function"?t:Wt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?D4:Wt(+r);function d(m){var x,v,y,g=(m=A1(m)).length,b,N=!1,_,S=new Array(g),C=new Array(g);for(i==null&&(l=s(_=f())),x=0;x<=g;++x){if(!(x<g&&a(b=m[x],x,m))===N)if(N=!N)v=x,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),y=x-1;y>=v;--y)l.point(S[y],C[y]);l.lineEnd(),l.areaEnd()}N&&(S[x]=+e(b,x,m),C[x]=+t(b,x,m),l.point(n?+n(b,x,m):S[x],r?+r(b,x,m):C[x]))}if(_)return l=null,_+""||null}function h(){return I4().defined(a).curve(s).context(i)}return d.x=function(m){return arguments.length?(e=typeof m=="function"?m:Wt(+m),n=null,d):e},d.x0=function(m){return arguments.length?(e=typeof m=="function"?m:Wt(+m),d):e},d.x1=function(m){return arguments.length?(n=m==null?null:typeof m=="function"?m:Wt(+m),d):n},d.y=function(m){return arguments.length?(t=typeof m=="function"?m:Wt(+m),r=null,d):t},d.y0=function(m){return arguments.length?(t=typeof m=="function"?m:Wt(+m),d):t},d.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:Wt(+m),d):r},d.lineX0=d.lineY0=function(){return h().x(e).y(t)},d.lineY1=function(){return h().x(e).y(r)},d.lineX1=function(){return h().x(n).y(t)},d.defined=function(m){return arguments.length?(a=typeof m=="function"?m:Wt(!!m),d):a},d.curve=function(m){return arguments.length?(s=m,i!=null&&(l=s(i)),d):s},d.context=function(m){return arguments.length?(m==null?i=l=null:l=s(i=m),d):i},d}class M4{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function oD(e){return new M4(e,!0)}function lD(e){return new M4(e,!1)}const T1={draw(e,t){const r=ri(t/B0);e.moveTo(r,0),e.arc(0,0,r,0,Bh)}},cD={draw(e,t){const r=ri(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},R4=ri(1/3),uD=R4*2,fD={draw(e,t){const r=ri(t/uD),n=r*R4;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},dD={draw(e,t){const r=ri(t),n=-r/2;e.rect(n,n,r,r)}},hD=.8908130915292852,L4=L0(B0/10)/L0(7*B0/10),mD=L0(Bh/10)*L4,pD=-T4(Bh/10)*L4,xD={draw(e,t){const r=ri(t*hD),n=mD*r,a=pD*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=Bh*i/5,l=T4(s),f=L0(s);e.lineTo(f*r,-l*r),e.lineTo(l*n-f*a,f*n+l*a)}e.closePath()}},_x=ri(3),gD={draw(e,t){const r=-ri(t/(_x*3));e.moveTo(0,r*2),e.lineTo(-_x*r,-r),e.lineTo(_x*r,-r),e.closePath()}},ba=-.5,wa=ri(3)/2,pv=1/ri(12),vD=(pv/2+1)*3,yD={draw(e,t){const r=ri(t/vD),n=r/2,a=r*pv,i=n,s=r*pv+r,l=-i,f=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,f),e.lineTo(ba*n-wa*a,wa*n+ba*a),e.lineTo(ba*i-wa*s,wa*i+ba*s),e.lineTo(ba*l-wa*f,wa*l+ba*f),e.lineTo(ba*n+wa*a,ba*a-wa*n),e.lineTo(ba*i+wa*s,ba*s-wa*i),e.lineTo(ba*l+wa*f,ba*f-wa*l),e.closePath()}};function bD(e,t){let r=null,n=C1(a);e=typeof e=="function"?e:Wt(e||T1),t=typeof t=="function"?t:Wt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Wt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Wt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function $0(){}function U0(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function B4(e){this._context=e}B4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:U0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:U0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function wD(e){return new B4(e)}function $4(e){this._context=e}$4.prototype={areaStart:$0,areaEnd:$0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:U0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function SD(e){return new $4(e)}function U4(e){this._context=e}U4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:U0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ND(e){return new U4(e)}function z4(e){this._context=e}z4.prototype={areaStart:$0,areaEnd:$0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function ED(e){return new z4(e)}function tN(e){return e<0?-1:1}function rN(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(tN(i)+tN(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function nN(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function kx(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function z0(e){this._context=e}z0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:kx(this,this._t0,nN(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,kx(this,nN(this,r=rN(this,e,t)),r);break;default:kx(this,this._t0,r=rN(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function W4(e){this._context=new H4(e)}(W4.prototype=Object.create(z0.prototype)).point=function(e,t){z0.prototype.point.call(this,t,e)};function H4(e){this._context=e}H4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function _D(e){return new z0(e)}function kD(e){return new W4(e)}function V4(e){this._context=e}V4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=aN(e),a=aN(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function aN(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function jD(e){return new V4(e)}function Uh(e,t){this._context=e,this._t=t}Uh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function CD(e){return new Uh(e,.5)}function AD(e){return new Uh(e,0)}function TD(e){return new Uh(e,1)}function rc(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function xv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function PD(e,t){return e[t]}function OD(e){const t=[];return t.key=e,t}function FD(){var e=Wt([]),t=xv,r=rc,n=PD;function a(i){var s=Array.from(e.apply(this,arguments),OD),l,f=s.length,d=-1,h;for(const m of i)for(l=0,++d;l<f;++l)(s[l][d]=[0,+n(m,s[l].key,d,i)]).data=m;for(l=0,h=A1(t(s));l<f;++l)s[h[l]].index=l;return r(s,h),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Wt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Wt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?xv:typeof i=="function"?i:Wt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??rc,a):r},a}function DD(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}rc(e,t)}}function ID(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}rc(e,t)}}function MD(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,f=0,d=0;l<s;++l){for(var h=e[t[l]],m=h[n][1]||0,x=h[n-1][1]||0,v=(m-x)/2,y=0;y<l;++y){var g=e[t[y]],b=g[n][1]||0,N=g[n-1][1]||0;v+=b-N}f+=m,d+=v*m}a[n-1][1]+=a[n-1][0]=r,f&&(r-=d/f)}a[n-1][1]+=a[n-1][0]=r,rc(e,t)}}var RD=["type","size","sizeType"];function gv(){return gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gv.apply(null,arguments)}function iN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iN(Object(r),!0).forEach(function(n){LD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LD(e,t,r){return(t=BD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BD(e){var t=$D(e,"string");return typeof t=="symbol"?t:t+""}function $D(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UD(e,t){if(e==null)return{};var r,n,a=zD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var K4={symbolCircle:T1,symbolCross:cD,symbolDiamond:fD,symbolSquare:dD,symbolStar:xD,symbolTriangle:gD,symbolWye:yD},WD=Math.PI/180,HD=e=>{var t="symbol".concat(Sf(e));return K4[t]||T1},VD=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*WD;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},KD=(e,t)=>{K4["symbol".concat(Sf(e))]=t},P1=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=UD(e,RD),i=sN(sN({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var l=()=>{var x=HD(s),v=bD().type(x).size(VD(r,n,s));return v()},{className:f,cx:d,cy:h}=i,m=jr(i,!0);return d===+d&&h===+h&&r===+r?j.createElement("path",gv({},m,{className:It("recharts-symbols",f),transform:"translate(".concat(d,", ").concat(h,")"),d:l()})):null};P1.registerSymbol=KD;function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vv.apply(null,arguments)}function oN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function GD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oN(Object(r),!0).forEach(function(n){O1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O1(e,t,r){return(t=qD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qD(e){var t=XD(e,"string");return typeof t=="symbol"?t:t+""}function XD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sa=32;class F1 extends j.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=Sa/2,i=Sa/6,s=Sa/3,l=t.inactive?n:t.color,f=r??t.type;if(f==="none")return null;if(f==="plainline")return j.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:Sa,y2:a,className:"recharts-legend-icon"});if(f==="line")return j.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(Sa,"M").concat(2*s,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(f==="rect")return j.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Sa/8,"h").concat(Sa,"v").concat(Sa*3/4,"h").concat(-Sa,"z"),className:"recharts-legend-icon"});if(j.isValidElement(t.legendIcon)){var d=GD({},t);return delete d.legendIcon,j.cloneElement(t.legendIcon,d)}return j.createElement(P1,{fill:l,cx:a,cy:a,size:Sa,sizeType:"diameter",type:f})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:s}=this.props,l={x:0,y:0,width:Sa,height:Sa},f={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((h,m)=>{var x=h.formatter||a,v=It({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:h.inactive});if(h.type==="none")return null;var y=h.inactive?i:h.color,g=x?x(h.value,h,m):h.value;return j.createElement("li",vv({className:v,style:f,key:"legend-item-".concat(m)},Nf(this.props,h,m)),j.createElement(j1,{width:r,height:r,viewBox:l,style:d,"aria-label":"".concat(g," legend icon")},this.renderIcon(h,s)),j.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},g))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return j.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}O1(F1,"displayName","Legend");O1(F1,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var jx={},Cx={},lN;function YD(){return lN||(lN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],l=n(s);a.has(l)||a.set(l,s)}return Array.from(a.values())}e.uniqBy=t})(Cx)),Cx}var Ax={},cN;function G4(){return cN||(cN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Ax)),Ax}var Tx={},Px={},Ox={},uN;function JD(){return uN||(uN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Ox)),Ox}var fN;function D1(){return fN||(fN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=JD();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Px)),Px}var Fx={},dN;function QD(){return dN||(dN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Fx)),Fx}var hN;function ZD(){return hN||(hN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D1(),r=QD();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(Tx)),Tx}var Dx={},Ix={},mN;function eI(){return mN||(mN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=E1();function r(n){return function(a){return t.get(a,n)}}e.property=r})(Ix)),Ix}var Mx={},Rx={},Lx={},Bx={},pN;function q4(){return pN||(pN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Bx)),Bx}var $x={},xN;function X4(){return xN||(xN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})($x)),$x}var Ux={},gN;function Y4(){return gN||(gN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(Ux)),Ux}var vN;function tI(){return vN||(vN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=I1(),r=q4(),n=X4(),a=Y4();function i(m,x,v){return typeof v!="function"?t.isMatch(m,x):s(m,x,function y(g,b,N,_,S,C){const T=v(g,b,N,_,S,C);return T!==void 0?!!T:s(g,b,y,C)},new Map)}function s(m,x,v,y){if(x===m)return!0;switch(typeof x){case"object":return l(m,x,v,y);case"function":return Object.keys(x).length>0?s(m,{...x},v,y):a.eq(m,x);default:return r.isObject(m)?typeof x=="string"?x==="":!0:a.eq(m,x)}}function l(m,x,v,y){if(x==null)return!0;if(Array.isArray(x))return d(m,x,v,y);if(x instanceof Map)return f(m,x,v,y);if(x instanceof Set)return h(m,x,v,y);const g=Object.keys(x);if(m==null)return g.length===0;if(g.length===0)return!0;if(y&&y.has(x))return y.get(x)===m;y&&y.set(x,m);try{for(let b=0;b<g.length;b++){const N=g[b];if(!n.isPrimitive(m)&&!(N in m)||x[N]===void 0&&m[N]!==void 0||x[N]===null&&m[N]!==null||!v(m[N],x[N],N,m,x,y))return!1}return!0}finally{y&&y.delete(x)}}function f(m,x,v,y){if(x.size===0)return!0;if(!(m instanceof Map))return!1;for(const[g,b]of x.entries()){const N=m.get(g);if(v(N,b,g,m,x,y)===!1)return!1}return!0}function d(m,x,v,y){if(x.length===0)return!0;if(!Array.isArray(m))return!1;const g=new Set;for(let b=0;b<x.length;b++){const N=x[b];let _=!1;for(let S=0;S<m.length;S++){if(g.has(S))continue;const C=m[S];let T=!1;if(v(C,N,b,m,x,y)&&(T=!0),T){g.add(S),_=!0;break}}if(!_)return!1}return!0}function h(m,x,v,y){return x.size===0?!0:m instanceof Set?d([...m],[...x],v,y):!1}e.isMatchWith=i,e.isSetMatch=h})(Lx)),Lx}var yN;function I1(){return yN||(yN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tI();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(Rx)),Rx}var zx={},Wx={},Hx={},bN;function rI(){return bN||(bN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(Hx)),Hx}var Vx={},wN;function J4(){return wN||(wN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Vx)),Vx}var Kx={},SN;function Q4(){return SN||(SN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",l="[object Date]",f="[object Map]",d="[object Set]",h="[object Array]",m="[object Function]",x="[object ArrayBuffer]",v="[object Object]",y="[object Error]",g="[object DataView]",b="[object Uint8Array]",N="[object Uint8ClampedArray]",_="[object Uint16Array]",S="[object Uint32Array]",C="[object BigUint64Array]",T="[object Int8Array]",k="[object Int16Array]",P="[object Int32Array]",D="[object BigInt64Array]",R="[object Float32Array]",G="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=x,e.arrayTag=h,e.bigInt64ArrayTag=D,e.bigUint64ArrayTag=C,e.booleanTag=a,e.dataViewTag=g,e.dateTag=l,e.errorTag=y,e.float32ArrayTag=R,e.float64ArrayTag=G,e.functionTag=m,e.int16ArrayTag=k,e.int32ArrayTag=P,e.int8ArrayTag=T,e.mapTag=f,e.numberTag=n,e.objectTag=v,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=_,e.uint32ArrayTag=S,e.uint8ArrayTag=b,e.uint8ClampedArrayTag=N})(Kx)),Kx}var Gx={},NN;function nI(){return NN||(NN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Gx)),Gx}var EN;function Z4(){return EN||(EN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rI(),r=J4(),n=Q4(),a=X4(),i=nI();function s(h,m){return l(h,void 0,h,new Map,m)}function l(h,m,x,v=new Map,y=void 0){const g=y?.(h,m,x,v);if(g!==void 0)return g;if(a.isPrimitive(h))return h;if(v.has(h))return v.get(h);if(Array.isArray(h)){const b=new Array(h.length);v.set(h,b);for(let N=0;N<h.length;N++)b[N]=l(h[N],N,x,v,y);return Object.hasOwn(h,"index")&&(b.index=h.index),Object.hasOwn(h,"input")&&(b.input=h.input),b}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const b=new RegExp(h.source,h.flags);return b.lastIndex=h.lastIndex,b}if(h instanceof Map){const b=new Map;v.set(h,b);for(const[N,_]of h)b.set(N,l(_,N,x,v,y));return b}if(h instanceof Set){const b=new Set;v.set(h,b);for(const N of h)b.add(l(N,void 0,x,v,y));return b}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(i.isTypedArray(h)){const b=new(Object.getPrototypeOf(h)).constructor(h.length);v.set(h,b);for(let N=0;N<h.length;N++)b[N]=l(h[N],N,x,v,y);return b}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const b=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return v.set(h,b),f(b,h,x,v,y),b}if(typeof File<"u"&&h instanceof File){const b=new File([h],h.name,{type:h.type});return v.set(h,b),f(b,h,x,v,y),b}if(h instanceof Blob){const b=new Blob([h],{type:h.type});return v.set(h,b),f(b,h,x,v,y),b}if(h instanceof Error){const b=new h.constructor;return v.set(h,b),b.message=h.message,b.name=h.name,b.stack=h.stack,b.cause=h.cause,f(b,h,x,v,y),b}if(typeof h=="object"&&d(h)){const b=Object.create(Object.getPrototypeOf(h));return v.set(h,b),f(b,h,x,v,y),b}return h}function f(h,m,x=h,v,y){const g=[...Object.keys(m),...t.getSymbols(m)];for(let b=0;b<g.length;b++){const N=g[b],_=Object.getOwnPropertyDescriptor(h,N);(_==null||_.writable)&&(h[N]=l(m[N],N,x,v,y))}}function d(h){switch(r.getTag(h)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=l,e.copyProperties=f})(Wx)),Wx}var _N;function aI(){return _N||(_N=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Z4();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(zx)),zx}var kN;function iI(){return kN||(kN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=I1(),r=aI();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(Mx)),Mx}var qx={},Xx={},Yx={},jN;function sI(){return jN||(jN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Z4(),r=Q4();function n(a,i){return t.cloneDeepWith(a,(s,l,f,d)=>{const h=i?.(s,l,f,d);if(h!==void 0)return h;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new a.constructor(a?.valueOf());return t.copyProperties(m,a),m}case r.argumentsTag:{const m={};return t.copyProperties(m,a),m.length=a.length,m[Symbol.iterator]=a[Symbol.iterator],m}default:return}})}e.cloneDeepWith=n})(Yx)),Yx}var CN;function oI(){return CN||(CN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sI();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(Xx)),Xx}var Jx={},Qx={},AN;function eC(){return AN||(AN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Qx)),Qx}var Zx={},TN;function lI(){return TN||(TN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=J4();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(Zx)),Zx}var PN;function cI(){return PN||(PN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=N4(),r=eC(),n=lI(),a=N1();function i(s,l){let f;if(Array.isArray(l)?f=l:typeof l=="string"&&t.isDeepKey(l)&&s?.[l]==null?f=a.toPath(l):f=[l],f.length===0)return!1;let d=s;for(let h=0;h<f.length;h++){const m=f[h];if((d==null||!Object.hasOwn(d,m))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(m)&&m<d.length))return!1;d=d[m]}return!0}e.has=i})(Jx)),Jx}var ON;function uI(){return ON||(ON=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=I1(),r=E4(),n=oI(),a=E1(),i=cI();function s(l,f){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return f=n.cloneDeep(f),function(d){const h=a.get(d,l);return h===void 0?i.has(d,l):f===void 0?h===void 0:t.isMatch(h,f)}}e.matchesProperty=s})(qx)),qx}var FN;function fI(){return FN||(FN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G4(),r=eI(),n=iI(),a=uI();function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(Dx)),Dx}var DN;function dI(){return DN||(DN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YD(),r=G4(),n=ZD(),a=fI();function i(s,l=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(l)):[]}e.uniqBy=i})(jx)),jx}var eg,IN;function hI(){return IN||(IN=1,eg=dI().uniqBy),eg}var mI=hI();const MN=es(mI);function tC(e,t,r){return t===!0?MN(e,r):typeof t=="function"?MN(e,t):e}var tg={exports:{}},rg={},ng={exports:{}},ag={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RN;function pI(){if(RN)return ag;RN=1;var e=pc();function t(m,x){return m===x&&(m!==0||1/m===1/x)||m!==m&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function l(m,x){var v=x(),y=n({inst:{value:v,getSnapshot:x}}),g=y[0].inst,b=y[1];return i(function(){g.value=v,g.getSnapshot=x,f(g)&&b({inst:g})},[m,v,x]),a(function(){return f(g)&&b({inst:g}),m(function(){f(g)&&b({inst:g})})},[m]),s(v),v}function f(m){var x=m.getSnapshot;m=m.value;try{var v=x();return!r(m,v)}catch{return!0}}function d(m,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return ag.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,ag}var LN;function xI(){return LN||(LN=1,ng.exports=pI()),ng.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BN;function gI(){if(BN)return rg;BN=1;var e=pc(),t=xI();function r(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,l=e.useMemo,f=e.useDebugValue;return rg.useSyncExternalStoreWithSelector=function(d,h,m,x,v){var y=i(null);if(y.current===null){var g={hasValue:!1,value:null};y.current=g}else g=y.current;y=l(function(){function N(k){if(!_){if(_=!0,S=k,k=x(k),v!==void 0&&g.hasValue){var P=g.value;if(v(P,k))return C=P}return C=k}if(P=C,n(S,k))return P;var D=x(k);return v!==void 0&&v(P,D)?(S=k,P):(S=k,C=D)}var _=!1,S,C,T=m===void 0?null:m;return[function(){return N(h())},T===null?void 0:function(){return N(T())}]},[h,m,x,v]);var b=a(d,y[0],y[1]);return s(function(){g.hasValue=!0,g.value=b},[b]),f(b),b},rg}var $N;function vI(){return $N||($N=1,tg.exports=gI()),tg.exports}var yI=vI(),M1=j.createContext(null),bI=e=>e,lr=()=>{var e=j.useContext(M1);return e?e.store.dispatch:bI},P0=()=>{},wI=()=>P0,SI=(e,t)=>e===t;function Qe(e){var t=j.useContext(M1);return yI.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:wI,t?t.store.getState:P0,t?t.store.getState:P0,t?e:P0,SI)}function NI(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function EI(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function _I(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var UN=e=>Array.isArray(e)?e:[e];function kI(e){const t=Array.isArray(e[0])?e[0]:e;return _I(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function jI(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var CI=class{constructor(e){this.value=e}deref(){return this.value}},AI=typeof WeakRef<"u"?WeakRef:CI,TI=0,zN=1;function r0(){return{s:TI,v:void 0,o:null,p:null}}function rC(e,t={}){let r=r0();const{resultEqualityCheck:n}=t;let a,i=0;function s(){let l=r;const{length:f}=arguments;for(let m=0,x=f;m<x;m++){const v=arguments[m];if(typeof v=="function"||typeof v=="object"&&v!==null){let y=l.o;y===null&&(l.o=y=new WeakMap);const g=y.get(v);g===void 0?(l=r0(),y.set(v,l)):l=g}else{let y=l.p;y===null&&(l.p=y=new Map);const g=y.get(v);g===void 0?(l=r0(),y.set(v,l)):l=g}}const d=l;let h;if(l.s===zN)h=l.v;else if(h=e.apply(null,arguments),i++,n){const m=a?.deref?.()??a;m!=null&&n(m,h)&&(h=m,i!==0&&i--),a=typeof h=="object"&&h!==null||typeof h=="function"?new AI(h):h}return d.s=zN,d.v=h,h}return s.clearCache=()=>{r=r0(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function PI(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,l,f={},d=a.pop();typeof d=="object"&&(f=d,d=a.pop()),NI(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const h={...r,...f},{memoize:m,memoizeOptions:x=[],argsMemoize:v=rC,argsMemoizeOptions:y=[]}=h,g=UN(x),b=UN(y),N=kI(a),_=m(function(){return i++,d.apply(null,arguments)},...g),S=v(function(){s++;const T=jI(N,arguments);return l=_.apply(null,T),l},...b);return Object.assign(S,{resultFunc:d,memoizedResultFunc:_,dependencies:N,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:v})};return Object.assign(n,{withTypes:()=>n}),n}var Ne=PI(rC),OI=Object.assign((e,t=Ne)=>{EI(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,l,f)=>(s[r[f]]=l,s),{}))},{withTypes:()=>OI}),ig={},sg={},og={},WN;function FI(){return WN||(WN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),l=t(a);if(s===l&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?l-s:s-l}return 0};e.compareValues=r})(og)),og}var lg={},cg={},HN;function nC(){return HN||(HN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(cg)),cg}var VN;function DI(){return VN||(VN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nC(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(lg)),lg}var KN;function II(){return KN||(KN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FI(),r=DI(),n=N1();function a(i,s,l,f){if(i==null)return[];l=f?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(v=>String(v));const d=(v,y)=>{let g=v;for(let b=0;b<y.length&&g!=null;++b)g=g[y[b]];return g},h=(v,y)=>y==null||v==null?y:typeof v=="object"&&"key"in v?Object.hasOwn(y,v.key)?y[v.key]:d(y,v.path):typeof v=="function"?v(y):Array.isArray(v)?d(y,v):typeof y=="object"?y[v]:y,m=s.map(v=>(Array.isArray(v)&&v.length===1&&(v=v[0]),v==null||typeof v=="function"||Array.isArray(v)||r.isKey(v)?v:{key:v,path:n.toPath(v)}));return i.map(v=>({original:v,criteria:m.map(y=>h(y,v))})).slice().sort((v,y)=>{for(let g=0;g<m.length;g++){const b=t.compareValues(v.criteria[g],y.criteria[g],l[g]);if(b!==0)return b}return 0}).map(v=>v.original)}e.orderBy=a})(sg)),sg}var ug={},GN;function MI(){return GN||(GN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(l,f)=>{for(let d=0;d<l.length;d++){const h=l[d];Array.isArray(h)&&f<i?s(h,f+1):a.push(h)}};return s(r,0),a}e.flatten=t})(ug)),ug}var fg={},qN;function aC(){return qN||(qN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=eC(),r=D1(),n=q4(),a=Y4();function i(s,l,f){return n.isObject(f)&&(typeof l=="number"&&r.isArrayLike(f)&&t.isIndex(l)&&l<f.length||typeof l=="string"&&l in f)?a.eq(f[l],s):!1}e.isIterateeCall=i})(fg)),fg}var XN;function RI(){return XN||(XN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=II(),r=MI(),n=aC();function a(i,...s){const l=s.length;return l>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:l>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(ig)),ig}var dg,YN;function LI(){return YN||(YN=1,dg=RI().sortBy),dg}var BI=LI();const zh=es(BI);var iC=e=>e.legend.settings,$I=e=>e.legend.size,UI=e=>e.legend.payload,zI=Ne([UI,iC],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?zh(n,r):n});function WI(){return Qe(zI)}var n0=1;function sC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=j.useState({height:0,left:0,top:0,width:0}),n=j.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>n0||Math.abs(s.left-t.left)>n0||Math.abs(s.top-t.top)>n0||Math.abs(s.width-t.width)>n0)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function nn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var HI=typeof Symbol=="function"&&Symbol.observable||"@@observable",JN=HI,hg=()=>Math.random().toString(36).substring(7).split("").join("."),VI={INIT:`@@redux/INIT${hg()}`,REPLACE:`@@redux/REPLACE${hg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${hg()}`},W0=VI;function R1(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function oC(e,t,r){if(typeof e!="function")throw new Error(nn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(nn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(nn(1));return r(oC)(e,t)}let n=e,a=t,i=new Map,s=i,l=0,f=!1;function d(){s===i&&(s=new Map,i.forEach((b,N)=>{s.set(N,b)}))}function h(){if(f)throw new Error(nn(3));return a}function m(b){if(typeof b!="function")throw new Error(nn(4));if(f)throw new Error(nn(5));let N=!0;d();const _=l++;return s.set(_,b),function(){if(N){if(f)throw new Error(nn(6));N=!1,d(),s.delete(_),i=null}}}function x(b){if(!R1(b))throw new Error(nn(7));if(typeof b.type>"u")throw new Error(nn(8));if(typeof b.type!="string")throw new Error(nn(17));if(f)throw new Error(nn(9));try{f=!0,a=n(a,b)}finally{f=!1}return(i=s).forEach(_=>{_()}),b}function v(b){if(typeof b!="function")throw new Error(nn(10));n=b,x({type:W0.REPLACE})}function y(){const b=m;return{subscribe(N){if(typeof N!="object"||N===null)throw new Error(nn(11));function _(){const C=N;C.next&&C.next(h())}return _(),{unsubscribe:b(_)}},[JN](){return this}}}return x({type:W0.INIT}),{dispatch:x,subscribe:m,getState:h,replaceReducer:v,[JN]:y}}function KI(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:W0.INIT})>"u")throw new Error(nn(12));if(typeof r(void 0,{type:W0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(nn(13))})}function lC(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{KI(r)}catch(i){a=i}return function(s={},l){if(a)throw a;let f=!1;const d={};for(let h=0;h<n.length;h++){const m=n[h],x=r[m],v=s[m],y=x(v,l);if(typeof y>"u")throw l&&l.type,new Error(nn(14));d[m]=y,f=f||y!==v}return f=f||n.length!==Object.keys(s).length,f?d:s}}function H0(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function GI(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(nn(15))};const s={getState:a.getState,dispatch:(f,...d)=>i(f,...d)},l=e.map(f=>f(s));return i=H0(...l)(a.dispatch),{...a,dispatch:i}}}function cC(e){return R1(e)&&"type"in e&&typeof e.type=="string"}var uC=Symbol.for("immer-nothing"),QN=Symbol.for("immer-draftable"),ua=Symbol.for("immer-state");function Xa(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var nc=Object.getPrototypeOf;function Ho(e){return!!e&&!!e[ua]}function Xi(e){return e?fC(e)||Array.isArray(e)||!!e[QN]||!!e.constructor?.[QN]||Ef(e)||Hh(e):!1}var qI=Object.prototype.constructor.toString();function fC(e){if(!e||typeof e!="object")return!1;const t=nc(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===qI}function V0(e,t){Wh(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Wh(e){const t=e[ua];return t?t.type_:Array.isArray(e)?1:Ef(e)?2:Hh(e)?3:0}function yv(e,t){return Wh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function dC(e,t,r){const n=Wh(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function XI(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Ef(e){return e instanceof Map}function Hh(e){return e instanceof Set}function No(e){return e.copy_||e.base_}function bv(e,t){if(Ef(e))return new Map(e);if(Hh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=fC(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[ua];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],l=n[s];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[s]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[s]})}return Object.create(nc(e),n)}else{const n=nc(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function L1(e,t=!1){return Vh(e)||Ho(e)||!Xi(e)||(Wh(e)>1&&Object.defineProperties(e,{set:{value:a0},add:{value:a0},clear:{value:a0},delete:{value:a0}}),Object.freeze(e),t&&Object.values(e).forEach(r=>L1(r,!0))),e}function a0(){Xa(2)}function Vh(e){return Object.isFrozen(e)}var YI={};function Vo(e){const t=YI[e];return t||Xa(0,e),t}var Yu;function hC(){return Yu}function JI(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ZN(e,t){t&&(Vo("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function wv(e){Sv(e),e.drafts_.forEach(QI),e.drafts_=null}function Sv(e){e===Yu&&(Yu=e.parent_)}function eE(e){return Yu=JI(Yu,e)}function QI(e){const t=e[ua];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function tE(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ua].modified_&&(wv(t),Xa(4)),Xi(e)&&(e=K0(t,e),t.parent_||G0(t,e)),t.patches_&&Vo("Patches").generateReplacementPatches_(r[ua].base_,e,t.patches_,t.inversePatches_)):e=K0(t,r,[]),wv(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==uC?e:void 0}function K0(e,t,r){if(Vh(t))return t;const n=t[ua];if(!n)return V0(t,(a,i)=>rE(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return G0(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),V0(i,(l,f)=>rE(e,n,a,l,f,r,s)),G0(e,a,!1),r&&e.patches_&&Vo("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function rE(e,t,r,n,a,i,s){if(Ho(a)){const l=i&&t&&t.type_!==3&&!yv(t.assigned_,n)?i.concat(n):void 0,f=K0(e,a,l);if(dC(r,n,f),Ho(f))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Xi(a)&&!Vh(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;K0(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Ef(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&G0(e,a)}}function G0(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&L1(t,r)}function ZI(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:hC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=B1;r&&(a=[n],i=Ju);const{revoke:s,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=s,l}var B1={get(e,t){if(t===ua)return e;const r=No(e);if(!yv(r,t))return eM(e,r,t);const n=r[t];return e.finalized_||!Xi(n)?n:n===mg(e.base_,t)?(pg(e),e.copy_[t]=Ev(n,e)):n},has(e,t){return t in No(e)},ownKeys(e){return Reflect.ownKeys(No(e))},set(e,t,r){const n=mC(No(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=mg(No(e),t),i=a?.[ua];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(XI(r,a)&&(r!==void 0||yv(e.base_,t)))return!0;pg(e),Nv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return mg(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,pg(e),Nv(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=No(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Xa(11)},getPrototypeOf(e){return nc(e.base_)},setPrototypeOf(){Xa(12)}},Ju={};V0(B1,(e,t)=>{Ju[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Ju.deleteProperty=function(e,t){return Ju.set.call(this,e,t,void 0)};Ju.set=function(e,t,r){return B1.set.call(this,e[0],t,r,e[0])};function mg(e,t){const r=e[ua];return(r?No(r):e)[t]}function eM(e,t,r){const n=mC(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function mC(e,t){if(!(t in e))return;let r=nc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=nc(r)}}function Nv(e){e.modified_||(e.modified_=!0,e.parent_&&Nv(e.parent_))}function pg(e){e.copy_||(e.copy_=bv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var tM=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(f=i,...d){return s.produce(f,h=>r.call(this,h,...d))}}typeof r!="function"&&Xa(6),n!==void 0&&typeof n!="function"&&Xa(7);let a;if(Xi(t)){const i=eE(this),s=Ev(t,void 0);let l=!0;try{a=r(s),l=!1}finally{l?wv(i):Sv(i)}return ZN(i,n),tE(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===uC&&(a=void 0),this.autoFreeze_&&L1(a,!0),n){const i=[],s=[];Vo("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Xa(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...l)=>this.produceWithPatches(s,f=>t(f,...l));let n,a;return[this.produce(t,r,(s,l)=>{n=s,a=l}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Xi(e)||Xa(8),Ho(e)&&(e=Ui(e));const t=eE(this),r=Ev(e,void 0);return r[ua].isManual_=!0,Sv(t),r}finishDraft(e,t){const r=e&&e[ua];(!r||!r.isManual_)&&Xa(9);const{scope_:n}=r;return ZN(n,t),tE(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Vo("Patches").applyPatches_;return Ho(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Ev(e,t){const r=Ef(e)?Vo("MapSet").proxyMap_(e,t):Hh(e)?Vo("MapSet").proxySet_(e,t):ZI(e,t);return(t?t.scope_:hC()).drafts_.push(r),r}function Ui(e){return Ho(e)||Xa(10,e),pC(e)}function pC(e){if(!Xi(e)||Vh(e))return e;const t=e[ua];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=bv(e,t.scope_.immer_.useStrictShallowCopy_)}else r=bv(e,!0);return V0(r,(n,a)=>{dC(r,n,pC(a))}),t&&(t.finalized_=!1),r}var rM=new tM,xC=rM.produce;function gC(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var nM=gC(),aM=gC,iM=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?H0:H0.apply(null,arguments)};function Da(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(oa(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>cC(n)&&n.type===e,r}var vC=class Au extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Au.prototype)}static get[Symbol.species](){return Au}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Au(...t[0].concat(this)):new Au(...t.concat(this))}};function nE(e){return Xi(e)?xC(e,()=>{}):e}function i0(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function sM(e){return typeof e=="boolean"}var oM=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new vC;return r&&(sM(r)?s.push(nM):s.push(aM(r.extraArgument))),s},lM="RTK_autoBatch",aE=e=>t=>{setTimeout(t,e)},cM=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const l=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:aE(10):e.type==="callback"?e.queueNotification:aE(e.timeout),d=()=>{s=!1,i&&(i=!1,l.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const m=()=>a&&h(),x=n.subscribe(m);return l.add(h),()=>{x(),l.delete(h)}},dispatch(h){try{return a=!h?.meta?.[lM],i=!a,i&&(s||(s=!0,f(d))),n.dispatch(h)}finally{a=!0}}})},uM=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new vC(e);return n&&a.push(cM(typeof n=="object"?n:void 0)),a};function fM(e){const t=oM(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(R1(r))l=lC(r);else throw new Error(oa(1));let f;typeof n=="function"?f=n(t):f=t();let d=H0;a&&(d=iM({trace:!1,...typeof a=="object"&&a}));const h=GI(...f),m=uM(h);let x=typeof s=="function"?s(m):m();const v=d(...x);return oC(l,i,v)}function yC(e){const t={},r=[];let n;const a={addCase(i,s){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(oa(28));if(l in t)throw new Error(oa(29));return t[l]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function dM(e){return typeof e=="function"}function hM(e,t){let[r,n,a]=yC(t),i;if(dM(e))i=()=>nE(e());else{const l=nE(e);i=()=>l}function s(l=i(),f){let d=[r[f.type],...n.filter(({matcher:h})=>h(f)).map(({reducer:h})=>h)];return d.filter(h=>!!h).length===0&&(d=[a]),d.reduce((h,m)=>{if(m)if(Ho(h)){const v=m(h,f);return v===void 0?h:v}else{if(Xi(h))return xC(h,x=>m(x,f));{const x=m(h,f);if(x===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return h},l)}return s.getInitialState=i,s}var mM="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",pM=(e=21)=>{let t="",r=e;for(;r--;)t+=mM[Math.random()*64|0];return t},xM=Symbol.for("rtk-slice-createasyncthunk");function gM(e,t){return`${e}/${t}`}function vM({creators:e}={}){const t=e?.asyncThunk?.[xM];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(oa(11));const s=(typeof n.reducers=="function"?n.reducers(bM()):n.reducers)||{},l=Object.keys(s),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,C){const T=typeof S=="string"?S:S.type;if(!T)throw new Error(oa(12));if(T in f.sliceCaseReducersByType)throw new Error(oa(13));return f.sliceCaseReducersByType[T]=C,d},addMatcher(S,C){return f.sliceMatchers.push({matcher:S,reducer:C}),d},exposeAction(S,C){return f.actionCreators[S]=C,d},exposeCaseReducer(S,C){return f.sliceCaseReducersByName[S]=C,d}};l.forEach(S=>{const C=s[S],T={reducerName:S,type:gM(a,S),createNotation:typeof n.reducers=="function"};SM(C)?EM(T,C,d,t):wM(T,C,d)});function h(){const[S={},C=[],T=void 0]=typeof n.extraReducers=="function"?yC(n.extraReducers):[n.extraReducers],k={...S,...f.sliceCaseReducersByType};return hM(n.initialState,P=>{for(let D in k)P.addCase(D,k[D]);for(let D of f.sliceMatchers)P.addMatcher(D.matcher,D.reducer);for(let D of C)P.addMatcher(D.matcher,D.reducer);T&&P.addDefaultCase(T)})}const m=S=>S,x=new Map,v=new WeakMap;let y;function g(S,C){return y||(y=h()),y(S,C)}function b(){return y||(y=h()),y.getInitialState()}function N(S,C=!1){function T(P){let D=P[S];return typeof D>"u"&&C&&(D=i0(v,T,b)),D}function k(P=m){const D=i0(x,C,()=>new WeakMap);return i0(D,P,()=>{const R={};for(const[G,M]of Object.entries(n.selectors??{}))R[G]=yM(M,P,()=>i0(v,P,b),C);return R})}return{reducerPath:S,getSelectors:k,get selectors(){return k(T)},selectSlice:T}}const _={name:a,reducer:g,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:b,...N(i),injectInto(S,{reducerPath:C,...T}={}){const k=C??i;return S.inject({reducerPath:k,reducer:g},T),{..._,...N(k,!0)}}};return _}}function yM(e,t,r,n){function a(i,...s){let l=t(i);return typeof l>"u"&&n&&(l=r()),e(l,...s)}return a.unwrapped=e,a}var ha=vM();function bM(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function wM({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!NM(n))throw new Error(oa(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?Da(e,s):Da(e))}function SM(e){return e._reducerDefinitionType==="asyncThunk"}function NM(e){return e._reducerDefinitionType==="reducerWithPrepare"}function EM({type:e,reducerName:t},r,n,a){if(!a)throw new Error(oa(18));const{payloadCreator:i,fulfilled:s,pending:l,rejected:f,settled:d,options:h}=r,m=a(e,i,h);n.exposeAction(t,m),s&&n.addCase(m.fulfilled,s),l&&n.addCase(m.pending,l),f&&n.addCase(m.rejected,f),d&&n.addMatcher(m.settled,d),n.exposeCaseReducer(t,{fulfilled:s||s0,pending:l||s0,rejected:f||s0,settled:d||s0})}function s0(){}var _M="task",bC="listener",wC="completed",$1="cancelled",kM=`task-${$1}`,jM=`task-${wC}`,_v=`${bC}-${$1}`,CM=`${bC}-${wC}`,Kh=class{constructor(e){this.code=e,this.message=`${_M} ${$1} (reason: ${e})`}name="TaskAbortError";message},U1=(e,t)=>{if(typeof e!="function")throw new TypeError(oa(32))},q0=()=>{},SC=(e,t=q0)=>(e.catch(t),e),NC=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Oo=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Fo=e=>{if(e.aborted){const{reason:t}=e;throw new Kh(t)}};function EC(e,t){let r=q0;return new Promise((n,a)=>{const i=()=>a(new Kh(e.reason));if(e.aborted){i();return}r=NC(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=q0})}var AM=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Kh?"cancelled":"rejected",error:r}}finally{t?.()}},X0=e=>t=>SC(EC(e,t).then(r=>(Fo(e),r))),_C=e=>{const t=X0(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Yl}=Object,iE={},Gh="listenerMiddleware",TM=(e,t)=>{const r=n=>NC(e,()=>Oo(n,e.reason));return(n,a)=>{U1(n);const i=new AbortController;r(i);const s=AM(async()=>{Fo(e),Fo(i.signal);const l=await n({pause:X0(i.signal),delay:_C(i.signal),signal:i.signal});return Fo(i.signal),l},()=>Oo(i,jM));return a?.autoJoin&&t.push(s.catch(q0)),{result:X0(e)(s),cancel(){Oo(i,kM)}}}},PM=(e,t)=>{const r=async(n,a)=>{Fo(t);let i=()=>{};const l=[new Promise((f,d)=>{let h=e({predicate:n,effect:(m,x)=>{x.unsubscribe(),f([m,x.getState(),x.getOriginalState()])}});i=()=>{h(),d()}})];a!=null&&l.push(new Promise(f=>setTimeout(f,a,null)));try{const f=await EC(t,Promise.race(l));return Fo(t),f}finally{i()}};return(n,a)=>SC(r(n,a))},kC=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=Da(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(oa(21));return U1(i),{predicate:a,type:t,effect:i}},jC=Yl(e=>{const{type:t,predicate:r,effect:n}=kC(e);return{id:pM(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(oa(22))}}},{withTypes:()=>jC}),sE=(e,t)=>{const{type:r,effect:n,predicate:a}=kC(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},kv=e=>{e.pending.forEach(t=>{Oo(t,_v)})},OM=e=>()=>{e.forEach(kv),e.clear()},oE=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},CC=Yl(Da(`${Gh}/add`),{withTypes:()=>CC}),FM=Da(`${Gh}/removeAll`),AC=Yl(Da(`${Gh}/remove`),{withTypes:()=>AC}),DM=(...e)=>{console.error(`${Gh}/error`,...e)},_f=(e={})=>{const t=new Map,{extra:r,onError:n=DM}=e;U1(n);const a=h=>(h.unsubscribe=()=>t.delete(h.id),t.set(h.id,h),m=>{h.unsubscribe(),m?.cancelActive&&kv(h)}),i=h=>{const m=sE(t,h)??jC(h);return a(m)};Yl(i,{withTypes:()=>i});const s=h=>{const m=sE(t,h);return m&&(m.unsubscribe(),h.cancelActive&&kv(m)),!!m};Yl(s,{withTypes:()=>s});const l=async(h,m,x,v)=>{const y=new AbortController,g=PM(i,y.signal),b=[];try{h.pending.add(y),await Promise.resolve(h.effect(m,Yl({},x,{getOriginalState:v,condition:(N,_)=>g(N,_).then(Boolean),take:g,delay:_C(y.signal),pause:X0(y.signal),extra:r,signal:y.signal,fork:TM(y.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{t.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((N,_,S)=>{N!==y&&(Oo(N,_v),S.delete(N))})},cancel:()=>{Oo(y,_v),h.pending.delete(y)},throwIfCancelled:()=>{Fo(y.signal)}})))}catch(N){N instanceof Kh||oE(n,N,{raisedBy:"effect"})}finally{await Promise.all(b),Oo(y,CM),h.pending.delete(y)}},f=OM(t);return{middleware:h=>m=>x=>{if(!cC(x))return m(x);if(CC.match(x))return i(x.payload);if(FM.match(x)){f();return}if(AC.match(x))return s(x.payload);let v=h.getState();const y=()=>{if(v===iE)throw new Error(oa(23));return v};let g;try{if(g=m(x),t.size>0){const b=h.getState(),N=Array.from(t.values());for(const _ of N){let S=!1;try{S=_.predicate(x,b,v)}catch(C){S=!1,oE(n,C,{raisedBy:"predicate"})}S&&l(_,x,h,y)}}}finally{v=iE}return g},startListening:i,stopListening:s,clearListeners:f}};function oa(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var IM={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},TC=ha({name:"chartLayout",initialState:IM,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:MM,setLayout:RM,setChartSize:LM,setScale:BM}=TC.actions,$M=TC.reducer;function lE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lE(Object(r),!0).forEach(function(n){UM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UM(e,t,r){return(t=zM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zM(e){var t=WM(e,"string");return typeof t=="symbol"?t:t+""}function WM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y0=Math.PI/180,HM=e=>e*180/Math.PI,Cr=(e,t,r,n)=>({x:e+Math.cos(-Y0*n)*r,y:t+Math.sin(-Y0*n)*r}),PC=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},VM=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},KM=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=VM({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var l=(r-a)/s,f=Math.acos(l);return n>i&&(f=2*Math.PI-f),{radius:s,angle:HM(f),angleInRadian:f}},GM=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},qM=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},XM=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=KM({x:r,y:n},t),{innerRadius:s,outerRadius:l}=t;if(a<s||a>l||a===0)return null;var{startAngle:f,endAngle:d}=GM(t),h=i,m;if(f<=d){for(;h>d;)h-=360;for(;h<f;)h+=360;m=h>=f&&h<=d}else{for(;h>f;)h-=360;for(;h<d;)h+=360;m=h>=d&&h<=f}return m?cE(cE({},t),{},{radius:a,angle:qM(h,t)}):null};function OC(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function uE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ta(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uE(Object(r),!0).forEach(function(n){YM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YM(e,t,r){return(t=JM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JM(e){var t=QM(e,"string");return typeof t=="symbol"?t:t+""}function QM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zt(e,t,r){return qr(e)||qr(t)?r:vi(t)?Wo(e,t,r):typeof t=="function"?t(e):r}var ZM=(e,t,r,n,a)=>{var i,s=-1,l=(i=t?.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var f=0;f<l;f++){var d=f>0?r[f-1].coordinate:r[l-1].coordinate,h=r[f].coordinate,m=f>=l-1?r[0].coordinate:r[f+1].coordinate,x=void 0;if(Kr(h-d)!==Kr(m-h)){var v=[];if(Kr(m-h)===Kr(a[1]-a[0])){x=m;var y=h+a[1]-a[0];v[0]=Math.min(y,(y+d)/2),v[1]=Math.max(y,(y+d)/2)}else{x=d;var g=m+a[1]-a[0];v[0]=Math.min(h,(g+h)/2),v[1]=Math.max(h,(g+h)/2)}var b=[Math.min(h,(x+h)/2),Math.max(h,(x+h)/2)];if(e>b[0]&&e<=b[1]||e>=v[0]&&e<=v[1]){({index:s}=r[f]);break}}else{var N=Math.min(d,m),_=Math.max(d,m);if(e>(N+h)/2&&e<=(_+h)/2){({index:s}=r[f]);break}}}else if(t){for(var S=0;S<l;S++)if(S===0&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S>0&&S<l-1&&e>(t[S].coordinate+t[S-1].coordinate)/2&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S===l-1&&e>(t[S].coordinate+t[S-1].coordinate)/2){({index:s}=t[S]);break}}return s},e8=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:l}=t;if((l==="vertical"||l==="horizontal"&&s==="middle")&&i!=="center"&&Ze(e[i]))return Ta(Ta({},e),{},{[i]:e[i]+(n||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&s!=="middle"&&Ze(e[s]))return Ta(Ta({},e),{},{[s]:e[s]+(a||0)})}return e},rl=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",FC=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,i,s=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(i=!0),l.coordinate));return a||s.push(t),i||s.push(r),s},DC=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:l,isCategorical:f,categoricalDomain:d,tickCount:h,ticks:m,niceTicks:x,axisType:v}=e;if(!s)return null;var y=l==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,g=a==="category"&&s.bandwidth?s.bandwidth()/y:0;if(g=v==="angleAxis"&&i&&i.length>=2?Kr(i[0]-i[1])*2*g:g,m||x){var b=(m||x||[]).map((N,_)=>{var S=n?n.indexOf(N):N;return{coordinate:s(S)+g,value:N,offset:g,index:_}});return b.filter(N=>!ca(N.coordinate))}return f&&d?d.map((N,_)=>({coordinate:s(N)+g,value:N,index:_,offset:g})):s.ticks&&h!=null?s.ticks(h).map((N,_)=>({coordinate:s(N)+g,value:N,offset:g,index:_})):s.domain().map((N,_)=>({coordinate:s(N)+g,value:n?n[N]:N,index:_,offset:g}))},fE=1e-4,t8=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-fE,i=Math.max(n[0],n[1])+fE,s=e(t[0]),l=e(t[r-1]);(s<a||s>i||l<a||l>i)&&e.domain([t[0],t[r-1]])}},r8=(e,t)=>{if(!t||t.length!==2||!Ze(t[0])||!Ze(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Ze(e[0])||e[0]<r)&&(a[0]=r),(!Ze(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},n8=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var l=ca(e[s][r][1])?e[s][r][0]:e[s][r][1];l>=0?(e[s][r][0]=a,e[s][r][1]=a+l,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+l,i=e[s][r][1])}},a8=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=ca(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},i8={sign:n8,expand:DD,none:rc,silhouette:ID,wiggle:MD,positive:a8},s8=(e,t,r)=>{var n=i8[r],a=FD().keys(t).value((i,s)=>+Zt(i,s,0)).order(xv).offset(n);return a(e)};function o8(e){return e==null?void 0:String(e)}var dE=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var l=Zt(i,t.dataKey,t.scale.domain()[s]);return qr(l)?null:t.scale(l)-a/2+n},l8=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},c8=e=>{var t=e.flat(2).filter(Ze);return[Math.min(...t),Math.max(...t)]},u8=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],f8=(e,t,r)=>{if(e!=null)return u8(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,l=s.reduce((f,d)=>{var h=OC(d,t,r),m=c8(h);return[Math.min(f[0],m[0]),Math.max(f[1],m[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},hE=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,mE=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,z1=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=zh(t,h=>h.coordinate),i=1/0,s=1,l=a.length;s<l;s++){var f=a[s],d=a[s-1];i=Math.min((f.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function pE(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Ta(Ta({},t),{},{dataKey:r,payload:n,value:a,name:i})}function qh(e,t){if(e)return String(e);if(typeof t=="string")return t}function d8(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?XM({x:e,y:t},n):null}var h8=(e,t,r,n)=>{var a=t.find(d=>d&&d.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return Ta(Ta(Ta({},n),Cr(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var l=a.coordinate,{angle:f}=n;return Ta(Ta(Ta({},n),Cr(n.cx,n.cy,l,f)),{},{angle:f,radius:l})}return{x:0,y:0}},m8=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,ts=e=>e.layout.width,rs=e=>e.layout.height,p8=e=>e.layout.scale,IC=e=>e.layout.margin,Xh=Ne(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Yh=Ne(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),MC="data-recharts-item-index",RC="data-recharts-item-data-key",kf=60;function xE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xE(Object(r),!0).forEach(function(n){x8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x8(e,t,r){return(t=g8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g8(e){var t=v8(e,"string");return typeof t=="symbol"?t:t+""}function v8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y8=e=>e.brush.height;function b8(e){var t=Yh(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:kf;return r+a}return r},0)}function w8(e){var t=Yh(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:kf;return r+a}return r},0)}function S8(e){var t=Xh(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function N8(e){var t=Xh(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Ir=Ne([ts,rs,IC,y8,b8,w8,S8,N8,iC,$I],(e,t,r,n,a,i,s,l,f,d)=>{var h={left:(r.left||0)+a,right:(r.right||0)+i},m={top:(r.top||0)+s,bottom:(r.bottom||0)+l},x=o0(o0({},m),h),v=x.bottom;x.bottom+=n,x=e8(x,f,d);var y=e-x.left-x.right,g=t-x.top-x.bottom;return o0(o0({brushBottom:v},x),{},{width:Math.max(y,0),height:Math.max(g,0)})}),E8=Ne(Ir,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),W1=Ne(ts,rs,(e,t)=>({x:0,y:0,width:e,height:t})),_8=j.createContext(null),Ra=()=>j.useContext(_8)!=null,Jh=e=>e.brush,Qh=Ne([Jh,Ir,IC],(e,t,r)=>({height:e.height,x:Ze(e.x)?e.x:t.left,y:Ze(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:Ze(e.width)?e.width:t.width})),H1=()=>{var e,t=Ra(),r=Qe(E8),n=Qe(Qh),a=(e=Qe(Jh))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},k8={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},LC=()=>{var e;return(e=Qe(Ir))!==null&&e!==void 0?e:k8},V1=()=>Qe(ts),K1=()=>Qe(rs),j8=()=>Qe(e=>e.layout.margin),kt=e=>e.layout.layoutType,G1=()=>Qe(kt),C8={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},BC=ha({name:"legend",initialState:C8,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Ui(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:gE,setLegendSettings:A8,addLegendPayload:$C,removeLegendPayload:UC}=BC.actions,T8=BC.reducer,P8=["contextPayload"];function jv(){return jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jv.apply(null,arguments)}function vE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ac(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vE(Object(r),!0).forEach(function(n){q1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q1(e,t,r){return(t=O8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O8(e){var t=F8(e,"string");return typeof t=="symbol"?t:t+""}function F8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function D8(e,t){if(e==null)return{};var r,n,a=I8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function I8(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function M8(e){return e.value}function R8(e){var{contextPayload:t}=e,r=D8(e,P8),n=tC(t,e.payloadUniqBy,M8),a=ac(ac({},r),{},{payload:n});return j.isValidElement(e.content)?j.cloneElement(e.content,a):typeof e.content=="function"?j.createElement(e.content,a):j.createElement(F1,a)}function L8(e,t,r,n,a,i){var{layout:s,align:l,verticalAlign:f}=t,d,h;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&s==="vertical"?d={left:((n||0)-i.width)/2}:d=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(f==="middle"?h={top:((a||0)-i.height)/2}:h=f==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),ac(ac({},d),h)}function B8(e){var t=lr();return j.useEffect(()=>{t(A8(e))},[t,e]),null}function $8(e){var t=lr();return j.useEffect(()=>(t(gE(e)),()=>{t(gE({width:0,height:0}))}),[t,e]),null}function U8(e){var t=WI(),r=nD(),n=j8(),{width:a,height:i,wrapperStyle:s,portal:l}=e,[f,d]=sC([t]),h=V1(),m=K1();if(h==null||m==null)return null;var x=h-(n.left||0)-(n.right||0),v=Zh.getWidthOrHeight(e.layout,i,a,x),y=l?s:ac(ac({position:"absolute",width:v?.width||a||"auto",height:v?.height||i||"auto"},L8(s,e,n,h,m,f)),s),g=l??r;if(g==null)return null;var b=j.createElement("div",{className:"recharts-legend-wrapper",style:y,ref:d},j.createElement(B8,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),j.createElement($8,{width:f.width,height:f.height}),j.createElement(R8,jv({},e,v,{margin:n,chartWidth:h,chartHeight:m,contextPayload:t})));return C4.createPortal(b,g)}class Zh extends j.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&Ze(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return j.createElement(U8,this.props)}}q1(Zh,"displayName","Legend");q1(Zh,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Cv(){return Cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cv.apply(null,arguments)}function yE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yE(Object(r),!0).forEach(function(n){z8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z8(e,t,r){return(t=W8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W8(e){var t=H8(e,"string");return typeof t=="symbol"?t:t+""}function H8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V8(e){return Array.isArray(e)&&vi(e[0])&&vi(e[1])?e.join(" ~ "):e}var K8=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:l,wrapperClassName:f,labelClassName:d,label:h,labelFormatter:m,accessibilityLayer:x=!1}=e,v=()=>{if(i&&i.length){var T={padding:0,margin:0},k=(l?zh(i,l):i).map((P,D)=>{if(P.type==="none")return null;var R=P.formatter||s||V8,{value:G,name:M}=P,H=G,z=M;if(R){var ne=R(G,M,P,D,i);if(Array.isArray(ne))[H,z]=ne;else if(ne!=null)H=ne;else return null}var Q=xg({display:"block",paddingTop:4,paddingBottom:4,color:P.color||"#000"},n);return j.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:Q},vi(z)?j.createElement("span",{className:"recharts-tooltip-item-name"},z):null,vi(z)?j.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,j.createElement("span",{className:"recharts-tooltip-item-value"},H),j.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return j.createElement("ul",{className:"recharts-tooltip-item-list",style:T},k)}return null},y=xg({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=xg({margin:0},a),b=!qr(h),N=b?h:"",_=It("recharts-default-tooltip",f),S=It("recharts-tooltip-label",d);b&&m&&i!==void 0&&i!==null&&(N=m(h,i));var C=x?{role:"status","aria-live":"assertive"}:{};return j.createElement("div",Cv({className:_,style:y},C),j.createElement("p",{className:S,style:g},j.isValidElement(N)?N:"".concat(N)),v())},gu="recharts-tooltip-wrapper",G8={visibility:"hidden"};function q8(e){var{coordinate:t,translateX:r,translateY:n}=e;return It(gu,{["".concat(gu,"-right")]:Ze(r)&&t&&Ze(t.x)&&r>=t.x,["".concat(gu,"-left")]:Ze(r)&&t&&Ze(t.x)&&r<t.x,["".concat(gu,"-bottom")]:Ze(n)&&t&&Ze(t.y)&&n>=t.y,["".concat(gu,"-top")]:Ze(n)&&t&&Ze(t.y)&&n<t.y})}function bE(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:l,viewBox:f,viewBoxDimension:d}=e;if(i&&Ze(i[n]))return i[n];var h=r[n]-l-(a>0?a:0),m=r[n]+a;if(t[n])return s[n]?h:m;var x=f[n];if(x==null)return 0;if(s[n]){var v=h,y=x;return v<y?Math.max(m,x):Math.max(h,x)}if(d==null)return 0;var g=m+l,b=x+d;return g>b?Math.max(h,x):Math.max(m,x)}function X8(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Y8(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:l,viewBox:f}=e,d,h,m;return s.height>0&&s.width>0&&r?(h=bE({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:f,viewBoxDimension:f.width}),m=bE({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:f,viewBoxDimension:f.height}),d=X8({translateX:h,translateY:m,useTranslate3d:l})):d=G8,{cssProperties:d,cssClasses:q8({translateX:h,translateY:m,coordinate:r})}}function wE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function l0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wE(Object(r),!0).forEach(function(n){Av(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Av(e,t,r){return(t=J8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J8(e){var t=Q8(e,"string");return typeof t=="symbol"?t:t+""}function Q8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Z8 extends j.PureComponent{constructor(){super(...arguments),Av(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Av(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:l,isAnimationActive:f,offset:d,position:h,reverseDirection:m,useTranslate3d:x,viewBox:v,wrapperStyle:y,lastBoundingBox:g,innerRef:b,hasPortalFromProps:N}=this.props,{cssClasses:_,cssProperties:S}=Y8({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:d,position:h,reverseDirection:m,tooltipBox:{height:g.height,width:g.width},useTranslate3d:x,viewBox:v}),C=N?{}:l0(l0({transition:f&&t?"transform ".concat(n,"ms ").concat(a):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),T=l0(l0({},C),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},y);return j.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:_,style:T,ref:b},i)}}var eR=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),vc={isSsr:eR()},zC=()=>Qe(e=>e.rootProps.accessibilityLayer);function fa(e){return Number.isFinite(e)}function ic(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Tv(){return Tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tv.apply(null,arguments)}function SE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function NE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SE(Object(r),!0).forEach(function(n){tR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tR(e,t,r){return(t=rR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rR(e){var t=nR(e,"string");return typeof t=="symbol"?t:t+""}function nR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EE={curveBasisClosed:SD,curveBasisOpen:ND,curveBasis:wD,curveBumpX:oD,curveBumpY:lD,curveLinearClosed:ED,curveLinear:$h,curveMonotoneX:_D,curveMonotoneY:kD,curveNatural:jD,curveStep:CD,curveStepAfter:TD,curveStepBefore:AD},c0=e=>fa(e.x)&&fa(e.y),vu=e=>e.x,yu=e=>e.y,aR=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Sf(e));return(r==="curveMonotone"||r==="curveBump")&&t?EE["".concat(r).concat(t==="vertical"?"Y":"X")]:EE[r]||$h},iR=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=aR(t,a),l=i?r.filter(c0):r,f;if(Array.isArray(n)){var d=i?n.filter(m=>c0(m)):n,h=l.map((m,x)=>NE(NE({},m),{},{base:d[x]}));return a==="vertical"?f=t0().y(yu).x1(vu).x0(m=>m.base.x):f=t0().x(vu).y1(yu).y0(m=>m.base.y),f.defined(c0).curve(s),f(h)}return a==="vertical"&&Ze(n)?f=t0().y(yu).x1(vu).x0(n):Ze(n)?f=t0().x(vu).y1(yu).y0(n):f=I4().x(vu).y(yu),f.defined(c0).curve(s),f(l)},WC=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?iR(e):n;return j.createElement("path",Tv({},tl(e),G5(e),{className:It("recharts-curve",t),d:i===null?void 0:i,ref:a}))},sR=["x","y","top","left","width","height","className"];function Pv(){return Pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pv.apply(null,arguments)}function _E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_E(Object(r),!0).forEach(function(n){lR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_E(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lR(e,t,r){return(t=cR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cR(e){var t=uR(e,"string");return typeof t=="symbol"?t:t+""}function uR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fR(e,t){if(e==null)return{};var r,n,a=dR(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function dR(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hR=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),mR=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:l}=e,f=fR(e,sR),d=oR({x:t,y:r,top:n,left:a,width:i,height:s},f);return!Ze(t)||!Ze(r)||!Ze(i)||!Ze(s)||!Ze(n)||!Ze(a)?null:j.createElement("path",Pv({},jr(d,!0),{className:It("recharts-cross",l),d:hR(t,r,i,s,n,a)}))};function pR(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function kE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kE(Object(r),!0).forEach(function(n){gR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gR(e,t,r){return(t=vR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vR(e){var t=yR(e,"string");return typeof t=="symbol"?t:t+""}function yR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function La(e,t){var r=xR({},e),n=t,a=Object.keys(t),i=a.reduce((s,l)=>(s[l]===void 0&&n[l]!==void 0&&(s[l]=n[l]),s),r);return i}function bR(){}function jE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function CE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jE(Object(r),!0).forEach(function(n){wR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wR(e,t,r){return(t=SR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SR(e){var t=NR(e,"string");return typeof t=="symbol"?t:t+""}function NR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ER=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),HC=(e,t,r)=>e.map(n=>"".concat(ER(n)," ").concat(t,"ms ").concat(r)).join(","),_R=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),Qu=(e,t)=>Object.keys(t).reduce((r,n)=>CE(CE({},r),{},{[n]:e(n,t[n])}),{});function AE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function an(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AE(Object(r),!0).forEach(function(n){kR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kR(e,t,r){return(t=jR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jR(e){var t=CR(e,"string");return typeof t=="symbol"?t:t+""}function CR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J0=(e,t,r)=>e+(t-e)*r,Ov=e=>{var{from:t,to:r}=e;return t!==r},VC=(e,t,r)=>{var n=Qu((a,i)=>{if(Ov(i)){var[s,l]=e(i.from,i.to,i.velocity);return an(an({},i),{},{from:s,velocity:l})}return i},t);return r<1?Qu((a,i)=>Ov(i)?an(an({},i),{},{velocity:J0(i.velocity,n[a].velocity,r),from:J0(i.from,n[a].from,r)}):i,t):VC(e,n,r-1)};function AR(e,t,r,n,a,i){var s,l=n.reduce((x,v)=>an(an({},x),{},{[v]:{from:e[v],velocity:0,to:t[v]}}),{}),f=()=>Qu((x,v)=>v.from,l),d=()=>!Object.values(l).filter(Ov).length,h=null,m=x=>{s||(s=x);var v=x-s,y=v/r.dt;l=VC(r,l,y),a(an(an(an({},e),t),f())),s=x,d()||(h=i.setTimeout(m))};return()=>(h=i.setTimeout(m),()=>{h()})}function TR(e,t,r,n,a,i,s){var l=null,f=a.reduce((m,x)=>an(an({},m),{},{[x]:[e[x],t[x]]}),{}),d,h=m=>{d||(d=m);var x=(m-d)/n,v=Qu((g,b)=>J0(...b,r(x)),f);if(i(an(an(an({},e),t),v)),x<1)l=s.setTimeout(h);else{var y=Qu((g,b)=>J0(...b,r(1)),f);i(an(an(an({},e),t),y))}};return()=>(l=s.setTimeout(h),()=>{l()})}const PR=(e,t,r,n,a,i)=>{var s=_R(e,t);return r.isStepper===!0?AR(e,t,r,s,a,i):TR(e,t,r,n,s,a,i)};var Q0=1e-4,KC=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],GC=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),TE=(e,t)=>r=>{var n=KC(e,t);return GC(n,r)},OR=(e,t)=>r=>{var n=KC(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return GC(a,r)},PE=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var f=s[0].split("(");f[0]==="cubic-bezier"&&f[1].split(")")[0].split(",").length===4&&([t,n,r,a]=f[1].split(")")[0].split(",").map(y=>parseFloat(y)))}}else s.length===4&&([t,n,r,a]=s);var d=TE(t,r),h=TE(n,a),m=OR(t,r),x=y=>y>1?1:y<0?0:y,v=y=>{for(var g=y>1?1:y,b=g,N=0;N<8;++N){var _=d(b)-g,S=m(b);if(Math.abs(_-g)<Q0||S<Q0)return h(b);b=x(b-_/S)}return h(b)};return v.isStepper=!1,v},FR=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,l,f)=>{var d=-(s-l)*r,h=f*n,m=f+(d-h)*a/1e3,x=f*a/1e3+s;return Math.abs(x-l)<Q0&&Math.abs(m)<Q0?[l,0]:[x,m]};return i.isStepper=!0,i.dt=a,i},DR=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return PE(e);case"spring":return FR();default:if(e.split("(")[0]==="cubic-bezier")return PE(e)}return typeof e=="function"?e:null};function IR(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var l=s,[f,...d]=l;if(typeof f=="number"){a=e.setTimeout(i.bind(null,d),f);return}i(f),a=e.setTimeout(i.bind(null,d));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class MR{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function RR(){return IR(new MR)}var LR=j.createContext(RR);function BR(e,t){var r=j.useContext(LR);return j.useMemo(()=>t??r(e),[e,t,r])}var $R={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},OE={t:0},gg={t:1};function em(e){var t=La(e,$R),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:l,onAnimationStart:f,children:d}=t,h=BR(t.animationId,t.animationManager),[m,x]=j.useState(r?OE:gg),v=j.useRef(null);return j.useEffect(()=>{r||x(gg)},[r]),j.useEffect(()=>{if(!r||!n)return bR;var y=PR(OE,gg,DR(i),a,x,h.getTimeoutController()),g=()=>{v.current=y()};return h.start([f,s,g,a,l]),()=>{h.stop(),v.current&&v.current(),l()}},[r,n,a,i,s,f,l,h]),d(m.t)}function tm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=j.useRef(Xu(t)),n=j.useRef(e);return n.current!==e&&(r.current=Xu(t),n.current=e),r.current}function FE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FE(Object(r),!0).forEach(function(n){UR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UR(e,t,r){return(t=zR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zR(e){var t=WR(e,"string");return typeof t=="symbol"?t:t+""}function WR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z0(){return Z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Z0.apply(null,arguments)}var IE=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,l=r>=0?1:-1,f=n>=0&&r>=0||n<0&&r<0?1:0,d;if(i>0&&a instanceof Array){for(var h=[0,0,0,0],m=0,x=4;m<x;m++)h[m]=a[m]>i?i:a[m];d="M".concat(e,",").concat(t+s*h[0]),h[0]>0&&(d+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(f,",").concat(e+l*h[0],",").concat(t)),d+="L ".concat(e+r-l*h[1],",").concat(t),h[1]>0&&(d+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(f,`,
        `).concat(e+r,",").concat(t+s*h[1])),d+="L ".concat(e+r,",").concat(t+n-s*h[2]),h[2]>0&&(d+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(f,`,
        `).concat(e+r-l*h[2],",").concat(t+n)),d+="L ".concat(e+l*h[3],",").concat(t+n),h[3]>0&&(d+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(f,`,
        `).concat(e,",").concat(t+n-s*h[3])),d+="Z"}else if(i>0&&a===+a&&a>0){var v=Math.min(i,a);d="M ".concat(e,",").concat(t+s*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(f,",").concat(e+l*v,",").concat(t,`
            L `).concat(e+r-l*v,",").concat(t,`
            A `).concat(v,",").concat(v,",0,0,").concat(f,",").concat(e+r,",").concat(t+s*v,`
            L `).concat(e+r,",").concat(t+n-s*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(f,",").concat(e+r-l*v,",").concat(t+n,`
            L `).concat(e+l*v,",").concat(t+n,`
            A `).concat(v,",").concat(v,",0,0,").concat(f,",").concat(e,",").concat(t+n-s*v," Z")}else d="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return d},HR={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},qC=e=>{var t=La(e,HR),r=j.useRef(null),[n,a]=j.useState(-1);j.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ne=r.current.getTotalLength();ne&&a(ne)}catch{}},[]);var{x:i,y:s,width:l,height:f,radius:d,className:h}=t,{animationEasing:m,animationDuration:x,animationBegin:v,isAnimationActive:y,isUpdateAnimationActive:g}=t,b=j.useRef(l),N=j.useRef(f),_=j.useRef(i),S=j.useRef(s),C=j.useMemo(()=>({x:i,y:s,width:l,height:f,radius:d}),[i,s,l,f,d]),T=tm(C,"rectangle-");if(i!==+i||s!==+s||l!==+l||f!==+f||l===0||f===0)return null;var k=It("recharts-rectangle",h);if(!g)return j.createElement("path",Z0({},jr(t,!0),{className:k,d:IE(i,s,l,f,d)}));var P=b.current,D=N.current,R=_.current,G=S.current,M="0px ".concat(n===-1?1:n,"px"),H="".concat(n,"px 0px"),z=HC(["strokeDasharray"],x,typeof m=="string"?m:void 0);return j.createElement(em,{animationId:T,key:T,canBegin:n>0,duration:x,easing:m,isActive:g,begin:v},ne=>{var Q=on(P,l,ne),le=on(D,f,ne),ue=on(R,i,ne),fe=on(G,s,ne);r.current&&(b.current=Q,N.current=le,_.current=ue,S.current=fe);var K;return y?ne>0?K={transition:z,strokeDasharray:H}:K={strokeDasharray:M}:K={strokeDasharray:H},j.createElement("path",Z0({},jr(t,!0),{className:k,d:IE(ue,fe,Q,le,d),ref:r,style:DE(DE({},K),t.style)}))})};function XC(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Cr(t,r,n,a),l=Cr(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Fv(){return Fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fv.apply(null,arguments)}var VR=(e,t)=>{var r=Kr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},u0=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:l,cornerIsExternal:f}=e,d=l*(s?1:-1)+n,h=Math.asin(l/d)/Y0,m=f?a:a+i*h,x=Cr(t,r,d,m),v=Cr(t,r,n,m),y=f?a-i*h:a,g=Cr(t,r,d*Math.cos(h*Y0),y);return{center:x,circleTangency:v,lineTangency:g,theta:h}},YC=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,l=VR(i,s),f=i+l,d=Cr(t,r,a,i),h=Cr(t,r,a,f),m="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(i>f),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(n>0){var x=Cr(t,r,n,i),v=Cr(t,r,n,f);m+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(i<=f),`,
            `).concat(x.x,",").concat(x.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},KR=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:l,startAngle:f,endAngle:d}=e,h=Kr(d-f),{circleTangency:m,lineTangency:x,theta:v}=u0({cx:t,cy:r,radius:a,angle:f,sign:h,cornerRadius:i,cornerIsExternal:l}),{circleTangency:y,lineTangency:g,theta:b}=u0({cx:t,cy:r,radius:a,angle:d,sign:-h,cornerRadius:i,cornerIsExternal:l}),N=l?Math.abs(f-d):Math.abs(f-d)-v-b;if(N<0)return s?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):YC({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:f,endAngle:d});var _="M ".concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(N>180),",").concat(+(h<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(g.x,",").concat(g.y,`
  `);if(n>0){var{circleTangency:S,lineTangency:C,theta:T}=u0({cx:t,cy:r,radius:n,angle:f,sign:h,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:k,lineTangency:P,theta:D}=u0({cx:t,cy:r,radius:n,angle:d,sign:-h,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),R=l?Math.abs(f-d):Math.abs(f-d)-T-D;if(R<0&&i===0)return"".concat(_,"L").concat(t,",").concat(r,"Z");_+="L".concat(P.x,",").concat(P.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(k.x,",").concat(k.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(R>180),",").concat(+(h>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(C.x,",").concat(C.y,"Z")}else _+="L".concat(t,",").concat(r,"Z");return _},GR={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},JC=e=>{var t=La(e,GR),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:l,cornerIsExternal:f,startAngle:d,endAngle:h,className:m}=t;if(i<a||d===h)return null;var x=It("recharts-sector",m),v=i-a,y=bn(s,v,0,!0),g;return y>0&&Math.abs(d-h)<360?g=KR({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(y,v/2),forceCornerRadius:l,cornerIsExternal:f,startAngle:d,endAngle:h}):g=YC({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:h}),j.createElement("path",Fv({},jr(t,!0),{className:x,d:g}))};function qR(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:f,innerRadius:d,outerRadius:h,angle:m}=t,x=Cr(l,f,d,m),v=Cr(l,f,h,m);n=x.x,a=x.y,i=v.x,s=v.y}else return XC(t);return[{x:n,y:a},{x:i,y:s}]}var vg={},yg={},bg={},ME;function XR(){return ME||(ME=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nC();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(bg)),bg}var RE;function YR(){return RE||(RE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=XR();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(yg)),yg}var LE;function JR(){return LE||(LE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aC(),r=YR();function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const l=Math.max(Math.ceil((i-a)/(s||1)),0),f=new Array(l);for(let d=0;d<l;d++)f[d]=a,a+=s;return f}e.range=n})(vg)),vg}var wg,BE;function QR(){return BE||(BE=1,wg=JR().range),wg}var ZR=QR();const QC=es(ZR);function Ms(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function eL(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function X1(e){let t,r,n;e.length!==2?(t=Ms,r=(l,f)=>Ms(e(l),f),n=(l,f)=>e(l)-f):(t=e===Ms||e===eL?e:tL,r=e,n=e);function a(l,f,d=0,h=l.length){if(d<h){if(t(f,f)!==0)return h;do{const m=d+h>>>1;r(l[m],f)<0?d=m+1:h=m}while(d<h)}return d}function i(l,f,d=0,h=l.length){if(d<h){if(t(f,f)!==0)return h;do{const m=d+h>>>1;r(l[m],f)<=0?d=m+1:h=m}while(d<h)}return d}function s(l,f,d=0,h=l.length){const m=a(l,f,d,h-1);return m>d&&n(l[m-1],f)>-n(l[m],f)?m-1:m}return{left:a,center:s,right:i}}function tL(){return 0}function ZC(e){return e===null?NaN:+e}function*rL(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const nL=X1(Ms),jf=nL.right;X1(ZC).center;class $E extends Map{constructor(t,r=sL){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(UE(this,t))}has(t){return super.has(UE(this,t))}set(t,r){return super.set(aL(this,t),r)}delete(t){return super.delete(iL(this,t))}}function UE({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function aL({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function iL({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function sL(e){return e!==null&&typeof e=="object"?e.valueOf():e}function oL(e=Ms){if(e===Ms)return eA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function eA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const lL=Math.sqrt(50),cL=Math.sqrt(10),uL=Math.sqrt(2);function eh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=lL?10:i>=cL?5:i>=uL?2:1;let l,f,d;return a<0?(d=Math.pow(10,-a)/s,l=Math.round(e*d),f=Math.round(t*d),l/d<e&&++l,f/d>t&&--f,d=-d):(d=Math.pow(10,a)*s,l=Math.round(e/d),f=Math.round(t/d),l*d<e&&++l,f*d>t&&--f),f<l&&.5<=r&&r<2?eh(e,t,r*2):[l,f,d]}function Dv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?eh(t,e,r):eh(e,t,r);if(!(i>=a))return[];const l=i-a+1,f=new Array(l);if(n)if(s<0)for(let d=0;d<l;++d)f[d]=(i-d)/-s;else for(let d=0;d<l;++d)f[d]=(i-d)*s;else if(s<0)for(let d=0;d<l;++d)f[d]=(a+d)/-s;else for(let d=0;d<l;++d)f[d]=(a+d)*s;return f}function Iv(e,t,r){return t=+t,e=+e,r=+r,eh(e,t,r)[2]}function Mv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Iv(t,e,r):Iv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function zE(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function WE(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function tA(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?eA:oL(a);n>r;){if(n-r>600){const f=n-r+1,d=t-r+1,h=Math.log(f),m=.5*Math.exp(2*h/3),x=.5*Math.sqrt(h*m*(f-m)/f)*(d-f/2<0?-1:1),v=Math.max(r,Math.floor(t-d*m/f+x)),y=Math.min(n,Math.floor(t+(f-d)*m/f+x));tA(e,t,v,y,a)}const i=e[t];let s=r,l=n;for(bu(e,r,t),a(e[n],i)>0&&bu(e,r,n);s<l;){for(bu(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?bu(e,r,l):(++l,bu(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function bu(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function fL(e,t,r){if(e=Float64Array.from(rL(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return WE(e);if(t>=1)return zE(e);var n,a=(n-1)*t,i=Math.floor(a),s=zE(tA(e,i).subarray(0,i+1)),l=WE(e.subarray(i+1));return s+(l-s)*(a-i)}}function dL(e,t,r=ZC){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function hL(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Ba(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ns(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Rv=Symbol("implicit");function Y1(){var e=new $E,t=[],r=[],n=Rv;function a(i){let s=e.get(i);if(s===void 0){if(n!==Rv)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new $E;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Y1(t,r).unknown(n)},Ba.apply(a,arguments),a}function J1(){var e=Y1().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,f=0,d=0,h=.5;delete e.unknown;function m(){var x=t().length,v=a<n,y=v?a:n,g=v?n:a;i=(g-y)/Math.max(1,x-f+d*2),l&&(i=Math.floor(i)),y+=(g-y-i*(x-f))*h,s=i*(1-f),l&&(y=Math.round(y),s=Math.round(s));var b=hL(x).map(function(N){return y+i*N});return r(v?b.reverse():b)}return e.domain=function(x){return arguments.length?(t(x),m()):t()},e.range=function(x){return arguments.length?([n,a]=x,n=+n,a=+a,m()):[n,a]},e.rangeRound=function(x){return[n,a]=x,n=+n,a=+a,l=!0,m()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(x){return arguments.length?(l=!!x,m()):l},e.padding=function(x){return arguments.length?(f=Math.min(1,d=+x),m()):f},e.paddingInner=function(x){return arguments.length?(f=Math.min(1,x),m()):f},e.paddingOuter=function(x){return arguments.length?(d=+x,m()):d},e.align=function(x){return arguments.length?(h=Math.max(0,Math.min(1,x)),m()):h},e.copy=function(){return J1(t(),[n,a]).round(l).paddingInner(f).paddingOuter(d).align(h)},Ba.apply(m(),arguments)}function rA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return rA(t())},e}function mL(){return rA(J1.apply(null,arguments).paddingInner(1))}function Q1(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function nA(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Cf(){}var Zu=.7,th=1/Zu,Jl="\\s*([+-]?\\d+)\\s*",ef="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",pi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pL=/^#([0-9a-f]{3,8})$/,xL=new RegExp(`^rgb\\(${Jl},${Jl},${Jl}\\)$`),gL=new RegExp(`^rgb\\(${pi},${pi},${pi}\\)$`),vL=new RegExp(`^rgba\\(${Jl},${Jl},${Jl},${ef}\\)$`),yL=new RegExp(`^rgba\\(${pi},${pi},${pi},${ef}\\)$`),bL=new RegExp(`^hsl\\(${ef},${pi},${pi}\\)$`),wL=new RegExp(`^hsla\\(${ef},${pi},${pi},${ef}\\)$`),HE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Q1(Cf,tf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:VE,formatHex:VE,formatHex8:SL,formatHsl:NL,formatRgb:KE,toString:KE});function VE(){return this.rgb().formatHex()}function SL(){return this.rgb().formatHex8()}function NL(){return aA(this).formatHsl()}function KE(){return this.rgb().formatRgb()}function tf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=pL.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?GE(t):r===3?new Hn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?f0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?f0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=xL.exec(e))?new Hn(t[1],t[2],t[3],1):(t=gL.exec(e))?new Hn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vL.exec(e))?f0(t[1],t[2],t[3],t[4]):(t=yL.exec(e))?f0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=bL.exec(e))?YE(t[1],t[2]/100,t[3]/100,1):(t=wL.exec(e))?YE(t[1],t[2]/100,t[3]/100,t[4]):HE.hasOwnProperty(e)?GE(HE[e]):e==="transparent"?new Hn(NaN,NaN,NaN,0):null}function GE(e){return new Hn(e>>16&255,e>>8&255,e&255,1)}function f0(e,t,r,n){return n<=0&&(e=t=r=NaN),new Hn(e,t,r,n)}function EL(e){return e instanceof Cf||(e=tf(e)),e?(e=e.rgb(),new Hn(e.r,e.g,e.b,e.opacity)):new Hn}function Lv(e,t,r,n){return arguments.length===1?EL(e):new Hn(e,t,r,n??1)}function Hn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Q1(Hn,Lv,nA(Cf,{brighter(e){return e=e==null?th:Math.pow(th,e),new Hn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zu:Math.pow(Zu,e),new Hn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Hn(Do(this.r),Do(this.g),Do(this.b),rh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qE,formatHex:qE,formatHex8:_L,formatRgb:XE,toString:XE}));function qE(){return`#${Co(this.r)}${Co(this.g)}${Co(this.b)}`}function _L(){return`#${Co(this.r)}${Co(this.g)}${Co(this.b)}${Co((isNaN(this.opacity)?1:this.opacity)*255)}`}function XE(){const e=rh(this.opacity);return`${e===1?"rgb(":"rgba("}${Do(this.r)}, ${Do(this.g)}, ${Do(this.b)}${e===1?")":`, ${e})`}`}function rh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Do(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Co(e){return e=Do(e),(e<16?"0":"")+e.toString(16)}function YE(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ya(e,t,r,n)}function aA(e){if(e instanceof Ya)return new Ya(e.h,e.s,e.l,e.opacity);if(e instanceof Cf||(e=tf(e)),!e)return new Ya;if(e instanceof Ya)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,f=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=f<.5?i+a:2-i-a,s*=60):l=f>0&&f<1?0:s,new Ya(s,l,f,e.opacity)}function kL(e,t,r,n){return arguments.length===1?aA(e):new Ya(e,t,r,n??1)}function Ya(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Q1(Ya,kL,nA(Cf,{brighter(e){return e=e==null?th:Math.pow(th,e),new Ya(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zu:Math.pow(Zu,e),new Ya(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Hn(Sg(e>=240?e-240:e+120,a,n),Sg(e,a,n),Sg(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ya(JE(this.h),d0(this.s),d0(this.l),rh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=rh(this.opacity);return`${e===1?"hsl(":"hsla("}${JE(this.h)}, ${d0(this.s)*100}%, ${d0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function JE(e){return e=(e||0)%360,e<0?e+360:e}function d0(e){return Math.max(0,Math.min(1,e||0))}function Sg(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Z1=e=>()=>e;function jL(e,t){return function(r){return e+r*t}}function CL(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function AL(e){return(e=+e)==1?iA:function(t,r){return r-t?CL(t,r,e):Z1(isNaN(t)?r:t)}}function iA(e,t){var r=t-e;return r?jL(e,r):Z1(isNaN(e)?t:e)}const QE=(function e(t){var r=AL(t);function n(a,i){var s=r((a=Lv(a)).r,(i=Lv(i)).r),l=r(a.g,i.g),f=r(a.b,i.b),d=iA(a.opacity,i.opacity);return function(h){return a.r=s(h),a.g=l(h),a.b=f(h),a.opacity=d(h),a+""}}return n.gamma=e,n})(1);function TL(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function PL(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function OL(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=yc(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function FL(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function nh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function DL(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=yc(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Bv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ng=new RegExp(Bv.source,"g");function IL(e){return function(){return e}}function ML(e){return function(t){return e(t)+""}}function RL(e,t){var r=Bv.lastIndex=Ng.lastIndex=0,n,a,i,s=-1,l=[],f=[];for(e=e+"",t=t+"";(n=Bv.exec(e))&&(a=Ng.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,f.push({i:s,x:nh(n,a)})),r=Ng.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?f[0]?ML(f[0].x):IL(t):(t=f.length,function(d){for(var h=0,m;h<t;++h)l[(m=f[h]).i]=m.x(d);return l.join("")})}function yc(e,t){var r=typeof t,n;return t==null||r==="boolean"?Z1(t):(r==="number"?nh:r==="string"?(n=tf(t))?(t=n,QE):RL:t instanceof tf?QE:t instanceof Date?FL:PL(t)?TL:Array.isArray(t)?OL:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?DL:nh)(e,t)}function ey(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function LL(e,t){t===void 0&&(t=e,e=yc);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function BL(e){return function(){return e}}function ah(e){return+e}var ZE=[0,1];function Tn(e){return e}function $v(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:BL(isNaN(t)?NaN:.5)}function $L(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function UL(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=$v(a,n),i=r(s,i)):(n=$v(n,a),i=r(i,s)),function(l){return i(n(l))}}function zL(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=$v(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var f=jf(e,l,1,n)-1;return i[f](a[f](l))}}function Af(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function rm(){var e=ZE,t=ZE,r=yc,n,a,i,s=Tn,l,f,d;function h(){var x=Math.min(e.length,t.length);return s!==Tn&&(s=$L(e[0],e[x-1])),l=x>2?zL:UL,f=d=null,m}function m(x){return x==null||isNaN(x=+x)?i:(f||(f=l(e.map(n),t,r)))(n(s(x)))}return m.invert=function(x){return s(a((d||(d=l(t,e.map(n),nh)))(x)))},m.domain=function(x){return arguments.length?(e=Array.from(x,ah),h()):e.slice()},m.range=function(x){return arguments.length?(t=Array.from(x),h()):t.slice()},m.rangeRound=function(x){return t=Array.from(x),r=ey,h()},m.clamp=function(x){return arguments.length?(s=x?!0:Tn,h()):s!==Tn},m.interpolate=function(x){return arguments.length?(r=x,h()):r},m.unknown=function(x){return arguments.length?(i=x,m):i},function(x,v){return n=x,a=v,h()}}function ty(){return rm()(Tn,Tn)}function WL(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ih(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function sc(e){return e=ih(Math.abs(e)),e?e[1]:NaN}function HL(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],f=0;a>0&&l>0&&(f+l+1>n&&(l=Math.max(1,n-f)),i.push(r.substring(a-=l,a+l)),!((f+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function VL(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var KL=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rf(e){if(!(t=KL.exec(e)))throw new Error("invalid format: "+e);var t;return new ry({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}rf.prototype=ry.prototype;function ry(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ry.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function GL(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var sA;function qL(e,t){var r=ih(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(sA=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+ih(e,Math.max(0,t+i-1))[0]}function e_(e,t){var r=ih(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const t_={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:WL,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>e_(e*100,t),r:e_,s:qL,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function r_(e){return e}var n_=Array.prototype.map,a_=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function XL(e){var t=e.grouping===void 0||e.thousands===void 0?r_:HL(n_.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?r_:VL(n_.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function d(m){m=rf(m);var x=m.fill,v=m.align,y=m.sign,g=m.symbol,b=m.zero,N=m.width,_=m.comma,S=m.precision,C=m.trim,T=m.type;T==="n"?(_=!0,T="g"):t_[T]||(S===void 0&&(S=12),C=!0,T="g"),(b||x==="0"&&v==="=")&&(b=!0,x="0",v="=");var k=g==="$"?r:g==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",P=g==="$"?n:/[%p]/.test(T)?s:"",D=t_[T],R=/[defgprs%]/.test(T);S=S===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function G(M){var H=k,z=P,ne,Q,le;if(T==="c")z=D(M)+z,M="";else{M=+M;var ue=M<0||1/M<0;if(M=isNaN(M)?f:D(Math.abs(M),S),C&&(M=GL(M)),ue&&+M==0&&y!=="+"&&(ue=!1),H=(ue?y==="("?y:l:y==="-"||y==="("?"":y)+H,z=(T==="s"?a_[8+sA/3]:"")+z+(ue&&y==="("?")":""),R){for(ne=-1,Q=M.length;++ne<Q;)if(le=M.charCodeAt(ne),48>le||le>57){z=(le===46?a+M.slice(ne+1):M.slice(ne))+z,M=M.slice(0,ne);break}}}_&&!b&&(M=t(M,1/0));var fe=H.length+M.length+z.length,K=fe<N?new Array(N-fe+1).join(x):"";switch(_&&b&&(M=t(K+M,K.length?N-z.length:1/0),K=""),v){case"<":M=H+M+z+K;break;case"=":M=H+K+M+z;break;case"^":M=K.slice(0,fe=K.length>>1)+H+M+z+K.slice(fe);break;default:M=K+H+M+z;break}return i(M)}return G.toString=function(){return m+""},G}function h(m,x){var v=d((m=rf(m),m.type="f",m)),y=Math.max(-8,Math.min(8,Math.floor(sc(x)/3)))*3,g=Math.pow(10,-y),b=a_[8+y/3];return function(N){return v(g*N)+b}}return{format:d,formatPrefix:h}}var h0,ny,oA;YL({thousands:",",grouping:[3],currency:["$",""]});function YL(e){return h0=XL(e),ny=h0.format,oA=h0.formatPrefix,h0}function JL(e){return Math.max(0,-sc(Math.abs(e)))}function QL(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(sc(t)/3)))*3-sc(Math.abs(e)))}function ZL(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,sc(t)-sc(e))+1}function lA(e,t,r,n){var a=Mv(e,t,r),i;switch(n=rf(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=QL(a,s))&&(n.precision=i),oA(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=ZL(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=JL(a))&&(n.precision=i-(n.type==="%")*2);break}}return ny(n)}function Xs(e){var t=e.domain;return e.ticks=function(r){var n=t();return Dv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return lA(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],f,d,h=10;for(l<s&&(d=s,s=l,l=d,d=a,a=i,i=d);h-- >0;){if(d=Iv(s,l,r),d===f)return n[a]=s,n[i]=l,t(n);if(d>0)s=Math.floor(s/d)*d,l=Math.ceil(l/d)*d;else if(d<0)s=Math.ceil(s*d)/d,l=Math.floor(l*d)/d;else break;f=d}return e},e}function cA(){var e=ty();return e.copy=function(){return Af(e,cA())},Ba.apply(e,arguments),Xs(e)}function uA(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,ah),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return uA(e).unknown(t)},e=arguments.length?Array.from(e,ah):[0,1],Xs(r)}function fA(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function i_(e){return Math.log(e)}function s_(e){return Math.exp(e)}function e7(e){return-Math.log(-e)}function t7(e){return-Math.exp(-e)}function r7(e){return isFinite(e)?+("1e"+e):e<0?0:e}function n7(e){return e===10?r7:e===Math.E?Math.exp:t=>Math.pow(e,t)}function a7(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function o_(e){return(t,r)=>-e(-t,r)}function ay(e){const t=e(i_,s_),r=t.domain;let n=10,a,i;function s(){return a=a7(n),i=n7(n),r()[0]<0?(a=o_(a),i=o_(i),e(e7,t7)):e(i_,s_),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const f=r();let d=f[0],h=f[f.length-1];const m=h<d;m&&([d,h]=[h,d]);let x=a(d),v=a(h),y,g;const b=l==null?10:+l;let N=[];if(!(n%1)&&v-x<b){if(x=Math.floor(x),v=Math.ceil(v),d>0){for(;x<=v;++x)for(y=1;y<n;++y)if(g=x<0?y/i(-x):y*i(x),!(g<d)){if(g>h)break;N.push(g)}}else for(;x<=v;++x)for(y=n-1;y>=1;--y)if(g=x>0?y/i(-x):y*i(x),!(g<d)){if(g>h)break;N.push(g)}N.length*2<b&&(N=Dv(d,h,b))}else N=Dv(x,v,Math.min(v-x,b)).map(i);return m?N.reverse():N},t.tickFormat=(l,f)=>{if(l==null&&(l=10),f==null&&(f=n===10?"s":","),typeof f!="function"&&(!(n%1)&&(f=rf(f)).precision==null&&(f.trim=!0),f=ny(f)),l===1/0)return f;const d=Math.max(1,n*l/t.ticks().length);return h=>{let m=h/i(Math.round(a(h)));return m*n<n-.5&&(m*=n),m<=d?f(h):""}},t.nice=()=>r(fA(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function dA(){const e=ay(rm()).domain([1,10]);return e.copy=()=>Af(e,dA()).base(e.base()),Ba.apply(e,arguments),e}function l_(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function c_(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function iy(e){var t=1,r=e(l_(t),c_(t));return r.constant=function(n){return arguments.length?e(l_(t=+n),c_(t)):t},Xs(r)}function hA(){var e=iy(rm());return e.copy=function(){return Af(e,hA()).constant(e.constant())},Ba.apply(e,arguments)}function u_(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function i7(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function s7(e){return e<0?-e*e:e*e}function sy(e){var t=e(Tn,Tn),r=1;function n(){return r===1?e(Tn,Tn):r===.5?e(i7,s7):e(u_(r),u_(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Xs(t)}function oy(){var e=sy(rm());return e.copy=function(){return Af(e,oy()).exponent(e.exponent())},Ba.apply(e,arguments),e}function o7(){return oy.apply(null,arguments).exponent(.5)}function f_(e){return Math.sign(e)*e*e}function l7(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function mA(){var e=ty(),t=[0,1],r=!1,n;function a(i){var s=l7(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(f_(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,ah)).map(f_)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return mA(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ba.apply(a,arguments),Xs(a)}function pA(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=dL(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[jf(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Ms),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return pA().domain(e).range(t).unknown(n)},Ba.apply(i,arguments)}function xA(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(f){return f!=null&&f<=f?a[jf(n,f,0,r)]:i}function l(){var f=-1;for(n=new Array(r);++f<r;)n[f]=((f+1)*t-(f-r)*e)/(r+1);return s}return s.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,l()):[e,t]},s.range=function(f){return arguments.length?(r=(a=Array.from(f)).length-1,l()):a.slice()},s.invertExtent=function(f){var d=a.indexOf(f);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},s.unknown=function(f){return arguments.length&&(i=f),s},s.thresholds=function(){return n.slice()},s.copy=function(){return xA().domain([e,t]).range(a).unknown(i)},Ba.apply(Xs(s),arguments)}function gA(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[jf(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return gA().domain(e).range(t).unknown(r)},Ba.apply(a,arguments)}const Eg=new Date,_g=new Date;function Mr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const f=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return f;let d;do f.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<s);return f},a.filter=i=>Mr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Eg.setTime(+i),_g.setTime(+s),e(Eg),e(_g),Math.floor(r(Eg,_g))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const sh=Mr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);sh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Mr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):sh);sh.range;const Ri=1e3,Pa=Ri*60,Li=Pa*60,Yi=Li*24,ly=Yi*7,d_=Yi*30,kg=Yi*365,Ao=Mr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ri)},(e,t)=>(t-e)/Ri,e=>e.getUTCSeconds());Ao.range;const cy=Mr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ri)},(e,t)=>{e.setTime(+e+t*Pa)},(e,t)=>(t-e)/Pa,e=>e.getMinutes());cy.range;const uy=Mr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Pa)},(e,t)=>(t-e)/Pa,e=>e.getUTCMinutes());uy.range;const fy=Mr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ri-e.getMinutes()*Pa)},(e,t)=>{e.setTime(+e+t*Li)},(e,t)=>(t-e)/Li,e=>e.getHours());fy.range;const dy=Mr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Li)},(e,t)=>(t-e)/Li,e=>e.getUTCHours());dy.range;const Tf=Mr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Pa)/Yi,e=>e.getDate()-1);Tf.range;const nm=Mr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Yi,e=>e.getUTCDate()-1);nm.range;const vA=Mr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Yi,e=>Math.floor(e/Yi));vA.range;function nl(e){return Mr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Pa)/ly)}const am=nl(0),oh=nl(1),c7=nl(2),u7=nl(3),oc=nl(4),f7=nl(5),d7=nl(6);am.range;oh.range;c7.range;u7.range;oc.range;f7.range;d7.range;function al(e){return Mr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/ly)}const im=al(0),lh=al(1),h7=al(2),m7=al(3),lc=al(4),p7=al(5),x7=al(6);im.range;lh.range;h7.range;m7.range;lc.range;p7.range;x7.range;const hy=Mr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());hy.range;const my=Mr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());my.range;const Ji=Mr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ji.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Mr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Ji.range;const Qi=Mr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Qi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Mr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Qi.range;function yA(e,t,r,n,a,i){const s=[[Ao,1,Ri],[Ao,5,5*Ri],[Ao,15,15*Ri],[Ao,30,30*Ri],[i,1,Pa],[i,5,5*Pa],[i,15,15*Pa],[i,30,30*Pa],[a,1,Li],[a,3,3*Li],[a,6,6*Li],[a,12,12*Li],[n,1,Yi],[n,2,2*Yi],[r,1,ly],[t,1,d_],[t,3,3*d_],[e,1,kg]];function l(d,h,m){const x=h<d;x&&([d,h]=[h,d]);const v=m&&typeof m.range=="function"?m:f(d,h,m),y=v?v.range(d,+h+1):[];return x?y.reverse():y}function f(d,h,m){const x=Math.abs(h-d)/m,v=X1(([,,b])=>b).right(s,x);if(v===s.length)return e.every(Mv(d/kg,h/kg,m));if(v===0)return sh.every(Math.max(Mv(d,h,m),1));const[y,g]=s[x/s[v-1][2]<s[v][2]/x?v-1:v];return y.every(g)}return[l,f]}const[g7,v7]=yA(Qi,my,im,vA,dy,uy),[y7,b7]=yA(Ji,hy,am,Tf,fy,cy);function jg(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Cg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function wu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function w7(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,f=e.shortMonths,d=Su(a),h=Nu(a),m=Su(i),x=Nu(i),v=Su(s),y=Nu(s),g=Su(l),b=Nu(l),N=Su(f),_=Nu(f),S={a:ue,A:fe,b:K,B:me,c:null,d:v_,e:v_,f:H7,g:e9,G:r9,H:U7,I:z7,j:W7,L:bA,m:V7,M:K7,p:J,q:O,Q:w_,s:S_,S:G7,u:q7,U:X7,V:Y7,w:J7,W:Q7,x:null,X:null,y:Z7,Y:t9,Z:n9,"%":b_},C={a:ae,A:ee,b:L,B:V,c:null,d:y_,e:y_,f:o9,g:g9,G:y9,H:a9,I:i9,j:s9,L:SA,m:l9,M:c9,p:se,q:U,Q:w_,s:S_,S:u9,u:f9,U:d9,V:h9,w:m9,W:p9,x:null,X:null,y:x9,Y:v9,Z:b9,"%":b_},T={a:G,A:M,b:H,B:z,c:ne,d:x_,e:x_,f:R7,g:p_,G:m_,H:g_,I:g_,j:F7,L:M7,m:O7,M:D7,p:R,q:P7,Q:B7,s:$7,S:I7,u:k7,U:j7,V:C7,w:_7,W:A7,x:Q,X:le,y:p_,Y:m_,Z:T7,"%":L7};S.x=k(r,S),S.X=k(n,S),S.c=k(t,S),C.x=k(r,C),C.X=k(n,C),C.c=k(t,C);function k(W,X){return function(de){var F=[],Pe=-1,Ae=0,We=W.length,Ue,Te,lt;for(de instanceof Date||(de=new Date(+de));++Pe<We;)W.charCodeAt(Pe)===37&&(F.push(W.slice(Ae,Pe)),(Te=h_[Ue=W.charAt(++Pe)])!=null?Ue=W.charAt(++Pe):Te=Ue==="e"?" ":"0",(lt=X[Ue])&&(Ue=lt(de,Te)),F.push(Ue),Ae=Pe+1);return F.push(W.slice(Ae,Pe)),F.join("")}}function P(W,X){return function(de){var F=wu(1900,void 0,1),Pe=D(F,W,de+="",0),Ae,We;if(Pe!=de.length)return null;if("Q"in F)return new Date(F.Q);if("s"in F)return new Date(F.s*1e3+("L"in F?F.L:0));if(X&&!("Z"in F)&&(F.Z=0),"p"in F&&(F.H=F.H%12+F.p*12),F.m===void 0&&(F.m="q"in F?F.q:0),"V"in F){if(F.V<1||F.V>53)return null;"w"in F||(F.w=1),"Z"in F?(Ae=Cg(wu(F.y,0,1)),We=Ae.getUTCDay(),Ae=We>4||We===0?lh.ceil(Ae):lh(Ae),Ae=nm.offset(Ae,(F.V-1)*7),F.y=Ae.getUTCFullYear(),F.m=Ae.getUTCMonth(),F.d=Ae.getUTCDate()+(F.w+6)%7):(Ae=jg(wu(F.y,0,1)),We=Ae.getDay(),Ae=We>4||We===0?oh.ceil(Ae):oh(Ae),Ae=Tf.offset(Ae,(F.V-1)*7),F.y=Ae.getFullYear(),F.m=Ae.getMonth(),F.d=Ae.getDate()+(F.w+6)%7)}else("W"in F||"U"in F)&&("w"in F||(F.w="u"in F?F.u%7:"W"in F?1:0),We="Z"in F?Cg(wu(F.y,0,1)).getUTCDay():jg(wu(F.y,0,1)).getDay(),F.m=0,F.d="W"in F?(F.w+6)%7+F.W*7-(We+5)%7:F.w+F.U*7-(We+6)%7);return"Z"in F?(F.H+=F.Z/100|0,F.M+=F.Z%100,Cg(F)):jg(F)}}function D(W,X,de,F){for(var Pe=0,Ae=X.length,We=de.length,Ue,Te;Pe<Ae;){if(F>=We)return-1;if(Ue=X.charCodeAt(Pe++),Ue===37){if(Ue=X.charAt(Pe++),Te=T[Ue in h_?X.charAt(Pe++):Ue],!Te||(F=Te(W,de,F))<0)return-1}else if(Ue!=de.charCodeAt(F++))return-1}return F}function R(W,X,de){var F=d.exec(X.slice(de));return F?(W.p=h.get(F[0].toLowerCase()),de+F[0].length):-1}function G(W,X,de){var F=v.exec(X.slice(de));return F?(W.w=y.get(F[0].toLowerCase()),de+F[0].length):-1}function M(W,X,de){var F=m.exec(X.slice(de));return F?(W.w=x.get(F[0].toLowerCase()),de+F[0].length):-1}function H(W,X,de){var F=N.exec(X.slice(de));return F?(W.m=_.get(F[0].toLowerCase()),de+F[0].length):-1}function z(W,X,de){var F=g.exec(X.slice(de));return F?(W.m=b.get(F[0].toLowerCase()),de+F[0].length):-1}function ne(W,X,de){return D(W,t,X,de)}function Q(W,X,de){return D(W,r,X,de)}function le(W,X,de){return D(W,n,X,de)}function ue(W){return s[W.getDay()]}function fe(W){return i[W.getDay()]}function K(W){return f[W.getMonth()]}function me(W){return l[W.getMonth()]}function J(W){return a[+(W.getHours()>=12)]}function O(W){return 1+~~(W.getMonth()/3)}function ae(W){return s[W.getUTCDay()]}function ee(W){return i[W.getUTCDay()]}function L(W){return f[W.getUTCMonth()]}function V(W){return l[W.getUTCMonth()]}function se(W){return a[+(W.getUTCHours()>=12)]}function U(W){return 1+~~(W.getUTCMonth()/3)}return{format:function(W){var X=k(W+="",S);return X.toString=function(){return W},X},parse:function(W){var X=P(W+="",!1);return X.toString=function(){return W},X},utcFormat:function(W){var X=k(W+="",C);return X.toString=function(){return W},X},utcParse:function(W){var X=P(W+="",!0);return X.toString=function(){return W},X}}}var h_={"-":"",_:" ",0:"0"},Yr=/^\s*\d+/,S7=/^%/,N7=/[\\^$*+?|[\]().{}]/g;function _t(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function E7(e){return e.replace(N7,"\\$&")}function Su(e){return new RegExp("^(?:"+e.map(E7).join("|")+")","i")}function Nu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function _7(e,t,r){var n=Yr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function k7(e,t,r){var n=Yr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function j7(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function C7(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function A7(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function m_(e,t,r){var n=Yr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function p_(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function T7(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function P7(e,t,r){var n=Yr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function O7(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function x_(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function F7(e,t,r){var n=Yr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function g_(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function D7(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function I7(e,t,r){var n=Yr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function M7(e,t,r){var n=Yr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function R7(e,t,r){var n=Yr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function L7(e,t,r){var n=S7.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function B7(e,t,r){var n=Yr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function $7(e,t,r){var n=Yr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function v_(e,t){return _t(e.getDate(),t,2)}function U7(e,t){return _t(e.getHours(),t,2)}function z7(e,t){return _t(e.getHours()%12||12,t,2)}function W7(e,t){return _t(1+Tf.count(Ji(e),e),t,3)}function bA(e,t){return _t(e.getMilliseconds(),t,3)}function H7(e,t){return bA(e,t)+"000"}function V7(e,t){return _t(e.getMonth()+1,t,2)}function K7(e,t){return _t(e.getMinutes(),t,2)}function G7(e,t){return _t(e.getSeconds(),t,2)}function q7(e){var t=e.getDay();return t===0?7:t}function X7(e,t){return _t(am.count(Ji(e)-1,e),t,2)}function wA(e){var t=e.getDay();return t>=4||t===0?oc(e):oc.ceil(e)}function Y7(e,t){return e=wA(e),_t(oc.count(Ji(e),e)+(Ji(e).getDay()===4),t,2)}function J7(e){return e.getDay()}function Q7(e,t){return _t(oh.count(Ji(e)-1,e),t,2)}function Z7(e,t){return _t(e.getFullYear()%100,t,2)}function e9(e,t){return e=wA(e),_t(e.getFullYear()%100,t,2)}function t9(e,t){return _t(e.getFullYear()%1e4,t,4)}function r9(e,t){var r=e.getDay();return e=r>=4||r===0?oc(e):oc.ceil(e),_t(e.getFullYear()%1e4,t,4)}function n9(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_t(t/60|0,"0",2)+_t(t%60,"0",2)}function y_(e,t){return _t(e.getUTCDate(),t,2)}function a9(e,t){return _t(e.getUTCHours(),t,2)}function i9(e,t){return _t(e.getUTCHours()%12||12,t,2)}function s9(e,t){return _t(1+nm.count(Qi(e),e),t,3)}function SA(e,t){return _t(e.getUTCMilliseconds(),t,3)}function o9(e,t){return SA(e,t)+"000"}function l9(e,t){return _t(e.getUTCMonth()+1,t,2)}function c9(e,t){return _t(e.getUTCMinutes(),t,2)}function u9(e,t){return _t(e.getUTCSeconds(),t,2)}function f9(e){var t=e.getUTCDay();return t===0?7:t}function d9(e,t){return _t(im.count(Qi(e)-1,e),t,2)}function NA(e){var t=e.getUTCDay();return t>=4||t===0?lc(e):lc.ceil(e)}function h9(e,t){return e=NA(e),_t(lc.count(Qi(e),e)+(Qi(e).getUTCDay()===4),t,2)}function m9(e){return e.getUTCDay()}function p9(e,t){return _t(lh.count(Qi(e)-1,e),t,2)}function x9(e,t){return _t(e.getUTCFullYear()%100,t,2)}function g9(e,t){return e=NA(e),_t(e.getUTCFullYear()%100,t,2)}function v9(e,t){return _t(e.getUTCFullYear()%1e4,t,4)}function y9(e,t){var r=e.getUTCDay();return e=r>=4||r===0?lc(e):lc.ceil(e),_t(e.getUTCFullYear()%1e4,t,4)}function b9(){return"+0000"}function b_(){return"%"}function w_(e){return+e}function S_(e){return Math.floor(+e/1e3)}var Ml,EA,_A;w9({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function w9(e){return Ml=w7(e),EA=Ml.format,Ml.parse,_A=Ml.utcFormat,Ml.utcParse,Ml}function S9(e){return new Date(e)}function N9(e){return e instanceof Date?+e:+new Date(+e)}function py(e,t,r,n,a,i,s,l,f,d){var h=ty(),m=h.invert,x=h.domain,v=d(".%L"),y=d(":%S"),g=d("%I:%M"),b=d("%I %p"),N=d("%a %d"),_=d("%b %d"),S=d("%B"),C=d("%Y");function T(k){return(f(k)<k?v:l(k)<k?y:s(k)<k?g:i(k)<k?b:n(k)<k?a(k)<k?N:_:r(k)<k?S:C)(k)}return h.invert=function(k){return new Date(m(k))},h.domain=function(k){return arguments.length?x(Array.from(k,N9)):x().map(S9)},h.ticks=function(k){var P=x();return e(P[0],P[P.length-1],k??10)},h.tickFormat=function(k,P){return P==null?T:d(P)},h.nice=function(k){var P=x();return(!k||typeof k.range!="function")&&(k=t(P[0],P[P.length-1],k??10)),k?x(fA(P,k)):h},h.copy=function(){return Af(h,py(e,t,r,n,a,i,s,l,f,d))},h}function E9(){return Ba.apply(py(y7,b7,Ji,hy,am,Tf,fy,cy,Ao,EA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function _9(){return Ba.apply(py(g7,v7,Qi,my,im,nm,dy,uy,Ao,_A).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function sm(){var e=0,t=1,r,n,a,i,s=Tn,l=!1,f;function d(m){return m==null||isNaN(m=+m)?f:s(a===0?.5:(m=(i(m)-r)*a,l?Math.max(0,Math.min(1,m)):m))}d.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(m){return arguments.length?(l=!!m,d):l},d.interpolator=function(m){return arguments.length?(s=m,d):s};function h(m){return function(x){var v,y;return arguments.length?([v,y]=x,s=m(v,y),d):[s(0),s(1)]}}return d.range=h(yc),d.rangeRound=h(ey),d.unknown=function(m){return arguments.length?(f=m,d):f},function(m){return i=m,r=m(e),n=m(t),a=r===n?0:1/(n-r),d}}function Ys(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function kA(){var e=Xs(sm()(Tn));return e.copy=function(){return Ys(e,kA())},ns.apply(e,arguments)}function jA(){var e=ay(sm()).domain([1,10]);return e.copy=function(){return Ys(e,jA()).base(e.base())},ns.apply(e,arguments)}function CA(){var e=iy(sm());return e.copy=function(){return Ys(e,CA()).constant(e.constant())},ns.apply(e,arguments)}function xy(){var e=sy(sm());return e.copy=function(){return Ys(e,xy()).exponent(e.exponent())},ns.apply(e,arguments)}function k9(){return xy.apply(null,arguments).exponent(.5)}function AA(){var e=[],t=Tn;function r(n){if(n!=null&&!isNaN(n=+n))return t((jf(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ms),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>fL(e,i/n))},r.copy=function(){return AA(t).domain(e)},ns.apply(r,arguments)}function om(){var e=0,t=.5,r=1,n=1,a,i,s,l,f,d=Tn,h,m=!1,x;function v(g){return isNaN(g=+g)?x:(g=.5+((g=+h(g))-i)*(n*g<n*i?l:f),d(m?Math.max(0,Math.min(1,g)):g))}v.domain=function(g){return arguments.length?([e,t,r]=g,a=h(e=+e),i=h(t=+t),s=h(r=+r),l=a===i?0:.5/(i-a),f=i===s?0:.5/(s-i),n=i<a?-1:1,v):[e,t,r]},v.clamp=function(g){return arguments.length?(m=!!g,v):m},v.interpolator=function(g){return arguments.length?(d=g,v):d};function y(g){return function(b){var N,_,S;return arguments.length?([N,_,S]=b,d=LL(g,[N,_,S]),v):[d(0),d(.5),d(1)]}}return v.range=y(yc),v.rangeRound=y(ey),v.unknown=function(g){return arguments.length?(x=g,v):x},function(g){return h=g,a=g(e),i=g(t),s=g(r),l=a===i?0:.5/(i-a),f=i===s?0:.5/(s-i),n=i<a?-1:1,v}}function TA(){var e=Xs(om()(Tn));return e.copy=function(){return Ys(e,TA())},ns.apply(e,arguments)}function PA(){var e=ay(om()).domain([.1,1,10]);return e.copy=function(){return Ys(e,PA()).base(e.base())},ns.apply(e,arguments)}function OA(){var e=iy(om());return e.copy=function(){return Ys(e,OA()).constant(e.constant())},ns.apply(e,arguments)}function gy(){var e=sy(om());return e.copy=function(){return Ys(e,gy()).exponent(e.exponent())},ns.apply(e,arguments)}function j9(){return gy.apply(null,arguments).exponent(.5)}const Tu=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:J1,scaleDiverging:TA,scaleDivergingLog:PA,scaleDivergingPow:gy,scaleDivergingSqrt:j9,scaleDivergingSymlog:OA,scaleIdentity:uA,scaleImplicit:Rv,scaleLinear:cA,scaleLog:dA,scaleOrdinal:Y1,scalePoint:mL,scalePow:oy,scaleQuantile:pA,scaleQuantize:xA,scaleRadial:mA,scaleSequential:kA,scaleSequentialLog:jA,scaleSequentialPow:xy,scaleSequentialQuantile:AA,scaleSequentialSqrt:k9,scaleSequentialSymlog:CA,scaleSqrt:o7,scaleSymlog:hA,scaleThreshold:gA,scaleTime:E9,scaleUtc:_9,tickFormat:lA},Symbol.toStringTag,{value:"Module"}));var Js=e=>e.chartData,vy=Ne([Js],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),yy=(e,t,r,n)=>n?vy(e):Js(e);function cc(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(fa(t)&&fa(r))return!0}return!1}function N_(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function C9(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(fa(r))a=r;else if(typeof r=="function")return;if(fa(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(cc(s))return s}}function A9(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(cc(n))return N_(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,l;if(a==="auto")t!=null&&(s=Math.min(...t));else if(Ze(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t?.[0]))}catch{}else if(typeof a=="string"&&hE.test(a)){var f=hE.exec(a);if(f==null||t==null)s=void 0;else{var d=+f[1];s=t[0]-d}}else s=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(Ze(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&mE.test(i)){var h=mE.exec(i);if(h==null||t==null)l=void 0;else{var m=+h[1];l=t[1]+m}}else l=t?.[1];var x=[s,l];if(cc(x))return t==null?x:N_(x,t,r)}}}var bc=1e9,T9={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},wy,er=!0,Ia="[DecimalError] ",Io=Ia+"Invalid argument: ",by=Ia+"Exponent out of range: ",wc=Math.floor,Eo=Math.pow,P9=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,aa,Wr=1e7,Kt=7,FA=9007199254740991,ch=wc(FA/Kt),qe={};qe.absoluteValue=qe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};qe.comparedTo=qe.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};qe.decimalPlaces=qe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Kt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};qe.dividedBy=qe.div=function(e){return zi(this,new this.constructor(e))};qe.dividedToIntegerBy=qe.idiv=function(e){var t=this,r=t.constructor;return $t(zi(t,new r(e),0,1),r.precision)};qe.equals=qe.eq=function(e){return!this.cmp(e)};qe.exponent=function(){return Ar(this)};qe.greaterThan=qe.gt=function(e){return this.cmp(e)>0};qe.greaterThanOrEqualTo=qe.gte=function(e){return this.cmp(e)>=0};qe.isInteger=qe.isint=function(){return this.e>this.d.length-2};qe.isNegative=qe.isneg=function(){return this.s<0};qe.isPositive=qe.ispos=function(){return this.s>0};qe.isZero=function(){return this.s===0};qe.lessThan=qe.lt=function(e){return this.cmp(e)<0};qe.lessThanOrEqualTo=qe.lte=function(e){return this.cmp(e)<1};qe.logarithm=qe.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(aa))throw Error(Ia+"NaN");if(r.s<1)throw Error(Ia+(r.s?"NaN":"-Infinity"));return r.eq(aa)?new n(0):(er=!1,t=zi(nf(r,i),nf(e,i),i),er=!0,$t(t,a))};qe.minus=qe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?MA(t,e):DA(t,(e.s=-e.s,e))};qe.modulo=qe.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Ia+"NaN");return r.s?(er=!1,t=zi(r,e,0,1).times(e),er=!0,r.minus(t)):$t(new n(r),a)};qe.naturalExponential=qe.exp=function(){return IA(this)};qe.naturalLogarithm=qe.ln=function(){return nf(this)};qe.negated=qe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};qe.plus=qe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?DA(t,e):MA(t,(e.s=-e.s,e))};qe.precision=qe.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Io+e);if(t=Ar(a)+1,n=a.d.length-1,r=n*Kt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};qe.squareRoot=qe.sqrt=function(){var e,t,r,n,a,i,s,l=this,f=l.constructor;if(l.s<1){if(!l.s)return new f(0);throw Error(Ia+"NaN")}for(e=Ar(l),er=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=hi(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=wc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new f(t)):n=new f(a.toString()),r=f.precision,a=s=r+3;;)if(i=n,n=i.plus(zi(l,i,s+2)).times(.5),hi(i.d).slice(0,s)===(t=hi(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if($t(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return er=!0,$t(n,r)};qe.times=qe.mul=function(e){var t,r,n,a,i,s,l,f,d,h=this,m=h.constructor,x=h.d,v=(e=new m(e)).d;if(!h.s||!e.s)return new m(0);for(e.s*=h.s,r=h.e+e.e,f=x.length,d=v.length,f<d&&(i=x,x=v,v=i,s=f,f=d,d=s),i=[],s=f+d,n=s;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=f+n;a>n;)l=i[a]+v[n]*x[a-n-1]+t,i[a--]=l%Wr|0,t=l/Wr|0;i[a]=(i[a]+t)%Wr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,er?$t(e,m.precision):e};qe.toDecimalPlaces=qe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(yi(e,0,bc),t===void 0?t=n.rounding:yi(t,0,8),$t(r,e+Ar(r)+1,t))};qe.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Ko(n,!0):(yi(e,0,bc),t===void 0?t=a.rounding:yi(t,0,8),n=$t(new a(n),e+1,t),r=Ko(n,!0,e+1)),r};qe.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Ko(a):(yi(e,0,bc),t===void 0?t=i.rounding:yi(t,0,8),n=$t(new i(a),e+Ar(a)+1,t),r=Ko(n.abs(),!1,e+Ar(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};qe.toInteger=qe.toint=function(){var e=this,t=e.constructor;return $t(new t(e),Ar(e)+1,t.rounding)};qe.toNumber=function(){return+this};qe.toPower=qe.pow=function(e){var t,r,n,a,i,s,l=this,f=l.constructor,d=12,h=+(e=new f(e));if(!e.s)return new f(aa);if(l=new f(l),!l.s){if(e.s<1)throw Error(Ia+"Infinity");return l}if(l.eq(aa))return l;if(n=f.precision,e.eq(aa))return $t(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=h<0?-h:h)<=FA){for(a=new f(aa),t=Math.ceil(n/Kt+4),er=!1;r%2&&(a=a.times(l),__(a.d,t)),r=wc(r/2),r!==0;)l=l.times(l),__(l.d,t);return er=!0,e.s<0?new f(aa).div(a):$t(a,n)}}else if(i<0)throw Error(Ia+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,er=!1,a=e.times(nf(l,n+d)),er=!0,a=IA(a),a.s=i,a};qe.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Ar(a),n=Ko(a,r<=i.toExpNeg||r>=i.toExpPos)):(yi(e,1,bc),t===void 0?t=i.rounding:yi(t,0,8),a=$t(new i(a),e,t),r=Ar(a),n=Ko(a,e<=r||r<=i.toExpNeg,e)),n};qe.toSignificantDigits=qe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(yi(e,1,bc),t===void 0?t=n.rounding:yi(t,0,8)),$t(new n(r),e,t)};qe.toString=qe.valueOf=qe.val=qe.toJSON=qe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ar(e),r=e.constructor;return Ko(e,t<=r.toExpNeg||t>=r.toExpPos)};function DA(e,t){var r,n,a,i,s,l,f,d,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),er?$t(t,m):t;if(f=e.d,d=t.d,s=e.e,a=t.e,f=f.slice(),i=s-a,i){for(i<0?(n=f,i=-i,l=d.length):(n=d,a=s,l=f.length),s=Math.ceil(m/Kt),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=f.length,i=d.length,l-i<0&&(i=l,n=d,d=f,f=n),r=0;i;)r=(f[--i]=f[i]+d[i]+r)/Wr|0,f[i]%=Wr;for(r&&(f.unshift(r),++a),l=f.length;f[--l]==0;)f.pop();return t.d=f,t.e=a,er?$t(t,m):t}function yi(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Io+e)}function hi(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Kt-n.length,r&&(i+=Ts(r)),i+=n;s=e[t],n=s+"",r=Kt-n.length,r&&(i+=Ts(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var zi=(function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%Wr|0,s=i/Wr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,f;if(i!=s)f=i>s?1:-1;else for(l=f=0;l<i;l++)if(n[l]!=a[l]){f=n[l]>a[l]?1:-1;break}return f}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*Wr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,f,d,h,m,x,v,y,g,b,N,_,S,C,T,k,P,D,R=n.constructor,G=n.s==a.s?1:-1,M=n.d,H=a.d;if(!n.s)return new R(n);if(!a.s)throw Error(Ia+"Division by zero");for(f=n.e-a.e,P=H.length,T=M.length,v=new R(G),y=v.d=[],d=0;H[d]==(M[d]||0);)++d;if(H[d]>(M[d]||0)&&--f,i==null?_=i=R.precision:s?_=i+(Ar(n)-Ar(a))+1:_=i,_<0)return new R(0);if(_=_/Kt+2|0,d=0,P==1)for(h=0,H=H[0],_++;(d<T||h)&&_--;d++)S=h*Wr+(M[d]||0),y[d]=S/H|0,h=S%H|0;else{for(h=Wr/(H[0]+1)|0,h>1&&(H=e(H,h),M=e(M,h),P=H.length,T=M.length),C=P,g=M.slice(0,P),b=g.length;b<P;)g[b++]=0;D=H.slice(),D.unshift(0),k=H[0],H[1]>=Wr/2&&++k;do h=0,l=t(H,g,P,b),l<0?(N=g[0],P!=b&&(N=N*Wr+(g[1]||0)),h=N/k|0,h>1?(h>=Wr&&(h=Wr-1),m=e(H,h),x=m.length,b=g.length,l=t(m,g,x,b),l==1&&(h--,r(m,P<x?D:H,x))):(h==0&&(l=h=1),m=H.slice()),x=m.length,x<b&&m.unshift(0),r(g,m,b),l==-1&&(b=g.length,l=t(H,g,P,b),l<1&&(h++,r(g,P<b?D:H,b))),b=g.length):l===0&&(h++,g=[0]),y[d++]=h,l&&g[0]?g[b++]=M[C]||0:(g=[M[C]],b=1);while((C++<T||g[0]!==void 0)&&_--)}return y[0]||y.shift(),v.e=f,$t(v,s?i+Ar(v)+1:i)}})();function IA(e,t){var r,n,a,i,s,l,f=0,d=0,h=e.constructor,m=h.precision;if(Ar(e)>16)throw Error(by+Ar(e));if(!e.s)return new h(aa);for(er=!1,l=m,s=new h(.03125);e.abs().gte(.1);)e=e.times(s),d+=5;for(n=Math.log(Eo(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new h(aa),h.precision=l;;){if(a=$t(a.times(e),l),r=r.times(++f),s=i.plus(zi(a,r,l)),hi(s.d).slice(0,l)===hi(i.d).slice(0,l)){for(;d--;)i=$t(i.times(i),l);return h.precision=m,t==null?(er=!0,$t(i,m)):i}i=s}}function Ar(e){for(var t=e.e*Kt,r=e.d[0];r>=10;r/=10)t++;return t}function Ag(e,t,r){if(t>e.LN10.sd())throw er=!0,r&&(e.precision=r),Error(Ia+"LN10 precision limit exceeded");return $t(new e(e.LN10),t)}function Ts(e){for(var t="";e--;)t+="0";return t}function nf(e,t){var r,n,a,i,s,l,f,d,h,m=1,x=10,v=e,y=v.d,g=v.constructor,b=g.precision;if(v.s<1)throw Error(Ia+(v.s?"NaN":"-Infinity"));if(v.eq(aa))return new g(0);if(t==null?(er=!1,d=b):d=t,v.eq(10))return t==null&&(er=!0),Ag(g,d);if(d+=x,g.precision=d,r=hi(y),n=r.charAt(0),i=Ar(v),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)v=v.times(e),r=hi(v.d),n=r.charAt(0),m++;i=Ar(v),n>1?(v=new g("0."+r),i++):v=new g(n+"."+r.slice(1))}else return f=Ag(g,d+2,b).times(i+""),v=nf(new g(n+"."+r.slice(1)),d-x).plus(f),g.precision=b,t==null?(er=!0,$t(v,b)):v;for(l=s=v=zi(v.minus(aa),v.plus(aa),d),h=$t(v.times(v),d),a=3;;){if(s=$t(s.times(h),d),f=l.plus(zi(s,new g(a),d)),hi(f.d).slice(0,d)===hi(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(Ag(g,d+2,b).times(i+""))),l=zi(l,new g(m),d),g.precision=b,t==null?(er=!0,$t(l,b)):l;l=f,a+=2}}function E_(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=wc(r/Kt),e.d=[],n=(r+1)%Kt,r<0&&(n+=Kt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Kt;n<a;)e.d.push(+t.slice(n,n+=Kt));t=t.slice(n),n=Kt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),er&&(e.e>ch||e.e<-ch))throw Error(by+r)}else e.s=0,e.e=0,e.d=[0];return e}function $t(e,t,r){var n,a,i,s,l,f,d,h,m=e.d;for(s=1,i=m[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Kt,a=t,d=m[h=0];else{if(h=Math.ceil((n+1)/Kt),i=m.length,h>=i)return e;for(d=i=m[h],s=1;i>=10;i/=10)s++;n%=Kt,a=n-Kt+s}if(r!==void 0&&(i=Eo(10,s-a-1),l=d/i%10|0,f=t<0||m[h+1]!==void 0||d%i,f=r<4?(l||f)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||f||r==6&&(n>0?a>0?d/Eo(10,s-a):0:m[h-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return f?(i=Ar(e),m.length=1,t=t-i-1,m[0]=Eo(10,(Kt-t%Kt)%Kt),e.e=wc(-t/Kt)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(n==0?(m.length=h,i=1,h--):(m.length=h+1,i=Eo(10,Kt-n),m[h]=a>0?(d/Eo(10,s-a)%Eo(10,a)|0)*i:0),f)for(;;)if(h==0){(m[0]+=i)==Wr&&(m[0]=1,++e.e);break}else{if(m[h]+=i,m[h]!=Wr)break;m[h--]=0,i=1}for(n=m.length;m[--n]===0;)m.pop();if(er&&(e.e>ch||e.e<-ch))throw Error(by+Ar(e));return e}function MA(e,t){var r,n,a,i,s,l,f,d,h,m,x=e.constructor,v=x.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new x(e),er?$t(t,v):t;if(f=e.d,m=t.d,n=t.e,d=e.e,f=f.slice(),s=d-n,s){for(h=s<0,h?(r=f,s=-s,l=m.length):(r=m,n=d,l=f.length),a=Math.max(Math.ceil(v/Kt),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=f.length,l=m.length,h=a<l,h&&(l=a),a=0;a<l;a++)if(f[a]!=m[a]){h=f[a]<m[a];break}s=0}for(h&&(r=f,f=m,m=r,t.s=-t.s),l=f.length,a=m.length-l;a>0;--a)f[l++]=0;for(a=m.length;a>s;){if(f[--a]<m[a]){for(i=a;i&&f[--i]===0;)f[i]=Wr-1;--f[i],f[a]+=Wr}f[a]-=m[a]}for(;f[--l]===0;)f.pop();for(;f[0]===0;f.shift())--n;return f[0]?(t.d=f,t.e=n,er?$t(t,v):t):new x(0)}function Ko(e,t,r){var n,a=Ar(e),i=hi(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Ts(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Ts(-a-1)+i,r&&(n=r-s)>0&&(i+=Ts(n))):a>=s?(i+=Ts(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Ts(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Ts(n))),e.s<0?"-"+i:i}function __(e,t){if(e.length>t)return e.length=t,!0}function RA(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Io+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return E_(s,i.toString())}else if(typeof i!="string")throw Error(Io+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,P9.test(i))E_(s,i);else throw Error(Io+i)}if(a.prototype=qe,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=RA,a.config=a.set=O9,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function O9(e){if(!e||typeof e!="object")throw Error(Ia+"Object expected");var t,r,n,a=["precision",1,bc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(wc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Io+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Io+r+": "+n);return this}var wy=RA(T9);aa=new wy(1);const Dt=wy;var F9=e=>e,LA={},BA=e=>e===LA,k_=e=>function t(){return arguments.length===0||arguments.length===1&&BA(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},$A=(e,t)=>e===1?t:k_(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==LA).length;return i>=e?t(...n):$A(e-i,k_(function(){for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];var d=n.map(h=>BA(h)?l.shift():h);return t(...d,...l)}))}),lm=e=>$A(e.length,e),Uv=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},D9=lm((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),I9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return F9;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((l,f)=>f(l),i(...arguments))}},zv=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),UA=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,l)=>{var f;return s===((f=t)===null||f===void 0?void 0:f[l])})||(t=a,r=e(...a)),r}};function zA(e){var t;return e===0?t=1:t=Math.floor(new Dt(e).abs().log(10).toNumber())+1,t}function WA(e,t,r){for(var n=new Dt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}lm((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});lm((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});lm((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var HA=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},VA=(e,t,r)=>{if(e.lte(0))return new Dt(0);var n=zA(e.toNumber()),a=new Dt(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new Dt(Math.ceil(i.div(s).toNumber())).add(r).mul(s),f=l.mul(a);return t?new Dt(f.toNumber()):new Dt(Math.ceil(f.toNumber()))},M9=(e,t,r)=>{var n=new Dt(1),a=new Dt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new Dt(10).pow(zA(e)-1),a=new Dt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Dt(Math.floor(e)))}else e===0?a=new Dt(Math.floor((t-1)/2)):r||(a=new Dt(Math.floor(e)));var s=Math.floor((t-1)/2),l=I9(D9(f=>a.add(new Dt(f-s).mul(n)).toNumber()),Uv);return l(0,t)},KA=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Dt(0),tickMin:new Dt(0),tickMax:new Dt(0)};var s=VA(new Dt(r).sub(t).div(n-1),a,i),l;t<=0&&r>=0?l=new Dt(0):(l=new Dt(t).add(r).div(2),l=l.sub(new Dt(l).mod(s)));var f=Math.ceil(l.sub(t).div(s).toNumber()),d=Math.ceil(new Dt(r).sub(l).div(s).toNumber()),h=f+d+1;return h>n?KA(t,r,n,a,i+1):(h<n&&(d=r>0?d+(n-h):d,f=r>0?f:f+(n-h)),{step:s,tickMin:l.sub(new Dt(f).mul(s)),tickMax:l.add(new Dt(d).mul(s))})};function R9(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,l]=HA([t,r]);if(s===-1/0||l===1/0){var f=l===1/0?[s,...Uv(0,n-1).map(()=>1/0)]:[...Uv(0,n-1).map(()=>-1/0),l];return t>r?zv(f):f}if(s===l)return M9(s,n,a);var{step:d,tickMin:h,tickMax:m}=KA(s,l,i,a,0),x=WA(h,m.add(new Dt(.1).mul(d)),d);return t>r?zv(x):x}function L9(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=HA([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var l=Math.max(t,2),f=VA(new Dt(s).sub(i).div(l-1),a,0),d=[...WA(new Dt(i),new Dt(s),f),s];return a===!1&&(d=d.map(h=>Math.round(h))),r>n?zv(d):d}var B9=UA(R9),$9=UA(L9),GA=e=>e.rootProps.maxBarSize,U9=e=>e.rootProps.barGap,qA=e=>e.rootProps.barCategoryGap,z9=e=>e.rootProps.barSize,Pf=e=>e.rootProps.stackOffset,Sy=e=>e.options.chartName,Ny=e=>e.rootProps.syncId,XA=e=>e.rootProps.syncMethod,Ey=e=>e.options.eventEmitter,Di={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ta={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},cm=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},W9={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Di.angleAxisId,includeHidden:!1,name:void 0,reversed:Di.reversed,scale:Di.scale,tick:Di.tick,tickCount:void 0,ticks:void 0,type:Di.type,unit:void 0},H9={allowDataOverflow:ta.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ta.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ta.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ta.scale,tick:ta.tick,tickCount:ta.tickCount,ticks:void 0,type:ta.type,unit:void 0},V9={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Di.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Di.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Di.scale,tick:Di.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},K9={allowDataOverflow:ta.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ta.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ta.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ta.scale,tick:ta.tick,tickCount:ta.tickCount,ticks:void 0,type:"category",unit:void 0},_y=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?V9:W9,ky=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?K9:H9,um=e=>e.polarOptions,jy=Ne([ts,rs,Ir],PC),YA=Ne([um,jy],(e,t)=>{if(e!=null)return bn(e.innerRadius,t,0)}),JA=Ne([um,jy],(e,t)=>{if(e!=null)return bn(e.outerRadius,t,t*.8)}),G9=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},QA=Ne([um],G9);Ne([_y,QA],cm);var ZA=Ne([jy,YA,JA],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Ne([ky,ZA],cm);var eT=Ne([kt,um,YA,JA,ts,rs],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:l,startAngle:f,endAngle:d}=t;return{cx:bn(s,a,a/2),cy:bn(l,i,i/2),innerRadius:r,outerRadius:n,startAngle:f,endAngle:d,clockWise:!1}}}),tr=(e,t)=>t,Of=(e,t,r)=>r;function Cy(e){return e?.id}var Rr=e=>{var t=kt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Sc=e=>e.tooltip.settings.axisId,Jr=e=>{var t=Rr(e),r=Sc(e);return Ff(e,t,r)},tT=Ne([Jr],e=>e?.dataKey);function rT(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(l=>{var f,d=(f=l.data)!==null&&f!==void 0?f:n;if(!(d==null||d.length===0)){var h=Cy(l);d.forEach((m,x)=>{var v=i==null||a?x:String(Zt(m,i,null)),y=Zt(m,l.dataKey,0),g;s.has(v)?g=s.get(v):g={},Object.assign(g,{[h]:y}),s.set(v,g)})}}),Array.from(s.values())}function fm(e){return e.stackId!=null&&e.dataKey!=null}function j_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j_(Object(r),!0).forEach(function(n){q9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q9(e,t,r){return(t=X9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X9(e){var t=Y9(e,"string");return typeof t=="symbol"?t:t+""}function Y9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wv=[0,"auto"],Zn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},nT=(e,t)=>e.cartesianAxis.xAxis[t],Qs=(e,t)=>{var r=nT(e,t);return r??Zn},ea={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Wv,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:kf},aT=(e,t)=>e.cartesianAxis.yAxis[t],Zs=(e,t)=>{var r=aT(e,t);return r??ea},J9={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Ay=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??J9},br=(e,t,r)=>{switch(t){case"xAxis":return Qs(e,r);case"yAxis":return Zs(e,r);case"zAxis":return Ay(e,r);case"angleAxis":return _y(e,r);case"radiusAxis":return ky(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Q9=(e,t,r)=>{switch(t){case"xAxis":return Qs(e,r);case"yAxis":return Zs(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Ff=(e,t,r)=>{switch(t){case"xAxis":return Qs(e,r);case"yAxis":return Zs(e,r);case"angleAxis":return _y(e,r);case"radiusAxis":return ky(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},iT=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Ty(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Py=e=>e.graphicalItems.cartesianItems,Z9=Ne([tr,Of],Ty),Oy=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),Df=Ne([Py,br,Z9],Oy),sT=Ne([Df],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(fm)),oT=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),lT=Ne([Df],oT),Fy=e=>e.map(t=>t.data).filter(Boolean).flat(1),eB=Ne([Df],Fy),Dy=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Iy=Ne([eB,yy],Dy),My=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:Zt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Zt(a,n)}))):e.map(n=>({value:n})),dm=Ne([Iy,br,Df],My);function cT(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function il(e){return e.filter(t=>vi(t)||t instanceof Date).map(Number).filter(t=>ca(t)===!1)}function tB(e,t,r){return!r||typeof t!="number"||ca(t)?[]:r.length?il(r.flatMap(n=>{var a=Zt(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!fa(i)||!fa(s)))return[t-i,t+s]})):[]}var rB=Ne([sT,yy,Jr],rT),uT=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,l]=i,f=l.map(Cy);return[s,{stackedData:s8(e,f,r),graphicalItems:l}]}))},Hv=Ne([rB,sT,Pf],uT),fT=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var i=f8(e,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},nB=Ne([Hv,Js,tr],fT),dT=(e,t,r,n,a)=>r.length>0?e.flatMap(i=>r.flatMap(s=>{var l,f,d=(l=n[s.id])===null||l===void 0?void 0:l.filter(m=>cT(a,m)),h=Zt(i,(f=t.dataKey)!==null&&f!==void 0?f:s.dataKey);return{value:h,errorDomain:tB(i,h,d)}})).filter(Boolean):t?.dataKey!=null?e.map(i=>({value:Zt(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),hm=e=>e.errorBars,hT=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>cT(r,n));Ne([lT,hm,tr],hT);var aB=Ne([Iy,br,lT,hm,tr],dT);function iB(e){var{value:t}=e;if(vi(t)||t instanceof Date)return t}var C_=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=il(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},sB=(e,t,r)=>{var n=e.map(iB).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&_4(n))?QC(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},Ry=e=>{var t;if(e==null||!("domain"in e))return Wv;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=il(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:Wv},fh=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),l=Math.max(...i);return[s,l]}},mT=e=>e.referenceElements.dots,Nc=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),oB=Ne([mT,tr,Of],Nc),pT=e=>e.referenceElements.areas,lB=Ne([pT,tr,Of],Nc),xT=e=>e.referenceElements.lines,cB=Ne([xT,tr,Of],Nc),gT=(e,t)=>{var r=il(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},uB=Ne(oB,tr,gT),vT=(e,t)=>{var r=il(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},fB=Ne([lB,tr],vT),yT=(e,t)=>{var r=il(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},dB=Ne(cB,tr,yT),hB=Ne(uB,dB,fB,(e,t,r)=>fh(e,r,t)),bT=Ne([br],Ry),Ly=(e,t,r,n,a,i,s)=>{var l=C9(t,e.allowDataOverflow);if(l!=null)return l;var f=i==="vertical"&&s==="xAxis"||i==="horizontal"&&s==="yAxis",d=f?fh(r,a,C_(n)):fh(a,C_(n));return A9(t,d,e.allowDataOverflow)},mB=Ne([br,bT,nB,aB,hB,kt,tr],Ly),pB=[0,1],By=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:l,type:f}=e,d=rl(t,i);return d&&l==null?QC(0,r.length):f==="category"?sB(n,e,d):a==="expand"?pB:s}},$y=Ne([br,kt,Iy,dm,Pf,tr,mB],By),wT=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(Sf(i));return l in Tu?l:"point"}}},Ec=Ne([br,kt,iT,Sy,tr],wT);function xB(e){if(e!=null){if(e in Tu)return Tu[e]();var t="scale".concat(Sf(e));if(t in Tu)return Tu[t]()}}function Uy(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=xB(t);if(a!=null){var i=a.domain(r).range(n);return t8(i),i}}}var zy=(e,t,r)=>{var n=Ry(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&cc(e))return B9(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&cc(e))return $9(e,t.tickCount,t.allowDecimals)}},Wy=Ne([$y,Ff,Ec],zy),Hy=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&cc(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],l=r[r.length-1];return[Math.min(a,i),Math.max(s,l)]}return t},gB=Ne([br,$y,Wy,tr],Hy),vB=Ne(dm,br,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(il(e.map(l=>l.value))).sort((l,f)=>l-f);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),ST=Ne(vB,kt,qA,Ir,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!fa(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=bn(r,e*i),l=e*i/2;return l-s-(l-s)/i*s}return 0}),yB=(e,t)=>{var r=Qs(e,t);return r==null||typeof r.padding!="string"?0:ST(e,"xAxis",t,r.padding)},bB=(e,t)=>{var r=Zs(e,t);return r==null||typeof r.padding!="string"?0:ST(e,"yAxis",t,r.padding)},wB=Ne(Qs,yB,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),SB=Ne(Zs,bB,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),NB=Ne([Ir,wB,Qh,Jh,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),EB=Ne([Ir,kt,SB,Qh,Jh,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),If=(e,t,r,n)=>{var a;switch(t){case"xAxis":return NB(e,r,n);case"yAxis":return EB(e,r,n);case"zAxis":return(a=Ay(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return QA(e);case"radiusAxis":return ZA(e,r);default:return}},NT=Ne([br,If],cm),_c=Ne([br,Ec,gB,NT],Uy);Ne([Df,hm,tr],hT);function ET(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var mm=(e,t)=>t,pm=(e,t,r)=>r,_B=Ne(Xh,mm,pm,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(ET)),kB=Ne(Yh,mm,pm,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(ET)),_T=(e,t)=>({width:e.width,height:t.height}),jB=(e,t)=>{var r=typeof t.width=="number"?t.width:kf;return{width:r,height:e.height}},kT=Ne(Ir,Qs,_T),CB=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},AB=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},TB=Ne(rs,Ir,_B,mm,pm,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var f=_T(t,l);s==null&&(s=CB(t,n,e));var d=n==="top"&&!a||n==="bottom"&&a;i[l.id]=s-Number(d)*f.height,s+=(d?-1:1)*f.height}),i}),PB=Ne(ts,Ir,kB,mm,pm,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var f=jB(t,l);s==null&&(s=AB(t,n,e));var d=n==="left"&&!a||n==="right"&&a;i[l.id]=s-Number(d)*f.width,s+=(d?-1:1)*f.width}),i}),OB=(e,t)=>{var r=Ir(e),n=Qs(e,t);if(n!=null){var a=TB(e,n.orientation,n.mirror),i=a[t];return i==null?{x:r.left,y:0}:{x:r.left,y:i}}},FB=(e,t)=>{var r=Ir(e),n=Zs(e,t);if(n!=null){var a=PB(e,n.orientation,n.mirror),i=a[t];return i==null?{x:0,y:r.top}:{x:i,y:r.top}}},jT=Ne(Ir,Zs,(e,t)=>{var r=typeof t.width=="number"?t.width:kf;return{width:r,height:e.height}}),A_=(e,t,r)=>{switch(t){case"xAxis":return kT(e,r).width;case"yAxis":return jT(e,r).height;default:return}},CT=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,l=rl(e,n),f=t.map(d=>d.value);if(s&&l&&i==="category"&&a&&_4(f))return f}},Vy=Ne([kt,dm,br,tr],CT),AT=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=rl(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(l=>l.value)}},Ky=Ne([kt,dm,Ff,tr],AT),T_=Ne([kt,Q9,Ec,_c,Vy,Ky,If,Wy,tr],(e,t,r,n,a,i,s,l,f)=>{if(t==null)return null;var d=rl(e,f);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:f,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:l,range:s,realScaleType:r,scale:n}}),DB=(e,t,r,n,a,i,s,l,f)=>{if(!(t==null||n==null)){var d=rl(e,f),{type:h,ticks:m,tickCount:x}=t,v=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,y=h==="category"&&n.bandwidth?n.bandwidth()/v:0;y=f==="angleAxis"&&i!=null&&i.length>=2?Kr(i[0]-i[1])*2*y:y;var g=m||a;if(g){var b=g.map((N,_)=>{var S=s?s.indexOf(N):N;return{index:_,coordinate:n(S)+y,value:N,offset:y}});return b.filter(N=>!ca(N.coordinate))}return d&&l?l.map((N,_)=>({coordinate:n(N)+y,value:N,index:_,offset:y})):n.ticks?n.ticks(x).map(N=>({coordinate:n(N)+y,value:N,offset:y})):n.domain().map((N,_)=>({coordinate:n(N)+y,value:s?s[N]:N,index:_,offset:y}))}},TT=Ne([kt,Ff,Ec,_c,Wy,If,Vy,Ky,tr],DB),IB=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=rl(e,s),{tickCount:f}=t,d=0;return d=s==="angleAxis"&&n?.length>=2?Kr(n[0]-n[1])*2*d:d,l&&i?i.map((h,m)=>({coordinate:r(h)+d,value:h,index:m,offset:d})):r.ticks?r.ticks(f).map(h=>({coordinate:r(h)+d,value:h,offset:d})):r.domain().map((h,m)=>({coordinate:r(h)+d,value:a?a[h]:h,index:m,offset:d}))}},uc=Ne([kt,Ff,_c,If,Vy,Ky,tr],IB),fc=Ne(br,_c,(e,t)=>{if(!(e==null||t==null))return uh(uh({},e),{},{scale:t})}),MB=Ne([br,Ec,$y,NT],Uy);Ne((e,t,r)=>Ay(e,r),MB,(e,t)=>{if(!(e==null||t==null))return uh(uh({},e),{},{scale:t})});var RB=Ne([kt,Xh,Yh],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),PT=e=>e.options.defaultTooltipEventType,OT=e=>e.options.validateTooltipEventTypes;function FT(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Gy(e,t){var r=PT(e),n=OT(e);return FT(t,r,n)}function LB(e){return Qe(t=>Gy(t,e))}var DT=(e,t)=>{var r,n=Number(t);if(!(ca(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},BB=e=>e.tooltip.settings,Os={active:!1,index:null,dataKey:void 0,coordinate:void 0},$B={itemInteraction:{click:Os,hover:Os},axisInteraction:{click:Os,hover:Os},keyboardInteraction:Os,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},IT=ha({name:"tooltip",initialState:$B,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Ui(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:UB,removeTooltipEntrySettings:zB,setTooltipSettingsState:WB,setActiveMouseOverItemIndex:MT,mouseLeaveItem:HB,mouseLeaveChart:RT,setActiveClickItemIndex:VB,setMouseOverAxisIndex:LT,setMouseClickAxisIndex:KB,setSyncInteraction:Vv,setKeyboardInteraction:Kv}=IT.actions,GB=IT.reducer;function P_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function m0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P_(Object(r),!0).forEach(function(n){qB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qB(e,t,r){return(t=XB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XB(e){var t=YB(e,"string");return typeof t=="symbol"?t:t+""}function YB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JB(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function QB(e){return e.index!=null}var BT=(e,t,r,n)=>{if(t==null)return Os;var a=JB(e,t,r);if(a==null)return Os;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(QB(a)){if(i)return m0(m0({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return m0(m0({},Os),{},{coordinate:a.coordinate})},qy=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!fa(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},$T=(e,t,r,n,a,i,s,l)=>{if(!(i==null||l==null)){var f=s[0],d=f==null?void 0:l(f.positions,i);if(d!=null)return d;var h=a?.[Number(i)];if(h)switch(r){case"horizontal":return{x:h.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:h.coordinate}}}},UT=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},Mf=e=>e.options.tooltipPayloadSearcher,kc=e=>e.tooltip;function O_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function F_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O_(Object(r),!0).forEach(function(n){ZB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZB(e,t,r){return(t=e$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e$(e){var t=t$(e,"string");return typeof t=="symbol"?t:t+""}function t$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r$(e,t){return e??t}var zT=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:l,computedData:f,dataStartIndex:d,dataEndIndex:h}=r,m=[];return e.reduce((x,v)=>{var y,{dataDefinedOnItem:g,settings:b}=v,N=r$(g,l),_=Array.isArray(N)?OC(N,d,h):N,S=(y=b?.dataKey)!==null&&y!==void 0?y:n,C=b?.nameKey,T;if(n&&Array.isArray(_)&&!Array.isArray(_[0])&&s==="axis"?T=H5(_,n,a):T=i(_,t,f,C),Array.isArray(T))T.forEach(P=>{var D=F_(F_({},b),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});x.push(pE({tooltipEntrySettings:D,dataKey:P.dataKey,payload:P.payload,value:Zt(P.payload,P.dataKey),name:P.name}))});else{var k;x.push(pE({tooltipEntrySettings:b,dataKey:S,payload:T,value:Zt(T,S),name:(k=Zt(T,C))!==null&&k!==void 0?k:b?.name}))}return x},m)}},Xy=Ne([Jr,kt,iT,Sy,Rr],wT),n$=Ne([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),a$=Ne([Rr,Sc],Ty),Rf=Ne([n$,Jr,a$],Oy),i$=Ne([Rf],e=>e.filter(fm)),s$=Ne([Rf],Fy),jc=Ne([s$,Js],Dy),o$=Ne([i$,Js,Jr],rT),Yy=Ne([jc,Jr,Rf],My),l$=Ne([Jr],Ry),c$=Ne([Rf],e=>e.filter(fm)),u$=Ne([o$,c$,Pf],uT),f$=Ne([u$,Js,Rr],fT),d$=Ne([Rf],oT),h$=Ne([jc,Jr,d$,hm,Rr],dT),m$=Ne([mT,Rr,Sc],Nc),p$=Ne([m$,Rr],gT),x$=Ne([pT,Rr,Sc],Nc),g$=Ne([x$,Rr],vT),v$=Ne([xT,Rr,Sc],Nc),y$=Ne([v$,Rr],yT),b$=Ne([p$,y$,g$],fh),w$=Ne([Jr,l$,f$,h$,b$,kt,Rr],Ly),WT=Ne([Jr,kt,jc,Yy,Pf,Rr,w$],By),S$=Ne([WT,Jr,Xy],zy),N$=Ne([Jr,WT,S$,Rr],Hy),HT=e=>{var t=Rr(e),r=Sc(e),n=!1;return If(e,t,r,n)},VT=Ne([Jr,HT],cm),KT=Ne([Jr,Xy,N$,VT],Uy),E$=Ne([kt,Yy,Jr,Rr],CT),_$=Ne([kt,Yy,Jr,Rr],AT),k$=(e,t,r,n,a,i,s,l)=>{if(t){var{type:f}=t,d=rl(e,l);if(n){var h=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,m=f==="category"&&n.bandwidth?n.bandwidth()/h:0;return m=l==="angleAxis"&&a!=null&&a?.length>=2?Kr(a[0]-a[1])*2*m:m,d&&s?s.map((x,v)=>({coordinate:n(x)+m,value:x,index:v,offset:m})):n.domain().map((x,v)=>({coordinate:n(x)+m,value:i?i[x]:x,index:v,offset:m}))}}},as=Ne([kt,Jr,Xy,KT,HT,E$,_$,Rr],k$),Jy=Ne([PT,OT,BB],(e,t,r)=>FT(r.shared,e,t)),GT=e=>e.tooltip.settings.trigger,Qy=e=>e.tooltip.settings.defaultIndex,xm=Ne([kc,Jy,GT,Qy],BT),Go=Ne([xm,jc],qy),qT=Ne([as,Go],DT),XT=Ne([xm],e=>{if(e)return e.dataKey}),YT=Ne([kc,Jy,GT,Qy],UT),j$=Ne([ts,rs,kt,Ir,as,Qy,YT,Mf],$T),C$=Ne([xm,j$],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),A$=Ne([xm],e=>e.active),T$=Ne([YT,Go,Js,tT,qT,Mf,Jy],zT);Ne([T$],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function D_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function I_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D_(Object(r),!0).forEach(function(n){P$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P$(e,t,r){return(t=O$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O$(e){var t=F$(e,"string");return typeof t=="symbol"?t:t+""}function F$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D$=()=>Qe(Jr),I$=()=>{var e=D$(),t=Qe(as),r=Qe(KT);return z1(I_(I_({},e),{},{scale:r}),t)},M$=()=>Qe(Sy),Zy=(e,t)=>t,JT=(e,t,r)=>r,eb=(e,t,r,n)=>n,R$=Ne(as,e=>zh(e,t=>t.coordinate)),tb=Ne([kc,Zy,JT,eb],BT),QT=Ne([tb,jc],qy),L$=(e,t,r)=>{if(t!=null){var n=kc(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},ZT=Ne([kc,Zy,JT,eb],UT),dh=Ne([ts,rs,kt,Ir,as,eb,ZT,Mf],$T),B$=Ne([tb,dh],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),e3=Ne(as,QT,DT),$$=Ne([ZT,QT,Js,tT,e3,Mf,Zy],zT),U$=Ne([tb],e=>({isActive:e.active,activeIndex:e.index})),z$=(e,t,r,n,a,i,s,l)=>{if(!(!e||!t||!n||!a||!i)){var f=d8(e.chartX,e.chartY,t,r,l);if(f){var d=m8(f,t),h=ZM(d,s,i,n,a),m=h8(t,i,h,f);return{activeIndex:String(h),activeCoordinate:m}}}};function Gv(){return Gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gv.apply(null,arguments)}function M_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M_(Object(r),!0).forEach(function(n){W$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W$(e,t,r){return(t=H$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H$(e){var t=V$(e,"string");return typeof t=="symbol"?t:t+""}function V$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K$(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:l,tooltipEventType:f,chartName:d}=e,h=t,m=r,x=n;if(!l||!h||d!=="ScatterChart"&&f!=="axis")return null;var v,y;if(d==="ScatterChart")v=h,y=mR;else if(d==="BarChart")v=pR(s,h,a,i),y=qC;else if(s==="radial"){var{cx:g,cy:b,radius:N,startAngle:_,endAngle:S}=XC(h);v={cx:g,cy:b,startAngle:_,endAngle:S,innerRadius:N,outerRadius:N},y=JC}else v={points:qR(s,h,a)},y=WC;var C=typeof l=="object"&&"className"in l?l.className:void 0,T=p0(p0(p0(p0({stroke:"#ccc",pointerEvents:"none"},a),v),jr(l,!1)),{},{payload:m,payloadIndex:x,className:It("recharts-tooltip-cursor",C)});return j.isValidElement(l)?j.cloneElement(l,T):j.createElement(y,T)}function G$(e){var t=I$(),r=LC(),n=G1(),a=M$();return j.createElement(K$,Gv({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var t3=j.createContext(null),q$=()=>j.useContext(t3),Tg={exports:{}},R_;function X$(){return R_||(R_=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(f,d,h){this.fn=f,this.context=d,this.once=h||!1}function i(f,d,h,m,x){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,m||f,x),y=r?r+d:d;return f._events[y]?f._events[y].fn?f._events[y]=[f._events[y],v]:f._events[y].push(v):(f._events[y]=v,f._eventsCount++),f}function s(f,d){--f._eventsCount===0?f._events=new n:delete f._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],h,m;if(this._eventsCount===0)return d;for(m in h=this._events)t.call(h,m)&&d.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},l.prototype.listeners=function(d){var h=r?r+d:d,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var x=0,v=m.length,y=new Array(v);x<v;x++)y[x]=m[x].fn;return y},l.prototype.listenerCount=function(d){var h=r?r+d:d,m=this._events[h];return m?m.fn?1:m.length:0},l.prototype.emit=function(d,h,m,x,v,y){var g=r?r+d:d;if(!this._events[g])return!1;var b=this._events[g],N=arguments.length,_,S;if(b.fn){switch(b.once&&this.removeListener(d,b.fn,void 0,!0),N){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,h),!0;case 3:return b.fn.call(b.context,h,m),!0;case 4:return b.fn.call(b.context,h,m,x),!0;case 5:return b.fn.call(b.context,h,m,x,v),!0;case 6:return b.fn.call(b.context,h,m,x,v,y),!0}for(S=1,_=new Array(N-1);S<N;S++)_[S-1]=arguments[S];b.fn.apply(b.context,_)}else{var C=b.length,T;for(S=0;S<C;S++)switch(b[S].once&&this.removeListener(d,b[S].fn,void 0,!0),N){case 1:b[S].fn.call(b[S].context);break;case 2:b[S].fn.call(b[S].context,h);break;case 3:b[S].fn.call(b[S].context,h,m);break;case 4:b[S].fn.call(b[S].context,h,m,x);break;default:if(!_)for(T=1,_=new Array(N-1);T<N;T++)_[T-1]=arguments[T];b[S].fn.apply(b[S].context,_)}}return!0},l.prototype.on=function(d,h,m){return i(this,d,h,m,!1)},l.prototype.once=function(d,h,m){return i(this,d,h,m,!0)},l.prototype.removeListener=function(d,h,m,x){var v=r?r+d:d;if(!this._events[v])return this;if(!h)return s(this,v),this;var y=this._events[v];if(y.fn)y.fn===h&&(!x||y.once)&&(!m||y.context===m)&&s(this,v);else{for(var g=0,b=[],N=y.length;g<N;g++)(y[g].fn!==h||x&&!y[g].once||m&&y[g].context!==m)&&b.push(y[g]);b.length?this._events[v]=b.length===1?b[0]:b:s(this,v)}return this},l.prototype.removeAllListeners=function(d){var h;return d?(h=r?r+d:d,this._events[h]&&s(this,h)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(Tg)),Tg.exports}var Y$=X$();const J$=es(Y$);var af=new J$,qv="recharts.syncEvent.tooltip",L_="recharts.syncEvent.brush";function r3(e,t){if(t){var r=Number.parseInt(t,10);if(!ca(r))return e?.[r]}}var Q$={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},n3=ha({name:"options",initialState:Q$,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Z$=n3.reducer,{createEventEmitter:eU}=n3.actions;function tU(e){return e.tooltip.syncInteraction}var rU={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},a3=ha({name:"chartData",initialState:rU,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:B_,setDataStartEndIndexes:nU,setComputedData:Ioe}=a3.actions,aU=a3.reducer,iU=["x","y"];function $_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$_(Object(r),!0).forEach(function(n){sU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sU(e,t,r){return(t=oU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oU(e){var t=lU(e,"string");return typeof t=="symbol"?t:t+""}function lU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cU(e,t){if(e==null)return{};var r,n,a=uU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var i3=()=>{};function fU(){var e=Qe(Ny),t=Qe(Ey),r=lr(),n=Qe(XA),a=Qe(as),i=G1(),s=H1(),l=Qe(f=>f.rootProps.className);j.useEffect(()=>{if(e==null)return i3;var f=(d,h,m)=>{if(t!==m&&e===d){if(n==="index"){var x;if(s&&h!==null&&h!==void 0&&(x=h.payload)!==null&&x!==void 0&&x.coordinate){var v=h.payload.coordinate,{x:y,y:g}=v,b=cU(v,iU),N=wo(wo(wo({},b),typeof y=="number"&&{x:Math.max(s.x,Math.min(y,s.x+s.width))}),typeof g=="number"&&{y:Math.max(s.y,Math.min(g,s.y+s.height))}),_=wo(wo({},h),{},{payload:wo(wo({},h.payload),{},{coordinate:N})});r(_)}else r(h);return}if(a!=null){var S;if(typeof n=="function"){var C={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},T=n(a,C);S=a[T]}else n==="value"&&(S=a.find(z=>String(z.value)===h.payload.label));var{coordinate:k}=h.payload;if(S==null||h.payload.active===!1||k==null||s==null){r(Vv({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:P,y:D}=k,R=Math.min(P,s.x+s.width),G=Math.min(D,s.y+s.height),M={x:i==="horizontal"?S.coordinate:R,y:i==="horizontal"?G:S.coordinate},H=Vv({active:h.payload.active,coordinate:M,dataKey:h.payload.dataKey,index:String(S.index),label:h.payload.label});r(H)}}};return af.on(qv,f),()=>{af.off(qv,f)}},[l,r,t,e,n,a,i,s])}function dU(){var e=Qe(Ny),t=Qe(Ey),r=lr();j.useEffect(()=>{if(e==null)return i3;var n=(a,i,s)=>{t!==s&&e===a&&r(nU(i))};return af.on(L_,n),()=>{af.off(L_,n)}},[r,t,e])}function hU(){var e=lr();j.useEffect(()=>{e(eU())},[e]),fU(),dU()}function mU(e,t,r,n,a,i){var s=Qe(x=>L$(x,e,t)),l=Qe(Ey),f=Qe(Ny),d=Qe(XA),h=Qe(tU),m=h?.active;j.useEffect(()=>{if(!m&&f!=null&&l!=null){var x=Vv({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n});af.emit(qv,f,x,l)}},[m,r,s,a,n,l,f,d,i])}function U_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function z_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U_(Object(r),!0).forEach(function(n){pU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pU(e,t,r){return(t=xU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xU(e){var t=gU(e,"string");return typeof t=="symbol"?t:t+""}function gU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vU(e){return e.dataKey}function yU(e,t){return j.isValidElement(e)?j.cloneElement(e,t):typeof e=="function"?j.createElement(e,t):j.createElement(K8,t)}var W_=[],bU={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!vc.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Du(e){var t=La(e,bU),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:l,isAnimationActive:f,offset:d,payloadUniqBy:h,position:m,reverseDirection:x,useTranslate3d:v,wrapperStyle:y,cursor:g,shared:b,trigger:N,defaultIndex:_,portal:S,axisId:C}=t,T=lr(),k=typeof _=="number"?String(_):_;j.useEffect(()=>{T(WB({shared:b,trigger:N,axisId:C,active:r,defaultIndex:k}))},[T,b,N,C,r,k]);var P=H1(),D=zC(),R=LB(b),{activeIndex:G,isActive:M}=Qe(L=>U$(L,R,N,k)),H=Qe(L=>$$(L,R,N,k)),z=Qe(L=>e3(L,R,N,k)),ne=Qe(L=>B$(L,R,N,k)),Q=H,le=q$(),ue=r??M,[fe,K]=sC([Q,ue]),me=R==="axis"?z:void 0;mU(R,N,ne,me,G,ue);var J=S??le;if(J==null)return null;var O=Q??W_;ue||(O=W_),l&&O.length&&(O=tC(Q.filter(L=>L.value!=null&&(L.hide!==!0||t.includeHidden)),h,vU));var ae=O.length>0,ee=j.createElement(Z8,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:f,active:ue,coordinate:ne,hasPayload:ae,offset:d,position:m,reverseDirection:x,useTranslate3d:v,viewBox:P,wrapperStyle:y,lastBoundingBox:fe,innerRef:K,hasPortalFromProps:!!S},yU(s,z_(z_({},t),{},{payload:O,label:me,active:ue,coordinate:ne,accessibilityLayer:D})));return j.createElement(j.Fragment,null,C4.createPortal(ee,J),ue&&j.createElement(G$,{cursor:g,tooltipEventType:R,coordinate:ne,payload:Q,index:G}))}var Pg={},Og={},Fg={},H_;function wU(){return H_||(H_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,l=null;const f=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),h=()=>{l!==null&&(r.apply(s,l),s=void 0,l=null)},m=()=>{d&&h(),g()};let x=null;const v=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,m()},n)},y=()=>{x!==null&&(clearTimeout(x),x=null)},g=()=>{y(),s=void 0,l=null},b=()=>{h()},N=function(..._){if(a?.aborted)return;s=this,l=_;const S=x==null;v(),f&&S&&h()};return N.schedule=v,N.cancel=g,N.flush=b,a?.addEventListener("abort",g,{once:!0}),N}e.debounce=t})(Fg)),Fg}var V_;function SU(){return V_||(V_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wU();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:l=!0,maxWait:f}=i,d=Array(2);s&&(d[0]="leading"),l&&(d[1]="trailing");let h,m=null;const x=t.debounce(function(...g){h=n.apply(this,g),m=null},a,{edges:d}),v=function(...g){return f!=null&&(m===null&&(m=Date.now()),Date.now()-m>=f)?(h=n.apply(this,g),m=Date.now(),x.cancel(),x.schedule(),h):(x.apply(this,g),h)},y=()=>(x.flush(),h);return v.cancel=x.cancel,v.flush=y,v}e.debounce=r})(Og)),Og}var K_;function NU(){return K_||(K_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SU();function r(n,a=0,i={}){const{leading:s=!0,trailing:l=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:l})}e.throttle=r})(Pg)),Pg}var Dg,G_;function EU(){return G_||(G_=1,Dg=NU().throttle),Dg}var _U=EU();const kU=es(_U);var Iu=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function q_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ig(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q_(Object(r),!0).forEach(function(n){jU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jU(e,t,r){return(t=CU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CU(e){var t=AU(e,"string");return typeof t=="symbol"?t:t+""}function AU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mu=j.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:s=0,minHeight:l,maxHeight:f,children:d,debounce:h=0,id:m,className:x,onResize:v,style:y={}}=e,g=j.useRef(null),b=j.useRef();b.current=v,j.useImperativeHandle(t,()=>g.current);var[N,_]=j.useState({containerWidth:n.width,containerHeight:n.height}),S=j.useCallback((T,k)=>{_(P=>{var D=Math.round(T),R=Math.round(k);return P.containerWidth===D&&P.containerHeight===R?P:{containerWidth:D,containerHeight:R}})},[]);j.useEffect(()=>{var T=R=>{var G,{width:M,height:H}=R[0].contentRect;S(M,H),(G=b.current)===null||G===void 0||G.call(b,M,H)};h>0&&(T=kU(T,h,{trailing:!0,leading:!1}));var k=new ResizeObserver(T),{width:P,height:D}=g.current.getBoundingClientRect();return S(P,D),k.observe(g.current),()=>{k.disconnect()}},[S,h]);var C=j.useMemo(()=>{var{containerWidth:T,containerHeight:k}=N;if(T<0||k<0)return null;Iu(jo(a)||jo(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),Iu(!r||r>0,"The aspect(%s) must be greater than zero.",r);var P=jo(a)?T:a,D=jo(i)?k:i;return r&&r>0&&(P?D=P/r:D&&(P=D*r),f&&D>f&&(D=f)),Iu(P>0||D>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,P,D,a,i,s,l,r),j.Children.map(d,R=>j.cloneElement(R,{width:P,height:D,style:Ig({width:P,height:D},R.props.style)}))},[r,d,i,f,l,s,N,a]);return j.createElement("div",{id:m?"".concat(m):void 0,className:It("recharts-responsive-container",x),style:Ig(Ig({},y),{},{width:a,height:i,minWidth:s,minHeight:l,maxHeight:f}),ref:g},j.createElement("div",{style:{width:0,height:0,overflow:"visible"}},C))}),Bi=e=>null;Bi.displayName="Cell";function TU(e,t,r){return(t=PU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PU(e){var t=OU(e,"string");return typeof t=="symbol"?t:t+""}function OU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class FU{constructor(t){TU(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function X_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X_(Object(r),!0).forEach(function(n){IU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IU(e,t,r){return(t=MU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MU(e){var t=RU(e,"string");return typeof t=="symbol"?t:t+""}function RU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LU={cacheSize:2e3,enableCache:!0},s3=DU({},LU),Y_=new FU(s3.cacheSize),BU={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},J_="recharts_measurement_span";function $U(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(l)}var Q_=(e,t)=>{try{var r=document.getElementById(J_);r||(r=document.createElement("span"),r.setAttribute("id",J_),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,BU,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Ru=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||vc.isSsr)return{width:0,height:0};if(!s3.enableCache)return Q_(t,r);var n=$U(t,r),a=Y_.get(n);if(a)return a;var i=Q_(t,r);return Y_.set(n,i),i},Z_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ek=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,UU=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,zU=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,o3={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},WU=Object.keys(o3),Kl="NaN";function HU(e,t){return e*o3[t]}class zn{static parse(t){var r,[,n,a]=(r=zU.exec(t))!==null&&r!==void 0?r:[];return new zn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ca(t)&&(this.unit=""),r!==""&&!UU.test(r)&&(this.num=NaN,this.unit=""),WU.includes(r)&&(this.num=HU(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new zn(NaN,""):new zn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new zn(NaN,""):new zn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new zn(NaN,""):new zn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new zn(NaN,""):new zn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ca(this.num)}}function l3(e){if(e.includes(Kl))return Kl;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=Z_.exec(t))!==null&&r!==void 0?r:[],s=zn.parse(n??""),l=zn.parse(i??""),f=a==="*"?s.multiply(l):s.divide(l);if(f.isNaN())return Kl;t=t.replace(Z_,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,h,m,x]=(d=ek.exec(t))!==null&&d!==void 0?d:[],v=zn.parse(h??""),y=zn.parse(x??""),g=m==="+"?v.add(y):v.subtract(y);if(g.isNaN())return Kl;t=t.replace(ek,g.toString())}return t}var tk=/\(([^()]*)\)/;function VU(e){for(var t=e,r;(r=tk.exec(t))!=null;){var[,n]=r;t=t.replace(tk,l3(n))}return t}function KU(e){var t=e.replace(/\s+/g,"");return t=VU(t),t=l3(t),t}function GU(e){try{return KU(e)}catch{return Kl}}function Mg(e){var t=GU(e.slice(5,-1));return t===Kl?"":t}var qU=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],XU=["dx","dy","angle","className","breakAll"];function Xv(){return Xv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xv.apply(null,arguments)}function rk(e,t){if(e==null)return{};var r,n,a=YU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var c3=/[ \f\n\r\t\v\u2028\u2029]+/,u3=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];qr(t)||(r?a=t.toString().split(""):a=t.toString().split(c3));var i=a.map(l=>({word:l,width:Ru(l,n).width})),s=r?0:Ru(" ",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},JU=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:l,breakAll:f}=e,d=Ze(i),h=s,m=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return M.reduce((H,z)=>{var{word:ne,width:Q}=z,le=H[H.length-1];if(le&&(n==null||a||le.width+Q+r<Number(n)))le.words.push(ne),le.width+=Q+r;else{var ue={words:[ne],width:Q};H.push(ue)}return H},[])},x=m(t),v=G=>G.reduce((M,H)=>M.width>H.width?M:H);if(!d||a)return x;var y=x.length>i||v(x).width>Number(n);if(!y)return x;for(var g="…",b=G=>{var M=h.slice(0,G),H=u3({breakAll:f,style:l,children:M+g}).wordsWithComputedWidth,z=m(H),ne=z.length>i||v(z).width>Number(n);return[ne,z]},N=0,_=h.length-1,S=0,C;N<=_&&S<=h.length-1;){var T=Math.floor((N+_)/2),k=T-1,[P,D]=b(k),[R]=b(T);if(!P&&!R&&(N=T+1),P&&R&&(_=T-1),!P&&R){C=D;break}S++}return C||x},nk=e=>{var t=qr(e)?[]:e.toString().split(c3);return[{words:t}]},QU=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!vc.isSsr){var l,f,d=u3({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:h,spaceWidth:m}=d;l=h,f=m}else return nk(n);return JU({breakAll:i,children:n,maxLines:s,style:a},l,f,t,r)}return nk(n)},ak="#808080",gm=j.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:l="start",verticalAnchor:f="end",fill:d=ak}=e,h=rk(e,qU),m=j.useMemo(()=>QU({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:s,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,s,h.style,h.width]),{dx:x,dy:v,angle:y,className:g,breakAll:b}=h,N=rk(h,XU);if(!vi(r)||!vi(n)||m.length===0)return null;var _=r+(Ze(x)?x:0),S=n+(Ze(v)?v:0),C;switch(f){case"start":C=Mg("calc(".concat(i,")"));break;case"middle":C=Mg("calc(".concat((m.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:C=Mg("calc(".concat(m.length-1," * -").concat(a,")"));break}var T=[];if(s){var k=m[0].width,{width:P}=h;T.push("scale(".concat(Ze(P)?P/k:1,")"))}return y&&T.push("rotate(".concat(y,", ").concat(_,", ").concat(S,")")),T.length&&(N.transform=T.join(" ")),j.createElement("text",Xv({},jr(N,!0),{ref:t,x:_,y:S,className:It("recharts-text",g),textAnchor:l,fill:d.includes("url")?ak:d}),m.map((D,R)=>{var G=D.words.join(b?"":" ");return j.createElement("tspan",{x:_,dy:R===0?C:a,key:"".concat(G,"-").concat(R)},G)}))});gm.displayName="Text";var ZU=["labelRef"];function ez(e,t){if(e==null)return{};var r,n,a=tz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ik(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ik(Object(r),!0).forEach(function(n){rz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ik(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rz(e,t,r){return(t=nz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nz(e){var t=az(e,"string");return typeof t=="symbol"?t:t+""}function az(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ii(){return Ii=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ii.apply(null,arguments)}var f3=j.createContext(null),iz=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,s=j.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return j.createElement(f3.Provider,{value:s},i)},d3=()=>{var e=j.useContext(f3),t=H1();return e||t},sz=j.createContext(null),oz=()=>{var e=j.useContext(sz),t=Qe(eT);return e||t},lz=e=>{var{value:t,formatter:r}=e,n=qr(e.children)?t:e.children;return typeof r=="function"?r(n):n},rb=e=>e!=null&&typeof e=="function",cz=(e,t)=>{var r=Kr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},uz=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:l,cy:f,innerRadius:d,outerRadius:h,startAngle:m,endAngle:x,clockWise:v}=a,y=(d+h)/2,g=cz(m,x),b=g>=0?1:-1,N,_;switch(t){case"insideStart":N=m+b*i,_=v;break;case"insideEnd":N=x-b*i,_=!v;break;case"end":N=x+b*i,_=v;break;default:throw new Error("Unsupported position ".concat(t))}_=g<=0?_:!_;var S=Cr(l,f,y,N),C=Cr(l,f,y,N+(_?1:-1)*359),T="M".concat(S.x,",").concat(S.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(_?0:1,`,
    `).concat(C.x,",").concat(C.y),k=qr(e.id)?Xu("recharts-radial-line-"):e.id;return j.createElement("text",Ii({},n,{dominantBaseline:"central",className:It("recharts-radial-bar-label",s)}),j.createElement("defs",null,j.createElement("path",{id:k,d:T})),j.createElement("textPath",{xlinkHref:"#".concat(k)},r))},fz=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:l,endAngle:f}=e,d=(l+f)/2;if(r==="outside"){var{x:h,y:m}=Cr(n,a,s+t,d);return{x:h,y:m,textAnchor:h>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var x=(i+s)/2,{x:v,y}=Cr(n,a,x,d);return{x:v,y,textAnchor:"middle",verticalAnchor:"middle"}},h3=e=>"cx"in e&&Ze(e.cx),dz=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!h3(r)&&(i=r);var{x:s,y:l,width:f,height:d}=t,h=d>=0?1:-1,m=h*n,x=h>0?"end":"start",v=h>0?"start":"end",y=f>=0?1:-1,g=y*n,b=y>0?"end":"start",N=y>0?"start":"end";if(a==="top"){var _={x:s+f/2,y:l-h*n,textAnchor:"middle",verticalAnchor:x};return vr(vr({},_),i?{height:Math.max(l-i.y,0),width:f}:{})}if(a==="bottom"){var S={x:s+f/2,y:l+d+m,textAnchor:"middle",verticalAnchor:v};return vr(vr({},S),i?{height:Math.max(i.y+i.height-(l+d),0),width:f}:{})}if(a==="left"){var C={x:s-g,y:l+d/2,textAnchor:b,verticalAnchor:"middle"};return vr(vr({},C),i?{width:Math.max(C.x-i.x,0),height:d}:{})}if(a==="right"){var T={x:s+f+g,y:l+d/2,textAnchor:N,verticalAnchor:"middle"};return vr(vr({},T),i?{width:Math.max(i.x+i.width-T.x,0),height:d}:{})}var k=i?{width:f,height:d}:{};return a==="insideLeft"?vr({x:s+g,y:l+d/2,textAnchor:N,verticalAnchor:"middle"},k):a==="insideRight"?vr({x:s+f-g,y:l+d/2,textAnchor:b,verticalAnchor:"middle"},k):a==="insideTop"?vr({x:s+f/2,y:l+m,textAnchor:"middle",verticalAnchor:v},k):a==="insideBottom"?vr({x:s+f/2,y:l+d-m,textAnchor:"middle",verticalAnchor:x},k):a==="insideTopLeft"?vr({x:s+g,y:l+m,textAnchor:N,verticalAnchor:v},k):a==="insideTopRight"?vr({x:s+f-g,y:l+m,textAnchor:b,verticalAnchor:v},k):a==="insideBottomLeft"?vr({x:s+g,y:l+d-m,textAnchor:N,verticalAnchor:x},k):a==="insideBottomRight"?vr({x:s+f-g,y:l+d-m,textAnchor:b,verticalAnchor:x},k):a&&typeof a=="object"&&(Ze(a.x)||jo(a.x))&&(Ze(a.y)||jo(a.y))?vr({x:s+bn(a.x,f),y:l+bn(a.y,d),textAnchor:"end",verticalAnchor:"end"},k):vr({x:s+f/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},k)},hz={offset:5};function Ps(e){var t=La(e,hz),{viewBox:r,position:n,value:a,children:i,content:s,className:l="",textBreakAll:f,labelRef:d}=t,h=oz(),m=d3(),x=n==="center"?m:h??m,v=r||x;if(!v||qr(a)&&qr(i)&&!j.isValidElement(s)&&typeof s!="function")return null;var y=vr(vr({},t),{},{viewBox:v});if(j.isValidElement(s)){var{labelRef:g}=y,b=ez(y,ZU);return j.cloneElement(s,b)}var N;if(typeof s=="function"){if(N=j.createElement(s,y),j.isValidElement(N))return N}else N=lz(t);var _=h3(v),S=jr(t,!0);if(_&&(n==="insideStart"||n==="insideEnd"||n==="end"))return uz(t,n,N,S,v);var C=_?fz(v,t.offset,t.position):dz(t,v);return j.createElement(gm,Ii({ref:d,className:It("recharts-label",l)},S,C,{breakAll:f}),N)}Ps.displayName="Label";var mz=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?j.createElement(Ps,Ii({key:"label-implicit"},n)):vi(e)?j.createElement(Ps,Ii({key:"label-implicit",value:e},n)):j.isValidElement(e)?e.type===Ps?j.cloneElement(e,vr({key:"label-implicit"},n)):j.createElement(Ps,Ii({key:"label-implicit",content:e},n)):rb(e)?j.createElement(Ps,Ii({key:"label-implicit",content:e},n)):e&&typeof e=="object"?j.createElement(Ps,Ii({},e,{key:"label-implicit"},n)):null};function pz(e){var{label:t}=e,r=d3();return mz(t,r)||null}var Rg={},Lg={},sk;function xz(){return sk||(sk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Lg)),Lg}var Bg={},ok;function gz(){return ok||(ok=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Bg)),Bg}var lk;function vz(){return lk||(lk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xz(),r=gz(),n=D1();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(Rg)),Rg}var $g,ck;function yz(){return ck||(ck=1,$g=vz().last),$g}var bz=yz();const wz=es(bz);var Sz=["valueAccessor"],Nz=["dataKey","clockWise","id","textBreakAll"];function hh(){return hh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hh.apply(null,arguments)}function uk(e,t){if(e==null)return{};var r,n,a=Ez(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ez(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _z=e=>Array.isArray(e.value)?wz(e.value):e.value,m3=j.createContext(void 0),kz=m3.Provider,p3=j.createContext(void 0),jz=p3.Provider;function Cz(){return j.useContext(m3)}function Az(){return j.useContext(p3)}function O0(e){var{valueAccessor:t=_z}=e,r=uk(e,Sz),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,l=uk(r,Nz),f=Cz(),d=Az(),h=f||d;return!h||!h.length?null:j.createElement(Kn,{className:"recharts-label-list"},h.map((m,x)=>{var v,y=qr(n)?t(m,x):Zt(m&&m.payload,n),g=qr(i)?{}:{id:"".concat(i,"-").concat(x)};return j.createElement(Ps,hh({},jr(m,!0),l,g,{fill:(v=r.fill)!==null&&v!==void 0?v:m.fill,parentViewBox:m.parentViewBox,value:y,textBreakAll:s,viewBox:m.viewBox,key:"label-".concat(x),index:x}))}))}O0.displayName="LabelList";function x3(e){var{label:t}=e;return t?t===!0?j.createElement(O0,{key:"labelList-implicit"}):j.isValidElement(t)||rb(t)?j.createElement(O0,{key:"labelList-implicit",content:t}):typeof t=="object"?j.createElement(O0,hh({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var g3=e=>e.graphicalItems.polarItems,Tz=Ne([tr,Of],Ty),nb=Ne([g3,br,Tz],Oy),Pz=Ne([nb],Fy),ab=Ne([Pz,vy],Dy),Oz=Ne([ab,br,nb],My),Fz=Ne([ab,br,nb],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=Zt(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:Zt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),fk=()=>{},Dz=Ne([br,bT,fk,Fz,fk,kt,tr],Ly),v3=Ne([br,kt,ab,Oz,Pf,tr,Dz],By),Iz=Ne([v3,br,Ec],zy);Ne([br,v3,Iz,tr],Hy);var Mz={radiusAxis:{},angleAxis:{}},y3=ha({name:"polarAxis",initialState:Mz,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Moe,removeRadiusAxis:Roe,addAngleAxis:Loe,removeAngleAxis:Boe}=y3.actions,Rz=y3.reducer;function dk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dk(Object(r),!0).forEach(function(n){Lz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lz(e,t,r){return(t=Bz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bz(e){var t=$z(e,"string");return typeof t=="symbol"?t:t+""}function $z(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uz=(e,t)=>t,ib=Ne([g3,Uz],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),zz=[],sb=(e,t,r)=>r?.length===0?zz:r,b3=Ne([vy,ib,sb],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>hk(hk({},t.presentationProps),i.props))),a!=null)return a}}),Wz=Ne([b3,ib,sb],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=Zt(n,t.nameKey,t.name),l;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:qh(s,t.dataKey),color:l,payload:n,type:t.legendType}})}),Hz=Ne([b3,ib,sb,Ir],(e,t,r,n)=>{if(!(t==null||e==null))return WW({offset:n,pieSettings:t,displayedData:e,cells:r})}),Ug={},mk;function Vz(){return mk||(mk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(Ug)),Ug}var zg,pk;function Kz(){return pk||(pk=1,zg=Vz().isPlainObject),zg}var Gz=Kz();const qz=es(Gz);function xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xk(Object(r),!0).forEach(function(n){Xz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xz(e,t,r){return(t=Yz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yz(e){var t=Jz(e,"string");return typeof t=="symbol"?t:t+""}function Jz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mh(){return mh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mh.apply(null,arguments)}var vk=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},Qz={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Zz=e=>{var t=La(e,Qz),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:l}=t,{animationEasing:f,animationDuration:d,animationBegin:h,isUpdateAnimationActive:m}=t,x=j.useRef(),[v,y]=j.useState(-1),g=j.useRef(a),b=j.useRef(i),N=j.useRef(s),_=j.useRef(r),S=j.useRef(n),C=tm(e,"trapezoid-");if(j.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var ne=x.current.getTotalLength();ne&&y(ne)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var T=It("recharts-trapezoid",l);if(!m)return j.createElement("g",null,j.createElement("path",mh({},jr(t,!0),{className:T,d:vk(r,n,a,i,s)})));var k=g.current,P=b.current,D=N.current,R=_.current,G=S.current,M="0px ".concat(v===-1?1:v,"px"),H="".concat(v,"px 0px"),z=HC(["strokeDasharray"],d,f);return j.createElement(em,{animationId:C,key:C,canBegin:v>0,duration:d,easing:f,isActive:m,begin:h},ne=>{var Q=on(k,a,ne),le=on(P,i,ne),ue=on(D,s,ne),fe=on(R,r,ne),K=on(G,n,ne);x.current&&(g.current=Q,b.current=le,N.current=ue,_.current=fe,S.current=K);var me=ne>0?{transition:z,strokeDasharray:H}:{strokeDasharray:M};return j.createElement("path",mh({},jr(t,!0),{className:T,d:vk(fe,K,Q,le,ue),ref:x,style:gk(gk({},me),t.style)}))})},eW=["option","shapeType","propTransformer","activeClassName","isActive"];function tW(e,t){if(e==null)return{};var r,n,a=rW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ph(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yk(Object(r),!0).forEach(function(n){nW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nW(e,t,r){return(t=aW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aW(e){var t=iW(e,"string");return typeof t=="symbol"?t:t+""}function iW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sW(e,t){return ph(ph({},t),e)}function oW(e,t){return e==="symbols"}function bk(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return j.createElement(qC,r);case"trapezoid":return j.createElement(Zz,r);case"sector":return j.createElement(JC,r);case"symbols":if(oW(t))return j.createElement(P1,r);break;default:return null}}function lW(e){return j.isValidElement(e)?e.props:e}function w3(e){var{option:t,shapeType:r,propTransformer:n=sW,activeClassName:a="recharts-active-shape",isActive:i}=e,s=tW(e,eW),l;if(j.isValidElement(t))l=j.cloneElement(t,ph(ph({},s),lW(t)));else if(typeof t=="function")l=t(s);else if(qz(t)&&typeof t!="boolean"){var f=n(t,s);l=j.createElement(bk,{shapeType:r,elementProps:f})}else{var d=s;l=j.createElement(bk,{shapeType:r,elementProps:d})}return i?j.createElement(Kn,{className:a},l):l}var ob=(e,t)=>{var r=lr();return(n,a)=>i=>{e?.(n,a,i),r(MT({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},lb=e=>{var t=lr();return(r,n)=>a=>{e?.(r,n,a),t(HB())}},cb=(e,t)=>{var r=lr();return(n,a)=>i=>{e?.(n,a,i),r(VB({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function S3(e){var{fn:t,args:r}=e,n=lr(),a=Ra();return j.useEffect(()=>{if(!a){var i=t(r);return n(UB(i)),()=>{n(zB(i))}}},[t,r,n,a]),null}var N3=()=>{};function cW(e){var{legendPayload:t}=e,r=lr(),n=Ra();return j.useEffect(()=>n?N3:(r($C(t)),()=>{r(UC(t))}),[r,n,t]),null}function uW(e){var{legendPayload:t}=e,r=lr(),n=Qe(kt);return j.useEffect(()=>n!=="centric"&&n!=="radial"?N3:(r($C(t)),()=>{r(UC(t))}),[r,n,t]),null}var Wg,fW=()=>{var[e]=j.useState(()=>Xu("uid-"));return e},dW=(Wg=s5.useId)!==null&&Wg!==void 0?Wg:fW;function hW(e,t){var r=dW();return t||(e?"".concat(e,"-").concat(r):r)}var mW=j.createContext(void 0),E3=e=>{var{id:t,type:r,children:n}=e,a=hW("recharts-".concat(r),t);return j.createElement(mW.Provider,{value:a},n(a))},pW={cartesianItems:[],polarItems:[]},_3=ha({name:"graphicalItems",initialState:pW,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=Ui(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=Ui(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Ui(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:xW,replaceCartesianGraphicalItem:gW,removeCartesianGraphicalItem:vW,addPolarGraphicalItem:yW,removePolarGraphicalItem:bW}=_3.actions,wW=_3.reducer;function SW(e){var t=lr(),r=j.useRef(null);return j.useEffect(()=>{r.current===null?t(xW(e)):r.current!==e&&t(gW({prev:r.current,next:e})),r.current=e},[t,e]),j.useEffect(()=>()=>{r.current&&(t(vW(r.current)),r.current=null)},[t]),null}function NW(e){var t=lr();return j.useEffect(()=>(t(yW(e)),()=>{t(bW(e))}),[t,e]),null}var EW=["onMouseEnter","onClick","onMouseLeave"],_W=["id"],kW=["id"];function ub(e,t){if(e==null)return{};var r,n,a=jW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function wk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wk(Object(r),!0).forEach(function(n){CW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CW(e,t,r){return(t=AW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AW(e){var t=TW(e,"string");return typeof t=="symbol"?t:t+""}function TW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $s(){return $s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$s.apply(null,arguments)}function PW(e){var t=j.useMemo(()=>k1(e.children,Bi),[e.children]),r=Qe(n=>Wz(n,e.id,t));return r==null?null:j.createElement(uW,{legendPayload:r})}function OW(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:l,hide:f,tooltipType:d}=e;return{dataDefinedOnItem:n.map(h=>h.tooltipPayload),positions:n.map(h=>h.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:qh(l,t),hide:f,type:d,color:s,unit:""}}}var FW=(e,t)=>e>t?"start":e<t?"end":"middle",DW=(e,t,r)=>bn(typeof t=="function"?t(e):t,r,r*.8),IW=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,l=PC(i,s),f=a+bn(e.cx,i,i/2),d=n+bn(e.cy,s,s/2),h=bn(e.innerRadius,l,0),m=DW(r,e.outerRadius,l),x=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:f,cy:d,innerRadius:h,outerRadius:m,maxRadius:x}},MW=(e,t)=>{var r=Kr(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function RW(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var LW=(e,t)=>{if(j.isValidElement(e))return j.cloneElement(e,t);if(typeof e=="function")return e(t);var r=It("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return j.createElement(WC,$s({},t,{type:"linear",className:r}))},BW=(e,t,r)=>{if(j.isValidElement(e))return j.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),j.isValidElement(n)))return n;var a=It("recharts-pie-label-text",RW(e));return j.createElement(gm,$s({},t,{alignmentBaseline:"middle",className:a}),n)};function $W(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var l=tl(r),f=jr(a,!1),d=jr(i,!1),h=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,m=t.map((x,v)=>{var y=(x.startAngle+x.endAngle)/2,g=Cr(x.cx,x.cy,x.outerRadius+h,y),b=Qt(Qt(Qt(Qt({},l),x),{},{stroke:"none"},f),{},{index:v,textAnchor:FW(g.x,x.cx)},g),N=Qt(Qt(Qt(Qt({},l),x),{},{fill:"none",stroke:x.fill},d),{},{index:v,points:[Cr(x.cx,x.cy,x.outerRadius,y),g],key:"line"});return j.createElement(Kn,{key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(v)},i&&LW(i,N),BW(a,b,Zt(x,s)))});return j.createElement(Kn,{className:"recharts-pie-labels"},m)}function UW(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?j.createElement(x3,{label:r.label}):j.createElement($W,{sectors:t,props:r,showLabels:n})}function zW(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=Qe(Go),{onMouseEnter:s,onClick:l,onMouseLeave:f}=a,d=ub(a,EW),h=ob(s,a.dataKey),m=lb(f),x=cb(l,a.dataKey);return t==null||t.length===0?null:j.createElement(j.Fragment,null,t.map((v,y)=>{if(v?.startAngle===0&&v?.endAngle===0&&t.length!==1)return null;var g=r&&String(y)===i,b=i?n:null,N=g?r:b,_=Qt(Qt({},v),{},{stroke:v.stroke,tabIndex:-1,[MC]:y,[RC]:a.dataKey});return j.createElement(Kn,$s({tabIndex:-1,className:"recharts-pie-sector"},Nf(d,v,y),{onMouseEnter:h(v,y),onMouseLeave:m(v,y),onClick:x(v,y),key:"sector-".concat(v?.startAngle,"-").concat(v?.endAngle,"-").concat(v.midAngle,"-").concat(y)}),j.createElement(w3,$s({option:N,isActive:g,shapeType:"sector"},_)))}))}function WW(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:l,endAngle:f,dataKey:d,nameKey:h,tooltipType:m}=r,x=Math.abs(r.minAngle),v=MW(l,f),y=Math.abs(v),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,b=n.filter(k=>Zt(k,d,0)!==0).length,N=(y>=360?b:b-1)*g,_=y-b*x-N,S=n.reduce((k,P)=>{var D=Zt(P,d,0);return k+(Ze(D)?D:0)},0),C;if(S>0){var T;C=n.map((k,P)=>{var D=Zt(k,d,0),R=Zt(k,h,P),G=IW(r,i,k),M=(Ze(D)?D:0)/S,H,z=Qt(Qt({},k),a&&a[P]&&a[P].props);P?H=T.endAngle+Kr(v)*g*(D!==0?1:0):H=l;var ne=H+Kr(v)*((D!==0?x:0)+M*_),Q=(H+ne)/2,le=(G.innerRadius+G.outerRadius)/2,ue=[{name:R,value:D,payload:z,dataKey:d,type:m}],fe=Cr(G.cx,G.cy,le,Q);return T=Qt(Qt(Qt(Qt({},r.presentationProps),{},{percent:M,cornerRadius:s,name:R,tooltipPayload:ue,midAngle:Q,middleRadius:le,tooltipPosition:fe},z),G),{},{value:Zt(k,d),startAngle:H,endAngle:ne,payload:z,paddingAngle:Kr(v)*g}),T})}return C}function HW(e){var{showLabels:t,sectors:r,children:n}=e,a=j.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return j.createElement(jz,{value:t?a:void 0},n)}function VW(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:l,activeShape:f,inactiveShape:d,onAnimationStart:h,onAnimationEnd:m}=t,x=tm(t,"recharts-pie-"),v=r.current,[y,g]=j.useState(!1),b=j.useCallback(()=>{typeof m=="function"&&m(),g(!1)},[m]),N=j.useCallback(()=>{typeof h=="function"&&h(),g(!0)},[h]);return j.createElement(HW,{showLabels:!y,sectors:n},j.createElement(em,{animationId:x,begin:i,duration:s,isActive:a,easing:l,onAnimationStart:N,onAnimationEnd:b,key:x},_=>{var S=[],C=n&&n[0],T=C?.startAngle;return n?.forEach((k,P)=>{var D=v&&v[P],R=P>0?Wo(k,"paddingAngle",0):0;if(D){var G=on(D.endAngle-D.startAngle,k.endAngle-k.startAngle,_),M=Qt(Qt({},k),{},{startAngle:T+R,endAngle:T+G+R});S.push(M),T=M.endAngle}else{var{endAngle:H,startAngle:z}=k,ne=on(0,H-z,_),Q=Qt(Qt({},k),{},{startAngle:T+R,endAngle:T+ne+R});S.push(Q),T=Q.endAngle}}),r.current=S,j.createElement(Kn,null,j.createElement(zW,{sectors:S,activeShape:f,inactiveShape:d,allOtherPieProps:t}))}),j.createElement(UW,{showLabels:!y,sectors:n,props:t}),t.children)}var KW={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!vc.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function GW(e){var{id:t}=e,r=ub(e,_W),{hide:n,className:a,rootTabIndex:i}=e,s=j.useMemo(()=>k1(e.children,Bi),[e.children]),l=Qe(h=>Hz(h,t,s)),f=j.useRef(null),d=It("recharts-pie",a);return n||l==null?(f.current=null,j.createElement(Kn,{tabIndex:i,className:d})):j.createElement(j.Fragment,null,j.createElement(S3,{fn:OW,args:Qt(Qt({},e),{},{sectors:l})}),j.createElement(Kn,{tabIndex:i,className:d},j.createElement(VW,{props:Qt(Qt({},r),{},{sectors:l}),previousSectorsRef:f})))}function Lu(e){var t=La(e,KW),{id:r}=t,n=ub(t,kW),a=tl(n);return j.createElement(E3,{id:r,type:"pie"},i=>j.createElement(j.Fragment,null,j.createElement(NW,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a}),j.createElement(PW,$s({},n,{id:i})),j.createElement(GW,$s({},n,{id:i}))))}Lu.displayName="Pie";function Sk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sk(Object(r),!0).forEach(function(n){qW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qW(e,t,r){return(t=XW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XW(e){var t=YW(e,"string");return typeof t=="symbol"?t:t+""}function YW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JW={xAxis:{},yAxis:{},zAxis:{}},k3=ha({name:"cartesianAxis",initialState:JW,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=Nk(Nk({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:QW,removeXAxis:ZW,addYAxis:eH,removeYAxis:tH,addZAxis:$oe,removeZAxis:Uoe,updateYAxisWidth:rH}=k3.actions,nH=k3.reducer,aH=Ne([Ir],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),iH=Ne([aH,ts,rs],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),j3=()=>Qe(iH),sH="Invariant failed";function oH(e,t){throw new Error(sH)}var lH=["x","y"];function Yv(){return Yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yv.apply(null,arguments)}function Ek(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Eu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ek(Object(r),!0).forEach(function(n){cH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ek(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cH(e,t,r){return(t=uH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uH(e){var t=fH(e,"string");return typeof t=="symbol"?t:t+""}function fH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dH(e,t){if(e==null)return{};var r,n,a=hH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function mH(e,t){var{x:r,y:n}=e,a=dH(e,lH),i="".concat(r),s=parseInt(i,10),l="".concat(n),f=parseInt(l,10),d="".concat(t.height||a.height),h=parseInt(d,10),m="".concat(t.width||a.width),x=parseInt(m,10);return Eu(Eu(Eu(Eu(Eu({},t),a),s?{x:s}:{}),f?{y:f}:{}),{},{height:h,width:x,name:t.name,radius:t.radius})}function fb(e){return j.createElement(w3,Yv({shapeType:"rectangle",propTransformer:mH,activeClassName:"recharts-active-bar"},e))}var pH=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Ze(t))return t;var i=Ze(n)||qr(n);return i?t(n,a):(i||oH(),r)}},xH={},C3=ha({name:"errorBars",initialState:xH,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:zoe,replaceErrorBar:Woe,removeErrorBar:Hoe}=C3.actions,gH=C3.reducer,vH=["children"];function yH(e,t){if(e==null)return{};var r,n,a=bH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wH={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},SH=j.createContext(wH);function NH(e){var{children:t}=e,r=yH(e,vH);return j.createElement(SH.Provider,{value:r},t)}function A3(e,t){var r,n,a=Qe(d=>Qs(d,e)),i=Qe(d=>Zs(d,t)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:Zn.allowDataOverflow,l=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:ea.allowDataOverflow,f=s||l;return{needClip:f,needClipX:s,needClipY:l}}function EH(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=j3(),{needClipX:i,needClipY:s,needClip:l}=A3(t,r);if(!l)return null;var{x:f,y:d,width:h,height:m}=a;return j.createElement("clipPath",{id:"clipPath-".concat(n)},j.createElement("rect",{x:i?f:f-h/2,y:s?d:d-m/2,width:i?h:h*2,height:s?m:m*2}))}var _H=["onMouseEnter","onMouseLeave","onClick"],kH=["value","background","tooltipPosition"],jH=["id"],CH=["onMouseEnter","onClick","onMouseLeave"];function Us(){return Us=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Us.apply(null,arguments)}function _k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function An(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_k(Object(r),!0).forEach(function(n){AH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_k(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AH(e,t,r){return(t=TH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TH(e){var t=PH(e,"string");return typeof t=="symbol"?t:t+""}function PH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xh(e,t){if(e==null)return{};var r,n,a=OH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function OH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var FH=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:qh(r,t),payload:e}]};function DH(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:qh(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:l}}}function IH(e){var t=Qe(Go),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:l,onClick:f}=i,d=xh(i,_H),h=ob(s,n),m=lb(l),x=cb(f,n);if(!a||r==null)return null;var v=jr(a,!1);return j.createElement(j.Fragment,null,r.map((y,g)=>{var{value:b,background:N,tooltipPosition:_}=y,S=xh(y,kH);if(!N)return null;var C=h(y,g),T=m(y,g),k=x(y,g),P=An(An(An(An(An({option:a,isActive:String(g)===t},S),{},{fill:"#eee"},N),v),Nf(d,y,g)),{},{onMouseEnter:C,onMouseLeave:T,onClick:k,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return j.createElement(fb,Us({key:"background-bar-".concat(g)},P))}))}function MH(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return An(An({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return j.createElement(kz,{value:t?a:void 0},r)}function RH(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,l=Qe(Go),f=Qe(XT),d=r&&String(i)===l&&(f==null||s===f),h=d?r:t;return j.createElement(fb,Us({},n,a,{isActive:d,option:h,index:i,dataKey:s}))}function LH(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return j.createElement(fb,Us({},r,n,{isActive:!1,option:t,index:a,dataKey:i}))}function BH(e){var{data:t,props:r}=e,n=tl(r),{id:a}=n,i=xh(n,jH),{shape:s,dataKey:l,activeBar:f}=r,{onMouseEnter:d,onClick:h,onMouseLeave:m}=r,x=xh(r,CH),v=ob(d,l),y=lb(m),g=cb(h,l);return t?j.createElement(j.Fragment,null,t.map((b,N)=>j.createElement(Kn,Us({className:"recharts-bar-rectangle"},Nf(x,b,N),{onMouseEnter:v(b,N),onMouseLeave:y(b,N),onClick:g(b,N),key:"rectangle-".concat(b?.x,"-").concat(b?.y,"-").concat(b?.value,"-").concat(N)}),f?j.createElement(RH,{shape:s,activeBar:f,baseProps:i,entry:b,index:N,dataKey:l}):j.createElement(LH,{shape:s,baseProps:i,entry:b,index:N,dataKey:l})))):null}function $H(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:f,onAnimationEnd:d,onAnimationStart:h}=t,m=r.current,x=tm(t,"recharts-bar-"),[v,y]=j.useState(!1),g=!v,b=j.useCallback(()=>{typeof d=="function"&&d(),y(!1)},[d]),N=j.useCallback(()=>{typeof h=="function"&&h(),y(!0)},[h]);return j.createElement(MH,{showLabels:g,rects:n},j.createElement(em,{animationId:x,begin:s,duration:l,isActive:i,easing:f,onAnimationEnd:b,onAnimationStart:N,key:x},_=>{var S=_===1?n:n?.map((C,T)=>{var k=m&&m[T];if(k)return An(An({},C),{},{x:on(k.x,C.x,_),y:on(k.y,C.y,_),width:on(k.width,C.width,_),height:on(k.height,C.height,_)});if(a==="horizontal"){var P=on(0,C.height,_);return An(An({},C),{},{y:C.y+C.height-P,height:P})}var D=on(0,C.width,_);return An(An({},C),{},{width:D})});return _>0&&(r.current=S??null),S==null?null:j.createElement(Kn,null,j.createElement(BH,{props:t,data:S}))}),j.createElement(x3,{label:t.label}),t.children)}function UH(e){var t=j.useRef(null);return j.createElement($H,{previousRectanglesRef:t,props:e})}var T3=0,zH=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Zt(e,t)}};class WH extends j.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:l,background:f,id:d}=this.props;if(t||r==null)return null;var h=It("recharts-bar",a),m=d;return j.createElement(Kn,{className:h,id:d},l&&j.createElement("defs",null,j.createElement(EH,{clipPathId:m,xAxisId:i,yAxisId:s})),j.createElement(Kn,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(m,")"):void 0},j.createElement(IH,{data:r,dataKey:n,background:f,allOtherBarProps:this.props}),j.createElement(UH,this.props)))}}var HH={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!vc.isSsr,legendType:"rect",minPointSize:T3,xAxisId:0,yAxisId:0};function VH(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:f,animationEasing:d,isAnimationActive:h}=e,{needClip:m}=A3(t,r),x=G1(),v=Ra(),y=k1(e.children,Bi),g=Qe(_=>vV(_,t,r,v,e.id,y));if(x!=="vertical"&&x!=="horizontal")return null;var b,N=g?.[0];return N==null||N.height==null||N.width==null?b=0:b=x==="vertical"?N.height/2:N.width/2,j.createElement(NH,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:zH,errorBarOffset:b},j.createElement(WH,Us({},e,{layout:x,needClip:m,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:f,animationEasing:d,isAnimationActive:h})))}function KH(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:l,xAxisTicks:f,yAxisTicks:d,stackedData:h,displayedData:m,offset:x,cells:v,parentViewBox:y}=e,g=t==="horizontal"?l:s,b=h?g.scale.domain():null,N=l8({numericAxis:g});return m.map((_,S)=>{var C,T,k,P,D,R;h?C=r8(h[S],b):(C=Zt(_,r),Array.isArray(C)||(C=[N,C]));var G=pH(n,T3)(C[1],S);if(t==="horizontal"){var M,[H,z]=[l.scale(C[0]),l.scale(C[1])];T=dE({axis:s,ticks:f,bandSize:i,offset:a.offset,entry:_,index:S}),k=(M=z??H)!==null&&M!==void 0?M:void 0,P=a.size;var ne=H-z;if(D=ca(ne)?0:ne,R={x:T,y:x.top,width:P,height:x.height},Math.abs(G)>0&&Math.abs(D)<Math.abs(G)){var Q=Kr(D||G)*(Math.abs(G)-Math.abs(D));k-=Q,D+=Q}}else{var[le,ue]=[s.scale(C[0]),s.scale(C[1])];if(T=le,k=dE({axis:l,ticks:d,bandSize:i,offset:a.offset,entry:_,index:S}),P=ue-le,D=a.size,R={x:x.left,y:k,width:x.width,height:D},Math.abs(G)>0&&Math.abs(P)<Math.abs(G)){var fe=Kr(P||G)*(Math.abs(G)-Math.abs(P));P+=fe}}if(T==null||k==null||P==null||D==null)return null;var K=An(An({},_),{},{x:T,y:k,width:P,height:D,value:h?C:C[1],payload:_,background:R,tooltipPosition:{x:T+P/2,y:k+D/2},parentViewBox:y},v&&v[S]&&v[S].props);return K}).filter(Boolean)}function P3(e){var t=La(e,HH),r=Ra();return j.createElement(E3,{id:t.id,type:"bar"},n=>j.createElement(j.Fragment,null,j.createElement(cW,{legendPayload:FH(t)}),j.createElement(S3,{fn:DH,args:t}),j.createElement(SW,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:o8(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),j.createElement(VH,Us({},t,{id:n}))))}P3.displayName="Bar";function kk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function x0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kk(Object(r),!0).forEach(function(n){GH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GH(e,t,r){return(t=qH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qH(e){var t=XH(e,"string");return typeof t=="symbol"?t:t+""}function XH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YH=(e,t)=>t,JH=(e,t,r)=>r,QH=(e,t,r,n)=>n,ZH=(e,t,r,n,a)=>a,Lf=Ne([Py,ZH],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),eV=Ne([Lf],e=>e?.maxBarSize),tV=(e,t,r,n,a,i)=>i,jk=(e,t,r)=>{var n=r??e;if(!qr(n))return bn(n,t,0)},rV=Ne([kt,Py,YH,JH,QH],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),nV=(e,t,r,n)=>{var a=kt(e);return a==="horizontal"?Hv(e,"yAxis",r,n):Hv(e,"xAxis",t,n)},aV=(e,t,r)=>{var n=kt(e);return n==="horizontal"?A_(e,"xAxis",t):A_(e,"yAxis",r)},iV=(e,t,r)=>{var n={},a=e.filter(fm),i=e.filter(d=>d.stackId==null),s=a.reduce((d,h)=>(d[h.stackId]||(d[h.stackId]=[]),d[h.stackId].push(h),d),n),l=Object.entries(s).map(d=>{var[h,m]=d,x=m.map(y=>y.dataKey),v=jk(t,r,m[0].barSize);return{stackId:h,dataKeys:x,barSize:v}}),f=i.map(d=>{var h=[d.dataKey].filter(x=>x!=null),m=jk(t,r,d.barSize);return{stackId:void 0,dataKeys:h,barSize:m}});return[...l,...f]},sV=Ne([rV,z9,aV],iV),oV=(e,t,r,n,a)=>{var i,s,l=Lf(e,t,r,n,a);if(l!=null){var f=kt(e),d=GA(e),{maxBarSize:h}=l,m=qr(h)?d:h,x,v;return f==="horizontal"?(x=fc(e,"xAxis",t,n),v=uc(e,"xAxis",t,n)):(x=fc(e,"yAxis",r,n),v=uc(e,"yAxis",r,n)),(i=(s=z1(x,v,!0))!==null&&s!==void 0?s:m)!==null&&i!==void 0?i:0}},O3=(e,t,r,n)=>{var a=kt(e),i,s;return a==="horizontal"?(i=fc(e,"xAxis",t,n),s=uc(e,"xAxis",t,n)):(i=fc(e,"yAxis",r,n),s=uc(e,"yAxis",r,n)),z1(i,s)};function lV(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=bn(e,r,0,!0),l,f=[];if(fa(n[0].barSize)){var d=!1,h=r/i,m=n.reduce((N,_)=>N+(_.barSize||0),0);m+=(i-1)*s,m>=r&&(m-=(i-1)*s,s=0),m>=r&&h>0&&(d=!0,h*=.9,m=i*h);var x=(r-m)/2>>0,v={offset:x-s,size:0};l=n.reduce((N,_)=>{var S,C={stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:v.offset+v.size+s,size:d?h:(S=_.barSize)!==null&&S!==void 0?S:0}},T=[...N,C];return v=T[T.length-1].position,T},f)}else{var y=bn(t,r,0,!0);r-2*y-(i-1)*s<=0&&(s=0);var g=(r-2*y-(i-1)*s)/i;g>1&&(g>>=0);var b=fa(a)?Math.min(g,a):g;l=n.reduce((N,_,S)=>[...N,{stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:y+(g+s)*S+(g-b)/2,size:b}}],f)}return l}}var cV=(e,t,r,n,a,i,s)=>{var l=qr(s)?t:s,f=lV(r,n,a!==i?a:i,e,l);return a!==i&&f!=null&&(f=f.map(d=>x0(x0({},d),{},{position:x0(x0({},d.position),{},{offset:d.position.offset-a/2})}))),f},uV=Ne([sV,GA,U9,qA,oV,O3,eV],cV),fV=(e,t,r,n)=>fc(e,"xAxis",t,n),dV=(e,t,r,n)=>fc(e,"yAxis",r,n),hV=(e,t,r,n)=>uc(e,"xAxis",t,n),mV=(e,t,r,n)=>uc(e,"yAxis",r,n),pV=Ne([uV,Lf],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),xV=(e,t)=>{var r=Cy(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},gV=Ne([nV,Lf],xV),vV=Ne([Ir,W1,fV,dV,hV,mV,pV,kt,yy,O3,gV,Lf,tV],(e,t,r,n,a,i,s,l,f,d,h,m,x)=>{var{chartData:v,dataStartIndex:y,dataEndIndex:g}=f;if(!(m==null||s==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||i==null||d==null)){var{data:b}=m,N;if(b!=null&&b.length>0?N=b:N=v?.slice(y,g+1),N!=null)return KH({layout:l,barSettings:m,pos:s,parentViewBox:t,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:h,displayedData:N,offset:e,cells:x})}}),F3=e=>{var{chartData:t}=e,r=lr(),n=Ra();return j.useEffect(()=>n?()=>{}:(r(B_(t)),()=>{r(B_(void 0))}),[t,r,n]),null},Ck={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},D3=ha({name:"brush",initialState:Ck,reducers:{setBrushSettings(e,t){return t.payload==null?Ck:t.payload}}}),{setBrushSettings:Voe}=D3.actions,yV=D3.reducer;function bV(e,t,r){return(t=wV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wV(e){var t=SV(e,"string");return typeof t=="symbol"?t:t+""}function SV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class db{static create(t){return new db(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}bV(db,"EPS",1e-4);function NV(e){return(e%180+180)%180}var EV=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=NV(a),s=i*Math.PI/180,l=Math.atan(n/r),f=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(f)},_V={dots:[],areas:[],lines:[]},I3=ha({name:"referenceElements",initialState:_V,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Ui(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Ui(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Ui(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Koe,removeDot:Goe,addArea:qoe,removeArea:Xoe,addLine:Yoe,removeLine:Joe}=I3.actions,kV=I3.reducer,jV=j.createContext(void 0),CV=e=>{var{children:t}=e,[r]=j.useState("".concat(Xu("recharts"),"-clip")),n=j3();if(n==null)return null;var{x:a,y:i,width:s,height:l}=n;return j.createElement(jV.Provider,{value:r},j.createElement("defs",null,j.createElement("clipPath",{id:r},j.createElement("rect",{x:a,y:i,height:l,width:s}))),t)};function Hg(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function M3(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function AV(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return EV(n,r)}function TV(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:l}=e;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function gh(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function PV(e,t){return M3(e,t+1)}function OV(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:l}=t,f=0,d=1,h=s,m=function(){var y=n?.[f];if(y===void 0)return{v:M3(n,d)};var g=f,b,N=()=>(b===void 0&&(b=r(y,g)),b),_=y.coordinate,S=f===0||gh(e,_,N,h,l);S||(f=0,h=s,d+=1),S&&(h=_+e*(N()/2+a),f+=d)},x;d<=i.length;)if(x=m(),x)return x.v;return[]}function Ak(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ak(Object(r),!0).forEach(function(n){FV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ak(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FV(e,t,r){return(t=DV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DV(e){var t=IV(e,"string");return typeof t=="symbol"?t:t+""}function IV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MV(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:l}=t,{end:f}=t,d=function(x){var v=i[x],y,g=()=>(y===void 0&&(y=r(v,x)),y);if(x===s-1){var b=e*(v.coordinate+e*g()/2-f);i[x]=v=mn(mn({},v),{},{tickCoord:b>0?v.coordinate-b*e:v.coordinate})}else i[x]=v=mn(mn({},v),{},{tickCoord:v.coordinate});var N=gh(e,v.tickCoord,g,l,f);N&&(f=v.tickCoord-e*(g()/2+a),i[x]=mn(mn({},v),{},{isShow:!0}))},h=s-1;h>=0;h--)d(h);return i}function RV(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,{start:f,end:d}=t;if(i){var h=n[l-1],m=r(h,l-1),x=e*(h.coordinate+e*m/2-d);s[l-1]=h=mn(mn({},h),{},{tickCoord:x>0?h.coordinate-x*e:h.coordinate});var v=gh(e,h.tickCoord,()=>m,f,d);v&&(d=h.tickCoord-e*(m/2+a),s[l-1]=mn(mn({},h),{},{isShow:!0}))}for(var y=i?l-1:l,g=function(_){var S=s[_],C,T=()=>(C===void 0&&(C=r(S,_)),C);if(_===0){var k=e*(S.coordinate-e*T()/2-f);s[_]=S=mn(mn({},S),{},{tickCoord:k<0?S.coordinate-k*e:S.coordinate})}else s[_]=S=mn(mn({},S),{},{tickCoord:S.coordinate});var P=gh(e,S.tickCoord,T,f,d);P&&(f=S.tickCoord+e*(T()/2+a),s[_]=mn(mn({},S),{},{isShow:!0}))},b=0;b<y;b++)g(b);return s}function hb(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:l,interval:f,tickFormatter:d,unit:h,angle:m}=e;if(!a||!a.length||!n)return[];if(Ze(f)||vc.isSsr){var x;return(x=PV(a,Ze(f)?f:0))!==null&&x!==void 0?x:[]}var v=[],y=l==="top"||l==="bottom"?"width":"height",g=h&&y==="width"?Ru(h,{fontSize:t,letterSpacing:r}):{width:0,height:0},b=(S,C)=>{var T=typeof d=="function"?d(S.value,C):S.value;return y==="width"?AV(Ru(T,{fontSize:t,letterSpacing:r}),g,m):Ru(T,{fontSize:t,letterSpacing:r})[y]},N=a.length>=2?Kr(a[1].coordinate-a[0].coordinate):1,_=TV(i,N,y);return f==="equidistantPreserveStart"?OV(N,_,b,a,s):(f==="preserveStart"||f==="preserveStartEnd"?v=RV(N,_,b,a,s,f==="preserveStartEnd"):v=MV(N,_,b,a,s),v.filter(S=>S.isShow))}var LV=["viewBox"],BV=["viewBox"];function Gl(){return Gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gl.apply(null,arguments)}function Tk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tk(Object(r),!0).forEach(function(n){mb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pk(e,t){if(e==null)return{};var r,n,a=$V(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $V(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function mb(e,t,r){return(t=UV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UV(e){var t=zV(e,"string");return typeof t=="symbol"?t:t+""}function zV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class eo extends j.Component{constructor(t){super(t),this.tickRefs=j.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,r){var{viewBox:n}=t,a=Pk(t,LV),i=this.props,{viewBox:s}=i,l=Pk(i,BV);return!Hg(n,s)||!Hg(a,l)||!Hg(r,this.state)}getTickLineCoord(t){var{x:r,y:n,width:a,height:i,orientation:s,tickSize:l,mirror:f,tickMargin:d}=this.props,h,m,x,v,y,g,b=f?-1:1,N=t.tickSize||l,_=Ze(t.tickCoord)?t.tickCoord:t.coordinate;switch(s){case"top":h=m=t.coordinate,v=n+ +!f*i,x=v-b*N,g=x-b*d,y=_;break;case"left":x=v=t.coordinate,m=r+ +!f*a,h=m-b*N,y=h-b*d,g=_;break;case"right":x=v=t.coordinate,m=r+ +f*a,h=m+b*N,y=h+b*d,g=_;break;default:h=m=t.coordinate,v=n+ +f*i,x=v+b*N,g=x+b*d,y=_;break}return{line:{x1:h,y1:x,x2:m,y2:v},tick:{x:y,y:g}}}getTickTextAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":return r?"start":"end";case"right":return r?"end":"start";default:return"middle"}}getTickVerticalAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:l}=this.props,f=Or(Or(Or({},jr(this.props,!1)),jr(l,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!s||i==="bottom"&&s);f=Or(Or({},f),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var h=+(i==="left"&&!s||i==="right"&&s);f=Or(Or({},f),{},{x1:t+h*n,y1:r,x2:t+h*n,y2:r+a})}return j.createElement("line",Gl({},f,{className:It("recharts-cartesian-axis-line",Wo(l,"className"))}))}static renderTickItem(t,r,n){var a,i=It(r.className,"recharts-cartesian-axis-tick-value");if(j.isValidElement(t))a=j.cloneElement(t,Or(Or({},r),{},{className:i}));else if(typeof t=="function")a=t(Or(Or({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=It(s,t.className)),a=j.createElement(gm,Gl({},r,{className:s}),n)}return a}renderTicks(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:a,stroke:i,tick:s,tickFormatter:l,unit:f,padding:d,tickTextProps:h}=this.props,m=hb(Or(Or({},this.props),{},{ticks:n}),t,r),x=this.getTickTextAnchor(),v=this.getTickVerticalAnchor(),y=tl(this.props),g=jr(s,!1),b=Or(Or({},y),{},{fill:"none"},jr(a,!1)),N=m.map((_,S)=>{var{line:C,tick:T}=this.getTickLineCoord(_),k=Or(Or(Or(Or({textAnchor:x,verticalAnchor:v},y),{},{stroke:"none",fill:i},g),T),{},{index:S,payload:_,visibleTicksCount:m.length,tickFormatter:l,padding:d},h);return j.createElement(Kn,Gl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},Nf(this.props,_,S)),a&&j.createElement("line",Gl({},b,C,{className:It("recharts-cartesian-axis-tick-line",Wo(a,"className"))})),s&&eo.renderTickItem(s,k,"".concat(typeof l=="function"?l(_.value,S):_.value).concat(f||"")))});return N.length>0?j.createElement("g",{className:"recharts-cartesian-axis-ticks"},N):null}render(){var{axisLine:t,width:r,height:n,className:a,hide:i}=this.props;if(i)return null;var{ticks:s}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:j.createElement(Kn,{className:It("recharts-cartesian-axis",a),ref:l=>{if(l){var f=l.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(f);var d=f[0];if(d){var h=window.getComputedStyle(d).fontSize,m=window.getComputedStyle(d).letterSpacing;(h!==this.state.fontSize||m!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(d).fontSize,letterSpacing:window.getComputedStyle(d).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,s),j.createElement(iz,{x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height},j.createElement(pz,{label:this.props.label}),this.props.children))}}mb(eo,"displayName","CartesianAxis");mb(eo,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var WV=["x1","y1","x2","y2","key"],HV=["offset"],VV=["xAxisId","yAxisId"],KV=["xAxisId","yAxisId"];function Ok(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ok(Object(r),!0).forEach(function(n){GV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ok(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GV(e,t,r){return(t=qV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qV(e){var t=XV(e,"string");return typeof t=="symbol"?t:t+""}function XV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function To(){return To=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},To.apply(null,arguments)}function vh(e,t){if(e==null)return{};var r,n,a=YV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var JV=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:l}=e;return j.createElement("rect",{x:n,y:a,ry:l,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function R3(e,t){var r;if(j.isValidElement(e))r=j.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:s,key:l}=t,f=vh(t,WV),d=tl(f),{offset:h}=d,m=vh(d,HV);r=j.createElement("line",To({},m,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:l}))}return r}function QV(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=vh(e,VV),f=a.map((d,h)=>{var m=gn(gn({},l),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(h),index:h});return R3(n,m)});return j.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function ZV(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=vh(e,KV),f=a.map((d,h)=>{var m=gn(gn({},l),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(h),index:h});return R3(n,m)});return j.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function eK(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:l,horizontal:f=!0}=e;if(!f||!t||!t.length)return null;var d=l.map(m=>Math.round(m+a-a)).sort((m,x)=>m-x);a!==d[0]&&d.unshift(0);var h=d.map((m,x)=>{var v=!d[x+1],y=v?a+s-m:d[x+1]-m;if(y<=0)return null;var g=x%t.length;return j.createElement("rect",{key:"react-".concat(x),y:m,x:n,height:y,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return j.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function tK(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:l,verticalPoints:f}=e;if(!t||!r||!r.length)return null;var d=f.map(m=>Math.round(m+a-a)).sort((m,x)=>m-x);a!==d[0]&&d.unshift(0);var h=d.map((m,x)=>{var v=!d[x+1],y=v?a+s-m:d[x+1]-m;if(y<=0)return null;var g=x%r.length;return j.createElement("rect",{key:"react-".concat(x),x:m,y:i,width:y,height:l,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return j.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var rK=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return FC(hb(gn(gn(gn({},eo.defaultProps),r),{},{ticks:DC(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},nK=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return FC(hb(gn(gn(gn({},eo.defaultProps),r),{},{ticks:DC(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},aK={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function L3(e){var t=V1(),r=K1(),n=LC(),a=gn(gn({},La(e,aK)),{},{x:Ze(e.x)?e.x:n.left,y:Ze(e.y)?e.y:n.top,width:Ze(e.width)?e.width:n.width,height:Ze(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:l,y:f,width:d,height:h,syncWithTicks:m,horizontalValues:x,verticalValues:v}=a,y=Ra(),g=Qe(R=>T_(R,"xAxis",i,y)),b=Qe(R=>T_(R,"yAxis",s,y));if(!Ze(d)||d<=0||!Ze(h)||h<=0||!Ze(l)||l!==+l||!Ze(f)||f!==+f)return null;var N=a.verticalCoordinatesGenerator||rK,_=a.horizontalCoordinatesGenerator||nK,{horizontalPoints:S,verticalPoints:C}=a;if((!S||!S.length)&&typeof _=="function"){var T=x&&x.length,k=_({yAxis:b?gn(gn({},b),{},{ticks:T?x:b.ticks}):void 0,width:t,height:r,offset:n},T?!0:m);Iu(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(S=k)}if((!C||!C.length)&&typeof N=="function"){var P=v&&v.length,D=N({xAxis:g?gn(gn({},g),{},{ticks:P?v:g.ticks}):void 0,width:t,height:r,offset:n},P?!0:m);Iu(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(C=D)}return j.createElement("g",{className:"recharts-cartesian-grid"},j.createElement(JV,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),j.createElement(eK,To({},a,{horizontalPoints:S})),j.createElement(tK,To({},a,{verticalPoints:C})),j.createElement(QV,To({},a,{offset:n,horizontalPoints:S,xAxis:g,yAxis:b})),j.createElement(ZV,To({},a,{offset:n,verticalPoints:C,xAxis:g,yAxis:b})))}L3.displayName="CartesianGrid";var iK=["children"],sK=["dangerouslySetInnerHTML","ticks"],oK=["id"];function B3(e,t,r){return(t=lK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lK(e){var t=cK(e,"string");return typeof t=="symbol"?t:t+""}function cK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jv(){return Jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jv.apply(null,arguments)}function Qv(e,t){if(e==null)return{};var r,n,a=uK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function fK(e){var t=lr(),r=j.useMemo(()=>{var{children:n}=e,a=Qv(e,iK);return a},[e]);return j.useEffect(()=>(t(QW(r)),()=>{t(ZW(r))}),[r,t]),e.children}var dK=e=>{var{xAxisId:t,className:r}=e,n=Qe(W1),a=Ra(),i="xAxis",s=Qe(b=>_c(b,i,t,a)),l=Qe(b=>TT(b,i,t,a)),f=Qe(b=>kT(b,t)),d=Qe(b=>OB(b,t)),h=Qe(b=>nT(b,t));if(f==null||d==null||h==null)return null;var{dangerouslySetInnerHTML:m,ticks:x}=e,v=Qv(e,sK),{id:y}=h,g=Qv(h,oK);return j.createElement(eo,Jv({},v,g,{scale:s,x:d.x,y:d.y,width:f.width,height:f.height,className:It("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:l}))},hK=e=>{var t,r,n,a,i;return j.createElement(fK,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(i=e.tick)!==null&&i!==void 0?i:!0,tickFormatter:e.tickFormatter},j.createElement(dK,e))};class pb extends j.Component{render(){return j.createElement(hK,this.props)}}B3(pb,"displayName","XAxis");B3(pb,"defaultProps",{allowDataOverflow:Zn.allowDataOverflow,allowDecimals:Zn.allowDecimals,allowDuplicatedCategory:Zn.allowDuplicatedCategory,height:Zn.height,hide:!1,mirror:Zn.mirror,orientation:Zn.orientation,padding:Zn.padding,reversed:Zn.reversed,scale:Zn.scale,tickCount:Zn.tickCount,type:Zn.type,xAxisId:0});var mK=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){t.forEach(h=>{if(h){var m=h.getBoundingClientRect();m.width>s&&(s=m.width)}});var l=r?r.getBoundingClientRect().width:0,f=a+i,d=s+f+l+(r?n:0);return Math.round(d)}return 0},pK=["dangerouslySetInnerHTML","ticks"],xK=["id"];function $3(e,t,r){return(t=gK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gK(e){var t=vK(e,"string");return typeof t=="symbol"?t:t+""}function vK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zv.apply(null,arguments)}function Fk(e,t){if(e==null)return{};var r,n,a=yK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function bK(e){var t=lr();return j.useEffect(()=>(t(eH(e)),()=>{t(tH(e))}),[e,t]),null}var wK=e=>{var t,{yAxisId:r,className:n,width:a,label:i}=e,s=j.useRef(null),l=j.useRef(null),f=Qe(W1),d=Ra(),h=lr(),m="yAxis",x=Qe(k=>_c(k,m,r,d)),v=Qe(k=>jT(k,r)),y=Qe(k=>FB(k,r)),g=Qe(k=>TT(k,m,r,d)),b=Qe(k=>aT(k,r));if(j.useLayoutEffect(()=>{var k;if(!(a!=="auto"||!v||rb(i)||j.isValidElement(i)||b==null)){var P=s.current,D=P==null||(k=P.tickRefs)===null||k===void 0?void 0:k.current,{tickSize:R,tickMargin:G}=P.props,M=mK({ticks:D,label:l.current,labelGapWithTick:5,tickSize:R,tickMargin:G});Math.round(v.width)!==Math.round(M)&&h(rH({id:r,width:M}))}},[s,s==null||(t=s.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,v?.width,v,h,i,r,a]),v==null||y==null||b==null)return null;var{dangerouslySetInnerHTML:N,ticks:_}=e,S=Fk(e,pK),{id:C}=b,T=Fk(b,xK);return j.createElement(eo,Zv({},S,T,{ref:s,labelRef:l,scale:x,x:y.x,y:y.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:v.width,height:v.height,className:It("recharts-".concat(m," ").concat(m),n),viewBox:f,ticks:g}))},SK=e=>{var t,r,n,a,i;return j.createElement(j.Fragment,null,j.createElement(bK,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(i=e.tick)!==null&&i!==void 0?i:!0,tickFormatter:e.tickFormatter}),j.createElement(wK,e))},NK={allowDataOverflow:ea.allowDataOverflow,allowDecimals:ea.allowDecimals,allowDuplicatedCategory:ea.allowDuplicatedCategory,hide:!1,mirror:ea.mirror,orientation:ea.orientation,padding:ea.padding,reversed:ea.reversed,scale:ea.scale,tickCount:ea.tickCount,type:ea.type,width:ea.width,yAxisId:0};class xb extends j.Component{render(){return j.createElement(SK,this.props)}}$3(xb,"displayName","YAxis");$3(xb,"defaultProps",NK);var Vg={exports:{}},Kg={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dk;function EK(){if(Dk)return Kg;Dk=1;var e=pc();function t(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,l=e.useDebugValue;return Kg.useSyncExternalStoreWithSelector=function(f,d,h,m,x){var v=a(null);if(v.current===null){var y={hasValue:!1,value:null};v.current=y}else y=v.current;v=s(function(){function b(T){if(!N){if(N=!0,_=T,T=m(T),x!==void 0&&y.hasValue){var k=y.value;if(x(k,T))return S=k}return S=T}if(k=S,r(_,T))return k;var P=m(T);return x!==void 0&&x(k,P)?(_=T,k):(_=T,S=P)}var N=!1,_,S,C=h===void 0?null:h;return[function(){return b(d())},C===null?void 0:function(){return b(C())}]},[d,h,m,x]);var g=n(f,v[0],v[1]);return i(function(){y.hasValue=!0,y.value=g},[g]),l(g),g},Kg}var Ik;function _K(){return Ik||(Ik=1,Vg.exports=EK()),Vg.exports}_K();function kK(e){e()}function jK(){let e=null,t=null;return{clear(){e=null,t=null},notify(){kK(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var Mk={notify(){},get:()=>[]};function CK(e,t){let r,n=Mk,a=0,i=!1;function s(g){h();const b=n.subscribe(g);let N=!1;return()=>{N||(N=!0,b(),m())}}function l(){n.notify()}function f(){y.onStateChange&&y.onStateChange()}function d(){return i}function h(){a++,r||(r=e.subscribe(f),n=jK())}function m(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Mk)}function x(){i||(i=!0,h())}function v(){i&&(i=!1,m())}const y={addNestedSub:s,notifyNestedSubs:l,handleChangeWrapper:f,isSubscribed:d,trySubscribe:x,tryUnsubscribe:v,getListeners:()=>n};return y}var AK=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TK=AK(),PK=()=>typeof navigator<"u"&&navigator.product==="ReactNative",OK=PK(),FK=()=>TK||OK?j.useLayoutEffect:j.useEffect,DK=FK(),IK=Symbol.for("react-redux-context"),MK=typeof globalThis<"u"?globalThis:{};function RK(){if(!j.createContext)return{};const e=MK[IK]??=new Map;let t=e.get(j.createContext);return t||(t=j.createContext(null),e.set(j.createContext,t)),t}var LK=RK();function BK(e){const{children:t,context:r,serverState:n,store:a}=e,i=j.useMemo(()=>{const f=CK(a);return{store:a,subscription:f,getServerState:n?()=>n:void 0}},[a,n]),s=j.useMemo(()=>a.getState(),[a]);DK(()=>{const{subscription:f}=i;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),s!==a.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[i,s]);const l=r||LK;return j.createElement(l.Provider,{value:i},t)}var $K=BK,UK=(e,t)=>t,gb=Ne([UK,kt,eT,Rr,VT,as,R$,Ir],z$),vb=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},U3=Da("mouseClick"),z3=_f();z3.startListening({actionCreator:U3,effect:(e,t)=>{var r=e.payload,n=gb(t.getState(),vb(r));n?.activeIndex!=null&&t.dispatch(KB({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var e1=Da("mouseMove"),W3=_f();W3.startListening({actionCreator:e1,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Gy(n,n.tooltip.settings.shared),i=gb(n,vb(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(LT({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(RT()))}});function zK(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var Rk={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},H3=ha({name:"rootProps",initialState:Rk,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:Rk.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),WK=H3.reducer,{updateOptions:HK}=H3.actions,V3=ha({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:VK}=V3.actions,KK=V3.reducer,K3=Da("keyDown"),G3=Da("focus"),yb=_f();yb.startListening({actionCreator:K3,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(qy(a,jc(r))),l=as(r);if(i==="Enter"){var f=dh(r,"axis","hover",String(a.index));t.dispatch(Kv({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:f}));return}var d=RB(r),h=d==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,x=s+m*h;if(!(l==null||x>=l.length||x<0)){var v=dh(r,"axis","hover",String(x));t.dispatch(Kv({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:v}))}}}}});yb.startListening({actionCreator:G3,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=dh(r,"axis","hover",String(i));t.dispatch(Kv({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var Ea=Da("externalEvent"),q3=_f();q3.startListening({actionCreator:Ea,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:C$(r),activeDataKey:XT(r),activeIndex:Go(r),activeLabel:qT(r),activeTooltipIndex:Go(r),isTooltipActive:A$(r)};e.payload.handler(n,e.payload.reactEvent)}}});var GK=Ne([kc],e=>e.tooltipItemPayloads),qK=Ne([GK,Mf,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(l=>l.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),X3=Da("touchMove"),Y3=_f();Y3.startListening({actionCreator:X3,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Gy(n,n.tooltip.settings.shared);if(a==="axis"){var i=gb(n,vb({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(LT({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,l=r.touches[0],f=document.elementFromPoint(l.clientX,l.clientY);if(!f||!f.getAttribute)return;var d=f.getAttribute(MC),h=(s=f.getAttribute(RC))!==null&&s!==void 0?s:void 0,m=qK(t.getState(),d,h);t.dispatch(MT({activeDataKey:h,activeIndex:d,activeCoordinate:m}))}}});var XK=lC({brush:yV,cartesianAxis:nH,chartData:aU,errorBars:gH,graphicalItems:wW,layout:$M,legend:T8,options:Z$,polarAxis:Rz,polarOptions:KK,referenceElements:kV,rootProps:WK,tooltip:GB}),YK=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return fM({reducer:XK,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([z3.middleware,W3.middleware,yb.middleware,q3.middleware,Y3.middleware]),devTools:!!window.RECHARTS_DEV_TOOLS_ENABLED&&{serialize:{replacer:zK},name:"recharts-".concat(r)}})};function J3(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Ra(),i=j.useRef(null);if(a)return r;i.current==null&&(i.current=YK(t,n));var s=M1;return j.createElement($K,{context:s,store:i.current},r)}function Q3(e){var{layout:t,width:r,height:n,margin:a}=e,i=lr(),s=Ra();return j.useEffect(()=>{s||(i(RM(t)),i(LM({width:r,height:n})),i(MM(a)))},[i,s,t,r,n,a]),null}function Z3(e){var t=lr();return j.useEffect(()=>{t(HK(e))},[t,e]),null}var JK=["children"];function QK(e,t){if(e==null)return{};var r,n,a=ZK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yh(){return yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yh.apply(null,arguments)}var eG={width:"100%",height:"100%"},tG=j.forwardRef((e,t)=>{var r=V1(),n=K1(),a=zC();if(!ic(r)||!ic(n))return null;var{children:i,otherAttributes:s,title:l,desc:f}=e,d,h;return typeof s.tabIndex=="number"?d=s.tabIndex:d=a?0:void 0,typeof s.role=="string"?h=s.role:h=a?"application":void 0,j.createElement(j1,yh({},s,{title:l,desc:f,role:h,tabIndex:d,width:r,height:n,style:eG,ref:t}),i)}),rG=e=>{var{children:t}=e,r=Qe(Qh);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return j.createElement(j1,{width:n,height:a,x:s,y:i},t)},Lk=j.forwardRef((e,t)=>{var{children:r}=e,n=QK(e,JK),a=Ra();return a?j.createElement(rG,null,r):j.createElement(tG,yh({ref:t},n),r)});function nG(){var e=lr(),[t,r]=j.useState(null),n=Qe(p8);return j.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;fa(i)&&i!==n&&e(BM(i))}},[t,e,n]),r}function Bk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bk(Object(r),!0).forEach(function(n){iG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iG(e,t,r){return(t=sG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sG(e){var t=oG(e,"string");return typeof t=="symbol"?t:t+""}function oG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lG=j.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:l,onMouseDown:f,onMouseEnter:d,onMouseLeave:h,onMouseMove:m,onMouseUp:x,onTouchEnd:v,onTouchMove:y,onTouchStart:g,style:b,width:N}=e,_=lr(),[S,C]=j.useState(null),[T,k]=j.useState(null);hU();var P=nG(),D=j.useCallback(O=>{P(O),typeof t=="function"&&t(O),C(O),k(O)},[P,t,C,k]),R=j.useCallback(O=>{_(U3(O)),_(Ea({handler:i,reactEvent:O}))},[_,i]),G=j.useCallback(O=>{_(e1(O)),_(Ea({handler:d,reactEvent:O}))},[_,d]),M=j.useCallback(O=>{_(RT()),_(Ea({handler:h,reactEvent:O}))},[_,h]),H=j.useCallback(O=>{_(e1(O)),_(Ea({handler:m,reactEvent:O}))},[_,m]),z=j.useCallback(()=>{_(G3())},[_]),ne=j.useCallback(O=>{_(K3(O.key))},[_]),Q=j.useCallback(O=>{_(Ea({handler:s,reactEvent:O}))},[_,s]),le=j.useCallback(O=>{_(Ea({handler:l,reactEvent:O}))},[_,l]),ue=j.useCallback(O=>{_(Ea({handler:f,reactEvent:O}))},[_,f]),fe=j.useCallback(O=>{_(Ea({handler:x,reactEvent:O}))},[_,x]),K=j.useCallback(O=>{_(Ea({handler:g,reactEvent:O}))},[_,g]),me=j.useCallback(O=>{_(X3(O)),_(Ea({handler:y,reactEvent:O}))},[_,y]),J=j.useCallback(O=>{_(Ea({handler:v,reactEvent:O}))},[_,v]);return j.createElement(t3.Provider,{value:S},j.createElement(A4.Provider,{value:T},j.createElement("div",{className:It("recharts-wrapper",n),style:aG({position:"relative",cursor:"default",width:N,height:a},b),onClick:R,onContextMenu:Q,onDoubleClick:le,onFocus:z,onKeyDown:ne,onMouseDown:ue,onMouseEnter:G,onMouseLeave:M,onMouseMove:H,onMouseUp:fe,onTouchEnd:J,onTouchMove:me,onTouchStart:K,ref:D},r)))}),cG=["children","className","width","height","style","compact","title","desc"];function uG(e,t){if(e==null)return{};var r,n,a=fG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eP=j.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:i,style:s,compact:l,title:f,desc:d}=e,h=uG(e,cG),m=tl(h);return l?j.createElement(Lk,{otherAttributes:m,title:f,desc:d},r):j.createElement(lG,{className:n,style:s,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},j.createElement(Lk,{otherAttributes:m,title:f,desc:d,ref:t},j.createElement(CV,null,r)))}),dG=["width","height"];function t1(){return t1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t1.apply(null,arguments)}function hG(e,t){if(e==null)return{};var r,n,a=mG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function mG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pG={top:5,right:5,bottom:5,left:5},xG={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:pG,reverseStackOrder:!1,syncMethod:"index"},gG=j.forwardRef(function(t,r){var n,a=La(t.categoricalChartProps,xG),{width:i,height:s}=a,l=hG(a,dG);if(!ic(i)||!ic(s))return null;var{chartName:f,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:m,categoricalChartProps:x}=t,v={chartName:f,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:m,eventEmitter:void 0};return j.createElement(J3,{preloadedState:{options:v},reduxStoreName:(n=x.id)!==null&&n!==void 0?n:f},j.createElement(F3,{chartData:x.data}),j.createElement(Q3,{width:i,height:s,layout:a.layout,margin:a.margin}),j.createElement(Z3,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),j.createElement(eP,t1({},l,{width:i,height:s,ref:r})))}),vG=["axis","item"],yG=j.forwardRef((e,t)=>j.createElement(gG,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:vG,tooltipPayloadSearcher:r3,categoricalChartProps:e,ref:t}));function bG(e){var t=lr();return j.useEffect(()=>{t(VK(e))},[t,e]),null}var wG=["width","height","layout"];function r1(){return r1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r1.apply(null,arguments)}function SG(e,t){if(e==null)return{};var r,n,a=NG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function NG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var EG={top:5,right:5,bottom:5,left:5},_G={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:EG,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},kG=j.forwardRef(function(t,r){var n,a=La(t.categoricalChartProps,_G),{width:i,height:s,layout:l}=a,f=SG(a,wG);if(!ic(i)||!ic(s))return null;var{chartName:d,defaultTooltipEventType:h,validateTooltipEventTypes:m,tooltipPayloadSearcher:x}=t,v={chartName:d,defaultTooltipEventType:h,validateTooltipEventTypes:m,tooltipPayloadSearcher:x,eventEmitter:void 0};return j.createElement(J3,{preloadedState:{options:v},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:d},j.createElement(F3,{chartData:a.data}),j.createElement(Q3,{width:i,height:s,layout:l,margin:a.margin}),j.createElement(Z3,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),j.createElement(bG,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),j.createElement(eP,r1({width:i,height:s},f,{ref:r})))}),jG=["item"],CG={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},F0=j.forwardRef((e,t)=>{var r=La(e,CG);return j.createElement(kG,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:jG,tooltipPayloadSearcher:r3,categoricalChartProps:r,ref:t})});const tP=6048e5,AG=864e5,$k=Symbol.for("constructDateFrom");function zs(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&$k in e?e[$k](t):e instanceof Date?new e.constructor(t):new Date(t)}function ni(e,t){return zs(t||e,e)}let TG={};function vm(){return TG}function sf(e,t){const r=vm(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=ni(e,t?.in),i=a.getDay(),s=(i<n?7:0)+i-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function bh(e,t){return sf(e,{...t,weekStartsOn:1})}function rP(e,t){const r=ni(e,t?.in),n=r.getFullYear(),a=zs(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=bh(a),s=zs(r,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const l=bh(s);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function Uk(e){const t=ni(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function PG(e,...t){const r=zs.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function zk(e,t){const r=ni(e,t?.in);return r.setHours(0,0,0,0),r}function OG(e,t,r){const[n,a]=PG(r?.in,e,t),i=zk(n),s=zk(a),l=+i-Uk(i),f=+s-Uk(s);return Math.round((l-f)/AG)}function FG(e,t){const r=rP(e,t),n=zs(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),bh(n)}function DG(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function IG(e){return!(!DG(e)&&typeof e!="number"||isNaN(+ni(e)))}function MG(e,t){const r=ni(e,t?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const RG={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},LG=(e,t,r)=>{let n;const a=RG[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Gg(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const BG={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},$G={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},UG={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},zG={date:Gg({formats:BG,defaultWidth:"full"}),time:Gg({formats:$G,defaultWidth:"full"}),dateTime:Gg({formats:UG,defaultWidth:"full"})},WG={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},HG=(e,t,r,n)=>WG[e];function _u(e){return(t,r)=>{const n=r?.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,l=r?.width?String(r.width):s;a=e.formattingValues[l]||e.formattingValues[s]}else{const s=e.defaultWidth,l=r?.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const VG={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},KG={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},GG={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},qG={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},XG={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},YG={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},JG=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},QG={ordinalNumber:JG,era:_u({values:VG,defaultWidth:"wide"}),quarter:_u({values:KG,defaultWidth:"wide",argumentCallback:e=>e-1}),month:_u({values:GG,defaultWidth:"wide"}),day:_u({values:qG,defaultWidth:"wide"}),dayPeriod:_u({values:XG,defaultWidth:"wide",formattingValues:YG,defaultFormattingWidth:"wide"})};function ku(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(l)?eq(l,m=>m.test(s)):ZG(l,m=>m.test(s));let d;d=e.valueCallback?e.valueCallback(f):f,d=r.valueCallback?r.valueCallback(d):d;const h=t.slice(s.length);return{value:d,rest:h}}}function ZG(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function eq(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function tq(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;const l=t.slice(a.length);return{value:s,rest:l}}}const rq=/^(\d+)(th|st|nd|rd)?/i,nq=/\d+/i,aq={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},iq={any:[/^b/i,/^(a|c)/i]},sq={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},oq={any:[/1/i,/2/i,/3/i,/4/i]},lq={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},cq={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},uq={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},fq={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},dq={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},hq={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},mq={ordinalNumber:tq({matchPattern:rq,parsePattern:nq,valueCallback:e=>parseInt(e,10)}),era:ku({matchPatterns:aq,defaultMatchWidth:"wide",parsePatterns:iq,defaultParseWidth:"any"}),quarter:ku({matchPatterns:sq,defaultMatchWidth:"wide",parsePatterns:oq,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ku({matchPatterns:lq,defaultMatchWidth:"wide",parsePatterns:cq,defaultParseWidth:"any"}),day:ku({matchPatterns:uq,defaultMatchWidth:"wide",parsePatterns:fq,defaultParseWidth:"any"}),dayPeriod:ku({matchPatterns:dq,defaultMatchWidth:"any",parsePatterns:hq,defaultParseWidth:"any"})},pq={code:"en-US",formatDistance:LG,formatLong:zG,formatRelative:HG,localize:QG,match:mq,options:{weekStartsOn:0,firstWeekContainsDate:1}};function xq(e,t){const r=ni(e,t?.in);return OG(r,MG(r))+1}function gq(e,t){const r=ni(e,t?.in),n=+bh(r)-+FG(r);return Math.round(n/tP)+1}function nP(e,t){const r=ni(e,t?.in),n=r.getFullYear(),a=vm(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=zs(t?.in||e,0);s.setFullYear(n+1,0,i),s.setHours(0,0,0,0);const l=sf(s,t),f=zs(t?.in||e,0);f.setFullYear(n,0,i),f.setHours(0,0,0,0);const d=sf(f,t);return+r>=+l?n+1:+r>=+d?n:n-1}function vq(e,t){const r=vm(),n=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,a=nP(e,t),i=zs(t?.in||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),sf(i,t)}function yq(e,t){const r=ni(e,t?.in),n=+sf(r,t)-+vq(r,t);return Math.round(n/tP)+1}function Ot(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Cs={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Ot(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Ot(r+1,2)},d(e,t){return Ot(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Ot(e.getHours()%12||12,t.length)},H(e,t){return Ot(e.getHours(),t.length)},m(e,t){return Ot(e.getMinutes(),t.length)},s(e,t){return Ot(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ot(a,t.length)}},Rl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Wk={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Cs.y(e,t)},Y:function(e,t,r,n){const a=nP(e,n),i=a>0?a:1-a;if(t==="YY"){const s=i%100;return Ot(s,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Ot(i,t.length)},R:function(e,t){const r=rP(e);return Ot(r,t.length)},u:function(e,t){const r=e.getFullYear();return Ot(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Ot(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Ot(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Cs.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Ot(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=yq(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Ot(a,t.length)},I:function(e,t,r){const n=gq(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Ot(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Cs.d(e,t)},D:function(e,t,r){const n=xq(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ot(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Ot(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Ot(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Ot(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Rl.noon:n===0?a=Rl.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Rl.evening:n>=12?a=Rl.afternoon:n>=4?a=Rl.morning:a=Rl.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Cs.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Cs.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ot(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ot(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Cs.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Cs.s(e,t)},S:function(e,t){return Cs.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Vk(n);case"XXXX":case"XX":return _o(n);case"XXXXX":case"XXX":default:return _o(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Vk(n);case"xxxx":case"xx":return _o(n);case"xxxxx":case"xxx":default:return _o(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Hk(n,":");case"OOOO":default:return"GMT"+_o(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Hk(n,":");case"zzzz":default:return"GMT"+_o(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Ot(n,t.length)},T:function(e,t,r){return Ot(+e,t.length)}};function Hk(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+Ot(i,2)}function Vk(e,t){return e%60===0?(e>0?"-":"+")+Ot(Math.abs(e)/60,2):_o(e,t)}function _o(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Ot(Math.trunc(n/60),2),i=Ot(n%60,2);return r+a+t+i}const Kk=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},aP=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},bq=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return Kk(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Kk(n,t)).replace("{{time}}",aP(a,t))},wq={p:aP,P:bq},Sq=/^D+$/,Nq=/^Y+$/,Eq=["D","DD","YY","YYYY"];function _q(e){return Sq.test(e)}function kq(e){return Nq.test(e)}function jq(e,t,r){const n=Cq(e,t,r);if(console.warn(n),Eq.includes(e))throw new RangeError(n)}function Cq(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Aq=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Tq=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Pq=/^'([^]*?)'?$/,Oq=/''/g,Fq=/[a-zA-Z]/;function Dq(e,t,r){const n=vm(),a=n.locale??pq,i=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,s=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,l=ni(e,r?.in);if(!IG(l))throw new RangeError("Invalid time value");let f=t.match(Tq).map(h=>{const m=h[0];if(m==="p"||m==="P"){const x=wq[m];return x(h,a.formatLong)}return h}).join("").match(Aq).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const m=h[0];if(m==="'")return{isToken:!1,value:Iq(h)};if(Wk[m])return{isToken:!0,value:h};if(m.match(Fq))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:h}});a.localize.preprocessor&&(f=a.localize.preprocessor(l,f));const d={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return f.map(h=>{if(!h.isToken)return h.value;const m=h.value;(kq(m)||_q(m))&&jq(m,t,String(e));const x=Wk[m[0]];return x(l,m,a.localize,d)}).join("")}function Iq(e){const t=e.match(Pq);return t?t[1].replace(Oq,"'"):e}function ym({type:e,libelle:t,classe:r,enseignant:n,hideFooter:a=!1,rightMeta:i}){const s=zo(e),l=pe.getAll("ecole")?.[0],f=l&&l.logo?l.logo:s.logo||"",d=s.logoMinistere||"",h=d&&d!==f,m=l&&l.nom?l.nom:s.etablissement||s.header,x=i?"grid grid-cols-[80px_1fr_80px] items-start gap-3 mb-1 print:mb-0":"grid grid-cols-[80px_1fr_80px] items-center gap-3 mb-1 print:mb-0";return o.jsxs("div",{className:"w-full mb-1",children:[o.jsxs("div",{className:x,children:[o.jsx("div",{className:"flex flex-col items-start",children:f?o.jsx("img",{src:f,alt:"logo",style:{maxHeight:64,width:"auto"},className:"logo-left object-contain"}):o.jsx("div",{className:"h-12 w-12 bg-gray-200 rounded flex items-center justify-center text-xs text-gray-600",children:"Logo"})}),o.jsxs("div",{className:"text-center px-1",children:[o.jsx("div",{className:"text-sm text-gray-700",children:s.pays}),o.jsx("div",{className:"font-bold text-base tracking-wider text-blue-800",children:s.ministere}),o.jsx("div",{className:"font-extrabold text-lg mt-0",children:m}),o.jsx("div",{className:"text-sm text-teal-700 mt-0 entete-libelle font-semibold",children:t||s.header}),(r||n)&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[r&&o.jsxs("span",{className:"mr-2",children:["Classe: ",r]}),n&&o.jsxs("span",{children:["Enseignant: ",n]})]}),(l||s)&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l?.adresse&&o.jsx("div",{children:l.adresse}),o.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[l?.telephone&&o.jsxs("div",{children:["Tel: ",l.telephone]}),l?.email&&o.jsxs("div",{children:["Email: ",l.email]})]})]})]}),o.jsxs("div",{className:"flex flex-col items-end",children:[i?o.jsx("div",{className:"text-right text-xs text-gray-600",children:i}):null,h?o.jsx("img",{src:d,alt:"logo-ministere",style:{maxHeight:56,width:"auto"},className:"logo-right object-contain"}):o.jsx("div",{style:{height:56,width:56}})]})]}),!a&&o.jsx("div",{className:"text-xs text-right text-gray-600 print:text-xs",children:s.footer})]})}const Gk=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(String(n.result)),n.onerror=r,n.readAsDataURL(e)});function Mq({onClose:e}){const[t,r]=j.useState(()=>Bs()),[n,a]=j.useState("eleves");function i(l){r(l),qu(l)}function s(l,f){const d={...t,[n]:{...t[n],[l]:f}};i(d)}return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-3xl w-full",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-bold",children:"Paramétrage des entêtes"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{className:"px-3 py-1 border rounded",onClick:()=>{r(Bs())},children:"Restaurer"}),o.jsx("button",{className:"px-3 py-1",onClick:e,children:"Fermer"})]})]}),o.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[o.jsx("div",{className:"col-span-3",children:o.jsxs("nav",{className:"flex flex-col gap-2",children:[o.jsx("button",{className:`text-left px-3 py-2 rounded ${n==="eleves"?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,onClick:()=>a("eleves"),children:"Élèves"}),o.jsx("button",{className:`text-left px-3 py-2 rounded ${n==="recu"?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,onClick:()=>a("recu"),children:"Reçu"}),o.jsx("button",{className:`text-left px-3 py-2 rounded ${n==="transport"?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,onClick:()=>a("transport"),children:"Transport"})]})}),o.jsxs("div",{className:"col-span-6 bg-gray-50 p-3 rounded",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Entête"}),o.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:t[n].header,onChange:l=>s("header",l.target.value)}),o.jsx("label",{className:"block text-sm text-gray-700 mt-3",children:"Pied de page"}),o.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:t[n].footer||"",onChange:l=>s("footer",l.target.value)}),o.jsx("label",{className:"block text-sm text-gray-700 mt-3",children:"Colonnes (séparées par une virgule)"}),o.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:t[n].columns.join(", "),onChange:l=>s("columns",l.target.value.split(",").map(f=>f.trim()))}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Logo principal"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async l=>{const f=l.target.files?.[0];if(f)try{const d=await Gk(f);s("logo",d)}catch{}}}),t[n].logo?o.jsx("img",{src:t[n].logo,alt:"logo",className:"h-12 mt-2"}):null]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Logo Ministère"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async l=>{const f=l.target.files?.[0];if(f)try{const d=await Gk(f);s("logoMinistere",d)}catch{}}}),t[n].logoMinistere?o.jsx("img",{src:t[n].logoMinistere,alt:"logo-min",className:"h-12 mt-2"}):null]})]}),o.jsxs("div",{className:"col-span-3",children:[o.jsx("h4",{className:"font-semibold mb-2",children:"Aperçu"}),o.jsx("div",{className:"border p-3 bg-white rounded",children:o.jsx(ym,{type:n,libelle:t[n].header})}),o.jsx("div",{className:"mt-3 flex justify-end",children:o.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded",onClick:()=>{i(t),e()},children:"Enregistrer"})})]})]})]})})}function Cc({title:e,subtitle:t,actions:r,children:n}){return o.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-extrabold text-gray-900",children:e}),t&&o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t})]}),r&&o.jsx("div",{className:"mt-4 sm:mt-0 flex items-center gap-3",children:r})]}),o.jsx("div",{className:"space-y-6",children:n})]})})}class ql{static instance;static getInstance(){return ql.instance||(ql.instance=new ql),ql.instance}cancelPayment(t,r){const n=pe.getById("paiements",t);if(!n)throw new Error("Paiement introuvable");try{const i=Number(n.avance||0);i>0&&pe.getAll("credits").filter(l=>l.eleveId===n.eleveId&&Math.abs(Number(l.montant||0)-i)<1).forEach(l=>pe.delete("credits",l.id))}catch{}const a={canceled:!0,updatedAt:new Date().toISOString()};return r&&(a.cancelNote=r),pe.update("paiements",t,a),pe.addHistorique({type:"autre",cible:"Paiement",cibleId:t,description:`Annulation du paiement ${t} de ${n.montant} FCFA${r?` — Motif: ${r}`:""}`,utilisateur:n&&n.operateur||"SYSTEM"}),!0}getSituationEcheances(t){const r=pe.getById("eleves",t);if(!r)return null;const n=pe.getById("classes",r.classeId);if(!n)return null;const a=pe.getAll("fraisScolaires").find(y=>y.niveau===n.niveau&&y.anneeScolaire===n.anneeScolaire);if(!a||!a.echeances)return null;const i=pe.getAll("paiements").filter(y=>y.eleveId===t&&!y.canceled),s=new Date,l={};i.forEach(y=>{if(y.allocations&&y.allocations.length>0)y.allocations.forEach(g=>{const b=a.echeances.find(N=>!!(N.id&&N.id===g.echeanceId||`${n.niveau}-${N.modalite}`===g.echeanceId));b&&b.modalite!=null&&(l[b.modalite]=(l[b.modalite]||0)+g.montant)});else{const g=y;let b=null;g.modalite?b=Number(g.modalite):g.typeFrais==="inscription"?b=1:g.typeFrais==="scolarite"&&g.versementIndex&&(b=Number(g.versementIndex)+1),b&&(l[b]=(l[b]||0)+y.montant)}});const f=a.echeances.map(y=>{const g=l[y.modalite||0]||0,b=Math.max(0,y.montant-g),N=new Date(y.date),_=N<s&&b>0,S=_?Math.floor((s.getTime()-N.getTime())/(1e3*60*60*24)):0;let C=`Versement ${y.modalite}`;return y.modalite===1?C="Inscription":y.modalite&&y.modalite>1&&(C=`Versement ${y.modalite-1}`),{echeanceId:y.id||`${n.niveau}-${y.modalite}`,modalite:y.modalite||0,label:y.label||C,date:y.date,montant:y.montant,montantPaye:g,montantRestant:b,isEchue:_,joursRetard:S}}),d=f.reduce((y,g)=>y+g.montant,0),h=f.reduce((y,g)=>y+g.montantPaye,0),m=f.reduce((y,g)=>y+g.montantRestant,0),x=f.filter(y=>y.isEchue),v=f.filter(y=>y.montantRestant>0&&!y.isEchue).sort((y,g)=>new Date(y.date).getTime()-new Date(g.date).getTime())[0]||null;return{eleveId:t,eleve:r,classe:n,echeances:f,totalDu:d,totalPaye:h,totalRestant:m,echeancesEchues:x,prochainEcheance:v}}getAlertesEcheances(t=12){const r=pe.getAll("eleves").filter(i=>i.statut==="Actif"),n=new Date,a=[];return r.forEach(i=>{const s=this.getSituationEcheances(i.id);if(!s)return;const l=s.echeances.filter(d=>d.montantRestant>0);if(l.length===0)return;if(l.some(d=>{const h=new Date(d.date);return Math.ceil((h.getTime()-n.getTime())/(1e3*60*60*24))<=t})){const d=l.filter(m=>{const x=new Date(m.date);return Math.ceil((x.getTime()-n.getTime())/(1e3*60*60*24))<=t}),h=d.reduce((m,x)=>m+x.montantRestant,0);a.push({eleve:i,echeances:d,totalDu:h})}}),{echeancesImpayees:a}}processPaymentIntelligent(t,r,n,a={}){const i=this.getSituationEcheances(t);if(!i)throw new Error("Impossible de calculer la situation des échéances");let s=r;const l=[],f=Array.isArray(a.selectedEcheances)?a.selectedEcheances:void 0,d=i.echeances.filter(g=>g.montantRestant>0),h=f&&f.length>0?d.filter(g=>f.includes(g.echeanceId)):d,m=[...h.filter(g=>g.isEchue).sort((g,b)=>new Date(g.date).getTime()-new Date(b.date).getTime()),...h.filter(g=>!g.isEchue).sort((g,b)=>new Date(g.date).getTime()-new Date(b.date).getTime())],x=!!i.eleve?.protege;if(x&&f&&f.length>0){if(h.find(N=>N.modalite!==1))throw new Error("Élève protégé : seules les échéances d'inscription (modalité 1) peuvent être réglées");const b=h.reduce((N,_)=>N+(_.modalite===1?_.montantRestant:0),0);if(r<b)throw new Error("Élève protégé : l'inscription doit être réglée en totalité")}else if(x&&(!f||f.length===0)){const g=i.echeances.filter(b=>b.modalite===1).reduce((b,N)=>b+N.montantRestant,0);if(r<g)throw new Error("Élève protégé : l'inscription doit être réglée en totalité")}for(const g of m){if(s<=0)break;if(g.montantRestant<=0)continue;if(g.modalite===1){if(s<g.montantRestant)throw new Error("L'inscription doit être réglée en totalité");l.push({echeanceId:g.echeanceId,montant:g.montantRestant}),s-=g.montantRestant;continue}const b=Math.min(s,g.montantRestant);l.push({echeanceId:g.echeanceId,montant:b}),s-=b}const v={eleveId:t,montant:r,datePaiement:n,typeFrais:a&&a.typeFrais||"scolarite",versementIndex:a&&a.versementIndex||void 0,modePaiement:a&&a.modePaiement||"Espèces",numeroRecu:a&&a.numeroRecu||`REC-${Date.now()}`,operateur:a&&a.operateur||"SYSTEM",notes:a&&a.notes||"",allocations:l,avance:s,updatedAt:new Date().toISOString()};return{paiement:pe.create("paiements",v),allocations:l,avance:s,situation:this.getSituationEcheances(t)}}generateConvocations(t=12){return this.getAlertesEcheances(t).echeancesImpayees.map(n=>({eleve:n.eleve,classe:pe.getById("classes",n.eleve.classeId),echeancesEchues:n.echeances,totalDu:n.totalDu,anneeScolaire:pe.getById("classes",n.eleve.classeId)?.anneeScolaire||""}))}}const la=ql.getInstance();function qg(){const[e,t]=j.useState(!1),[r,n]=j.useState(0),a=()=>{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"eleves",action:"new"}}))},i=()=>{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"finances"}})),window.dispatchEvent(new CustomEvent("open-payment-form"))},s=()=>{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"notes"}})),window.dispatchEvent(new CustomEvent("open-notes-entry"))},l=pe.getAll("eleves"),f=pe.getAll("paiements").filter(C=>!C.canceled),d=pe.getAll("fraisScolaires"),h=pe.getAll("classes"),m=pe.getAll("notes"),x=j.useMemo(()=>la.getAlertesEcheances(),[r]),v=j.useMemo(()=>l.filter(C=>!m.some(T=>T.eleveId===C.id)),[l,m,r]),y=j.useMemo(()=>{const C=l.length,T=l.filter(G=>G.statut==="Actif").length,k=f.reduce((G,M)=>G+M.montant,0),P=f.filter(G=>{const M=new Date(G.datePaiement),H=new Date;return M.getMonth()===H.getMonth()&&M.getFullYear()===H.getFullYear()}).reduce((G,M)=>G+M.montant,0),D=l.map(G=>{const M=la.getSituationEcheances(G.id);if(!M)return{eleveId:G.id,statut:"Non Payé",solde:0};if(M.eleve&&M.eleve.protege){const Q=(M.echeances||[]).filter(K=>K.modalite===1),le=Q.reduce((K,me)=>K+(me.montant||0),0),ue=Q.reduce((K,me)=>K+(me.montantPaye||0),0);let fe="Non Payé";return le>0&&ue>=le?fe="Payé":ue>0&&(fe="Partiellement Payé"),{eleveId:G.id,statut:fe,solde:le-ue}}const H=M.totalDu||0,z=M.totalPaye||0;let ne="Non Payé";return H>0&&z>=H?ne="Payé":z>0&&(ne="Partiellement Payé"),{eleveId:G.id,statut:ne,solde:H-z}}),R={soldes:D.filter(G=>G.statut==="Payé").length,partiels:D.filter(G=>G.statut==="Partiellement Payé").length,impayes:D.filter(G=>G.statut==="Non Payé").length};return{totalEleves:C,elevesActifs:T,totalRecettes:k,recettesMoisCourant:P,elevesParStatut:R}},[l,f,d,h,r]),g=j.useMemo(()=>{const C=Array.from({length:12},(T,k)=>({mois:Dq(new Date(2024,k,1),"MMM"),recettes:0}));return f.forEach(T=>{const k=new Date(T.datePaiement);if(!isNaN(k.getTime())){const P=k.getMonth();P>=0&&P<12&&(C[P].recettes+=T.montant)}}),C},[f,r]),b=[{name:"Payé",value:y.elevesParStatut.soldes,color:"#10b981"},{name:"Partiel",value:y.elevesParStatut.partiels,color:"#f59e0b"},{name:"Non Payé",value:y.elevesParStatut.impayes,color:"#ef4444"}],N=C=>new Intl.NumberFormat("fr-FR").format(C)+" FCFA",[_,S]=j.useState(null);return j.useEffect(()=>S(pe.getAll("ecole")[0]||null),[r]),j.useEffect(()=>{const C=()=>n(T=>T+1);return window.addEventListener("dataChanged",C),()=>window.removeEventListener("dataChanged",C)},[]),o.jsxs(Cc,{title:"Tableau de bord",subtitle:`Année scolaire ${_?.anneeScolaireActive||"Non configurée"}`,actions:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:a,className:"px-3 py-2 bg-teal-600 text-white rounded-md",children:"Nouvel élève"}),o.jsx("button",{onClick:i,className:"px-3 py-2 bg-gray-900 text-white rounded-md",children:"Paiement"})]}),children:[(v.length>0||(x?.echeancesEchues?.length||0)>0||(x?.echeancesProches?.length||0)>0)&&o.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(d4,{className:"h-5 w-5 text-gray-600 mt-0.5 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Alertes"}),o.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[v.length>0&&o.jsxs("p",{children:[v.length," élève(s) n'ont aucune note enregistrée."]}),x?.echeancesEchues?.length>0&&o.jsxs("p",{children:[x.echeancesEchues.length," élève(s) ont des échéances échues."]}),x?.echeancesProches?.length>0&&o.jsxs("p",{children:[x.echeancesProches.length," échéance(s) dans les 7 prochains jours."]})]})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Élèves Actifs"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:y.elevesActifs}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Total: ",y.totalEleves]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(qi,{className:"h-6 w-6 text-gray-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Recettes Totales"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:N(y.totalRecettes)}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center",children:[o.jsx(Gu,{className:"inline h-3 w-3 mr-1"}),"Ce mois: ",N(y.recettesMoisCourant)]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(gi,{className:"h-6 w-6 text-gray-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Paiements Complétés"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:y.elevesParStatut.soldes}),o.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[o.jsx(Oa,{className:"h-4 w-4 text-green-600"}),o.jsx("span",{className:"text-sm text-gray-500",children:"Frais payés"})]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(Oa,{className:"h-6 w-6 text-gray-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Non Payé"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:y.elevesParStatut.impayes}),o.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[o.jsx(ti,{className:"h-4 w-4 text-red-600"}),o.jsx("span",{className:"text-sm text-gray-500",children:"En attente"})]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(b1,{className:"h-6 w-6 text-gray-600"})})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[o.jsx(Gu,{className:"h-5 w-5 text-gray-600"})," Évolution des Recettes"]}),o.jsx(Mu,{width:"100%",height:260,children:o.jsxs(yG,{data:g,children:[o.jsx(L3,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),o.jsx(pb,{dataKey:"mois",tick:{fontSize:12}}),o.jsx(xb,{tickFormatter:C=>new Intl.NumberFormat("fr-FR",{notation:"compact"}).format(C),tick:{fontSize:12}}),o.jsx(Du,{formatter:C=>N(Number(C))}),o.jsx(P3,{dataKey:"recettes",fill:"#374151",radius:[2,2,0,0]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[o.jsx(Oa,{className:"h-5 w-5 text-gray-600"})," Situation des Paiements"]}),o.jsx(Mu,{width:"100%",height:260,children:o.jsxs(F0,{children:[o.jsx(Lu,{data:b,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",children:b.map((C,T)=>o.jsx(Bi,{fill:C.color},`cell-${T}`))}),o.jsx(Du,{})]})}),o.jsx("div",{className:"flex justify-center space-x-6 mt-4",children:b.map(C=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:C.color}})," ",o.jsxs("span",{className:"text-sm text-gray-600",children:[C.name," (",C.value,")"]})]},C.name))})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Actions Rapides"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("button",{className:"group p-6 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-left",onClick:a,children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:o.jsx(qi,{className:"h-5 w-5 text-gray-600"})})}),o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Nouvel Élève"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Inscrire un nouvel élève"})]}),o.jsxs("button",{className:"group p-6 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-left",onClick:i,children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:o.jsx(gi,{className:"h-5 w-5 text-gray-600"})})}),o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Nouveau Paiement"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Enregistrer un paiement"})]}),o.jsxs("button",{className:"group p-6 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-left",onClick:s,children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:o.jsx(Ki,{className:"h-5 w-5 text-gray-600"})})}),o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Saisir Notes"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Enregistrer les notes"})]})]})]}),e&&o.jsx(Mq,{onClose:()=>t(!1)})]})}const Rq="modulepreload",Lq=function(e,t){return new URL(e,t).href},qk={},Fi=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let d=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const s=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),f=l?.nonce||l?.getAttribute("nonce");a=d(r.map(h=>{if(h=Lq(h,n),h in qk)return;qk[h]=!0;const m=h.endsWith(".css"),x=m?'[rel="stylesheet"]':"";if(!!n)for(let g=s.length-1;g>=0;g--){const b=s[g];if(b.href===h&&(!m||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${x}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":Rq,m||(y.as="script"),y.crossOrigin="",y.href=h,f&&y.setAttribute("nonce",f),document.head.appendChild(y),m)return new Promise((g,b)=>{y.addEventListener("load",g),y.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return a.then(s=>{for(const l of s||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},Bq={primary:"bg-teal-600 text-white hover:bg-teal-700",secondary:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",ghost:"bg-transparent text-gray-700 hover:bg-gray-50",danger:"bg-red-600 text-white hover:bg-red-700"},Xk={sm:"px-2 py-1 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-base"};function ht({variant:e="primary",className:t="",children:r,leftIcon:n,rightIcon:a,size:i="md",...s}){const l=`rounded-md font-medium inline-flex items-center space-x-2 ${Xk[i]||Xk.md}`;return o.jsxs("button",{className:`${l} ${Bq[e]} ${t}`,...s,children:[n&&o.jsx("span",{className:"inline-flex mr-1",children:n}),o.jsx("span",{className:"inline-flex items-center",children:r}),a&&o.jsx("span",{className:"inline-flex ml-1",children:a})]})}function $q({onEleveSelect:e,onNewEleve:t}){const{showToast:r}=Xr(),[n,a]=j.useState([]),[i,s]=j.useState(!1),[l,f]=j.useState(""),d=oe=>{a(oe?Qr.map(ke=>ke.id):[])},h=(oe,ke)=>{a(Ke=>ke?[...Ke,oe]:Ke.filter(et=>et!==oe))},m=()=>{n.length!==0&&window.confirm(`Supprimer ${n.length} élève(s) ?`)&&(n.forEach(oe=>pe.delete("eleves",oe)),setTimeout(()=>{},100))},x=()=>{l&&(n.forEach(oe=>pe.update("eleves",oe,{classeId:l})),s(!1),a([]),setTimeout(()=>{},100))},[v,y]=j.useState(null),[g,b]=j.useState([]),[N,_]=j.useState([]),[S,C]=j.useState({matricule:"",nom:"",prenoms:"",nomPrenoms:""}),[T,k]=j.useState(""),[P,D]=j.useState(!1),[R,G]=j.useState(!1),M=j.useRef(null),H=j.useRef(null),[z,ne]=j.useState(null),[Q,le]=j.useState(!1),[ue,fe]=j.useState(null),[K,me]=j.useState(!1),J=async oe=>{const ke=oe.target.files?.[0];if(ke){console.log("handleImportExcel: file selected",ke?.name,ke?.size),y(ke);try{const et=(await Fi(()=>Promise.resolve().then(()=>Cu),void 0,import.meta.url)).importerElevesDepuisExcel;if(console.log("handleImportExcel: importer function loaded",!!et),typeof et!="function")throw new Error("Module d'import introuvable");const ze=await et(ke);if(console.log("handleImportExcel: importer result",ze&&(Array.isArray(ze)?ze.length:Object.keys(ze).length)),!ze)throw new Error("Aucune donnée retournée par l'importeur");Array.isArray(ze)?(_(ze),D(!0)):ze.columns?(b(ze.columns),_(ze.preview||[]),G(!0)):(_(ze.preview||[]),D(!0))}catch(Ke){const et=Ke instanceof Error?Ke.message:String(Ke);r("Erreur lors de l'importation: "+et,"error"),console.error("Import error:",Ke)}}},O=async()=>{if(!v)return;G(!1);const{importerElevesDepuisExcel:oe}=await Fi(async()=>{const{importerElevesDepuisExcel:Ke}=await Promise.resolve().then(()=>Cu);return{importerElevesDepuisExcel:Ke}},void 0,import.meta.url),ke=await oe(v,S);_(ke),D(!0)},ae=async()=>{if(!T){alert("Sélectionnez une classe pour l'importation.");return}const{db:oe}=await Fi(async()=>{const{db:ke}=await Promise.resolve().then(()=>O5);return{db:ke}},void 0,import.meta.url);N.forEach(ke=>{const Ke=oe.getAll("eleves").find(et=>et.matricule&&et.matricule===(ke.matricule||"")||et.nom===(ke.nom||"")&&et.prenoms===(ke.prenoms||""));if(Ke)oe.update("eleves",Ke.id,{classeId:T});else{const et=oe.generateMatricule();oe.create("eleves",{...ke,id:et,classeId:T,anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:ke.pereTuteur||"",mereTutrice:ke.mereTutrice||"",telephone:ke.telephone||"",adresse:ke.adresse||"",photo:ke.photo||"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}}),D(!1),_([]),k(""),y(null),M.current&&(M.current.value="")},ee=async()=>{const{exporterElevesEnExcel:oe}=await Fi(async()=>{const{exporterElevesEnExcel:at}=await Promise.resolve().then(()=>Cu);return{exporterElevesEnExcel:at}},void 0,import.meta.url),ke=await oe(lt),Ke=new Blob([ke],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),et=window.URL.createObjectURL(Ke),ze=document.createElement("a");ze.href=et,ze.download=`eleves_klasnet_${new Date().toISOString().split("T")[0]}.xlsx`,ze.click(),window.URL.revokeObjectURL(et)};function L(oe){try{const ke=la.getSituationEcheances(oe.id);if(!ke)return"Non défini";if(ke.eleve&&ke.eleve.protege){const ze=(ke.echeances||[]).filter(hr=>hr.modalite===1),at=ze.reduce((hr,Zr)=>hr+(Zr.montant||0),0),Sr=ze.reduce((hr,Zr)=>hr+(Zr.montantPaye||0),0);return at>0&&Sr>=at?"Payé":Sr>0&&Sr<at?"Partiel":"Impayé"}const Ke=ke.totalDu||0,et=ke.totalPaye||0;return Ke===0?"Non défini":et>=Ke?"Payé":et>0&&et<Ke?"Partiel":"Impayé"}catch(ke){return console.warn("Unable to compute financial status for",oe.id,ke),"Non défini"}}function V(oe){switch(oe){case"Payé":return"bg-green-100 text-green-800";case"Partiel":return"bg-orange-100 text-orange-800";case"Impayé":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}const[se,U]=j.useState(""),[W,X]=j.useState(""),[de,F]=j.useState(""),[Pe,Ae]=j.useState("nom"),[We,Ue]=j.useState("asc"),[,Te]=j.useState(0);j.useEffect(()=>{const oe=()=>Te(ke=>ke+1);return window.addEventListener("dataChanged",oe),()=>window.removeEventListener("dataChanged",oe)},[]);const lt=pe.getAll("eleves"),jt=pe.getAll("classes"),Yt=zo("eleves"),Ct=jt.find(oe=>oe.id===W),Ua=Ct?`${Ct.niveau} ${Ct.section||""}`.trim():"Toutes les classes",On=Ct?Ct.anneeScolaire:jt[0]?.anneeScolaire||"",Lr=`${Ua}${On?" — "+On:""} — ${Yt.header}`,rr=(()=>{if(!Ct)return["N°","Matricule","Nom & Prénom","Date de naissance","Classe"];const ke=(Array.isArray(Yt.columns)?[...Yt.columns]:[]).filter(at=>!/classe/i.test(String(at))&&!/date\s*de\s*naiss/i.test(String(at))&&!/date.*naiss/i.test(String(at))),Ke=ke.some(at=>/matricul/i.test(String(at))),et=ke.filter(at=>!(/nom/.test(String(at).toLowerCase())&&/pr/i.test(String(at).toLowerCase()))&&!/matricul/i.test(String(at))),ze=["N°"];return Ke&&ze.push("Matricule"),ze.push("Nom & Prénom"),ze.push(...et),ze.filter((at,Sr,hr)=>hr.indexOf(at)===Sr)})(),Fn=(()=>{const oe=rr.length;if(oe===0)return[];if(!Ct){if(oe===5)return["5%","10%","50%","14%","21%"];if(oe>1&&rr.findIndex(Sr=>/nom/i.test(String(Sr))&&/pr/i.test(String(Sr)))>=0){const hr=Math.floor(81/(oe-2));return["5%","14%",...Array(oe-2).fill(`${hr}%`)]}const ze=Math.floor(100/oe);return Array(oe).fill(`${ze}%`)}const ke=rr.some(ze=>/matricul/i.test(String(ze))),Ke=rr.some(ze=>/nom/i.test(String(ze))&&/pr/i.test(String(ze)));if(Ct){const ze=rr.length;if(ze===1)return["100%"];if(ze===2)return Ke?["10%","90%"]:["25%","75%"];if(ze===3)return ke&&Ke?["5%","15%","80%"]:["20%","45%","35%"];if(ze===4)return ke&&Ke?["5%","12%","45%","38%"]:["20%","45%","35%"];const at=ke?12:0,Sr=Ke?45:60,hr=5,Zr=ze-(ke&&Ke?3:2),qn=Zr>0?Math.max(4,Math.floor((100-hr-at-Sr)/Zr)):0,Dn=[];ke&&Dn.push(`${at}%`),Ke&&Dn.push(`${Sr}%`);for(let Si=0;Si<Zr;Si++)Dn.push(`${qn}%`);const In={};In["n°"]=`${hr}%`;let ao=0;return ke&&(In.matricule=Dn[ao++]),Ke&&(In["nom & prénom"]=Dn[ao++],In["nom & prénoms"]=In["nom & prénom"]),rr.map(Si=>In[String(Si).toLowerCase()]||`${qn}%`)}const et=Math.floor(100/oe);return Array(oe).fill(`${et}%`)})(),Qr=j.useMemo(()=>{let oe=[...lt];if(se){const ke=se.toLowerCase();oe=oe.filter(Ke=>Ke.nom.toLowerCase().includes(ke)||Ke.prenoms.toLowerCase().includes(ke)||Ke.matricule.toLowerCase().includes(ke)||Ke.pereTuteur.toLowerCase().includes(ke)||Ke.mereTutrice.toLowerCase().includes(ke))}return W&&(oe=oe.filter(ke=>ke.classeId===W)),de&&(oe=oe.filter(ke=>L(ke)===de)),oe.sort((ke,Ke)=>{let et=ke[Pe],ze=Ke[Pe];return(typeof et>"u"||et===null)&&(et=""),(typeof ze>"u"||ze===null)&&(ze=""),typeof et=="string"&&(et=et.toLowerCase(),ze=ze.toLowerCase()),We==="asc"?et<ze?-1:et>ze?1:0:et>ze?-1:et<ze?1:0}),oe},[lt,se,W,de,Pe,We]),nr=oe=>{Pe===oe?Ue(We==="asc"?"desc":"asc"):(Ae(oe),Ue("asc"))},En=oe=>{window.confirm(`Êtes-vous sûr de vouloir supprimer l'élève ${oe.prenoms} ${oe.nom} ?`)&&(pe.delete("eleves",oe.id),pe.addHistorique({type:"suppression",cible:"Élève",cibleId:oe.id,description:`Suppression de l'élève ${oe.prenoms} ${oe.nom}`,utilisateur:"ADMIN"}),setTimeout(()=>{},100))},ut=oe=>{const ke=jt.find(Ke=>Ke.id===oe);return ke?`${ke.niveau} ${ke.section}`:"Non assigné"},At=oe=>{switch(oe){case"Actif":return"bg-green-100 text-green-800";case"Inactif":return"bg-gray-100 text-gray-800";case"Transféré":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return o.jsxs(Cc,{title:"Gestion des Élèves",subtitle:`${Qr.length} élève(s) trouvé(s)`,actions:o.jsxs(o.Fragment,{children:[o.jsx("input",{ref:M,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:J}),o.jsxs(ht,{variant:"secondary",className:"px-3",onClick:()=>M.current?.click(),children:[o.jsx(Ls,{className:"h-4 w-4"}),o.jsx("span",{children:"Importer"})]}),o.jsxs(ht,{variant:"secondary",className:"px-3",onClick:ee,children:[o.jsx(u4,{className:"h-4 w-4"}),o.jsx("span",{children:"Exporter"})]}),o.jsx("input",{ref:H,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:async oe=>{const ke=oe.target.files?.[0];if(ke)try{const Ke=await Fi(()=>Promise.resolve().then(()=>Cu),void 0,import.meta.url);if(typeof Ke.previewImporterPaiementsDepuisExcel!="function")throw new Error("Importeur de paiements introuvable");const et=await Ke.previewImporterPaiementsDepuisExcel(ke);fe(et),me(!0)}catch(Ke){const et=Ke instanceof Error?Ke.message:String(Ke);r("Erreur import paiements: "+et,"error"),console.error(Ke)}}}),o.jsxs(ht,{variant:"secondary",className:"px-3",onClick:()=>H.current?.click(),children:[o.jsx(Ls,{className:"h-4 w-4"}),o.jsx("span",{children:"Importer paiements"})]}),o.jsxs(ht,{variant:"primary",onClick:t,children:[o.jsx(Gi,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvel Élève"})]}),o.jsxs(ht,{variant:"secondary",onClick:()=>window.print(),className:"px-3",children:[o.jsx(wf,{className:"h-4 w-4"}),o.jsx("span",{children:"Imprimer / PDF"})]}),R&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-8 relative animate-fade-in flex flex-col items-center",children:[o.jsx("h2",{className:"text-xl font-bold mb-4",children:"Sélectionnez les colonnes à importer"}),o.jsxs("div",{className:"space-y-3 w-full",children:[o.jsxs("div",{children:[o.jsx("label",{children:"Matricule :"}),o.jsxs("select",{value:S.matricule,onChange:oe=>C({...S,matricule:oe.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),g.map(oe=>o.jsx("option",{value:oe,children:oe},oe))]})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Nom :"}),o.jsxs("select",{value:S.nom,onChange:oe=>C({...S,nom:oe.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),g.map(oe=>o.jsx("option",{value:oe,children:oe},oe))]})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Prénoms :"}),o.jsxs("select",{value:S.prenoms,onChange:oe=>C({...S,prenoms:oe.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),g.map(oe=>o.jsx("option",{value:oe,children:oe},oe))]})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Noms et Prénoms (si tout est dans une seule colonne) :"}),o.jsxs("select",{value:S.nomPrenoms,onChange:oe=>C({...S,nomPrenoms:oe.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),g.map(oe=>o.jsx("option",{value:oe,children:oe},oe))]}),o.jsx("div",{className:"text-xs text-gray-500",children:"Si cette colonne est sélectionnée, le nom sera le premier mot, le reste les prénoms."})]})]}),o.jsxs("div",{className:"mt-4 flex justify-end space-x-2 w-full",children:[o.jsx("button",{className:"px-4 py-2 bg-gray-200 rounded",onClick:()=>G(!1),children:"Annuler"}),o.jsx("button",{className:"px-4 py-2 bg-teal-600 text-white rounded",onClick:O,children:"Valider"})]}),o.jsxs("div",{className:"mt-4 w-full",children:[o.jsx("h3",{className:"font-semibold mb-2",children:"Aperçu des données :"}),o.jsxs("table",{className:"w-full text-xs border",children:[o.jsx("thead",{children:o.jsx("tr",{children:g.map(oe=>o.jsx("th",{className:"border px-1",children:oe},oe))})}),o.jsx("tbody",{children:N.map((oe,ke)=>o.jsx("tr",{children:g.map((Ke,et)=>o.jsx("td",{className:"border px-1",children:oe[et]},et))},ke))})]})]})]})}),P&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-[90vw] p-8 relative animate-fade-in flex flex-col items-center",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Aperçu de l'importation"}),o.jsx("div",{className:"w-full max-h-[60vh] overflow-y-auto mb-6 border rounded-lg",children:o.jsxs("table",{className:"w-full text-sm border-collapse",children:[o.jsx("thead",{className:"bg-gray-100 sticky top-0",children:o.jsxs("tr",{className:"text-center",children:[o.jsx("th",{className:"py-2 px-3 border",children:"Matricule"}),o.jsx("th",{className:"py-2 px-3 border",children:"Nom"}),o.jsx("th",{className:"py-2 px-3 border",children:"Prénoms"})]})}),o.jsx("tbody",{children:N.map((oe,ke)=>o.jsxs("tr",{className:"text-center hover:bg-gray-50",children:[o.jsx("td",{className:"py-2 px-3 border",children:oe.matricule}),o.jsx("td",{className:"py-2 px-3 border",children:oe.nom}),o.jsx("td",{className:"py-2 px-3 border",children:oe.prenoms})]},ke))})]})}),o.jsxs("div",{className:"mb-6 w-full flex flex-col items-center",children:[o.jsx("label",{className:"font-semibold mb-2",children:"Classe d'affectation :"}),o.jsxs("select",{value:T,onChange:oe=>k(oe.target.value),className:"px-3 py-2 border rounded w-full max-w-xs",children:[o.jsx("option",{value:"",children:"Sélectionner une classe"}),jt.map(oe=>o.jsxs("option",{value:oe.id,children:[oe.niveau," ",oe.section]},oe.id))]})]}),o.jsxs("div",{className:"flex justify-end gap-4 w-full",children:[o.jsx("button",{className:"px-4 py-2 bg-gray-400 text-white rounded",onClick:()=>D(!1),children:"Annuler"}),o.jsx("button",{className:"px-4 py-2 bg-teal-600 text-white rounded font-bold",onClick:ae,children:"Valider l'importation"})]})]})}),Q&&z&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-[90vw] p-6 relative animate-fade-in",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Résultat de l'import des paiements"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{className:"border rounded p-3",children:[o.jsxs("h3",{className:"font-semibold",children:["Paiements appliqués (",z.applied.length,")"]}),o.jsx("div",{className:"mt-2 max-h-60 overflow-auto text-sm",children:o.jsxs("table",{className:"w-full text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"py-1",children:"Ligne"}),o.jsx("th",{className:"py-1",children:"Élève"}),o.jsx("th",{className:"py-1",children:"Mois"}),o.jsx("th",{className:"py-1",children:"Montant"})]})}),o.jsx("tbody",{children:z.applied.map((oe,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"py-1",children:oe.row}),o.jsx("td",{className:"py-1",children:oe.eleveId}),o.jsx("td",{className:"py-1",children:oe.month}),o.jsx("td",{className:"py-1",children:oe.montant})]},ke))})]})})]}),o.jsxs("div",{className:"border rounded p-3",children:[o.jsxs("h3",{className:"font-semibold",children:["Lignes non résolues (",z.unresolved.length,")"]}),o.jsx("div",{className:"mt-2 max-h-60 overflow-auto text-sm",children:o.jsxs("table",{className:"w-full text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"py-1",children:"Ligne"}),o.jsx("th",{className:"py-1",children:"Nom"}),o.jsx("th",{className:"py-1",children:"Classe"}),o.jsx("th",{className:"py-1",children:"Contact"})]})}),o.jsx("tbody",{children:z.unresolved.map((oe,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"py-1",children:oe.row}),o.jsx("td",{className:"py-1",children:oe.name}),o.jsx("td",{className:"py-1",children:oe.classe}),o.jsx("td",{className:"py-1",children:oe.contact||""})]},ke))})]})})]})]}),o.jsx("div",{className:"flex justify-end gap-2",children:o.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:()=>{le(!1),ne(null)},children:"Fermer"})})]})}),K&&ue&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-[95vw] p-6 relative animate-fade-in",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Aperçu des paiements détectés"}),o.jsxs("div",{className:"max-h-[55vh] overflow-auto mb-4",children:[o.jsxs("table",{className:"w-full text-sm border-collapse",children:[o.jsx("thead",{className:"bg-gray-100 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"p-2 border",children:"Ligne"}),o.jsx("th",{className:"p-2 border",children:"Élève suggéré"}),o.jsx("th",{className:"p-2 border",children:"Nom"}),o.jsx("th",{className:"p-2 border",children:"Classe"}),o.jsx("th",{className:"p-2 border",children:"Mois"}),o.jsx("th",{className:"p-2 border",children:"Montant"})]})}),o.jsx("tbody",{children:ue.proposals.map((oe,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"p-2",children:oe.row}),o.jsx("td",{className:"p-2",children:oe.match?oe.match.name:"—"}),o.jsx("td",{className:"p-2",children:oe.name}),o.jsx("td",{className:"p-2",children:oe.classe}),o.jsx("td",{className:"p-2",children:oe.month}),o.jsx("td",{className:"p-2",children:oe.montant})]},ke))})]}),o.jsxs("div",{className:"mt-4",children:[o.jsxs("h3",{className:"font-semibold",children:["Lignes non résolues (",ue.unresolved.length,")"]}),o.jsx("div",{className:"max-h-40 overflow-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"p-2 border",children:"Ligne"}),o.jsx("th",{className:"p-2 border",children:"Nom"}),o.jsx("th",{className:"p-2 border",children:"Classe"})]})}),o.jsx("tbody",{children:ue.unresolved.map((oe,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"p-2",children:oe.row}),o.jsx("td",{className:"p-2",children:oe.name}),o.jsx("td",{className:"p-2",children:oe.classe})]},ke))})]})})]})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:()=>{me(!1),fe(null)},children:"Annuler"}),o.jsx("button",{className:"px-4 py-2 bg-teal-600 text-white rounded",onClick:async()=>{try{const ke=await(await Fi(()=>Promise.resolve().then(()=>Cu),void 0,import.meta.url)).applyPaiementsDepuisProposals(ue.proposals);ne(ke),le(!0),me(!1),fe(null)}catch(oe){const ke=oe instanceof Error?oe.message:String(oe);r("Erreur lors de l'application: "+ke,"error")}},children:"Appliquer les paiements"})]})]})})]}),children:[o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher un élève...",value:se,onChange:oe=>U(oe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]}),o.jsxs("select",{value:W,onChange:oe=>X(oe.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Toutes les classes"}),jt.map(oe=>o.jsxs("option",{value:oe.id,children:[oe.niveau," ",oe.section]},oe.id))]}),o.jsxs("select",{value:de,onChange:oe=>F(oe.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Tous les statuts financiers"}),o.jsx("option",{value:"Payé",children:"Payé"}),o.jsx("option",{value:"Partiel",children:"Partiel"}),o.jsx("option",{value:"Impayé",children:"Impayé"})]}),o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:[o.jsx(b5,{className:"h-4 w-4"}),o.jsx("span",{children:"Plus de filtres"})]})]})}),o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden",children:[o.jsxs("div",{id:"print-area",className:"hidden print:block bg-white p-4 mb-4",children:[o.jsx(ym,{type:"eleves",libelle:Lr}),o.jsx("div",{className:"mb-2 overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse",style:{tableLayout:"fixed"},children:[o.jsx("colgroup",{children:rr.map((oe,ke)=>o.jsx("col",{style:{width:Fn[ke]}},ke))}),o.jsx("thead",{children:o.jsx("tr",{children:rr.map((oe,ke)=>o.jsx("th",{className:"border px-2 py-1 text-left text-sm font-medium align-top",children:oe},ke))})})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"min-w-full border-collapse",style:{tableLayout:"fixed"},children:[o.jsx("colgroup",{children:rr.map((oe,ke)=>o.jsx("col",{style:{width:Fn[ke]}},ke))}),o.jsx("tbody",{children:Qr.map((oe,ke)=>o.jsx("tr",{className:ke%2===0?"bg-white":"bg-gray-50",children:rr.map((Ke,et)=>{const ze=Ke.toLowerCase();let at="";if(Ct){if(ze==="n°")return at=ke+1,o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},et);if(ze.includes("matricul"))return at=oe.matricule||"",o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},et);if(ze.includes("nom")&&ze.includes("pr"))return at=yt(oe),o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},et);if(ze.includes("date")&&ze.includes("naiss"))return at="",o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},et)}if(!Ct&&ze==="n°")return at=ke+1,o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},et);if(ze.includes("matricul"))at=oe.matricule||"";else if(ze.includes("nom")&&ze.includes("pr"))at=yt(oe);else if(ze.includes("nom")&&!ze.includes("pr"))at=oe.nom||"";else if((ze.includes("pr")||ze.includes("prénom")||ze.includes("prenoms"))&&!ze.includes("nom"))at=oe.prenoms||"";else if(ze.includes("date")&&ze.includes("naiss"))at=oe.dateNaissance?new Date(oe.dateNaissance).toLocaleDateString("fr-FR"):"";else if(ze.includes("classe"))at=ut(oe.classeId);else if(ze.includes("sexe"))at=oe.sexe==="M"?"Masculin":"Féminin";else if(ze.includes("parent"))at=`P: ${oe.pereTuteur||""} • M: ${oe.mereTutrice||""}`;else if(ze.includes("statut financi")||ze.includes("financier"))at=L(oe);else if(/\b(?:n°|no\.?|#|num(?:ero|éro)?|numero)\b/.test(ze))at=ke+1;else{const hr=Ke.toLowerCase().replace(/\s+/g,"").replace(/&/g,"and"),Zr=Object.keys(oe).find(qn=>qn.toLowerCase()===hr);at=Zr?oe[Zr]:""}return o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},et)})},oe.id))})]}),o.jsx("div",{className:"text-xs text-right text-gray-500 mt-2",children:Yt.footer})]})]}),n.length>0&&o.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[o.jsxs("span",{className:"font-medium text-gray-700",children:[n.length," sélectionné(s)"]}),o.jsx(ht,{variant:"danger",onClick:m,children:"Supprimer"}),o.jsx(ht,{variant:"primary",onClick:()=>s(!0),children:"Changer de classe"}),o.jsx(ht,{variant:"ghost",onClick:()=>a([]),children:"Tout désélectionner"})]}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-[90vw] mx-4",children:[o.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 text-center",children:"Changement de Classe"}),o.jsxs("p",{className:"text-gray-600 text-center mt-1",children:[n.length," élève(s) sélectionné(s)"]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Nouvelle classe d'affectation"}),o.jsxs("select",{value:l,onChange:oe=>f(oe.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"Sélectionner une classe"}),jt.map(oe=>o.jsxs("option",{value:oe.id,children:[oe.niveau," ",oe.section," (",oe.anneeScolaire,")"]},oe.id))]})]}),o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsx("p",{className:"text-gray-700 text-sm",children:"⚠️ Cette action modifiera la classe de tous les élèves sélectionnés"})})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-4 mt-6 pt-6 border-t border-gray-200",children:[o.jsx(ht,{variant:"secondary",className:"w-full sm:w-auto",onClick:()=>s(!1),children:"Annuler"}),o.jsx(ht,{variant:"primary",className:"w-full sm:w-auto",onClick:x,disabled:!l,children:"Valider le Changement"})]}),o.jsxs(o.Fragment,{children:[o.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Changer la classe de ",n.length," élève(s)"]}),o.jsxs("select",{value:l,onChange:oe=>f(oe.target.value),className:"w-full mb-4 border rounded px-3 py-2",children:[o.jsx("option",{value:"",children:"Sélectionner une classe"}),jt.map(oe=>o.jsxs("option",{value:oe.id,children:[oe.niveau," ",oe.section]},oe.id))]}),o.jsxs("div",{className:"flex justify-end space-x-2 w-full",children:[o.jsx(ht,{variant:"secondary",onClick:()=>s(!1),children:"Annuler"}),o.jsx(ht,{variant:"primary",onClick:x,children:"Valider"})]})]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-2 py-3 text-center",children:o.jsx("input",{type:"checkbox",checked:n.length===Qr.length&&Qr.length>0,onChange:oe=>d(oe.target.checked)})}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"N°"}),o.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-100",onClick:()=>nr("matricule"),children:["Matricule ",Pe==="matricule"&&(We==="asc"?"↑":"↓")]}),o.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-100",onClick:()=>nr("nom"),children:["Nom et Prénoms ",Pe==="nom"&&(We==="asc"?"↑":"↓")]}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Sexe"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Date Naissance"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Classe"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Parents"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Statut"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Statut Financier"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:Qr.map((oe,ke)=>o.jsxs("tr",{className:`hover:bg-gray-50 ${n.includes(oe.id)?"bg-teal-50":""}`,children:[o.jsx("td",{className:"px-2 py-3 text-center",children:o.jsx("input",{type:"checkbox",checked:n.includes(oe.id),onChange:Ke=>h(oe.id,Ke.target.checked)})}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:ke+1}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:oe.matricule}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[oe.photo&&o.jsx("img",{src:oe.photo,alt:yt(oe),className:"h-8 w-8 rounded-full object-cover"}),o.jsx("div",{children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:yt(oe)})})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${oe.sexe==="M"?"bg-blue-100 text-blue-800":"bg-pink-100 text-pink-800"}`,children:oe.sexe==="M"?"Masculin":"Féminin"})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(oe.dateNaissance).toLocaleDateString("fr-FR")}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:ut(oe.classeId)}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:o.jsxs("div",{children:[o.jsxs("div",{className:"font-medium",children:["P: ",oe.pereTuteur]}),o.jsxs("div",{children:["M: ",oe.mereTutrice]}),oe.protege&&oe.garantId&&(()=>{const Ke=pe.getById("enseignants",oe.garantId);return Ke?o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Garant: ",yt(Ke)]}):null})()]})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${At(oe.statut)}`,children:oe.statut})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${V(L(oe))}`,children:L(oe)})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>e(oe),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Voir détails",children:o.jsx(f4,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>e(oe),className:"p-1 text-gray-600 hover:bg-gray-50 rounded",title:"Modifier",children:o.jsx($o,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>En(oe),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Supprimer",children:o.jsx(Rs,{className:"h-4 w-4"})})]})})]},oe.id))})]})})]}),Qr.length===0&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-gray-500",children:"Aucun élève trouvé"})})]})}function Bf(e,t="Vous avez des modifications non sauvegardées. Vouliez-vous quitter sans enregistrer ?"){const[r,n]=j.useState(!1),a=j.useRef(!1);a.current=!!e;const i=j.useRef(null);return j.useEffect(()=>{let d=null,h=null;try{const g=window;g.__unsavedGuards||(g.__unsavedGuards=new Set),d=()=>{try{const b=window;if(b&&b.__skipUnsavedGuards||b&&b.__forceNavigationInProgress)return!1}catch{}return!!a.current},g.__unsavedGuards.add(d),g.__unsavedAllowHandlers||(g.__unsavedAllowHandlers=new Set),h=()=>{try{a.current=!1,n(!1)}catch{}},g.__unsavedAllowHandlers.add(h);try{console.debug("[useUnsavedWarning] registered guard",{id:h&&h.toString().slice(0,40)})}catch{}}catch{}const m=g=>{if(a.current)return g.preventDefault(),g.returnValue=t,t},x=()=>{a.current&&(history.pushState(null,document.title,window.location.href),n(!0))},v=g=>{try{console.debug("[useUnsavedWarning] handleAppNavigate called, dirty=",a.current)}catch{}try{const b=window;if(b&&b.__forceNavigationInProgress){console.debug("[useUnsavedWarning] skipping due to forceNavigation flag");return}}catch{}if(a.current){try{g&&typeof g.stopImmediatePropagation=="function"&&g.stopImmediatePropagation()}catch{}i.current=g?.detail||{page:null};try{const b=window;try{console.debug("[useUnsavedWarning] calling autosave handlers")}catch{}b.__autosaveHandlers&&typeof b.__autosaveHandlers.forEach=="function"&&b.__autosaveHandlers.forEach(N=>{try{N()}catch(_){console.debug("autosave handler failed",_)}})}catch{}n(!0);try{history.pushState(null,document.title,window.location.href)}catch{}}},y=()=>{try{console.debug("[useUnsavedWarning] unsaved:allow received, running allowHandler")}catch{}try{typeof h=="function"&&h()}catch{}};return window.addEventListener("unsaved:allow",y),window.addEventListener("beforeunload",m),window.addEventListener("popstate",x),window.addEventListener("navigate",v,!0),()=>{try{window.removeEventListener("beforeunload",m),window.removeEventListener("popstate",x),window.removeEventListener("navigate",v,!0),window.removeEventListener("unsaved:allow",y)}catch{}try{const g=window;d&&g&&g.__unsavedGuards&&g.__unsavedGuards.delete(d),h&&g&&g.__unsavedAllowHandlers&&g.__unsavedAllowHandlers.delete(h)}catch{}}},[t]),{showPrompt:r,openPrompt:()=>n(!0),closePrompt:()=>n(!1),allowNavigation:()=>{n(!1),a.current=!1;const d=i.current;i.current=null,setTimeout(()=>{try{const h=window;if(h&&(h.__preventReDispatch||h.__forceNavigationInProgress)){try{console.debug("[useUnsavedWarning] skipping re-dispatch because app will handle navigation")}catch{}return}d&&d.page?window.dispatchEvent(new CustomEvent("navigate",{detail:d})):history.back()}catch(h){console.debug("allowNavigation failed",h)}},0)}}}function $f(e,t){const r=`autosave:${e}`,n=j.useRef(t);return n.current=t,j.useEffect(()=>{if(t!==void 0)try{const l=JSON.stringify(t);localStorage.setItem(r,l)}catch(l){console.debug("autosave write failed",l)}},[r,t]),j.useEffect(()=>{const l=window,f=()=>{try{const d=n.current;if(d===void 0)return;localStorage.setItem(r,JSON.stringify(d));try{console.debug("[useAutoSave] saved",r)}catch{}}catch(d){console.debug("autosave immediate write failed",d)}};l.__autosaveHandlers||(l.__autosaveHandlers=new Set),l.__autosaveHandlers.add(f);try{console.debug("[useAutoSave] registered handler",r)}catch{}return()=>{try{l.__autosaveHandlers.delete(f)}catch{}}},[r]),{load:()=>{try{const l=localStorage.getItem(r);return l?JSON.parse(l):null}catch(l){return console.debug("autosave read failed",l),null}},clear:()=>{try{localStorage.removeItem(r)}catch{}},saveNow:()=>{try{const l=n.current;if(l===void 0)return;localStorage.setItem(r,JSON.stringify(l));try{console.debug("[useAutoSave] saveNow called",r)}catch{}}catch(l){console.debug("autosave saveNow failed",l)}}}}function Uq({eleve:e,onSave:t,onCancel:r}){const{showToast:n}=Xr(),[a,i]=j.useState({matricule:"",nom:"",prenoms:"",sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:"",anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:"",adresse:"",photo:"",protege:!1,garantId:""}),[s,l]=j.useState({}),[f,d]=j.useState(!1),h=pe.getAll("classes"),m=pe.getAll("enseignants");j.useEffect(()=>{if(e){const M={matricule:e.matricule,nom:e.nom,prenoms:e.prenoms,sexe:e.sexe,dateNaissance:e.dateNaissance,lieuNaissance:e.lieuNaissance,classeId:e.classeId,anneeEntree:e.anneeEntree,statut:e.statut,pereTuteur:e.pereTuteur,mereTutrice:e.mereTutrice,telephone:e.telephone,adresse:e.adresse,photo:e.photo||"",protege:e.protege||!1,garantId:e.garantId||""};i(M),x.current=M,pe.getAll("enseignants")}else{const M=pe.generateMatricule(),H={...a,matricule:M};i(H),x.current=H}},[e]);const x=j.useRef({}),v=j.useMemo(()=>{try{return JSON.stringify(x.current||{})!==JSON.stringify(a||{})}catch{return!1}},[a]),y=Bf(v),g=e?.id?`eleve:${e.id}`:"eleve:new",{load:b,clear:N}=$f(g,a),_=j.useRef(null),[S,C]=j.useState(!1);j.useEffect(()=>{try{const M=b();M&&i(H=>({...H,...M}))}catch{}},[]);const T=()=>{try{N()}catch{}const M=window;try{M.__preventReDispatch=!0}catch{}try{y&&y.allowNavigation?y.allowNavigation():r()}finally{setTimeout(()=>{try{M.__preventReDispatch=!1}catch{}},80)}},k=()=>{y&&y.closePrompt&&y.closePrompt()},P=()=>{const M={};a.nom.trim()||(M.nom="Le nom est obligatoire"),a.prenoms.trim()||(M.prenoms="Les prénoms sont obligatoires"),a.classeId||(M.classeId="La classe est obligatoire"),a.protege&&!a.garantId&&(M.garantId="Un garant (enseignant) est requis pour un élève protégé");const H=pe.getAll("eleves");return a.matricule&&a.matricule.trim()&&H.find(ne=>ne.matricule===a.matricule&&ne.id!==e?.id)&&(M.matricule="Ce matricule existe déjà"),l(M),Object.keys(M).length===0},D=async M=>{if(M.preventDefault(),!!P()){d(!0);try{e?(pe.update("eleves",e.id,a),n("Élève mis à jour avec succès","success")):(pe.create("eleves",a),n("Élève ajouté avec succès","success"));try{N()}catch{}t()}catch{n("Erreur lors de la sauvegarde de l'élève","error")}finally{d(!1)}}},R=(M,H)=>{i(z=>({...z,[M]:H})),s[M]&&l(z=>({...z,[M]:""}))},G=M=>{const H=M.target.files?.[0];if(H){const z=new FileReader;z.onload=ne=>{i(Q=>({...Q,photo:ne.target?.result}))},z.readAsDataURL(H)}};return o.jsxs("div",{className:"p-6 max-w-5xl mx-auto",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Modifier l'élève":"Nouvel élève"}),o.jsx("p",{className:"text-gray-600 mt-1",children:e?"Modifiez les informations de l'élève":"Ajoutez un nouvel élève"})]}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",children:o.jsx(qs,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations personnelles"}),o.jsxs("div",{className:"flex items-start space-x-8",children:[o.jsxs("div",{className:"flex-shrink-0",children:[o.jsxs("div",{className:"w-32 h-32 bg-white rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center relative overflow-hidden group hover:border-gray-400 transition-colors",children:[a.photo?o.jsx("img",{src:a.photo,alt:"Photo élève",className:"w-full h-full object-cover rounded-lg"}):o.jsxs("div",{className:"text-center",children:[o.jsx(Uo,{className:"h-10 w-10 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Photo élève"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:G,className:"absolute inset-0 opacity-0 cursor-pointer"})]}),o.jsxs("button",{type:"button",className:"mt-3 w-full flex items-center justify-center px-3 py-2 text-sm bg-gray-700 text-white rounded-md hover:bg-gray-800 transition-colors",children:[o.jsx(Ls,{className:"h-4 w-4 mr-2"}),"Changer photo"]})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Matricule ",o.jsx("span",{className:"text-gray-400 text-sm",children:"(optionnel)"})]}),o.jsx("input",{type:"text",value:a.matricule,onChange:M=>R("matricule",M.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.matricule?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Généré automatiquement"}),s.matricule&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.matricule]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:M=>R("nom",M.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.nom?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Nom de famille"}),s.nom&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.nom]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Prénoms ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.prenoms,onChange:M=>R("prenoms",M.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.prenoms?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Prénoms"}),s.prenoms&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.prenoms]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Sexe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:`flex items-center justify-center p-3 border rounded-md cursor-pointer transition-all ${a.sexe==="M"?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"M",checked:a.sexe==="M",onChange:M=>R("sexe",M.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:"👦 Masculin"})]}),o.jsxs("label",{className:`flex items-center justify-center p-3 border rounded-md cursor-pointer transition-all ${a.sexe==="F"?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"F",checked:a.sexe==="F",onChange:M=>R("sexe",M.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:"👧 Féminin"})]})]})]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations scolaires"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Date de naissance ",o.jsx("span",{className:"text-gray-400 text-sm",children:"(optionnel)"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(x1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:a.dateNaissance,onChange:M=>R("dateNaissance",M.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.dateNaissance?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`})]}),s.dateNaissance&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.dateNaissance]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Lieu de naissance"}),o.jsxs("div",{className:"relative",children:[o.jsx(uv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.lieuNaissance,onChange:M=>R("lieuNaissance",M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"Ville de naissance"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Classe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:a.classeId,onChange:M=>R("classeId",M.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.classeId?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,children:[o.jsx("option",{value:"",children:"Sélectionner une classe"}),h.map(M=>o.jsxs("option",{value:M.id,children:[M.niveau," ",M.section," (",M.anneeScolaire,")"]},M.id))]}),s.classeId&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.classeId]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Année d'entrée"}),o.jsx("input",{type:"text",value:a.anneeEntree,onChange:M=>R("anneeEntree",M.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"2025"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Statut"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"Actif",label:"Actif"},{value:"Inactif",label:"Inactif"},{value:"Transféré",label:"Transféré"}].map(M=>o.jsxs("label",{className:`flex items-center justify-center p-2 border rounded-md cursor-pointer transition-all ${a.statut===M.value?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"statut",value:M.value,checked:a.statut===M.value,onChange:H=>R("statut",H.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium text-sm",children:M.label})]},M.value))})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations familiales"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Père / Tuteur"}),o.jsxs("div",{className:"relative",children:[o.jsx(qi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.pereTuteur,onChange:M=>R("pereTuteur",M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"Nom du père ou tuteur"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Mère / Tutrice"}),o.jsxs("div",{className:"relative",children:[o.jsx(qi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.mereTutrice,onChange:M=>R("mereTutrice",M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"Nom de la mère ou tutrice"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Téléphone"}),o.jsxs("div",{className:"relative",children:[o.jsx(y1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"tel",value:a.telephone,onChange:M=>R("telephone",M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"+225 XX XX XX XX XX"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Adresse"}),o.jsxs("div",{className:"relative",children:[o.jsx(uv,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),o.jsx("textarea",{value:a.adresse,onChange:M=>R("adresse",M.target.value),rows:3,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors resize-none",placeholder:"Adresse de résidence"})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statut spécial"}),o.jsx("div",{className:"flex items-center space-x-4",children:o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:a.protege,onChange:M=>R("protege",M.target.checked),className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:"Élève protégé (ne paie que l'inscription)"})]})}),a.protege&&o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Garant (enseignant)"}),o.jsxs("select",{value:a.garantId,onChange:M=>R("garantId",M.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"-- Aucun --"}),m.map(M=>o.jsx("option",{value:M.id,children:yt(M)},M.id))]})]})]})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:()=>{if(!v)return r();try{_.current={type:"cancel"},y&&y.openPrompt&&y.openPrompt()}catch{if(window.confirm("Vous avez des modifications non sauvegardées. Quitter sans enregistrer ?")){try{N()}catch{}r()}}},className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors font-medium",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 focus:ring-2 focus:ring-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:[f?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Gs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:e?f?"Sauvegarde...":"Mettre à jour l'élève":f?"Sauvegarde...":"Enregistrer l'élève"})]})]})]})]}),y&&o.jsx(gc,{open:!!y.showPrompt,onConfirm:T,onCancel:k})]})}function zq({onEnseignantSelect:e,onNewEnseignant:t}){const[r,n]=j.useState(""),[a,i]=j.useState(""),s=pe.getAll("enseignants"),l=pe.getAll("classes"),f=j.useMemo(()=>{let x=[...s];if(r){const v=r.toLowerCase();x=x.filter(y=>y.nom.toLowerCase().includes(v)||y.prenoms.toLowerCase().includes(v)||(y.specialite||"").toLowerCase().includes(v)||(y.email||"").toLowerCase().includes(v)||yt(y).toLowerCase().includes(v))}return a&&(x=x.filter(v=>v.statut===a)),x.sort((v,y)=>v.nom.localeCompare(y.nom))},[s,r,a]),d=x=>{const v=l.filter(y=>y.enseignantPrincipal===`${x.prenoms} ${x.nom}`);if(v.length>0){alert(`Impossible de supprimer cet enseignant car il est assigné à ${v.length} classe(s).`);return}window.confirm(`Êtes-vous sûr de vouloir supprimer l'enseignant ${x.prenoms} ${x.nom} ?`)&&pe.delete("enseignants",x.id)},h=x=>{switch(x){case"Actif":return"bg-green-100 text-green-800";case"Inactif":return"bg-gray-100 text-gray-800";case"Congé":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},m=x=>l.filter(v=>v.enseignantPrincipal===x);return o.jsxs(Cc,{title:"Gestion des Enseignants",subtitle:`${f.length} enseignant(s) trouvé(s)`,actions:o.jsx(o.Fragment,{children:o.jsxs(ht,{variant:"primary",onClick:t,children:[o.jsx(Gi,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvel Enseignant"})]})}),children:[o.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher un enseignant...",value:r,onChange:x=>n(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),o.jsxs("select",{value:a,onChange:x=>i(x.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"Tous les statuts"}),o.jsx("option",{value:"Actif",children:"Actif"}),o.jsx("option",{value:"Inactif",children:"Inactif"}),o.jsx("option",{value:"Congé",children:"En congé"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(x=>{const v=m(yt(x));return o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[x.photo?o.jsx("img",{src:x.photo,alt:yt(x),className:"h-12 w-12 rounded-full object-cover"}):o.jsx("div",{className:"h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center",children:o.jsx(Uo,{className:"h-6 w-6 text-gray-400"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:yt(x)}),o.jsx("p",{className:"text-sm text-gray-500",children:x.specialite})]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>e(x),className:"p-2 text-gray-600 hover:bg-gray-50 rounded",title:"Modifier",children:o.jsx($o,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>d(x),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Supprimer",children:o.jsx(Rs,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"mb-4",children:o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${h(x.statut)}`,children:x.statut})}),o.jsxs("div",{className:"space-y-2 mb-4",children:[x.telephone&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(y1,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm text-gray-600",children:x.telephone})]}),x.email&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(_5,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm text-gray-600",children:x.email})]})]}),o.jsx("div",{className:"mb-4",children:o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium",children:"Diplôme:"})," ",x.diplome]})}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Classes assignées (",v.length,")"]}),v.length>0?o.jsxs("div",{className:"flex flex-wrap gap-1",children:[v.slice(0,3).map(y=>o.jsxs("span",{className:"px-2 py-1 bg-teal-100 text-teal-800 text-xs rounded",children:[y.niveau," ",y.section]},y.id)),v.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",v.length-3]})]}):o.jsx("span",{className:"text-xs text-gray-500",children:"Aucune classe assignée"})]}),o.jsx("div",{className:"pt-4 border-t border-gray-100",children:o.jsxs("p",{className:"text-xs text-gray-500",children:["Embauché le ",new Date(x.dateEmbauche).toLocaleDateString("fr-FR")]})})]},x.id)})}),f.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Uo,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucun enseignant trouvé"}),o.jsx(ht,{variant:"primary",onClick:t,className:"mt-4",children:"Ajouter votre premier enseignant"})]})]})}function Wq({enseignant:e,onSave:t,onCancel:r}){const{showToast:n}=Xr(),[a,i]=j.useState({nom:"",prenoms:"",sexe:"M",telephone:"",adresse:"",specialite:"",diplome:"",dateEmbauche:"",statut:"Actif",salaire:0,photo:"",classesPrincipales:[],matieresEnseignees:[]}),[s,l]=j.useState({}),[f,d]=j.useState(!1);j.useEffect(()=>{e&&i({nom:e.nom,prenoms:e.prenoms,sexe:e.sexe,telephone:e.telephone,adresse:e.adresse,specialite:e.specialite,diplome:e.diplome,dateEmbauche:e.dateEmbauche,statut:e.statut,salaire:e.salaire,photo:e.photo||"",classesPrincipales:e.classesPrincipales||[],matieresEnseignees:e.matieresEnseignees||[]})},[e]);const h=()=>{const y={};return a.nom.trim()||(y.nom="Le nom est obligatoire"),a.prenoms.trim()||(y.prenoms="Les prénoms sont obligatoires"),a.specialite.trim()||(y.specialite="La spécialité est obligatoire"),a.diplome.trim()||(y.diplome="Le diplôme est obligatoire"),a.dateEmbauche||(y.dateEmbauche="La date d'embauche est obligatoire"),a.salaire<0&&(y.salaire="Le salaire doit être positif"),pe.getAll("enseignants").find(N=>N.nom.toLowerCase()===a.nom.toLowerCase()&&N.prenoms.toLowerCase()===a.prenoms.toLowerCase()&&N.id!==e?.id)&&(y.nom="Un enseignant avec ce nom et ces prénoms existe déjà"),l(y),Object.keys(y).length===0},m=async y=>{if(y.preventDefault(),!!h()){d(!0);try{e?(pe.update("enseignants",e.id,a),n("Enseignant mis à jour avec succès","success")):(pe.create("enseignants",a),n("Enseignant ajouté avec succès","success")),t()}catch{n("Erreur lors de la sauvegarde de l'enseignant","error")}finally{d(!1)}}},x=(y,g)=>{i(b=>({...b,[y]:g})),s[y]&&l(b=>({...b,[y]:""}))},v=y=>{const g=y.target.files?.[0];if(g){const b=new FileReader;b.onload=N=>{i(_=>({..._,photo:N.target?.result}))},b.readAsDataURL(g)}};return o.jsx("div",{className:"p-6 max-w-5xl mx-auto",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-8",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:o.jsx(Uo,{className:"h-8 w-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:e?"Modifier l'enseignant":"Nouvel enseignant"}),o.jsx("p",{className:"text-blue-100 mt-1",children:e?"Modifiez les informations de l'enseignant":"Ajoutez un nouvel enseignant"})]})]}),o.jsx("button",{onClick:r,className:"text-white hover:bg-white hover:bg-opacity-20 p-3 rounded-xl transition-colors",children:o.jsx(qs,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:m,className:"p-8 space-y-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-6",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[o.jsx("span",{className:"bg-blue-100 p-2 rounded-lg mr-3",children:"👤"}),"Informations personnelles"]}),o.jsxs("div",{className:"flex items-start space-x-8",children:[o.jsxs("div",{className:"flex-shrink-0",children:[o.jsxs("div",{className:"w-32 h-32 bg-white rounded-2xl border-4 border-dashed border-gray-300 flex items-center justify-center relative overflow-hidden group hover:border-blue-400 transition-colors",children:[a.photo?o.jsx("img",{src:a.photo,alt:"Photo enseignant",className:"w-full h-full object-cover rounded-xl"}):o.jsxs("div",{className:"text-center",children:[o.jsx(Uo,{className:"h-10 w-10 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Photo enseignant"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:v,className:"absolute inset-0 opacity-0 cursor-pointer"})]}),o.jsxs("button",{type:"button",className:"mt-3 w-full flex items-center justify-center px-3 py-2 text-sm bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:[o.jsx(Ls,{className:"h-4 w-4 mr-2"}),"Changer photo"]})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:y=>x("nom",y.target.value),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.nom?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Nom de famille"}),s.nom&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.nom]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Prénoms ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.prenoms,onChange:y=>x("prenoms",y.target.value),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.prenoms?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Prénoms"}),s.prenoms&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.prenoms]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Sexe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:`flex items-center justify-center p-3 border-2 rounded-xl cursor-pointer transition-all ${a.sexe==="M"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"M",checked:a.sexe==="M",onChange:y=>x("sexe",y.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:"👨 Masculin"})]}),o.jsxs("label",{className:`flex items-center justify-center p-3 border-2 rounded-xl cursor-pointer transition-all ${a.sexe==="F"?"border-pink-500 bg-pink-50 text-pink-700":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"F",checked:a.sexe==="F",onChange:y=>x("sexe",y.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:"👩 Féminin"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Téléphone"}),o.jsxs("div",{className:"relative",children:[o.jsx(y1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"tel",value:a.telephone,onChange:y=>x("telephone",y.target.value),className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all",placeholder:"+225 XX XX XX XX XX"})]})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[o.jsx("span",{className:"bg-green-100 p-2 rounded-lg mr-3",children:"🎓"}),"Informations professionnelles"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Spécialité ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(v1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.specialite,onChange:y=>x("specialite",y.target.value),className:`w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.specialite?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Ex: Instituteur, Professeur des écoles..."})]}),s.specialite&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.specialite]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Diplôme ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.diplome,onChange:y=>x("diplome",y.target.value),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.diplome?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Ex: CEAP, Licence, Master..."}),s.diplome&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.diplome]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Date d'embauche ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(x1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:a.dateEmbauche,onChange:y=>x("dateEmbauche",y.target.value),className:`w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.dateEmbauche?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`})]}),s.dateEmbauche&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.dateEmbauche]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Salaire (FCFA)"}),o.jsx("input",{type:"number",value:a.salaire,onChange:y=>x("salaire",parseInt(y.target.value)),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.salaire?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,min:"0",placeholder:"150000"}),s.salaire&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.salaire]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Statut"}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"Actif",label:"✅ Actif",color:"green"},{value:"Inactif",label:"⏸️ Inactif",color:"gray"},{value:"Congé",label:"🏖️ En congé",color:"orange"}].map(y=>o.jsxs("label",{className:`flex items-center justify-center p-3 border-2 rounded-xl cursor-pointer transition-all ${a.statut===y.value?`border-${y.color}-500 bg-${y.color}-50 text-${y.color}-700`:"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"statut",value:y.value,checked:a.statut===y.value,onChange:g=>x("statut",g.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium text-sm",children:y.label})]},y.value))})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[o.jsx("span",{className:"bg-yellow-100 p-2 rounded-lg mr-3",children:"📞"}),"Informations de contact"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Adresse"}),o.jsxs("div",{className:"relative",children:[o.jsx(uv,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),o.jsx("textarea",{value:a.adresse,onChange:y=>x("adresse",y.target.value),rows:3,className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all resize-none",placeholder:"Adresse de résidence"})]})]})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:r,className:"px-8 py-4 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors font-semibold",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-3 px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:ring-4 focus:ring-blue-100 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",disabled:f,children:[f?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Gs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:e?f?"Sauvegarde...":"Mettre à jour l'enseignant":f?"Sauvegarde...":"Enregistrer l'enseignant"})]})]})]})]})})}function wh(e,t="Aperçu",r=!0){const n=document.getElementById(e);if(n)try{const a=n.innerHTML,s=new DOMParser().parseFromString(a,"text/html");s.querySelectorAll(".no-print, button").forEach(y=>y.remove());const l=s.body.innerHTML,f=`
      <style>
        @page { 
          size: A4 portrait; 
          margin: 8mm; 
          background: white;
        }
        
        :root { 
          --page-height: 297mm; 
          --print-margin: 8mm; 
          --cut-gap: 6mm;
          --primary-blue: #1e40af;
          --primary-green: #059669;
          --accent-gold: #d97706;
          --text-dark: #1f2937;
          --text-gray: #6b7280;
          --border-light: #e5e7eb;
          --bg-light: #f9fafb;
        }
        
        html, body { 
          height: 100%; 
          margin: 0; 
          padding: 0; 
          background: white;
          font-family: 'Times New Roman', Times, serif;
          color: var(--text-dark);
          line-height: 1.4;
        }

        /* Layout containers */
        .receipt-wrapper { 
          width: 210mm; 
          margin: 0 auto; 
          box-sizing: border-box; 
          height: var(--page-height); 
        }
        
        .print-content { 
          box-sizing: border-box; 
          padding: calc(var(--print-margin) - 2mm); 
          display: block; 
          height: calc(var(--page-height)); 
        }

        /* Two-up layout improvements */
        .print-content.two-up { 
          display: flex; 
          flex-direction: column; 
          justify-content: space-between; 
          gap: var(--cut-gap); 
          page-break-after: always; 
        }
        /* Visible cut indicator for two-up double receipts */
        .print-content.two-up::before {
          content: '✂ Découper ici';
          position: absolute;
          left: 50%;
          transform: translateX(-50%);
          top: calc(50% - 10px);
          background: white;
          padding: 4px 10px;
          border-radius: 999px;
          font-weight: 700;
          color: var(--primary-blue);
          border: 1px solid rgba(0,0,0,0.06);
          z-index: 10;
        }
        
        .print-content.two-up .receipt-compact {
          /* Force each receipt to occupy exactly 50% of the printable area (minus cut gap) */
          height: calc((var(--page-height) - (var(--print-margin) * 2) - var(--cut-gap)) / 2);
          box-sizing: border-box;
          padding: 8px 12px;
          background: white;
          border: 2px solid var(--primary-blue);
          border-radius: 8px;
          box-shadow: 0 2px 8px rgba(30, 64, 175, 0.1);
          position: relative;
          overflow: hidden;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
        }

        /* Main receipt card styling */
        .receipt-compact { 
          box-sizing: border-box; 
          width: 100%; 
          max-width: 780px; 
          margin: 0 auto; 
          background: white; 
          padding: 20px 24px; 
          border-radius: 12px; 
          border: 2px solid var(--primary-blue);
          box-shadow: 0 4px 12px rgba(30, 64, 175, 0.12);
          page-break-inside: avoid; 
          break-inside: avoid; 
          display: flex; 
          flex-direction: column;
          position: relative;
          overflow: hidden;
        }

        /* Decorative elements */
        .receipt-compact::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 4px;
          background: linear-gradient(90deg, var(--primary-blue) 0%, var(--primary-green) 50%, var(--accent-gold) 100%);
        }

        .receipt-compact::after {
          content: '';
          position: absolute;
          top: 12px;
          right: 12px;
          width: 60px;
          height: 60px;
          background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-green) 100%);
          border-radius: 50%;
          opacity: 0.05;
          z-index: 0;
        }

        .receipt-compact > * {
          position: relative;
          z-index: 1;
        }

        /* Page break styling for non two-up */
        .print-content:not(.two-up) .receipt-compact:not(:last-child) { 
          page-break-after: always; 
        }
        
        .receipt-compact + .receipt-compact { 
          margin-top: 10mm; 
          border-top: 2px dashed var(--primary-blue); 
          position: relative; 
        }
        
        .receipt-compact + .receipt-compact::before { 
          content: '✂ Découper ici'; 
          position: absolute; 
          top: -8mm; 
          left: 50%; 
          transform: translateX(-50%); 
          background: white; 
          padding: 4px 16px; 
          color: var(--primary-blue); 
          font-size: 11px; 
          font-weight: 600;
          border: 1px solid var(--primary-blue);
          border-radius: 20px;
          z-index: 10;
        }

        /* Header improvements */
        .receipt-compact .entete { 
          display: flex; 
          align-items: center; 
          justify-content: center; 
          gap: 16px; 
          padding-bottom: 12px; 
          border-bottom: 2px solid var(--bg-light);
          margin-bottom: 16px;
        }
        
        .receipt-compact .entete img { 
          width: 70px; 
          height: 70px; 
          object-fit: contain; 
          border-radius: 8px;
          border: 2px solid var(--border-light);
          padding: 4px;
          background: var(--bg-light);
        }
        
        .receipt-compact .entete .entete-text { 
          text-align: center; 
          flex: 1;
        }
        
        .receipt-compact .entete .entete-text .school-name { 
          font-weight: 800; 
          font-size: 22px; 
          letter-spacing: -0.025em; 
          color: var(--primary-blue);
          text-shadow: 0 1px 2px rgba(30, 64, 175, 0.1);
          margin-bottom: 4px;
        }
        
        .receipt-compact .entete .entete-text .libelle { 
          color: var(--primary-green); 
          font-weight: 600; 
          font-size: 14px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        .receipt-compact .meta { 
          display: flex; 
          justify-content: space-between; 
          font-size: 12px; 
          color: var(--text-gray); 
          margin-top: 8px;
          padding: 8px 12px;
          background: var(--bg-light);
          border-radius: 6px;
          border-left: 3px solid var(--accent-gold);
        }

        /* Student info styling */
        .receipt-compact .student-row { 
          display: flex; 
          justify-content: space-between; 
          align-items: flex-start; 
          gap: 16px; 
          margin: 16px 0;
          padding: 12px;
          background: linear-gradient(135deg, rgba(30, 64, 175, 0.02) 0%, rgba(5, 150, 105, 0.02) 100%);
          border-radius: 8px;
          border: 1px solid var(--border-light);
        }
        
        .receipt-compact .student-row .left { 
          flex: 1;
          max-width: 65%; 
        }
        
        .receipt-compact .student-row .right { 
          text-align: right; 
          color: var(--text-dark); 
          font-weight: 700;
          font-size: 18px; /* slightly larger for amounts */
        }

        /* Title styling */
        h4 { 
          text-align: center; 
          font-size: 20px; 
          margin: 16px 0 20px; 
          font-weight: 800;
          color: var(--primary-blue);
          text-transform: uppercase;
          letter-spacing: 1px;
          position: relative;
        }

        h4::after {
          content: '';
          position: absolute;
          bottom: -6px;
          left: 50%;
          transform: translateX(-50%);
          width: 80px;
          height: 3px;
          background: linear-gradient(90deg, var(--primary-blue), var(--primary-green));
          border-radius: 2px;
        }

        /* Table improvements */
        table { 
          width: 100%; 
          border-collapse: separate;
          border-spacing: 0;
          font-size: 15px;
          margin: 16px 0;
          border-radius: 8px;
          overflow: hidden;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        thead tr { 
          background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
          color: white; 
        }
        
        th, td { 
          padding: 12px 16px; 
          border-bottom: 1px solid var(--border-light);
          vertical-align: middle;
        }
        
        th { 
          text-align: left; 
          font-weight: 700;
          font-size: 13px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        tbody tr:nth-child(even) {
          background: rgba(249, 250, 251, 0.5);
        }
        
        tbody tr:hover {
          background: rgba(30, 64, 175, 0.03);
        }
        
        td.amount, .text-right { 
          text-align: right; 
          font-weight: 700; 
          color: var(--primary-green);
          font-size: 15px;
        }

        tfoot tr {
          background: var(--bg-light);
          border-top: 2px solid var(--primary-blue);
        }

        tfoot td {
          font-weight: 900;
          font-size: 18px;
          color: var(--primary-blue);
          border-bottom: none;
        }

        /* Summary box improvements */
        .summary-box { 
          margin-top: 20px; 
          padding: 20px; 
          border-radius: 12px; 
          background: linear-gradient(135deg, rgba(30, 64, 175, 0.02) 0%, rgba(5, 150, 105, 0.02) 100%);
          border: 2px solid var(--border-light);
          border-left: 4px solid var(--primary-blue);
          page-break-inside: avoid; 
        }
        
        .summary-grid { 
          display: grid; 
          grid-template-columns: 1fr auto; 
          gap: 12px 20px; 
          align-items: center; 
        }
        
        .summary-grid .label { 
          color: var(--text-gray);
          font-weight: 500;
          font-size: 13px;
        }
        
        .summary-grid .value { 
          text-align: right; 
          font-weight: 900;
          font-size: 16px; /* bigger for clarity */
        }
        
        .summary-grid .value.secondary { 
          font-weight: 700; 
          color: var(--text-dark); 
        }
        
        .summary-grid .value.alert { 
          color: #dc2626;
        }

        /* Footer styling */
        .muted { 
          color: var(--text-gray); 
          text-align: center; 
          margin-top: 20px; 
          font-size: 11px;
          font-style: italic;
          padding-top: 12px;
          border-top: 1px solid var(--border-light);
        }

        /* Compact mode adjustments */
        .print-content.two-up .receipt-compact .entete img { 
          width: 45px; 
          height: 45px; 
        }
        
        .print-content.two-up .receipt-compact .entete .entete-text .school-name { 
          font-size: 16px; 
        }
        
        .print-content.two-up h4 { 
          font-size: 14px; 
          margin: 12px 0 16px; 
        }
        
        .print-content.two-up table { 
          font-size: 11px; 
          margin: 12px 0;
        }
        
        .print-content.two-up th, .print-content.two-up td { 
          padding: 8px 12px; 
        }
        
        .print-content.two-up .summary-box { 
          padding: 12px 16px; 
          margin-top: 12px;
        }

        .print-content.two-up .summary-grid {
          gap: 8px 16px;
        }

        .print-content.two-up .summary-grid .value {
          font-size: 13px;
        }

        /* Force compact mode */
        .force-compact .receipt-compact { 
          padding: 12px 16px; 
          border-radius: 6px; 
        }
        
        .force-compact .receipt-compact .entete img { 
          width: 35px; 
          height: 35px; 
        }
        
        .force-compact .receipt-compact .entete .entete-text .school-name { 
          font-size: 14px; 
        }
        
        .force-compact h4 { 
          font-size: 12px;
          margin: 8px 0 12px;
        }
        
        .force-compact table { 
          font-size: 10px;
          margin: 10px 0;
        }
        
        .force-compact th, .force-compact td { 
          padding: 6px 10px; 
        }
        
        .force-compact .summary-box { 
          padding: 10px 12px; 
          margin-top: 10px;
        }
        
        .force-compact .muted { 
          font-size: 9px;
          margin-top: 12px;
        }

        /* Print-specific adjustments */
        @media print {
          body { 
            -webkit-print-color-adjust: exact; 
            color-adjust: exact; 
            print-color-adjust: exact;
          }
          
          .receipt-compact { 
            box-shadow: none !important; 
            border: 2px solid var(--primary-blue) !important;
          }
          
          .receipt-wrapper { 
            padding: 0; 
          }

          /* Ensure gradients print properly */
          .receipt-compact::before,
          thead tr,
          h4::after {
            -webkit-print-color-adjust: exact;
            color-adjust: exact;
            print-color-adjust: exact;
          }
        }
      </style>
    `;let d="";if(r)try{const y=s.querySelectorAll(".receipt-compact");if(y&&y.length>0){const g=[];for(let b=0;b<y.length;b+=2){const N=y[b].outerHTML,_=y[b+1]?y[b+1].outerHTML:"";g.push(`<div class="print-content two-up">${N}${_}</div>`)}d=g.join("")}else d=`<div class="print-content two-up"><div class="receipt-compact">${l}</div><div class="receipt-compact">${l}</div></div>`}catch{d=`<div class="print-content two-up"><div class="receipt-compact">${l}</div><div class="receipt-compact">${l}</div></div>`}else d=`<div class="print-content">${l}</div>`;const x=`<!doctype html><html><head><meta charset="utf-8"/><title>${t}</title>${f}</head><body><div class="receipt-wrapper">${d}</div>${`
      <script>
        (function(){
          const TWO_UP = ${r?"true":"false"};
          function sleep(ms){return new Promise(r=>setTimeout(r,ms));}

          function mmToPx(mm){
            const div = document.createElement('div');
            div.style.position = 'absolute';
            div.style.left = '-9999px';
            div.style.height = mm + 'mm';
            document.body.appendChild(div);
            const px = div.getBoundingClientRect().height;
            document.body.removeChild(div);
            return px;
          }

          async function adjustAndPrint(){
            await sleep(200); // Allow more time for styles to load

            const pageHeightPx = mmToPx(297);
            const marginPx = mmToPx(8); // Updated margin
            const printablePx = pageHeightPx - marginPx * 2;

            const wrapper = document.querySelector('.receipt-wrapper');
            if (!wrapper){ 
              await sleep(200); 
              try{ window.print(); } catch(e){} 
              return; 
            }

            const cutGapPx = mmToPx(6); // Updated gap
            const receipts = Array.from(wrapper.querySelectorAll('.receipt-compact'));
            if (receipts.length === 0){ 
              await sleep(200); 
              try{ window.print(); } catch(e){} 
              return; 
            }

            const combinedHeight = receipts.reduce((acc, r) => acc + r.getBoundingClientRect().height, 0) + (receipts.length - 1) * cutGapPx;

            if (!TWO_UP){
              if (combinedHeight <= printablePx){ 
                await sleep(150); 
                try{ window.print(); } catch(e){} 
                return; 
              }
            } else {
              const perReceiptLimit = (printablePx - cutGapPx) / 2;
              const worst = Math.max(...receipts.map(r => r.getBoundingClientRect().height));
              if (worst <= perReceiptLimit){ 
                await sleep(150); 
                try{ window.print(); } catch(e){} 
                return; 
              }
            }

            let targetScale = 1;
            if (!TWO_UP){
              targetScale = Math.min(1, printablePx / combinedHeight);
            } else {
              const worst = Math.max(...receipts.map(r => r.getBoundingClientRect().height));
              const perReceiptLimit = (printablePx - cutGapPx) / 2;
              targetScale = Math.min(1, perReceiptLimit / worst);
            }

            const MIN_SCALE = 0.35; // Slightly higher minimum for better readability
            targetScale = Math.max(MIN_SCALE, targetScale);

            if (targetScale < 0.8){
              try{
                const outer = document.querySelector('.receipt-wrapper');
                if (outer && !outer.classList.contains('force-compact')){
                  outer.classList.add('force-compact');
                  await sleep(100);
                  
                  const receiptsAfterCompact = Array.from(outer.querySelectorAll('.receipt-compact'));
                  const worstAfter = Math.max(...receiptsAfterCompact.map(r => r.getBoundingClientRect().height));
                  const newPerLimit = (printablePx - cutGapPx) / 2;
                  
                  if (!TWO_UP){
                    const combinedAfter = receiptsAfterCompact.reduce((acc, r) => acc + r.getBoundingClientRect().height, 0) + (receiptsAfterCompact.length - 1) * cutGapPx;
                    targetScale = Math.min(1, printablePx / combinedAfter);
                  } else {
                    targetScale = Math.min(1, newPerLimit / worstAfter);
                  }
                  targetScale = Math.max(MIN_SCALE, targetScale);
                }
              } catch(e) { /* ignore */ }
            }

            // Smooth scaling with better progression
            document.body.style.transformOrigin = 'top left';
            const steps = 8;
            for (let i = 0; i < steps; i++){
              const progress = (i + 1) / steps;
              const easeProgress = 1 - Math.pow(1 - progress, 3); // Ease out cubic
              const s = 1 - ((1 - targetScale) * easeProgress);
              document.body.style.transform = 'scale(' + s + ')';
              await sleep(30);
            }

            // Final adjustments for two-up fallback
            const afterWorst = Math.max(...receipts.map(r => r.getBoundingClientRect().height * targetScale));
            if (TWO_UP){
              const perReceiptLimit = (printablePx - cutGapPx) / 2;
              if (afterWorst > perReceiptLimit + 2){
                try{
                  const newWrapper = document.createElement('div');
                  newWrapper.className = 'receipt-wrapper';
                  const content = document.createElement('div');
                  content.className = 'print-content';
                  
                  receipts.forEach((r, idx) => {
                    const c = document.createElement('div');
                    c.className = 'receipt-compact';
                    c.innerHTML = r.innerHTML;
                    content.appendChild(c);
                    if (idx < receipts.length - 1){
                      const br = document.createElement('div');
                      br.style.pageBreakAfter = 'always';
                      content.appendChild(br);
                    }
                  });
                  
                  newWrapper.appendChild(content);
                  document.body.innerHTML = '';
                  document.body.appendChild(newWrapper);
                  document.body.style.transform = '';
                } catch (e) { /* ignore */ }
              }
            }

            await sleep(200);
            try{ window.print(); } catch(e){}
          }

          adjustAndPrint();
        })();
      <\/script>
    `}</body></html>`,v=window.open("","_blank");if(!v)return;v.document.open(),v.document.write(x),v.document.close(),v.focus(),setTimeout(()=>{try{v.print()}catch{}},400)}catch{const i=document.getElementById(e);if(!i)return;const s=window.open("","_blank");if(!s)return;s.document.open(),s.document.write("<html><head><title>"+t+"</title></head><body>"+i.innerHTML+"</body></html>"),s.document.close(),s.print()}}function Hq({onClasseSelect:e,onNewClasse:t}){const r=()=>wh("classes-print-area","Liste des classes",!1),{showToast:n}=Xr(),a=pe.getAll("classes"),[i,s]=j.useState(!1),[l,f]=j.useState(a),[d,h]=j.useState(""),[m,x]=j.useState(""),v=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"],y=pe.getAll("enseignants"),g=pe.getAll("eleves"),b=j.useMemo(()=>{let C=[...l];if(d){const k=d.toLowerCase();C=C.filter(P=>P.niveau.toLowerCase().includes(k)||P.section.toLowerCase().includes(k)||P.enseignantPrincipal.toLowerCase().includes(k)||P.salle.toLowerCase().includes(k))}m&&(C=C.filter(k=>k.niveau===m));const T=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];return C.sort((k,P)=>{const D=T.indexOf(k.niveau),R=T.indexOf(P.niveau);return D!==R?D-R:k.section.localeCompare(P.section)})},[a,d,m]),N=C=>{s(!0);const T=g.filter(k=>k.classeId===C.id);if(T.length>0){n(`Impossible de supprimer cette classe car elle contient ${T.length} élève(s).`,"error"),s(!1);return}window.confirm(`Êtes-vous sûr de vouloir supprimer la classe ${C.niveau} ${C.section} ?`)&&(pe.delete("classes",C.id),f(l.filter(k=>k.id!==C.id)),n("Classe supprimée avec succès","success")),s(!1)},_=C=>g.filter(T=>T.classeId===C&&T.statut==="Actif").length,S=C=>{const T=y.find(k=>yt(k)===C||T0(k)===C||`${k.prenoms} ${k.nom}`===C);return T?yt(T):C};return o.jsxs(Cc,{title:"Gestion des Classes",subtitle:`${b.length} classe(s) trouvée(s)`,actions:o.jsxs(o.Fragment,{children:[o.jsx(ht,{variant:"secondary",onClick:r,children:"Aperçu & Impression"}),o.jsxs(ht,{variant:"primary",onClick:t,children:[o.jsx(Gi,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvelle Classe"})]})]}),children:[i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsxs("svg",{className:"animate-spin h-10 w-10 text-teal-600 mb-4",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),o.jsx("span",{className:"text-white text-lg font-semibold",children:"Chargement..."})]})}),o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher une classe...",value:d,onChange:C=>h(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]}),o.jsxs("select",{value:m,onChange:C=>x(C.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Tous les niveaux"}),v.map(C=>o.jsx("option",{value:C,children:C},C))]})]})}),o.jsxs("div",{id:"print-area",className:"hidden print:block bg-white p-4 mb-4 print-compact",children:[o.jsx(ym,{type:"eleves",libelle:"Liste des classes"}),o.jsx("div",{className:"mb-2 overflow-x-auto",children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px",tableLayout:"fixed"},children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"6%"}}),o.jsx("col",{style:{width:"18%"}}),o.jsx("col",{style:{width:"12%"}}),o.jsx("col",{style:{width:"14%"}}),o.jsx("col",{style:{width:"24%"}}),o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"16%"}})]}),o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"border px-2 py-1",children:"N°"}),o.jsx("th",{className:"border px-2 py-1",children:"Niveau"}),o.jsx("th",{className:"border px-2 py-1",children:"Section"}),o.jsx("th",{className:"border px-2 py-1",children:"Année scolaire"}),o.jsx("th",{className:"border px-2 py-1",children:"Enseignant principal"}),o.jsx("th",{className:"border px-2 py-1",children:"Effectif max"}),o.jsx("th",{className:"border px-2 py-1",children:"Effectif actuel"})]})})]})}),o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px",tableLayout:"fixed"},children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"6%"}}),o.jsx("col",{style:{width:"18%"}}),o.jsx("col",{style:{width:"12%"}}),o.jsx("col",{style:{width:"14%"}}),o.jsx("col",{style:{width:"24%"}}),o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"16%"}})]}),o.jsx("tbody",{children:b.map((C,T)=>o.jsxs("tr",{children:[o.jsx("td",{children:T+1}),o.jsx("td",{children:C.niveau}),o.jsx("td",{children:C.section}),o.jsx("td",{children:C.anneeScolaire}),o.jsx("td",{children:S(C.enseignantPrincipal)}),o.jsx("td",{children:C.effectifMax}),o.jsx("td",{children:_(C.id)})]},C.id))})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(C=>{const T=_(C.id),k=T/C.effectifMax*100;return o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:[C.niveau," ",C.section]}),o.jsx("p",{className:"text-sm text-gray-500",children:C.anneeScolaire})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(ht,{variant:"ghost",className:"p-2",onClick:()=>e(C),title:"Modifier",children:o.jsx($o,{className:"h-4 w-4"})}),o.jsx(ht,{variant:"danger",className:"p-2",onClick:()=>N(C),title:"Supprimer",children:o.jsx(Rs,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(qi,{className:"h-4 w-4 text-gray-400"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Enseignant: ",S(C.enseignantPrincipal)]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ki,{className:"h-4 w-4 text-gray-400"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Salle: ",C.salle]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-1",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Effectif"}),o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[T,"/",C.effectifMax]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded h-2",children:o.jsx("div",{className:`h-2 rounded ${k>=90?"bg-red-500":k>=75?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.min(k,100)}%`}})}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[k.toFixed(0),"% de remplissage"]})]}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[C.matieres.length," matière(s)"]}),o.jsxs("div",{className:"flex flex-wrap gap-1",children:[C.matieres.slice(0,3).map(P=>o.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:P.nom},P.id)),C.matieres.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs rounded",children:["+",C.matieres.length-3]})]})]})]})]},C.id)})}),b.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("p",{className:"text-gray-500",children:"Aucune classe trouvée"}),o.jsx(ht,{variant:"primary",onClick:t,className:"mt-4",children:"Créer une classe"})]})]})}function Vq({classe:e,onSave:t,onCancel:r}){const[n,a]=j.useState({niveau:"CP1",section:"A",anneeScolaire:new Date().getFullYear()+"-"+(new Date().getFullYear()+1),enseignantPrincipal:"",effectifMax:35,salle:""}),{showToast:i}=Xr(),[s,l]=j.useState([]),[f,d]=j.useState({}),[h,m]=j.useState(!1),x=pe.getAll("matieres"),v=pe.getAll("enseignants");j.useEffect(()=>{e&&(a({niveau:e.niveau,section:e.section,anneeScolaire:e.anneeScolaire,enseignantPrincipal:e.enseignantPrincipal,effectifMax:e.effectifMax,salle:e.salle}),l(e.matieres))},[e]);const y=()=>{const S={};return n.niveau||(S.niveau="Le niveau est obligatoire"),n.section.trim()||(S.section="La section est obligatoire"),n.anneeScolaire.trim()||(S.anneeScolaire="L'année scolaire est obligatoire"),n.enseignantPrincipal.trim()||(S.enseignantPrincipal="L'enseignant principal est obligatoire"),(n.effectifMax<1||n.effectifMax>50)&&(S.effectifMax="L'effectif maximum doit être entre 1 et 50"),n.salle.trim()||(S.salle="La salle est obligatoire"),s.length===0&&(S.matieres="Au moins une matière doit être sélectionnée"),pe.getAll("classes").find(k=>k.niveau===n.niveau&&k.section===n.section&&k.anneeScolaire===n.anneeScolaire&&k.id!==e?.id)&&(S.section="Cette classe existe déjà pour cette année scolaire"),d(S),Object.keys(S).length===0},g=async S=>{if(S.preventDefault(),!!y()){m(!0);try{const C=new Date().toISOString(),T={...n,matieres:s,updatedAt:C,...e?{}:{createdAt:C}};if(e){const k=pe.update("classes",e.id,T);k&&(i("Classe mise à jour avec succès","success"),t(k))}else{const k=pe.create("classes",T);i("Classe ajoutée avec succès","success"),t(k)}}catch{i("Erreur lors de la sauvegarde de la classe","error")}finally{m(!1)}}},b=(S,C)=>{a(T=>({...T,[S]:C})),f[S]&&d(T=>({...T,[S]:""}))},N=S=>{l(C=>C.find(k=>k.id===S.id)?C.filter(k=>k.id!==S.id):[...C,S]),f.matieres&&d(C=>({...C,matieres:""}))},_=S=>x.filter(C=>C.type===S);return o.jsx("div",{className:"p-6 max-w-5xl mx-auto",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Modifier la classe":"Nouvelle classe"}),o.jsx("p",{className:"text-gray-600 mt-1",children:e?"Modifiez les informations de la classe":"Créez une nouvelle classe"})]}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",children:o.jsx(qs,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:g,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de base"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Niveau ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:n.niveau,onChange:S=>b("niveau",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.niveau?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,children:[o.jsx("option",{value:"Petite Section",children:"Petite Section"}),o.jsx("option",{value:"Moyenne Section",children:"Moyenne Section"}),o.jsx("option",{value:"Grande Section",children:"Grande Section"}),o.jsx("option",{value:"CP1",children:"CP1"}),o.jsx("option",{value:"CP2",children:"CP2"}),o.jsx("option",{value:"CE1",children:"CE1"}),o.jsx("option",{value:"CE2",children:"CE2"}),o.jsx("option",{value:"CM1",children:"CM1"}),o.jsx("option",{value:"CM2",children:"CM2"})]}),f.niveau&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),f.niveau]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Section ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.section,onChange:S=>b("section",S.target.value.toUpperCase()),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.section?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"A, B, C...",maxLength:2}),f.section&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),f.section]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Année scolaire ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.anneeScolaire,onChange:S=>b("anneeScolaire",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.anneeScolaire?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"2025-2026"}),f.anneeScolaire&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),f.anneeScolaire]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gestion et organisation"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Enseignant principal ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:n.enseignantPrincipal,onChange:S=>b("enseignantPrincipal",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.enseignantPrincipal?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,children:[o.jsx("option",{value:"",children:"Sélectionner un enseignant"}),v.filter(S=>S.statut==="Actif").map(S=>o.jsx("option",{value:yt(S),children:yt(S)},S.id))]}),f.enseignantPrincipal&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),f.enseignantPrincipal]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Effectif maximum ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",value:n.effectifMax,onChange:S=>b("effectifMax",parseInt(S.target.value)),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.effectifMax?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,min:"1",max:"50"}),f.effectifMax&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),f.effectifMax]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Salle de classe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.salle,onChange:S=>b("salle",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.salle?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Ex: Salle 1, Salle A..."}),f.salle&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),f.salle]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Matières enseignées ",o.jsx("span",{className:"text-red-500",children:"*"})]}),f.matieres&&o.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:o.jsxs("p",{className:"text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-2",children:"⚠️"}),f.matieres]})}),o.jsx("div",{className:"space-y-8",children:["Fondamentale","Éveil","Expression"].map(S=>o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:S}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:_(S).map(C=>{const T=s.find(k=>k.id===C.id);return o.jsxs("label",{className:`flex items-center p-3 border rounded-md cursor-pointer transition-all ${T?"border-gray-900 bg-gray-50":"border-gray-300 hover:border-gray-400 bg-white"}`,children:[o.jsx("input",{type:"checkbox",checked:!!T,onChange:()=>N(C),className:"sr-only"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-gray-900",children:C.nom}),o.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Coefficient: ",C.coefficient,C.obligatoire&&o.jsx("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 text-gray-700 text-xs rounded",children:"Obligatoire"})]})]}),T&&o.jsx("div",{className:"w-6 h-6 bg-gray-900 rounded-full flex items-center justify-center ml-3",children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},C.id)})})]},S))}),o.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-md border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[s.length," matière(s) sélectionnée(s)"]}),o.jsxs("p",{className:"text-gray-700 mt-1",children:["Coefficient total: ",s.reduce((S,C)=>S+C.coefficient,0)]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.length}),o.jsx("p",{className:"text-gray-600 text-sm",children:"matières"})]})]})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors font-medium",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 focus:ring-2 focus:ring-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:h,children:[h?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Gs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:e?h?"Sauvegarde...":"Mettre à jour la classe":h?"Sauvegarde...":"Créer la classe"})]})]})]})]})})}function Kq({onMatiereSelect:e,onNewMatiere:t}){const{showToast:r}=Xr(),[n,a]=j.useState(!1),[i,s]=j.useState(""),[l,f]=j.useState(""),d=pe.getAll("matieres"),h=pe.getAll("classes"),[m,x]=j.useState(d),v=j.useMemo(()=>{let N=[...m];if(i){const _=i.toLowerCase();N=N.filter(S=>S.nom.toLowerCase().includes(_)||S.type.toLowerCase().includes(_))}return l&&(N=N.filter(_=>_.type===l)),N.sort((_,S)=>_.nom.localeCompare(S.nom))},[m,i,l]),y=N=>{a(!0);const _=h.filter(S=>S.matieres.some(C=>C.id===N.id));if(_.length>0){r(`Impossible de supprimer cette matière car elle est utilisée dans ${_.length} classe(s).`,"error"),a(!1);return}window.confirm(`Êtes-vous sûr de vouloir supprimer la matière "${N.nom}" ?`)&&(pe.delete("matieres",N.id),x(m.filter(S=>S.id!==N.id)),r("Matière supprimée avec succès","success")),a(!1)},g=N=>{switch(N){case"Fondamentale":return"bg-blue-100 text-blue-800";case"Éveil":return"bg-green-100 text-green-800";case"Expression":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},b=N=>h.filter(_=>_.matieres.some(S=>S.id===N));return o.jsxs(Cc,{title:"Gestion des Matières",subtitle:`${v.length} matière(s) trouvée(s)`,actions:o.jsx(o.Fragment,{children:o.jsxs(ht,{variant:"primary",onClick:t,children:[o.jsx(Gi,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvelle Matière"})]})}),children:[n&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsxs("svg",{className:"animate-spin h-10 w-10 text-teal-600 mb-4",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),o.jsx("span",{className:"text-white text-lg font-semibold",children:"Chargement..."})]})}),o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher une matière...",value:i,onChange:N=>s(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]}),o.jsxs("select",{value:l,onChange:N=>f(N.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Tous les types"}),o.jsx("option",{value:"Fondamentale",children:"Fondamentale"}),o.jsx("option",{value:"Éveil",children:"Éveil"}),o.jsx("option",{value:"Expression",children:"Expression"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(N=>{const _=b(N.id);return o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ki,{className:"h-4 w-4 text-gray-600"}),o.jsx("h3",{className:"text-base font-semibold text-gray-900",children:N.nom})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(ht,{variant:"ghost",className:"p-2",onClick:()=>e(N),title:"Modifier",children:o.jsx($o,{className:"h-4 w-4"})}),o.jsx(ht,{variant:"danger",className:"p-2",onClick:()=>y(N),title:"Supprimer",children:o.jsx(Rs,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${g(N.type)}`,children:N.type}),N.obligatoire&&o.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Obligatoire"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Coefficient:"}),o.jsx("span",{className:"text-lg font-bold text-gray-900",children:N.coefficient})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Abréviation:"}),o.jsx("span",{className:"text-sm font-bold text-gray-900 bg-gray-100 px-2 py-1 rounded",children:N.abreviation})]}),o.jsxs("div",{children:[o.jsxs("span",{className:"text-sm text-gray-600",children:["Utilisée dans ",_.length," classe(s)"]}),_.length>0&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[_.slice(0,3).map(S=>o.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded",children:[S.niveau," ",S.section]},S.id)),_.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs rounded",children:["+",_.length-3]})]})]}),o.jsx("div",{className:"pt-2 border-t border-gray-100",children:o.jsxs("p",{className:"text-xs text-gray-500",children:["Créée le ",new Date(N.createdAt).toLocaleDateString("fr-FR")]})})]})]},N.id)})}),v.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Ki,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucune matière trouvée"}),o.jsx(ht,{variant:"primary",onClick:t,className:"mt-4",children:"Créer votre première matière"})]})]})}function Gq({matiere:e,onSave:t,onCancel:r}){const{showToast:n}=Xr(),[a,i]=j.useState({nom:"",abreviation:"",coefficient:1,type:"Fondamentale",obligatoire:!0,classeIds:[],baremeParNiveau:{}}),[s,l]=j.useState({}),[f,d]=j.useState(!1),[h,m]=j.useState("CP1"),x=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];j.useEffect(()=>{if(e){const k={nom:e.nom,abreviation:e.abreviation,coefficient:e.coefficient,type:e.type,obligatoire:e.obligatoire,classeIds:e.classeIds||[],baremeParNiveau:e.baremeParNiveau||{}};i(k),v.current=k}},[e]);const v=j.useRef({}),y=j.useMemo(()=>{try{return JSON.stringify(v.current||{})!==JSON.stringify(a||{})}catch{return!1}},[a]),g=Bf(y),b=`matiere:${e?.id||"new"}`,{load:N,clear:_}=$f(b,a);j.useEffect(()=>{try{const k=N();k&&(i(P=>({...P,...k})),v.current=JSON.parse(JSON.stringify(k||{})))}catch{}},[]);const S=()=>{const k={};a.nom.trim()||(k.nom="Le nom de la matière est obligatoire"),a.abreviation.trim()||(k.abreviation="L'abréviation est obligatoire"),(a.coefficient<1||a.coefficient>10)&&(k.coefficient="Le coefficient doit être entre 1 et 10");const P=pe.getAll("matieres");return P.find(G=>{const M=(G.nom||"").toString().toLowerCase(),H=(a.nom||"").toString().toLowerCase();return M===H&&G.id!==e?.id})&&(k.nom="Une matière avec ce nom existe déjà"),P.find(G=>{const M=(G.abreviation||"").toString().toLowerCase(),H=(a.abreviation||"").toString().toLowerCase();return M===H&&G.id!==e?.id})&&(k.abreviation="Une matière avec cette abréviation existe déjà"),l(k),Object.keys(k).length===0},C=async k=>{if(k.preventDefault(),!!S()){d(!0);try{if(e){const P=pe.update("matieres",e.id,a);if(P){n("Matière mise à jour avec succès","success"),t(P);try{_()}catch{}v.current=JSON.parse(JSON.stringify(a||{}))}}else{const P=new Date().toISOString(),D={...a,updatedAt:P},R=pe.create("matieres",D);n("Matière ajoutée avec succès","success"),t(R);try{_()}catch{}v.current=JSON.parse(JSON.stringify(a||{}))}}catch{n("Erreur lors de la sauvegarde de la matière","error")}finally{d(!1)}}},T=(k,P)=>{i(D=>({...D,[k]:P})),s[k]&&l(D=>({...D,[k]:""}))};return o.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Modifier la matière":"Nouvelle matière"}),o.jsx("p",{className:"text-gray-600 mt-1",children:e?"Modifiez les informations de la matière":"Créez une nouvelle matière"})]}),o.jsx("button",{onClick:()=>y&&g?g.openPrompt():r(),className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",children:o.jsx(qs,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:C,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de base"}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom de la matière ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:k=>T("nom",k.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.nom?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Ex: Mathématiques, Français, Sciences..."}),s.nom&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.nom]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Abréviation ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.abreviation,onChange:k=>T("abreviation",k.target.value.toUpperCase()),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.abreviation?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Ex: MATH, FR, AEM...",maxLength:10}),s.abreviation&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.abreviation]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Abréviation utilisée dans les tableaux de notes (max 10 caractères)"})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configuration avancée"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Type de matière ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("div",{className:"space-y-3",children:[{value:"Fondamentale",label:"Fondamentale",desc:"Matières principales (Français, Maths...)"},{value:"Éveil",label:"Éveil",desc:"Matières d'éveil (Sciences, Histoire...)"},{value:"Expression",label:"Expression",desc:"Matières d'expression (Arts, Sport...)"}].map(k=>o.jsxs("label",{className:`flex items-center p-4 border rounded-md cursor-pointer transition-all ${a.type===k.value?"border-gray-900 bg-gray-50":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"type",value:k.value,checked:a.type===k.value,onChange:P=>T("type",P.target.value),className:"sr-only"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-gray-900",children:k.label}),o.jsx("div",{className:"text-sm text-gray-600 mt-1",children:k.desc})]}),a.type===k.value&&o.jsx("div",{className:"w-6 h-6 bg-gray-900 rounded-full flex items-center justify-center ml-3",children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},k.value))})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Coefficient ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"number",value:a.coefficient,onChange:k=>T("coefficient",parseInt(k.target.value)),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.coefficient?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,min:"1",max:"100"}),s.coefficient&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:"⚠️"}),s.coefficient]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Poids de la matière dans le calcul de la moyenne (1-100)"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:a.obligatoire,onChange:k=>T("obligatoire",k.target.checked),className:"w-4 h-4 text-gray-900 border border-gray-300 rounded focus:ring-gray-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Matière obligatoire"})]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500 ml-8",children:"Les matières obligatoires doivent être enseignées dans toutes les classes du niveau correspondant"})]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configuration des barèmes par niveau"}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:x.map(k=>o.jsx("button",{type:"button",onClick:()=>m(k),className:`px-3 py-2 rounded-md text-sm font-medium transition-all ${h===k?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:k},k))}),o.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[o.jsxs("h4",{className:"font-semibold text-gray-900 mb-4",children:["Barème pour ",h]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Note minimale"}),o.jsx("input",{type:"number",min:"0",value:a.baremeParNiveau[h]?.min||0,onChange:k=>{const P={...a.baremeParNiveau,[h]:{...a.baremeParNiveau[h],min:Number(k.target.value)}};T("baremeParNiveau",P)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Note maximale"}),o.jsx("input",{type:"number",min:"1",value:a.baremeParNiveau[h]?.max||20,onChange:k=>{const P={...a.baremeParNiveau,[h]:{...a.baremeParNiveau[h],max:Number(k.target.value)}};T("baremeParNiveau",P)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors"})]})]}),o.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-md",children:[o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsxs("strong",{children:["Exemple pour ",h,":"]}),h==="CE2"?" Mathématiques /50, Orthographe /20":" Notes généralement /20"]}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Les notes seront automatiquement converties pour le calcul des moyennes"})]})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Aperçu des barèmes configurés"}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:x.map(k=>{const P=a.baremeParNiveau[k];return o.jsxs("div",{className:"bg-white rounded-md p-3 border border-gray-200",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:k}),o.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["/",P?.max||20]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["Min: ",P?.min||0]})]},k)})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:()=>y&&g?g.openPrompt():r(),className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors font-medium",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 focus:ring-2 focus:ring-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:[f?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Gs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:e?f?"Sauvegarde...":"Mettre à jour la matière":f?"Sauvegarde...":"Créer la matière"})]})]})]})]}),g&&o.jsx(gc,{open:g.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardées. Voulez-vous quitter sans enregistrer ?",onConfirm:()=>{try{_()}catch{}g.allowNavigation?g.allowNavigation():r()},onCancel:()=>g.closePrompt&&g.closePrompt()})]})}function qq(){const{showToast:e}=Xr(),[t,r]=j.useState(""),[n,a]=j.useState(""),[i,s]=j.useState({}),[l,f]=j.useState(!1),[d,h]=j.useState(20),m=j.useMemo(()=>pe.getAll("classes"),[]),x=j.useMemo(()=>pe.getAll("compositions"),[]),v=j.useMemo(()=>pe.getAll("notes"),[]),y=m.find(V=>V.id===t),g=j.useMemo(()=>pe.getAll("eleves").filter(V=>V.classeId===t&&V.statut==="Actif").sort((V,se)=>V.nom.localeCompare(se.nom)),[t]),b=j.useMemo(()=>y?x.filter(V=>!V.niveau||V.niveau===y.niveau).sort((V,se)=>V.ordre-se.ordre):x,[y,x]),N=j.useMemo(()=>pe.getAll("matieres"),[]),_=j.useRef({}),S=j.useMemo(()=>y?(y.matieres||[]).map(U=>{if(typeof U=="string")return N.find(Ae=>Ae.id===U)||{id:U,nom:U,abreviation:U,coefficient:1,type:"Fondamentale",baremeParNiveau:{}};if(U&&typeof U=="object"&&U.abreviation)return U;const W=U&&U.id||null,X=U&&U.nom||null;let de=null;if(W&&(de=N.find(Pe=>Pe.id===W)||null),!de&&X&&(de=N.find(Pe=>Pe.nom===X)||null),de)return de;const F=U&&U.abreviation||(X?String(X).slice(0,3).toUpperCase():"—");return{id:W||U&&U.id||Math.random().toString(36).slice(2,9),nom:X||U&&U.nom||"Matière",abreviation:F,coefficient:U&&U.coefficient||1,type:U&&U.type||"Fondamentale",baremeParNiveau:U&&U.baremeParNiveau||{}}}).sort((U,W)=>U.nom.localeCompare(W.nom)):[],[y,N]);j.useEffect(()=>{if(!n||!t)return;const V={};g.forEach(se=>{V[se.id]={},S.forEach(U=>{const W=v.find(X=>X.eleveId===se.id&&X.matiereId===U.id&&X.compositionId===n&&X.classeId===t);W&&(V[se.id][U.id]=W.valeur)})}),s(se=>{try{const U=JSON.stringify(se||{}),W=JSON.stringify(V||{});if(U===W)return se}catch{}return V});try{_.current=JSON.parse(JSON.stringify(V||{}))}catch{_.current=V||{}}},[n,t,g,S,v]);const C=j.useMemo(()=>{try{return JSON.stringify(_.current||{})!==JSON.stringify(i||{})}catch{return!1}},[i]),T=Bf(C),k=`notes:${t}:${n}`,{load:P,clear:D}=$f(k,i);j.useEffect(()=>{if(!(!t||!n))try{const V=P();V&&s(se=>({...se,...V}))}catch{}},[t,n]),j.useEffect(()=>{},[i]),j.useEffect(()=>{const V=()=>{!t&&m.length>0&&r(m[0].id),!n&&b.length>0&&a(b[0].id)};return window.addEventListener("open-notes-entry",V),()=>window.removeEventListener("open-notes-entry",V)},[t,n,m,b]);const R=(V,se,U)=>{const W=S.find(F=>F.id===se),X=W&&y?G(W,y.niveau):20;let de=Number.isFinite(Number(U))?Number(U):0;de<0&&(de=0),de>X&&(de=X),s(F=>({...F,[V]:{...F[V],[se]:de}}))},G=(V,se)=>V.baremeParNiveau?.[se]?.max||20,M=V=>i[V]?S.reduce((se,U)=>{const W=i[V][U.id]||0;return se+W},0):0,H=V=>{if(!i[V]||!y)return 0;let se=0,U=0;return S.forEach(W=>{const X=i[V][W.id]||0,de=G(W,y.niveau),F=d===20?X/de*20:X/de*10;se+=F*W.coefficient,U+=d*W.coefficient}),U>0?se/U*d:0},z=()=>{const V=g.map(F=>({eleveId:F.id,moyenne:H(F.id)})),se={};V.forEach(F=>{se[F.eleveId]=F.moyenne});const U=V.filter(F=>F.moyenne>0);U.sort((F,Pe)=>Pe.moyenne-F.moyenne);const W={};let X=Number.NaN,de=0;for(let F=0;F<U.length;F++){const Pe=U[F];if(!Number.isNaN(X)&&Math.abs(Pe.moyenne-X)<1e-9)W[Pe.eleveId]=de;else{const Ae=F+1;W[Pe.eleveId]=Ae,de=Ae,X=Pe.moyenne}}return{moyennesMap:se,ranksMap:W,sortedByRank:U}},{moyennesMap:ne,ranksMap:Q,sortedByRank:le}=j.useMemo(()=>z(),[g,S,i,d,n,t]),[ue,fe]=j.useState("nom"),K=j.useMemo(()=>{if(ue==="nom")return[...g].sort((W,X)=>W.nom.localeCompare(X.nom));const V=le.map(W=>W.eleveId),se=V.map(W=>g.find(X=>X.id===W)).filter(Boolean),U=g.filter(W=>!V.includes(W.id)).sort((W,X)=>W.nom.localeCompare(X.nom));return[...se,...U]},[ue,g,le]),me=async()=>{if(!n||!t){e("Sélectionnez une classe et une composition","error");return}f(!0);try{Object.entries(i).forEach(([V,se])=>{Object.entries(se).forEach(([U,W])=>{if(W>=0){const X=S.find(We=>We.id===U);if(!X||!y)return;let de=G(X,y.niveau),F=Number(W)||0;F<0&&(F=0),F>de&&(F=de);const Pe=v.find(We=>We.eleveId===V&&We.matiereId===U&&We.compositionId===n&&We.classeId===t),Ae={eleveId:V,matiereId:U,compositionId:n,classeId:t,valeur:F,bareme:de,date:new Date().toISOString()};Pe?pe.update("notes",Pe.id,Ae):pe.create("notes",Ae)}})}),Object.keys(ne).forEach(V=>{const se=ne[V],U=Q[V]||0;if(se>0){const W=pe.getAll("moyennesGenerales").find(de=>de.eleveId===V&&de.compositionId===n&&de.classeId===t),X={eleveId:V,classeId:t,compositionId:n,moyenne:se,rang:U,dateCalcul:new Date().toISOString()};W?pe.update("moyennesGenerales",W.id,X):pe.create("moyennesGenerales",X)}}),e("Notes enregistrées avec succès","success");try{_.current=JSON.parse(JSON.stringify(i||{}))}catch{_.current=i||{}}try{D()}catch{}}catch(V){console.error(V),e("Erreur lors de l'enregistrement des notes","error")}finally{f(!1)}},J=()=>{try{D()}catch{}T&&T.allowNavigation&&T.allowNavigation()},O=()=>{T&&T.closePrompt&&T.closePrompt()},ae=()=>y?S.reduce((V,se)=>V+G(se,y.niveau),0):0,ee=()=>{if(!y)return 1;const V=ae();return d===20?V/20:V/10},L=()=>{if(!y||!n||K.length===0){e("Aucune donnée à imprimer","error");return}const V=K.map((de,F)=>{const Pe=M(de.id),Ae=ne[de.id]||0,We=Q[de.id]||0,Ue=S.map(Te=>`<td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #f9f9f9;">${i[de.id]?.[Te.id]||""}</td>`).join(`
`);return`
        <tr>
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #f9f9f9;">${F+1}</td>
          <td style="border: 1px solid #333; padding: 8px; text-align: left; background-color: #f9f9f9;">${yt(de)}</td>
          ${Ue}
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #e6ffe6; font-weight: bold;">${Pe.toFixed(1)}</td>
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #ffe6e6; font-weight: bold;">${Ae.toFixed(2)}</td>
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #f9f9f9; font-weight: bold;">${We>0?We:""}</td>
        </tr>
      `}).join(`
`),se=S.map(de=>`<th style="border: 2px solid #333; padding: 10px; text-align: center; background-color: #4a5568; color: white; font-weight: bold; font-size: 13px;">${de.abreviation}</th>`).join(`
`),U=x.find(de=>de.id===n)?.nom||"Composition",W=`
      <html>
        <head>
          <title>Résultats de Composition - ${y.niveau} ${y.section}</title>
          <style>
            body {
              font-family: 'Times New Roman', Times, serif;
              font-size: 12px;
              color: #000;
              padding: 15mm;
              line-height: 1.4;
            }
            h2 {
              text-align: center;
              margin-bottom: 20px;
              font-size: 18px;
              font-weight: bold;
            }
            .header-info {
              text-align: center;
              margin-bottom: 30px;
              font-size: 14px;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              margin-bottom: 20px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            th {
              border: 2px solid #333;
              padding: 10px;
              text-align: center;
              background-color: #4a5568;
              color: white;
              font-weight: bold;
              font-size: 13px;
            }
            td {
              border: 1px solid #333;
              padding: 8px;
            }
            .signature {
              text-align: right;
              margin-top: 50px;
              font-weight: bold;
              font-size: 14px;
            }
            @media print {
              body { margin: 0; }
              .signature { page-break-inside: avoid; }
            }
          </style>
        </head>
        <body>
          <h2>Résultats de Composition</h2>
          <div class="header-info">
            <strong>Classe:</strong> ${y.niveau} ${y.section}<br>
            <strong>Composition:</strong> ${U}<br>
            <strong>Base de moyenne:</strong> /${d}
          </div>
          <table>
            <thead>
              <tr>
                <th>N°</th>
                <th>Noms et Prénoms</th>
                ${se}
                <th>Total</th>
                <th>Moyenne</th>
                <th>Rang</th>
              </tr>
            </thead>
            <tbody>
              ${V}
            </tbody>
          </table>
          <div class="signature">Signature</div>
        </body>
      </html>
    `,X=window.open("","_blank","width=800,height=600");if(!X){e("Impossible d'ouvrir la fenêtre d'impression","error");return}X.document.open(),X.document.write(W),X.document.close(),X.focus(),setTimeout(()=>{X.print(),X.onafterprint=()=>X.close()},500)};return o.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-white border border-gray-200 p-6 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Notes par Classe"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Saisie et calcul des moyennes selon le système ivoirien"})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Base de calcul"}),o.jsxs("div",{className:"flex space-x-2 mt-2",children:[o.jsx("button",{onClick:()=>h(10),className:`px-3 py-2 rounded-md font-medium transition-all ${d===10?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"/10"}),o.jsx("button",{onClick:()=>h(20),className:`px-3 py-2 rounded-md font-medium transition-all ${d===20?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"/20"})]})]})]})}),o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Trier par :"}),o.jsx("button",{onClick:()=>fe("nom"),className:`px-3 py-1 rounded ${ue==="nom"?"bg-gray-900 text-white":"bg-gray-100"}`,children:"Nom"}),o.jsx("button",{onClick:()=>fe("rang"),className:`px-3 py-1 rounded ${ue==="rang"?"bg-gray-900 text-white":"bg-gray-100"}`,children:"Rang"})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Sélection des paramètres"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Classe"}),o.jsxs("select",{value:t,onChange:V=>{r(V.target.value),a(""),s({})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"Sélectionner une classe"}),m.map(V=>{const se=pe.getAll("eleves").filter(U=>U.classeId===V.id&&U.statut==="Actif").length;return o.jsxs("option",{value:V.id,children:[V.niveau," ",V.section," (",se," élèves)"]},V.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Composition"}),o.jsxs("select",{value:n,onChange:V=>{a(V.target.value),s({})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",disabled:!t,children:[o.jsx("option",{value:"",children:"Sélectionner une composition"}),b.map(V=>o.jsxs("option",{value:V.id,children:[V.nom," (coeff. ",V.coefficient,")"]},V.id))]})]}),o.jsx("div",{className:"flex items-end",children:o.jsxs("button",{onClick:me,disabled:l||!n||!t,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition-colors disabled:opacity-50",children:[l?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(Gs,{className:"h-4 w-4"}),o.jsx("span",{children:l?"Sauvegarde...":"Enregistrer"})]})})]})]}),t&&n&&S.length>0&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Saisie des notes - ",y?.niveau," ",y?.section]}),o.jsxs("p",{className:"text-gray-600 text-sm",children:[x.find(V=>V.id===n)?.nom," • Total /",ae()," • Moyenne /",d]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Notes complètes"}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[Object.keys(i).filter(V=>{const se=i[V]||{};return S.every(U=>se[U.id]!==void 0)}).length,"/",g.length]})]}),o.jsxs("button",{onClick:L,className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm shadow hover:bg-indigo-700 flex items-center space-x-2",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"inline-block",children:[o.jsx("path",{d:"M6 9V2h12v7",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("rect",{x:"6",y:"13",width:"12",height:"9",rx:"1",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("span",{children:"Imprimer"})]})]})]})}),o.jsx("div",{className:"p-6 overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-semibold text-gray-900 min-w-[60px]",children:"N°"}),o.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-semibold text-gray-900 min-w-[200px]",children:"Noms et Prénoms"}),S.map(V=>o.jsx("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[80px]",children:o.jsx("div",{children:V.abreviation})},V.id)),o.jsxs("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[80px]",children:[o.jsx("div",{children:"Total"}),o.jsxs("div",{className:"text-xs text-gray-500 font-normal",children:["/",ae()]})]}),o.jsxs("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[80px]",children:[o.jsx("div",{children:"Moy"}),o.jsxs("div",{className:"text-xs text-gray-500 font-normal",children:["/",d]})]}),o.jsx("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[60px]",children:"Rang"})]})}),o.jsx("tbody",{children:K.map((V,se)=>{const U=M(V.id),W=ne[V.id]||0,X=Q[V.id]||0;return o.jsxs("tr",{className:se%2===0?"bg-white":"bg-gray-50",children:[o.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm font-medium text-gray-900",children:se+1}),o.jsx("td",{className:"border border-gray-300 px-3 py-2",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[V.photo&&o.jsx("img",{src:V.photo,alt:`${V.prenoms} ${V.nom}`,className:"h-6 w-6 rounded-full object-cover"}),o.jsx("div",{className:"text-sm font-medium text-gray-900",children:yt(V)})]})}),S.map(de=>{const F=G(de,y?.niveau||""),Pe=i[V.id]?.[de.id]||"";return o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:o.jsx("input",{type:"number",min:"0",max:F,step:"0.5",value:Pe,onChange:Ae=>R(V.id,de.id,Number(Ae.target.value)),className:"w-full px-2 py-1 border border-gray-300 rounded text-center font-bold focus:ring-2 focus:ring-gray-500 focus:border-gray-500",placeholder:"0"})},de.id)}),o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:o.jsx("div",{className:"font-bold text-blue-600",children:U.toFixed(1)})}),o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:o.jsx("div",{className:`font-bold ${W>=d*.5?"text-green-600":"text-red-600"}`,children:W.toFixed(2)})}),o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:X>0&&o.jsxs("div",{className:`font-bold ${X===1?"text-yellow-600":X<=3?"text-green-600":"text-gray-600"}`,children:[X,X===1&&o.jsx(A5,{className:"inline h-3 w-3 ml-1"})]})})]},V.id)})})]})}),g.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(qi,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucun élève dans cette classe"})]})]}),t&&y&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations sur le calcul des moyennes"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx(C5,{className:"h-6 w-6 text-gray-600 mx-auto mb-2"}),o.jsx("div",{className:"text-xl font-bold text-gray-900",children:ae()}),o.jsx("p",{className:"text-gray-700 font-medium",children:"Total maximum"}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Somme des barèmes de toutes les matières"})]})}),o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx(x5,{className:"h-6 w-6 text-gray-600 mx-auto mb-2"}),o.jsx("div",{className:"text-xl font-bold text-gray-900",children:ee().toFixed(1)}),o.jsx("p",{className:"text-gray-700 font-medium",children:"Diviseur"}),o.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Pour obtenir la moyenne /",d]})]})}),o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Ki,{className:"h-6 w-6 text-gray-600 mx-auto mb-2"}),o.jsx("div",{className:"text-xl font-bold text-gray-900",children:S.length}),o.jsx("p",{className:"text-gray-700 font-medium",children:"Matières"}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Configurées pour cette classe"})]})})]}),o.jsxs("div",{className:"mt-6 bg-gray-50 rounded-md p-4",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Détail des matières"}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:S.map(V=>{const se=G(V,y.niveau),U=d===20?se/20:se/10;return o.jsxs("div",{className:"bg-white rounded-md p-3 border border-gray-200",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:V.abreviation}),o.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["/",se]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["Diviseur: ",U.toFixed(1)]})]},V.id)})})]})]}),t&&n&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statistiques de la classe"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-gray-900",children:g.length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Élèves"})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-green-600",children:g.filter(V=>H(V.id)>=d*.5).length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Admis"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["≥ ",d/2,"/",d]})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-red-600",children:g.filter(V=>{const se=H(V.id);return se>0&&se<d*.5}).length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Échec"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["< ",d/2,"/",d]})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-gray-900",children:(()=>{const V=g.map(se=>H(se.id)).filter(se=>se>0);return V.length>0?(V.reduce((se,U)=>se+U,0)/V.length).toFixed(2):"0"})()}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Moy. Classe"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["/",d]})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-gray-900",children:Object.keys(i).reduce((V,se)=>{const U=i[se]||{},W=Object.values(U).filter(X=>X!=null).length;return V+W},0)}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Notes saisies"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["/ ",g.length*S.length]})]})]})]}),T&&o.jsx(gc,{open:T.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardées. Voulez-vous quitter sans enregistrer ?",onConfirm:J,onCancel:O})]})}function Xq(e){const t=e.split("-"),r=parseInt(t[0],10);return isNaN(r)?new Date().getFullYear():r}function Yq(e,t){const r=Xq(t),n=r+1,a=[`${r}-09-01`,`${r}-10-05`,`${r}-11-05`,`${r}-12-05`,`${n}-01-05`,`${n}-02-05`,`${n}-03-05`];let i=35e3,s=15e3,l=15e3;["Petite Section","Moyenne Section","Grande Section"].includes(e)&&(i=35e3,s=15e3,l=1e4),["CP1","CP2","CE1","CE2"].includes(e)&&(i=35e3,s=15e3,l=15e3),e==="CM1"&&(i=35e3,s=2e4,l=15e3),e==="CM2"&&(i=45e3,s=2e4,l=15e3);const f=[{modalite:1,label:"Inscription",date:a[0],montant:i,id:`${e}-1`},{modalite:2,label:"Versement 1",date:a[1],montant:s,id:`${e}-2`},{modalite:3,label:"Versement 2",date:a[2],montant:l,id:`${e}-3`},{modalite:4,label:"Versement 3",date:a[3],montant:1e4,id:`${e}-4`},{modalite:5,label:"Versement 4",date:a[4],montant:1e4,id:`${e}-5`},{modalite:6,label:"Versement 5",date:a[5],montant:1e4,id:`${e}-6`},{modalite:7,label:"Versement 6",date:a[6],montant:1e4,id:`${e}-7`}],d=f.reduce((h,m)=>h+m.montant,0);return{niveau:e,anneeScolaire:t,montant:d,fraisInscription:0,echeances:f.map(h=>({date:h.date,montant:h.montant,modalite:h.modalite,label:h.label,id:h.id}))}}const Jq=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];function Qq(e){(pe.getAll("fraisScolaires")||[]).forEach(n=>{if(n&&n.annee&&!n.anneeScolaire)try{pe.update("fraisScolaires",n.id,{...n,anneeScolaire:n.annee,updatedAt:new Date().toISOString()})}catch{}});let r=0;return Jq.forEach(n=>{if(!(pe.getAll("fraisScolaires")||[]).find(i=>i.niveau===n&&i.anneeScolaire===e)){const i=Yq(n,e);pe.create("fraisScolaires",i),r++}}),r}function iP(){const e="2025-2026",t=Qq(e);return t>0&&console.log(`Frais scolaires initialisés: ${t} niveaux créés pour ${e}`),t}const Yk=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];function Zq(){const{showToast:e}=Xr(),[t,r]=j.useState([]),[n,a]=j.useState(null),[i,s]=j.useState(!1),[l,f]=j.useState({niveau:"CP1",anneeScolaire:"2025-2026",echeances:[{date:"2025-09-01",montant:35e3,modalite:1,label:"Inscription"}]});j.useEffect(()=>{d(),pe.getAll("fraisScolaires").length===0&&(iP(),d())},[]);const d=()=>{const _=pe.getAll("fraisScolaires");r(_)},h=()=>{f({niveau:"CP1",anneeScolaire:"2025-2026",echeances:[{date:"2025-09-01",montant:35e3,modalite:1,label:"Inscription"}]}),a(null),s(!1)},m=_=>{f({niveau:_.niveau,anneeScolaire:_.anneeScolaire,echeances:(_.echeances||[]).map(S=>({date:S.date,montant:S.montant,modalite:S.modalite||1,label:S.label||""}))}),a(_.id),s(!0)},x=_=>{window.confirm(`Supprimer les frais pour ${_.niveau} (${_.anneeScolaire}) ?`)&&(pe.delete("fraisScolaires",_.id),d(),e("Frais supprimés","success"))},v=()=>{const _=l.echeances.reduce((C,T)=>C+T.montant,0),S={niveau:l.niveau,anneeScolaire:l.anneeScolaire,fraisInscription:0,montant:_,echeances:l.echeances.map((C,T)=>({id:`${l.niveau}-${l.anneeScolaire}-${T+1}`,date:C.date,montant:C.montant,modalite:C.modalite,label:C.label}))};if(n)pe.update("fraisScolaires",n,S),e("Frais mis à jour","success");else{if(t.find(T=>T.niveau===l.niveau&&T.anneeScolaire===l.anneeScolaire)){e("Des frais existent déjà pour ce niveau et cette année","error");return}pe.create("fraisScolaires",S),e("Frais ajoutés","success")}d(),h()},y=()=>{f(_=>({..._,echeances:[..._.echeances,{date:"",montant:1e4,modalite:_.echeances.length+1,label:`Versement ${_.echeances.length}`}]}))},g=(_,S,C)=>{f(T=>({...T,echeances:T.echeances.map((k,P)=>P===_?{...k,[S]:S==="montant"||S==="modalite"?Number(C):C}:k)}))},b=_=>{f(S=>({...S,echeances:S.echeances.filter((C,T)=>T!==_)}))},N=_=>(_.echeances||[]).reduce((S,C)=>S+(C.montant||0),0);return o.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 text-white p-8 rounded-2xl shadow-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:o.jsx(gi,{className:"h-8 w-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Configuration des Frais Scolaires"}),o.jsx("p",{className:"text-green-100 mt-2",children:"Gestion des modalités de paiement par niveau"})]})]}),o.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-2 px-6 py-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-xl transition-all",children:[o.jsx(Gi,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:"Nouveau Frais"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 gap-6",children:Yk.map(_=>{const S=t.filter(C=>C.niveau===_);return o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:_}),o.jsxs("p",{className:"text-gray-600 text-sm",children:[S.length," configuration(s)"]})]}),o.jsx("div",{className:"p-6",children:S.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(gi,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-500",children:"Aucun frais configuré pour ce niveau"}),o.jsx("button",{onClick:()=>{f(C=>({...C,niveau:_})),s(!0)},className:"mt-3 text-teal-600 hover:text-teal-700 font-medium",children:"Configurer les frais"})]}):o.jsx("div",{className:"space-y-4",children:S.map(C=>o.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:C.anneeScolaire}),o.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[N(C).toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>m(C),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:o.jsx($o,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>x(C),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:o.jsx(Rs,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:(C.echeances||[]).map((T,k)=>o.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsxs("span",{className:"text-xs font-medium text-gray-600",children:["Modalité ",T.modalite]}),o.jsx("span",{className:"text-xs text-gray-500",children:new Date(T.date).toLocaleDateString("fr-FR")})]}),o.jsx("p",{className:"text-xs text-gray-600 font-medium",children:T.label||`Modalité ${T.modalite}`}),o.jsxs("p",{className:"font-bold text-gray-900",children:[(T.montant||0).toLocaleString("fr-FR")," FCFA"]})]},k))})]},C.id))})})]},_)})}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 text-white p-6",children:o.jsx("h3",{className:"text-xl font-bold",children:n?"Modifier les frais":"Nouveau frais scolaire"})}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Niveau"}),o.jsx("select",{value:l.niveau,onChange:_=>f(S=>({...S,niveau:_.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-green-100 focus:border-green-500 transition-all",children:Yk.map(_=>o.jsx("option",{value:_,children:_},_))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Année scolaire"}),o.jsx("input",{type:"text",value:l.anneeScolaire,onChange:_=>f(S=>({...S,anneeScolaire:_.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-green-100 focus:border-green-500 transition-all",placeholder:"2025-2026"})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Échéances de paiement"}),o.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",l.echeances.reduce((_,S)=>_+S.montant,0).toLocaleString("fr-FR")," FCFA"]}),o.jsxs("button",{onClick:y,className:"flex items-center space-x-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:[o.jsx(Gi,{className:"h-4 w-4"}),o.jsx("span",{children:"Ajouter"})]})]}),o.jsx("div",{className:"space-y-4",children:l.echeances.map((_,S)=>o.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modalité"}),o.jsx("input",{type:"number",min:"1",value:_.modalite,onChange:C=>g(S,"modalite",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-center font-bold"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Label"}),o.jsx("input",{type:"text",value:_.label,onChange:C=>g(S,"label",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent font-medium",placeholder:"Ex: Inscription, Versement 1..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'échéance"}),o.jsx("input",{type:"date",value:_.date,onChange:C=>g(S,"date",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent font-mono"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant (FCFA)"}),o.jsx("input",{type:"number",min:"0",value:_.montant,onChange:C=>g(S,"montant",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-right font-bold text-green-700"})]}),o.jsx("div",{children:o.jsx("button",{onClick:()=>b(S),className:"w-full p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",disabled:l.echeances.length===1,children:o.jsx(Rs,{className:"h-4 w-4 mx-auto"})})})]})},S))}),o.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-blue-900 font-semibold",children:"Total des frais:"}),o.jsxs("span",{className:"text-2xl font-bold text-blue-700",children:[l.echeances.reduce((_,S)=>_+S.montant,0).toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"mt-2 text-sm text-blue-600",children:[l.echeances.length," modalité(s) de paiement configurée(s)"]})]})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{onClick:h,className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:v,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-600 to-teal-600 text-white rounded-xl hover:from-green-700 hover:to-teal-700 transition-all",children:[o.jsx(Gs,{className:"h-5 w-5"}),o.jsx("span",{children:n?"Mettre à jour":"Enregistrer"})]})]})]})]})})]})}const Jk=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];function eX(){const{showToast:e}=Xr(),[t,r]=j.useState([]),[n,a]=j.useState(null),[i,s]=j.useState(!1),[l,f]=j.useState({nom:"",coefficient:1,niveau:"",ordre:1});j.useEffect(()=>{d()},[]);const d=()=>{const g=pe.getAll("compositions");r(g.sort((b,N)=>b.ordre-N.ordre))},h=()=>{f({nom:"",coefficient:1,niveau:"",ordre:1}),a(null),s(!1)},m=g=>{f({nom:g.nom,coefficient:g.coefficient,niveau:g.niveau||"",ordre:g.ordre}),a(g),s(!0)},x=()=>{if(!l.nom.trim()){e("Le nom est obligatoire","error");return}if(t.some(b=>b.nom.toLowerCase()===l.nom.trim().toLowerCase()&&b.niveau===(l.niveau||void 0)&&b.id!==n?.id)){e("Cette composition existe déjà pour ce niveau","error");return}const g={nom:l.nom.trim(),coefficient:l.coefficient,niveau:l.niveau||void 0,ordre:l.ordre};n?(pe.update("compositions",n.id,g),e("Composition mise à jour","success")):(pe.create("compositions",g),e("Composition ajoutée","success")),d(),h()},v=g=>{window.confirm("Supprimer cette composition ? Toutes les notes associées seront perdues.")&&(pe.getAll("notes").filter(_=>_.compositionId===g).forEach(_=>pe.delete("notes",_.id)),pe.getAll("moyennesGenerales").filter(_=>_.compositionId===g).forEach(_=>pe.delete("moyennesGenerales",_.id)),pe.delete("compositions",g),d(),e("Composition supprimée","success"))},y=g=>t.filter(b=>!b.niveau||b.niveau===g);return o.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-8 rounded-2xl shadow-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:o.jsx(Ki,{className:"h-8 w-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Configuration des Compositions"}),o.jsx("p",{className:"text-purple-100 mt-2",children:"Gestion des périodes d'évaluation par niveau"})]})]}),o.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-2 px-6 py-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-xl transition-all",children:[o.jsx(Gi,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:"Nouvelle Composition"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:Jk.map(g=>o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:g}),o.jsxs("p",{className:"text-gray-600 text-sm",children:[y(g).length," composition(s)"]})]}),o.jsx("div",{className:"p-6",children:y(g).length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(v1,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-500 mb-3",children:"Aucune composition spécifique"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Les compositions générales s'appliquent à ce niveau"})]}):o.jsx("div",{className:"space-y-3",children:y(g).map(b=>o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:b.nom}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Coefficient: ",b.coefficient," • Ordre: ",b.ordre]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>m(b),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:o.jsx($o,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>v(b.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:o.jsx(Rs,{className:"h-4 w-4"})})]})]},b.id))})})]},g))}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-blue-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Compositions Générales"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"S'appliquent à tous les niveaux sauf configuration spécifique"})]}),o.jsx("div",{className:"p-6",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.filter(g=>!g.niveau).map(g=>o.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl p-4 border border-gray-200 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:g.nom}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsx("button",{onClick:()=>m(g),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",children:o.jsx($o,{className:"h-3 w-3"})}),o.jsx("button",{onClick:()=>v(g.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",children:o.jsx(Rs,{className:"h-3 w-3"})})]})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:g.coefficient}),o.jsx("p",{className:"text-gray-600 text-xs",children:"Coefficient"}),o.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:["Ordre: ",g.ordre]})]})]},g.id))})})]}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4",children:[o.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 rounded-t-2xl",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-xl font-bold",children:n?"Modifier la composition":"Nouvelle composition"}),o.jsx("button",{onClick:h,className:"text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition-colors",children:o.jsx(qs,{className:"h-5 w-5"})})]})}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom de la composition ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:l.nom,onChange:g=>f(b=>({...b,nom:g.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all",placeholder:"Ex: 1ère Composition, Devoir de Noël..."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Coefficient ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",min:"1",max:"10",value:l.coefficient,onChange:g=>f(b=>({...b,coefficient:Number(g.target.value)})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Ordre d'affichage"}),o.jsx("input",{type:"number",min:"1",value:l.ordre,onChange:g=>f(b=>({...b,ordre:Number(g.target.value)})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Niveau spécifique (optionnel)"}),o.jsxs("select",{value:l.niveau,onChange:g=>f(b=>({...b,niveau:g.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all",children:[o.jsx("option",{value:"",children:"Tous les niveaux"}),Jk.map(g=>o.jsx("option",{value:g,children:g},g))]}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Laissez vide pour appliquer à tous les niveaux"})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{onClick:h,className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:x,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl hover:from-purple-700 hover:to-indigo-700 transition-all",children:[o.jsx(Gs,{className:"h-5 w-5"}),o.jsx("span",{children:n?"Mettre à jour":"Enregistrer"})]})]})]})]})})]})}const Qk=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(String(n.result)),n.onerror=r,n.readAsDataURL(e)});function tX(){const[e,t]=j.useState(()=>Bs()),[r,n]=j.useState("eleves");function a(s,l,f){t(d=>{const h=d[s];return{...d,[s]:{...h,[l]:f}}})}const i=()=>{qu(e),alert("Configurations d'impression sauvegardées")};return o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Configuration des impressions"}),o.jsx("p",{className:"mb-6 text-sm text-gray-600 max-w-3xl",children:"Éditez l'en-tête, le pied de page, les logos et les colonnes pour chaque type de document. Chaque onglet dispose d'un aperçu placé sous le formulaire."}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex items-center gap-3",children:["eleves","recu","transport"].map(s=>o.jsx("button",{onClick:()=>n(s),className:`px-4 py-2 rounded-md font-semibold shadow-sm ${r===s?"bg-teal-600 text-white":"bg-white border text-gray-700"}`,children:s==="eleves"?"ÉLÈVES":s==="recu"?"REÇU":"TRANSPORT"},s))}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow space-y-6",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["Paramètres — ",r==="eleves"?"Liste élèves":r==="recu"?"Reçu de paiement":"Transport"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"En-tête"}),o.jsx("textarea",{rows:2,value:e[r].header,onChange:s=>a(r,"header",s.target.value),className:"w-full border rounded px-3 py-2 mt-1 resize-none",placeholder:r==="eleves"?"Ministère de l'Éducation Nationale — Nom de l'établissement":r==="recu"?"Reçu de paiement":"Fiche de renseignement transport"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pied de page"}),o.jsx("textarea",{rows:2,value:e[r].footer||"",onChange:s=>a(r,"footer",s.target.value),className:"w-full border rounded px-3 py-2 mt-1 resize-none",placeholder:r==="recu"?"Aucun remboursement n'est possible après encaissement.":""})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Colonnes (séparées par des virgules)"}),o.jsx("input",{value:e[r].columns.join(", "),onChange:s=>a(r,"columns",s.target.value.split(",").map(l=>l.trim())),className:"w-full border rounded px-3 py-2 mt-1",placeholder:r==="eleves"?"Matricule, Nom & Prénom":r==="recu"?"Nom, Montant, Date, Classe":"Nom, Classe, Montant, Versement"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Logo principal"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async s=>{const l=s.target.files?.[0];if(!l)return;const f=await Qk(l);a(r,"logo",f)},className:"mt-1"}),o.jsx("div",{className:"mt-2 text-sm text-gray-600",children:e[r].logo?o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:e[r].logo,alt:"logo",className:"h-14"}),o.jsx("button",{className:"px-3 py-1 border rounded text-sm",onClick:()=>a(r,"logo",""),children:"Supprimer"})]}):o.jsx("div",{children:"Aucun fichier sélectionné"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Logo Ministère"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async s=>{const l=s.target.files?.[0];if(!l)return;const f=await Qk(l);a(r,"logoMinistere",f)},className:"mt-1"}),o.jsx("div",{className:"mt-2 text-sm text-gray-600",children:e[r].logoMinistere?o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:e[r].logoMinistere,alt:"logo-min",className:"h-14"}),o.jsx("button",{className:"px-3 py-1 border rounded text-sm",onClick:()=>a(r,"logoMinistere",""),children:"Supprimer"})]}):o.jsx("div",{children:"Aucun fichier sélectionné"})})]})]}),o.jsxs("div",{className:"flex items-center justify-between mt-4",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Options"}),o.jsxs("div",{className:"space-x-2",children:[o.jsx("button",{onClick:()=>t(Bs()),className:"px-3 py-1 border rounded",children:"Restaurer"}),o.jsx("button",{onClick:i,className:"px-3 py-1 bg-teal-600 text-white rounded",children:"Sauvegarder"})]})]})]}),o.jsx("div",{className:"border-t pt-4",children:o.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h4",{className:"font-semibold",children:["Aperçu — ",r==="eleves"?"Liste élèves":r==="recu"?"Reçu":"Transport"]}),o.jsx("div",{className:"text-sm text-gray-500",children:r==="eleves"?"Liste des élèves":r==="recu"?"Reçu de paiement":"Fiche de renseignement transport"})]}),o.jsxs("div",{className:"border rounded bg-white p-4",children:[o.jsx(ym,{type:r,libelle:e[r].header}),o.jsxs("div",{className:"mt-4 text-sm text-gray-700",children:[r==="eleves"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:"Ministère de l'Éducation Nationale et de l'Alphabétisation"}),o.jsx("div",{className:"mt-1",children:"GROUPE SCOLAIRE BAPTISTE MISSIONNAIRE DE KOUMASSI"}),o.jsx("div",{className:"mt-3 font-medium",children:"Liste des élèves"})]}),r==="recu"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:"Reçu de paiement"}),o.jsx("div",{className:"mt-2 text-gray-600",children:"Aucun remboursement n'est possible après encaissement."})]}),r==="transport"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:"Fiche de renseignement transport"}),o.jsx("div",{className:"mt-2 text-gray-600",children:"Informations : nom, classe, montant, versement"})]})]})]})]})})]})]})]})}function rX(){const{showToast:e}=Xr(),t=j.useRef(null),r=async()=>{try{const i=await Fi(()=>import("./jszip.min-65g4qvkX.js").then(g=>g.j),[],import.meta.url),s=i&&(i.default||i),l=new s,f=JSON.parse(pe.exportData()),d=new Date().toISOString().split("T")[0],h=l.folder(`backup_${d}/data`);Object.entries(f).forEach(([g,b])=>{h.file(`${g}.json`,JSON.stringify(b,null,2))}),l.folder(`backup_${d}/meta`).file("info.json",JSON.stringify({generatedAt:new Date().toISOString(),app:"KlasNet"},null,2));const x=await l.generateAsync({type:"blob"}),v=window.URL.createObjectURL(x),y=document.createElement("a");y.href=v,y.download=`klasnet_backup_${d}.zip`,y.click(),window.URL.revokeObjectURL(v),e("Sauvegarde ZIP exportée avec succès","success")}catch{const s=pe.exportData(),l=new Blob([s],{type:"application/json"}),f=window.URL.createObjectURL(l),d=document.createElement("a"),h=new Date().toISOString().split("T")[0];d.href=f,d.download=`klasnet_backup_${h}.json`,d.click(),window.URL.revokeObjectURL(f),e("Sauvegarde exportée (fallback JSON)","success")}},n=i=>{const s=i.target.files?.[0];if(!s)return;const l=new FileReader;l.onload=f=>{try{const d=f.target?.result;pe.importData(d)?e("Données importées avec succès","success"):e("Erreur lors de l’importation des données","error")}catch{e("Erreur lors de la lecture du fichier","error")}},l.readAsText(s)},a=()=>{window.confirm("Êtes-vous sûr de vouloir réinitialiser toutes les données ? Cette action est irréversible.")&&(pe.resetData(),e("Données réinitialisées avec succès","success"))};return o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Sauvegarde et Restauration"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Export / import / réinitialisation des données de l'application"})]}),o.jsxs("div",{className:"max-w-xl bg-white p-6 rounded shadow-sm border",children:[o.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"Utilisez ces commandes pour exporter une sauvegarde complète de l'application, importer une sauvegarde ou réinitialiser la base de données locale."}),o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsx("button",{onClick:r,className:"w-full px-4 py-2 bg-blue-600 text-white rounded",children:"Exporter les données"}),o.jsx("button",{onClick:()=>t.current?.click(),className:"w-full px-4 py-2 border rounded",children:"Importer des données"}),o.jsx("button",{onClick:a,className:"w-full px-4 py-2 bg-red-600 text-white rounded",children:"Réinitialiser toutes les données"})]}),o.jsx("input",{ref:t,type:"file",accept:".json",onChange:n,className:"hidden"})]})]})}function nX(){const[e,t]=j.useState([]);return j.useEffect(()=>{t(pe.getAll("historiques").sort((r,n)=>n.date.localeCompare(r.date)))},[]),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 max-w-2xl mx-auto",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Historique des actions"}),e.length===0?o.jsx("div",{className:"text-gray-500 text-center",children:"Aucune action enregistrée."}):o.jsxs("table",{className:"w-full text-sm border",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"border px-2 py-1",children:"Date"}),o.jsx("th",{className:"border px-2 py-1",children:"Type"}),o.jsx("th",{className:"border px-2 py-1",children:"Cible"}),o.jsx("th",{className:"border px-2 py-1",children:"Description"}),o.jsx("th",{className:"border px-2 py-1",children:"Utilisateur"})]})}),o.jsx("tbody",{children:e.map(r=>o.jsxs("tr",{children:[o.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:new Date(r.date).toLocaleString()}),o.jsx("td",{className:"border px-2 py-1 capitalize",children:r.type}),o.jsx("td",{className:"border px-2 py-1",children:r.cible}),o.jsx("td",{className:"border px-2 py-1",children:r.description}),o.jsx("td",{className:"border px-2 py-1",children:r.utilisateur||"-"})]},r.id))})]})]})}function aX(){const{showToast:e}=Xr(),[t,r]=j.useState(null),[n,a]=j.useState(""),[i,s]=j.useState(!1),[l,f]=j.useState(!1),[d,h]=j.useState(!1),[m,x]=j.useState(null);j.useEffect(()=>{v()},[]);const v=async()=>{f(!0);try{await Mi.updateLicenceFromServer();const N=await Mi.checkLicenceStatus();r(N)}catch(N){console.error("Erreur refresh licence:",N)}finally{f(!1)}},y=async()=>{if(!n.trim()){e("Veuillez entrer une clé de licence","error");return}s(!0);try{const N=Mi.activateLicence(n.trim());N.success?(e(N.message,"success"),a(""),await v()):e(N.message,"error")}catch{e("Erreur lors de l'activation","error")}finally{s(!1)}},g=()=>t?t.isValid&&!t.isExpired?o.jsx(Oa,{className:"h-8 w-8 text-green-600"}):o.jsx(ti,{className:"h-8 w-8 text-red-600"}):o.jsx(I0,{className:"h-8 w-8 text-gray-400"}),b=()=>t?t.isValid&&!t.isExpired?t.daysRemaining<=7?"from-yellow-500 to-orange-500":"from-green-500 to-teal-500":"from-red-500 to-red-600":"from-gray-500 to-gray-600";return o.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[o.jsx("div",{className:`bg-gradient-to-r ${b()} text-white p-8 rounded-2xl shadow-lg`,children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:g()}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Gestion des Licences"}),o.jsx("p",{className:"text-white text-opacity-90 mt-2",children:t?.isValid?`Licence ${t.type} active - ${t.daysRemaining} jour(s) restant(s)`:"Licence expirée ou invalide"})]})]})}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Statut de la Licence"}),o.jsxs("button",{onClick:v,disabled:l,className:"flex items-center space-x-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors disabled:opacity-50",children:[o.jsx(h4,{className:`h-4 w-4 ${l?"animate-spin":""}`}),o.jsx("span",{children:"Actualiser"})]})]})}),o.jsxs("div",{className:"p-6",children:[t?o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-xl",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600 capitalize",children:t.type}),o.jsx("p",{className:"text-blue-800 font-medium",children:"Type de licence"})]}),o.jsxs("div",{className:"text-center p-6 bg-purple-50 rounded-xl",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.daysRemaining}),o.jsx("p",{className:"text-purple-800 font-medium",children:"Jours restants"})]}),o.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-xl",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.isValid?"✅":"❌"}),o.jsx("p",{className:"text-green-800 font-medium",children:t.isValid?"Valide":"Expirée"})]})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Vérification en cours..."})]}),t&&o.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Détails"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Date d'expiration:"}),o.jsx("div",{className:"font-medium text-gray-900",children:t.dateExpiration?new Date(t.dateExpiration).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Non définie"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Dernière vérification:"}),o.jsx("div",{className:"font-medium text-gray-900",children:new Date(t.lastCheck).toLocaleString("fr-FR")})]})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-blue-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Activation de Licence"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Entrez votre clé de licence pour activer ou renouveler"})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Clé de licence"}),o.jsx("textarea",{value:n,onChange:N=>a(N.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-teal-100 focus:border-teal-500 transition-all resize-none font-mono text-sm",rows:4,placeholder:"Collez votre clé de licence ici..."})]}),o.jsxs("div",{className:"flex justify-end space-x-4",children:[o.jsx("button",{onClick:()=>a(""),className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors",children:"Effacer"}),o.jsxs("button",{onClick:y,disabled:i||!n.trim(),className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-xl hover:from-teal-700 hover:to-blue-700 transition-all disabled:opacity-50",children:[i?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(M0,{className:"h-4 w-4"}),o.jsx("span",{children:i?"Activation...":"Activer la licence"})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Générateur de Clés (désactivé)"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"La génération de clés a été désactivée dans le client. Utilisez un service serveur sécurisé pour émettre des licences."})]}),o.jsx("div",{className:"p-6",children:o.jsxs("button",{disabled:!0,title:"Génération de clés désactivée",className:"flex items-center space-x-2 px-6 py-3 bg-gray-200 text-gray-500 rounded-xl cursor-not-allowed",children:[o.jsx(M0,{className:"h-5 w-5"}),o.jsx("span",{children:"Génération désactivée"})]})})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Actions Avancées"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Utilisez avec précaution"})]}),o.jsx("div",{className:"p-6",children:o.jsx("div",{className:"flex space-x-4",children:o.jsx("button",{onClick:()=>{window.confirm("Réinitialiser la licence ? Cela supprimera la licence actuelle.")&&(Mi.resetLicence(),v(),e("Licence réinitialisée","success"))},className:"px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors",children:"Réinitialiser la licence"})})})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations Système"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:o.jsx("div",{className:"text-sm",children:o.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[o.jsxs("p",{children:["📞 ",o.jsx("strong",{children:"Téléphone:"})," +2250555863953"]}),o.jsxs("p",{children:["📧 ",o.jsx("strong",{children:"Email:"})," Non disponible"]}),o.jsxs("p",{children:["🌐 ",o.jsx("strong",{children:"Site web:"})," Non disponible"]})]})})})]})]})}let Sh;try{Sh=require("./defaultFraisScolaires").ensureDefaultFrais}catch{Sh=void 0}function iX(e){const{useDFA:t=!1,dfa:r={},seuilAdmission:n=10,nouvelleAnnee:a,fallbackToReset:i=!0,preserveEleves:s=!0,resetFinances:l=!0}=e,f=pe.getAll("eleves"),d=pe.getAll("classes"),h=pe.getAll("notes"),m=pe.getAll("paiements"),x={date:new Date().toISOString(),eleves:f,classes:d,notes:h,paiements:m,compositions:pe.getAll("compositions"),fraisScolaires:pe.getAll("fraisScolaires"),type:"archive_pre_passage_annee"};try{const N=new Blob([JSON.stringify(x,null,2)],{type:"application/json"}),_=window.URL.createObjectURL(N),S=document.createElement("a");S.href=_,S.download=`archive_pre_passage_${new Date().getFullYear()}.json`,S.click(),window.URL.revokeObjectURL(_)}catch{}pe.addHistorique({type:"autre",cible:"Système",description:`Passage d'année déclenché (${t?"DFA":"Reset simple"}) vers ${a}`,utilisateur:"ADMIN"});let v=0,y=0;if(t){if(h.length===0&&!i)throw new Error("Aucune note disponible pour calculer la DFA");if(h.length===0&&i)return b();const N=Object.keys(r).length?r:(function(){const C={},T=pe.getAll("notes"),k={};return T.forEach(P=>{const D=P.eleveId,R=Number(P.valeur||0),G=Number(P.bareme||20)||20,M=R/G*20;k[D]=k[D]||[],k[D].push(M)}),Object.keys(k).forEach(P=>{const D=k[P],R=D.reduce((G,M)=>G+M,0)/D.length;C[P]=Math.round(R*100)/100}),C})(),_=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];f.forEach(S=>{const C=N[S.id]??0,T=d.find(P=>P.id===S.classeId);if(!T)return;const k=_.indexOf(T.niveau);if(C>=n)if(k>=0&&k<_.length-1){const P=_[k+1],D=d.find(R=>R.niveau===P&&R.section===T.section&&R.anneeScolaire===a);D&&(pe.update("eleves",S.id,{classeId:D.id,anneeEntree:a}),v++)}else pe.update("eleves",S.id,{statut:"Inactif"}),v++;else pe.update("eleves",S.id,{anneeEntree:a}),y++})}else return b();d.forEach(N=>{pe.update("classes",N.id,{anneeScolaire:a})});const g=pe.getAll("ecole")[0];return g&&pe.update("ecole",g.id,{anneeScolaireActive:a}),l&&pe.getAll("paiements").forEach(N=>pe.delete("paiements",N.id)),{promoted:v,heldBack:y};function b(){s?pe.getAll("eleves").forEach(S=>{pe.update("eleves",S.id,{classeId:"",anneeEntree:a})}):pe.getAll("eleves").forEach(S=>{pe.update("eleves",S.id,{statut:"Inactif"})});try{Sh&&Sh(a)}catch{}l&&pe.getAll("paiements").forEach(_=>pe.delete("paiements",_.id)),d.forEach(_=>{pe.update("classes",_.id,{anneeScolaire:a})});const N=pe.getAll("ecole")[0];return N&&pe.update("ecole",N.id,{anneeScolaireActive:a}),pe.addHistorique({type:"autre",cible:"Système",description:`Reset simple appliqué pour année ${a}`,utilisateur:"ADMIN"}),{promoted:0,heldBack:0}}}function sX(){const[e,t]=j.useState(!0),[r,n]=j.useState(10),[a,i]=j.useState(()=>{const P=new Date().getFullYear()+1;return`${P}-${P+1}`}),[s,l]=j.useState(!0),[f,d]=j.useState(!0),[h,m]=j.useState(null),[x,v]=j.useState(!1),[y,g]=j.useState(!1),[b,N]=j.useState(""),[_,S]=j.useState({promoted:0,heldBack:0,total:0}),C=()=>{g(!0),N("")},T=async()=>{if(b.trim()!==a.trim()){m("La confirmation ne correspond pas à la nouvelle année. Tapez exactement la valeur affichée pour confirmer.");return}g(!1),v(!0),m(null);try{const P=iX({useDFA:e,seuilAdmission:r,nouvelleAnnee:a,preserveEleves:s,resetFinances:f});m(`Opération terminée. Promus: ${P?.promoted??0}, Redoublants: ${P?.heldBack??0}`)}catch(P){m(`Erreur: ${P?.message||String(P)}`)}finally{v(!1)}},k=()=>{const P=pe.getAll("eleves"),D=pe.getAll("classes"),R=pe.getAll("notes"),G={};R.forEach(ne=>{const Q=ne.eleveId,le=Number(ne.valeur||0),ue=Number(ne.bareme||20)||20,fe=le/ue*20;G[Q]=G[Q]||[],G[Q].push(fe)});const M={};Object.keys(G).forEach(ne=>{const Q=G[ne],le=Q.reduce((ue,fe)=>ue+fe,0)/Q.length;M[ne]=Math.round(le*100)/100});let H=0,z=0;P.forEach(ne=>{const Q=M[ne.id]??0;D.find(ue=>ue.id===ne.classeId)&&(Q>=r?H++:z++)}),S({promoted:H,heldBack:z,total:P.length})};return j.useEffect(()=>{k()},[e,r,a,s]),o.jsxs(Cc,{title:"Passage d'année scolaire",subtitle:"Clôturer l'année actuelle et préparer la nouvelle",children:[o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white p-4 rounded border border-gray-200",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold",children:"Préparation du passage"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Les moyennes sont normalisées sur une échelle sur 20 avant décision. Par exemple, une moyenne 5/10 est convertie en 10/20 — le seuil d'admission est donc comparé sur /20."})]}),o.jsxs("div",{className:"text-sm text-gray-500 flex items-center space-x-3",children:[o.jsx(ti,{className:"w-5 h-5 text-yellow-600"}),o.jsx("span",{children:"Opération irréversible — une archive sera proposée"})]})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:e,onChange:P=>t(P.target.checked)}),o.jsx("span",{children:"Utiliser DFA (moyennes) pour promouvoir les élèves"})]}),o.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("label",{className:"text-sm text-gray-700",children:"Seuil admission (sur 20)"}),o.jsx("input",{type:"number",value:r,onChange:P=>n(Number(P.target.value)),className:"border rounded px-2 py-1 w-20"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Nouvelle année scolaire"}),o.jsx("input",{value:a,onChange:P=>i(P.target.value),className:"border rounded px-2 py-1 w-48 mt-1"})]}),o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:e,onChange:P=>t(P.target.checked)}),o.jsx("span",{children:"Utiliser DFA (moyennes)"})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:s,onChange:P=>l(P.target.checked)}),o.jsx("span",{children:"Conserver les élèves (désaffecter si besoin)"})]})]})]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Nouvelle année scolaire"}),o.jsx("input",{value:a,onChange:P=>i(P.target.value),className:"border rounded px-2 py-1 w-48 mt-1"})]}),o.jsx("div",{className:"mt-3",children:o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:f,onChange:P=>d(P.target.checked)}),o.jsx("span",{children:"Réinitialiser les paiements / finances"})]})}),o.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(ht,{onClick:C,disabled:x,variant:"danger",children:x?"Exécution...":"Lancer le passage"}),o.jsx(ht,{onClick:()=>{m(null)},variant:"ghost",children:"Effacer"})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs("button",{className:"flex items-center text-sm text-gray-600 hover:text-gray-900",onClick:k,title:"Rafraîchir l'aperçu",children:[o.jsx(h4,{className:"w-4 h-4 mr-2"})," Rafraîchir l'aperçu"]})})]}),h&&o.jsx("div",{className:"mt-4 p-3 bg-gray-50 border rounded text-sm",children:h})]}),o.jsxs("div",{className:"bg-white p-4 rounded border border-gray-200",children:[o.jsx("h3",{className:"text-md font-semibold mb-2",children:"Aperçu (non destructif)"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Estimation basée sur les notes existantes (toutes normalisées sur 20)."}),o.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"p-4 bg-green-50 rounded flex items-center space-x-3",children:[o.jsx(Oa,{className:"w-6 h-6 text-green-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-bold",children:_.promoted}),o.jsx("div",{className:"text-sm text-gray-600",children:"Promus estimés"})]})]}),o.jsxs("div",{className:"p-4 bg-yellow-50 rounded flex items-center space-x-3",children:[o.jsx(ti,{className:"w-6 h-6 text-yellow-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-bold",children:_.heldBack}),o.jsx("div",{className:"text-sm text-gray-600",children:"Redoublants estimés"})]})]}),o.jsxs("div",{className:"p-4 bg-gray-50 rounded flex items-center space-x-3",children:[o.jsx(b1,{className:"w-6 h-6 text-gray-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-bold",children:_.total}),o.jsx("div",{className:"text-sm text-gray-600",children:"Total élèves analysés"})]})]})]})]})]}),y&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-md",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Confirmer le passage d'année"}),o.jsx("p",{className:"text-sm text-gray-700 mt-2",children:"Cette opération est irréversible. Pour confirmer, tapez exactement la nouvelle année scolaire :"}),o.jsx("div",{className:"mt-3 font-mono text-sm bg-gray-100 p-2 rounded",children:a}),o.jsx("input",{value:b,onChange:P=>N(P.target.value),placeholder:"Tapez la nouvelle année pour confirmer",className:"mt-3 w-full border rounded px-2 py-1"}),o.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[o.jsx(ht,{variant:"ghost",onClick:()=>g(!1),children:"Annuler"}),o.jsx(ht,{variant:"danger",onClick:T,children:"Confirmer et lancer"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Nh={};Nh.version="0.18.5";var sP=1252,oX=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},wb=function(e){oX.indexOf(e)!=-1&&(sP=bb[0]=e)};function lX(){wb(1252)}var Ja=function(e){wb(e)};function Sb(){Ja(1200),lX()}function Zk(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function cX(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function oP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Pu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?cX(e.slice(2)):t==254&&r==255?oP(e.slice(2)):t==65279?e.slice(1):e},g0=function(t){return String.fromCharCode(t)},ej=function(t){return String.fromCharCode(t)},of,Ds="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,f=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),s=(r&3)<<4|n>>4,a=e.charCodeAt(d++),l=(n&15)<<2|a>>6,f=a&63,isNaN(n)?l=f=64:isNaN(a)&&(f=64),t+=Ds.charAt(i)+Ds.charAt(s)+Ds.charAt(l)+Ds.charAt(f);return t}function da(e){var t="",r=0,n=0,a=0,i=0,s=0,l=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Ds.indexOf(e.charAt(d++)),s=Ds.indexOf(e.charAt(d++)),r=i<<2|s>>4,t+=String.fromCharCode(r),l=Ds.indexOf(e.charAt(d++)),n=(s&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),f=Ds.indexOf(e.charAt(d++)),a=(l&3)<<6|f,f!==64&&(t+=String.fromCharCode(a));return t}var xt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),is=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ws(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function tj(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ia=function(t){return xt?is(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function bm(e){if(typeof ArrayBuffer>"u")return ia(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function to(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function uX(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Nb(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Nb(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Vr=xt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:is(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function fX(e){for(var t=[],r=0,n=e.length+250,a=Ws(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|l>>6&15|(s&3)<<4,a[r++]=128|l&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ws(65535),n=65530)}return t.push(a.slice(0,r)),Vr(t)}var Pn=/\u0000/g,Ou=/[\u0001-\u0006]/g;function Ql(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Qa(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}function Eb(e,t){var r=""+e;return r.length>=t?r:ur(" ",t-r.length)+r}function Eh(e,t){var r=""+e;return r.length>=t?r:r+ur(" ",t-r.length)}function dX(e,t){var r=""+Math.round(e);return r.length>=t?r:ur("0",t-r.length)+r}function hX(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}var rj=Math.pow(2,32);function Ll(e,t){if(e>rj||e<-rj)return dX(e,t);var r=Math.round(e);return hX(r,t)}function _h(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var nj=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function mX(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},aj={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},pX={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function kh(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,l=0,f=1,d=0,h=0,m=Math.floor(a);d<t&&(m=Math.floor(a),l=m*s+i,h=m*d+f,!(a-m<5e-8));)a=1/(a-m),i=s,s=l,f=d,d=h;if(h>t&&(d>t?(h=f,l=i):(h=d,l=s)),!r)return[0,n*l,h];var x=Math.floor(n*l/h);return[x,n*l-x*h,h]}function Po(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),s=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=wX(f,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var lP=new Date(1899,11,31,0,0,0),xX=lP.getTime(),gX=new Date(1900,2,1,0,0,0);function cP(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=gX&&(r+=1440*60*1e3),(r-(xX+(e.getTimezoneOffset()-lP.getTimezoneOffset())*6e4))/(1440*60*1e3)}function _b(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vX(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yX(e){var t=e<0?12:11,r=_b(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function bX(e){var t=_b(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function cf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=yX(e):t===10?r=e.toFixed(10).substr(0,12):r=bX(e),_b(vX(r.toUpperCase()))}function qo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):cf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ma(14,cP(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function wX(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function SX(e,t,r,n){var a="",i=0,s=0,l=r.y,f,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:f=l%100,d=2;break;default:f=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,d=t.length;break;case 3:return Xg[r.m-1][1];case 5:return Xg[r.m-1][0];default:return Xg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,d=t.length;break;case 3:return nj[r.q][0];default:return nj[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Qa(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Qa(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:f=l,d=1;break}var h=d>0?Qa(f,d):"";return h}function Is(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var uP=/%/g;function NX(e,t,r){var n=t.replace(uP,""),a=t.length-n.length;return Wi(e,n,r*Math.pow(10,2*a))+ur("%",a)}function EX(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function fP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+fP(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,f,d,h){return f+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var dP=/# (\?+)( ?)\/( ?)(\d+)/;function _X(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(s===0?ur(" ",e[1].length+1+e[4].length):Eb(s,e[1].length)+e[2]+"/"+e[3]+Qa(l,e[4].length))}function kX(e,t,r){return r+(t===0?"":""+t)+ur(" ",e[1].length+2+e[4].length)}var hP=/^#*0*\.([0#]+)/,mP=/\).*[0#]/,pP=/\(###\) ###\\?-####/;function jn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ij(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function sj(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function jX(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function CX(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function _a(e,t,r){if(e.charCodeAt(0)===40&&!t.match(mP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_a("n",n,r):"("+_a("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return EX(e,t,r);if(t.indexOf("%")!==-1)return NX(e,t,r);if(t.indexOf("E")!==-1)return fP(t,r);if(t.charCodeAt(0)===36)return"$"+_a(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ll(f,t.length);if(t.match(/^[#?]+$/))return a=Ll(r,0),a==="0"&&(a=""),a.length>t.length?a:jn(t.substr(0,t.length-a.length))+a;if(i=t.match(dP))return _X(i,f,d);if(t.match(/^#+0+$/))return d+Ll(f,t.length-t.indexOf("0"));if(i=t.match(hP))return a=ij(r,i[1].length).replace(/^([^\.]+)$/,"$1."+jn(i[1])).replace(/\.$/,"."+jn(i[1])).replace(/\.(\d*)$/,function(y,g){return"."+g+ur("0",jn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+ij(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Is(Ll(f,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_a(e,t,-r):Is(""+(Math.floor(r)+jX(r,i[1].length)))+"."+Qa(sj(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return _a(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ql(_a(e,t.replace(/[\\-]/g,""),r)),s=0,Ql(Ql(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(pP))return a=_a(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=kh(f,Math.pow(10,s)-1,!1),a=""+d,h=Wi("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=Eh(l[2],s),h.length<i[4].length&&(h=jn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=kh(f,Math.pow(10,s)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Eb(l[1],s)+i[2]+"/"+i[3]+Eh(l[2],s):ur(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Ll(r,0),t.length<=a.length?a:jn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,x=t.length-a.length-m;return jn(t.substr(0,m)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=sj(r,i[1].length),r<0?"-"+_a(e,t,-r):Is(CX(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Qa(0,3-y.length):"")+y})+"."+Qa(s,i[1].length);switch(t){case"###,##0.00":return _a(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=Is(Ll(f,0));return v!=="0"?d+v:"";case"###,###.00":return _a(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return _a(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function AX(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function TX(e,t,r){var n=t.replace(uP,""),a=t.length-n.length;return Wi(e,n,r*Math.pow(10,2*a))+ur("%",a)}function xP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+xP(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,f,d,h){return f+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(mP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fi("n",n,r):"("+fi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return AX(e,t,r);if(t.indexOf("%")!==-1)return TX(e,t,r);if(t.indexOf("E")!==-1)return xP(t,r);if(t.charCodeAt(0)===36)return"$"+fi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Qa(f,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:jn(t.substr(0,t.length-a.length))+a;if(i=t.match(dP))return kX(i,f,d);if(t.match(/^#+0+$/))return d+Qa(f,t.length-t.indexOf("0"));if(i=t.match(hP))return a=(""+r).replace(/^([^\.]+)$/,"$1."+jn(i[1])).replace(/\.$/,"."+jn(i[1])),a=a.replace(/\.(\d*)$/,function(y,g){return"."+g+ur("0",jn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Is(""+f);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fi(e,t,-r):Is(""+r)+"."+ur("0",i[1].length);if(i=t.match(/^#,#*,#0/))return fi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ql(fi(e,t.replace(/[\\-]/g,""),r)),s=0,Ql(Ql(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(pP))return a=fi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=kh(f,Math.pow(10,s)-1,!1),a=""+d,h=Wi("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=Eh(l[2],s),h.length<i[4].length&&(h=jn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=kh(f,Math.pow(10,s)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Eb(l[1],s)+i[2]+"/"+i[3]+Eh(l[2],s):ur(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:jn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,x=t.length-a.length-m;return jn(t.substr(0,m)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fi(e,t,-r):Is(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Qa(0,3-y.length):"")+y})+"."+Qa(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Is(""+f);return v!=="0"?d+v:"";default:if(t.match(/\.[0#?]*$/))return fi(e,t.slice(0,t.lastIndexOf(".")),r)+jn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wi(e,t,r){return(r|0)===r?fi(e,t,r):_a(e,t,r)}function PX(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var gP=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ac(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":_h(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(gP))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function OX(e,t,r,n){for(var a=[],i="",s=0,l="",f="t",d,h,m,x="H";s<e.length;)switch(l=e.charAt(s)){case"G":if(!_h(e,s))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(m=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++s;break;case"\\":var v=e.charAt(++s),y=v==="("||v===")"?v:"t";a[a.length]={t:y,v},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(d==null&&(d=Po(t,r,e.charAt(s+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},f=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Po(t,r),d==null))return"";for(i=l;++s<e.length&&e.charAt(s).toLowerCase()===l;)i+=l;l==="m"&&f.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=x),a[a.length]={t:l,v:i},f=l;break;case"A":case"a":case"上":var g={t:l,v:l};if(d==null&&(d=Po(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(d!=null&&(g.v=d.H>=12?"P":"A"),g.t="T",x="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(d!=null&&(g.v=d.H>=12?"PM":"AM"),g.t="T",s+=5,x="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(d!=null&&(g.v=d.H>=12?"下午":"上午"),g.t="T",s+=5,x="h"):(g.t="t",++s),d==null&&g.t==="T")return"";a[a.length]=g,f=l;break;case"[":for(i=l;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(gP)){if(d==null&&(d=Po(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ac(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++s<e.length&&(l=e.charAt(s))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++s<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(s))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++s)===l;)i+=l;a[a.length]={t:l,v:i},f=l;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++s;break}var b=0,N=0,_;for(s=a.length-1,f="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=x,f="h",b<1&&(b=1);break;case"s":(_=a[s].v.match(/\.0+$/))&&(N=Math.max(N,_[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":f=a[s].t;break;case"m":f==="s"&&(a[s].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[s].v.match(/[Hh]/)&&(b=1),b<2&&a[s].v.match(/[Mm]/)&&(b=2),b<3&&a[s].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var S="",C;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=SX(a[s].t.charCodeAt(0),a[s].v,d,N),a[s].t="t";break;case"n":case"?":for(C=s+1;a[C]!=null&&((l=a[C].t)==="?"||l==="D"||(l===" "||l==="t")&&a[C+1]!=null&&(a[C+1].t==="?"||a[C+1].t==="t"&&a[C+1].v==="/")||a[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[C].v==="/"||a[C].v===" "&&a[C+1]!=null&&a[C+1].t=="?"));)a[s].v+=a[C].v,a[C]={v:"",t:";"},++C;S+=a[s].v,s=C-1;break;case"G":a[s].t="t",a[s].v=qo(t,r);break}var T="",k,P;if(S.length>0){S.charCodeAt(0)==40?(k=t<0&&S.charCodeAt(0)===45?-t:t,P=Wi("n",S,k)):(k=t<0&&n>1?-t:t,P=Wi("n",S,k),k<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),C=P.length-1;var D=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){D=s;break}var R=a.length;if(D===a.length&&P.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(C>=a[s].v.length-1?(C-=a[s].v.length,a[s].v=P.substr(C+1,a[s].v.length)):C<0?a[s].v="":(a[s].v=P.substr(0,C+1),C=-1),a[s].t="t",R=s);C>=0&&R<a.length&&(a[R].v=P.substr(0,C+1)+a[R].v)}else if(D!==a.length&&P.indexOf("E")===-1){for(C=P.indexOf(".")-1,s=D;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(h=a[s].v.indexOf(".")>-1&&s===D?a[s].v.indexOf(".")-1:a[s].v.length-1,T=a[s].v.substr(h+1);h>=0;--h)C>=0&&(a[s].v.charAt(h)==="0"||a[s].v.charAt(h)==="#")&&(T=P.charAt(C--)+T);a[s].v=T,a[s].t="t",R=s}for(C>=0&&R<a.length&&(a[R].v=P.substr(0,C+1)+a[R].v),C=P.indexOf(".")+1,s=D;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==D)){for(h=a[s].v.indexOf(".")>-1&&s===D?a[s].v.indexOf(".")+1:0,T=a[s].v.substr(0,h);h<a[s].v.length;++h)C<P.length&&(T+=P.charAt(C++));a[s].v=T,a[s].t="t",R=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(k=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Wi(a[s].t,a[s].v,k),a[s].t="t");var G="";for(s=0;s!==a.length;++s)a[s]!=null&&(G+=a[s].v);return G}var oj=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function lj(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function FX(e,t){var r=PX(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(oj),l=r[1].match(oj);return lj(t,s)?[n,r[0]]:lj(t,l)?[n,r[1]]:[n,r[s!=null&&l!=null?2:1]]}return[n,i]}function Ma(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[e],n==null&&(n=r.table&&r.table[aj[e]]||it[aj[e]]),n==null&&(n=pX[e]||"General");break}if(_h(n,0))return qo(t,r);t instanceof Date&&(t=cP(t,r.date1904));var a=FX(n,t);if(_h(a[1]))return qo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return OX(a[1],t,r,a[0])}function Hi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(it[r]==null){t<0&&(t=r);continue}if(it[r]==e){t=r;break}}t<0&&(t=391)}return it[t]=e,t}function wm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Hi(e[t],t)}function Tc(){it=mX()}var DX={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vP=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function IX(e){var t=typeof e=="number"?it[e]:e;return t=t.replace(vP,"(\\d+)"),new RegExp("^"+t+"$")}function MX(e,t,r){var n=-1,a=-1,i=-1,s=-1,l=-1,f=-1;(t.match(vP)||[]).forEach(function(m,x){var v=parseInt(r[x+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=v;break;case"d":i=v;break;case"h":s=v;break;case"s":f=v;break;case"m":s>=0?l=v:a=v;break}}),f>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return s==-1&&l==-1&&f==-1?d:n==-1&&a==-1&&i==-1?h:d+"T"+h}var RX=(function(){var e={};e.version="1.2.0";function t(){for(var P=0,D=new Array(256),R=0;R!=256;++R)P=R,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,D[R]=P;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(P){var D=0,R=0,G=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)M[G]=P[G];for(G=0;G!=256;++G)for(R=P[G],D=256+G;D<4096;D+=256)R=M[D]=R>>>8^P[R&255];var H=[];for(G=1;G!=16;++G)H[G-1]=typeof Int32Array<"u"?M.subarray(G*256,G*256+256):M.slice(G*256,G*256+256);return H}var a=n(r),i=a[0],s=a[1],l=a[2],f=a[3],d=a[4],h=a[5],m=a[6],x=a[7],v=a[8],y=a[9],g=a[10],b=a[11],N=a[12],_=a[13],S=a[14];function C(P,D){for(var R=D^-1,G=0,M=P.length;G<M;)R=R>>>8^r[(R^P.charCodeAt(G++))&255];return~R}function T(P,D){for(var R=D^-1,G=P.length-15,M=0;M<G;)R=S[P[M++]^R&255]^_[P[M++]^R>>8&255]^N[P[M++]^R>>16&255]^b[P[M++]^R>>>24]^g[P[M++]]^y[P[M++]]^v[P[M++]]^x[P[M++]]^m[P[M++]]^h[P[M++]]^d[P[M++]]^f[P[M++]]^l[P[M++]]^s[P[M++]]^i[P[M++]]^r[P[M++]];for(G+=15;M<G;)R=R>>>8^r[(R^P[M++])&255];return~R}function k(P,D){for(var R=D^-1,G=0,M=P.length,H=0,z=0;G<M;)H=P.charCodeAt(G++),H<128?R=R>>>8^r[(R^H)&255]:H<2048?(R=R>>>8^r[(R^(192|H>>6&31))&255],R=R>>>8^r[(R^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,z=P.charCodeAt(G++)&1023,R=R>>>8^r[(R^(240|H>>8&7))&255],R=R>>>8^r[(R^(128|H>>2&63))&255],R=R>>>8^r[(R^(128|z>>6&15|(H&3)<<4))&255],R=R>>>8^r[(R^(128|z&63))&255]):(R=R>>>8^r[(R^(224|H>>12&15))&255],R=R>>>8^r[(R^(128|H>>6&63))&255],R=R>>>8^r[(R^(128|H&63))&255]);return~R}return e.table=r,e.bstr=C,e.buf=T,e.str=k,e})(),tt=(function(){var t={};t.version="1.2.1";function r(B,Z){for(var q=B.split("/"),Y=Z.split("/"),te=0,re=0,ye=Math.min(q.length,Y.length);te<ye;++te){if(re=q[te].length-Y[te].length)return re;if(q[te]!=Y[te])return q[te]<Y[te]?-1:1}return q.length-Y.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var Z=B.lastIndexOf("/");return Z===-1?B:B.slice(0,Z+1)}function a(B){if(B.charAt(B.length-1)=="/")return a(B.slice(0,-1));var Z=B.lastIndexOf("/");return Z===-1?B:B.slice(Z+1)}function i(B,Z){typeof Z=="string"&&(Z=new Date(Z));var q=Z.getHours();q=q<<6|Z.getMinutes(),q=q<<5|Z.getSeconds()>>>1,B.write_shift(2,q);var Y=Z.getFullYear()-1980;Y=Y<<4|Z.getMonth()+1,Y=Y<<5|Z.getDate(),B.write_shift(2,Y)}function s(B){var Z=B.read_shift(2)&65535,q=B.read_shift(2)&65535,Y=new Date,te=q&31;q>>>=5;var re=q&15;q>>>=4,Y.setMilliseconds(0),Y.setFullYear(q+1980),Y.setMonth(re-1),Y.setDate(te);var ye=Z&31;Z>>>=5;var _e=Z&63;return Z>>>=6,Y.setHours(Z),Y.setMinutes(_e),Y.setSeconds(ye<<1),Y}function l(B){sn(B,0);for(var Z={},q=0;B.l<=B.length-4;){var Y=B.read_shift(2),te=B.read_shift(2),re=B.l+te,ye={};switch(Y){case 21589:q=B.read_shift(1),q&1&&(ye.mtime=B.read_shift(4)),te>5&&(q&2&&(ye.atime=B.read_shift(4)),q&4&&(ye.ctime=B.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}B.l=re,Z[Y]=ye}return Z}var f;function d(){return f||(f={})}function h(B,Z){if(B[0]==80&&B[1]==75)return Zr(B,Z);if((B[0]|32)==109&&(B[1]|32)==105)return Yf(B,Z);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var q=3,Y=512,te=0,re=0,ye=0,_e=0,ve=0,be=[],we=B.slice(0,512);sn(we,0);var Fe=m(we);switch(q=Fe[0],q){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Fe[1]==0)return Zr(B,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}Y!==512&&(we=B.slice(0,Y),sn(we,28));var $e=B.slice(0,Y);x(we,q);var Ve=we.read_shift(4,"i");if(q===3&&Ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ve);we.l+=4,ye=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),_e=we.read_shift(4,"i"),te=we.read_shift(4,"i"),ve=we.read_shift(4,"i"),re=we.read_shift(4,"i");for(var Me=-1,Ie=0;Ie<109&&(Me=we.read_shift(4,"i"),!(Me<0));++Ie)be[Ie]=Me;var dt=v(B,Y);b(ve,re,dt,Y,be);var Bt=_(dt,ye,be,Y);Bt[ye].name="!Directory",te>0&&_e!==z&&(Bt[_e].name="!MiniFAT"),Bt[be[0]].name="!FAT",Bt.fat_addrs=be,Bt.ssz=Y;var Ut={},mr=[],oo=[],ls=[];S(ye,Bt,dt,mr,te,Ut,oo,_e),y(oo,ls,mr),mr.shift();var ai={FileIndex:oo,FullPaths:ls};return Z&&Z.raw&&(ai.raw={header:$e,sectors:dt}),ai}function m(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(ne,"Header Signature: "),B.l+=16;var Z=B.read_shift(2,"u");return[B.read_shift(2,"u"),Z]}function x(B,Z){var q=9;switch(B.l+=2,q=B.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function v(B,Z){for(var q=Math.ceil(B.length/Z)-1,Y=[],te=1;te<q;++te)Y[te-1]=B.slice(te*Z,(te+1)*Z);return Y[q-1]=B.slice(q*Z),Y}function y(B,Z,q){for(var Y=0,te=0,re=0,ye=0,_e=0,ve=q.length,be=[],we=[];Y<ve;++Y)be[Y]=we[Y]=Y,Z[Y]=q[Y];for(;_e<we.length;++_e)Y=we[_e],te=B[Y].L,re=B[Y].R,ye=B[Y].C,be[Y]===Y&&(te!==-1&&be[te]!==te&&(be[Y]=be[te]),re!==-1&&be[re]!==re&&(be[Y]=be[re])),ye!==-1&&(be[ye]=Y),te!==-1&&Y!=be[Y]&&(be[te]=be[Y],we.lastIndexOf(te)<_e&&we.push(te)),re!==-1&&Y!=be[Y]&&(be[re]=be[Y],we.lastIndexOf(re)<_e&&we.push(re));for(Y=1;Y<ve;++Y)be[Y]===Y&&(re!==-1&&be[re]!==re?be[Y]=be[re]:te!==-1&&be[te]!==te&&(be[Y]=be[te]));for(Y=1;Y<ve;++Y)if(B[Y].type!==0){if(_e=Y,_e!=be[_e])do _e=be[_e],Z[Y]=Z[_e]+"/"+Z[Y];while(_e!==0&&be[_e]!==-1&&_e!=be[_e]);be[Y]=-1}for(Z[0]+="/",Y=1;Y<ve;++Y)B[Y].type!==2&&(Z[Y]+="/")}function g(B,Z,q){for(var Y=B.start,te=B.size,re=[],ye=Y;q&&te>0&&ye>=0;)re.push(Z.slice(ye*H,ye*H+H)),te-=H,ye=ko(q,ye*4);return re.length===0?Ee(0):Vr(re).slice(0,B.size)}function b(B,Z,q,Y,te){var re=z;if(B===z){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var ye=q[B],_e=(Y>>>2)-1;if(!ye)return;for(var ve=0;ve<_e&&(re=ko(ye,ve*4))!==z;++ve)te.push(re);b(ko(ye,Y-4),Z-1,q,Y,te)}}function N(B,Z,q,Y,te){var re=[],ye=[];te||(te=[]);var _e=Y-1,ve=0,be=0;for(ve=Z;ve>=0;){te[ve]=!0,re[re.length]=ve,ye.push(B[ve]);var we=q[Math.floor(ve*4/Y)];if(be=ve*4&_e,Y<4+be)throw new Error("FAT boundary crossed: "+ve+" 4 "+Y);if(!B[we])break;ve=ko(B[we],be)}return{nodes:re,data:bj([ye])}}function _(B,Z,q,Y){var te=B.length,re=[],ye=[],_e=[],ve=[],be=Y-1,we=0,Fe=0,$e=0,Ve=0;for(we=0;we<te;++we)if(_e=[],$e=we+Z,$e>=te&&($e-=te),!ye[$e]){ve=[];var Me=[];for(Fe=$e;Fe>=0;){Me[Fe]=!0,ye[Fe]=!0,_e[_e.length]=Fe,ve.push(B[Fe]);var Ie=q[Math.floor(Fe*4/Y)];if(Ve=Fe*4&be,Y<4+Ve)throw new Error("FAT boundary crossed: "+Fe+" 4 "+Y);if(!B[Ie]||(Fe=ko(B[Ie],Ve),Me[Fe]))break}re[$e]={nodes:_e,data:bj([ve])}}return re}function S(B,Z,q,Y,te,re,ye,_e){for(var ve=0,be=Y.length?2:0,we=Z[B].data,Fe=0,$e=0,Ve;Fe<we.length;Fe+=128){var Me=we.slice(Fe,Fe+128);sn(Me,64),$e=Me.read_shift(2),Ve=Ob(Me,0,$e-be),Y.push(Ve);var Ie={name:Ve,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},dt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);dt!==0&&(Ie.ct=C(Me,Me.l-8));var Bt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Bt!==0&&(Ie.mt=C(Me,Me.l-8)),Ie.start=Me.read_shift(4,"i"),Ie.size=Me.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=z,Ie.name=""),Ie.type===5?(ve=Ie.start,te>0&&ve!==z&&(Z[ve].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",Z[Ie.start]===void 0&&(Z[Ie.start]=N(q,Ie.start,Z.fat_addrs,Z.ssz)),Z[Ie.start].name=Ie.name,Ie.content=Z[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:ve!==z&&Ie.start!==z&&Z[ve]&&(Ie.content=g(Ie,Z[ve].data,(Z[_e]||{}).data))),Ie.content&&sn(Ie.content,0),re[Ve]=Ie,ye.push(Ie)}}function C(B,Z){return new Date((na(B,Z+4)/1e7*Math.pow(2,32)+na(B,Z)/1e7-11644473600)*1e3)}function T(B,Z){return d(),h(f.readFileSync(B),Z)}function k(B,Z){var q=Z&&Z.type;switch(q||xt&&Buffer.isBuffer(B)&&(q="buffer"),q||"base64"){case"file":return T(B,Z);case"base64":return h(ia(da(B)),Z);case"binary":return h(ia(B),Z)}return h(B,Z)}function P(B,Z){var q=Z||{},Y=q.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=Y+"/",B.FileIndex[0]={name:Y,type:5}),q.CLSID&&(B.FileIndex[0].clsid=q.CLSID),D(B)}function D(B){var Z="Sh33tJ5";if(!tt.find(B,"/"+Z)){var q=Ee(4);q[0]=55,q[1]=q[3]=50,q[2]=54,B.FileIndex.push({name:Z,type:2,content:q,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+Z),R(B)}}function R(B,Z){P(B);for(var q=!1,Y=!1,te=B.FullPaths.length-1;te>=0;--te){var re=B.FileIndex[te];switch(re.type){case 0:Y?q=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(re.R*re.L*re.C)&&(q=!0),re.R>-1&&re.L>-1&&re.R==re.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!Z)){var ye=new Date(1987,1,19),_e=0,ve=Object.create?Object.create(null):{},be=[];for(te=0;te<B.FullPaths.length;++te)ve[B.FullPaths[te]]=!0,B.FileIndex[te].type!==0&&be.push([B.FullPaths[te],B.FileIndex[te]]);for(te=0;te<be.length;++te){var we=n(be[te][0]);Y=ve[we],Y||(be.push([we,{name:a(we).replace("/",""),type:1,clsid:le,ct:ye,mt:ye,content:null}]),ve[we]=!0)}for(be.sort(function(Ve,Me){return r(Ve[0],Me[0])}),B.FullPaths=[],B.FileIndex=[],te=0;te<be.length;++te)B.FullPaths[te]=be[te][0],B.FileIndex[te]=be[te][1];for(te=0;te<be.length;++te){var Fe=B.FileIndex[te],$e=B.FullPaths[te];if(Fe.name=a($e).replace("/",""),Fe.L=Fe.R=Fe.C=-(Fe.color=1),Fe.size=Fe.content?Fe.content.length:0,Fe.start=0,Fe.clsid=Fe.clsid||le,te===0)Fe.C=be.length>1?1:-1,Fe.size=0,Fe.type=5;else if($e.slice(-1)=="/"){for(_e=te+1;_e<be.length&&n(B.FullPaths[_e])!=$e;++_e);for(Fe.C=_e>=be.length?-1:_e,_e=te+1;_e<be.length&&n(B.FullPaths[_e])!=n($e);++_e);Fe.R=_e>=be.length?-1:_e,Fe.type=1}else n(B.FullPaths[te+1]||"")==n($e)&&(Fe.R=te+1),Fe.type=2}}}function G(B,Z){var q=Z||{};if(q.fileType=="mad")return io(B,q);switch(R(B),q.fileType){case"zip":return Dn(B,q)}var Y=(function(Ve){for(var Me=0,Ie=0,dt=0;dt<Ve.FileIndex.length;++dt){var Bt=Ve.FileIndex[dt];if(Bt.content){var Ut=Bt.content.length;Ut>0&&(Ut<4096?Me+=Ut+63>>6:Ie+=Ut+511>>9)}}for(var mr=Ve.FullPaths.length+3>>2,oo=Me+7>>3,ls=Me+127>>7,ai=oo+Ie+mr+ls,Br=ai+127>>7,Mc=Br<=109?0:Math.ceil((Br-109)/127);ai+Br+Mc+127>>7>Br;)Mc=++Br<=109?0:Math.ceil((Br-109)/127);var pr=[1,Mc,Br,ls,mr,Ie,Me,0];return Ve.FileIndex[0].size=Me<<6,pr[7]=(Ve.FileIndex[0].start=pr[0]+pr[1]+pr[2]+pr[3]+pr[4]+pr[5])+(pr[6]+7>>3),pr})(B),te=Ee(Y[7]<<9),re=0,ye=0;{for(re=0;re<8;++re)te.write_shift(1,Q[re]);for(re=0;re<8;++re)te.write_shift(2,0);for(te.write_shift(2,62),te.write_shift(2,3),te.write_shift(2,65534),te.write_shift(2,9),te.write_shift(2,6),re=0;re<3;++re)te.write_shift(2,0);for(te.write_shift(4,0),te.write_shift(4,Y[2]),te.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),te.write_shift(4,0),te.write_shift(4,4096),te.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:z),te.write_shift(4,Y[3]),te.write_shift(-4,Y[1]?Y[0]-1:z),te.write_shift(4,Y[1]),re=0;re<109;++re)te.write_shift(-4,re<Y[2]?Y[1]+re:-1)}if(Y[1])for(ye=0;ye<Y[1];++ye){for(;re<236+ye*127;++re)te.write_shift(-4,re<Y[2]?Y[1]+re:-1);te.write_shift(-4,ye===Y[1]-1?z:ye+1)}var _e=function(Ve){for(ye+=Ve;re<ye-1;++re)te.write_shift(-4,re+1);Ve&&(++re,te.write_shift(-4,z))};for(ye=re=0,ye+=Y[1];re<ye;++re)te.write_shift(-4,ue.DIFSECT);for(ye+=Y[2];re<ye;++re)te.write_shift(-4,ue.FATSECT);_e(Y[3]),_e(Y[4]);for(var ve=0,be=0,we=B.FileIndex[0];ve<B.FileIndex.length;++ve)we=B.FileIndex[ve],we.content&&(be=we.content.length,!(be<4096)&&(we.start=ye,_e(be+511>>9)));for(_e(Y[6]+7>>3);te.l&511;)te.write_shift(-4,ue.ENDOFCHAIN);for(ye=re=0,ve=0;ve<B.FileIndex.length;++ve)we=B.FileIndex[ve],we.content&&(be=we.content.length,!(!be||be>=4096)&&(we.start=ye,_e(be+63>>6)));for(;te.l&511;)te.write_shift(-4,ue.ENDOFCHAIN);for(re=0;re<Y[4]<<2;++re){var Fe=B.FullPaths[re];if(!Fe||Fe.length===0){for(ve=0;ve<17;++ve)te.write_shift(4,0);for(ve=0;ve<3;++ve)te.write_shift(4,-1);for(ve=0;ve<12;++ve)te.write_shift(4,0);continue}we=B.FileIndex[re],re===0&&(we.start=we.size?we.start-1:z);var $e=re===0&&q.root||we.name;if(be=2*($e.length+1),te.write_shift(64,$e,"utf16le"),te.write_shift(2,be),te.write_shift(1,we.type),te.write_shift(1,we.color),te.write_shift(-4,we.L),te.write_shift(-4,we.R),te.write_shift(-4,we.C),we.clsid)te.write_shift(16,we.clsid,"hex");else for(ve=0;ve<4;++ve)te.write_shift(4,0);te.write_shift(4,we.state||0),te.write_shift(4,0),te.write_shift(4,0),te.write_shift(4,0),te.write_shift(4,0),te.write_shift(4,we.start),te.write_shift(4,we.size),te.write_shift(4,0)}for(re=1;re<B.FileIndex.length;++re)if(we=B.FileIndex[re],we.size>=4096)if(te.l=we.start+1<<9,xt&&Buffer.isBuffer(we.content))we.content.copy(te,te.l,0,we.size),te.l+=we.size+511&-512;else{for(ve=0;ve<we.size;++ve)te.write_shift(1,we.content[ve]);for(;ve&511;++ve)te.write_shift(1,0)}for(re=1;re<B.FileIndex.length;++re)if(we=B.FileIndex[re],we.size>0&&we.size<4096)if(xt&&Buffer.isBuffer(we.content))we.content.copy(te,te.l,0,we.size),te.l+=we.size+63&-64;else{for(ve=0;ve<we.size;++ve)te.write_shift(1,we.content[ve]);for(;ve&63;++ve)te.write_shift(1,0)}if(xt)te.l=te.length;else for(;te.l<te.length;)te.write_shift(1,0);return te}function M(B,Z){var q=B.FullPaths.map(function(ve){return ve.toUpperCase()}),Y=q.map(function(ve){var be=ve.split("/");return be[be.length-(ve.slice(-1)=="/"?2:1)]}),te=!1;Z.charCodeAt(0)===47?(te=!0,Z=q[0].slice(0,-1)+Z):te=Z.indexOf("/")!==-1;var re=Z.toUpperCase(),ye=te===!0?q.indexOf(re):Y.indexOf(re);if(ye!==-1)return B.FileIndex[ye];var _e=!re.match(Ou);for(re=re.replace(Pn,""),_e&&(re=re.replace(Ou,"!")),ye=0;ye<q.length;++ye)if((_e?q[ye].replace(Ou,"!"):q[ye]).replace(Pn,"")==re||(_e?Y[ye].replace(Ou,"!"):Y[ye]).replace(Pn,"")==re)return B.FileIndex[ye];return null}var H=64,z=-2,ne="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],le="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(B,Z,q){d();var Y=G(B,q);f.writeFileSync(Z,Y)}function K(B){for(var Z=new Array(B.length),q=0;q<B.length;++q)Z[q]=String.fromCharCode(B[q]);return Z.join("")}function me(B,Z){var q=G(B,Z);switch(Z&&Z.type||"buffer"){case"file":return d(),f.writeFileSync(Z.filename,q),q;case"binary":return typeof q=="string"?q:K(q);case"base64":return lf(typeof q=="string"?q:K(q));case"buffer":if(xt)return Buffer.isBuffer(q)?q:is(q);case"array":return typeof q=="string"?ia(q):q}return q}var J;function O(B){try{var Z=B.InflateRaw,q=new Z;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)J=B;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function ae(B,Z){if(!J)return Sr(B,Z);var q=J.InflateRaw,Y=new q,te=Y._processChunk(B.slice(B.l),Y._finishFlushFlag);return B.l+=Y.bytesRead,te}function ee(B){return J?J.deflateRawSync(B):ut(B)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function U(B){var Z=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var W=typeof Uint8Array<"u",X=W?new Uint8Array(256):[],de=0;de<256;++de)X[de]=U(de);function F(B,Z){var q=X[B&255];return Z<=8?q>>>8-Z:(q=q<<8|X[B>>8&255],Z<=16?q>>>16-Z:(q=q<<8|X[B>>16&255],q>>>24-Z))}function Pe(B,Z){var q=Z&7,Y=Z>>>3;return(B[Y]|(q<=6?0:B[Y+1]<<8))>>>q&3}function Ae(B,Z){var q=Z&7,Y=Z>>>3;return(B[Y]|(q<=5?0:B[Y+1]<<8))>>>q&7}function We(B,Z){var q=Z&7,Y=Z>>>3;return(B[Y]|(q<=4?0:B[Y+1]<<8))>>>q&15}function Ue(B,Z){var q=Z&7,Y=Z>>>3;return(B[Y]|(q<=3?0:B[Y+1]<<8))>>>q&31}function Te(B,Z){var q=Z&7,Y=Z>>>3;return(B[Y]|(q<=1?0:B[Y+1]<<8))>>>q&127}function lt(B,Z,q){var Y=Z&7,te=Z>>>3,re=(1<<q)-1,ye=B[te]>>>Y;return q<8-Y||(ye|=B[te+1]<<8-Y,q<16-Y)||(ye|=B[te+2]<<16-Y,q<24-Y)||(ye|=B[te+3]<<24-Y),ye&re}function jt(B,Z,q){var Y=Z&7,te=Z>>>3;return Y<=5?B[te]|=(q&7)<<Y:(B[te]|=q<<Y&255,B[te+1]=(q&7)>>8-Y),Z+3}function Yt(B,Z,q){var Y=Z&7,te=Z>>>3;return q=(q&1)<<Y,B[te]|=q,Z+1}function Ct(B,Z,q){var Y=Z&7,te=Z>>>3;return q<<=Y,B[te]|=q&255,q>>>=8,B[te+1]=q,Z+8}function Ua(B,Z,q){var Y=Z&7,te=Z>>>3;return q<<=Y,B[te]|=q&255,q>>>=8,B[te+1]=q&255,B[te+2]=q>>>8,Z+16}function On(B,Z){var q=B.length,Y=2*q>Z?2*q:Z+5,te=0;if(q>=Z)return B;if(xt){var re=tj(Y);if(B.copy)B.copy(re);else for(;te<B.length;++te)re[te]=B[te];return re}else if(W){var ye=new Uint8Array(Y);if(ye.set)ye.set(B);else for(;te<q;++te)ye[te]=B[te];return ye}return B.length=Y,B}function Lr(B){for(var Z=new Array(B),q=0;q<B;++q)Z[q]=0;return Z}function rr(B,Z,q){var Y=1,te=0,re=0,ye=0,_e=0,ve=B.length,be=W?new Uint16Array(32):Lr(32);for(re=0;re<32;++re)be[re]=0;for(re=ve;re<q;++re)B[re]=0;ve=B.length;var we=W?new Uint16Array(ve):Lr(ve);for(re=0;re<ve;++re)be[te=B[re]]++,Y<te&&(Y=te),we[re]=0;for(be[0]=0,re=1;re<=Y;++re)be[re+16]=_e=_e+be[re-1]<<1;for(re=0;re<ve;++re)_e=B[re],_e!=0&&(we[re]=be[_e+16]++);var Fe=0;for(re=0;re<ve;++re)if(Fe=B[re],Fe!=0)for(_e=F(we[re],Y)>>Y-Fe,ye=(1<<Y+4-Fe)-1;ye>=0;--ye)Z[_e|ye<<Fe]=Fe&15|re<<4;return Y}var Fn=W?new Uint16Array(512):Lr(512),Qr=W?new Uint16Array(32):Lr(32);if(!W){for(var nr=0;nr<512;++nr)Fn[nr]=0;for(nr=0;nr<32;++nr)Qr[nr]=0}(function(){for(var B=[],Z=0;Z<32;Z++)B.push(5);rr(B,Qr,32);var q=[];for(Z=0;Z<=143;Z++)q.push(8);for(;Z<=255;Z++)q.push(9);for(;Z<=279;Z++)q.push(7);for(;Z<=287;Z++)q.push(8);rr(q,Fn,288)})();var En=(function(){for(var Z=W?new Uint8Array(32768):[],q=0,Y=0;q<se.length-1;++q)for(;Y<se[q+1];++Y)Z[Y]=q;for(;Y<32768;++Y)Z[Y]=29;var te=W?new Uint8Array(259):[];for(q=0,Y=0;q<V.length-1;++q)for(;Y<V[q+1];++Y)te[Y]=q;function re(_e,ve){for(var be=0;be<_e.length;){var we=Math.min(65535,_e.length-be),Fe=be+we==_e.length;for(ve.write_shift(1,+Fe),ve.write_shift(2,we),ve.write_shift(2,~we&65535);we-- >0;)ve[ve.l++]=_e[be++]}return ve.l}function ye(_e,ve){for(var be=0,we=0,Fe=W?new Uint16Array(32768):[];we<_e.length;){var $e=Math.min(65535,_e.length-we);if($e<10){for(be=jt(ve,be,+(we+$e==_e.length)),be&7&&(be+=8-(be&7)),ve.l=be/8|0,ve.write_shift(2,$e),ve.write_shift(2,~$e&65535);$e-- >0;)ve[ve.l++]=_e[we++];be=ve.l*8;continue}be=jt(ve,be,+(we+$e==_e.length)+2);for(var Ve=0;$e-- >0;){var Me=_e[we];Ve=(Ve<<5^Me)&32767;var Ie=-1,dt=0;if((Ie=Fe[Ve])&&(Ie|=we&-32768,Ie>we&&(Ie-=32768),Ie<we))for(;_e[Ie+dt]==_e[we+dt]&&dt<250;)++dt;if(dt>2){Me=te[dt],Me<=22?be=Ct(ve,be,X[Me+1]>>1)-1:(Ct(ve,be,3),be+=5,Ct(ve,be,X[Me-23]>>5),be+=3);var Bt=Me<8?0:Me-4>>2;Bt>0&&(Ua(ve,be,dt-V[Me]),be+=Bt),Me=Z[we-Ie],be=Ct(ve,be,X[Me]>>3),be-=3;var Ut=Me<4?0:Me-2>>1;Ut>0&&(Ua(ve,be,we-Ie-se[Me]),be+=Ut);for(var mr=0;mr<dt;++mr)Fe[Ve]=we&32767,Ve=(Ve<<5^_e[we])&32767,++we;$e-=dt-1}else Me<=143?Me=Me+48:be=Yt(ve,be,1),be=Ct(ve,be,X[Me]),Fe[Ve]=we&32767,++we}be=Ct(ve,be,0)-1}return ve.l=(be+7)/8|0,ve.l}return function(ve,be){return ve.length<8?re(ve,be):ye(ve,be)}})();function ut(B){var Z=Ee(50+Math.floor(B.length*1.1)),q=En(B,Z);return Z.slice(0,q)}var At=W?new Uint16Array(32768):Lr(32768),oe=W?new Uint16Array(32768):Lr(32768),ke=W?new Uint16Array(128):Lr(128),Ke=1,et=1;function ze(B,Z){var q=Ue(B,Z)+257;Z+=5;var Y=Ue(B,Z)+1;Z+=5;var te=We(B,Z)+4;Z+=4;for(var re=0,ye=W?new Uint8Array(19):Lr(19),_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,be=W?new Uint8Array(8):Lr(8),we=W?new Uint8Array(8):Lr(8),Fe=ye.length,$e=0;$e<te;++$e)ye[L[$e]]=re=Ae(B,Z),ve<re&&(ve=re),be[re]++,Z+=3;var Ve=0;for(be[0]=0,$e=1;$e<=ve;++$e)we[$e]=Ve=Ve+be[$e-1]<<1;for($e=0;$e<Fe;++$e)(Ve=ye[$e])!=0&&(_e[$e]=we[Ve]++);var Me=0;for($e=0;$e<Fe;++$e)if(Me=ye[$e],Me!=0){Ve=X[_e[$e]]>>8-Me;for(var Ie=(1<<7-Me)-1;Ie>=0;--Ie)ke[Ve|Ie<<Me]=Me&7|$e<<3}var dt=[];for(ve=1;dt.length<q+Y;)switch(Ve=ke[Te(B,Z)],Z+=Ve&7,Ve>>>=3){case 16:for(re=3+Pe(B,Z),Z+=2,Ve=dt[dt.length-1];re-- >0;)dt.push(Ve);break;case 17:for(re=3+Ae(B,Z),Z+=3;re-- >0;)dt.push(0);break;case 18:for(re=11+Te(B,Z),Z+=7;re-- >0;)dt.push(0);break;default:dt.push(Ve),ve<Ve&&(ve=Ve);break}var Bt=dt.slice(0,q),Ut=dt.slice(q);for($e=q;$e<286;++$e)Bt[$e]=0;for($e=Y;$e<30;++$e)Ut[$e]=0;return Ke=rr(Bt,At,286),et=rr(Ut,oe,30),Z}function at(B,Z){if(B[0]==3&&!(B[1]&3))return[Ws(Z),2];for(var q=0,Y=0,te=tj(Z||1<<18),re=0,ye=te.length>>>0,_e=0,ve=0;(Y&1)==0;){if(Y=Ae(B,q),q+=3,Y>>>1)Y>>1==1?(_e=9,ve=5):(q=ze(B,q),_e=Ke,ve=et);else{q&7&&(q+=8-(q&7));var be=B[q>>>3]|B[(q>>>3)+1]<<8;if(q+=32,be>0)for(!Z&&ye<re+be&&(te=On(te,re+be),ye=te.length);be-- >0;)te[re++]=B[q>>>3],q+=8;continue}for(;;){!Z&&ye<re+32767&&(te=On(te,re+32767),ye=te.length);var we=lt(B,q,_e),Fe=Y>>>1==1?Fn[we]:At[we];if(q+=Fe&15,Fe>>>=4,(Fe>>>8&255)===0)te[re++]=Fe;else{if(Fe==256)break;Fe-=257;var $e=Fe<8?0:Fe-4>>2;$e>5&&($e=0);var Ve=re+V[Fe];$e>0&&(Ve+=lt(B,q,$e),q+=$e),we=lt(B,q,ve),Fe=Y>>>1==1?Qr[we]:oe[we],q+=Fe&15,Fe>>>=4;var Me=Fe<4?0:Fe-2>>1,Ie=se[Fe];for(Me>0&&(Ie+=lt(B,q,Me),q+=Me),!Z&&ye<Ve&&(te=On(te,Ve+100),ye=te.length);re<Ve;)te[re]=te[re-Ie],++re}}}return Z?[te,q+7>>>3]:[te.slice(0,re),q+7>>>3]}function Sr(B,Z){var q=B.slice(B.l||0),Y=at(q,Z);return B.l+=Y[1],Y[0]}function hr(B,Z){if(B)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function Zr(B,Z){var q=B;sn(q,0);var Y=[],te=[],re={FileIndex:Y,FullPaths:te};P(re,{root:Z.root});for(var ye=q.length-4;(q[ye]!=80||q[ye+1]!=75||q[ye+2]!=5||q[ye+3]!=6)&&ye>=0;)--ye;q.l=ye+4,q.l+=4;var _e=q.read_shift(2);q.l+=6;var ve=q.read_shift(4);for(q.l=ve,ye=0;ye<_e;++ye){q.l+=20;var be=q.read_shift(4),we=q.read_shift(4),Fe=q.read_shift(2),$e=q.read_shift(2),Ve=q.read_shift(2);q.l+=8;var Me=q.read_shift(4),Ie=l(q.slice(q.l+Fe,q.l+Fe+$e));q.l+=Fe+$e+Ve;var dt=q.l;q.l=Me+4,qn(q,be,we,re,Ie),q.l=dt}return re}function qn(B,Z,q,Y,te){B.l+=2;var re=B.read_shift(2),ye=B.read_shift(2),_e=s(B);if(re&8257)throw new Error("Unsupported ZIP encryption");for(var ve=B.read_shift(4),be=B.read_shift(4),we=B.read_shift(4),Fe=B.read_shift(2),$e=B.read_shift(2),Ve="",Me=0;Me<Fe;++Me)Ve+=String.fromCharCode(B[B.l++]);if($e){var Ie=l(B.slice(B.l,B.l+$e));(Ie[21589]||{}).mt&&(_e=Ie[21589].mt),((te||{})[21589]||{}).mt&&(_e=te[21589].mt)}B.l+=$e;var dt=B.slice(B.l,B.l+be);switch(ye){case 8:dt=ae(B,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var Bt=!1;re&8&&(ve=B.read_shift(4),ve==134695760&&(ve=B.read_shift(4),Bt=!0),be=B.read_shift(4),we=B.read_shift(4)),be!=Z&&hr(Bt,"Bad compressed size: "+Z+" != "+be),we!=q&&hr(Bt,"Bad uncompressed size: "+q+" != "+we),Ni(Y,Ve,dt,{unsafe:!0,mt:_e})}function Dn(B,Z){var q=Z||{},Y=[],te=[],re=Ee(1),ye=q.compression?8:0,_e=0,ve=0,be=0,we=0,Fe=0,$e=B.FullPaths[0],Ve=$e,Me=B.FileIndex[0],Ie=[],dt=0;for(ve=1;ve<B.FullPaths.length;++ve)if(Ve=B.FullPaths[ve].slice($e.length),Me=B.FileIndex[ve],!(!Me.size||!Me.content||Ve=="Sh33tJ5")){var Bt=we,Ut=Ee(Ve.length);for(be=0;be<Ve.length;++be)Ut.write_shift(1,Ve.charCodeAt(be)&127);Ut=Ut.slice(0,Ut.l),Ie[Fe]=RX.buf(Me.content,0);var mr=Me.content;ye==8&&(mr=ee(mr)),re=Ee(30),re.write_shift(4,67324752),re.write_shift(2,20),re.write_shift(2,_e),re.write_shift(2,ye),Me.mt?i(re,Me.mt):re.write_shift(4,0),re.write_shift(-4,Ie[Fe]),re.write_shift(4,mr.length),re.write_shift(4,Me.content.length),re.write_shift(2,Ut.length),re.write_shift(2,0),we+=re.length,Y.push(re),we+=Ut.length,Y.push(Ut),we+=mr.length,Y.push(mr),re=Ee(46),re.write_shift(4,33639248),re.write_shift(2,0),re.write_shift(2,20),re.write_shift(2,_e),re.write_shift(2,ye),re.write_shift(4,0),re.write_shift(-4,Ie[Fe]),re.write_shift(4,mr.length),re.write_shift(4,Me.content.length),re.write_shift(2,Ut.length),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(4,0),re.write_shift(4,Bt),dt+=re.l,te.push(re),dt+=Ut.length,te.push(Ut),++Fe}return re=Ee(22),re.write_shift(4,101010256),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,Fe),re.write_shift(2,Fe),re.write_shift(4,dt),re.write_shift(4,we),re.write_shift(2,0),Vr([Vr(Y),Vr(te),re])}var In={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ao(B,Z){if(B.ctype)return B.ctype;var q=B.name||"",Y=q.match(/\.([^\.]+)$/);return Y&&In[Y[1]]||Z&&(Y=(q=Z).match(/[\.\\]([^\.\\])+$/),Y&&In[Y[1]])?In[Y[1]]:"application/octet-stream"}function Fc(B){for(var Z=lf(B),q=[],Y=0;Y<Z.length;Y+=76)q.push(Z.slice(Y,Y+76));return q.join(`\r
`)+`\r
`}function Si(B){var Z=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(be){var we=be.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],Y=Z.split(`\r
`),te=0;te<Y.length;++te){var re=Y[te];if(re.length==0){q.push("");continue}for(var ye=0;ye<re.length;){var _e=76,ve=re.slice(ye,ye+_e);ve.charAt(_e-1)=="="?_e--:ve.charAt(_e-2)=="="?_e-=2:ve.charAt(_e-3)=="="&&(_e-=3),ve=re.slice(ye,ye+_e),ye+=_e,ye<re.length&&(ve+="="),q.push(ve)}}return q.join(`\r
`)}function Xf(B){for(var Z=[],q=0;q<B.length;++q){for(var Y=B[q];q<=B.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+B[++q];Z.push(Y)}for(var te=0;te<Z.length;++te)Z[te]=Z[te].replace(/[=][0-9A-Fa-f]{2}/g,function(re){return String.fromCharCode(parseInt(re.slice(1),16))});return ia(Z.join(`\r
`))}function Dc(B,Z,q){for(var Y="",te="",re="",ye,_e=0;_e<10;++_e){var ve=Z[_e];if(!ve||ve.match(/^\s*$/))break;var be=ve.match(/^(.*?):\s*([^\s].*)$/);if(be)switch(be[1].toLowerCase()){case"content-location":Y=be[2].trim();break;case"content-type":re=be[2].trim();break;case"content-transfer-encoding":te=be[2].trim();break}}switch(++_e,te.toLowerCase()){case"base64":ye=ia(da(Z.slice(_e).join("")));break;case"quoted-printable":ye=Xf(Z.slice(_e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+te)}var we=Ni(B,Y.slice(q.length),ye,{unsafe:!0});re&&(we.ctype=re)}function Yf(B,Z){if(K(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=Z&&Z.root||"",Y=(xt&&Buffer.isBuffer(B)?B.toString("binary"):K(B)).split(`\r
`),te=0,re="";for(te=0;te<Y.length;++te)if(re=Y[te],!!/^Content-Location:/i.test(re)&&(re=re.slice(re.indexOf("file")),q||(q=re.slice(0,re.lastIndexOf("/")+1)),re.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),re.slice(0,q.length)!=q););var ye=(Y[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var _e="--"+(ye[1]||""),ve=[],be=[],we={FileIndex:ve,FullPaths:be};P(we);var Fe,$e=0;for(te=0;te<Y.length;++te){var Ve=Y[te];Ve!==_e&&Ve!==_e+"--"||($e++&&Dc(we,Y.slice(Fe,te),q),Fe=te)}return we}function io(B,Z){var q=Z||{},Y=q.boundary||"SheetJS";Y="------="+Y;for(var te=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],re=B.FullPaths[0],ye=re,_e=B.FileIndex[0],ve=1;ve<B.FullPaths.length;++ve)if(ye=B.FullPaths[ve].slice(re.length),_e=B.FileIndex[ve],!(!_e.size||!_e.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dt){return"_x"+dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dt){return"_u"+dt.charCodeAt(0).toString(16)+"_"});for(var be=_e.content,we=xt&&Buffer.isBuffer(be)?be.toString("binary"):K(be),Fe=0,$e=Math.min(1024,we.length),Ve=0,Me=0;Me<=$e;++Me)(Ve=we.charCodeAt(Me))>=32&&Ve<128&&++Fe;var Ie=Fe>=$e*4/5;te.push(Y),te.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+ye),te.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),te.push("Content-Type: "+ao(_e,ye)),te.push(""),te.push(Ie?Si(we):Fc(we))}return te.push(Y+`--\r
`),te.join(`\r
`)}function Ic(B){var Z={};return P(Z,B),Z}function Ni(B,Z,q,Y){var te=Y&&Y.unsafe;te||P(B);var re=!te&&tt.find(B,Z);if(!re){var ye=B.FullPaths[0];Z.slice(0,ye.length)==ye?ye=Z:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+Z).replace("//","/")),re={name:a(Z),type:2},B.FileIndex.push(re),B.FullPaths.push(ye),te||tt.utils.cfb_gc(B)}return re.content=q,re.size=q?q.length:0,Y&&(Y.CLSID&&(re.clsid=Y.CLSID),Y.mt&&(re.mt=Y.mt),Y.ct&&(re.ct=Y.ct)),re}function Tm(B,Z){P(B);var q=tt.find(B,Z);if(q){for(var Y=0;Y<B.FileIndex.length;++Y)if(B.FileIndex[Y]==q)return B.FileIndex.splice(Y,1),B.FullPaths.splice(Y,1),!0}return!1}function so(B,Z,q){P(B);var Y=tt.find(B,Z);if(Y){for(var te=0;te<B.FileIndex.length;++te)if(B.FileIndex[te]==Y)return B.FileIndex[te].name=a(q),B.FullPaths[te]=q,!0}return!1}function dl(B){R(B,!0)}return t.find=M,t.read=k,t.parse=h,t.write=me,t.writeFile=fe,t.utils={cfb_new:Ic,cfb_add:Ni,cfb_del:Tm,cfb_mov:so,cfb_gc:dl,ReadShift:Bu,CheckField:$P,prep_blob:sn,bconcat:Vr,use_zlib:O,_deflateRaw:ut,_inflateRaw:Sr,consts:ue},t})();function LX(e){return typeof e=="string"?bm(e):Array.isArray(e)?uX(e):e}function Uf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=bm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?mi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([LX(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=to(t)),l.write(t),l.close(),t}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+e)}function BX(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function dr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function cj(e,t){for(var r=[],n=dr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Sm(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Nm(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function $X(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var jh=new Date(1899,11,30,0,0,0);function Dr(e,t){var r=e.getTime(),n=jh.getTime()+(e.getTimezoneOffset()-jh.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var yP=new Date,UX=jh.getTime()+(yP.getTimezoneOffset()-jh.getTimezoneOffset())*6e4,uj=yP.getTimezoneOffset();function Em(e){var t=new Date;return t.setTime(e*24*60*60*1e3+UX),t.getTimezoneOffset()!==uj&&t.setTime(t.getTime()+(t.getTimezoneOffset()-uj)*6e4),t}function zX(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var fj=new Date("2017-02-19T19:06:09.000Z"),bP=isNaN(fj.getFullYear())?new Date("2/19/17"):fj,WX=bP.getFullYear()==2017;function qt(e,t){var r=new Date(e);if(WX)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(bP.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Xo(e,t){if(xt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return mi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return mi(oP(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return mi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return mi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Xt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Xt(e[r]));return t}function ur(e,t){for(var r="";r.length<t;)r+=e;return r}function Za(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var HX=["january","february","march","april","may","june","july","august","september","october","november","december"];function dc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&HX.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var VX=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],l=1;l<i.length;++l)s.push(a),s.push(i[l]);return s}})();function wP(e){return e?e.content&&e.type?Xo(e.content,!0):e.data?Pu(e.data):e.asNodeBuffer&&xt?Pu(e.asNodeBuffer().toString("binary")):e.asBinary?Pu(e.asBinary()):e._data&&e._data.getContent?Pu(Xo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function SP(e){if(!e)return null;if(e.data)return Zk(e.data);if(e.asNodeBuffer&&xt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Zk(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function KX(e){return e&&e.name.slice(-4)===".bin"?SP(e):wP(e)}function Ca(e,t){for(var r=e.FullPaths||dr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function kb(e,t){var r=Ca(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function _r(e,t,r){if(!r)return KX(kb(e,t));if(!t)return null;try{return _r(e,t)}catch{return null}}function sa(e,t,r){if(!r)return wP(kb(e,t));if(!t)return null;try{return sa(e,t)}catch{return null}}function GX(e,t,r){return SP(kb(e,t))}function dj(e){for(var t=e.FullPaths||dr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function pt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return xt?n=is(r):n=fX(r),tt.utils.cfb_add(e,t,n)}tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function jb(){return tt.utils.cfb_new()}function NP(e,t){switch(t.type){case"base64":return tt.read(e,{type:"base64"});case"binary":return tt.read(e,{type:"binary"});case"buffer":case"array":return tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Fu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var wr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,qX=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,hj=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,XX=/<[^>]*>/g,Nn=wr.match(hj)?hj:XX,YX=/<\w*:/,JX=/<(\/?)\w+:/;function ct(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(qX),l=0,f="",d=0,h="",m="",x=1;if(s)for(d=0;d!=s.length;++d){for(m=s[d],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(h=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(x=(a=m.charCodeAt(i+1))==34||a==39?1:0,f=m.slice(i+1+x,m.length-x),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=f,n[h.toLowerCase()]=f;else{var v=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[v]&&h.slice(l-3,l)=="ext")continue;n[v]=f,n[v.toLowerCase()]=f}}return n}function bi(e){return e.replace(JX,"<$1")}var EP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Cb=Sm(EP),wt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(l,f){return EP[l]||String.fromCharCode(parseInt(f,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,f){return String.fromCharCode(parseInt(f,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}})(),Ab=/[&<>'"]/g,QX=/[\u0000-\u0008\u000b-\u001f]/g;function Mt(e){var t=e+"";return t.replace(Ab,function(r){return Cb[r]}).replace(QX,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function mj(e){return Mt(e).replace(/ /g,"_x0020_")}var _P=/[\u0000-\u001f]/g;function Tb(e){var t=e+"";return t.replace(Ab,function(r){return Cb[r]}).replace(/\n/g,"<br/>").replace(_P,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function ZX(e){var t=e+"";return t.replace(Ab,function(r){return Cb[r]}).replace(_P,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var pj=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function eY(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Gt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Yg(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function xj(e){var t=Ws(2*e.length),r,n,a=1,i=0,s=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function gj(e){return is(e,"binary").toString("utf8")}var v0="foo bar bazâð£",Lt=xt&&(gj(v0)==Yg(v0)&&gj||xj(v0)==Yg(v0)&&xj)||Yg,mi=xt?function(e){return is(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},uf=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),kP=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),tY=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),rY=/<\/?(?:vt:)?variant>/g,nY=/<(?:vt:)([^>]*)>([\s\S]*)</;function vj(e,t){var r=ct(e),n=e.match(tY(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(rY,"").match(nY);s&&a.push({v:Lt(s[2]),t:s[1]})}),a}var jP=/(^\s|\s$|\n)/;function ln(e,t){return"<"+e+(t.match(jP)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ff(e){return dr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Le(e,t,r){return"<"+e+(r!=null?ff(r):"")+(t!=null?(t.match(jP)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function n1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function aY(e,t){switch(typeof e){case"string":var r=Le("vt:lpwstr",Mt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Le((e|0)==e?"vt:i4":"vt:r8",Mt(String(e)));case"boolean":return Le("vt:bool",e?"true":"false")}if(e instanceof Date)return Le("vt:filetime",n1(e));throw new Error("Unable to serialize "+e)}function Pb(e){if(xt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Lt(to(Nb(e)));throw new Error("Bad input format: expected Buffer or string")}var df=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Fr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},sl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ra={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function iY(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function sY(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var yj=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},bj=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:is(t)})):yj(e)}:yj,wj=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode($i(e,a)));return n.join("").replace(Pn,"")},Ob=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Pn,""):wj(e,t,r)}:wj,Sj=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},CP=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Sj(e,t,r)}:Sj,Nj=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Wl(e,a)));return n.join("")},zf=xt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Nj(t,r,n)}:Nj,AP=function(e,t){var r=na(e,t);return r>0?zf(e,t+4,t+4+r-1):""},TP=AP,PP=function(e,t){var r=na(e,t);return r>0?zf(e,t+4,t+4+r-1):""},OP=PP,FP=function(e,t){var r=2*na(e,t);return r>0?zf(e,t+4,t+4+r-1):""},DP=FP,IP=function(t,r){var n=na(t,r);return n>0?Ob(t,r+4,r+4+n):""},MP=IP,RP=function(e,t){var r=na(e,t);return r>0?zf(e,t+4,t+4+r):""},LP=RP,BP=function(e,t){return iY(e,t)},Ch=BP,Fb=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(TP=function(t,r){if(!Buffer.isBuffer(t))return AP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},OP=function(t,r){if(!Buffer.isBuffer(t))return PP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},DP=function(t,r){if(!Buffer.isBuffer(t))return FP(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},MP=function(t,r){if(!Buffer.isBuffer(t))return IP(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},LP=function(t,r){if(!Buffer.isBuffer(t))return RP(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Ch=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):BP(t,r)},Fb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Wl=function(e,t){return e[t]},$i=function(e,t){return e[t+1]*256+e[t]},oY=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},na=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ko=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},lY=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Bu(e,t){var r="",n,a,i=[],s,l,f,d;switch(t){case"dbcs":if(d=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode($i(this,d)),d+=2;e*=2;break;case"utf8":r=zf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Ob(this,this.l,this.l+e);break;case"wstr":return Bu.call(this,e,"dbcs");case"lpstr-ansi":r=TP(this,this.l),e=4+na(this,this.l);break;case"lpstr-cp":r=OP(this,this.l),e=4+na(this,this.l);break;case"lpwstr":r=DP(this,this.l),e=4+2*na(this,this.l);break;case"lpp4":e=4+na(this,this.l),r=MP(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+na(this,this.l),r=LP(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Wl(this,this.l+e++))!==0;)i.push(g0(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=$i(this,this.l+e))!==0;)i.push(g0(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return s=Wl(this,d),this.l=d+1,l=Bu.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(g0($i(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return s=Wl(this,d),this.l=d+1,l=Bu.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(g0(Wl(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=Wl(this,this.l),this.l++,n;case 2:return n=(t==="i"?oY:$i)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?ko:lY)(this,this.l),this.l+=4,n):(a=na(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Ch(this,this.l):a=Ch([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=CP(this,this.l,e);break}}return this.l+=e,r}var cY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},uY=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},fY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function dY(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)fY(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,cY(this,t,this.l);break;case 8:if(n=8,r==="f"){sY(this,t,this.l);break}case 16:break;case-4:n=4,uY(this,t,this.l);break}return this.l+=n,this}function $P(e,t){var r=CP(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function sn(e,t){e.l=t,e.read_shift=Bu,e.chk=$P,e.write_shift=dY}function Sn(e,t){e.l+=t}function Ee(e){var t=Ws(e);return sn(t,0),t}function ss(e,t,r){if(e){var n,a,i;sn(e,e.l||0);for(var s=e.length,l=0,f=0;e.l<s;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=vf[l]||vf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;f=e.l+i;var h=d.f&&d.f(e,i,r);if(e.l=f,t(h,d,l))return}}}function Vn(){var e=[],t=xt?256:2048,r=function(d){var h=Ee(d);return sn(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},s=function(){return a(),Vr(e)},l=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:s,_bufs:e}}function je(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=vf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Fb(r)&&e.push(r)}}function $u(e,t,r){var n=Xt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ej(e,t,r){var n=Xt(e);return n.s=$u(n.s,t.s,r),n.e=$u(n.e,t.s,r),n}function Uu(e,t){if(e.cRel&&e.c<0)for(e=Xt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Xt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=st(e);return!e.cRel&&e.cRel!=null&&(r=pY(r)),!e.rRel&&e.rRel!=null&&(r=hY(r)),r}function Jg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sr(e.s.c)+":"+(e.e.cRel?"":"$")+sr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+yr(e.s.r)+":"+(e.e.rRel?"":"$")+yr(e.e.r):Uu(e.s,t.biff)+":"+Uu(e.e,t.biff)}function Db(e){return parseInt(mY(e),10)-1}function yr(e){return""+(e+1)}function hY(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function mY(e){return e.replace(/\$(\d+)$/,"$1")}function Ib(e){for(var t=xY(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function pY(e){return e.replace(/^([A-Z])/,"$$$1")}function xY(e){return e.replace(/^\$([A-Z])/,"$1")}function gY(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function or(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function st(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Gn(e){var t=e.indexOf(":");return t==-1?{s:or(e),e:or(e)}:{s:or(e.slice(0,t)),e:or(e.slice(t+1))}}function mt(e,t){return typeof t>"u"||typeof t=="number"?mt(e.s,e.e):(typeof e!="string"&&(e=st(e)),typeof t!="string"&&(t=st(t)),e==t?e:e+":"+t)}function St(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function _j(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ma(e.z,r?Dr(t):t)}catch{}try{return e.w=Ma((e.XF||{}).numFmtId||(r?14:0),r?Dr(t):t)}catch{return""+t}}function Zi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?os[e.v]||e.v:t==null?_j(e,e.v):_j(e,t))}function ro(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function UP(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?or(n.origin):n.origin;s=f.r,l=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=St(i["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),s==-1&&(d.e.r=s=h.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[m].length;++x)if(!(typeof t[m][x]>"u")){var v={v:t[m][x]},y=s+m,g=l+x;if(d.s.r>y&&(d.s.r=y),d.s.c>g&&(d.s.c=g),d.e.r<y&&(d.e.r=y),d.e.c<g&&(d.e.c=g),t[m][x]&&typeof t[m][x]=="object"&&!Array.isArray(t[m][x])&&!(t[m][x]instanceof Date))v=t[m][x];else if(Array.isArray(v.v)&&(v.f=t[m][x][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||it[14],n.cellDates?(v.t="d",v.w=Ma(v.z,Dr(v.v))):(v.t="n",v.v=Dr(v.v),v.w=Ma(v.z,v.v))):v.t="s";if(a)i[y]||(i[y]=[]),i[y][g]&&i[y][g].z&&(v.z=i[y][g].z),i[y][g]=v;else{var b=st({c:g,r:y});i[b]&&i[b].z&&(v.z=i[b].z),i[b]=v}}}return d.s.c<1e7&&(i["!ref"]=mt(d)),i}function Pc(e,t){return UP(null,e,t)}function vY(e){return e.read_shift(4,"i")}function ei(e,t){return t||(t=Ee(4)),t.write_shift(4,e),t}function wn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Gr(e,t){var r=!1;return t==null&&(r=!0,t=Ee(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function yY(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function bY(e,t){return t||(t=Ee(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Mb(e,t){var r=e.l,n=e.read_shift(1),a=wn(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),f=0;f!=l;++f)i.push(yY(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function wY(e,t){var r=!1;return t==null&&(r=!0,t=Ee(15+4*e.t.length)),t.write_shift(1,0),Gr(e.t,t),r?t.slice(0,t.l):t}var SY=Mb;function NY(e,t){var r=!1;return t==null&&(r=!0,t=Ee(23+4*e.t.length)),t.write_shift(1,1),Gr(e.t,t),t.write_shift(4,1),bY({},t),r?t.slice(0,t.l):t}function $a(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ol(e,t){return t==null&&(t=Ee(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ll(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function cl(e,t){return t==null&&(t=Ee(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var EY=wn,zP=Gr;function Rb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ah(e,t){var r=!1;return t==null&&(r=!0,t=Ee(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var _Y=wn,a1=Rb,Lb=Ah;function Bb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Ch([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ko(t,0)>>2;return r?a/100:a}function WP(e,t){t==null&&(t=Ee(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function HP(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function kY(e,t){return t||(t=Ee(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ul=HP,Oc=kY;function yn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Yo(e,t){return(t||Ee(8)).write_shift(8,e,"f")}function jY(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),l=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=Mo[a];d&&(t.rgb=mf(d));break;case 2:t.rgb=mf([s,l,f]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Th(e,t){if(t||(t=Ee(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function CY(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function AY(e,t){t||(t=Ee(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function VP(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function TY(e){return VP(e,1)}function PY(e){return VP(e,2)}var $b=2,Wn=3,y0=11,kj=12,Ph=19,b0=64,OY=65,FY=71,DY=4108,IY=4126,Hr=80,KP=81,MY=[Hr,KP],i1={1:{n:"CodePage",t:$b},2:{n:"Category",t:Hr},3:{n:"PresentationFormat",t:Hr},4:{n:"ByteCount",t:Wn},5:{n:"LineCount",t:Wn},6:{n:"ParagraphCount",t:Wn},7:{n:"SlideCount",t:Wn},8:{n:"NoteCount",t:Wn},9:{n:"HiddenCount",t:Wn},10:{n:"MultimediaClipCount",t:Wn},11:{n:"ScaleCrop",t:y0},12:{n:"HeadingPairs",t:DY},13:{n:"TitlesOfParts",t:IY},14:{n:"Manager",t:Hr},15:{n:"Company",t:Hr},16:{n:"LinksUpToDate",t:y0},17:{n:"CharacterCount",t:Wn},19:{n:"SharedDoc",t:y0},22:{n:"HyperlinksChanged",t:y0},23:{n:"AppVersion",t:Wn,p:"version"},24:{n:"DigSig",t:OY},26:{n:"ContentType",t:Hr},27:{n:"ContentStatus",t:Hr},28:{n:"Language",t:Hr},29:{n:"Version",t:Hr},255:{},2147483648:{n:"Locale",t:Ph},2147483651:{n:"Behavior",t:Ph},1919054434:{}},s1={1:{n:"CodePage",t:$b},2:{n:"Title",t:Hr},3:{n:"Subject",t:Hr},4:{n:"Author",t:Hr},5:{n:"Keywords",t:Hr},6:{n:"Comments",t:Hr},7:{n:"Template",t:Hr},8:{n:"LastAuthor",t:Hr},9:{n:"RevNumber",t:Hr},10:{n:"EditTime",t:b0},11:{n:"LastPrinted",t:b0},12:{n:"CreatedDate",t:b0},13:{n:"ModifiedDate",t:b0},14:{n:"PageCount",t:Wn},15:{n:"WordCount",t:Wn},16:{n:"CharCount",t:Wn},17:{n:"Thumbnail",t:FY},18:{n:"Application",t:Hr},19:{n:"DocSecurity",t:Wn},255:{},2147483648:{n:"Locale",t:Ph},2147483651:{n:"Behavior",t:Ph},1919054434:{}},jj={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},RY=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function LY(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var BY=LY([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Mo=Xt(BY),os={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},GP={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},o1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},w0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ub(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function $Y(e){var t=Ub();if(!e||!e.match)return t;var r={};if((e.match(Nn)||[]).forEach(function(n){var a=ct(n);switch(a[0].replace(YX,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[o1[a.ContentType]]!==void 0&&t[o1[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Fr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function qP(e,t){var r=$X(o1),n=[],a;n[n.length]=wr,n[n.length]=Le("Types",null,{xmlns:Fr.CT,"xmlns:xsd":Fr.xsd,"xmlns:xsi":Fr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Le("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){e[f]&&e[f].length>0&&(a=e[f][0],n[n.length]=Le("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:w0[f][t.bookType]||w0[f].xlsx}))},s=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Le("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:w0[f][t.bookType]||w0[f].xlsx})})},l=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Le("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return i("workbooks"),s("sheets"),s("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),s("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var vt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function zu(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Nn)||[]).forEach(function(a){var i=ct(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Fu(i.Target,t);r[l]=s,n[i.Id]=s}}),r["!id"]=n,r}function Zl(e){var t=[wr,Le("Relationships",null,{xmlns:Fr.RELS})];return dr(e["!id"]).forEach(function(r){t[t.length]=Le("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ft(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[vt.HLINK,vt.XPATH,vt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var UY="application/vnd.oasis.opendocument.spreadsheet";function zY(e,t){for(var r=Pb(e),n,a;n=df.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ct(n[0],!1),a.path=="/"&&a.type!==UY)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function WY(e){var t=[wr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Cj(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function HY(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function VY(e){var t=[wr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Cj(e[r][0],e[r][1])),t.push(HY("",e[r][0]));return t.push(Cj("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function XP(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Nh.version+"</meta:generator></office:meta></office:document-meta>"}var Fa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],KY=(function(){for(var e=new Array(Fa.length),t=0;t<Fa.length;++t){var r=Fa[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function YP(e){var t={};e=Lt(e);for(var r=0;r<Fa.length;++r){var n=Fa[r],a=e.match(KY[r]);a!=null&&a.length>0&&(t[n[1]]=wt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=qt(t[n[1]]))}return t}function Qg(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Mt(t),n[n.length]=r?Le(e,t,r):ln(e,t))}function JP(e,t){var r=t||{},n=[wr,Le("cp:coreProperties",null,{"xmlns:cp":Fr.CORE_PROPS,"xmlns:dc":Fr.dc,"xmlns:dcterms":Fr.dcterms,"xmlns:dcmitype":Fr.dcmitype,"xmlns:xsi":Fr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Qg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:n1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Qg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:n1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Fa.length;++i){var s=Fa[i],l=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Qg(s[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ro=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],QP=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ZP(e,t,r,n){var a=[];if(typeof e=="string")a=vj(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(h){return{v:h}}));var s=typeof t=="string"?vj(t,n).map(function(h){return h.v}):t,l=0,f=0;if(s.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=s.slice(l,l+f);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=f,r.DefinedNames=s.slice(l,l+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=s.slice(l,l+f);break}l+=f}}function GY(e,t,r){var n={};return t||(t={}),e=Lt(e),Ro.forEach(function(a){var i=(e.match(uf(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=wt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ZP(n.HeadingPairs,n.TitlesOfParts,t,r),t}function eO(e){var t=[],r=Le;return e||(e={}),e.Application="SheetJS",t[t.length]=wr,t[t.length]=Le("Properties",null,{xmlns:Fr.EXT_PROPS,"xmlns:vt":Fr.vt}),Ro.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Mt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Mt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var qY=/<[^>]+>[^<]*/g;function XY(e,t){var r={},n="",a=e.match(qY);if(a)for(var i=0;i!=a.length;++i){var s=a[i],l=ct(s);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=wt(l.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var f=s.split(">"),d=f[0].slice(4),h=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=wt(h);break;case"bool":r[n]=Gt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=qt(h);break;case"cy":case"error":r[n]=wt(h);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,d,f)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function tO(e){var t=[wr,Le("Properties",null,{xmlns:Fr.CUST_PROPS,"xmlns:vt":Fr.vt})];if(!e)return t.join("");var r=1;return dr(e).forEach(function(a){++r,t[t.length]=Le("property",aY(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Mt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var l1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Zg;function YY(e,t,r){Zg||(Zg=Sm(l1)),t=Zg[t]||t,e[t]=r}function JY(e,t){var r=[];return dr(l1).map(function(n){for(var a=0;a<Fa.length;++a)if(Fa[a][1]==n)return Fa[a];for(a=0;a<Ro.length;++a)if(Ro[a][1]==n)return Ro[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(ln(l1[n[1]]||n[1],a))}}),Le("DocumentProperties",r.join(""),{xmlns:ra.o})}function QY(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&dr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Fa.length;++s)if(i==Fa[s][1])return;for(s=0;s<Ro.length;++s)if(i==Ro[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var l=e[i],f="string";typeof l=="number"?(f="float",l=String(l)):l===!0||l===!1?(f="boolean",l=l?"1":"0"):l=String(l),a.push(Le(mj(i),l,{"dt:dt":f}))}}),t&&dr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Le(mj(i),s,{"dt:dt":l}))}}),"<"+n+' xmlns="'+ra.o+'">'+a.join("")+"</"+n+">"}function zb(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ZY(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=Ee(8);return s.write_shift(4,n),s.write_shift(4,a),s}function rO(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function nO(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function aO(e,t,r){return t===31?nO(e):rO(e,t,r)}function c1(e,t,r){return aO(e,t,r===!1?0:4)}function eJ(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return aO(e,t,0)}function tJ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Pn,""),e.l-a&2&&(e.l+=2)}return r}function rJ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Pn,"");return r}function nJ(e){var t=e.l,r=Oh(e,KP);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Oh(e,Wn);return[r,n]}function aJ(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(nJ(e));return r}function Aj(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Pn,"").replace(Ou,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function iO(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function iJ(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Oh(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==kj&&n!==t&&MY.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===kj?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return rO(e,n,4).replace(Pn,"");case 31:return nO(e);case 64:return zb(e);case 65:return iO(e);case 71:return iJ(e);case 80:return c1(e,n,!i.raw).replace(Pn,"");case 81:return eJ(e,n).replace(Pn,"");case 4108:return aJ(e);case 4126:case 4127:return n==4127?tJ(e):rJ(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Tj(e,t){var r=Ee(4),n=Ee(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ee(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=ZY(t);break;case 31:case 80:for(n=Ee(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Vr([r,n])}function Pj(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,l=0,f=-1,d={};for(s=0;s!=a;++s){var h=e.read_shift(4),m=e.read_shift(4);i[s]=[h,m+r]}i.sort(function(_,S){return _[1]-S[1]});var x={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var v=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,v=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],v=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],v=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(v=!1,e.l=i[s][1]),v)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var y=t[i[s][0]];if(x[y.n]=Oh(e,y.t,{raw:!0}),y.p==="version"&&(x[y.n]=String(x[y.n]>>16)+"."+("0000"+String(x[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(x[y.n]){case 0:x[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ja(l=x[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[y.n])}}else if(i[s][0]===1){if(l=x.CodePage=Oh(e,$b),Ja(l),f!==-1){var g=e.l;e.l=i[f][1],d=Aj(e,l),e.l=g}}else if(i[s][0]===0){if(l===0){f=s,e.l=i[s+1][1];continue}d=Aj(e,l)}else{var b=d[i[s][0]],N;switch(e[e.l]){case 65:e.l+=4,N=iO(e);break;case 30:e.l+=4,N=c1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,N=c1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,N=e.read_shift(4,"i");break;case 19:e.l+=4,N=e.read_shift(4);break;case 5:e.l+=4,N=e.read_shift(8,"f");break;case 11:e.l+=4,N=gr(e,4);break;case 64:e.l+=4,N=qt(zb(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[b]=N}}return e.l=r+n,x}var sO=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function sJ(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Oj(e,t,r){var n=Ee(8),a=[],i=[],s=8,l=0,f=Ee(8),d=Ee(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),i.push(f),a.push(d),s+=8+f.length,!t){d=Ee(8),d.write_shift(4,0),a.unshift(d);var h=[Ee(4)];for(h[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(f=Ee(8+2*(m.length+1)+(m.length%2?0:2)),f.write_shift(4,l+2),f.write_shift(4,m.length+1),f.write_shift(0,m,"dbcs");f.l!=f.length;)f.write_shift(1,0);h.push(f)}f=Vr(h),i.unshift(f),s+=8+f.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(sO.indexOf(e[l][0])>-1||QP.indexOf(e[l][0])>-1)&&e[l][1]!=null){var x=e[l][1],v=0;if(t){v=+t[e[l][0]];var y=r[v];if(y.p=="version"&&typeof x=="string"){var g=x.split(".");x=(+g[0]<<16)+(+g[1]||0)}f=Tj(y.t,x)}else{var b=sJ(x);b==-1&&(b=31,x=String(x)),f=Tj(b,x)}i.push(f),d=Ee(8),d.write_shift(4,t?v:2+l),a.push(d),s+=8+f.length}var N=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,N),N+=i[l].length;return n.write_shift(4,s),n.write_shift(4,i.length),Vr([n].concat(a).concat(i))}function Fj(e,t,r){var n=e.content;if(!n)return{};sn(n,0);var a,i,s,l,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),h=n.read_shift(16);if(h!==tt.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(s=n.read_shift(16),f=n.read_shift(4));var m=Pj(n,t),x={SystemIdentifier:d};for(var v in m)x[v]=m[v];if(x.FMTID=i,a===1)return x;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var y;try{y=Pj(n,null)}catch{}for(v in y)x[v]=y[v];return x.FMTID=[i,s],x}function Dj(e,t,r,n,a,i){var s=Ee(a?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var f=Oj(e,r,n);if(l.push(f),a){var d=Oj(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+f.length),l.push(d)}return Vr(l)}function As(e,t){return e.read_shift(t),null}function oJ(e,t){t||(t=Ee(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function lJ(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function gr(e,t){return e.read_shift(t)===1}function Cn(e,t){return t||(t=Ee(2)),t.write_shift(2,+!!e),t}function kr(e){return e.read_shift(2,"u")}function Aa(e,t){return t||(t=Ee(2)),t.write_shift(2,e),t}function oO(e,t){return lJ(e,t,kr)}function cJ(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function lO(e,t,r){return r||(r=Ee(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Wf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function uJ(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,l,f={};a&&(s=e.read_shift(2)),n&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,d);return a&&(e.l+=4*s),n&&(e.l+=l),f.t=h,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function fJ(e){var t=e.t||"",r=Ee(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ee(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Vr(a)}function Jo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Hf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Jo(e,n,r)}function fl(e,t,r){if(r.biff>5)return Hf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function cO(e,t,r){return r||(r=Ee(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function dJ(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function hJ(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Pn,"");return n&&(e.l+=24),a}function mJ(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Pn,"");return r+s}function pJ(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return hJ(e);case"0303000000000000c000000000000046":return mJ(e);default:throw new Error("Unsupported Moniker "+r)}}function S0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Pn,""):"";return r}function Ij(e,t){t||(t=Ee(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function xJ(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,l,f,d="",h,m;a&16&&(i=S0(e,r-e.l)),a&128&&(s=S0(e,r-e.l)),(a&257)===257&&(l=S0(e,r-e.l)),(a&257)===1&&(f=pJ(e,r-e.l)),a&8&&(d=S0(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(m=zb(e)),e.l=r;var x=s||l||f||"";x&&d&&(x+="#"+d),x||(x="#"+d),a&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var v={Target:x};return h&&(v.guid=h),m&&(v.time=m),i&&(v.Tooltip=i),v}function gJ(e){var t=Ee(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),Ij(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&Ij(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)t.write_shift(1,n.charCodeAt(r+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function uO(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function fO(e,t){var r=uO(e);return r[3]=0,r}function wi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Qo(e,t,r,n){return n||(n=Ee(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function vJ(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function yJ(e,t,r){return t===0?"":fl(e,t,r)}function bJ(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function dO(e){var t=e.read_shift(2),r=Bb(e);return[t,r]}function wJ(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Wf(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function _m(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function hO(e,t){return t||(t=Ee(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function mO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var SJ=mO;function pO(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function NJ(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function EJ(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function hn(e){e.l+=2,e.l+=e.read_shift(2)}var _J={0:hn,4:hn,5:hn,6:hn,7:EJ,8:hn,9:hn,10:hn,11:hn,12:hn,13:NJ,14:hn,15:hn,16:hn,17:hn,18:hn,19:hn,20:hn,21:pO};function kJ(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(_J[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function N0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Wb(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ee(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function jJ(e,t){return t===0||e.read_shift(2),1200}function CJ(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=fl(e,0,r);return e.read_shift(t+n-e.l),a}function AJ(e,t){var r=!t||t.biff==8,n=Ee(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function TJ(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function PJ(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Wf(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function OJ(e,t){var r=!t||t.biff>=8?2:1,n=Ee(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function FJ(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(uJ(e));return i.Count=n,i.Unique=a,i}function DJ(e,t){var r=Ee(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=fJ(e[a]);var i=Vr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function IJ(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function MJ(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function RJ(e){var t=vJ(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function LJ(e){return e.read_shift(2),e.read_shift(4)}function Mj(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function BJ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:l,Selected:f,TabRatio:d}}function $J(){var e=Ee(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function UJ(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function zJ(e){var t=Ee(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function WJ(){}function HJ(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Wf(e,0,r),n}function VJ(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Ee(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function KJ(e){var t=wi(e);return t.isst=e.read_shift(4),t}function GJ(e,t,r,n){var a=Ee(10);return Qo(e,t,n,a),a.write_shift(4,r),a}function qJ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=wi(e);r.biff==2&&e.l++;var i=Hf(e,n-e.l,r);return a.val=i,a}function XJ(e,t,r,n,a){var i=!a||a.biff==8,s=Ee(8+ +i+(1+i)*r.length);return Qo(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function YJ(e,t,r){var n=e.read_shift(2),a=fl(e,0,r);return[n,a]}function JJ(e,t,r,n){var a=r&&r.biff==5;n||(n=Ee(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var QJ=fl;function Rj(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),l=e.read_shift(2),f=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:s,c:f}}}function ZJ(e,t){var r=t.biff==8||!t.biff?4:2,n=Ee(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function eQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=dO(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function tQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(dO(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function rQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function nQ(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(4),f=e.read_shift(2);return a.patternType=RY[l>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function aQ(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=nQ(e,t,n.fStyle,r),n}function Lj(e,t,r,n){var a=r&&r.biff==5;n||(n=Ee(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function iQ(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function sQ(e){var t=Ee(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Bj(e,t,r){var n=wi(e);(r.biff==2||t==9)&&++e.l;var a=cJ(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function oQ(e,t,r,n,a,i){var s=Ee(8);return Qo(e,t,n,s),lO(r,i,s),s}function lQ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=wi(e),a=yn(e);return n.val=a,n}function cQ(e,t,r,n){var a=Ee(14);return Qo(e,t,n,a),Yo(r,a),a}var $j=yJ;function uQ(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Jo(e,i),l=[];n>e.l;)l.push(Hf(e));return[i,a,s,l]}function Uj(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=wJ(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var fQ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function zj(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),f=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Jo(e,s,r);a&32&&(d=fQ[d.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var m=n==e.l||l===0||!(h>0)?[]:kre(e,h,r,l);return{chKey:i,Name:d,itab:f,rgce:m}}function xO(e,t,r){if(r.biff<8)return dQ(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(bJ(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function dQ(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Wf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function hQ(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Jo(e,n,r),s=Jo(e,a,r);return[i,s]}function mQ(e,t,r){var n=mO(e);e.l++;var a=e.read_shift(1);return t-=8,[jre(e,t,r),a,n]}function Wj(e,t,r){var n=SJ(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Ere(e,t,r)]}function pQ(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function xQ(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=fl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,s,i]}}function gQ(e,t,r){return xQ(e,t,r)}function vQ(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(_m(e));return r}function yQ(e){var t=Ee(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)hO(e[r],t);return t}function bQ(e,t,r){if(r&&r.biff<8)return SQ(e,t,r);var n=pO(e),a=kJ(e,t-22,n[1]);return{cmo:n,ft:a}}var wQ={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function SQ(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((wQ[n]||Sn)(e,t,r)),{cmo:[a,n,i],ft:s}}function NQ(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=dJ(e,6,r);var l=e.read_shift(2);e.read_shift(2),kr(e,2);var f=e.read_shift(2);e.l+=f;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var h=e[e.l],m=Jo(e,e.lens[d+1]-e.lens[d]-1);if(a+=m,a.length>=(h?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function EQ(e,t){var r=_m(e);e.l+=16;var n=xJ(e,t-24);return[r,n]}function _Q(e){var t=Ee(24),r=or(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Vr([t,gJ(e[1])])}function kQ(e,t){e.read_shift(2);var r=_m(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Pn,""),[r,n]}function jQ(e){var t=e[1].Tooltip,r=Ee(10+2*(t.length+1));r.write_shift(2,2048);var n=or(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function CQ(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=jj[r]||r,r=e.read_shift(2),t[1]=jj[r]||r,t}function AQ(e){return e||(e=Ee(4)),e.write_shift(2,1),e.write_shift(2,1),e}function TQ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fO(e));return r}function PQ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fO(e));return r}function OQ(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function gO(e,t,r){if(!r.cellStyles)return Sn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:s,ixfe:l,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function FQ(e,t){var r=Ee(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function DQ(e,t){var r={};return t<32||(e.l+=16,r.header=yn(e),r.footer=yn(e),e.l+=2),r}function IQ(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function MQ(e){for(var t=Ee(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var RQ=wi,LQ=oO,BQ=Hf;function $Q(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function UQ(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=wi(e);++e.l;var a=fl(e,t-7,r);return n.t="str",n.val=a,n}function zQ(e){var t=wi(e);++e.l;var r=yn(e);return t.t="n",t.val=r,t}function WQ(e,t,r){var n=Ee(15);return qf(n,e,t),n.write_shift(8,r,"f"),n}function HQ(e){var t=wi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function VQ(e,t,r){var n=Ee(9);return qf(n,e,t),n.write_shift(2,r),n}function KQ(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function GQ(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function qQ(e,t,r){var n=e.l+t,a=wi(e),i=e.read_shift(2),s=Jo(e,i,r);return e.l=n,a.t="str",a.val=s,a}var XQ=[2,3,48,49,131,139,140,245],u1=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Sm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,f){var d=[],h=Ws(1);switch(f.type){case"base64":h=ia(da(l));break;case"binary":h=ia(l);break;case"buffer":case"array":h=l;break}sn(h,0);var m=h.read_shift(1),x=!!(m&136),v=!1,y=!1;switch(m){case 2:break;case 3:break;case 48:v=!0,x=!0;break;case 49:v=!0,x=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var g=0,b=521;m==2&&(g=h.read_shift(2)),h.l+=3,m!=2&&(g=h.read_shift(4)),g>1048576&&(g=1e6),m!=2&&(b=h.read_shift(2));var N=h.read_shift(2),_=f.codepage||1252;m!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(_=e[h[h.l]]),h.l+=1,h.l+=2),y&&(h.l+=36);for(var S=[],C={},T=Math.min(h.length,m==2?521:b-10-(v?264:0)),k=y?32:11;h.l<T&&h[h.l]!=13;)switch(C={},C.name=of.utils.decode(_,h.slice(h.l,h.l+k)).replace(/[\u0000\r\n].*$/g,""),h.l+=k,C.type=String.fromCharCode(h.read_shift(1)),m!=2&&!y&&(C.offset=h.read_shift(4)),C.len=h.read_shift(1),m==2&&(C.offset=h.read_shift(2)),C.dec=h.read_shift(1),C.name.length&&S.push(C),m!=2&&(h.l+=y?13:14),C.type){case"B":(!v||C.len!=8)&&f.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(h[h.l]!==13&&(h.l=b-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=b;var P=0,D=0;for(d[0]=[],D=0;D!=S.length;++D)d[0][D]=S[D].name;for(;g-- >0;){if(h[h.l]===42){h.l+=N;continue}for(++h.l,d[++P]=[],D=0,D=0;D!=S.length;++D){var R=h.slice(h.l,h.l+S[D].len);h.l+=S[D].len,sn(R,0);var G=of.utils.decode(_,R);switch(S[D].type){case"C":G.trim().length&&(d[P][D]=G.replace(/\s+$/,""));break;case"D":G.length===8?d[P][D]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):d[P][D]=G;break;case"F":d[P][D]=parseFloat(G.trim());break;case"+":case"I":d[P][D]=y?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":d[P][D]=!0;break;case"N":case"F":d[P][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[P][D]="##MEMO##"+(y?parseInt(G.trim(),10):R.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(d[P][D]=+G||0);break;case"@":d[P][D]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":d[P][D]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":d[P][D]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[P][D]=-R.read_shift(-8,"f");break;case"B":if(v&&S[D].len==8){d[P][D]=R.read_shift(8,"f");break}case"G":case"P":R.l+=S[D].len;break;case"0":if(S[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[D].type)}}}if(m!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=S,d}function n(l,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var h=Pc(r(l,d),d);return h["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,h}function a(l,f){try{return ro(n(l,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,f){var d=f||{};if(+d.codepage>=0&&Ja(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=Vn(),m=Ih(l,{header:1,raw:!0,cellDates:!0}),x=m[0],v=m.slice(1),y=l["!cols"]||[],g=0,b=0,N=0,_=1;for(g=0;g<x.length;++g){if(((y[g]||{}).DBF||{}).name){x[g]=y[g].DBF.name,++N;continue}if(x[g]!=null){if(++N,typeof x[g]=="number"&&(x[g]=x[g].toString(10)),typeof x[g]!="string")throw new Error("DBF Invalid column name "+x[g]+" |"+typeof x[g]+"|");if(x.indexOf(x[g])!==g){for(b=0;b<1024;++b)if(x.indexOf(x[g]+"_"+b)==-1){x[g]+="_"+b;break}}}}var S=St(l["!ref"]),C=[],T=[],k=[];for(g=0;g<=S.e.c-S.s.c;++g){var P="",D="",R=0,G=[];for(b=0;b<v.length;++b)v[b][g]!=null&&G.push(v[b][g]);if(G.length==0||x[g]==null){C[g]="?";continue}for(b=0;b<G.length;++b){switch(typeof G[b]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=G[b]instanceof Date?"D":"C";break;default:D="C"}R=Math.max(R,String(G[b]).length),P=P&&P!=D?"C":D}R>250&&(R=250),D=((y[g]||{}).DBF||{}).type,D=="C"&&y[g].DBF.len>R&&(R=y[g].DBF.len),P=="B"&&D=="N"&&(P="N",k[g]=y[g].DBF.dec,R=y[g].DBF.len),T[g]=P=="C"||D=="N"?R:i[P]||0,_+=T[g],C[g]=P}var M=h.next(32);for(M.write_shift(4,318902576),M.write_shift(4,v.length),M.write_shift(2,296+32*N),M.write_shift(2,_),g=0;g<4;++g)M.write_shift(4,0);for(M.write_shift(4,0|(+t[sP]||3)<<8),g=0,b=0;g<x.length;++g)if(x[g]!=null){var H=h.next(32),z=(x[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,z,"sbcs"),H.write_shift(1,C[g]=="?"?"C":C[g],"sbcs"),H.write_shift(4,b),H.write_shift(1,T[g]||i[C[g]]||0),H.write_shift(1,k[g]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),b+=T[g]||i[C[g]]||0}var ne=h.next(264);for(ne.write_shift(4,13),g=0;g<65;++g)ne.write_shift(4,0);for(g=0;g<v.length;++g){var Q=h.next(_);for(Q.write_shift(1,0),b=0;b<x.length;++b)if(x[b]!=null)switch(C[b]){case"L":Q.write_shift(1,v[g][b]==null?63:v[g][b]?84:70);break;case"B":Q.write_shift(8,v[g][b]||0,"f");break;case"N":var le="0";for(typeof v[g][b]=="number"&&(le=v[g][b].toFixed(k[b]||0)),N=0;N<T[b]-le.length;++N)Q.write_shift(1,32);Q.write_shift(1,le,"sbcs");break;case"D":v[g][b]?(Q.write_shift(4,("0000"+v[g][b].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(v[g][b].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+v[g][b].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(v[g][b]!=null?v[g][b]:"").slice(0,T[b]);for(Q.write_shift(1,ue,"sbcs"),N=0;N<T[b]-ue.length;++N)Q.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),vO=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+dr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,v){var y=e[v];return typeof y=="number"?ej(y):y},n=function(x,v,y){var g=v.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return g==59?x:ej(g)};e["|"]=254;function a(x,v){switch(v.type){case"base64":return i(da(x),v);case"binary":return i(x,v);case"buffer":return i(xt&&Buffer.isBuffer(x)?x.toString("binary"):to(x),v);case"array":return i(Xo(x),v)}throw new Error("Unrecognized type "+v.type)}function i(x,v){var y=x.split(/[\n\r]+/),g=-1,b=-1,N=0,_=0,S=[],C=[],T=null,k={},P=[],D=[],R=[],G=0,M;for(+v.codepage>=0&&Ja(+v.codepage);N!==y.length;++N){G=0;var H=y[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),z=H.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),ne=z[0],Q;if(H.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&C.push(H.slice(3).replace(/;;/g,";"));break;case"C":var le=!1,ue=!1,fe=!1,K=!1,me=-1,J=-1;for(_=1;_<z.length;++_)switch(z[_].charAt(0)){case"A":break;case"X":b=parseInt(z[_].slice(1))-1,ue=!0;break;case"Y":for(g=parseInt(z[_].slice(1))-1,ue||(b=0),M=S.length;M<=g;++M)S[M]=[];break;case"K":Q=z[_].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(Za(Q))?isNaN(dc(Q).getDate())||(Q=qt(Q)):(Q=Za(Q),T!==null&&Ac(T)&&(Q=Em(Q))),le=!0;break;case"E":K=!0;var O=ec(z[_].slice(1),{r:g,c:b});S[g][b]=[S[g][b],O];break;case"S":fe=!0,S[g][b]=[S[g][b],"S5S"];break;case"G":break;case"R":me=parseInt(z[_].slice(1))-1;break;case"C":J=parseInt(z[_].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+H)}if(le&&(S[g][b]&&S[g][b].length==2?S[g][b][0]=Q:S[g][b]=Q,T=null),fe){if(K)throw new Error("SYLK shared formula cannot have own formula");var ae=me>-1&&S[me][J];if(!ae||!ae[1])throw new Error("SYLK shared formula cannot find base");S[g][b][1]=MO(ae[1],{r:g-me,c:b-J})}break;case"F":var ee=0;for(_=1;_<z.length;++_)switch(z[_].charAt(0)){case"X":b=parseInt(z[_].slice(1))-1,++ee;break;case"Y":for(g=parseInt(z[_].slice(1))-1,M=S.length;M<=g;++M)S[M]=[];break;case"M":G=parseInt(z[_].slice(1))/20;break;case"F":break;case"G":break;case"P":T=C[parseInt(z[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=z[_].slice(1).split(" "),M=parseInt(R[0],10);M<=parseInt(R[1],10);++M)G=parseInt(R[2],10),D[M-1]=G===0?{hidden:!0}:{wch:G},Hs(D[M-1]);break;case"C":b=parseInt(z[_].slice(1))-1,D[b]||(D[b]={});break;case"R":g=parseInt(z[_].slice(1))-1,P[g]||(P[g]={}),G>0?(P[g].hpt=G,P[g].hpx=mc(G)):G===0&&(P[g].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+H)}ee<1&&(T=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+H)}}return P.length>0&&(k["!rows"]=P),D.length>0&&(k["!cols"]=D),v&&v.sheetRows&&(S=S.slice(0,v.sheetRows)),[S,k]}function s(x,v){var y=a(x,v),g=y[0],b=y[1],N=Pc(g,v);return dr(b).forEach(function(_){N[_]=b[_]}),N}function l(x,v){return ro(s(x,v),v)}function f(x,v,y,g){var b="C;Y"+(y+1)+";X"+(g+1)+";K";switch(x.t){case"n":b+=x.v||0,x.f&&!x.F&&(b+=";E"+Xb(x.f,{r:y,c:g}));break;case"b":b+=x.v?"TRUE":"FALSE";break;case"e":b+=x.w||x.v;break;case"d":b+='"'+(x.w||x.v)+'"';break;case"s":b+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(x,v){v.forEach(function(y,g){var b="F;W"+(g+1)+" "+(g+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=pf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=xf(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&x.push(b)})}function h(x,v){v.forEach(function(y,g){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*gf(y.hpx)+";"),b.length>2&&x.push(b+"R"+(g+1))})}function m(x,v){var y=["ID;PWXL;N;E"],g=[],b=St(x["!ref"]),N,_=Array.isArray(x),S=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),x["!cols"]&&d(y,x["!cols"]),x["!rows"]&&h(y,x["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var C=b.s.r;C<=b.e.r;++C)for(var T=b.s.c;T<=b.e.c;++T){var k=st({r:C,c:T});N=_?(x[C]||[])[T]:x[k],!(!N||N.v==null&&(!N.f||N.F))&&g.push(f(N,x,C,T))}return y.join(S)+S+g.join(S)+S+"E"+S}return{to_workbook:l,to_sheet:s,from_sheet:m}})(),yO=(function(){function e(i,s){switch(s.type){case"base64":return t(da(i),s);case"binary":return t(i,s);case"buffer":return t(xt&&Buffer.isBuffer(i)?i.toString("binary"):to(i),s);case"array":return t(Xo(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var l=i.split(`
`),f=-1,d=-1,h=0,m=[];h!==l.length;++h){if(l[h].trim()==="BOT"){m[++f]=[],d=0;continue}if(!(f<0)){var x=l[h].trim().split(","),v=x[0],y=x[1];++h;for(var g=l[h]||"";(g.match(/["]/g)||[]).length&1&&h<l.length-1;)g+=`
`+l[++h];switch(g=g.trim(),+v){case-1:if(g==="BOT"){m[++f]=[],d=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?m[f][d]=!0:g==="FALSE"?m[f][d]=!1:isNaN(Za(y))?isNaN(dc(y).getDate())?m[f][d]=y:m[f][d]=qt(y):m[f][d]=Za(y),++d;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),m[f][d++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(m=m.slice(0,s.sheetRows)),m}function r(i,s){return Pc(e(i,s),s)}function n(i,s){return ro(r(i,s),s)}var a=(function(){var i=function(f,d,h,m,x){f.push(d),f.push(h+","+m),f.push('"'+x.replace(/"/g,'""')+'"')},s=function(f,d,h,m){f.push(d+","+h),f.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var d=[],h=St(f["!ref"]),m,x=Array.isArray(f);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,h.e.r-h.s.r+1,""),i(d,"TUPLES",0,h.e.c-h.s.c+1,""),i(d,"DATA",0,0,"");for(var v=h.s.r;v<=h.e.r;++v){s(d,-1,0,"BOT");for(var y=h.s.c;y<=h.e.c;++y){var g=st({r:v,c:y});if(m=x?(f[v]||[])[y]:f[g],!m){s(d,1,0,"");continue}switch(m.t){case"n":var b=m.w;!b&&m.v!=null&&(b=m.v),b==null?m.f&&!m.F?s(d,1,0,"="+m.f):s(d,1,0,""):s(d,0,b,"V");break;case"b":s(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":s(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Ma(m.z||it[14],Dr(qt(m.v)))),s(d,0,m.w,"V");break;default:s(d,1,0,"")}}}s(d,-1,0,"EOD");var N=`\r
`,_=d.join(N);return _}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),bO=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,x){for(var v=m.split(`
`),y=-1,g=-1,b=0,N=[];b!==v.length;++b){var _=v[b].trim().split(":");if(_[0]==="cell"){var S=or(_[1]);if(N.length<=S.r)for(y=N.length;y<=S.r;++y)N[y]||(N[y]=[]);switch(y=S.r,g=S.c,_[2]){case"t":N[y][g]=e(_[3]);break;case"v":N[y][g]=+_[3];break;case"vtf":var C=_[_.length-1];case"vtc":switch(_[3]){case"nl":N[y][g]=!!+_[4];break;default:N[y][g]=+_[4];break}_[2]=="vtf"&&(N[y][g]=[N[y][g],C])}}}return x&&x.sheetRows&&(N=N.slice(0,x.sheetRows)),N}function n(m,x){return Pc(r(m,x),x)}function a(m,x){return ro(n(m,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var x=[],v=[],y,g="",b=Gn(m["!ref"]),N=Array.isArray(m),_=b.s.r;_<=b.e.r;++_)for(var S=b.s.c;S<=b.e.c;++S)if(g=st({r:_,c:S}),y=N?(m[_]||[])[S]:m[g],!(!y||y.v==null||y.t==="z")){switch(v=["cell",g,"t"],y.t){case"s":case"str":v.push(t(y.v));break;case"n":y.f?(v[2]="vtf",v[3]="n",v[4]=y.v,v[5]=t(y.f)):(v[2]="v",v[3]=y.v);break;case"b":v[2]="vt"+(y.f?"f":"c"),v[3]="nl",v[4]=y.v?"1":"0",v[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var C=Dr(qt(y.v));v[2]="vtc",v[3]="nd",v[4]=""+C,v[5]=y.w||Ma(y.z||it[14],C);break;case"e":continue}x.push(v.join(":"))}return x.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(m){return[i,s,l,s,d(m),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}})(),hc=(function(){function e(h,m,x,v,y){y.raw?m[x][v]=h:h===""||(h==="TRUE"?m[x][v]=!0:h==="FALSE"?m[x][v]=!1:isNaN(Za(h))?isNaN(dc(h).getDate())?m[x][v]=h:m[x][v]=qt(h):m[x][v]=Za(h))}function t(h,m){var x=m||{},v=[];if(!h||h.length===0)return v;for(var y=h.split(/[\r\n]/),g=y.length-1;g>=0&&y[g].length===0;)--g;for(var b=10,N=0,_=0;_<=g;++_)N=y[_].indexOf(" "),N==-1?N=y[_].length:N++,b=Math.max(b,N);for(_=0;_<=g;++_){v[_]=[];var S=0;for(e(y[_].slice(0,b).trim(),v,_,S,x),S=1;S<=(y[_].length-b)/10+1;++S)e(y[_].slice(b+(S-1)*10,b+S*10).trim(),v,_,S,x)}return x.sheetRows&&(v=v.slice(0,x.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var m={},x=!1,v=0,y=0;v<h.length;++v)(y=h.charCodeAt(v))==34?x=!x:!x&&y in r&&(m[y]=(m[y]||0)+1);y=[];for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&y.push([m[v],v]);if(!y.length){m=n;for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&y.push([m[v],v])}return y.sort(function(g,b){return g[0]-b[0]||n[g[1]]-n[b[1]]}),r[y.pop()[1]]||44}function i(h,m){var x=m||{},v="",y=x.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(v=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(v=h.charAt(4),h=h.slice(6)):v=a(h.slice(0,1024)):x&&x.FS?v=x.FS:v=a(h.slice(0,1024));var b=0,N=0,_=0,S=0,C=0,T=v.charCodeAt(0),k=!1,P=0,D=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var R=x.dateNF!=null?IX(x.dateNF):null;function G(){var M=h.slice(S,C),H={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)H.t="z";else if(x.raw)H.t="s",H.v=M;else if(M.trim().length===0)H.t="s",H.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(H.t="s",H.v=M.slice(2,-1).replace(/""/g,'"')):ute(M)?(H.t="n",H.f=M.slice(1)):(H.t="s",H.v=M);else if(M=="TRUE")H.t="b",H.v=!0;else if(M=="FALSE")H.t="b",H.v=!1;else if(!isNaN(_=Za(M)))H.t="n",x.cellText!==!1&&(H.w=M),H.v=_;else if(!isNaN(dc(M).getDate())||R&&M.match(R)){H.z=x.dateNF||it[14];var z=0;R&&M.match(R)&&(M=MX(M,x.dateNF,M.match(R)||[]),z=1),x.cellDates?(H.t="d",H.v=qt(M,z)):(H.t="n",H.v=Dr(qt(M,z))),x.cellText!==!1&&(H.w=Ma(H.z,H.v instanceof Date?Dr(H.v):H.v)),x.cellNF||delete H.z}else H.t="s",H.v=M;if(H.t=="z"||(x.dense?(y[b]||(y[b]=[]),y[b][N]=H):y[st({c:N,r:b})]=H),S=C+1,D=h.charCodeAt(S),g.e.c<N&&(g.e.c=N),g.e.r<b&&(g.e.r=b),P==T)++N;else if(N=0,++b,x.sheetRows&&x.sheetRows<=b)return!0}e:for(;C<h.length;++C)switch(P=h.charCodeAt(C)){case 34:D===34&&(k=!k);break;case T:case 10:case 13:if(!k&&G())break e;break}return C-S>0&&G(),y["!ref"]=mt(g),y}function s(h,m){return!(m&&m.PRN)||m.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,m):Pc(t(h,m),m)}function l(h,m){var x="",v=m.type=="string"?[0,0,0,0]:nw(h,m);switch(m.type){case"base64":x=da(h);break;case"binary":x=h;break;case"buffer":m.codepage==65001?x=h.toString("utf8"):m.codepage&&typeof of<"u"||(x=xt&&Buffer.isBuffer(h)?h.toString("binary"):to(h));break;case"array":x=Xo(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+m.type)}return v[0]==239&&v[1]==187&&v[2]==191?x=Lt(x.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?x=Lt(x):m.type=="binary"&&typeof of<"u",x.slice(0,19)=="socialcalc:version:"?bO.to_sheet(m.type=="string"?x:Lt(x),m):s(x,m)}function f(h,m){return ro(l(h,m),m)}function d(h){for(var m=[],x=St(h["!ref"]),v,y=Array.isArray(h),g=x.s.r;g<=x.e.r;++g){for(var b=[],N=x.s.c;N<=x.e.c;++N){var _=st({r:g,c:N});if(v=y?(h[g]||[])[N]:h[_],!v||v.v==null){b.push("          ");continue}for(var S=(v.w||(Zi(v),v.w)||"").slice(0,10);S.length<10;)S+=" ";b.push(S+(N===0?" ":""))}m.push(b.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:l,from_sheet:d}})();function YQ(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=vO.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return hc.to_workbook(e,t)}}var Lo=(function(){function e(O,ae,ee){if(O){sn(O,O.l||0);for(var L=ee.Enum||me;O.l<O.length;){var V=O.read_shift(2),se=L[V]||L[65535],U=O.read_shift(2),W=O.l+U,X=se.f&&se.f(O,U,ee);if(O.l=W,ae(X,se,V))return}}}function t(O,ae){switch(ae.type){case"base64":return r(ia(da(O)),ae);case"binary":return r(ia(O),ae);case"buffer":case"array":return r(O,ae)}throw"Unsupported type "+ae.type}function r(O,ae){if(!O)return O;var ee=ae||{},L=ee.dense?[]:{},V="Sheet1",se="",U=0,W={},X=[],de=[],F={s:{r:0,c:0},e:{r:0,c:0}},Pe=ee.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)ee.Enum=me,e(O,function(Te,lt,jt){switch(jt){case 0:ee.vers=Te,Te>=4096&&(ee.qpro=!0);break;case 6:F=Te;break;case 204:Te&&(se=Te);break;case 222:se=Te;break;case 15:case 51:ee.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:jt==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=ee.dateNF||it[14],ee.cellDates&&(Te[1].t="d",Te[1].v=Em(Te[1].v))),ee.qpro&&Te[3]>U&&(L["!ref"]=mt(F),W[V]=L,X.push(V),L=ee.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},U=Te[3],V=se||"Sheet"+(U+1),se="");var Yt=ee.dense?(L[Te[0].r]||[])[Te[0].c]:L[st(Te[0])];if(Yt){Yt.t=Te[1].t,Yt.v=Te[1].v,Te[1].z!=null&&(Yt.z=Te[1].z),Te[1].f!=null&&(Yt.f=Te[1].f);break}ee.dense?(L[Te[0].r]||(L[Te[0].r]=[]),L[Te[0].r][Te[0].c]=Te[1]):L[st(Te[0])]=Te[1];break}},ee);else if(O[2]==26||O[2]==14)ee.Enum=J,O[2]==14&&(ee.qpro=!0,O.l=0),e(O,function(Te,lt,jt){switch(jt){case 204:V=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>U&&(L["!ref"]=mt(F),W[V]=L,X.push(V),L=ee.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},U=Te[3],V="Sheet"+(U+1)),Pe>0&&Te[0].r>=Pe)break;ee.dense?(L[Te[0].r]||(L[Te[0].r]=[]),L[Te[0].r][Te[0].c]=Te[1]):L[st(Te[0])]=Te[1],F.e.c<Te[0].c&&(F.e.c=Te[0].c),F.e.r<Te[0].r&&(F.e.r=Te[0].r);break;case 27:Te[14e3]&&(de[Te[14e3][0]]=Te[14e3][1]);break;case 1537:de[Te[0]]=Te[1],Te[0]==U&&(V=Te[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(L["!ref"]=mt(F),W[se||V]=L,X.push(se||V),!de.length)return{SheetNames:X,Sheets:W};for(var Ae={},We=[],Ue=0;Ue<de.length;++Ue)W[X[Ue]]?(We.push(de[Ue]||X[Ue]),Ae[de[Ue]]=W[de[Ue]]||W[X[Ue]]):(We.push(de[Ue]),Ae[de[Ue]]={"!ref":"A1"});return{SheetNames:We,Sheets:Ae}}function n(O,ae){var ee=ae||{};if(+ee.codepage>=0&&Ja(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var L=Vn(),V=St(O["!ref"]),se=Array.isArray(O),U=[];Be(L,0,i(1030)),Be(L,6,f(V));for(var W=Math.min(V.e.r,8191),X=V.s.r;X<=W;++X)for(var de=yr(X),F=V.s.c;F<=V.e.c;++F){X===V.s.r&&(U[F]=sr(F));var Pe=U[F]+de,Ae=se?(O[X]||[])[F]:O[Pe];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?Be(L,13,v(X,F,Ae.v)):Be(L,14,g(X,F,Ae.v));else{var We=Zi(Ae);Be(L,15,m(X,F,We.slice(0,239)))}}return Be(L,1),L.end()}function a(O,ae){var ee=ae||{};if(+ee.codepage>=0&&Ja(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var L=Vn();Be(L,0,s(O));for(var V=0,se=0;V<O.SheetNames.length;++V)(O.Sheets[O.SheetNames[V]]||{})["!ref"]&&Be(L,27,K(O.SheetNames[V],se++));var U=0;for(V=0;V<O.SheetNames.length;++V){var W=O.Sheets[O.SheetNames[V]];if(!(!W||!W["!ref"])){for(var X=St(W["!ref"]),de=Array.isArray(W),F=[],Pe=Math.min(X.e.r,8191),Ae=X.s.r;Ae<=Pe;++Ae)for(var We=yr(Ae),Ue=X.s.c;Ue<=X.e.c;++Ue){Ae===X.s.r&&(F[Ue]=sr(Ue));var Te=F[Ue]+We,lt=de?(W[Ae]||[])[Ue]:W[Te];if(!(!lt||lt.t=="z"))if(lt.t=="n")Be(L,23,G(Ae,Ue,U,lt.v));else{var jt=Zi(lt);Be(L,22,P(Ae,Ue,U,jt.slice(0,239)))}}++U}}return Be(L,1),L.end()}function i(O){var ae=Ee(2);return ae.write_shift(2,O),ae}function s(O){var ae=Ee(26);ae.write_shift(2,4096),ae.write_shift(2,4),ae.write_shift(4,0);for(var ee=0,L=0,V=0,se=0;se<O.SheetNames.length;++se){var U=O.SheetNames[se],W=O.Sheets[U];if(!(!W||!W["!ref"])){++V;var X=Gn(W["!ref"]);ee<X.e.r&&(ee=X.e.r),L<X.e.c&&(L=X.e.c)}}return ee>8191&&(ee=8191),ae.write_shift(2,ee),ae.write_shift(1,V),ae.write_shift(1,L),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(1,1),ae.write_shift(1,2),ae.write_shift(4,0),ae.write_shift(4,0),ae}function l(O,ae,ee){var L={s:{c:0,r:0},e:{c:0,r:0}};return ae==8&&ee.qpro?(L.s.c=O.read_shift(1),O.l++,L.s.r=O.read_shift(2),L.e.c=O.read_shift(1),O.l++,L.e.r=O.read_shift(2),L):(L.s.c=O.read_shift(2),L.s.r=O.read_shift(2),ae==12&&ee.qpro&&(O.l+=2),L.e.c=O.read_shift(2),L.e.r=O.read_shift(2),ae==12&&ee.qpro&&(O.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function f(O){var ae=Ee(8);return ae.write_shift(2,O.s.c),ae.write_shift(2,O.s.r),ae.write_shift(2,O.e.c),ae.write_shift(2,O.e.r),ae}function d(O,ae,ee){var L=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(L[0].c=O.read_shift(1),L[3]=O.read_shift(1),L[0].r=O.read_shift(2),O.l+=2):(L[2]=O.read_shift(1),L[0].c=O.read_shift(2),L[0].r=O.read_shift(2)),L}function h(O,ae,ee){var L=O.l+ae,V=d(O,ae,ee);if(V[1].t="s",ee.vers==20768){O.l++;var se=O.read_shift(1);return V[1].v=O.read_shift(se,"utf8"),V}return ee.qpro&&O.l++,V[1].v=O.read_shift(L-O.l,"cstr"),V}function m(O,ae,ee){var L=Ee(7+ee.length);L.write_shift(1,255),L.write_shift(2,ae),L.write_shift(2,O),L.write_shift(1,39);for(var V=0;V<L.length;++V){var se=ee.charCodeAt(V);L.write_shift(1,se>=128?95:se)}return L.write_shift(1,0),L}function x(O,ae,ee){var L=d(O,ae,ee);return L[1].v=O.read_shift(2,"i"),L}function v(O,ae,ee){var L=Ee(7);return L.write_shift(1,255),L.write_shift(2,ae),L.write_shift(2,O),L.write_shift(2,ee,"i"),L}function y(O,ae,ee){var L=d(O,ae,ee);return L[1].v=O.read_shift(8,"f"),L}function g(O,ae,ee){var L=Ee(13);return L.write_shift(1,255),L.write_shift(2,ae),L.write_shift(2,O),L.write_shift(8,ee,"f"),L}function b(O,ae,ee){var L=O.l+ae,V=d(O,ae,ee);if(V[1].v=O.read_shift(8,"f"),ee.qpro)O.l=L;else{var se=O.read_shift(2);C(O.slice(O.l,O.l+se),V),O.l+=se}return V}function N(O,ae,ee){var L=ae&32768;return ae&=-32769,ae=(L?O:0)+(ae>=8192?ae-16384:ae),(L?"":"$")+(ee?sr(ae):yr(ae))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(O,ae){sn(O,0);for(var ee=[],L=0,V="",se="",U="",W="";O.l<O.length;){var X=O[O.l++];switch(X){case 0:ee.push(O.read_shift(8,"f"));break;case 1:se=N(ae[0].c,O.read_shift(2),!0),V=N(ae[0].r,O.read_shift(2),!1),ee.push(se+V);break;case 2:{var de=N(ae[0].c,O.read_shift(2),!0),F=N(ae[0].r,O.read_shift(2),!1);se=N(ae[0].c,O.read_shift(2),!0),V=N(ae[0].r,O.read_shift(2),!1),ee.push(de+F+":"+se+V)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(O.read_shift(2));break;case 6:{for(var Pe="";X=O[O.l++];)Pe+=String.fromCharCode(X);ee.push('"'+Pe.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:W=ee.pop(),U=ee.pop(),ee.push(["AND","OR"][X-20]+"("+U+","+W+")");break;default:if(X<32&&S[X])W=ee.pop(),U=ee.pop(),ee.push(U+S[X]+W);else if(_[X]){if(L=_[X][1],L==69&&(L=O[O.l++]),L>ee.length){console.error("WK1 bad formula parse 0x"+X.toString(16)+":|"+ee.join("|")+"|");return}var Ae=ee.slice(-L);ee.length-=L,ee.push(_[X][0]+"("+Ae.join(",")+")")}else return X<=7?console.error("WK1 invalid opcode "+X.toString(16)):X<=24?console.error("WK1 unsupported op "+X.toString(16)):X<=30?console.error("WK1 invalid opcode "+X.toString(16)):X<=115?console.error("WK1 unsupported function opcode "+X.toString(16)):console.error("WK1 unrecognized opcode "+X.toString(16))}}ee.length==1?ae[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function T(O){var ae=[{c:0,r:0},{t:"n",v:0},0];return ae[0].r=O.read_shift(2),ae[3]=O[O.l++],ae[0].c=O[O.l++],ae}function k(O,ae){var ee=T(O);return ee[1].t="s",ee[1].v=O.read_shift(ae-4,"cstr"),ee}function P(O,ae,ee,L){var V=Ee(6+L.length);V.write_shift(2,O),V.write_shift(1,ee),V.write_shift(1,ae),V.write_shift(1,39);for(var se=0;se<L.length;++se){var U=L.charCodeAt(se);V.write_shift(1,U>=128?95:U)}return V.write_shift(1,0),V}function D(O,ae){var ee=T(O);ee[1].v=O.read_shift(2);var L=ee[1].v>>1;if(ee[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return ee[1].v=L,ee}function R(O,ae){var ee=T(O),L=O.read_shift(4),V=O.read_shift(4),se=O.read_shift(2);if(se==65535)return L===0&&V===3221225472?(ee[1].t="e",ee[1].v=15):L===0&&V===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var U=se&32768;return se=(se&32767)-16446,ee[1].v=(1-U*2)*(V*Math.pow(2,se+32)+L*Math.pow(2,se)),ee}function G(O,ae,ee,L){var V=Ee(14);if(V.write_shift(2,O),V.write_shift(1,ee),V.write_shift(1,ae),L==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var se=0,U=0,W=0,X=0;return L<0&&(se=1,L=-L),U=Math.log2(L)|0,L/=Math.pow(2,U-31),X=L>>>0,(X&2147483648)==0&&(L/=2,++U,X=L>>>0),L-=X,X|=2147483648,X>>>=0,L*=Math.pow(2,32),W=L>>>0,V.write_shift(4,W),V.write_shift(4,X),U+=16383+(se?32768:0),V.write_shift(2,U),V}function M(O,ae){var ee=R(O);return O.l+=ae-14,ee}function H(O,ae){var ee=T(O),L=O.read_shift(4);return ee[1].v=L>>6,ee}function z(O,ae){var ee=T(O),L=O.read_shift(8,"f");return ee[1].v=L,ee}function ne(O,ae){var ee=z(O);return O.l+=ae-10,ee}function Q(O,ae){return O[O.l+ae-1]==0?O.read_shift(ae,"cstr"):""}function le(O,ae){var ee=O[O.l++];ee>ae-1&&(ee=ae-1);for(var L="";L.length<ee;)L+=String.fromCharCode(O[O.l++]);return L}function ue(O,ae,ee){if(!(!ee.qpro||ae<21)){var L=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var V=O.read_shift(ae-21,"cstr");return[L,V]}}function fe(O,ae){for(var ee={},L=O.l+ae;O.l<L;){var V=O.read_shift(2);if(V==14e3){for(ee[V]=[0,""],ee[V][0]=O.read_shift(2);O[O.l];)ee[V][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return ee}function K(O,ae){var ee=Ee(5+O.length);ee.write_shift(2,14e3),ee.write_shift(2,ae);for(var L=0;L<O.length;++L){var V=O.charCodeAt(L);ee[ee.l++]=V>127?95:V}return ee[ee.l++]=0,ee}var me={0:{n:"BOF",f:kr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:le},65535:{n:""}},J={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function JQ(e){var t={},r=e.match(Nn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=ct(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=bb[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var QQ=(function(){var e=uf("t"),t=uf("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var l={t:"s",v:wt(s[1])},f=i.match(t);return f&&(l.s=JQ(f[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(l){return l.v})}})(),ZQ=(function(){var t=/(\r\n|\n)/g;function r(a,i,s){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),s.push("</"+f+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),eZ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,tZ=/<(?:\w+:)?r>/,rZ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Hb(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=wt(Lt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Lt(e),r&&(n.h=Tb(n.t))):e.match(tZ)&&(n.r=Lt(e),n.t=wt(Lt((e.replace(rZ,"").match(eZ)||[]).join("").replace(Nn,""))),r&&(n.h=ZQ(QQ(n.r)))),n):{t:""}}var nZ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,aZ=/<(?:\w+:)?(?:si|sstItem)>/g,iZ=/<\/(?:\w+:)?(?:si|sstItem)>/;function sZ(e,t){var r=[],n="";if(!e)return r;var a=e.match(nZ);if(a){n=a[2].replace(aZ,"").split(iZ);for(var i=0;i!=n.length;++i){var s=Hb(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=ct(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var oZ=/^\s|\s$|[\t\n\r]/;function wO(e,t){if(!t.bookSST)return"";var r=[wr];r[r.length]=Le("sst",null,{xmlns:sl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(oZ)&&(i+=' xml:space="preserve"'),i+=">"+Mt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function lZ(e){return[e.read_shift(4),e.read_shift(4)]}function cZ(e,t){var r=[],n=!1;return ss(e,function(i,s,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function uZ(e,t){return t||(t=Ee(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var fZ=wY;function dZ(e){var t=Vn();je(t,159,uZ(e));for(var r=0;r<e.length;++r)je(t,19,fZ(e[r]));return je(t,160),t.end()}function SO(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Vi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function hZ(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Vi(e,4),t.U=Vi(e,4),t.W=Vi(e,4),t}function mZ(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function pZ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(mZ(e));return t}function xZ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function gZ(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Vi(e,4),t.U=Vi(e,4),t.W=Vi(e,4),t}function vZ(e){var t=gZ(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function NO(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function EO(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function yZ(e){var t=Vi(e);switch(t.Minor){case 2:return[t.Minor,bZ(e)];case 3:return[t.Minor,wZ()];case 4:return[t.Minor,SZ(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function bZ(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=NO(e,r),a=EO(e,e.length-e.l);return{t:"Std",h:n,v:a}}function wZ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function SZ(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Nn,function(i){var s=ct(i);switch(bi(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=s[l]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function NZ(e,t){var r={},n=r.EncryptionVersionInfo=Vi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=NO(e,a),t-=a,r.EncryptionVerifier=EO(e,t),r}function EZ(e){var t={},r=t.EncryptionVersionInfo=Vi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Vb(e){var t=0,r,n=SO(e),a=n.length+1,i,s,l,f,d;for(r=Ws(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],l=(t&16384)===0?0:1,f=t<<1&32767,d=l|f,t=d^s;return t^52811}var _O=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,l){return n(s^l)},i=function(s){for(var l=t[s.length-1],f=104,d=s.length-1;d>=0;--d)for(var h=s[d],m=0;m!=7;++m)h&64&&(l^=r[f]),h*=2,--f;return l};return function(s){for(var l=SO(s),f=i(l),d=l.length,h=Ws(16),m=0;m!=16;++m)h[m]=0;var x,v,y;for((d&1)===1&&(x=f>>8,h[d]=a(e[0],x),--d,x=f&255,v=l[l.length-1],h[d]=a(v,x));d>0;)--d,x=f>>8,h[d]=a(l[d],x),--d,x=f&255,h[d]=a(l[d],x);for(d=15,y=15-l.length;y>0;)x=f>>8,h[d]=a(e[y],x),--d,--y,x=f&255,h[d]=a(l[d],x),--d,--y;return h}})(),_Z=function(e,t,r,n,a){a||(a=t),n||(n=_O(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},kZ=function(e){var t=0,r=_O(e);return function(n){var a=_Z("",n,t,r);return t=a[1],a[0]}};function jZ(e,t,r,n){var a={key:kr(e),verificationBytes:kr(e)};return r.password&&(a.verifier=Vb(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=kZ(r.password)),a}function CZ(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=EZ(e):n.Data=NZ(e,t),n}function AZ(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?CZ(e,t-2,n):jZ(e,r.biff>=8?t:t-2,r,n),n}var kO=(function(){function e(a,i){switch(i.type){case"base64":return t(da(a),i);case"binary":return t(a,i);case"buffer":return t(xt&&Buffer.isBuffer(a)?a.toString("binary"):to(a),i);case"array":return t(Xo(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},l=s.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(h,m){Array.isArray(l)&&(l[m]=[]);for(var x=/\\\w+\b/g,v=0,y,g=-1;y=x.exec(h);){switch(y[0]){case"\\cell":var b=h.slice(v,x.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++g,b.length){var N={v:b,t:"s"};Array.isArray(l)?l[m][g]=N:l[st({r:m,c:g})]=N}break}v=x.lastIndex}g>d.e.c&&(d.e.c=g)}),l["!ref"]=mt(d),l}function r(a,i){return ro(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=St(a["!ref"]),l,f=Array.isArray(a),d=s.s.r;d<=s.e.r;++d){i.push("\\trowd\\trautofit1");for(var h=s.s.c;h<=s.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=s.s.c;h<=s.e.c;++h){var m=st({r:d,c:h});l=f?(a[d]||[])[h]:a[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Zi(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function TZ(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function mf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function PZ(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var l=0,f=0,d=a+i;switch(f=s/(d>1?2-d:d),a){case t:l=((r-n)/s+6)%6;break;case r:l=(n-t)/s+2;break;case n:l=(t-r)/s+4;break}return[l/6,f,d/2]}function OZ(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],l=6*t,f;if(r!==0)switch(l|0){case 0:case 6:f=a*l,s[0]+=a,s[1]+=f;break;case 1:f=a*(2-l),s[0]+=f,s[1]+=a;break;case 2:f=a*(l-2),s[1]+=a,s[2]+=f;break;case 3:f=a*(4-l),s[1]+=f,s[2]+=a;break;case 4:f=a*(l-4),s[2]+=a,s[0]+=f;break;case 5:f=a*(6-l),s[2]+=f,s[0]+=a;break}for(var d=0;d!=3;++d)s[d]=Math.round(s[d]*255);return s}function Fh(e,t){if(t===0)return e;var r=PZ(TZ(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),mf(OZ(r))}var jO=6,FZ=15,DZ=1,vn=jO;function pf(e){return Math.floor((e+Math.round(128/vn)/256)*vn)}function xf(e){return Math.floor((e-5)/vn*100+.5)/100}function Dh(e){return Math.round((e*vn+5)/vn*256)/256}function ev(e){return Dh(xf(pf(e)))}function Kb(e){var t=Math.abs(e-ev(e)),r=vn;if(t>.005)for(vn=DZ;vn<FZ;++vn)Math.abs(e-ev(e))<=t&&(t=Math.abs(e-ev(e)),r=vn);vn=r}function Hs(e){e.width?(e.wpx=pf(e.width),e.wch=xf(e.wpx),e.MDW=vn):e.wpx?(e.wch=xf(e.wpx),e.width=Dh(e.wch),e.MDW=vn):typeof e.wch=="number"&&(e.width=Dh(e.wch),e.wpx=pf(e.width),e.MDW=vn),e.customWidth&&delete e.customWidth}var IZ=96,CO=IZ;function gf(e){return e*96/CO}function mc(e){return e*CO/96}var MZ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function RZ(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Nn)||[]).forEach(function(s){var l=ct(s);switch(bi(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Gt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Gt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function LZ(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Nn)||[]).forEach(function(s){var l=ct(s);switch(bi(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function BZ(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Nn)||[]).forEach(function(s){var l=ct(s);switch(bi(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Lt(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Gt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Gt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Gt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Gt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Gt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Gt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Gt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=bb[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Gt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var f=Mo[a.color.index];a.color.index==81&&(f=Mo[1]),f||(f=Mo[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Fh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function $Z(e,t,r){t.NumberFmt=[];for(var n=dr(it),a=0;a<n.length;++a)t.NumberFmt[n[a]]=it[n[a]];var i=e[0].match(Nn);if(i)for(a=0;a<i.length;++a){var s=ct(i[a]);switch(bi(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=wt(Lt(s.formatCode)),f=parseInt(s.numFmtId,10);if(t.NumberFmt[f]=l,f>0){if(f>392){for(f=392;f>60&&t.NumberFmt[f]!=null;--f);t.NumberFmt[f]=l}Hi(l,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function UZ(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Le("numFmt",null,{numFmtId:n,formatCode:Mt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Le("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var E0=["numFmtId","fillId","fontId","borderId","xfId"],_0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zZ(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Nn)||[]).forEach(function(i){var s=ct(i),l=0;switch(bi(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],l=0;l<E0.length;++l)n[E0[l]]&&(n[E0[l]]=parseInt(n[E0[l]],10));for(l=0;l<_0.length;++l)n[_0[l]]&&(n[_0[l]]=Gt(n[_0[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};s.vertical&&(f.vertical=s.vertical),s.horizontal&&(f.horizontal=s.horizontal),s.textRotation!=null&&(f.textRotation=s.textRotation),s.indent&&(f.indent=s.indent),s.wrapText&&(f.wrapText=Gt(s.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function WZ(e){var t=[];return t[t.length]=Le("cellXfs",null),e.forEach(function(r){t[t.length]=Le("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Le("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var HZ=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,f,d){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&$Z(m,h,d),(m=l.match(a))&&BZ(m,h,f,d),(m=l.match(n))&&LZ(m,h,f,d),(m=l.match(i))&&RZ(m,h,f,d),(m=l.match(r))&&zZ(m,h,d),h}})();function AO(e,t){var r=[wr,Le("styleSheet",null,{xmlns:sl[0],"xmlns:vt":Fr.vt})],n;return e.SSF&&(n=UZ(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=WZ(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function VZ(e,t){var r=e.read_shift(2),n=wn(e);return[r,n]}function KZ(e,t,r){r||(r=Ee(6+4*t.length)),r.write_shift(2,e),Gr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function GZ(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=CY(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var l=e.read_shift(1);l>0&&(n.family=l);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=jY(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=wn(e),n}function qZ(e,t){t||(t=Ee(153)),t.write_shift(2,e.sz*20),AY(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Th(e.color,t);var n=0;return n=2,t.write_shift(1,n),Gr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var XZ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],tv,YZ=Sn;function Hj(e,t){t||(t=Ee(84)),tv||(tv=Sm(XZ));var r=tv[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Th({auto:1},t),Th({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function JZ(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function TO(e,t,r){r||(r=Ee(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ju(e,t){return t||(t=Ee(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var QZ=Sn;function ZZ(e,t){return t||(t=Ee(51)),t.write_shift(1,0),ju(null,t),ju(null,t),ju(null,t),ju(null,t),ju(null,t),t.length>t.l?t.slice(0,t.l):t}function eee(e,t){return t||(t=Ee(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Ah(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function tee(e,t,r){var n=Ee(2052);return n.write_shift(4,e),Ah(t,n),Ah(r,n),n.length>n.l?n.slice(0,n.l):n}function ree(e,t,r){var n={};n.NumberFmt=[];for(var a in it)n.NumberFmt[a]=it[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return ss(e,function(f,d,h){switch(h){case 44:n.NumberFmt[f[0]]=f[1],Hi(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(f.color.rgb=Fh(t.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(h),s=!0;break;case 38:i.pop(),s=!1;break;default:if(d.T>0)i.push(h);else if(d.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function nee(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(je(e,615,ei(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&je(e,44,KZ(a,t[a]))}),je(e,616))}}function aee(e){var t=1;je(e,611,ei(t)),je(e,43,qZ({sz:12,color:{theme:1},name:"Calibri",family:2})),je(e,612)}function iee(e){var t=2;je(e,603,ei(t)),je(e,45,Hj({patternType:"none"})),je(e,45,Hj({patternType:"gray125"})),je(e,604)}function see(e){var t=1;je(e,613,ei(t)),je(e,46,ZZ()),je(e,614)}function oee(e){var t=1;je(e,626,ei(t)),je(e,47,TO({numFmtId:0},65535)),je(e,627)}function lee(e,t){je(e,617,ei(t.length)),t.forEach(function(r){je(e,47,TO(r,0))}),je(e,618)}function cee(e){var t=1;je(e,619,ei(t)),je(e,48,eee({xfId:0,name:"Normal"})),je(e,620)}function uee(e){var t=0;je(e,505,ei(t)),je(e,506)}function fee(e){var t=0;je(e,508,tee(t,"TableStyleMedium9","PivotStyleMedium4")),je(e,509)}function dee(e,t){var r=Vn();return je(r,278),nee(r,e.SSF),aee(r),iee(r),see(r),oee(r),lee(r,t.cellXfs),cee(r),uee(r),fee(r),je(r,279),r.end()}var hee=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function mee(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Nn)||[]).forEach(function(a){var i=ct(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[hee.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function pee(){}function xee(){}var gee=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,vee=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yee=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function bee(e,t,r){t.themeElements={};var n;[["clrScheme",gee,mee],["fontScheme",vee,pee],["fmtScheme",yee,xee]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var wee=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function PO(e,t){(!e||e.length===0)&&(e=Gb());var r,n={};if(!(r=e.match(wee)))throw new Error("themeElements not found in theme");return bee(r[0],n,t),n.raw=e,n}function Gb(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[wr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function See(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=NP(i,{type:"array"})}catch{return}var l=sa(s,"theme/theme/theme1.xml",!0);if(l)return PO(l,r)}}function Nee(e){return e.read_shift(4)}function Eee(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=_ee(e,4);break;case 2:t.xclrValue=uO(e);break;case 3:t.xclrValue=Nee(e);break;case 4:e.l+=4;break}return e.l+=8,t}function _ee(e,t){return Sn(e,t)}function kee(e,t){return Sn(e,t)}function jee(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Eee(e);break;case 6:n[1]=kee(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Cee(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(jee(e,r-e.l));return{ixfe:n,ext:i}}function Aee(e,t){t.forEach(function(r){r[0]})}function Tee(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:wn(e)}}function Pee(e){var t=Ee(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Gr(e.name,t),t.slice(0,t.l)}function Oee(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Fee(e){var t=Ee(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Dee(e,t){var r=Ee(8+2*t.length);return r.write_shift(4,e),Gr(t,r),r.slice(0,r.l)}function Iee(e){return e.l+=4,e.read_shift(4)!=0}function Mee(e,t){var r=Ee(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Ree(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,l=2;return ss(e,function(f,d,h){switch(h){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=f?1:0;break;case 338:l=2;break;case 35:i.push(h),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!d.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function Lee(){var e=Vn();return je(e,332),je(e,334,ei(1)),je(e,335,Pee({name:"XLDAPR",version:12e4,flags:3496657072})),je(e,336),je(e,339,Dee(1,"XLDAPR")),je(e,52),je(e,35,ei(514)),je(e,4096,ei(0)),je(e,4097,Aa(1)),je(e,36),je(e,53),je(e,340),je(e,337,Mee(1)),je(e,51,Fee([[1,0]])),je(e,338),je(e,333),e.end()}function Bee(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(Nn,function(l){var f=ct(l);switch(bi(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(s=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return l}),n}function OO(){var e=[wr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function $ee(e){var t=[];if(!e)return t;var r=1;return(e.match(Nn)||[]).forEach(function(n){var a=ct(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Uee(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=st(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function zee(e,t,r){var n=[];return ss(e,function(i,s,l){switch(l){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Wee(e,t,r,n){if(!e)return e;var a=n||{},i=!1;ss(e,function(l,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function Hee(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Xl=1024;function FO(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Le("xml",null,{"xmlns:v":ra.v,"xmlns:o":ra.o,"xmlns:x":ra.x,"xmlns:mv":ra.mv}).replace(/\/>/,">"),Le("o:shapelayout",Le("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Le("v:shapetype",[Le("v:stroke",null,{joinstyle:"miter"}),Le("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Xl<e*1e3;)Xl+=1e3;return t.forEach(function(i){var s=or(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var f=l.type=="gradient"?Le("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Le("v:fill",f,l),h={on:"t",obscured:"t"};++Xl,a=a.concat(["<v:shape"+ff({id:"_x0000_s"+Xl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Le("v:shadow",null,h),Le("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ln("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),ln("x:AutoFill","False"),ln("x:Row",String(s.r)),ln("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Vj(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var l=or(s.ref);if(a?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[s.ref],!i){i={t:"z"},a?e[l.r][l.c]=i:e[s.ref]=i;var f=St(e["!ref"]||"BDWGO1000001:A1");f.s.r>l.r&&(f.s.r=l.r),f.e.r<l.r&&(f.e.r=l.r),f.s.c>l.c&&(f.s.c=l.c),f.e.c<l.c&&(f.e.c=l.c);var d=mt(f);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var h={a:s.author,t:s.t,r:s.r,T:r};s.h&&(h.h=s.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(h.a==n[m].id){h.a=n[m].name||h.a;break}}i.c.push(h)})}function Vee(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?comment[^>]*>/);if(l){var f=ct(l[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},h=or(f.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var m=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!m&&!!m[1]&&Hb(m[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=x.h),n.push(d)}}}}),n}function DO(e){var t=[wr,Le("comments",null,{xmlns:sl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Mt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(Mt(f.a))),i.push(f.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(ln("t",Mt(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)s+=`Reply:
    `+i[l]+`
`;t.push(ln("t",Mt(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Kee(e,t){var r=[],n=!1,a={},i=0;return e.replace(Nn,function(l,f){var d=ct(l);switch(bi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+l.length;break;case"</text>":a.t=e.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function Gee(e,t,r){var n=[wr,Le("ThreadedComments",null,{xmlns:Fr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,l){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=f.id:f.parentId=i,s.ID=f.id,s.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Le("threadedComment",ln("text",s.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function qee(e,t){var r=[],n=!1;return e.replace(Nn,function(i){var s=ct(i);switch(bi(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function Xee(e){var t=[wr,Le("personList",null,{xmlns:Fr.TCMNT,"xmlns:x":sl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Le("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Yee(e){var t={};t.iauthor=e.read_shift(4);var r=ul(e);return t.rfx=r.s,t.ref=st(r.s),e.l+=16,t}function Jee(e,t){return t==null&&(t=Ee(36)),t.write_shift(4,e[1].iauthor),Oc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Qee=wn;function Zee(e){return Gr(e.slice(0,54))}function ete(e,t){var r=[],n=[],a={},i=!1;return ss(e,function(l,f,d){switch(d){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function tte(e){var t=Vn(),r=[];return je(t,628),je(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),je(t,632,Zee(a.a)))})}),je(t,631),je(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:or(n[0]),e:or(n[0])};je(t,635,Jee([i,a])),a.t&&a.t.length>0&&je(t,637,NY(a)),je(t,636),delete a.iauthor})}),je(t,634),je(t,629),t.end()}var rte="application/vnd.ms-office.vbaProject";function nte(e){var t=tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),tt.write(t)}function ate(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&tt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var IO=["xlsb","xlsm","xlam","biff8","xla"];function ite(){return{"!type":"dialog"}}function ste(){return{"!type":"dialog"}}function ote(){return{"!type":"macro"}}function lte(){return{"!type":"macro"}}var ec=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var l=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,h=s.length>0?parseInt(s,10)|0:0;return l?h+=t.c:--h,f?d+=t.r:--d,a+(l?"":"$")+sr(h)+(f?"":"$")+yr(d)}return function(a,i){return t=i,a.replace(e,r)}})(),qb=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xb=(function(){return function(t,r){return t.replace(qb,function(n,a,i,s,l,f){var d=Ib(s)-(i?0:r.c),h=Db(f)-(l?0:r.r),m=h==0?"":l?h+1:"["+h+"]",x=d==0?"":i?d+1:"["+d+"]";return a+"R"+m+"C"+x})}})();function MO(e,t){return e.replace(qb,function(r,n,a,i,s,l){return n+(a=="$"?a+i:sr(Ib(i)+t.c))+(s=="$"?s+l:yr(Db(l)+t.r))})}function cte(e,t,r){var n=Gn(t),a=n.s,i=or(r),s={r:i.r-a.r,c:i.c-a.c};return MO(e,s)}function ute(e){return e.length!=1}function Kj(e){return e.replace(/_xlfn\./g,"")}function Er(e){e.l+=1}function Vs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function RO(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return LO(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Vs(e),l=Vs(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function LO(e){var t=Vs(e),r=Vs(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function fte(e,t,r){if(r.biff<8)return LO(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Vs(e),s=Vs(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function BO(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return dte(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Vs(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function dte(e){var t=Vs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function hte(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function mte(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return pte(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:l}}function pte(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function xte(e,t,r){var n=(e[e.l++]&96)>>5,a=RO(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function gte(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=RO(e,i,r);return[n,a,s]}function vte(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function yte(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function bte(e,t,r){var n=(e[e.l++]&96)>>5,a=fte(e,t-1,r);return[n,a]}function wte(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Gj(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Ste(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Nte(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ete(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function _te(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function kte(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function $O(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function jte(e){return e.read_shift(2),$O(e)}function Cte(e){return e.read_shift(2),$O(e)}function Ate(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=BO(e,0,r);return[n,a]}function Tte(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=mte(e,0,r);return[n,a]}function Pte(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=BO(e,0,r);return[n,a,i]}function Ote(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Ire[a],WO[a],n]}function Fte(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Dte(e);return[a,(i[0]===0?WO:Dre)[i[1]]]}function Dte(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Ite(e,t,r){e.l+=r&&r.biff==2?3:4}function Mte(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Rte(e){return e.l++,os[e.read_shift(1)]}function Lte(e){return e.l++,e.read_shift(2)}function Bte(e){return e.l++,e.read_shift(1)!==0}function $te(e){return e.l++,yn(e)}function Ute(e,t,r){return e.l++,Wf(e,t-1,r)}function zte(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=gr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=os[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=yn(e);break;case 2:r[1]=fl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Wte(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?ul:_m)(e));return a}function Hte(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var l=0;l!=a;++l)s[i][l]=zte(e,r.biff);return s}function Vte(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Kte(e,t,r){if(r.biff==5)return Gte(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Gte(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function qte(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Xte(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Yte(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Jte(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var Qte=Sn,Zte=Sn,ere=Sn;function Vf(e,t,r){return e.l+=2,[hte(e)]}function Yb(e){return e.l+=6,[]}var tre=Vf,rre=Yb,nre=Yb,are=Vf;function UO(e){return e.l+=2,[kr(e),e.read_shift(2)&1]}var ire=Vf,sre=UO,ore=Yb,lre=Vf,cre=Vf,ure=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fre(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=ure[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function dre(e){return e.l+=2,[e.read_shift(4)]}function hre(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function mre(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function pre(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function xre(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gre(e){return e.l+=4,[0,0]}var qj={1:{n:"PtgExp",f:Mte},2:{n:"PtgTbl",f:ere},3:{n:"PtgAdd",f:Er},4:{n:"PtgSub",f:Er},5:{n:"PtgMul",f:Er},6:{n:"PtgDiv",f:Er},7:{n:"PtgPower",f:Er},8:{n:"PtgConcat",f:Er},9:{n:"PtgLt",f:Er},10:{n:"PtgLe",f:Er},11:{n:"PtgEq",f:Er},12:{n:"PtgGe",f:Er},13:{n:"PtgGt",f:Er},14:{n:"PtgNe",f:Er},15:{n:"PtgIsect",f:Er},16:{n:"PtgUnion",f:Er},17:{n:"PtgRange",f:Er},18:{n:"PtgUplus",f:Er},19:{n:"PtgUminus",f:Er},20:{n:"PtgPercent",f:Er},21:{n:"PtgParen",f:Er},22:{n:"PtgMissArg",f:Er},23:{n:"PtgStr",f:Ute},26:{n:"PtgSheet",f:hre},27:{n:"PtgEndSheet",f:mre},28:{n:"PtgErr",f:Rte},29:{n:"PtgBool",f:Bte},30:{n:"PtgInt",f:Lte},31:{n:"PtgNum",f:$te},32:{n:"PtgArray",f:wte},33:{n:"PtgFunc",f:Ote},34:{n:"PtgFuncVar",f:Fte},35:{n:"PtgName",f:Vte},36:{n:"PtgRef",f:Ate},37:{n:"PtgArea",f:xte},38:{n:"PtgMemArea",f:qte},39:{n:"PtgMemErr",f:Qte},40:{n:"PtgMemNoMem",f:Zte},41:{n:"PtgMemFunc",f:Xte},42:{n:"PtgRefErr",f:Yte},43:{n:"PtgAreaErr",f:vte},44:{n:"PtgRefN",f:Tte},45:{n:"PtgAreaN",f:bte},46:{n:"PtgMemAreaN",f:pre},47:{n:"PtgMemNoMemN",f:xre},57:{n:"PtgNameX",f:Kte},58:{n:"PtgRef3d",f:Pte},59:{n:"PtgArea3d",f:gte},60:{n:"PtgRefErr3d",f:Jte},61:{n:"PtgAreaErr3d",f:yte},255:{}},vre={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yre={1:{n:"PtgElfLel",f:UO},2:{n:"PtgElfRw",f:lre},3:{n:"PtgElfCol",f:tre},6:{n:"PtgElfRwV",f:cre},7:{n:"PtgElfColV",f:are},10:{n:"PtgElfRadical",f:ire},11:{n:"PtgElfRadicalS",f:ore},13:{n:"PtgElfColS",f:rre},15:{n:"PtgElfColSV",f:nre},16:{n:"PtgElfRadicalLel",f:sre},25:{n:"PtgList",f:fre},29:{n:"PtgSxName",f:dre},255:{}},bre={0:{n:"PtgAttrNoop",f:gre},1:{n:"PtgAttrSemi",f:kte},2:{n:"PtgAttrIf",f:Ete},4:{n:"PtgAttrChoose",f:Ste},8:{n:"PtgAttrGoto",f:Nte},16:{n:"PtgAttrSum",f:Ite},32:{n:"PtgAttrBaxcel",f:Gj},33:{n:"PtgAttrBaxcel",f:Gj},64:{n:"PtgAttrSpace",f:jte},65:{n:"PtgAttrSpaceSemi",f:Cte},128:{n:"PtgAttrIfError",f:_te},255:{}};function Kf(e,t,r,n){if(n.biff<8)return Sn(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=Hte(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=Wte(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Sn(e,t)),i}function Gf(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=qj[i]||qj[vre[i]],(i===24||i===25)&&(a=(i===24?yre:bre)[e[e.l+1]]),!a||!a.f?Sn(e,t):s.push([a.n,a.f(e,t,r)]);return s}function wre(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Sre={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Nre(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function zO(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Xj(e,t,r){var n=zO(e,t,r);return n=="#REF"?n:Nre(n,r)}function xn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},l=[],f,d,h,m=0,x=0,v,y="";if(!e[0]||!e[0][0])return"";for(var g=-1,b="",N=0,_=e[0].length;N<_;++N){var S=e[0][N];switch(S[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=l.pop(),d=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:b=ur(" ",e[0][g][1][1]);break;case 1:b=ur("\r",e[0][g][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}d=d+b,g=-1}l.push(d+Sre[S[0]]+f);break;case"PtgIsect":f=l.pop(),d=l.pop(),l.push(d+" "+f);break;case"PtgUnion":f=l.pop(),d=l.pop(),l.push(d+","+f);break;case"PtgRange":f=l.pop(),d=l.pop(),l.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=$u(S[1][1],s,a),l.push(Uu(h,i));break;case"PtgRefN":h=r?$u(S[1][1],r,a):S[1][1],l.push(Uu(h,i));break;case"PtgRef3d":m=S[1][1],h=$u(S[1][2],s,a),y=Xj(n,m,a),l.push(y+"!"+Uu(h,i));break;case"PtgFunc":case"PtgFuncVar":var C=S[1][0],T=S[1][1];C||(C=0),C&=127;var k=C==0?[]:l.slice(-C);l.length-=C,T==="User"&&(T=k.shift()),l.push(T+"("+k.join(",")+")");break;case"PtgBool":l.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(S[1]);break;case"PtgNum":l.push(String(S[1]));break;case"PtgStr":l.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(S[1]);break;case"PtgAreaN":v=Ej(S[1][1],r?{s:r}:s,a),l.push(Jg(v,a));break;case"PtgArea":v=Ej(S[1][1],s,a),l.push(Jg(v,a));break;case"PtgArea3d":m=S[1][1],v=S[1][2],y=Xj(n,m,a),l.push(y+"!"+Jg(v,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=S[1][2];var P=(n.names||[])[x-1]||(n[0]||[])[x],D=P?P.Name:"SH33TJSNAME"+String(x);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),l.push(D);break;case"PtgNameX":var R=S[1][1];x=S[1][2];var G;if(a.biff<=5)R<0&&(R=-R),n[R]&&(G=n[R][x]);else{var M="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][x]&&n[R][x].itab>0&&(M=n.SheetNames[n[R][x].itab-1]+"!"):M=n.SheetNames[x-1]+"!"),n[R]&&n[R][x])M+=n[R][x].Name;else if(n[0]&&n[0][x])M+=n[0][x].Name;else{var H=(zO(n,R,a)||"").split(";;");H[x-1]?M=H[x-1]:M+="SH33TJSERRX"}l.push(M);break}G||(G={Name:"SH33TJSERRY"}),l.push(G.Name);break;case"PtgParen":var z="(",ne=")";if(g>=0){switch(b="",e[0][g][1][0]){case 2:z=ur(" ",e[0][g][1][1])+z;break;case 3:z=ur("\r",e[0][g][1][1])+z;break;case 4:ne=ur(" ",e[0][g][1][1])+ne;break;case 5:ne=ur("\r",e[0][g][1][1])+ne;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(z+l.pop()+ne);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:S[1][1],r:S[1][0]};var Q={c:r.c,r:r.r};if(n.sharedf[st(h)]){var le=n.sharedf[st(h)];l.push(xn(le,s,Q,n,a))}else{var ue=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){l.push(xn(d[1],s,Q,n,a)),ue=!0;break}ue||l.push(S[1])}break;case"PtgArray":l.push("{"+wre(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&fe.indexOf(e[0][N][0])==-1){S=e[0][g];var K=!0;switch(S[1][0]){case 4:K=!1;case 0:b=ur(" ",S[1][1]);break;case 5:K=!1;case 1:b=ur("\r",S[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}l.push((K?b:"")+l.pop()+(K?"":b)),g=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function Ere(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Sn(e,t-2)];var l=Gf(e,s,r);return t!==s+a&&(i=Kf(e,t-s-a,l,r)),e.l=n,[l,i]}function _re(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Sn(e,t-2)];var l=Gf(e,s,r);return t!==s+a&&(i=Kf(e,t-s-a,l,r)),e.l=n,[l,i]}function kre(e,t,r,n){var a=e.l+t,i=Gf(e,n,r),s;return a!==e.l&&(s=Kf(e,a-e.l,i,r)),[i,s]}function jre(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=Gf(e,i,r);return i==65535?[[],Sn(e,t-2)]:(t!==i+2&&(a=Kf(e,n-i-2,s,r)),[s,a])}function Cre(e){var t;if($i(e,e.l+6)!==65535)return[yn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Are(e){if(e==null){var t=Ee(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Yo(e);return Yo(0)}function rv(e,t,r){var n=e.l+t,a=wi(e);r.biff==2&&++e.l;var i=Cre(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=_re(e,n-e.l,r);return{cell:a,val:i[0],formula:l,shared:s>>3&1,tt:i[1]}}function Tre(e,t,r,n,a){var i=Qo(t,r,a),s=Are(e.v),l=Ee(6),f=33;l.write_shift(2,f),l.write_shift(4,0);for(var d=Ee(e.bf.length),h=0;h<e.bf.length;++h)d[h]=e.bf[h];var m=Vr([i,s,l,d]);return m}function km(e,t,r){var n=e.read_shift(4),a=Gf(e,n,r),i=e.read_shift(4),s=i>0?Kf(e,i,a,r):null;return[a,s]}var Pre=km,jm=km,Ore=km,Fre=km,Dre={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},WO={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Ire={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Yj(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Mre(e){var t="of:="+e.replace(qb,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function nv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Rre(e){return e.replace(/\./,"!")}var Wu={},tc={},Hu=typeof Map<"u";function Jb(e,t,r){var n=0,a=e.length;if(r){if(Hu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Hu?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Hu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Cm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(vn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=xf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Dh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Bo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function no(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Hi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function HO(e,t,r,n,a,i){try{n.cellNF&&(e.z=it[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=qt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(it[t]==null&&Hi(DX[t]||"General",t),e.t==="e")e.w=e.w||os[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cf(e.v);else if(e.t==="d"){var s=Dr(e.v);(s|0)===s?e.w=s.toString(10):e.w=cf(s)}else{if(e.v===void 0)return"";e.w=qo(e.v,tc)}else e.t==="d"?e.w=Ma(t,Dr(e.v),tc):e.w=Ma(t,e.v,tc)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Fh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Fh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function Lre(e,t,r){if(e&&e["!ref"]){var n=St(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Bre(e,t){var r=St(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=mt(r))}var $re=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ure=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zre=/<(?:\w:)?hyperlink [^>]*>/mg,Wre=/"(\w*:\w*)"/,Hre=/<(?:\w:)?col\b[^>]*[\/]?>/g,Vre=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Kre=/<(?:\w:)?pageMargins[^>]*\/>/g,VO=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Gre=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qre=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Xre(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",m=e.match(Ure);m?(d=e.slice(0,m.index),h=e.slice(m.index+m[0].length)):d=h=e;var x=d.match(VO);x?Qb(x[0],l,a,r):(x=d.match(Gre))&&Jre(x[0],x[1]||"",l,a,r);var v=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var y=d.slice(v,v+50).match(Wre);y&&Bre(l,y[1])}var g=d.match(qre);g&&g[1]&&une(g[1],a);var b=[];if(t.cellStyles){var N=d.match(Hre);N&&ine(b,N)}m&&hne(m[1],l,t,f,i,s);var _=h.match(Vre);_&&(l["!autofilter"]=one(_[0]));var S=[],C=h.match($re);if(C)for(v=0;v!=C.length;++v)S[v]=St(C[v].slice(C[v].indexOf('"')+1));var T=h.match(zre);T&&rne(l,T,n);var k=h.match(Kre);if(k&&(l["!margins"]=nne(ct(k[0]))),!l["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(l["!ref"]=mt(f)),t.sheetRows>0&&l["!ref"]){var P=St(l["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>f.e.r&&(P.e.r=f.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>f.e.c&&(P.e.c=f.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),l["!fullref"]=l["!ref"],l["!ref"]=mt(P))}return b.length>0&&(l["!cols"]=b),S.length>0&&(l["!merges"]=S),l}function Yre(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+mt(e[r])+'"/>';return t+"</mergeCells>"}function Qb(e,t,r,n){var a=ct(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=wt(Lt(a.codeName)))}function Jre(e,t,r,n,a){Qb(e.slice(0,e.indexOf(">")),r,n,a)}function Qre(e,t,r,n,a){var i=!1,s={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[r];try{t.Workbook&&(f=t.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,s.codeName=mi(Mt(f))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+Le("outlinePr",null,d)}!i&&!l||(a[a.length]=Le("sheetPr",l,s))}var Zre=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ene=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function tne(e){var t={sheet:1};return Zre.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),ene.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Vb(e.password).toString(16).toUpperCase()),Le("sheetProtection",null,t)}function rne(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=ct(Lt(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+wt(i.location))):(i.Target="#"+wt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=St(i.ref),f=l.s.r;f<=l.e.r;++f)for(var d=l.s.c;d<=l.e.c;++d){var h=st({c:d,r:f});n?(e[f]||(e[f]=[]),e[f][d]||(e[f][d]={t:"z",v:void 0}),e[f][d].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function nne(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function ane(e){return Bo(e),Le("pageMargins",null,e)}function ine(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=ct(t[n],!0);a.hidden&&(a.hidden=Gt(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Kb(a.width)),Hs(a);i<=s;)e[i++]=Xt(a)}}function sne(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Le("col",null,Cm(a,n)));return r[r.length]="</cols>",r.join("")}function one(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function lne(e,t,r,n){var a=typeof e.ref=="string"?e.ref:mt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Gn(a);s.s.r==s.e.r&&(s.e.r=Gn(t["!ref"]).e.r,a=mt(s));for(var l=0;l<i.length;++l){var f=i[l];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Le("autoFilter",null,{ref:a})}var cne=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function une(e,t){t.Views||(t.Views=[{}]),(e.match(cne)||[]).forEach(function(r,n){var a=ct(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Gt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function fne(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Le("sheetViews",Le("sheetView",null,a),{})}function dne(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=os[e.v];break;case"d":n&&n.cellDates?a=qt(e.v,-1).toISOString():(e=Xt(e),e.t="n",a=""+(e.v=Dr(qt(e.v)))),typeof e.z>"u"&&(e.z=it[14]);break;default:a=e.v;break}var l=ln("v",Mt(a)),f={r:t},d=no(n.cellXfs,e,n);switch(d!==0&&(f.s=d),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=ln("v",""+Jb(n.Strings,e.v,n.revStrings)),f.t="s";break}f.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Le("f",Mt(e.f),h)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(f.cm=1),Le("c",l,f)}var hne=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=uf("v"),s=uf("f");return function(f,d,h,m,x,v){for(var y=0,g="",b=[],N=[],_=0,S=0,C=0,T="",k,P,D=0,R=0,G,M,H=0,z=0,ne=Array.isArray(v.CellXf),Q,le=[],ue=[],fe=Array.isArray(d),K=[],me={},J=!1,O=!!h.sheetStubs,ae=f.split(t),ee=0,L=ae.length;ee!=L;++ee){g=ae[ee].trim();var V=g.length;if(V!==0){var se=0;e:for(y=0;y<V;++y)switch(g[y]){case">":if(g[y-1]!="/"){++y;break e}if(h&&h.cellStyles){if(P=ct(g.slice(se,y),!0),D=P.r!=null?parseInt(P.r,10):D+1,R=-1,h.sheetRows&&h.sheetRows<D)continue;me={},J=!1,P.ht&&(J=!0,me.hpt=parseFloat(P.ht),me.hpx=mc(me.hpt)),P.hidden=="1"&&(J=!0,me.hidden=!0),P.outlineLevel!=null&&(J=!0,me.level=+P.outlineLevel),J&&(K[D-1]=me)}break;case"<":se=y;break}if(se>=y)break;if(P=ct(g.slice(se,y),!0),D=P.r!=null?parseInt(P.r,10):D+1,R=-1,!(h.sheetRows&&h.sheetRows<D)){m.s.r>D-1&&(m.s.r=D-1),m.e.r<D-1&&(m.e.r=D-1),h&&h.cellStyles&&(me={},J=!1,P.ht&&(J=!0,me.hpt=parseFloat(P.ht),me.hpx=mc(me.hpt)),P.hidden=="1"&&(J=!0,me.hidden=!0),P.outlineLevel!=null&&(J=!0,me.level=+P.outlineLevel),J&&(K[D-1]=me)),b=g.slice(y).split(e);for(var U=0;U!=b.length&&b[U].trim().charAt(0)=="<";++U);for(b=b.slice(U),y=0;y!=b.length;++y)if(g=b[y].trim(),g.length!==0){if(N=g.match(r),_=y,S=0,C=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,N!=null&&N.length===2){for(_=0,T=N[1],S=0;S!=T.length&&!((C=T.charCodeAt(S)-64)<1||C>26);++S)_=26*_+C;--_,R=_}else++R;for(S=0;S!=g.length&&g.charCodeAt(S)!==62;++S);if(++S,P=ct(g.slice(0,S),!0),P.r||(P.r=st({r:D-1,c:R})),T=g.slice(S),k={t:""},(N=T.match(i))!=null&&N[1]!==""&&(k.v=wt(N[1])),h.cellFormula){if((N=T.match(s))!=null&&N[1]!==""){if(k.f=wt(Lt(N[1])).replace(/\r\n/g,`
`),h.xlfn||(k.f=Kj(k.f)),N[0].indexOf('t="array"')>-1)k.F=(T.match(a)||[])[1],k.F.indexOf(":")>-1&&le.push([St(k.F),k.F]);else if(N[0].indexOf('t="shared"')>-1){M=ct(N[0]);var W=wt(Lt(N[1]));h.xlfn||(W=Kj(W)),ue[parseInt(M.si,10)]=[M,W,P.r]}}else(N=T.match(/<f[^>]*\/>/))&&(M=ct(N[0]),ue[M.si]&&(k.f=cte(ue[M.si][1],ue[M.si][2],P.r)));var X=or(P.r);for(S=0;S<le.length;++S)X.r>=le[S][0].s.r&&X.r<=le[S][0].e.r&&X.c>=le[S][0].s.c&&X.c<=le[S][0].e.c&&(k.F=le[S][1])}if(P.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(O)k.t="z";else continue;else k.t=P.t||"n";switch(m.s.c>R&&(m.s.c=R),m.e.c<R&&(m.e.c=R),k.t){case"n":if(k.v==""||k.v==null){if(!O)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!O)continue;k.t="z"}else G=Wu[parseInt(k.v,10)],k.v=G.t,k.r=G.r,h.cellHTML&&(k.h=G.h);break;case"str":k.t="s",k.v=k.v!=null?Lt(k.v):"",h.cellHTML&&(k.h=Tb(k.v));break;case"inlineStr":N=T.match(n),k.t="s",N!=null&&(G=Hb(N[1]))?(k.v=G.t,h.cellHTML&&(k.h=G.h)):k.v="";break;case"b":k.v=Gt(k.v);break;case"d":h.cellDates?k.v=qt(k.v,1):(k.v=Dr(qt(k.v,1)),k.t="n");break;case"e":(!h||h.cellText!==!1)&&(k.w=k.v),k.v=GP[k.v];break}if(H=z=0,Q=null,ne&&P.s!==void 0&&(Q=v.CellXf[P.s],Q!=null&&(Q.numFmtId!=null&&(H=Q.numFmtId),h.cellStyles&&Q.fillId!=null&&(z=Q.fillId))),HO(k,H,z,h,x,v),h.cellDates&&ne&&k.t=="n"&&Ac(it[H])&&(k.t="d",k.v=Em(k.v)),P.cm&&h.xlmeta){var de=(h.xlmeta.Cell||[])[+P.cm-1];de&&de.type=="XLDAPR"&&(k.D=!0)}if(fe){var F=or(P.r);d[F.r]||(d[F.r]=[]),d[F.r][F.c]=k}else d[P.r]=k}}}}K.length>0&&(d["!rows"]=K)}})();function mne(e,t,r,n){var a=[],i=[],s=St(e["!ref"]),l="",f,d="",h=[],m=0,x=0,v=e["!rows"],y=Array.isArray(e),g={r:d},b,N=-1;for(x=s.s.c;x<=s.e.c;++x)h[x]=sr(x);for(m=s.s.r;m<=s.e.r;++m){for(i=[],d=yr(m),x=s.s.c;x<=s.e.c;++x){f=h[x]+d;var _=y?(e[m]||[])[x]:e[f];_!==void 0&&(l=dne(_,f,e,t))!=null&&i.push(l)}(i.length>0||v&&v[m])&&(g={r:d},v&&v[m]&&(b=v[m],b.hidden&&(g.hidden=1),N=-1,b.hpx?N=gf(b.hpx):b.hpt&&(N=b.hpt),N>-1&&(g.ht=N,g.customHeight=1),b.level&&(g.outlineLevel=b.level)),a[a.length]=Le("row",i.join(""),g))}if(v)for(;m<v.length;++m)v&&v[m]&&(g={r:m+1},b=v[m],b.hidden&&(g.hidden=1),N=-1,b.hpx?N=gf(b.hpx):b.hpt&&(N=b.hpt),N>-1&&(g.ht=N,g.customHeight=1),b.level&&(g.outlineLevel=b.level),a[a.length]=Le("row","",g));return a.join("")}function KO(e,t,r,n){var a=[wr,Le("worksheet",null,{xmlns:sl[0],"xmlns:r":Fr.r})],i=r.SheetNames[e],s=0,l="",f=r.Sheets[i];f==null&&(f={});var d=f["!ref"]||"A1",h=St(d);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),d=mt(h)}n||(n={}),f["!comments"]=[];var m=[];Qre(f,r,e,t,a),a[a.length]=Le("dimension",null,{ref:d}),a[a.length]=fne(f,t,e,r),t.sheetFormat&&(a[a.length]=Le("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=sne(f,f["!cols"])),a[s=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(l=mne(f,t),l.length>0&&(a[a.length]=l)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),f["!protect"]&&(a[a.length]=tne(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=lne(f["!autofilter"],f,r,e)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=Yre(f["!merges"]));var x=-1,v,y=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(g){g[1].Target&&(v={ref:g[0]},g[1].Target.charAt(0)!="#"&&(y=Ft(n,-1,Mt(g[1].Target).replace(/#.*$/,""),vt.HLINK),v["r:id"]="rId"+y),(x=g[1].Target.indexOf("#"))>-1&&(v.location=Mt(g[1].Target.slice(x+1))),g[1].Tooltip&&(v.tooltip=Mt(g[1].Tooltip)),a[a.length]=Le("hyperlink",null,v))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=ane(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=ln("ignoredErrors",Le("ignoredError",null,{numberStoredAsText:1,sqref:d}))),m.length>0&&(y=Ft(n,-1,"../drawings/drawing"+(e+1)+".xml",vt.DRAW),a[a.length]=Le("drawing",null,{"r:id":"rId"+y}),f["!drawing"]=m),f["!comments"].length>0&&(y=Ft(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",vt.VML),a[a.length]=Le("legacyDrawing",null,{"r:id":"rId"+y}),f["!legacy"]=y),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function pne(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function xne(e,t,r){var n=Ee(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=gf(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var l=0,f=n.l;n.l+=4;for(var d={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var m=-1,x=-1,v=h<<10;v<h+1<<10;++v){d.c=v;var y=Array.isArray(r)?(r[d.r]||[])[d.c]:r[st(d)];y&&(m<0&&(m=v),x=v)}m<0||(++l,n.write_shift(4,m),n.write_shift(4,x))}var g=n.l;return n.l=f,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function gne(e,t,r,n){var a=xne(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&je(e,0,a)}var vne=ul,yne=Oc;function bne(){}function wne(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=EY(e),r}function Sne(e,t,r){r==null&&(r=Ee(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Th({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),zP(e,r),r.slice(0,r.l)}function Nne(e){var t=$a(e);return[t]}function Ene(e,t,r){return r==null&&(r=Ee(8)),ol(t,r)}function _ne(e){var t=ll(e);return[t]}function kne(e,t,r){return r==null&&(r=Ee(4)),cl(t,r)}function jne(e){var t=$a(e),r=e.read_shift(1);return[t,r,"b"]}function Cne(e,t,r){return r==null&&(r=Ee(9)),ol(t,r),r.write_shift(1,e.v?1:0),r}function Ane(e){var t=ll(e),r=e.read_shift(1);return[t,r,"b"]}function Tne(e,t,r){return r==null&&(r=Ee(5)),cl(t,r),r.write_shift(1,e.v?1:0),r}function Pne(e){var t=$a(e),r=e.read_shift(1);return[t,r,"e"]}function One(e,t,r){return r==null&&(r=Ee(9)),ol(t,r),r.write_shift(1,e.v),r}function Fne(e){var t=ll(e),r=e.read_shift(1);return[t,r,"e"]}function Dne(e,t,r){return r==null&&(r=Ee(8)),cl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Ine(e){var t=$a(e),r=e.read_shift(4);return[t,r,"s"]}function Mne(e,t,r){return r==null&&(r=Ee(12)),ol(t,r),r.write_shift(4,t.v),r}function Rne(e){var t=ll(e),r=e.read_shift(4);return[t,r,"s"]}function Lne(e,t,r){return r==null&&(r=Ee(8)),cl(t,r),r.write_shift(4,t.v),r}function Bne(e){var t=$a(e),r=yn(e);return[t,r,"n"]}function $ne(e,t,r){return r==null&&(r=Ee(16)),ol(t,r),Yo(e.v,r),r}function GO(e){var t=ll(e),r=yn(e);return[t,r,"n"]}function Une(e,t,r){return r==null&&(r=Ee(12)),cl(t,r),Yo(e.v,r),r}function zne(e){var t=$a(e),r=Bb(e);return[t,r,"n"]}function Wne(e,t,r){return r==null&&(r=Ee(12)),ol(t,r),WP(e.v,r),r}function Hne(e){var t=ll(e),r=Bb(e);return[t,r,"n"]}function Vne(e,t,r){return r==null&&(r=Ee(8)),cl(t,r),WP(e.v,r),r}function Kne(e){var t=$a(e),r=Mb(e);return[t,r,"is"]}function Gne(e){var t=$a(e),r=wn(e);return[t,r,"str"]}function qne(e,t,r){return r==null&&(r=Ee(12+4*e.v.length)),ol(t,r),Gr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Xne(e){var t=ll(e),r=wn(e);return[t,r,"str"]}function Yne(e,t,r){return r==null&&(r=Ee(8+4*e.v.length)),cl(t,r),Gr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Jne(e,t,r){var n=e.l+t,a=$a(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=jm(e,n-e.l,r);s[3]=xn(l,null,a,r.supbooks,r)}else e.l=n;return s}function Qne(e,t,r){var n=e.l+t,a=$a(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=jm(e,n-e.l,r);s[3]=xn(l,null,a,r.supbooks,r)}else e.l=n;return s}function Zne(e,t,r){var n=e.l+t,a=$a(e);a.r=r["!row"];var i=yn(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=jm(e,n-e.l,r);s[3]=xn(l,null,a,r.supbooks,r)}else e.l=n;return s}function eae(e,t,r){var n=e.l+t,a=$a(e);a.r=r["!row"];var i=wn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=jm(e,n-e.l,r);s[3]=xn(l,null,a,r.supbooks,r)}else e.l=n;return s}var tae=ul,rae=Oc;function nae(e,t){return t==null&&(t=Ee(4)),t.write_shift(4,e),t}function aae(e,t){var r=e.l+t,n=ul(e),a=Rb(e),i=wn(e),s=wn(e),l=wn(e);e.l=r;var f={rfx:n,relId:a,loc:i,display:l};return s&&(f.Tooltip=s),f}function iae(e,t){var r=Ee(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Oc({s:or(e[0]),e:or(e[0])},r),Lb("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Gr(a||"",r),Gr(e[1].Tooltip||"",r),Gr("",r),r.slice(0,r.l)}function sae(){}function oae(e,t,r){var n=e.l+t,a=HP(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var l=Pre(e,n-e.l,r);s[1]=l}else e.l=n;return s}function lae(e,t,r){var n=e.l+t,a=ul(e),i=[a];if(r.cellFormula){var s=Fre(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function cae(e,t,r){r==null&&(r=Ee(18));var n=Cm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var qO=["left","right","top","bottom","header","footer"];function uae(e){var t={};return qO.forEach(function(r){t[r]=yn(e)}),t}function fae(e,t){return t==null&&(t=Ee(48)),Bo(e),qO.forEach(function(r){Yo(e[r],t)}),t}function dae(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function hae(e,t,r){r==null&&(r=Ee(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function mae(e){var t=Ee(24);return t.write_shift(4,4),t.write_shift(4,1),Oc(e,t),t}function pae(e,t){return t==null&&(t=Ee(66)),t.write_shift(2,e.password?Vb(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function xae(){}function gae(){}function vae(e,t,r,n,a,i,s){if(!e)return e;var l=t||{};n||(n={"!id":{}});var f=l.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,x=!1,v,y,g,b,N,_,S,C,T,k=[];l.biff=12,l["!row"]=0;var P=0,D=!1,R=[],G={},M=l.supbooks||a.supbooks||[[]];if(M.sharedf=G,M.arrayf=R,M.SheetNames=a.SheetNames||a.Sheets.map(function(fe){return fe.name}),!l.supbooks&&(l.supbooks=M,a.Names))for(var H=0;H<a.Names.length;++H)M[0][H+1]=a.Names[H];var z=[],ne=[],Q=!1;vf[16]={n:"BrtShortReal",f:GO};var le;if(ss(e,function(K,me,J){if(!x)switch(J){case 148:d=K;break;case 0:v=K,l.sheetRows&&l.sheetRows<=v.r&&(x=!0),C=yr(b=v.r),l["!row"]=v.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=mc(K.hpt)),ne[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:K[2]},K[2]){case"n":y.v=K[1];break;case"s":S=Wu[K[1]],y.v=S.t,y.r=S.r;break;case"b":y.v=!!K[1];break;case"e":y.v=K[1],l.cellText!==!1&&(y.w=os[y.v]);break;case"str":y.t="s",y.v=K[1];break;case"is":y.t="s",y.v=K[1].t;break}if((g=s.CellXf[K[0].iStyleRef])&&HO(y,g.numFmtId,null,l,i,s),N=K[0].c==-1?N+1:K[0].c,l.dense?(f[b]||(f[b]=[]),f[b][N]=y):f[sr(N)+C]=y,l.cellFormula){for(D=!1,P=0;P<R.length;++P){var O=R[P];v.r>=O[0].s.r&&v.r<=O[0].e.r&&N>=O[0].s.c&&N<=O[0].e.c&&(y.F=mt(O[0]),D=!0)}!D&&K.length>3&&(y.f=K[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>N&&(h.s.c=N),h.e.r<v.r&&(h.e.r=v.r),h.e.c<N&&(h.e.c=N),l.cellDates&&g&&y.t=="n"&&Ac(it[g.numFmtId])){var ae=Po(y.v);ae&&(y.t="d",y.v=new Date(ae.y,ae.m-1,ae.d,ae.H,ae.M,ae.S,ae.u))}le&&(le.type=="XLDAPR"&&(y.D=!0),le=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;y={t:"z",v:void 0},N=K[0].c==-1?N+1:K[0].c,l.dense?(f[b]||(f[b]=[]),f[b][N]=y):f[sr(N)+C]=y,h.s.r>v.r&&(h.s.r=v.r),h.s.c>N&&(h.s.c=N),h.e.r<v.r&&(h.e.r=v.r),h.e.c<N&&(h.e.c=N),le&&(le.type=="XLDAPR"&&(y.D=!0),le=void 0);break;case 176:k.push(K);break;case 49:le=((l.xlmeta||{}).Cell||[])[K-1];break;case 494:var ee=n["!id"][K.relId];for(ee?(K.Target=ee.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=ee):K.relId==""&&(K.Target="#"+K.loc),b=K.rfx.s.r;b<=K.rfx.e.r;++b)for(N=K.rfx.s.c;N<=K.rfx.e.c;++N)l.dense?(f[b]||(f[b]=[]),f[b][N]||(f[b][N]={t:"z",v:void 0}),f[b][N].l=K):(_=st({c:N,r:b}),f[_]||(f[_]={t:"z",v:void 0}),f[_].l=K);break;case 426:if(!l.cellFormula)break;R.push(K),T=l.dense?f[b][N]:f[sr(N)+C],T.f=xn(K[1],h,{r:v.r,c:N},M,l),T.F=mt(K[0]);break;case 427:if(!l.cellFormula)break;G[st(K[0].s)]=K[1],T=l.dense?f[b][N]:f[sr(N)+C],T.f=xn(K[1],h,{r:v.r,c:N},M,l);break;case 60:if(!l.cellStyles)break;for(;K.e>=K.s;)z[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},Q||(Q=!0,Kb(K.w/256)),Hs(z[K.e+1]);break;case 161:f["!autofilter"]={ref:mt(K)};break;case 476:f["!margins"]=K;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),K.name&&(a.Sheets[r].CodeName=K.name),(K.above||K.left)&&(f["!outline"]={above:K.above,left:K.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),K.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!me.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+J.toString(16))}}},l),delete l.supbooks,delete l["!row"],!f["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=mt(d||h)),l.sheetRows&&f["!ref"]){var ue=St(f["!ref"]);l.sheetRows<=+ue.e.r&&(ue.e.r=l.sheetRows-1,ue.e.r>h.e.r&&(ue.e.r=h.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>h.e.c&&(ue.e.c=h.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),f["!fullref"]=f["!ref"],f["!ref"]=mt(ue))}return k.length>0&&(f["!merges"]=k),z.length>0&&(f["!cols"]=z),ne.length>0&&(f["!rows"]=ne),f}function yae(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Xt(t),t.z=t.z||it[14],t.v=Dr(qt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var f={r,c:n};switch(f.s=no(a.cellXfs,t,a),t.l&&i["!links"].push([st(f),t.l]),t.c&&i["!comments"].push([st(f),t.c]),t.t){case"s":case"str":return a.bookSST?(l=Jb(a.Strings,t.v,a.revStrings),f.t="s",f.v=l,s?je(e,18,Lne(t,f)):je(e,7,Mne(t,f))):(f.t="str",s?je(e,17,Yne(t,f)):je(e,6,qne(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?je(e,13,Vne(t,f)):je(e,2,Wne(t,f)):s?je(e,16,Une(t,f)):je(e,5,$ne(t,f)),!0;case"b":return f.t="b",s?je(e,15,Tne(t,f)):je(e,4,Cne(t,f)),!0;case"e":return f.t="e",s?je(e,14,Dne(t,f)):je(e,3,One(t,f)),!0}return s?je(e,12,kne(t,f)):je(e,1,Ene(t,f)),!0}function bae(e,t,r,n){var a=St(t["!ref"]||"A1"),i,s="",l=[];je(e,145);var f=Array.isArray(t),d=a.e.r;t["!rows"]&&(d=Math.max(a.e.r,t["!rows"].length-1));for(var h=a.s.r;h<=d;++h){s=yr(h),gne(e,t,a,h);var m=!1;if(h<=a.e.r)for(var x=a.s.c;x<=a.e.c;++x){h===a.s.r&&(l[x]=sr(x)),i=l[x]+s;var v=f?(t[h]||[])[x]:t[i];if(!v){m=!1;continue}m=yae(e,v,h,x,n,t,m)}}je(e,146)}function wae(e,t){!t||!t["!merges"]||(je(e,177,nae(t["!merges"].length)),t["!merges"].forEach(function(r){je(e,176,rae(r))}),je(e,178))}function Sae(e,t){!t||!t["!cols"]||(je(e,390),t["!cols"].forEach(function(r,n){r&&je(e,60,cae(n,r))}),je(e,391))}function Nae(e,t){!t||!t["!ref"]||(je(e,648),je(e,649,mae(St(t["!ref"]))),je(e,650))}function Eae(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Ft(r,-1,n[1].Target.replace(/#.*$/,""),vt.HLINK);je(e,494,iae(n,a))}}),delete t["!links"]}function _ae(e,t,r,n){if(t["!comments"].length>0){var a=Ft(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",vt.VML);je(e,551,Lb("rId"+a)),t["!legacy"]=a}}function kae(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:mt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=Gn(i);l.s.r==l.e.r&&(l.e.r=Gn(t["!ref"]).e.r,i=mt(l));for(var f=0;f<s.length;++f){var d=s[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),je(e,161,Oc(St(i))),je(e,162)}}function jae(e,t,r){je(e,133),je(e,137,hae(t,r)),je(e,138),je(e,134)}function Cae(e,t){t["!protect"]&&je(e,535,pae(t["!protect"]))}function Aae(e,t,r,n){var a=Vn(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var f=St(s["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],je(a,129),(r.vbaraw||s["!outline"])&&je(a,147,Sne(l,s["!outline"])),je(a,148,yne(f)),jae(a,s,r.Workbook),Sae(a,s),bae(a,s,e,t),Cae(a,s),kae(a,s,r,e),wae(a,s),Eae(a,s,n),s["!margins"]&&je(a,476,fae(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Nae(a,s),_ae(a,s,e,n),je(a,130),a.end()}function Tae(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=wt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function Pae(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var l=0,f=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var x=Tae(m);h.s.r=h.s.c=0,h.e.c=l,d=sr(l),x[0].forEach(function(v,y){s[d+yr(y)]={t:"n",v,z:x[1]},f=y}),h.e.r<f&&(h.e.r=f),++l}),l>0&&(s["!ref"]=mt(h)),s}function Oae(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,l=e.match(VO);return l&&Qb(l[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Fae(e,t){e.l+=10;var r=wn(e);return{name:r}}function Dae(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ss(e,function(f,d,h){switch(h){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Zb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Iae=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Mae=[],Rae=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Jj(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Gt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Qj(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Gt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function XO(e){Qj(e.WBProps,Zb),Qj(e.CalcPr,Rae),Jj(e.WBView,Iae),Jj(e.Sheets,Mae),tc.date1904=Gt(e.WBProps.date1904)}function Lae(e){return!e.Workbook||!e.Workbook.WBProps?"false":Gt(e.Workbook.WBProps.date1904)?"true":"false"}var Bae="][*?/\\".split("");function YO(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Bae.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function $ae(e,t,r){e.forEach(function(n,a){YO(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Uae(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];$ae(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Lre(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var zae=/<\w+:workbook/;function Wae(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(Nn,function(f,d){var h=ct(f);switch(bi(h[0])){case"<?xml":break;case"<workbook":f.match(zae)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zb.forEach(function(m){if(h[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=Gt(h[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(h[m[0]],10);break;default:r.WBProps[m[0]]=h[m[0]]}}),h.codeName&&(r.WBProps.CodeName=Lt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=wt(Lt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Lt(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Gt(h.hidden||"0")&&(i.Hidden=!0),s=d+f.length;break;case"</definedName>":i.Ref=wt(Lt(e.slice(s,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return f}),sl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return XO(r),r}function JO(e){var t=[wr];t[t.length]=Le("workbook",null,{xmlns:sl[0],"xmlns:r":Fr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Zb.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Le("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Mt(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Le("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var f={name:l.Name};l.Comment&&(f.comment=l.Comment),l.Sheet!=null&&(f.localSheetId=""+l.Sheet),l.Hidden&&(f.hidden="1"),l.Ref&&(t[t.length]=Le("definedName",Mt(l.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Hae(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=a1(e),r.name=wn(e),r}function Vae(e,t){return t||(t=Ee(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Lb(e.strRelID,t),Gr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Kae(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?wn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Gae(e,t){t||(t=Ee(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),zP(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function qae(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Xae(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=_Y(e),s=Ore(e,0,r),l=Rb(e);e.l=n;var f={Name:i,Ptg:s};return a<268435455&&(f.Sheet=a),l&&(f.Comment=l),f}function Yae(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],vf[16]={n:"BrtFRTArchID$",f:qae},ss(e,function(f,d,h){switch(h){case 156:s.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(t.SID=f.Sheet),f.Ref=xn(f.Ptg,null,null,s,t),delete t.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([h,f]):s[0]=[h,f],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(f),s.XTI=s.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),XO(r),r.Names=i,r.supbooks=s,r}function Jae(e,t){je(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};je(e,156,Vae(a))}je(e,144)}function Qae(e,t){t||(t=Ee(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Gr("SheetJS",t),Gr(Nh.version,t),Gr(Nh.version,t),Gr("7262",t),t.length>t.l?t.slice(0,t.l):t}function Zae(e,t){t||(t=Ee(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function eie(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(je(e,135),je(e,158,Zae(a)),je(e,136))}}function tie(e,t){var r=Vn();return je(r,131),je(r,128,Qae()),je(r,153,Gae(e.Workbook&&e.Workbook.WBProps||null)),eie(r,e),Jae(r,e),je(r,132),r.end()}function rie(e,t,r){return t.slice(-4)===".bin"?Yae(e,r):Wae(e,r)}function nie(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?vae(e,n,r,a,i,s,l):Xre(e,n,r,a,i,s,l)}function aie(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?Dae(e,n,r,a,i):Oae(e,n,r,a,i)}function iie(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?ote():lte()}function sie(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?ite():ste()}function oie(e,t,r,n){return t.slice(-4)===".bin"?ree(e,r,n):HZ(e,r,n)}function lie(e,t,r){return PO(e,r)}function cie(e,t,r){return t.slice(-4)===".bin"?cZ(e,r):sZ(e,r)}function uie(e,t,r){return t.slice(-4)===".bin"?ete(e,r):Vee(e,r)}function fie(e,t,r){return t.slice(-4)===".bin"?zee(e):$ee(e)}function die(e,t,r,n){return r.slice(-4)===".bin"?Wee(e,t,r,n):void 0}function hie(e,t,r){return t.slice(-4)===".bin"?Ree(e,t,r):Bee(e,t,r)}function mie(e,t,r){return(t.slice(-4)===".bin"?tie:JO)(e)}function pie(e,t,r,n,a){return(t.slice(-4)===".bin"?Aae:KO)(e,r,n,a)}function xie(e,t,r){return(t.slice(-4)===".bin"?dee:AO)(e,r)}function gie(e,t,r){return(t.slice(-4)===".bin"?dZ:wO)(e,r)}function vie(e,t,r){return(t.slice(-4)===".bin"?tte:DO)(e)}function yie(e){return(e.slice(-4)===".bin"?Lee:OO)()}var QO=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ZO=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qa(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(QO),i,s,l,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(ZO),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),n[l]=i[2].slice(1,i[2].length-1));return n}function bie(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(QO),a,i,s,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(ZO),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Vu;function wie(e,t){var r=Vu[e]||wt(e);return r==="General"?qo(t):Ma(r,t)}function Sie(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Gt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=qt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[wt(t)]=a}function Nie(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||os[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cf(e.v):e.w=qo(e.v):e.w=wie(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Vu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ac(n)){var a=Po(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function Eie(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=MZ[n.Pattern]||n.Pattern)}e[t.ID]=t}function _ie(e,t,r,n,a,i,s,l,f,d){var h="General",m=n.StyleID,x={};d=d||{};var v=[],y=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&s&&(m=s.StyleID);i[m]!==void 0&&(i[m].nf&&(h=i[m].nf),i[m].Interior&&v.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Gt(e);break;case"String":n.t="s",n.r=pj(wt(e)),n.v=e.indexOf("<")>-1?wt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(qt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=wt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=GP[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=pj(t||e));break}if(Nie(n,h,d),d.cellFormula!==!1)if(n.Formula){var g=wt(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=ec(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ec("RC:RC",a):n.ArrayRange&&(n.F=ec(n.ArrayRange,a),f.push([St(n.F),n.F]))}else for(y=0;y<f.length;++y)a.r>=f[y][0].s.r&&a.r<=f[y][0].e.r&&a.c>=f[y][0].s.c&&a.c<=f[y][0].e.c&&(n.F=f[y][1]);d.cellStyles&&(v.forEach(function(b){!x.patternType&&b.patternType&&(x.patternType=b.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function kie(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function av(e,t){var r=t||{};Tc();var n=Pu(Pb(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Lt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Xt(r);return s.type="string",hc.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(lt){a.indexOf("<"+lt)>=0&&(i=!0)}),i)return fse(n,r);Vu={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,f=[],d,h={},m=[],x=r.dense?[]:{},v="",y={},g={},b=qa('<Data ss:Type="String">'),N=0,_=0,S=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},k={},P="",D=0,R=[],G={},M={},H=0,z=[],ne=[],Q={},le=[],ue,fe=!1,K=[],me=[],J={},O=0,ae=0,ee={Sheets:[],WBProps:{date1904:!1}},L={};df.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var V="";l=df.exec(n);)switch(l[3]=(V=l[3]).toLowerCase()){case"data":if(V=="data"){if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&f.push([l[3],!0]);break}if(f[f.length-1][1])break;l[1]==="/"?_ie(n.slice(N,l.index),P,b,f[f.length-1][0]=="comment"?Q:y,{c:_,r:S},T,le[_],g,K,r):(P="",b=qa(l[0]),N=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(ne.length>0&&(y.c=ne),(!r.sheetRows||r.sheetRows>S)&&y.v!==void 0&&(r.dense?(x[S]||(x[S]=[]),x[S][_]=y):x[sr(_)+yr(S)]=y),y.HRef&&(y.l={Target:wt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(O=_+(parseInt(y.MergeAcross,10)|0),ae=S+(parseInt(y.MergeDown,10)|0),R.push({s:{c:_,r:S},e:{c:O,r:ae}})),!r.sheetStubs)y.MergeAcross?_=O+1:++_;else if(y.MergeAcross||y.MergeDown){for(var se=_;se<=O;++se)for(var U=S;U<=ae;++U)(se>_||U>S)&&(r.dense?(x[U]||(x[U]=[]),x[U][se]={t:"z"}):x[sr(se)+yr(U)]={t:"z"});_=O+1}else++_;else y=bie(l[0]),y.Index&&(_=+y.Index-1),_<C.s.c&&(C.s.c=_),_>C.e.c&&(C.e.c=_),l[0].slice(-2)==="/>"&&++_,ne=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(S<C.s.r&&(C.s.r=S),S>C.e.r&&(C.e.r=S),l[0].slice(-2)==="/>"&&(g=qa(l[0]),g.Index&&(S=+g.Index-1)),_=0,++S):(g=qa(l[0]),g.Index&&(S=+g.Index-1),J={},(g.AutoFitHeight=="0"||g.Height)&&(J.hpx=parseInt(g.Height,10),J.hpt=gf(J.hpx),me[S]=J),g.Hidden=="1"&&(J.hidden=!0,me[S]=J));break;case"worksheet":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));m.push(v),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(x["!ref"]=mt(C),r.sheetRows&&r.sheetRows<=C.e.r&&(x["!fullref"]=x["!ref"],C.e.r=r.sheetRows-1,x["!ref"]=mt(C))),R.length&&(x["!merges"]=R),le.length>0&&(x["!cols"]=le),me.length>0&&(x["!rows"]=me),h[v]=x}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=_=0,f.push([l[3],!1]),d=qa(l[0]),v=wt(d.Name),x=r.dense?[]:{},R=[],K=[],me=[],L={name:v,Hidden:0},ee.Sheets.push(L);break;case"table":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;f.push([l[3],!1]),le=[],fe=!1}break;case"style":l[1]==="/"?Eie(T,k,r):k=qa(l[0]);break;case"numberformat":k.nf=wt(qa(l[0]).Format||"General"),Vu[k.nf]&&(k.nf=Vu[k.nf]);for(var W=0;W!=392&&it[W]!=k.nf;++W);if(W==392){for(W=57;W!=392;++W)if(it[W]==null){Hi(k.nf,W);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(ue=qa(l[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!fe&&ue.wpx>10){fe=!0,vn=jO;for(var X=0;X<le.length;++X)le[X]&&Hs(le[X])}fe&&Hs(ue),le[ue.Index-1||le.length]=ue;for(var de=0;de<+ue.Span;++de)le[le.length]=Xt(ue);break;case"namedrange":if(l[1]==="/")break;ee.Names||(ee.Names=[]);var F=ct(l[0]),Pe={Name:F.Name,Ref:ec(F.RefersTo.slice(1),{r:0,c:0})};ee.Sheets.length>0&&(Pe.Sheet=ee.Sheets.length-1),ee.Names.push(Pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?P+=n.slice(D,l.index):D=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=qa(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?YY(G,V,n.slice(H,l.index)):H=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else f.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));kie(Q),ne.push(Q)}else f.push([l[3],!1]),d=qa(l[0]),Q={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Ae=qa(l[0]);x["!autofilter"]={ref:ec(Ae.Range).replace(/\$/g,"")},f.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&f.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&f.push([l[3],!0]);break;case"null":break;default:if(f.length==0&&l[3]=="document"||f.length==0&&l[3]=="uof")return n4(n,r);var We=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:We=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:We=!1}break;case"excelworkbook":switch(l[3]){case"date1904":ee.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:We=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:We=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(H,l.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else H=l.index+l[0].length;break;case"header":x["!margins"]||Bo(x["!margins"]={},"xlml"),isNaN(+ct(l[0]).Margin)||(x["!margins"].header=+ct(l[0]).Margin);break;case"footer":x["!margins"]||Bo(x["!margins"]={},"xlml"),isNaN(+ct(l[0]).Margin)||(x["!margins"].footer=+ct(l[0]).Margin);break;case"pagemargins":var Ue=ct(l[0]);x["!margins"]||Bo(x["!margins"]={},"xlml"),isNaN(+Ue.Top)||(x["!margins"].top=+Ue.Top),isNaN(+Ue.Left)||(x["!margins"].left=+Ue.Left),isNaN(+Ue.Right)||(x["!margins"].right=+Ue.Right),isNaN(+Ue.Bottom)||(x["!margins"].bottom=+Ue.Bottom);break;case"displayrighttoleft":ee.Views||(ee.Views=[]),ee.Views[0]||(ee.Views[0]={}),ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:We=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:We=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:We=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:We=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:We=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:We=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:We=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:We=!1}break;case"smarttags":break;default:We=!1;break}if(We||l[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Sie(M,V,z,n.slice(H,l.index)):(z=l,H=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+f.join("|")}var Te={};return!r.bookSheets&&!r.bookProps&&(Te.Sheets=h),Te.SheetNames=m,Te.Workbook=ee,Te.SSF=Xt(it),Te.Props=G,Te.Custprops=M,Te}function f1(e,t){switch(tw(t=t||{}),t.type||"base64"){case"base64":return av(da(e),t);case"binary":case"buffer":case"file":return av(e,t);case"array":return av(to(e),t)}}function jie(e,t){var r=[];return e.Props&&r.push(JY(e.Props,t)),e.Custprops&&r.push(QY(e.Props,e.Custprops)),r.join("")}function Cie(){return""}function Aie(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Le("NumberFormat",null,{"ss:Format":Mt(it[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Le("Style",i.join(""),s))}),Le("Styles",r.join(""))}function e6(e){return Le("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Xb(e.Ref,{r:0,c:0})})}function Tie(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(e6(a)))}return Le("Names",r.join(""))}function Pie(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var l=a[s];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(e6(l)))}return i.join("")}function Oie(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Le("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Le("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Le("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Le("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(ln("ProtectContents","True")),e["!protect"].objects&&a.push(ln("ProtectObjects","True")),e["!protect"].scenarios&&a.push(ln("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(ln("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(ln("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Le("WorksheetOptions",a.join(""),{xmlns:ra.x})}function Fie(e){return e.map(function(t){var r=eY(t.t||""),n=Le("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Le("Comment",n,{"ss:Author":t.a})}).join("")}function Die(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Mt(Xb(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var f=or(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(f.r==s.r?"":"["+(f.r-s.r)+"]")+"C"+(f.c==s.c?"":"["+(f.c-s.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Mt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Mt(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],h=0;h!=d.length;++h)d[h].s.c!=s.c||d[h].s.r!=s.r||(d[h].e.c>d[h].s.c&&(l["ss:MergeAcross"]=d[h].e.c-d[h].s.c),d[h].e.r>d[h].s.r&&(l["ss:MergeDown"]=d[h].e.r-d[h].s.r));var m="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",x=String(e.v);break;case"b":m="Boolean",x=e.v?"1":"0";break;case"e":m="Error",x=os[e.v];break;case"d":m="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||it[14]);break;case"s":m="String",x=ZX(e.v||"");break}var v=no(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+v),l["ss:Index"]=s.c+1;var y=e.v!=null?x:"",g=e.t=="z"?"":'<Data ss:Type="'+m+'">'+y+"</Data>";return(e.c||[]).length>0&&(g+=Fie(e.c)),Le("Cell",g,l)}function Iie(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=mc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Mie(e,t,r,n){if(!e["!ref"])return"";var a=St(e["!ref"]),i=e["!merges"]||[],s=0,l=[];e["!cols"]&&e["!cols"].forEach(function(b,N){Hs(b);var _=!!b.width,S=Cm(N,b),C={"ss:Index":N+1};_&&(C["ss:Width"]=pf(S.width)),b.hidden&&(C["ss:Hidden"]="1"),l.push(Le("Column",null,C))});for(var f=Array.isArray(e),d=a.s.r;d<=a.e.r;++d){for(var h=[Iie(d,(e["!rows"]||[])[d])],m=a.s.c;m<=a.e.c;++m){var x=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>m)&&!(i[s].s.r>d)&&!(i[s].e.c<m)&&!(i[s].e.r<d)){(i[s].s.c!=m||i[s].s.r!=d)&&(x=!0);break}if(!x){var v={r:d,c:m},y=st(v),g=f?(e[d]||[])[m]:e[y];h.push(Die(g,y,e,t,r,n,v))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function Rie(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?Pie(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Mie(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Oie(i,t,e,r)),n.join("")}function Lie(e,t){t||(t={}),e.SSF||(e.SSF=Xt(it)),e.SSF&&(Tc(),wm(e.SSF),t.revssf=Nm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],no(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(jie(e,t)),r.push(Cie()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Le("Worksheet",Rie(n,t,e),{"ss:Name":Mt(e.SheetNames[n])}));return r[2]=Aie(e,t),r[3]=Tie(e),wr+Le("Workbook",r.join(""),{xmlns:ra.ss,"xmlns:o":ra.o,"xmlns:x":ra.x,"xmlns:ss":ra.ss,"xmlns:dt":ra.dt,"xmlns:html":ra.html})}function Bie(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=TY(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=PY(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var $ie=[60,1084,2066,2165,2175];function Uie(e,t,r,n,a){var i=n,s=[],l=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}s.push(l),r.l+=i;for(var f=$i(r,r.l),d=d1[f],h=0;d!=null&&$ie.indexOf(f)>-1;)i=$i(r,r.l+2),h=r.l+4,f==2066?h+=4:(f==2165||f==2175)&&(h+=12),l=r.slice(h,r.l+4+i),s.push(l),r.l+=4+i,d=d1[f=$i(r,r.l)];var m=Vr(s);sn(m,0);var x=0;m.lens=[];for(var v=0;v<s.length;++v)m.lens.push(x),x+=s[v].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,a)}function ci(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=it[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||os[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cf(e.v):e.w=qo(e.v):e.w=Ma(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Ac(it[n]||String(n))){var a=Po(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function k0(e,t,r){return{v:e,ixfe:t,t:r}}function zie(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},l=null,f=[],d="",h={},m,x="",v,y,g,b,N={},_=[],S,C,T=[],k=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},R=function(ut){return ut<8?Mo[ut]:ut<64&&k[ut-8]||Mo[ut]},G=function(ut,At,oe){var ke=At.XF.data;if(!(!ke||!ke.patternType||!oe||!oe.cellStyles)){At.s={},At.s.patternType=ke.patternType;var Ke;(Ke=mf(R(ke.icvFore)))&&(At.s.fgColor={rgb:Ke}),(Ke=mf(R(ke.icvBack)))&&(At.s.bgColor={rgb:Ke})}},M=function(ut,At,oe){if(!(J>1)&&!(oe.sheetRows&&ut.r>=oe.sheetRows)){if(oe.cellStyles&&At.XF&&At.XF.data&&G(ut,At,oe),delete At.ixfe,delete At.XF,m=ut,x=st(ut),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<s.s.r&&(s.s.r=ut.r),ut.c<s.s.c&&(s.s.c=ut.c),ut.r+1>s.e.r&&(s.e.r=ut.r+1),ut.c+1>s.e.c&&(s.e.c=ut.c+1),oe.cellFormula&&At.f){for(var ke=0;ke<_.length;++ke)if(!(_[ke][0].s.c>ut.c||_[ke][0].s.r>ut.r)&&!(_[ke][0].e.c<ut.c||_[ke][0].e.r<ut.r)){At.F=mt(_[ke][0]),(_[ke][0].s.c!=ut.c||_[ke][0].s.r!=ut.r)&&delete At.f,At.f&&(At.f=""+xn(_[ke][1],s,ut,K,H));break}}oe.dense?(a[ut.r]||(a[ut.r]=[]),a[ut.r][ut.c]=At):a[x]=At}},H={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(H.password=t.password);var z,ne=[],Q=[],le=[],ue=[],fe=!1,K=[];K.SheetNames=H.snames,K.sharedf=H.sharedf,K.arrayf=H.arrayf,K.names=[],K.XTI=[];var me=0,J=0,O=0,ae=[],ee=[],L;H.codepage=1200,Ja(1200);for(var V=!1;e.l<e.length-1;){var se=e.l,U=e.read_shift(2);if(U===0&&me===10)break;var W=e.l===e.length?0:e.read_shift(2),X=d1[U];if(X&&X.f){if(t.bookSheets&&me===133&&U!==133)break;if(me=U,X.r===2||X.r==12){var de=e.read_shift(2);if(W-=2,!H.enc&&de!==U&&((de&255)<<8|de>>8)!==U)throw new Error("rt mismatch: "+de+"!="+U);X.r==12&&(e.l+=10,W-=10)}var F={};if(U===10?F=X.f(e,W,H):F=Uie(U,X,e,W,H),J==0&&[9,521,1033,2057].indexOf(me)===-1)continue;switch(U){case 34:r.opts.Date1904=P.WBProps.date1904=F;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(H.enc||(e.l=0),H.enc=F,!t.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:H.lastuser=F;break;case 66:var Pe=Number(F);switch(Pe){case 21010:Pe=1200;break;case 32768:Pe=1e4;break;case 32769:Pe=1252;break}Ja(H.codepage=Pe),V=!0;break;case 317:H.rrtabid=F;break;case 25:H.winlocked=F;break;case 439:r.opts.RefreshAll=F;break;case 12:r.opts.CalcCount=F;break;case 16:r.opts.CalcDelta=F;break;case 17:r.opts.CalcIter=F;break;case 13:r.opts.CalcMode=F;break;case 14:r.opts.CalcPrecision=F;break;case 95:r.opts.CalcSaveRecalc=F;break;case 15:H.CalcRefMode=F;break;case 2211:r.opts.FullCalc=F;break;case 129:F.fDialog&&(a["!type"]="dialog"),F.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),F.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:T.push(F);break;case 430:K.push([F]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(F);break;case 24:case 536:L={Name:F.Name,Ref:xn(F.rgce,s,null,K,H)},F.itab>0&&(L.Sheet=F.itab-1),K.names.push(L),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(ee[F.itab-1]={ref:mt(F.rgce[0][0][1][2])});break;case 22:H.ExternCount=F;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(F),K.XTI=K.XTI.concat(F);break;case 2196:if(H.biff<8)break;L!=null&&(L.Comment=F[1]);break;case 18:a["!protect"]=F;break;case 19:F!==0&&H.WTF&&console.error("Password verifier: "+F);break;case 133:i[F.pos]=F,H.snames.push(F.name);break;case 10:{if(--J)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=mt(s),t.sheetRows&&t.sheetRows<=s.e.r){var Ae=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=mt(s),s.e.r=Ae}s.e.r++,s.e.c++}ne.length>0&&(a["!merges"]=ne),Q.length>0&&(a["!objects"]=Q),le.length>0&&(a["!cols"]=le),ue.length>0&&(a["!rows"]=ue),P.Sheets.push(D)}d===""?h=a:n[d]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(H.biff===8&&(H.biff={9:2,521:3,1033:4}[U]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),H.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(H.biff=5,V=!0,Ja(H.codepage=28591)),H.biff==8&&F.BIFFVer==0&&F.dt==16&&(H.biff=2),J++)break;if(a=t.dense?[]:{},H.biff<8&&!V&&(V=!0,Ja(H.codepage=t.codepage||1252)),H.biff<5||F.BIFFVer==0&&F.dt==4096){d===""&&(d="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var We={pos:e.l-W,name:d};i[We.pos]=We,H.snames.push(d)}else d=(i[se]||{name:""}).name;F.dt==32&&(a["!type"]="chart"),F.dt==64&&(a["!type"]="macro"),ne=[],Q=[],H.arrayf=_=[],le=[],ue=[],fe=!1,D={Hidden:(i[se]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[F.r]||[])[F.c]:a[st({c:F.c,r:F.r})])&&++F.c,S={ixfe:F.ixfe,XF:T[F.ixfe]||{},v:F.val,t:"n"},O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 5:case 517:S={ixfe:F.ixfe,XF:T[F.ixfe],v:F.val,t:F.t},O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 638:S={ixfe:F.ixfe,XF:T[F.ixfe],v:F.rknum,t:"n"},O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 189:for(var Ue=F.c;Ue<=F.C;++Ue){var Te=F.rkrec[Ue-F.c][0];S={ixfe:Te,XF:T[Te],v:F.rkrec[Ue-F.c][1],t:"n"},O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M({c:Ue,r:F.r},S,t)}break;case 6:case 518:case 1030:{if(F.val=="String"){l=F;break}if(S=k0(F.val,F.cell.ixfe,F.tt),S.XF=T[S.ixfe],t.cellFormula){var lt=F.formula;if(lt&&lt[0]&&lt[0][0]&&lt[0][0][0]=="PtgExp"){var jt=lt[0][0][1][0],Yt=lt[0][0][1][1],Ct=st({r:jt,c:Yt});N[Ct]?S.f=""+xn(F.formula,s,F.cell,K,H):S.F=((t.dense?(a[jt]||[])[Yt]:a[Ct])||{}).F}else S.f=""+xn(F.formula,s,F.cell,K,H)}O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M(F.cell,S,t),l=F}break;case 7:case 519:if(l)l.val=F,S=k0(F,l.cell.ixfe,"s"),S.XF=T[S.ixfe],t.cellFormula&&(S.f=""+xn(l.formula,s,l.cell,K,H)),O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M(l.cell,S,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(F);var Ua=st(F[0].s);if(v=t.dense?(a[F[0].s.r]||[])[F[0].s.c]:a[Ua],t.cellFormula&&v){if(!l||!Ua||!v)break;v.f=""+xn(F[1],s,F[0],K,H),v.F=mt(F[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!l)break;N[st(l.cell)]=F[0],v=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[st(l.cell)],(v||{}).f=""+xn(F[0],s,m,K,H)}}break;case 253:S=k0(f[F.isst].t,F.ixfe,"s"),f[F.isst].h&&(S.h=f[F.isst].h),S.XF=T[S.ixfe],O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:F.ixfe,XF:T[F.ixfe],t:"z"},O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t));break;case 190:if(t.sheetStubs)for(var On=F.c;On<=F.C;++On){var Lr=F.ixfe[On-F.c];S={ixfe:Lr,XF:T[Lr],t:"z"},O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M({c:On,r:F.r},S,t)}break;case 214:case 516:case 4:S=k0(F.val,F.ixfe,"s"),S.XF=T[S.ixfe],O>0&&(S.z=ae[S.ixfe>>8&63]),ci(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 0:case 512:J===1&&(s=F);break;case 252:f=F;break;case 1054:if(H.biff==4){ae[O++]=F[1];for(var rr=0;rr<O+163&&it[rr]!=F[1];++rr);rr>=163&&Hi(F[1],O+163)}else Hi(F[1],F[0]);break;case 30:{ae[O++]=F;for(var Fn=0;Fn<O+163&&it[Fn]!=F;++Fn);Fn>=163&&Hi(F,O+163)}break;case 229:ne=ne.concat(F);break;case 93:Q[F.cmo[0]]=H.lastobj=F;break;case 438:H.lastobj.TxO=F;break;case 127:H.lastobj.ImData=F;break;case 440:for(b=F[0].s.r;b<=F[0].e.r;++b)for(g=F[0].s.c;g<=F[0].e.c;++g)v=t.dense?(a[b]||[])[g]:a[st({c:g,r:b})],v&&(v.l=F[1]);break;case 2048:for(b=F[0].s.r;b<=F[0].e.r;++b)for(g=F[0].s.c;g<=F[0].e.c;++g)v=t.dense?(a[b]||[])[g]:a[st({c:g,r:b})],v&&v.l&&(v.l.Tooltip=F[1]);break;case 28:{if(H.biff<=5&&H.biff>=2)break;v=t.dense?(a[F[0].r]||[])[F[0].c]:a[st(F[0])];var Qr=Q[F[2]];v||(t.dense?(a[F[0].r]||(a[F[0].r]=[]),v=a[F[0].r][F[0].c]={t:"z"}):v=a[st(F[0])]={t:"z"},s.e.r=Math.max(s.e.r,F[0].r),s.s.r=Math.min(s.s.r,F[0].r),s.e.c=Math.max(s.e.c,F[0].c),s.s.c=Math.min(s.s.c,F[0].c)),v.c||(v.c=[]),y={a:F[1],t:Qr.TxO.t},v.c.push(y)}break;case 2173:Aee(T[F.ixfe],F.ext);break;case 125:{if(!H.cellStyles)break;for(;F.e>=F.s;)le[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},fe||(fe=!0,Kb(F.w/256)),Hs(le[F.e+1])}break;case 520:{var nr={};F.level!=null&&(ue[F.r]=nr,nr.level=F.level),F.hidden&&(ue[F.r]=nr,nr.hidden=!0),F.hpt&&(ue[F.r]=nr,nr.hpt=F.hpt,nr.hpx=mc(F.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Bo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[U]]=F;break;case 161:a["!margins"]||Bo(a["!margins"]={}),a["!margins"].header=F.header,a["!margins"].footer=F.footer;break;case 574:F.RTL&&(P.Views[0].RTL=!0);break;case 146:k=F;break;case 2198:z=F;break;case 140:C=F;break;case 442:d?D.CodeName=F||D.name:P.WBProps.CodeName=F||"ThisWorkbook";break}}else X||console.error("Missing Info for XLS Record 0x"+U.toString(16)),e.l+=W}return r.SheetNames=dr(i).sort(function(En,ut){return Number(En)-Number(ut)}).map(function(En){return i[En].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&ee.forEach(function(En,ut){r.Sheets[r.SheetNames[ut]]["!autofilter"]=En}),r.Strings=f,r.SSF=Xt(it),H.enc&&(r.Encryption=H.enc),z&&(r.Themes=z),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),K.names.length>0&&(P.Names=K.names),r.Workbook=P,r}var Ku={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Wie(e,t,r){var n=tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Fj(n,i1,Ku.DSI);for(var i in a)t[i]=a[i]}catch(d){if(r.WTF)throw d}var s=tt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var l=Fj(s,s1,Ku.SI);for(var f in l)t[f]==null&&(t[f]=l[f])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(ZP(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Hie(e,t){var r=[],n=[],a=[],i=0,s,l=cj(i1,"n"),f=cj(s1,"n");if(e.Props)for(s=dr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(f,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=dr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(f,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var d=[];for(i=0;i<a.length;++i)sO.indexOf(a[i][0])>-1||QP.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&tt.utils.cfb_add(t,"/SummaryInformation",Dj(n,Ku.SI,f,s1)),(r.length||d.length)&&tt.utils.cfb_add(t,"/DocumentSummaryInformation",Dj(r,Ku.DSI,l,i1,d.length?d:null,Ku.UDI))}function t6(e,t){t||(t={}),tw(t),Sb(),t.codepage&&wb(t.codepage);var r,n;if(e.FullPaths){if(tt.find(e,"/encryption"))throw new Error("File is password-protected");r=tt.find(e,"!CompObj"),n=tt.find(e,"/Workbook")||tt.find(e,"/Book")}else{switch(t.type){case"base64":e=ia(da(e));break;case"binary":e=ia(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}sn(e,0),n={content:e}}var a,i;if(r&&Bie(r),t.bookProps&&!t.bookSheets)a={};else{var s=xt?"buffer":"array";if(n&&n.content)a=zie(n.content,t);else if((i=tt.find(e,"PerfectOffice_MAIN"))&&i.content)a=Lo.to_workbook(i.content,(t.type=s,t));else if((i=tt.find(e,"NativeContent_MAIN"))&&i.content)a=Lo.to_workbook(i.content,(t.type=s,t));else throw(i=tt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=nte(e))}var l={};return e.FullPaths&&Wie(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}function Vie(e,t){var r=t||{},n=tt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,a,r6(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Hie(e,n),r.biff==8&&e.vbaraw&&ate(n,tt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var vf={0:{f:pne},1:{f:Nne},2:{f:zne},3:{f:Pne},4:{f:jne},5:{f:Bne},6:{f:Gne},7:{f:Ine},8:{f:eae},9:{f:Zne},10:{f:Jne},11:{f:Qne},12:{f:_ne},13:{f:Hne},14:{f:Fne},15:{f:Ane},16:{f:GO},17:{f:Xne},18:{f:Rne},19:{f:Mb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Xae},40:{},42:{},43:{f:GZ},44:{f:VZ},45:{f:YZ},46:{f:QZ},47:{f:JZ},48:{},49:{f:vY},50:{},51:{f:Oee},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gO},62:{f:Kne},63:{f:Uee},64:{f:xae},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Sn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:dae},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:wne},148:{f:vne,p:16},151:{f:sae},152:{},153:{f:Kae},154:{},155:{},156:{f:Hae},157:{},158:{},159:{T:1,f:lZ},160:{T:-1},161:{T:1,f:ul},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:tae},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Tee},336:{T:-1},337:{f:Iee,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:a1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:xO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:oae},427:{f:lae},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:uae},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:bne},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:aae},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:a1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Qee},633:{T:1},634:{T:-1},635:{T:1,f:Yee},636:{T:-1},637:{f:SY},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Fae},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:gae},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},d1={6:{f:rv},10:{f:As},12:{f:kr},13:{f:kr},14:{f:gr},15:{f:gr},16:{f:yn},17:{f:gr},18:{f:gr},19:{f:kr},20:{f:$j},21:{f:$j},23:{f:xO},24:{f:zj},25:{f:gr},26:{},27:{},28:{f:gQ},29:{},34:{f:gr},35:{f:Uj},38:{f:yn},39:{f:yn},40:{f:yn},41:{f:yn},42:{f:gr},43:{f:gr},47:{f:AZ},49:{f:HJ},51:{f:kr},60:{},61:{f:BJ},64:{f:gr},65:{f:WJ},66:{f:kr},77:{},80:{},81:{},82:{},85:{f:kr},89:{},90:{},91:{},92:{f:CJ},93:{f:bQ},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:gO},128:{f:iQ},129:{f:TJ},130:{f:kr},131:{f:gr},132:{f:gr},133:{f:PJ},134:{},140:{f:CQ},141:{f:kr},144:{},146:{f:PQ},151:{},152:{},153:{},154:{},155:{},156:{f:kr},157:{},158:{},160:{f:LQ},161:{f:DQ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:tQ},190:{f:rQ},193:{f:As},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:kr},220:{},221:{f:gr},222:{},224:{f:aQ},225:{f:jJ},226:{f:As},227:{},229:{f:vQ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:FJ},253:{f:KJ},255:{f:IJ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:oO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:As},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:uQ},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:NQ},439:{f:gr},440:{f:EQ},441:{},442:{f:Hf},443:{},444:{f:kr},445:{},446:{},448:{f:As},449:{f:LJ,r:2},450:{f:As},512:{f:Rj},513:{f:RQ},515:{f:lQ},516:{f:qJ},517:{f:Bj},519:{f:BQ},520:{f:MJ},523:{},545:{f:Wj},549:{f:Mj},566:{},574:{f:UJ},638:{f:eQ},659:{},1048:{},1054:{f:YJ},1084:{},1212:{f:mQ},2048:{f:kQ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:N0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:As},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:OQ,r:12},2173:{f:Cee,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:hQ,r:12},2197:{},2198:{f:See,r:12},2199:{},2200:{},2201:{},2202:{f:pQ,r:12},2203:{f:As},2204:{},2205:{},2206:{},2207:{},2211:{f:RJ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:kr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:IQ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:TQ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Rj},1:{},2:{f:HQ},3:{f:zQ},4:{f:UQ},5:{f:Bj},7:{f:KQ},8:{},9:{f:N0},11:{},22:{f:kr},30:{f:QJ},31:{},32:{},33:{f:Wj},36:{},37:{f:Mj},50:{f:GQ},62:{},52:{},67:{},68:{f:kr},69:{},86:{},126:{},127:{f:$Q},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:qQ},223:{},234:{},354:{},421:{},518:{f:rv},521:{f:N0},536:{f:zj},547:{f:Uj},561:{},579:{},1030:{f:rv},1033:{f:N0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Be(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Fb(r)&&e.push(r)}}function Kie(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Be(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],l=0,f=0,d=0;d+(s[l]||8224)<=8224;)d+=s[l]||8224,l++;var h=e.next(4);for(h.write_shift(2,i),h.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d;f<a;){for(h=e.next(4),h.write_shift(2,60),d=0;d+(s[l]||8224)<=8224;)d+=s[l]||8224,l++;h.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d}}}function qf(e,t,r){return e||(e=Ee(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Gie(e,t,r,n){var a=Ee(9);return qf(a,e,t),lO(r,n||"b",a),a}function qie(e,t,r){var n=Ee(8+2*r.length);return qf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Xie(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Dr(qt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Be(e,2,VQ(r,n,a)):Be(e,3,WQ(r,n,a));return;case"b":case"e":Be(e,5,Gie(r,n,t.v,t.t));return;case"s":case"str":Be(e,4,qie(r,n,(t.v||"").slice(0,255)));return}Be(e,1,qf(null,r,n))}function Yie(e,t,r,n){var a=Array.isArray(t),i=St(t["!ref"]||"A1"),s,l="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=mt(i)}for(var d=i.s.r;d<=i.e.r;++d){l=yr(d);for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(f[h]=sr(h)),s=f[h]+l;var m=a?(t[d]||[])[h]:t[s];m&&Xie(e,m,d,h)}}}function Jie(e,t){for(var r=t||{},n=Vn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Be(n,r.biff==4?1033:r.biff==3?521:9,Wb(e,16,r)),Yie(n,e.Sheets[e.SheetNames[a]],a,r),Be(n,10),n.end()}function Qie(e,t,r){Be(e,49,VJ({sz:12,name:"Arial"},r))}function Zie(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Be(e,1054,JJ(a,t[a],r))})}function ese(e,t){var r=Ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Be(e,2151,r),r=Ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),hO(St(t["!ref"]||"A1"),r),r.write_shift(4,4),Be(e,2152,r)}function tse(e,t){for(var r=0;r<16;++r)Be(e,224,Lj({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Be(e,224,Lj(n,0,t))})}function rse(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Be(e,440,_Q(n)),n[1].Tooltip&&Be(e,2048,jQ(n))}delete t["!links"]}function nse(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Be(e,125,FQ(Cm(a,n),a))})}}function ase(e,t,r,n,a){var i=16+no(a.cellXfs,t,a);if(t.v==null&&!t.bf){Be(e,513,Qo(r,n,i));return}if(t.bf)Be(e,6,Tre(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Dr(qt(t.v)):t.v;Be(e,515,cQ(r,n,s,i));break;case"b":case"e":Be(e,517,oQ(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var l=Jb(a.Strings,t.v,a.revStrings);Be(e,253,GJ(r,n,l,i))}else Be(e,516,XJ(r,n,(t.v||"").slice(0,255),i,a));break;default:Be(e,513,Qo(r,n,i))}}function ise(e,t,r){var n=Vn(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},l=(s.Sheets||[])[e]||{},f=Array.isArray(i),d=t.biff==8,h,m="",x=[],v=St(i["!ref"]||"A1"),y=d?65536:16384;if(v.e.c>255||v.e.r>=y){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,y-1)}Be(n,2057,Wb(r,16,t)),Be(n,13,Aa(1)),Be(n,12,Aa(100)),Be(n,15,Cn(!0)),Be(n,17,Cn(!1)),Be(n,16,Yo(.001)),Be(n,95,Cn(!0)),Be(n,42,Cn(!1)),Be(n,43,Cn(!1)),Be(n,130,Aa(1)),Be(n,128,sQ()),Be(n,131,Cn(!1)),Be(n,132,Cn(!1)),d&&nse(n,i["!cols"]),Be(n,512,ZJ(v,t)),d&&(i["!links"]=[]);for(var g=v.s.r;g<=v.e.r;++g){m=yr(g);for(var b=v.s.c;b<=v.e.c;++b){g===v.s.r&&(x[b]=sr(b)),h=x[b]+m;var N=f?(i[g]||[])[b]:i[h];N&&(ase(n,N,g,b,t),d&&N.l&&i["!links"].push([h,N.l]))}}var _=l.CodeName||l.name||a;return d&&Be(n,574,zJ((s.Views||[])[0])),d&&(i["!merges"]||[]).length&&Be(n,229,yQ(i["!merges"])),d&&rse(n,i),Be(n,442,cO(_)),d&&ese(n,i),Be(n,10),n.end()}function sse(e,t,r){var n=Vn(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},l=r.biff==8,f=r.biff==5;if(Be(n,2057,Wb(e,5,r)),r.bookType=="xla"&&Be(n,135),Be(n,225,l?Aa(1200):null),Be(n,193,oJ(2)),f&&Be(n,191),f&&Be(n,192),Be(n,226),Be(n,92,AJ("SheetJS",r)),Be(n,66,Aa(l?1200:1252)),l&&Be(n,353,Aa(0)),l&&Be(n,448),Be(n,317,MQ(e.SheetNames.length)),l&&e.vbaraw&&Be(n,211),l&&e.vbaraw){var d=s.CodeName||"ThisWorkbook";Be(n,442,cO(d))}Be(n,156,Aa(17)),Be(n,25,Cn(!1)),Be(n,18,Cn(!1)),Be(n,19,Aa(0)),l&&Be(n,431,Cn(!1)),l&&Be(n,444,Aa(0)),Be(n,61,$J()),Be(n,64,Cn(!1)),Be(n,141,Aa(0)),Be(n,34,Cn(Lae(e)=="true")),Be(n,14,Cn(!0)),l&&Be(n,439,Cn(!1)),Be(n,218,Aa(0)),Qie(n,e,r),Zie(n,e.SSF,r),tse(n,r),l&&Be(n,352,Cn(!1));var h=n.end(),m=Vn();l&&Be(m,140,AQ()),l&&r.Strings&&Kie(m,252,DJ(r.Strings)),Be(m,10);var x=m.end(),v=Vn(),y=0,g=0;for(g=0;g<e.SheetNames.length;++g)y+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var b=h.length+y+x.length;for(g=0;g<e.SheetNames.length;++g){var N=i[g]||{};Be(v,133,OJ({pos:b,hs:N.Hidden||0,dt:0,name:e.SheetNames[g]},r)),b+=t[g].length}var _=v.end();if(y!=_.length)throw new Error("BS8 "+y+" != "+_.length);var S=[];return h.length&&S.push(h),_.length&&S.push(_),x.length&&S.push(x),Vr(S)}function ose(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Xt(it)),e&&e.SSF&&(Tc(),wm(e.SSF),r.revssf=Nm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,rw(r),r.cellXfs=[],no(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=ise(a,r,e);return n.unshift(sse(e,n,r)),Vr(n)}function r6(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Gn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return ose(e,t);case 4:case 3:case 2:return Jie(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Zj(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,l=i&&i.index||e.length,f=VX(e.slice(s,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,m=0,x=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(s=0;s<f.length;++s){var g=f[s].trim(),b=g.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}h=0;continue}if(!(b!="<td"&&b!="<th")){var N=g.split(/<\/t[dh]>/i);for(l=0;l<N.length;++l){var _=N[l].trim();if(_.match(/<t[dh]/i)){for(var S=_,C=0;S.charAt(0)=="<"&&(C=S.indexOf(">"))>-1;)S=S.slice(C+1);for(var T=0;T<y.length;++T){var k=y[T];k.s.c==h&&k.s.r<d&&d<=k.e.r&&(h=k.e.c+1,T=-1)}var P=ct(_.slice(0,_.indexOf(">")));x=P.colspan?+P.colspan:1,((m=+P.rowspan)>1||x>1)&&y.push({s:{r:d,c:h},e:{r:d+(m||1)-1,c:h+x-1}});var D=P.t||P["data-t"]||"";if(!S.length){h+=x;continue}if(S=kP(S),v.s.r>d&&(v.s.r=d),v.e.r<d&&(v.e.r=d),v.s.c>h&&(v.s.c=h),v.e.c<h&&(v.e.c=h),!S.length){h+=x;continue}var R={t:"s",v:S};r.raw||!S.trim().length||D=="s"||(S==="TRUE"?R={t:"b",v:!0}:S==="FALSE"?R={t:"b",v:!1}:isNaN(Za(S))?isNaN(dc(S).getDate())||(R={t:"d",v:qt(S)},r.cellDates||(R={t:"n",v:Dr(R.v)}),R.z=r.dateNF||it[14]):R={t:"n",v:Za(S)}),r.dense?(n[d]||(n[d]=[]),n[d][h]=R):n[st({r:d,c:h})]=R,h+=x}}}}return n["!ref"]=mt(v),y.length&&(n["!merges"]=y),n}function lse(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var l=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>s)&&!(a[d].e.r<r||a[d].e.c<s)){if(a[d].s.r<r||a[d].s.c<s){l=-1;break}l=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(l<0)){var h=st({r,c:s}),m=n.dense?(e[r]||[])[s]:e[h],x=m&&m.v!=null&&(m.h||Tb(m.w||(Zi(m),m.w)||""))||"",v={};l>1&&(v.rowspan=l),f>1&&(v.colspan=f),n.editable?x='<span contenteditable="true">'+x+"</span>":m&&(v["data-t"]=m&&m.t||"z",m.v!=null&&(v["data-v"]=m.v),m.z!=null&&(v["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+m.l.Target+'">'+x+"</a>")),v.id=(n.id||"sjs")+"-"+h,i.push(Le("td",x,v))}}var y="<tr>";return y+i.join("")+"</tr>"}var cse='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',use="</body></html>";function fse(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ro(Zj(r[0],t),t);var n=iw();return r.forEach(function(a,i){sw(n,Zj(a,t),"Sheet"+(i+1))}),n}function dse(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function n6(e,t){var r=t||{},n=r.header!=null?r.header:cse,a=r.footer!=null?r.footer:use,i=[n],s=Gn(e["!ref"]);r.dense=Array.isArray(e),i.push(dse(e,s,r));for(var l=s.s.r;l<=s.e.r;++l)i.push(lse(e,s,l,r));return i.push("</table>"+a),i.join("")}function a6(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?or(n.origin):n.origin;a=s.r,i=s.c}var l=t.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var h=Gn(e["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),a==-1&&(d.e.r=a=h.e.r+1)}var m=[],x=0,v=e["!rows"]||(e["!rows"]=[]),y=0,g=0,b=0,N=0,_=0,S=0;for(e["!cols"]||(e["!cols"]=[]);y<l.length&&g<f;++y){var C=l[y];if(e4(C)){if(n.display)continue;v[g]={hidden:!0}}var T=C.children;for(b=N=0;b<T.length;++b){var k=T[b];if(!(n.display&&e4(k))){var P=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):kP(k.innerHTML),D=k.getAttribute("data-z")||k.getAttribute("z");for(x=0;x<m.length;++x){var R=m[x];R.s.c==N+i&&R.s.r<g+a&&g+a<=R.e.r&&(N=R.e.c+1-i,x=-1)}S=+k.getAttribute("colspan")||1,((_=+k.getAttribute("rowspan")||1)>1||S>1)&&m.push({s:{r:g+a,c:N+i},e:{r:g+a+(_||1)-1,c:N+i+(S||1)-1}});var G={t:"s",v:P},M=k.getAttribute("data-t")||k.getAttribute("t")||"";P!=null&&(P.length==0?G.t=M||"z":n.raw||P.trim().length==0||M=="s"||(P==="TRUE"?G={t:"b",v:!0}:P==="FALSE"?G={t:"b",v:!1}:isNaN(Za(P))?isNaN(dc(P).getDate())||(G={t:"d",v:qt(P)},n.cellDates||(G={t:"n",v:Dr(G.v)}),G.z=n.dateNF||it[14]):G={t:"n",v:Za(P)})),G.z===void 0&&D!=null&&(G.z=D);var H="",z=k.getElementsByTagName("A");if(z&&z.length)for(var ne=0;ne<z.length&&!(z[ne].hasAttribute("href")&&(H=z[ne].getAttribute("href"),H.charAt(0)!="#"));++ne);H&&H.charAt(0)!="#"&&(G.l={Target:H}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][N+i]=G):e[st({c:N+i,r:g+a})]=G,d.e.c<N+i&&(d.e.c=N+i),N+=S}}++g}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,g-1+a),e["!ref"]=mt(d),g>=f&&(e["!fullref"]=mt((d.e.r=l.length-y+g-1+a,d))),e}function i6(e,t){var r=t||{},n=r.dense?[]:{};return a6(n,e,t)}function hse(e,t){return ro(i6(e,t),t)}function e4(e){var t="",r=mse(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function mse(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function pse(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=wt(t.replace(/<[^>]*>/g,""));return[r]}var t4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function s6(e,t){var r=t||{},n=Pb(e),a=[],i,s,l={name:""},f="",d=0,h,m,x={},v=[],y=r.dense?[]:{},g,b,N={value:""},_="",S=0,C=[],T=-1,k=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,R={},G=[],M={},H=0,z=0,ne=[],Q=1,le=1,ue=[],fe={Names:[]},K={},me=["",""],J=[],O={},ae="",ee=0,L=!1,V=!1,se=0;for(df.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=df.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"工作表":g[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?y["!ref"]=mt(P):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(y["!fullref"]=y["!ref"],P.e.r=r.sheetRows-1,y["!ref"]=mt(P)),G.length&&(y["!merges"]=G),ne.length&&(y["!rows"]=ne),h.name=h.名称||h.name,typeof JSON<"u"&&JSON.stringify(h),v.push(h.name),x[h.name]=y,V=!1):g[0].charAt(g[0].length-2)!=="/"&&(h=ct(g[0],!1),T=k=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,y=r.dense?[]:{},G=[],ne=[],V=!0);break;case"table-row-group":g[1]==="/"?--D:++D;break;case"table-row":case"行":if(g[1]==="/"){T+=Q,Q=1;break}if(m=ct(g[0],!1),m.行号?T=m.行号-1:T==-1&&(T=0),Q=+m["number-rows-repeated"]||1,Q<10)for(se=0;se<Q;++se)D>0&&(ne[T+se]={level:D});k=-1;break;case"covered-table-cell":g[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(y[T]||(y[T]=[]),y[T][k]={t:"z"}):y[st({r:T,c:k})]={t:"z"}),_="",C=[];break;case"table-cell":case"数据":if(g[0].charAt(g[0].length-2)==="/")++k,N=ct(g[0],!1),le=parseInt(N["number-columns-repeated"]||"1",10),b={t:"z",v:null},N.formula&&r.cellFormula!=!1&&(b.f=Yj(wt(N.formula))),(N.数据类型||N["value-type"])=="string"&&(b.t="s",b.v=wt(N["string-value"]||""),r.dense?(y[T]||(y[T]=[]),y[T][k]=b):y[st({r:T,c:k})]=b),k+=le-1;else if(g[1]!=="/"){++k,_="",S=0,C=[],le=1;var U=Q?T+Q-1:T;if(k>P.e.c&&(P.e.c=k),k<P.s.c&&(P.s.c=k),T<P.s.r&&(P.s.r=T),U>P.e.r&&(P.e.r=U),N=ct(g[0],!1),J=[],O={},b={t:N.数据类型||N["value-type"],v:null},r.cellFormula)if(N.formula&&(N.formula=wt(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(H=parseInt(N["number-matrix-rows-spanned"],10)||0,z=parseInt(N["number-matrix-columns-spanned"],10)||0,M={s:{r:T,c:k},e:{r:T+H-1,c:k+z-1}},b.F=mt(M),ue.push([M,b.F])),N.formula)b.f=Yj(N.formula);else for(se=0;se<ue.length;++se)T>=ue[se][0].s.r&&T<=ue[se][0].e.r&&k>=ue[se][0].s.c&&k<=ue[se][0].e.c&&(b.F=ue[se][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(H=parseInt(N["number-rows-spanned"],10)||0,z=parseInt(N["number-columns-spanned"],10)||0,M={s:{r:T,c:k},e:{r:T+H-1,c:k+z-1}},G.push(M)),N["number-columns-repeated"]&&(le=parseInt(N["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=Gt(N["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(N.value);break;case"percentage":b.t="n",b.v=parseFloat(N.value);break;case"currency":b.t="n",b.v=parseFloat(N.value);break;case"date":b.t="d",b.v=qt(N["date-value"]),r.cellDates||(b.t="n",b.v=Dr(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=zX(N["time-value"])/86400,r.cellDates&&(b.t="d",b.v=Em(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(N.数据数值);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",N["string-value"]!=null&&(_=wt(N["string-value"]),C=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(L=!1,b.t==="s"&&(b.v=_||"",C.length&&(b.R=C),L=S==0),K.Target&&(b.l=K),J.length>0&&(b.c=J,J=[]),_&&r.cellText!==!1&&(b.w=_),L&&(b.t="z",delete b.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var W=0;W<Q;++W){if(le=parseInt(N["number-columns-repeated"]||"1",10),r.dense)for(y[T+W]||(y[T+W]=[]),y[T+W][k]=W==0?b:Xt(b);--le>0;)y[T+W][k+le]=Xt(b);else for(y[st({r:T+W,c:k})]=b;--le>0;)y[st({r:T+W,c:k+le})]=Xt(b);P.e.c<=k&&(P.e.c=k)}le=parseInt(N["number-columns-repeated"]||"1",10),k+=le-1,le=0,b={},_="",C=[]}K={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i;O.t=_,C.length&&(O.R=C),O.a=ae,J.push(O)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);ae="",ee=0,_="",S=0,C=[];break;case"creator":g[1]==="/"?ae=n.slice(ee,g.index):ee=g.index+g[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);_="",S=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(R[l.name]=f,(i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(f="",l=ct(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=ct(g[0],!1),f+=t4[g[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=ct(g[0],!1),f+=t4[g[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,g.index);break}else d=g.index+g[0].length;break;case"named-range":s=ct(g[0],!1),me=nv(s["cell-range-address"]);var X={Name:s.name,Ref:me[0]+"!"+me[1]};V&&(X.Sheet=v.length),fe.Names.push(X);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!N||!N["string-value"])){var de=pse(n.slice(S,g.index));_=(_.length>0?_+`
`:"")+de[0]}else ct(g[0],!1),S=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{me=nv(ct(g[0])["target-range-address"]),x[me[0]]["!autofilter"]={ref:me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(K=ct(g[0],!1),!K.href)break;K.Target=wt(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(me=nv(K.Target.slice(1)),K.Target="#"+me[0]+"!"+me[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(g)}}var F={Sheets:x,SheetNames:v,Workbook:fe};return r.bookSheets&&delete F.Sheets,F}function r4(e,t){t=t||{},Ca(e,"META-INF/manifest.xml")&&zY(_r(e,"META-INF/manifest.xml"),t);var r=sa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=s6(Lt(r),t);return Ca(e,"meta.xml")&&(n.Props=YP(_r(e,"meta.xml"))),n}function n4(e,t){return s6(e,t)}var xse=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ff({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return wr+t}})(),a4=(function(){var e=function(i){return Mt(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,l){var f=[];f.push('      <table:table table:name="'+Mt(s.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,h=0,m=Gn(i["!ref"]||"A1"),x=i["!merges"]||[],v=0,y=Array.isArray(i);if(i["!cols"])for(h=0;h<=m.e.c;++h)f.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var g="",b=i["!rows"]||[];for(d=0;d<m.s.r;++d)g=b[d]?' table:style-name="ro'+b[d].ods+'"':"",f.push("        <table:table-row"+g+`></table:table-row>
`);for(;d<=m.e.r;++d){for(g=b[d]?' table:style-name="ro'+b[d].ods+'"':"",f.push("        <table:table-row"+g+`>
`),h=0;h<m.s.c;++h)f.push(t);for(;h<=m.e.c;++h){var N=!1,_={},S="";for(v=0;v!=x.length;++v)if(!(x[v].s.c>h)&&!(x[v].s.r>d)&&!(x[v].e.c<h)&&!(x[v].e.r<d)){(x[v].s.c!=h||x[v].s.r!=d)&&(N=!0),_["table:number-columns-spanned"]=x[v].e.c-x[v].s.c+1,_["table:number-rows-spanned"]=x[v].e.r-x[v].s.r+1;break}if(N){f.push(r);continue}var C=st({r:d,c:h}),T=y?(i[d]||[])[h]:i[C];if(T&&T.f&&(_["table:formula"]=Mt(Mre(T.f)),T.F&&T.F.slice(0,C.length)==C)){var k=Gn(T.F);_["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,_["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!T){f.push(t);continue}switch(T.t){case"b":S=T.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=T.v?"true":"false";break;case"n":S=T.w||String(T.v||0),_["office:value-type"]="float",_["office:value"]=T.v||0;break;case"s":case"str":S=T.v==null?"":T.v,_["office:value-type"]="string";break;case"d":S=T.w||qt(T.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=qt(T.v).toISOString(),_["table:style-name"]="ce1";break;default:f.push(t);continue}var P=e(S);if(T.l&&T.l.Target){var D=T.l.Target;D=D.charAt(0)=="#"?"#"+Rre(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),P=Le("text:a",P,{"xlink:href":D.replace(/&/g,"&amp;")})}f.push("          "+Le("table:table-cell",Le("text:p",P,{}),_)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var h=0;h<d["!cols"].length;++h)if(d["!cols"][h]){var m=d["!cols"][h];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Hs(m),m.ods=l;var x=d["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++l}}});var f=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var h=0;h<d["!rows"].length;++h)if(d["!rows"][h]){d["!rows"][h].ods=f;var m=d["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,l){var f=[wr],d=ff({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=ff({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(f.push("<office:document"+d+h+`>
`),f.push(XP().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,s),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var m=0;m!=s.SheetNames.length;++m)f.push(n(s.Sheets[s.SheetNames[m]],s,m));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),l.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function o6(e,t){if(t.bookType=="fods")return a4(e,t);var r=jb(),n="",a=[],i=[];return n="mimetype",pt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",pt(r,n,a4(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",pt(r,n,xse(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",pt(r,n,wr+XP()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",pt(r,n,VY(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",pt(r,n,WY(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Zo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function h1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Lt(to(e))}function gse(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ia(mi(e))}function vse(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ks(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function i4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function yse(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function bse(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function yf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Pt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function fr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Et(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=yf(e,r),i=a&7;a=Math.floor(a/8);var s=0,l;if(a==0)break;switch(i){case 0:{for(var f=r[0];e[r[0]++]>=128;);l=e.slice(f,r[0])}break;case 5:s=4,l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=yf(e,r),l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:l,type:i};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function rn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Pt(n*8+a.type)),a.type==2&&t.push(Pt(a.data.length)),t.push(a.data))})}),Ks(t)}function ew(e,t){return e?.map(function(r){return t(r.data)})||[]}function ka(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=yf(e,n),i=Et(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:fr(i[1][0].data),messages:[]};i[2].forEach(function(l){var f=Et(l.data),d=fr(f[3][0].data);s.messages.push({meta:f,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(s.merge=fr(i[3][0].data)>>>0>0),r.push(s)}return r}function Bl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Pt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Pt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:Pt(s.data.length)}],n[2].push({data:rn(s.meta),type:2})});var i=rn(n);t.push(Pt(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Ks(t)}function wse(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=yf(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var l=s-59;s=t[r[0]],l>1&&(s|=t[r[0]+1]<<8),l>2&&(s|=t[r[0]+2]<<16),l>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=l}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var f=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,f=(t[r[0]++]&224)<<3,f|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(f=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(f=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ks(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var h=Ks(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function ja(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(wse(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ks(t)}function $l(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Pt(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Ks(t)}function Sse(e,t,r,n){var a=Zo(e),i=a.getUint32(4,!0),s=(n>1?12:8)+i4(i&(n>1?3470:398))*4,l=-1,f=-1,d=NaN,h=new Date(2001,0,1);i&512&&(l=a.getUint32(s,!0),s+=4),s+=i4(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(s,!0),s+=4),i&32&&(d=a.getFloat64(s,!0),s+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[f]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(f>-1)m={t:"s",v:t[f]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function Nse(e,t,r){var n=Zo(e),a=n.getUint32(8,!0),i=12,s=-1,l=-1,f=NaN,d=NaN,h=new Date(2001,0,1);a&1&&(f=yse(e,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(l=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(s>-1)m={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function iv(e,t){var r=new Uint8Array(32),n=Zo(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,bse(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function sv(e,t){var r=new Uint8Array(32),n=Zo(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Ese(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Sse(e,t,r,e[0]);case 5:return Nse(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function pn(e){var t=Et(e);return yf(t[1][0].data)}function s4(e,t){var r=Et(t.data),n=fr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var l=Et(s.data),f=fr(l[1][0].data)>>>0;switch(n){case 1:i[f]=h1(l[3][0].data);break;case 8:{var d=e[pn(l[9][0].data)][0],h=Et(d.data),m=e[pn(h[1][0].data)][0],x=fr(m.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var v=Et(m.data);i[f]=v[3].map(function(y){return h1(y.data)}).join("")}break}}),i}function _se(e,t){var r,n,a,i,s,l,f,d,h,m,x,v,y,g,b=Et(e),N=fr(b[1][0].data)>>>0,_=fr(b[2][0].data)>>>0,S=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&fr(b[8][0].data)>0||!1,C,T;if((i=(a=b[7])==null?void 0:a[0])!=null&&i.data&&t!=0)C=(l=(s=b[7])==null?void 0:s[0])==null?void 0:l.data,T=(d=(f=b[6])==null?void 0:f[0])==null?void 0:d.data;else if((m=(h=b[4])==null?void 0:h[0])!=null&&m.data&&t!=1)C=(v=(x=b[4])==null?void 0:x[0])==null?void 0:v.data,T=(g=(y=b[3])==null?void 0:y[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=S?4:1,P=Zo(C),D=[],R=0;R<C.length/2;++R){var G=P.getUint16(R*2,!0);G<65535&&D.push([R,G])}if(D.length!=_)throw"Expected ".concat(_," cells, found ").concat(D.length);var M=[];for(R=0;R<D.length-1;++R)M[D[R][0]]=T.subarray(D[R][1]*k,D[R+1][1]*k);return D.length>=1&&(M[D[D.length-1][0]]=T.subarray(D[D.length-1][1]*k)),{R:N,cells:M}}function kse(e,t){var r,n=Et(t.data),a=(r=n?.[7])!=null&&r[0]?fr(n[7][0].data)>>>0>0?1:0:-1,i=ew(n[5],function(s){return _se(s,a)});return{nrows:fr(n[4][0].data)>>>0,data:i.reduce(function(s,l){return s[l.R]||(s[l.R]=[]),l.cells.forEach(function(f,d){if(s[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));s[l.R][d]=f}),s},[])}}function jse(e,t,r){var n,a=Et(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(fr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(fr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=mt(i);var s=Et(a[4][0].data),l=s4(e,e[pn(s[4][0].data)][0]),f=(n=s[17])!=null&&n[0]?s4(e,e[pn(s[17][0].data)][0]):[],d=Et(s[3][0].data),h=0;d[1].forEach(function(m){var x=Et(m.data),v=e[pn(x[2][0].data)][0],y=fr(v.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var g=kse(e,v);g.data.forEach(function(b,N){b.forEach(function(_,S){var C=st({r:h+N,c:S}),T=Ese(_,l,f);T&&(r[C]=T)})}),h+=g.nrows})}function Cse(e,t){var r=Et(t.data),n={"!ref":"A1"},a=e[pn(r[2][0].data)],i=fr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return jse(e,a[0],n),n}function Ase(e,t){var r,n=Et(t.data),a={name:(r=n[1])!=null&&r[0]?h1(n[1][0].data):"",sheets:[]},i=ew(n[2],pn);return i.forEach(function(s){e[s].forEach(function(l){var f=fr(l.meta[1][0].data);f==6e3&&a.sheets.push(Cse(e,l))})}),a}function Tse(e,t){var r=iw(),n=Et(t.data),a=ew(n[1],pn);if(a.forEach(function(i){e[i].forEach(function(s){var l=fr(s.meta[1][0].data);if(l==2){var f=Ase(e,s);f.sheets.forEach(function(d,h){sw(r,d,h==0?f.name:f.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ov(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=ja(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var h;try{h=ka(d)}catch(m){return console.log("## "+(m.message||m))}h.forEach(function(m){i[m.id]=m.messages,s.push(m.id)})}}),!s.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||s.forEach(function(f){i[f].forEach(function(d){var h=fr(d.meta[1][0].data)>>>0;if(h==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Tse(i,l)}function Pse(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&fr(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var f=0,d=Zo(e[7][0].data),h=0,m=[],x=Zo(e[4][0].data),v=0,y=[],g=0;g<t.length;++g){if(t[g]==null){d.setUint16(g*2,65535,!0),x.setUint16(g*2,65535);continue}d.setUint16(g*2,h,!0),x.setUint16(g*2,v,!0);var b,N;switch(typeof t[g]){case"string":b=iv({t:"s",v:t[g]},r),N=sv({t:"s",v:t[g]},r);break;case"number":b=iv({t:"n",v:t[g]},r),N=sv({t:"n",v:t[g]},r);break;case"boolean":b=iv({t:"b",v:t[g]},r),N=sv({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}m.push(b),h+=b.length,y.push(N),v+=N.length,++f}for(e[2][0].data=Pt(f);g<e[7][0].data.length/2;++g)d.setUint16(g*2,65535,!0),x.setUint16(g*2,65535,!0);return e[6][0].data=Ks(m),e[3][0].data=Ks(y),f}function Ose(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Gn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(mt(n)));var i=Ih(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(ae){return ae.forEach(function(ee){typeof ee=="string"&&s.push(ee)})});var l={},f=[],d=tt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(ae,ee){return[ae,d.FullPaths[ee]]}).forEach(function(ae){var ee=ae[0],L=ae[1];if(ee.type==2&&ee.name.match(/\.iwa/)){var V=ee.content,se=ja(V),U=ka(se);U.forEach(function(W){f.push(W.id),l[W.id]={deps:[],location:L,type:fr(W.messages[0].meta[1][0].data)}})}}),f.sort(function(ae,ee){return ae-ee});var h=f.filter(function(ae){return ae>1}).map(function(ae){return[ae,Pt(ae)]});d.FileIndex.map(function(ae,ee){return[ae,d.FullPaths[ee]]}).forEach(function(ae){var ee=ae[0];if(ae[1],!!ee.name.match(/\.iwa/)){var L=ka(ja(ee.content));L.forEach(function(V){V.messages.forEach(function(se){h.forEach(function(U){V.messages.some(function(W){return fr(W.meta[1][0].data)!=11006&&vse(W.data,U[1])})&&l[U[0]].deps.push(V.id)})})})}});for(var m=tt.find(d,l[1].location),x=ka(ja(m.content)),v,y=0;y<x.length;++y){var g=x[y];g.id==1&&(v=g)}var b=pn(Et(v.messages[0].data)[1][0].data);for(m=tt.find(d,l[b].location),x=ka(ja(m.content)),y=0;y<x.length;++y)g=x[y],g.id==b&&(v=g);for(b=pn(Et(v.messages[0].data)[2][0].data),m=tt.find(d,l[b].location),x=ka(ja(m.content)),y=0;y<x.length;++y)g=x[y],g.id==b&&(v=g);for(b=pn(Et(v.messages[0].data)[2][0].data),m=tt.find(d,l[b].location),x=ka(ja(m.content)),y=0;y<x.length;++y)g=x[y],g.id==b&&(v=g);var N=Et(v.messages[0].data);{N[6][0].data=Pt(n.e.r+1),N[7][0].data=Pt(n.e.c+1);var _=pn(N[46][0].data),S=tt.find(d,l[_].location),C=ka(ja(S.content));{for(var T=0;T<C.length&&C[T].id!=_;++T);if(C[T].id!=_)throw"Bad ColumnRowUIDMapArchive";var k=Et(C[T].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var P=0;P<=n.e.c;++P){var D=[];D[1]=D[2]=[{type:0,data:Pt(P+420690)}],k[1].push({type:2,data:rn(D)}),k[2].push({type:0,data:Pt(P)}),k[3].push({type:0,data:Pt(P)})}k[4]=[],k[5]=[],k[6]=[];for(var R=0;R<=n.e.r;++R)D=[],D[1]=D[2]=[{type:0,data:Pt(R+726270)}],k[4].push({type:2,data:rn(D)}),k[5].push({type:0,data:Pt(R)}),k[6].push({type:0,data:Pt(R)});C[T].messages[0].data=rn(k)}S.content=$l(Bl(C)),S.size=S.content.length,delete N[46];var G=Et(N[4][0].data);{G[7][0].data=Pt(n.e.r+1);var M=Et(G[1][0].data),H=pn(M[2][0].data);S=tt.find(d,l[H].location),C=ka(ja(S.content));{if(C[0].id!=H)throw"Bad HeaderStorageBucket";var z=Et(C[0].messages[0].data);for(R=0;R<i.length;++R){var ne=Et(z[2][0].data);ne[1][0].data=Pt(R),ne[4][0].data=Pt(i[R].length),z[2][R]={type:z[2][0].type,data:rn(ne)}}C[0].messages[0].data=rn(z)}S.content=$l(Bl(C)),S.size=S.content.length;var Q=pn(G[2][0].data);S=tt.find(d,l[Q].location),C=ka(ja(S.content));{if(C[0].id!=Q)throw"Bad HeaderStorageBucket";for(z=Et(C[0].messages[0].data),P=0;P<=n.e.c;++P)ne=Et(z[2][0].data),ne[1][0].data=Pt(P),ne[4][0].data=Pt(n.e.r+1),z[2][P]={type:z[2][0].type,data:rn(ne)};C[0].messages[0].data=rn(z)}S.content=$l(Bl(C)),S.size=S.content.length;var le=pn(G[4][0].data);(function(){for(var ae=tt.find(d,l[le].location),ee=ka(ja(ae.content)),L,V=0;V<ee.length;++V){var se=ee[V];se.id==le&&(L=se)}var U=Et(L.messages[0].data);{U[3]=[];var W=[];s.forEach(function(F,Pe){W[1]=[{type:0,data:Pt(Pe)}],W[2]=[{type:0,data:Pt(1)}],W[3]=[{type:2,data:gse(F)}],U[3].push({type:2,data:rn(W)})})}L.messages[0].data=rn(U);var X=Bl(ee),de=$l(X);ae.content=de,ae.size=ae.content.length})();var ue=Et(G[3][0].data);{var fe=ue[1][0];delete ue[2];var K=Et(fe.data);{var me=pn(K[2][0].data);(function(){for(var ae=tt.find(d,l[me].location),ee=ka(ja(ae.content)),L,V=0;V<ee.length;++V){var se=ee[V];se.id==me&&(L=se)}var U=Et(L.messages[0].data);{delete U[6],delete ue[7];var W=new Uint8Array(U[5][0].data);U[5]=[];for(var X=0,de=0;de<=n.e.r;++de){var F=Et(W);X+=Pse(F,i[de],s),F[1][0].data=Pt(de),U[5].push({data:rn(F),type:2})}U[1]=[{type:0,data:Pt(n.e.c+1)}],U[2]=[{type:0,data:Pt(n.e.r+1)}],U[3]=[{type:0,data:Pt(X)}],U[4]=[{type:0,data:Pt(n.e.r+1)}]}L.messages[0].data=rn(U);var Pe=Bl(ee),Ae=$l(Pe);ae.content=Ae,ae.size=ae.content.length})()}fe.data=rn(K)}G[3][0].data=rn(ue)}N[4][0].data=rn(G)}v.messages[0].data=rn(N);var J=Bl(x),O=$l(J);return m.content=O,m.size=m.content.length,d}function l6(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function tw(e){l6([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function rw(e){l6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Fse(e){return vt.WS.indexOf(e)>-1?"sheet":e==vt.CS?"chart":e==vt.DS?"dialog":e==vt.MS?"macro":e&&e.length?e:"sheet"}function Dse(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Fse(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Ise(e,t,r,n,a,i,s,l,f,d,h,m){try{i[n]=zu(sa(e,r,!0),t);var x=_r(e,t),v;switch(l){case"sheet":v=nie(x,t,a,f,i[n],d,h,m);break;case"chart":if(v=aie(x,t,a,f,i[n],d,h,m),!v||!v["!drawel"])break;var y=Fu(v["!drawel"].Target,t),g=hf(y),b=Hee(sa(e,y,!0),zu(sa(e,g,!0),y)),N=Fu(b,y),_=hf(N);v=Pae(sa(e,N,!0),N,f,zu(sa(e,_,!0),N),d,v);break;case"macro":v=iie(x,t,a,f,i[n],d,h,m);break;case"dialog":v=sie(x,t,a,f,i[n],d,h,m);break;default:throw new Error("Unrecognized sheet type "+l)}s[n]=v;var S=[];i&&i[n]&&dr(i[n]).forEach(function(C){var T="";if(i[n][C].Type==vt.CMNT){T=Fu(i[n][C].Target,t);var k=uie(_r(e,T,!0),T,f);if(!k||!k.length)return;Vj(v,k,!1)}i[n][C].Type==vt.TCMNT&&(T=Fu(i[n][C].Target,t),S=S.concat(Kee(_r(e,T,!0),f)))}),S&&S.length&&Vj(v,S,!0,f.people||[])}catch(C){if(f.WTF)throw C}}function Na(e){return e.charAt(0)=="/"?e.slice(1):e}function Mse(e,t){if(Tc(),t=t||{},tw(t),Ca(e,"META-INF/manifest.xml")||Ca(e,"objectdata.xml"))return r4(e,t);if(Ca(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ov<"u"){if(e.FileIndex)return ov(e);var r=tt.utils.cfb_new();return dj(e).forEach(function(ne){pt(r,ne,GX(e,ne))}),ov(r)}throw new Error("Unsupported NUMBERS file")}if(!Ca(e,"[Content_Types].xml"))throw Ca(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ca(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=dj(e),a=$Y(sa(e,"[Content_Types].xml")),i=!1,s,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",_r(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!_r(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},d={};if(!t.bookSheets&&!t.bookProps){if(Wu=[],a.sst)try{Wu=cie(_r(e,Na(a.sst)),a.sst,t)}catch(ne){if(t.WTF)throw ne}t.cellStyles&&a.themes.length&&(f=lie(sa(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(d=oie(_r(e,Na(a.style)),a.style,f,t))}a.links.map(function(ne){try{var Q=zu(sa(e,hf(Na(ne))),ne);return die(_r(e,Na(ne)),Q,ne,t)}catch{}});var h=rie(_r(e,Na(a.workbooks[0])),a.workbooks[0],t),m={},x="";a.coreprops.length&&(x=_r(e,Na(a.coreprops[0]),!0),x&&(m=YP(x)),a.extprops.length!==0&&(x=_r(e,Na(a.extprops[0]),!0),x&&GY(x,m,t)));var v={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(x=sa(e,Na(a.custprops[0]),!0),x&&(v=XY(x,t)));var y={};if((t.bookSheets||t.bookProps)&&(h.Sheets?s=h.Sheets.map(function(Q){return Q.name}):m.Worksheets&&m.SheetNames.length>0&&(s=m.SheetNames),t.bookProps&&(y.Props=m,y.Custprops=v),t.bookSheets&&typeof s<"u"&&(y.SheetNames=s),t.bookSheets?y.SheetNames:t.bookProps))return y;s={};var g={};t.bookDeps&&a.calcchain&&(g=fie(_r(e,Na(a.calcchain)),a.calcchain));var b=0,N={},_,S;{var C=h.Sheets;m.Worksheets=C.length,m.SheetNames=[];for(var T=0;T!=C.length;++T)m.SheetNames[T]=C[T].name}var k=i?"bin":"xml",P=a.workbooks[0].lastIndexOf("/"),D=(a.workbooks[0].slice(0,P+1)+"_rels/"+a.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");Ca(e,D)||(D="xl/_rels/workbook."+k+".rels");var R=zu(sa(e,D,!0),D.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=hie(_r(e,Na(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=qee(_r(e,Na(a.people[0])),t)),R&&(R=Dse(R,h.Sheets));var G=_r(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=m.Worksheets;++b){var M="sheet";if(R&&R[b]?(_="xl/"+R[b][1].replace(/[\/]?xl\//,""),Ca(e,_)||(_=R[b][1]),Ca(e,_)||(_=D.replace(/_rels\/.*$/,"")+R[b][1]),M=R[b][2]):(_="xl/worksheets/sheet"+(b+1-G)+"."+k,_=_.replace(/sheet0\./,"sheet.")),S=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(m.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var H=!1,z=0;z!=t.sheets.length;++z)typeof t.sheets[z]=="number"&&t.sheets[z]==b&&(H=1),typeof t.sheets[z]=="string"&&t.sheets[z].toLowerCase()==m.SheetNames[b].toLowerCase()&&(H=1);if(!H)continue e}}Ise(e,_,S,m.SheetNames[b],b,N,s,M,t,h,f,d)}return y={Directory:a,Workbook:h,Props:m,Custprops:v,Deps:g,Sheets:s,SheetNames:m.SheetNames,Strings:Wu,Styles:d,Themes:f,SSF:Xt(it)},t&&t.bookFiles&&(e.files?(y.keys=n,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(ne,Q){ne=ne.replace(/^Root Entry[\/]/,""),y.keys.push(ne),y.files[ne]=e.FileIndex[Q]}))),t&&t.bookVBA&&(a.vba.length>0?y.vbaraw=_r(e,Na(a.vba[0]),!0):a.defaults&&a.defaults.bin===rte&&(y.vbaraw=_r(e,"xl/vbaProject.bin",!0))),y}function Rse(e,t){var r=t||{},n="Workbook",a=tt.find(e,n);try{if(n="/!DataSpaces/Version",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(hZ(a.content),n="/!DataSpaces/DataSpaceMap",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=pZ(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=xZ(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);vZ(a.content)}catch{}if(n="/EncryptionInfo",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=yZ(a.content);if(n="/EncryptedPackage",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Lse(e,t){return t.bookType=="ods"?o6(e,t):t.bookType=="numbers"?Ose(e,t):t.bookType=="xlsb"?Bse(e,t):$se(e,t)}function Bse(e,t){Xl=1024,e&&!e.SSF&&(e.SSF=Xt(it)),e&&e.SSF&&(Tc(),wm(e.SSF),t.revssf=Nm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=IO.indexOf(t.bookType)>-1,a=Ub();rw(t=t||{});var i=jb(),s="",l=0;if(t.cellXfs=[],no(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",pt(i,s,JP(e.Props,t)),a.coreprops.push(s),Ft(t.rels,2,s,vt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}for(e.Props.Worksheets=e.Props.SheetNames.length,pt(i,s,eO(e.Props)),a.extprops.push(s),Ft(t.rels,3,s,vt.EXT_PROPS),e.Custprops!==e.Props&&dr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",pt(i,s,tO(e.Custprops)),a.custprops.push(s),Ft(t.rels,4,s,vt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],x=(m||{})["!type"]||"sheet";switch(x){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,pt(i,s,pie(l-1,s,t,e,h)),a.sheets.push(s),Ft(t.wbrels,-1,"worksheets/sheet"+l+"."+r,vt.WS[0])}if(m){var v=m["!comments"],y=!1,g="";v&&v.length>0&&(g="xl/comments"+l+"."+r,pt(i,g,vie(v,g)),a.comments.push(g),Ft(h,-1,"../comments"+l+"."+r,vt.CMNT),y=!0),m["!legacy"]&&y&&pt(i,"xl/drawings/vmlDrawing"+l+".vml",FO(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&pt(i,hf(s),Zl(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,pt(i,s,gie(t.Strings,s,t)),a.strs.push(s),Ft(t.wbrels,-1,"sharedStrings."+r,vt.SST)),s="xl/workbook."+r,pt(i,s,mie(e,s)),a.workbooks.push(s),Ft(t.rels,1,s,vt.WB),s="xl/theme/theme1.xml",pt(i,s,Gb(e.Themes,t)),a.themes.push(s),Ft(t.wbrels,-1,"theme/theme1.xml",vt.THEME),s="xl/styles."+r,pt(i,s,xie(e,s,t)),a.styles.push(s),Ft(t.wbrels,-1,"styles."+r,vt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",pt(i,s,e.vbaraw),a.vba.push(s),Ft(t.wbrels,-1,"vbaProject.bin",vt.VBA)),s="xl/metadata."+r,pt(i,s,yie(s)),a.metadata.push(s),Ft(t.wbrels,-1,"metadata."+r,vt.XLMETA),pt(i,"[Content_Types].xml",qP(a,t)),pt(i,"_rels/.rels",Zl(t.rels)),pt(i,"xl/_rels/workbook."+r+".rels",Zl(t.wbrels)),delete t.revssf,delete t.ssf,i}function $se(e,t){Xl=1024,e&&!e.SSF&&(e.SSF=Xt(it)),e&&e.SSF&&(Tc(),wm(e.SSF),t.revssf=Nm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=IO.indexOf(t.bookType)>-1,a=Ub();rw(t=t||{});var i=jb(),s="",l=0;if(t.cellXfs=[],no(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",pt(i,s,JP(e.Props,t)),a.coreprops.push(s),Ft(t.rels,2,s,vt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,pt(i,s,eO(e.Props)),a.extprops.push(s),Ft(t.rels,3,s,vt.EXT_PROPS),e.Custprops!==e.Props&&dr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",pt(i,s,tO(e.Custprops)),a.custprops.push(s),Ft(t.rels,4,s,vt.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],v=(x||{})["!type"]||"sheet";switch(v){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,pt(i,s,KO(l-1,t,e,m)),a.sheets.push(s),Ft(t.wbrels,-1,"worksheets/sheet"+l+"."+r,vt.WS[0])}if(x){var y=x["!comments"],g=!1,b="";if(y&&y.length>0){var N=!1;y.forEach(function(_){_[1].forEach(function(S){S.T==!0&&(N=!0)})}),N&&(b="xl/threadedComments/threadedComment"+l+"."+r,pt(i,b,Gee(y,h,t)),a.threadedcomments.push(b),Ft(m,-1,"../threadedComments/threadedComment"+l+"."+r,vt.TCMNT)),b="xl/comments"+l+"."+r,pt(i,b,DO(y)),a.comments.push(b),Ft(m,-1,"../comments"+l+"."+r,vt.CMNT),g=!0}x["!legacy"]&&g&&pt(i,"xl/drawings/vmlDrawing"+l+".vml",FO(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&pt(i,hf(s),Zl(m))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,pt(i,s,wO(t.Strings,t)),a.strs.push(s),Ft(t.wbrels,-1,"sharedStrings."+r,vt.SST)),s="xl/workbook."+r,pt(i,s,JO(e)),a.workbooks.push(s),Ft(t.rels,1,s,vt.WB),s="xl/theme/theme1.xml",pt(i,s,Gb(e.Themes,t)),a.themes.push(s),Ft(t.wbrels,-1,"theme/theme1.xml",vt.THEME),s="xl/styles."+r,pt(i,s,AO(e,t)),a.styles.push(s),Ft(t.wbrels,-1,"styles."+r,vt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",pt(i,s,e.vbaraw),a.vba.push(s),Ft(t.wbrels,-1,"vbaProject.bin",vt.VBA)),s="xl/metadata."+r,pt(i,s,OO()),a.metadata.push(s),Ft(t.wbrels,-1,"metadata."+r,vt.XLMETA),h.length>1&&(s="xl/persons/person.xml",pt(i,s,Xee(h)),a.people.push(s),Ft(t.wbrels,-1,"persons/person.xml",vt.PEOPLE)),pt(i,"[Content_Types].xml",qP(a,t)),pt(i,"_rels/.rels",Zl(t.rels)),pt(i,"xl/_rels/workbook."+r+".rels",Zl(t.wbrels)),delete t.revssf,delete t.ssf,i}function nw(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=da(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Use(e,t){return tt.find(e,"EncryptedPackage")?Rse(e,t):t6(e,t)}function zse(e,t){var r,n=e,a=t||{};return a.type||(a.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r=NP(n,a),Mse(r,a)}function c6(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return f1(e.slice(r),t);default:break e}return hc.to_workbook(e,t)}function Wse(e,t){var r="",n=nw(e,t);switch(t.type){case"base64":r=da(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Xo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Lt(r)),t.type="binary",c6(r,t)}function Hse(e,t){var r=e;return t.type=="base64"&&(r=da(r)),r=of.utils.decode(1200,r.slice(2),"str"),t.type="binary",c6(r,t)}function Vse(e){return e.match(/[^\x00-\x7F]/)?mi(e):e}function lv(e,t,r,n){return n?(r.type="string",hc.to_workbook(e,r)):hc.to_workbook(t,r)}function el(e,t){Sb();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return el(new Uint8Array(e),(r=Xt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),tc={},r.dateNF&&(tc.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",n=BX(e),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=Vse(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),l=new Uint8Array(s);if(l.foo="bar",!l.foo)return r=Xt(r),r.type="array",el(Nb(n),r)}switch((a=nw(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Use(tt.read(n,r),r);break;case 9:if(a[1]<=8)return t6(n,r);break;case 60:return f1(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return YQ(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return yO.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?zse(n,r):lv(e,n,r,i);case 239:return a[3]===60?f1(n,r):lv(e,n,r,i);case 255:if(a[1]===254)return Hse(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Lo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Lo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return u1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return kO.to_workbook(n,r);break;case 10:case 13:case 32:return Wse(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return XQ.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?u1.to_workbook(n,r):lv(e,n,r,i)}function u6(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Uf(t.file,tt.write(e,{type:xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return tt.write(e,t)}function Kse(e,t){var r=Xt(t||{}),n=Lse(e,r);return Gse(n,r)}function Gse(e,t){var r={},n=xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?tt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(bm(a))}return t.password&&typeof encrypt_agile<"u"?u6(encrypt_agile(a,t.password),t):t.type==="file"?Uf(t.file,a):t.type=="string"?Lt(a):a}function qse(e,t){var r=t||{},n=Vie(e,r);return u6(n,r)}function di(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return lf(mi(n));case"binary":return mi(n);case"string":return e;case"file":return Uf(t.file,n,"utf8");case"buffer":return xt?is(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):di(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Xse(e,t){switch(t.type){case"base64":return lf(e);case"binary":return e;case"string":return e;case"file":return Uf(t.file,e,"binary");case"buffer":return xt?is(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function j0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?lf(r):t.type=="string"?Lt(r):r;case"file":return Uf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function f6(e,t){Sb(),Uae(e);var r=Xt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=f6(e,r);return r.type="array",bm(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return di(Lie(e,r),r);case"slk":case"sylk":return di(vO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return di(n6(e.Sheets[e.SheetNames[a]],r),r);case"txt":return Xse(d6(e.Sheets[e.SheetNames[a]],r),r);case"csv":return di(aw(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return di(yO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return j0(u1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return di(hc.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return di(kO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return di(bO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return di(o6(e,r),r);case"wk1":return j0(Lo.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return j0(Lo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),j0(r6(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),qse(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Kse(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Yse(e,t,r,n,a,i,s,l){var f=yr(r),d=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!s||e[r])for(var v=t.s.c;v<=t.e.c;++v){var y=s?e[r][v]:e[n[v]+f];if(y===void 0||y.t===void 0){if(d===void 0)continue;i[v]!=null&&(x[i[v]]=d);continue}var g=y.v;switch(y.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[v]!=null){if(g==null)if(y.t=="e"&&g===null)x[i[v]]=null;else if(d!==void 0)x[i[v]]=d;else if(h&&g===null)x[i[v]]=null;else continue;else x[i[v]]=h&&(y.t!=="n"||y.t==="n"&&l.rawNumbers!==!1)?g:Zi(y,g,l);g!=null&&(m=!1)}}return{row:x,isempty:m}}function Ih(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,l="",f={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},h=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof h){case"string":f=St(h);break;case"number":f=St(e["!ref"]),f.s.r=h;break;default:f=h}n>0&&(a=0);var m=yr(f.s.r),x=[],v=[],y=0,g=0,b=Array.isArray(e),N=f.s.r,_=0,S={};b&&!e[N]&&(e[N]=[]);var C=d.skipHidden&&e["!cols"]||[],T=d.skipHidden&&e["!rows"]||[];for(_=f.s.c;_<=f.e.c;++_)if(!(C[_]||{}).hidden)switch(x[_]=sr(_),r=b?e[N][_]:e[x[_]+m],n){case 1:i[_]=_-f.s.c;break;case 2:i[_]=x[_];break;case 3:i[_]=d.header[_-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=s=Zi(r,null,d),g=S[s]||0,!g)S[s]=1;else{do l=s+"_"+g++;while(S[l]);S[s]=g,S[l]=1}i[_]=l}for(N=f.s.r+a;N<=f.e.r;++N)if(!(T[N]||{}).hidden){var k=Yse(e,f,N,x,n,i,b,d);(k.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(v[y++]=k.row)}return v.length=y,v}var o4=/"/g;function Jse(e,t,r,n,a,i,s,l){for(var f=!0,d=[],h="",m=yr(r),x=t.s.c;x<=t.e.c;++x)if(n[x]){var v=l.dense?(e[r]||[])[x]:e[n[x]+m];if(v==null)h="";else if(v.v!=null){f=!1,h=""+(l.rawNumbers&&v.t=="n"?v.v:Zi(v,null,l));for(var y=0,g=0;y!==h.length;++y)if((g=h.charCodeAt(y))===a||g===i||g===34||l.forceQuotes){h='"'+h.replace(o4,'""')+'"';break}h=="ID"&&(h='"ID"')}else v.f!=null&&!v.F?(f=!1,h="="+v.f,h.indexOf(",")>=0&&(h='"'+h.replace(o4,'""')+'"')):h="";d.push(h)}return l.blankrows===!1&&f?null:d.join(s)}function aw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=St(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,f=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),h="",m=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(x[y]||{}).hidden||(m[y]=sr(y));for(var g=0,b=a.s.r;b<=a.e.r;++b)(v[b]||{}).hidden||(h=Jse(e,a,b,m,s,f,i,n),h!=null&&(n.strip&&(h=h.replace(d,"")),(h||n.blankrows!==!1)&&r.push((g++?l:"")+h)));return delete n.dense,r.join("")}function d6(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=aw(e,t);return r}function Qse(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=St(e["!ref"]),i="",s=[],l,f=[],d=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)s[l]=sr(l);for(var h=a.s.r;h<=a.e.r;++h)for(i=yr(h),l=a.s.c;l<=a.e.c;++l)if(t=s[l]+i,r=d?(e[h]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=t+"="+n}return f}function h6(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?or(n.origin):n.origin;s=f.r,l=f.c}var d,h={s:{c:0,r:0},e:{c:l,r:s+t.length-1+a}};if(i["!ref"]){var m=St(i["!ref"]);h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),s==-1&&(s=m.e.r+1,h.e.r=s+t.length-1+a)}else s==-1&&(s=0,h.e.r=t.length-1+a);var x=n.header||[],v=0;t.forEach(function(g,b){dr(g).forEach(function(N){(v=x.indexOf(N))==-1&&(x[v=x.length]=N);var _=g[N],S="z",C="",T=st({c:l+v,r:s+b+a});d=bf(i,T),_&&typeof _=="object"&&!(_ instanceof Date)?i[T]=_:(typeof _=="number"?S="n":typeof _=="boolean"?S="b":typeof _=="string"?S="s":_ instanceof Date?(S="d",n.cellDates||(S="n",_=Dr(_)),C=n.dateNF||it[14]):_===null&&n.nullError&&(S="e",_=0),d?(d.t=S,d.v=_,delete d.w,delete d.R,C&&(d.z=C)):i[T]=d={t:S,v:_},C&&(d.z=C))})}),h.e.c=Math.max(h.e.c,l+x.length-1);var y=yr(s);if(a)for(v=0;v<x.length;++v)i[sr(v+l)+y]={t:"s",v:x[v]};return i["!ref"]=mt(h),i}function Zse(e,t){return h6(null,e,t)}function bf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=or(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?bf(e,st(t)):bf(e,st({r:t,c:r||0}))}function eoe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function iw(){return{SheetNames:[],Sheets:{}}}function sw(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(YO(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function toe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=eoe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function roe(e,t){return e.z=t,e}function m6(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function noe(e,t,r){return m6(e,"#"+t,r)}function aoe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function ioe(e,t,r,n){for(var a=typeof t!="string"?t:St(t),i=typeof t=="string"?t:mt(t),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var f=bf(e,s,l);f.t="n",f.F=i,delete f.v,s==a.s.r&&l==a.s.c&&(f.f=r,n&&(f.D=!0))}return e}var xi={encode_col:sr,encode_row:yr,encode_cell:st,encode_range:mt,decode_col:Ib,decode_row:Db,split_cell:gY,decode_cell:or,decode_range:Gn,format_cell:Zi,sheet_add_aoa:UP,sheet_add_json:h6,sheet_add_dom:a6,aoa_to_sheet:Pc,json_to_sheet:Zse,table_to_sheet:i6,table_to_book:hse,sheet_to_csv:aw,sheet_to_txt:d6,sheet_to_json:Ih,sheet_to_html:n6,sheet_to_formulae:Qse,sheet_to_row_object_array:Ih,sheet_get_cell:bf,book_new:iw,book_append_sheet:sw,book_set_sheet_visibility:toe,cell_set_number_format:roe,cell_set_hyperlink:m6,cell_set_internal_link:noe,cell_add_comment:aoe,sheet_set_array_formula:ioe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Am(e){const t=pe.getById("eleves",e);if(!t)throw new Error("Élève introuvable");const r=pe.getById("classes",t.classeId),n=pe.getAll("ecole")[0],a=r?.niveau,i=r?.anneeScolaire||t.anneeEntree||n?.anneeScolaireActive;if(!a||!i)return[];const s=pe.getAll("fraisScolaires").find(l=>l.niveau===a&&l.anneeScolaire===i);return!s||!(s.echeances&&s.echeances.length)?[]:(s.echeances||[]).map((l,f)=>({echeanceId:l.id||`${s.niveau}-${f+1}`,date:l.date,montant:Number(l.montant||0),paid:0,remaining:Number(l.montant||0),modalite:l.modalite,dueDate:l.date}))}function soe(e,t,r,n={}){let a=Am(e);const i=typeof(n&&n.modalite)<"u"?Number(n.modalite):null;if(i!==null){const h=[],m=[];for(const x of a)Number(x.modalite)===i?h.push(x):m.push(x);a=[...h,...m]}let s=Math.max(0,Number(t));const l=[];for(const h of a){if(s<=0)break;if(h.remaining<=0)continue;const m=Math.min(h.remaining,s);h.paid+=m,h.remaining-=m,s-=m,l.push({echeanceId:h.echeanceId,montant:m})}const f={eleveId:e,montant:t,datePaiement:r,createdAt:new Date().toISOString(),allocations:l,avance:s,...n},d=pe.create("paiements",f);if(s>0){const h={eleveId:e,montant:s,date:new Date().toISOString(),createdAt:new Date().toISOString()};pe.create("credits",h)}return{paiement:d,allocations:l,avance:s}}const ow={computeScheduleForEleve:Am,processPayment:soe};function ui(e){return e?e.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().replace(/[^a-z0-9 ]+/g,"").replace(/\s+/g," ").trim():""}function ooe(e,t){if(e===t)return 0;const r=e.length,n=t.length;if(r===0)return n;if(n===0)return r;const a=new Array(n+1).fill(0),i=new Array(n+1).fill(0);for(let s=0;s<=n;s++)a[s]=s;for(let s=0;s<r;s++){i[0]=s+1;for(let l=0;l<n;l++){const f=e[s]===t[l]?0:1;i[l+1]=Math.min(i[l]+1,a[l+1]+1,a[l]+f)}for(let l=0;l<=n;l++)a[l]=i[l]}return i[n]}function p6(e,t,r,n){const a=ui(t||""),i=ui(r||"");if(!a)return null;const s=x=>{const v=pe.getById("classes",x.classeId)||{};return ui(`${v.niveau||""} ${v.section||""}`.trim())};let l=e.find(x=>{const v=ui(yt(x)),y=ui(T0(x)),g=s(x);return(!i||g.includes(i)||i.includes(g))&&(v===a||y===a)});if(l)return l;let f=e.find(x=>{const v=ui(yt(x)),y=ui(T0(x));return v===a||y===a});if(f)return f;const d=a.split(" ").filter(Boolean),h=[];for(const x of e){const v=ui(yt(x)),y=ui(T0(x)),g=s(x),b=!!i&&(g.includes(i)||i.includes(g)),N=v.split(" ").filter(Boolean),_=d.filter(k=>N.includes(k)).length,S=v.includes(a)||a.includes(v)||y.includes(a)||a.includes(y);let C=0;try{const k=[String(x.telephone||""),String(x.pereTuteur||""),String(x.mereTutrice||"")].join(" "),P=(n||"").replace(/\D/g,"");P&&P.length>=6&&k.replace(/\D/g,"").includes(P)&&(C=5)}catch{}let T=_*2+(S?3:0)+C+(b?4:0);_>=Math.max(1,Math.floor(d.length*.6))&&(T+=2),h.push({e:x,score:T,classMatch:b})}if(h.sort((x,v)=>v.score-x.score),h.length>0&&h[0].score>3)return h[0].e;let m={};for(const x of e){const v=ui(yt(x)),y=ooe(a,v);(m.d===void 0||y<m.d)&&(m={e:x,d:y})}if(m.e&&m.d!==void 0){const x=Math.max(1,a.length);if(m.d<=Math.max(1,Math.floor(x*.3)))return m.e}return null}async function loe(e,t){return new Promise((r,n)=>{const a=new FileReader;a.onload=i=>{try{const s=i.target?.result,l=el(s,{type:typeof s=="string"?"binary":"array"}),f=l.SheetNames[0],d=l.Sheets[f],h=xi.sheet_to_json(d,{header:1});if(!h||h.length===0){n("Fichier Excel vide ou illisible");return}const m=h[0].map(_=>String(_||"").trim()),x=h.slice(1);if(!t){r({columns:m,preview:x.slice(0,5)});return}const v=t.matricule?m.findIndex(_=>_===t.matricule):-1,y=t.nom?m.findIndex(_=>_===t.nom):-1,g=t.prenoms?m.findIndex(_=>_===t.prenoms):-1,b=t.nomPrenoms?m.findIndex(_=>_===t.nomPrenoms):-1,N=x.map(_=>{let S="",C="";if(b!==-1){const k=String(_[b]||"").trim().split(" ");S=k[0]||"",C=k.slice(1).join(" ")}else S=y!==-1?String(_[y]||"").trim():"",C=g!==-1?String(_[g]||"").trim():"";return{id:"",matricule:v!==-1?String(_[v]||"").trim():"",nom:S,prenoms:C,sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:"",anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:"",adresse:"",photo:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}});r(N)}catch(s){n(s instanceof Error?s.message:String(s))}},a.onerror=()=>n("Erreur lecture du fichier"),a.readAsArrayBuffer(e)})}async function coe(e){const t=[["Matricule","Nom & Prénoms","Moyenne"],...e.map(i=>[i.matricule,`${i.nom} ${i.prenoms}`,""])],r=xi.aoa_to_sheet(t),n=xi.book_new();return xi.book_append_sheet(n,r,"Élèves"),f6(n,{bookType:"xlsx",type:"array"})}async function uoe(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const i=a.target?.result,s=el(i,{type:typeof i=="string"?"binary":"array"}),l=s.SheetNames[0],f=s.Sheets[l],d=xi.sheet_to_json(f,{header:1});if(!d||d.length===0){r("Fichier Excel vide ou illisible");return}const h=d[0].map(k=>String(k||"").trim()),m=d.slice(1),x=h.findIndex(k=>/nom/i.test(k)&&/pr/i.test(k)||/nom\s*&\s*pr/i.test(k)),v=h.findIndex(k=>/classe/i.test(k)),y=h.findIndex(k=>/contact|tel/i.test(k)),g=["inscription","octobre","novembre","décembre","decembre","janvier","février","fevrier","mars","avril","mai","juin","juillet","août","aout","septembre"],b=[];let S=h.map(k=>String(k||"").toLowerCase()).some(k=>k.includes("inscription"))?2:1;h.forEach((k,P)=>{const D=String(k||"").toLowerCase();g.some(R=>D.includes(R))&&(D.includes("inscription")?b.push({idx:P,name:String(k),modalite:1}):(b.push({idx:P,name:String(k),modalite:S}),S++))});const C=[],T=[];for(let k=0;k<m.length;k++){const P=m[k],D=String(P[x]||"").trim(),R=String(P[v]||"").trim(),G=y>=0?String(P[y]||"").trim():"",M=pe.getAll("eleves");let H=p6(M,D,R,G);if(!H){T.push({row:k+2,name:D,classe:R,contact:G});continue}for(const z of b){const ne=P[z.idx];if(!ne&&ne!==0)continue;const Q=String(ne).replace(/[^0-9]/g,"");if(!Q)continue;const le=Number(Q);if(!le||isNaN(le)||le<=0)continue;let fe=new Date().toISOString();const K=String(z.name||"").toLowerCase(),me={janvier:1,fevrier:2,février:2,mars:3,avril:4,mai:5,juin:6,juillet:7,août:8,aout:8,septembre:9,octobre:10,novembre:11,décembre:12,decembre:12};for(const O in me)if(K.includes(O)){const ae=new Date().getFullYear(),ee=me[O];fe=new Date(ae,ee-1,1).toISOString();break}const J=z.modalite||null;try{ow.processPayment(H.id,le,fe,{source:"import",note:`Import ${z.name}`,modalite:J,pereTelephone:G}),C.push({row:k+2,eleveId:H.id,eleveName:yt(H),month:z.name,modalite:J,montant:le})}catch{T.push({row:k+2,name:D,classe:R,contact:G})}}}t({applied:C,unresolved:T})}catch(i){r(i instanceof Error?i.message:String(i))}},n.onerror=()=>r("Erreur lecture du fichier"),n.readAsArrayBuffer(e)})}async function foe(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const i=a.target?.result,s=el(i,{type:typeof i=="string"?"binary":"array"}),l=s.SheetNames[0],f=s.Sheets[l],d=xi.sheet_to_json(f,{header:1});if(!d||d.length===0)return t({proposals:[],unresolved:[]});const h=d[0].map(k=>String(k||"").trim()),m=d.slice(1),x=h.findIndex(k=>/nom/i.test(k)&&/pr/i.test(k)||/nom\s*&\s*pr/i.test(k)),v=h.findIndex(k=>/classe/i.test(k)),y=h.findIndex(k=>/contact|tel/i.test(k)),g=["inscription","octobre","novembre","décembre","decembre","janvier","février","fevrier","mars","avril","mai","juin","juillet","août","aout","septembre"],b=[];let S=h.map(k=>String(k||"").toLowerCase()).some(k=>k.includes("inscription"))?2:1;h.forEach((k,P)=>{const D=String(k||"").toLowerCase();g.some(R=>D.includes(R))&&(D.includes("inscription")?b.push({idx:P,name:String(k),modalite:1}):(b.push({idx:P,name:String(k),modalite:S}),S++))});const C=[],T=[];for(let k=0;k<m.length;k++){const P=m[k],D=String(P[x]||"").trim(),R=String(P[v]||"").trim(),G=y>=0?String(P[y]||"").trim():"",M=pe.getAll("eleves"),H=p6(M,D,R,G);for(const z of b){const ne=P[z.idx];if(!ne&&ne!==0)continue;const Q=String(ne).replace(/[^0-9]/g,"");if(!Q)continue;const le=Number(Q);!le||isNaN(le)||le<=0||C.push({row:k+2,name:D,classe:R,contact:G,month:z.name,montant:le,modalite:z.modalite,match:H?{id:H.id,name:yt(H)}:null})}H||T.push({row:k+2,name:D,classe:R,contact:G})}t({proposals:C,unresolved:T})}catch(i){r(i instanceof Error?i.message:String(i))}},n.onerror=()=>r("Erreur lecture du fichier"),n.readAsArrayBuffer(e)})}async function doe(e){const t=[],r=[];for(const n of e){if(!n.match||!n.match.id){r.push(n);continue}let i=new Date().toISOString();const s=String(n.month||"").toLowerCase(),l={janvier:1,fevrier:2,février:2,mars:3,avril:4,mai:5,juin:6,juillet:7,août:8,aout:8,septembre:9,octobre:10,novembre:11,décembre:12,decembre:12};for(const f in l)if(s.includes(f)){const d=new Date().getFullYear(),h=l[f];i=new Date(d,h-1,1).toISOString();break}try{const f={source:"import",note:`Import ${n.month}`};typeof n.modalite<"u"&&(f.modalite=n.modalite),n.contact&&(f.pereTelephone=n.contact),ow.processPayment(n.match.id,n.montant,i,f),t.push({row:n.row,eleveId:n.match.id,month:n.month,montant:n.montant})}catch{r.push(n)}}return{applied:t,unresolved:r}}function hoe(e){const t=String(e||"").trim();if(!t)return{niveau:"",section:""};const r=t.match(/^([A-Z]+\s*\d*)\s*([A-Z]?)$/i);if(r){const a=r[1].replace(/\s+/g,"").toUpperCase(),i=r[2]||"A";return{niveau:a,section:i.toUpperCase()}}const n=t.split(/\s+/);if(n.length>=2){const a=n[n.length-1];return{niveau:n.slice(0,-1).join("").toUpperCase(),section:a.toUpperCase()}}return{niveau:t.toUpperCase(),section:"A"}}function moe(e,t,r){const a=pe.getAll("classes").find(s=>s.niveau===e&&s.section===t&&s.anneeScolaire===r);return a?a.id:pe.create("classes",{niveau:e,section:t,anneeScolaire:r,enseignantPrincipal:"",effectifMax:40,salle:"",matieres:[]}).id}function poe(e){return e?String(e).replace(/[^\d+]/g,"").trim():""}function xoe(e,t,r,n){if(t<0)return!1;const a=String(e[t]||"").toLowerCase().trim();if((a.includes("soldé")||a.includes("solde"))&&r>=0&&n>=0){const i=Number(String(e[r]||"0").replace(/[^0-9]/g,""))||0,s=Number(String(e[n]||"0").replace(/[^0-9]/g,""))||0;if(i>0&&s>0&&i<s*.5)return!0}return!1}function Oi(e,t){const r=e.map(n=>n.toLowerCase().trim().replace(/\s+/g," "));for(let n=0;n<r.length;n++)for(const a of t)if(r[n]===a.toLowerCase())return{index:n,confidence:100,matchedHeader:e[n]};for(let n=0;n<r.length;n++)for(const a of t){const i=a.toLowerCase();if(r[n].includes(i)||i.includes(r[n]))return{index:n,confidence:80,matchedHeader:e[n]}}for(let n=0;n<r.length;n++){const a=r[n].split(/[\s&]+/);for(const i of t){const s=i.toLowerCase().split(/[\s&]+/);if(s.filter(f=>a.some(d=>d.includes(f)||f.includes(d))).length>=Math.ceil(s.length*.6))return{index:n,confidence:60,matchedHeader:e[n]}}}return{index:-1,confidence:0,matchedHeader:""}}async function Mh(e,t){return new Promise((r,n)=>{const a=new FileReader;a.onload=i=>{try{const s=i.target?.result,l=el(s,{type:typeof s=="string"?"binary":"array",cellDates:!0,cellNF:!1,cellText:!1}),f=l.SheetNames;console.log("📚 Feuilles disponibles:",f);const d=t||l.SheetNames[0];console.log("📄 Feuille sélectionnée:",d);const h=l.Sheets[d],m=xi.decode_range(h["!ref"]||"A1");console.log("📐 Plage du fichier:",h["!ref"],"Range:",m);const x=[];for(let J=m.s.c;J<=m.e.c;J++){const O=xi.encode_cell({r:m.s.r,c:J}),ae=h[O];ae&&ae.v!==void 0&&ae.v!==null?x.push(String(ae.v).trim()):x.push(`Colonne ${J+1}`)}console.log("📋 En-têtes extraits (méthode directe):",x),console.log("📋 Nombre total de colonnes:",x.length);const v=xi.sheet_to_json(h,{header:1,defval:"",raw:!1,range:m.s.r});if(!v||v.length===0){n("Fichier Excel vide ou illisible");return}console.log("📋 Première ligne via sheet_to_json:",v[0]),console.log("📋 Comparaison - Direct:",x.length,"vs JSON:",v[0]?.length);const y=v.slice(1,6),g=["nom & prénoms","nom & prenoms","nom et prénoms","nom et prenoms","nom&prénoms","nom&prenoms","noms & prénoms","nom prenom","nom prenoms","nom complet","full name","eleve","élève"],b=["nom","noms","name","lastname","surname"],N=["prénom","prenom","prénoms","prenoms","firstname","given name"],_=["classe","class","niveau","grade"],S=["contact","tel","téléphone","telephone","phone","portable","mobile"],C=["protégé","protege","protégé ?","protege ?","protected"],T=["statut","status","état","etat"],k=["total payé","total paye","montant payé","montant paye","paid"],P=["montant dû","montant du","montant à payer","scolarité","scolarite","amount due"],D=Oi(x,g),R=Oi(x,b),G=Oi(x,N),M=Oi(x,_),H=Oi(x,S),z=Oi(x,C),ne=Oi(x,T),Q=Oi(x,k),le=Oi(x,P),ue={classe:M.index};D.index>=0&&D.confidence>=60?ue.nomPrenomsCombined=D.index:R.index>=0&&G.index>=0?(ue.nom=R.index,ue.prenoms=G.index):R.index>=0&&(ue.nomPrenomsCombined=R.index),H.index>=0&&(ue.contact=H.index),z.index>=0&&(ue.protege=z.index),ne.index>=0&&(ue.statut=ne.index),Q.index>=0&&(ue.totalPaye=Q.index),le.index>=0&&(ue.montantDu=le.index);const fe=D.confidence>0?D.confidence:R.confidence>0&&G.confidence>0?Math.min(R.confidence,G.confidence):R.confidence,K=Math.round((fe+M.confidence)/2),me=[{column:"Nom & Prénoms (combiné)",detectedIndex:D.index,detectedName:D.matchedHeader,confidence:D.confidence},{column:"Nom (séparé)",detectedIndex:R.index,detectedName:R.matchedHeader,confidence:R.confidence},{column:"Prénoms (séparé)",detectedIndex:G.index,detectedName:G.matchedHeader,confidence:G.confidence},{column:"Classe",detectedIndex:M.index,detectedName:M.matchedHeader,confidence:M.confidence},{column:"Contact",detectedIndex:H.index,detectedName:H.matchedHeader,confidence:H.confidence},{column:"Protégé ?",detectedIndex:z.index,detectedName:z.matchedHeader,confidence:z.confidence}].filter(J=>J.detectedIndex>=0);r({headers:x,detectedMapping:ue,confidence:{nom:fe,classe:M.confidence,overall:K},preview:y,suggestions:me,sheets:f,selectedSheet:d})}catch(s){n(s instanceof Error?s.message:String(s))}},a.onerror=()=>n("Erreur lecture du fichier"),a.readAsArrayBuffer(e)})}async function x6(e,t){return new Promise(async(r,n)=>{if(!t)try{const i=await Mh(e);if(console.log("📊 Analyse du fichier Excel:",i),i.confidence.overall<80){r({needsValidation:!0,analysis:i});return}t=i.detectedMapping,console.log("✅ Mapping automatique utilisé:",t)}catch(i){n(i instanceof Error?i.message:String(i));return}const a=new FileReader;a.onload=i=>{try{const s=i.target?.result,l=el(s,{type:typeof s=="string"?"binary":"array"}),f=l.SheetNames[0],d=l.Sheets[f],h=xi.sheet_to_json(d,{header:1});if(!h||h.length===0){n("Fichier Excel vide ou illisible");return}const m=h[0].map(ne=>String(ne||"").trim()),x=h.slice(1);if(!t){n("Mapping des colonnes non disponible");return}const v=t.nomPrenomsCombined??-1,y=t.nom??-1,g=t.prenoms??-1,b=t.classe,N=t.contact??-1,_=t.protege??-1,S=t.statut??-1,C=t.totalPaye??-1,T=t.montantDu??-1;console.log("📋 Colonnes utilisées:",{nameIdx:v,nomIdx:y,prenomsIdx:g,classeIdx:b,contactIdx:N,protegeIdx:_,statutIdx:S,totalPayeIdx:C,montantScolariteIdx:T});const k=["inscription","octobre","novembre","décembre","decembre","janvier","février","fevrier","mars","avril","mai","juin","juillet","août","aout","septembre"],P=[];let G=m.map(ne=>ne.toLowerCase().trim()).some(ne=>ne.includes("inscription"))?2:1;if(m.forEach((ne,Q)=>{const le=String(ne||"").toLowerCase();k.some(ue=>le.includes(ue))&&(le.includes("inscription")?P.push({idx:Q,name:String(ne),modalite:1}):(P.push({idx:Q,name:String(ne),modalite:G}),G++))}),console.log("📅 Colonnes de paiements détectées:",P),v<0&&y<0){n('Colonne "Nom" ou "Nom & Prénoms" non trouvée dans le fichier. Colonnes disponibles: '+m.join(", "));return}if(b<0){n('Colonne "Classe" non trouvée dans le fichier. Colonnes disponibles: '+m.join(", "));return}const H=pe.getAll("ecole")[0]?.anneeScolaireActive||`${new Date().getFullYear()}-${new Date().getFullYear()+1}`,z={elevesCreated:[],classesCreated:[],paiementsApplied:[],errors:[]};for(let ne=0;ne<x.length;ne++){const Q=x[ne];try{let le="",ue="",fe="";if(v>=0){fe=String(Q[v]||"").trim();const X=fe.split(" ");le=X[0]||"",ue=X.slice(1).join(" ")||""}else if(y>=0&&g>=0)le=String(Q[y]||"").trim(),ue=String(Q[g]||"").trim(),fe=`${le} ${ue}`.trim();else if(y>=0){fe=String(Q[y]||"").trim();const X=fe.split(" ");le=X[0]||"",ue=X.slice(1).join(" ")||""}const K=String(Q[b]||"").trim(),me=N>=0?String(Q[N]||"").trim():"";if(!le||!K)continue;if(!le){z.errors.push({row:ne+2,error:"Nom invalide",name:fe});continue}console.log(`📝 Traitement ligne ${ne+2}: ${le} ${ue} - ${K}`);const{niveau:J,section:O}=hoe(K);if(!J){z.errors.push({row:ne+2,error:"Classe invalide",name:fe});continue}const ae=moe(J,O,H);!pe.getAll("classes").some(X=>X.id===ae&&X.createdAt!==X.updatedAt)&&z.classesCreated.push({niveau:J,section:O});let L=!1;if(_>=0){const X=String(Q[_]||"").toLowerCase().trim();L=X==="oui"||X==="yes"||X==="o"}else L=xoe(Q,S,C,T);const V=poe(me),se=pe.create("eleves",{nom:le.toUpperCase(),prenoms:ue,matricule:pe.generateMatricule(),sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:ae,anneeEntree:H.split("-")[0],statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:V,adresse:"",photo:"",protege:L});z.elevesCreated.push({nom:se.nom,prenoms:se.prenoms,classe:`${J} ${O}`,matricule:se.matricule,protege:L});let U=0;const W=[];for(const X of P){const de=Q[X.idx];if(!de&&de!==0)continue;const F=String(de).replace(/[^0-9]/g,"");if(!F)continue;const Pe=Number(F);if(!Pe||isNaN(Pe)||Pe<=0||L&&X.modalite!==1)continue;let We=new Date().toISOString();const Ue=String(X.name||"").toLowerCase(),Te={janvier:1,fevrier:2,février:2,mars:3,avril:4,mai:5,juin:6,juillet:7,août:8,aout:8,septembre:9,octobre:10,novembre:11,décembre:12,decembre:12};for(const lt in Te)if(Ue.includes(lt)){const jt=parseInt(H.split("-")[0]),Yt=Te[lt],Ct=Yt>=9?jt:jt+1;We=new Date(Ct,Yt-1,1).toISOString();break}try{const lt={source:"import",note:`Import ${X.name}`,modalite:X.modalite,pereTelephone:V,typeFrais:X.modalite===1?"inscription":"scolarite",modePaiement:"Espèces",numeroRecu:`IMP-${se.matricule}-${X.modalite}`,operateur:"Système"};ow.processPayment(se.id,Pe,We,lt),U+=Pe,W.push(`${X.name}: ${Pe} FCFA`)}catch(lt){z.errors.push({row:ne+2,error:`Erreur paiement ${X.name}: ${lt instanceof Error?lt.message:String(lt)}`,name:fe})}}U>0&&z.paiementsApplied.push({eleveName:`${se.nom} ${se.prenoms}`,totalAmount:U,details:W.join(", ")})}catch(le){z.errors.push({row:ne+2,error:le instanceof Error?le.message:String(le),name:Q[v]?String(Q[v]):"Inconnu"})}}r(z)}catch(s){n(s instanceof Error?s.message:String(s))}},a.onerror=()=>n("Erreur lecture du fichier"),a.readAsArrayBuffer(e)})}const Cu=Object.freeze(Object.defineProperty({__proto__:null,analyzeExcelStructure:Mh,applyPaiementsDepuisProposals:doe,exporterElevesEnExcel:coe,importerElevesDepuisExcel:loe,importerElevesEtPaiementsComplet:x6,importerPaiementsDepuisExcel:uoe,previewImporterPaiementsDepuisExcel:foe},Symbol.toStringTag,{value:"Module"}));function goe(){const[e,t]=j.useState(null),[r,n]=j.useState(!1),[a,i]=j.useState(null),[s,l]=j.useState(""),[f,d]=j.useState(null),[h,m]=j.useState(!1),[x,v]=j.useState(null),[y,g]=j.useState(""),b=async T=>{const k=T.target.files?.[0];if(k){t(k),i(null),l(""),d(null),m(!1),v(null),g(""),n(!0);try{const P=await Mh(k);d(P),g(P.selectedSheet),console.log("📊 Analyse automatique:",P),P.confidence.overall<80&&(m(!0),v(P.detectedMapping))}catch(P){l(P instanceof Error?P.message:String(P))}finally{n(!1)}}},N=async T=>{if(e){g(T),n(!0),l("");try{const k=await Mh(e,T);d(k),v(k.detectedMapping),console.log("📊 Analyse de la feuille:",T,k),k.confidence.overall<80?m(!0):m(!1)}catch(k){l(k instanceof Error?k.message:String(k))}finally{n(!1)}}},_=async()=>{if(!e){l("Veuillez sélectionner un fichier");return}n(!0),l(""),i(null);try{const T=await x6(e,x||void 0);if(T.needsValidation){d(T.analysis),m(!0),v(T.analysis.detectedMapping),n(!1);return}i(T),T.elevesCreated.length>0&&setTimeout(()=>{window.dispatchEvent(new CustomEvent("dataChanged"))},1e3)}catch(T){l(T instanceof Error?T.message:String(T))}finally{n(!1)}},S=(T,k)=>{v(P=>({...P,[T]:k>=0?k:void 0}))},C=()=>{m(!1)};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Importation Complète (Élèves + Paiements)"}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"📋 Format du fichier Excel requis:"}),o.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 ml-4",children:[o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Nom & Prénoms"}),": Nom complet de l'élève"]}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Classe"}),": Classe de l'élève (ex: CP1 A, CE2 B)"]}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Contact"}),": Numéro de téléphone du parent (père par défaut)"]}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Colonnes de mois"}),": Inscription, Octobre, Novembre, Décembre, etc."]}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Statut"}),": Pour détecter les élèves protégés (optionnel)"]})]})]}),o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[o.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"✨ Fonctionnalités intelligentes:"}),o.jsxs("ul",{className:"text-sm text-green-800 space-y-1 ml-4",children:[o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Création automatique des classes"}),' basée sur la colonne "Classe"']}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Détection des élèves protégés"})," (ne paient que l'inscription)"]}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Allocation intelligente des paiements"})," sur les échéances"]}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Gestion des paiements excédentaires"})," (report automatique)"]}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Importation des contacts parents"})," (insensible à la casse)"]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sélectionner le fichier Excel"}),o.jsx("div",{className:"flex items-center space-x-4",children:o.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:b,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})}),e&&o.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Fichier sélectionné: ",o.jsx("strong",{children:e.name})]})]}),f&&f.sheets.length>1&&o.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-purple-900 mb-2",children:"📚 Sélection de la feuille"}),o.jsx("p",{className:"text-sm text-purple-800 mb-3",children:"Votre fichier contient plusieurs feuilles. Sélectionnez celle qui contient les données à importer :"}),o.jsx("select",{value:y,onChange:T=>N(T.target.value),className:"w-full border border-purple-300 rounded-md px-3 py-2 text-sm bg-white",children:f.sheets.map((T,k)=>o.jsx("option",{value:T,children:T},k))})]}),f&&!h&&o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:"✅ Colonnes détectées automatiquement"}),o.jsx("div",{className:"text-sm text-green-800 space-y-1",children:f.suggestions.map((T,k)=>o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("span",{children:[T.column,":"]}),o.jsxs("span",{className:"font-medium",children:[T.detectedName," (",T.confidence,"% confiance)"]})]},k))}),o.jsxs("button",{onClick:()=>m(!0),className:"mt-3 text-sm text-green-700 hover:text-green-900 underline flex items-center space-x-1",children:[o.jsx(R0,{className:"w-4 h-4"}),o.jsx("span",{children:"Modifier le mapping"})]})]}),h&&f&&x&&o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[o.jsxs("h4",{className:"font-semibold text-yellow-900 mb-3 flex items-center space-x-2",children:[o.jsx(R0,{className:"w-5 h-5"}),o.jsx("span",{children:"Configuration du mapping des colonnes"})]}),o.jsx("p",{className:"text-sm text-yellow-800 mb-4",children:"Sélectionnez les colonnes correspondantes dans votre fichier Excel :"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom & Prénoms (combiné) - Optionnel si colonnes séparées"}),o.jsxs("select",{value:x.nomPrenomsCombined??-1,onChange:T=>S("nomPrenomsCombined",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilisé --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom (séparé) - Optionnel si colonne combinée"}),o.jsxs("select",{value:x.nom??-1,onChange:T=>S("nom",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilisé --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prénoms (séparé) - Optionnel si colonne combinée"}),o.jsxs("select",{value:x.prenoms??-1,onChange:T=>S("prenoms",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilisé --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Classe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("select",{value:x.classe,onChange:T=>S("classe",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact / Téléphone - Optionnel"}),o.jsxs("select",{value:x.contact??-1,onChange:T=>S("contact",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilisé --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Protégé ? - Optionnel"}),o.jsxs("select",{value:x.protege??-1,onChange:T=>S("protege",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilisé --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]})]}),o.jsx("button",{onClick:C,className:"mt-4 w-full bg-yellow-600 text-white py-2 px-4 rounded-lg hover:bg-yellow-700 transition-colors",children:"Confirmer le mapping"})]}),o.jsx("button",{onClick:_,disabled:!e||r||h,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2 transition-colors",children:r?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),o.jsx("span",{children:"Analyse en cours..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Ls,{className:"w-5 h-5"}),o.jsx("span",{children:"Lancer l'importation"})]})})]}),s&&o.jsxs("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[o.jsx(b1,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-red-900",children:"Erreur d'importation"}),o.jsx("p",{className:"text-sm text-red-800 mt-1",children:s})]})]})]}),a&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center space-x-2",children:[o.jsx(Oa,{className:"w-6 h-6 text-green-600"}),o.jsx("span",{children:"Résumé de l'importation"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(qi,{className:"w-8 h-8 text-blue-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-blue-900",children:a.elevesCreated.length}),o.jsx("p",{className:"text-sm text-blue-700",children:"Élèves importés"})]})]})}),o.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ki,{className:"w-8 h-8 text-green-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-green-900",children:a.classesCreated.length}),o.jsx("p",{className:"text-sm text-green-700",children:"Classes créées"})]})]})}),o.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(gi,{className:"w-8 h-8 text-purple-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-purple-900",children:a.paiementsApplied.length}),o.jsx("p",{className:"text-sm text-purple-700",children:"Paiements traités"})]})]})})]})]}),a.classesCreated.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Classes créées automatiquement"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:a.classesCreated.map((T,k)=>o.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:[T.niveau," ",T.section]},k))})]}),a.elevesCreated.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Élèves importés"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Matricule"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nom & Prénoms"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Classe"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.elevesCreated.map((T,k)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:T.matricule}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[T.nom," ",T.prenoms]}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:T.classe}),o.jsx("td",{className:"px-4 py-3 text-sm",children:T.protege?o.jsx("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs font-medium",children:"Protégé"}):o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:"Normal"})})]},k))})]})})]}),a.paiementsApplied.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Paiements traités"}),o.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:a.paiementsApplied.map((T,k)=>o.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:T.eleveName}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:T.details})]}),o.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold",children:[T.totalAmount.toLocaleString()," FCFA"]})]})},k))})]}),a.errors.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsxs("h4",{className:"font-semibold text-red-800 mb-3 flex items-center space-x-2",children:[o.jsx(m5,{className:"w-5 h-5"}),o.jsxs("span",{children:["Erreurs rencontrées (",a.errors.length,")"]})]}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.errors.map((T,k)=>o.jsx("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200",children:o.jsxs("p",{className:"text-sm text-red-900",children:[o.jsxs("strong",{children:["Ligne ",T.row]}),T.name&&o.jsxs("span",{children:[" - ",T.name]}),": ",T.error]})},k))})]})]})]})}const voe=[{id:"ecole",title:"Configuration École",description:"Nom, logo, coordonnées de l'établissement",icon:c4},{id:"frais",title:"Configuration Frais",description:"Modalités et échéances de paiement par niveau",icon:gi},{id:"compositions",title:"Configuration Compositions",description:"Périodes d'évaluation et coefficients",icon:Ki},{id:"impression",title:"Configuration Impression",description:"Entêtes, logos et mise en page des documents",icon:g1},{id:"import",title:"Importation Complète",description:"Importer élèves, classes et paiements depuis Excel",icon:Ls},{id:"backup",title:"Sauvegarde & Restauration",description:"Export, import et gestion des données",icon:v5},{id:"historique",title:"Historique des Actions",description:"Journal des modifications et opérations",icon:w5},{id:"licence",title:"Gestion des Licences",description:"Activation et statut de la licence logicielle",icon:p4},{id:"passage",title:"Passage d'année scolaire",description:"Clôturer l'année en cours et préparer la nouvelle",icon:v1}];function yoe(){const[e,t]=j.useState("menu"),r=()=>{switch(e){case"ecole":return o.jsx(v4,{});case"frais":return o.jsx(Zq,{});case"compositions":return o.jsx(eX,{});case"impression":return o.jsx(tX,{});case"import":return o.jsx(goe,{});case"backup":return o.jsx(rX,{});case"historique":return o.jsx(nX,{});case"licence":return o.jsx(aX,{});case"passage":return o.jsx(sX,{});default:return o.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-8",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Configuration Système"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Paramètres généraux de votre école"})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:voe.map(n=>{const a=n.icon;return o.jsxs("button",{onClick:()=>t(n.id),className:"group bg-white rounded-lg border border-gray-200 p-6 hover:border-gray-300 hover:shadow-sm transition-all text-left",children:[o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mb-4 group-hover:bg-gray-200 transition-colors",children:o.jsx(a,{className:"h-6 w-6 text-gray-600"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n.title}),o.jsx("p",{className:"text-gray-600 text-sm mb-4",children:n.description}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500 group-hover:text-gray-700 transition-colors",children:[o.jsx("span",{children:"Configurer"}),o.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},n.id)})}),o.jsxs("div",{className:"mt-8 bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Informations Système"}),o.jsx("p",{className:"text-gray-600",children:"État actuel de votre configuration"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"text-center p-6 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:pe.getAll("eleves").length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Élèves"})]}),o.jsxs("div",{className:"text-center p-6 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:pe.getAll("classes").length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Classes"})]}),o.jsxs("div",{className:"text-center p-6 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:pe.getAll("matieres").length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Matières"})]})]})]})]})})}};return e!=="menu"?o.jsx("div",{className:"bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("button",{onClick:()=>t("menu"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[o.jsx(D0,{className:"h-4 w-4"}),o.jsx("span",{children:"Retour à la configuration"})]})}),r()]})}):o.jsx("div",{children:r()})}function boe({onCancel:e,onSubmit:t}){const r=pe.getAll("classes"),[n,a]=j.useState(""),[i,s]=j.useState(""),[l,f]=j.useState(!1),[d,h]=j.useState(""),[m,x]=j.useState("scolarite"),[v,y]=j.useState("auto"),[g,b]=j.useState("espece"),[N,_]=j.useState(""),{showToast:S}=Xr(),[C,T]=j.useState(!1),k=j.useRef({selectedClasse:n,eleveId:i,montant:d,type:m,modalite:v,mode:g,note:N}),P=j.useMemo(()=>{try{return JSON.stringify({selectedClasse:n,eleveId:i,montant:d,type:m,modalite:v,mode:g,note:N})!==JSON.stringify(k.current||{})}catch{return!1}},[n,i,d,m,v,g,N]),D=Bf(P),R="payment:draft",{load:G,clear:M}=$f(R,{selectedClasse:n,eleveId:i,montant:d,type:m,modalite:v,mode:g,note:N});useEffect(()=>{try{const Q=G();Q&&(a(Q.selectedClasse||""),s(Q.eleveId||""),h(Q.montant||""),x(Q.type||"scolarite"),y(Q.modalite||"auto"),b(Q.mode||"espece"),_(Q.note||""),k.current=Q)}catch{}},[]);const H=()=>"REC"+Date.now().toString().slice(-8),z=Q=>{s(Q);const le=pe.getById("eleves",Q);f(!!le?.protege);try{const fe=Am(Q).find(K=>K.remaining>0);if(fe){const K=String(fe.echeanceId).split("-"),me=K[K.length-1],J=Number(me);Number.isFinite(J)&&J>=1&&J<=7&&y(J)}}catch(ue){console.debug("compute schedule failed",ue)}},ne=Q=>{a(Q);const le=pe.getAll("eleves").filter(ue=>!Q||ue.classeId===Q);le.length?z(le[0].id):s("")};return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 flex flex-col max-h-[90vh]",children:[o.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-100",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Nouveau Paiement"}),o.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",onClick:()=>P&&D?D.openPrompt():e(),"aria-label":"Fermer",children:"✕"})]}),o.jsxs("div",{className:"overflow-y-auto px-4 py-3 space-y-3 flex-1",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Classe"}),o.jsxs("select",{value:n,onChange:Q=>ne(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"-- Toutes les classes --"}),r.map(Q=>o.jsxs("option",{value:Q.id,children:[Q.niveau," ",Q.section]},Q.id))]}),o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 mt-4",children:"Élève"}),o.jsxs("select",{value:i,onChange:Q=>z(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"-- Sélectionner élève --"}),pe.getAll("eleves").filter(Q=>!n||Q.classeId===n).map(Q=>o.jsxs("option",{value:Q.id,children:[Q.nom," ",Q.prenoms," (",Q.matricule,")"]},Q.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant (FCFA)"}),o.jsx("input",{type:"number",value:d,onChange:Q=>h(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors text-lg font-bold",placeholder:"0"}),l&&o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Élève protégé: montant libre, mais seule l'inscription sera prise en compte."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de frais"}),o.jsx("select",{value:m,onChange:Q=>x(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",disabled:l,children:l?o.jsx("option",{value:"inscription",children:"Inscription"}):o.jsxs(o.Fragment,{children:[o.jsx("option",{value:"scolarite",children:"Scolarité"}),o.jsx("option",{value:"inscription",children:"Inscription"}),o.jsx("option",{value:"cantine",children:"Cantine"}),o.jsx("option",{value:"transport",children:"Transport"}),o.jsx("option",{value:"fournitures",children:"Fournitures"})]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modalité de versement"}),o.jsx("select",{value:String(v),onChange:Q=>y(Q.target.value==="auto"?"auto":Number(Q.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",disabled:l,children:l?o.jsx("option",{value:1,children:"1 - Inscription"}):o.jsxs(o.Fragment,{children:[o.jsx("option",{value:"auto",children:"Auto"}),o.jsx("option",{value:1,children:"1 - Inscription"}),o.jsx("option",{value:2,children:"2 - Versement 1"}),o.jsx("option",{value:3,children:"3 - Versement 2"}),o.jsx("option",{value:4,children:"4 - Versement 3"}),o.jsx("option",{value:5,children:"5 - Versement 4"}),o.jsx("option",{value:6,children:"6 - Versement 5"}),o.jsx("option",{value:7,children:"7 - Versement 6"})]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mode de paiement"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{value:"espece",label:"Espèces"},{value:"mobile",label:"Mobile Money"},{value:"cheque",label:"Chèque"},{value:"virement",label:"Virement"}].map(Q=>o.jsxs("label",{className:`flex items-center justify-center p-2 border rounded-md cursor-pointer transition-all ${g===Q.value?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"mode",value:Q.value,checked:g===Q.value,onChange:le=>b(le.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium text-sm",children:Q.label})]},Q.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note ou commentaire (optionnel)"}),o.jsx("textarea",{value:N,onChange:Q=>_(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors resize-none",rows:3,placeholder:"Commentaire sur ce paiement..."})]})]}),o.jsxs("div",{className:"px-4 py-3 border-t bg-white flex flex-col sm:flex-row justify-end gap-2 lg:gap-4",children:[o.jsx(ht,{variant:"secondary",className:"w-full sm:w-auto",onClick:()=>P&&D?D.openPrompt():e(),disabled:C,children:"Annuler"}),o.jsxs(ht,{variant:"primary",className:"w-full sm:w-auto",onClick:async()=>{if(!i){S("Sélectionnez un élève","error");return}const Q=Number(d||0);if(!Q||Q<=0){S("Montant invalide","error");return}T(!0);const le=H();try{const ue={mode:g,note:N,numeroRecu:le,type:m,modalite:v};try{const{getCurrentUser:K}=await Fi(async()=>{const{getCurrentUser:J}=await Promise.resolve().then(()=>WS);return{getCurrentUser:J}},void 0,import.meta.url),me=K();me&&(ue.utilisateur=yt(me))}catch(K){console.debug("getCurrentUser failed",K)}const fe=la.processPaymentIntelligent(i,Q,new Date().toISOString(),ue);try{const K=(await Fi(async()=>{const{getCurrentUser:J}=await Promise.resolve().then(()=>WS);return{getCurrentUser:J}},void 0,import.meta.url)).getCurrentUser(),me=fe&&fe.paiement&&fe.paiement.id?String(fe.paiement.id):void 0;pe.addHistorique({type:"paiement",cible:"Paiement",cibleId:me,description:`Paiement de ${Q} FCFA pour élève ${i} (reçu ${ue.numeroRecu})`,utilisateur:K?`${K.prenoms} ${K.nom}`:"Inconnu"})}catch(K){console.debug("historique skip:",K)}try{const K=pe.getById("eleves",i),me=K?yt(K):"",J=`
                      <html><head><title>Reçu ${ue.numeroRecu}</title></head><body>
                        <h2>Reçu de paiement</h2>
                        <div>Reçu: ${ue.numeroRecu}</div>
                        <div>Élève: ${me} (${K?.matricule||""})</div>
                        <div>Montant: ${Q} FCFA</div>
                        <div>Mode: ${ue.mode}</div>
                        <div>Date: ${new Date().toLocaleString()}</div>
                      </body></html>`,O=window.open("","_blank","width=600,height=800");O&&(O.document.write(J),O.document.close(),setTimeout(()=>{try{O.print()}catch(ae){console.debug("print failed",ae)}},300))}catch(K){console.debug("preview failed",K)}try{t(i,Q,m,v,fe.paiement)}catch(K){console.debug("onSubmit handler error",K)}S("Paiement enregistré","success");try{M()}catch{}e()}catch(ue){console.error(ue);const fe=ue&&ue.message?ue.message:"Erreur lors de l'enregistrement du paiement";S(fe,"error")}finally{T(!1)}},disabled:C,children:[C?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 lg:h-5 lg:w-5 border-b-2 border-white"}):o.jsx("span",{children:"Enregistrer"}),o.jsx("span",{children:C?"Enregistrement...":"Paiement"})]})]})]}),D&&o.jsx(gc,{open:D.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardées. Voulez-vous quitter sans enregistrer ?",onConfirm:()=>{try{M()}catch{}const Q=window;try{Q.__preventReDispatch=!0}catch{}try{D.allowNavigation?D.allowNavigation():e()}finally{setTimeout(()=>{try{Q.__preventReDispatch=!1}catch{}},80)}},onCancel:()=>D.closePrompt&&D.closePrompt()})]})}function lw(e){let t=e.receipt;if(!t&&e.montantRegle!=null){const v=e.eleve||{},y=e.numeroRecu||e.notes||"Paiement",g=Number(e.montantRegle||0);t={id:String(e.numeroRecu||"tmp-"+Date.now()),numero:e.numeroRecu,eleve:{nom:v.nom||"",prenoms:v.prenoms||"",matricule:v.matricule||"",classe:v.classe||""},payeur:e.payeur||v.nom||"",items:[{description:y,montant:g}],montantTotal:g,date:e.date,paiementType:e.mode,user:e.operateur||e.user,notes:e.notes||""};try{const b=pe.getAll("paiements").find(N=>N.numeroRecu===t.numero||N.datePaiement===t.date||N.eleveId&&N.eleveId===v.id);if(b&&b.allocations&&Array.isArray(b.allocations)&&b.allocations.length>0){const N=b.allocations.map(_=>{let S=null;return _&&_.echeanceId&&(S=pe.getById("echeances",_.echeanceId),S||(S=pe.getAll("echeances").find(T=>T.echeanceId===_.echeanceId||T.echeanceId===_.echeanceId))),{description:S?.label?.trim()||(_.description?_.description.trim():"")||(_.modalite?`Modalité ${_.modalite}`:"Paiement"),montant:_.montant||0}});t.items=N,t.montantTotal=N.reduce((_,S)=>_+(S.montant||0),0)}}catch{}}const r=e.entete,n=zo("recu"),a=r||n||{};if(!t)return o.jsx("div",{className:"p-4 text-sm text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:"Aucun reçu à afficher"});const i=v=>v.toLocaleString("fr-FR"),s=(()=>{try{const v=t?.eleve?.id||e.eleve?.id;return v?la.getSituationEcheances(v):null}catch{return null}})(),l=Number(e.totalPaye??e.cumulReglement??(s?s.totalPaye:NaN));let f=e.totalRestant??e.resteAPayer??(s?s.totalRestant:void 0),d=e.totalAttendu??e.totalDu??(s?s.totalDu:void 0);const h=Number.isFinite(l)?l:t?Number(t.montantTotal||0):0;d==null&&(f!=null?d=h+Number(f):s?d=s.totalDu:d=h||(t?t.montantTotal:0)),f==null&&(f=Math.max(0,Number(d||0)-Number(h||0)));const m=Number(f||0),x=Number(m||0)===0;return o.jsxs("div",{id:t.id,className:"receipt-compact recu simple-recu bg-white border border-gray-300 rounded-md p-4 relative","data-recu-id":t.id,style:{minHeight:"320px",boxSizing:"border-box"},children:[x?o.jsx("div",{style:{position:"absolute",top:12,right:12,background:"#059669",color:"white",padding:"6px 12px",borderRadius:8,fontSize:12,fontWeight:700,zIndex:10,boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:"SOLDÉ"}):null,o.jsxs("div",{className:"entete flex justify-between items-center mb-2",children:[o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"text-base font-bold entete-libelle",children:a.etablissement||a.header||"Votre École"}),o.jsx("div",{className:"text-xs",children:"Reçu de paiement"})]}),o.jsx("div",{className:"text-right",children:a.logo?o.jsx("img",{src:a.logo,alt:"logo",style:{height:48,objectFit:"contain"}}):null})]}),o.jsxs("div",{className:"student-row mb-3 flex justify-between text-xs",children:[o.jsxs("div",{children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Élève :"})," ",yt(t.eleve)," ",t.eleve.matricule?`(${t.eleve.matricule})`:""]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Classe :"})," ",t.eleve.classe||"—"]})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Mode :"})," ",t.paiementType||"Espèces"]}),o.jsx("div",{className:"mt-1",children:t.date?new Date(t.date).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""})]})]}),o.jsx("div",{className:"items mb-3 text-xs",style:{maxHeight:"none",overflowY:"visible"},children:t.items.map((v,y)=>{const g=v.description.match(/^(\d{2}\/\d{2}\/\d{4})(?: (\d{2}:\d{2}))? · /),b=g?g[1]:"",N=g&&g[2]?g[2]:"";return g?v.description.replace(/^(\d{2}\/\d{2}\/\d{4})(?: \d{2}:\d{2})? · /,""):v.description,o.jsxs("div",{style:{padding:"2px 0",fontWeight:600,fontSize:14,lineHeight:"1.3"},children:[b&&o.jsx("span",{style:{marginRight:8},children:b}),N&&o.jsx("span",{style:{marginRight:8},children:N}),"Paiement : ",o.jsxs("span",{style:{fontWeight:700,marginLeft:4},children:[i(v.montant)," FCFA"]})]},y)})}),o.jsx("div",{className:"summary-box mb-4 text-xs",style:{borderTop:"1px solid #ddd",paddingTop:8},children:o.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Total attendu:"})," ",o.jsxs("span",{className:"font-bold",children:[i(Number(d||0))," FCFA"]})]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Total cumulé payé:"})," ",o.jsxs("span",{className:"font-bold",children:[i(Number(h||0))," FCFA"]})]}),o.jsxs("div",{className:"print-deadline",children:[o.jsx("strong",{children:"Reste à payer:"})," ",o.jsxs("span",{className:"font-bold",children:[i(Number(m||0))," FCFA"]})]})]})}),o.jsxs("div",{className:"total text-right text-sm font-bold mb-3 print-important",style:{fontSize:"1.1rem"},children:["TOTAL — ",o.jsxs("span",{className:"font-bold",children:[i(t.montantTotal)," FCFA"]})]}),o.jsx("div",{className:"mt-2 text-xs text-left",children:o.jsxs("div",{children:[o.jsx("strong",{children:"Opérateur :"})," ",o.jsx("span",{className:"font-bold",children:t.user||e.user||(()=>{const v=Lh();return v?yt(v):"ADMIN"})()})]})}),o.jsxs("div",{className:"mt-4 flex gap-3 justify-end",children:[o.jsxs(ht,{variant:"secondary",onClick:()=>wh(t.id,"Aperçu reçu",!1),children:[o.jsx(wf,{className:"h-4 w-4"})," Aperçu"]}),o.jsxs(ht,{onClick:()=>wh(t.id,"Imprimer reçu (2/page)",!0),children:[o.jsx(u4,{className:"h-4 w-4"})," Imprimer 2/page"]})]})]})}function g6({receipts:e=[],eleve:t,paiements:r,classe:n,totalAttendu:a,title:i="Reçus de Paiement"}){let s=[];if(Array.isArray(e)&&e.length>0)s=e;else if(Array.isArray(r)&&r.length>0){const d=new Map;r.forEach(h=>{const m=h.eleveId||h.eleveMatricule||`${h.eleveNom||""}|${h.elevePrenoms||""}`,x=h.montant||h.montantTtc||0,v=h.modePaiement||h.paiementType||"Espèces",y=h.datePaiement||h.createdAt,g=h.nbEcheances||h.nombreEcheances||1;let b="";try{const S=h.eleveId?la.getSituationEcheances(h.eleveId):null;if(S){if(Array.isArray(h.allocations)&&h.allocations.length>0){const C=h.allocations.map(T=>{const k=(S.echeances||[]).find(P=>P.echeanceId===T.echeanceId||P.echeanceId===`${S.classe&&S.classe.niveau||""}-${T.modalite}`);return k?k.label:T.label||""}).filter(Boolean);C.length>0&&(b=C.join(" · "))}if(!b){let C=null;if(h.modalite?C=Number(h.modalite):h.versementIndex!=null?C=Number(h.versementIndex)+1:h.typeFrais==="inscription"&&(C=1),C){const T=(S.echeances||[]).find(k=>Number(k.modalite)===Number(C));T&&(b=T.label||"")}if(!b){const T=(S.echeances||[]).find(k=>Number(k.montant)===Number(x));T&&(b=T.label||"")}}}}catch{}b||(b=h.notes||h.numeroRecu||`Règlement de ${g} échéance(s)`);const N=`${b}${" - "+v}`,_={description:`${y?new Date(y).toLocaleDateString("fr-FR")+" · ":""}${N}`,montant:x};if(!d.has(m))d.set(m,{eleve:{id:h.eleveId,nom:h.eleveNom||h.eleve?.nom||(t?t.nom:"")||"",prenoms:h.elevePrenoms||h.eleve?.prenoms||(t?t.prenoms:"")||"",matricule:h.eleveMatricule||h.eleve?.matricule||(t?t.matricule:"")||"",classe:n?`${n.niveau||""} ${n.section||""}`:h.classe||h.classeNom||""},payeur:h.payeur||h.nomPayeur,paiementType:v,items:[_],montantTotal:x,ids:[h.id]});else{const S=d.get(m);S.items.push(_),S.montantTotal=(S.montantTotal||0)+x,S.ids.push(h.id)}}),s=Array.from(d.values()).map(h=>({id:h.ids&&h.ids[0]||String(Math.random()).slice(2),numero:void 0,eleve:h.eleve,payeur:h.payeur,items:h.items,montantTotal:h.montantTotal,date:void 0,paiementType:h.paiementType,user:void 0,notes:void 0}))}const l=[];for(let d=0;d<s.length;d+=2)l.push([s[d],s[d+1]].filter(Boolean));const f=zo("recu");return o.jsxs("div",{className:"combined-recu-root",children:[o.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12},children:o.jsx("h2",{style:{margin:0},children:i})}),o.jsxs("div",{id:"combined-print-area",children:[l.length===0&&o.jsx("div",{style:{padding:24},children:"Aucun reçu"}),l.map((d,h)=>o.jsx("div",{className:"print-page-two-up",style:{padding:8},children:o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:d.map(m=>{const x=typeof a=="number"?a:m.montantTotal,v=m.montantTotal,y=Math.max(0,(x||0)-v),g={receipt:m,totalAttendu:x,totalPaye:v,totalRestant:y,entete:f,eleve:m.eleve||t};return o.jsx("div",{style:{marginBottom:6},children:o.jsx(lw,{...g})},m.id)})})},h))]}),o.jsx("style",{children:`
        @media print {
          body > *:not(#combined-print-area):not(script):not(style) { display: none !important; }
          #combined-print-area { width: 210mm; margin: 0 auto; }
          .print-page-two-up { min-height: 297mm; display: flex; flex-direction: column; justify-content: space-between; page-break-after: always; }
          .print-page-two-up:last-child { page-break-after: auto; }
          .print-page-two-up > div { height: 100%; display:flex; flex-direction:column; justify-content:space-between; }
          .receipt-compact { page-break-inside: avoid; }
        }
      `})]})}function m1(e,t="Aperçu convocations"){const r=document.getElementById(e);if(r)try{const n=r.innerHTML,i=new DOMParser().parseFromString(n,"text/html");i.querySelectorAll(".no-print, button").forEach(h=>h.remove());const s=i.body.innerHTML,f=`<!doctype html><html><head><meta charset="utf-8"/><title>${t}</title>
      <style>
        @page { size: A4 portrait; margin: 12mm; }
        :root { --page-height: 297mm; --print-margin: 12mm; }
        html,body { height: 100%; }
        body { font-family: 'Times New Roman', Times, serif; color: #111827; padding: 0; margin: 0; background: #ffffff; }
        .receipt-wrapper { width: 210mm; margin: 0 auto; padding: 0; box-sizing: border-box; }
        .convocations-wrapper { display: block; box-sizing: border-box; }
  .convocation { box-sizing: border-box; height: 65mm; padding: 6mm; overflow: visible; position: relative; }
        .convocation + .convocation { border-top: 1px dashed #444; margin-top: 4mm; padding-top: 4mm; }
        .convocation + .convocation::before { content: '\\2702'; position: absolute; top: -9mm; left: 50%; transform: translateX(-50%); background: white; padding: 0 3px; color: #444; font-size: 10px; }
  .convocation { break-inside: avoid; }
  /* ensure important / deadline markers render even when global CSS isn't loaded */
  .print-important { color: #b91c1c !important; font-weight: 800 !important; }
  .print-deadline { color: #7f1d1d !important; font-weight: 700 !important; font-size: 1.0rem !important; display: block; margin-top: 6px; }
        .convocation:nth-child(4n) { page-break-after: always; }
      </style>
    </head><body><div class="receipt-wrapper print-four-per-page">${s}</div></body></html>`,d=window.open("","_blank");if(!d)return;d.document.open(),d.document.write(f),d.document.close(),d.focus(),setTimeout(()=>{try{d.print()}catch{}},300)}catch{const a=document.getElementById(e);if(!a)return;const i=window.open("","_blank");if(!i)return;i.document.open(),i.document.write("<html><head><title>"+t+"</title></head><body>"+a.innerHTML+"</body></html>"),i.document.close(),i.print()}}function woe({eleve:e,echeances:t,totalDue:r,classe:n,anneeScolaire:a}){return o.jsxs("div",{className:"p-6 print:page-break-after-always",children:[o.jsxs("div",{className:"flex justify-end mb-4 space-x-2",children:[o.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded-md text-sm",onClick:()=>{const i=document.getElementById("convocation-print-area");i&&(i.classList.contains("print-five-per-page")&&i.classList.remove("print-five-per-page"),m1("convocation-print-area",`convocation_${e.matricule||"unknown"}`))},children:"Exporter PDF"}),o.jsx("button",{className:"px-3 py-1 bg-gray-700 text-white rounded-md text-sm",onClick:()=>{const i=document.getElementById("convocation-print-area");i&&(i.classList.add("print-four-per-page"),m1("convocation-print-area",`convocation_${e.matricule||"unknown"}_4up`),setTimeout(()=>i.classList.remove("print-four-per-page"),500))},children:"Exporter (4/pg)"})]}),o.jsxs("div",{id:"convocation-print-area",className:"mx-auto bg-white text-black p-6 shadow-lg border border-gray-200 max-w-[800px] convocation",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("div",{className:"flex items-center space-x-4",children:(()=>{const i=pe.getAll("ecole")[0],s=zo("recu"),l=i?.logo||s?.logo||"",f=i?.nom||s?.header||"Votre École";return o.jsxs(o.Fragment,{children:[l?o.jsx("img",{src:l,alt:"Logo",className:"w-20 h-20 object-contain rounded-md"}):o.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-md flex items-center justify-center text-sm font-semibold text-gray-600",children:"Logo"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-gray-600",children:"École"}),o.jsx("div",{className:"text-xl font-bold",children:f}),o.jsxs("div",{className:"text-sm text-gray-500",children:["Année scolaire ",a||""]})]})]})})()}),o.jsxs("div",{className:"text-right text-sm",children:[o.jsx("div",{className:"font-medium",children:"Convocation de paiement"}),o.jsxs("div",{className:"text-gray-500",children:["Imprimé le ",new Date().toLocaleDateString("fr-FR")]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6 text-sm",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500",children:"Élève"}),o.jsx("div",{className:"font-semibold text-lg",children:yt(e)}),o.jsxs("div",{className:"text-sm text-gray-600",children:["Matricule : ",e.matricule||"-"]}),o.jsxs("div",{className:"text-sm text-gray-600",children:["Tél parent : ",e.pereTuteur||e.telephone||e.mereTutrice||"-"]})]}),o.jsxs("div",{className:"text-sm",children:[o.jsx("div",{className:"text-xs text-gray-500",children:"Classe"}),o.jsx("div",{className:"font-semibold",children:n?`${n.niveau} ${n.section||""}`:"-"}),o.jsxs("div",{className:"mt-2",children:["Année : ",o.jsx("span",{className:"font-medium",children:a||"-"})]})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-3 text-base",children:"Modalités impayées"}),o.jsx("div",{className:"overflow-hidden border rounded-md",children:o.jsxs("table",{className:"min-w-full text-sm",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-4 py-3",children:"Modalité"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Période"}),o.jsx("th",{className:"text-right px-4 py-3",children:"Attendu"}),o.jsx("th",{className:"text-right px-4 py-3",children:"Payé"}),o.jsx("th",{className:"text-right px-4 py-3",children:"Reste"})]})}),o.jsx("tbody",{children:t.map((i,s)=>o.jsxs("tr",{className:s%2===0?"bg-white":"bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3",children:i.modalite}),o.jsx("td",{className:"px-4 py-3",children:i.date||"-"}),o.jsxs("td",{className:"px-4 py-3 text-right",children:[(i.attendu||0).toLocaleString("fr-FR")," FCFA"]}),o.jsxs("td",{className:"px-4 py-3 text-right text-green-700",children:[(i.paye||0).toLocaleString("fr-FR")," FCFA"]}),o.jsxs("td",{className:"px-4 py-3 text-right text-red-700 font-medium",children:[(i.reste||0).toLocaleString("fr-FR")," FCFA"]})]},i.modalite))})]})})]}),o.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[o.jsxs("div",{className:"text-sm text-gray-700 print-important",children:[o.jsx("strong",{className:"text-red-800 text-base",children:"IMPORTANT :"}),o.jsx("div",{className:"mt-1 font-semibold text-red-700",children:"Veuillez régler le montant dû dans les plus brefs délais — sans régularisation, l'élève risque de ne pas être accepté dans l'école."})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Montant total dû"}),o.jsxs("div",{className:"text-2xl font-bold text-red-700",children:[r.toLocaleString("fr-FR")," FCFA"]})]})]}),o.jsx("div",{className:"mt-4 text-sm text-right text-gray-600",children:(()=>{try{const i=new Date,s=new Date(i.getFullYear(),i.getMonth(),i.getDate()),l=12,f=t.filter(d=>{if(!d.date)return!1;const h=new Date(d.date),m=Math.ceil((h.getTime()-s.getTime())/(1e3*60*60*24));return m>0&&m<=l}).sort((d,h)=>new Date(d.date).getTime()-new Date(h.date).getTime());if(f.length>0){const h=new Date(f[0].date).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),m=h.charAt(0).toUpperCase()+h.slice(1);return o.jsxs("div",{className:"print-deadline",children:[o.jsx("div",{className:"text-sm text-gray-700",children:"Date limite de paiement :"}),o.jsx("div",{className:"font-bold text-red-800",children:m})]})}else return o.jsxs("div",{className:"print-deadline",children:[o.jsx("div",{className:"text-sm text-gray-700",children:"Date limite de paiement :"}),o.jsx("div",{className:"font-bold text-red-800",children:"Dès que possible"})]})}catch{return null}})()}),o.jsx("div",{className:"mt-8 text-sm",children:o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:"Signature responsable"}),o.jsx("div",{className:"mt-6 border-t w-48"})]}),o.jsx("div",{className:"text-right text-xs text-gray-500",children:"Pour toute information : contactez l'administration"})]})})]})]})}function C0({progress:e,color:t="bg-blue-500",size:r="md",showPercentage:n=!1,className:a=""}){const i={sm:"h-1",md:"h-2",lg:"h-3"},s=Math.max(0,Math.min(100,e));return o.jsxs("div",{className:`w-full bg-gray-200 rounded-full ${i[r]} ${a}`,children:[o.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${t}`,style:{width:`${s}%`}}),n&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1 text-center",children:[Math.round(s),"%"]})]})}function Soe({eleve:e,onBack:t}){const{showToast:r}=Xr(),[n,a]=j.useState([]),[i,s]=j.useState([]),[l,f]=j.useState(""),[d,h]=j.useState(!1),[m,x]=j.useState(!1),[v,y]=j.useState(null),[g,b]=j.useState(!1),[N,_]=j.useState(""),S=j.useRef({selectedEcheances:[],montantReglement:""}),C=n.length>0||l&&l.trim()!=="",T=Bf(!!C),k=`elevePayment:${e.id}`,{load:P,clear:D}=$f(k,{selectedEcheances:n,montantReglement:l});j.useEffect(()=>{try{const L=P();L&&(a(L.selectedEcheances||[]),f(L.montantReglement||""),S.current=L)}catch{}},[]);const R=pe.getById("classes",e.classeId),G=la.getSituationEcheances(e.id),M=!!e?.protege,H=R?pe.getById("enseignants",R.enseignantPrincipal):null,z=pe.getAll("paiements").filter(L=>L.eleveId===e.id&&!L.canceled),ne=j.useMemo(()=>{if(!G)return{totalDu:0,totalPaye:0,totalRestant:0,echeancesEchues:0};if(!M)return{totalDu:G.totalDu||0,totalPaye:G.totalPaye||0,totalRestant:G.totalRestant||0,echeancesEchues:(G.echeancesEchues||[]).length};const L=(G.echeances||[]).filter(X=>X.modalite===1),V=L.reduce((X,de)=>X+(de.montant||0),0),se=L.reduce((X,de)=>X+(de.montantPaye||0),0),U=L.reduce((X,de)=>X+(de.montantRestant||0),0),W=L.filter(X=>X.isEchue).length;return{totalDu:V,totalPaye:se,totalRestant:U,echeancesEchues:W}},[G,M]),Q=j.useMemo(()=>G?G.echeances.filter(V=>n.includes(V.echeanceId)&&(!M||V.modalite===1)).reduce((V,se)=>V+se.montantRestant,0):0,[n,G]),le=(L,V)=>{if(M&&G){const se=G.echeances.find(U=>U.echeanceId===L);if(se&&se.modalite!==1)return}a(se=>V?[...se,L]:se.filter(U=>U!==L))},ue=L=>{if(G)if(L){const V=G.echeances.filter(se=>se.montantRestant>0&&(!M||se.modalite===1)).map(se=>se.echeanceId);a(V)}else a([])},fe=(L,V)=>{s(se=>V?[...se,L]:se.filter(U=>U!==L))},K=L=>{if(L){const V=z.filter(se=>!se.canceled).map(se=>se.id);s(V)}else s([])},me=async(L="Espèces")=>{if(n.length===0){r("Sélectionnez au moins une échéance à régler","error");return}const V=l&&l.trim()!==""?Number(l):void 0,se=V!==void 0?V:Q;if(!Number.isFinite(se)||se<=0){r("Montant invalide","error");return}if(se>Q){r("Le montant ne peut pas dépasser le total sélectionné","error");return}try{const U=Lh(),W=U?`${U.prenoms} ${U.nom}`:"ADMIN",X="REC"+Date.now().toString().slice(-8);await la.processPaymentIntelligent(e.id,se,new Date().toISOString(),{typeFrais:"scolarite",modePaiement:L,numeroRecu:X,operateur:W,notes:`Règlement de ${n.length} échéance(s) - ${L}`,selectedEcheances:n}),pe.addHistorique({type:"paiement",cible:"Paiement",description:`Paiement de ${Q.toLocaleString("fr-FR")} FCFA pour ${yt(e)} (${X})`,utilisateur:W}),r(`Paiement de ${Q.toLocaleString("fr-FR")} FCFA enregistré avec succès`,"success"),a([]);try{D()}catch{}setTimeout(()=>{},800)}catch(U){console.error("Erreur paiement:",U);const W=U&&U.message?U.message:"Erreur lors de l'enregistrement du paiement";r(W,"error")}},J=L=>{y(L),h(!0)},O=()=>{if(i.length===0){r("Sélectionnez au moins un paiement","error");return}x(!0)},ae=L=>L.montantRestant===0?"bg-green-50 text-green-700 border-green-300":L.isEchue?"bg-red-50 text-red-700 border-red-300":"bg-yellow-50 text-yellow-700 border-yellow-300",ee=L=>L.montantRestant===0?o.jsx(Oa,{className:"h-4 w-4"}):L.isEchue?o.jsx(ti,{className:"h-4 w-4"}):o.jsx(I0,{className:"h-4 w-4"});return G?o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-white border border-gray-200 p-6 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs(ht,{variant:"ghost",onClick:()=>C&&T?T.openPrompt():t(),className:"flex items-center space-x-2",children:[o.jsx(D0,{className:"h-4 w-4"}),o.jsx("span",{className:"font-medium",children:"Retour aux finances"})]}),o.jsx("div",{className:"h-6 w-px bg-gray-300"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:yt(e)}),o.jsxs("p",{className:"text-gray-600",children:[R?`${R.niveau} ${R.section}`:"Classe non assignée"," • ",e.matricule]}),M&&H&&o.jsxs("div",{className:"mt-1 text-sm text-gray-700",children:["Garant: ",yt(H)," • ",o.jsx("span",{className:"text-xs text-gray-500",children:"Enseignant principal"})]})]})]}),o.jsxs("div",{className:"mt-4 text-right bg-gray-50 border border-gray-200 rounded-md p-4",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Reste à payer"}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[ne.totalRestant.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["sur ",ne.totalDu.toLocaleString("fr-FR")," FCFA"]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 text-center",children:[o.jsx("div",{className:"bg-gray-100 rounded-full p-3 w-12 h-12 mx-auto mb-3 flex items-center justify-center",children:o.jsx(gi,{className:"h-6 w-6 text-gray-600"})}),o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ne.totalDu.toLocaleString("fr-FR")}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Total dû (FCFA)"})]}),o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 text-center",children:[o.jsx("div",{className:"bg-gray-100 rounded-full p-3 w-12 h-12 mx-auto mb-3 flex items-center justify-center",children:o.jsx(Oa,{className:"h-6 w-6 text-gray-600"})}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:ne.totalPaye.toLocaleString("fr-FR")}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Total payé (FCFA)"})]}),o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 text-center",children:[o.jsx("div",{className:"bg-gray-100 rounded-full p-3 w-12 h-12 mx-auto mb-3 flex items-center justify-center",children:o.jsx(ti,{className:"h-6 w-6 text-gray-600"})}),o.jsx("div",{className:"text-2xl font-bold text-red-600",children:ne.totalRestant.toLocaleString("fr-FR")}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Reste à payer (FCFA)"})]}),o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 text-center",children:[o.jsx("div",{className:"bg-gray-100 rounded-full p-3 w-12 h-12 mx-auto mb-3 flex items-center justify-center",children:o.jsx(I0,{className:"h-6 w-6 text-gray-600"})}),o.jsx("div",{className:"text-2xl font-bold text-orange-600",children:ne.echeancesEchues}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Échéances échues"})]})]}),o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Échéances de paiement"}),o.jsxs("div",{className:"flex items-center space-x-4",children:[n.length>0&&o.jsxs("div",{className:"text-sm text-gray-700 bg-gray-100 px-3 py-1 rounded-md border border-gray-200",children:[n.length," sélectionnée(s) • ",Q.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",checked:n.length===G.echeances.filter(L=>L.montantRestant>0).length,onChange:L=>ue(L.target.checked),className:"w-4 h-4 text-gray-900 border-gray-300 rounded focus:ring-gray-500"}),o.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Tout sélectionner"})]})]})]})}),o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"space-y-3",children:G.echeances.filter(L=>!M||L.modalite===1).map(L=>o.jsx("div",{className:`border rounded-md p-4 transition-all ${n.includes(L.echeanceId)?"border-gray-900 bg-gray-50":ae(L)}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[L.montantRestant>0&&o.jsx("input",{type:"checkbox",checked:n.includes(L.echeanceId),onChange:V=>le(L.echeanceId,V.target.checked),className:"w-4 h-4 text-gray-900 border-gray-300 rounded focus:ring-gray-500",disabled:M&&L.modalite!==1}),o.jsxs("div",{className:"flex items-center space-x-3",children:[ee(L),o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-gray-900",children:["Modalité ",L.modalite," - ",L.label]}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Échéance : ",new Date(L.date).toLocaleDateString("fr-FR"),L.isEchue&&L.joursRetard>0&&o.jsxs("span",{className:"ml-2 text-red-600 font-medium",children:["(En retard de ",L.joursRetard," jour",L.joursRetard>1?"s":"",")"]})]})]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[L.montant.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("div",{className:"text-sm text-gray-600",children:["Payé : ",L.montantPaye.toLocaleString("fr-FR")," FCFA"]}),L.montantRestant>0&&o.jsxs("div",{className:"text-sm font-medium text-red-600",children:["Reste : ",L.montantRestant.toLocaleString("fr-FR")," FCFA"]})]})]})},L.echeanceId))}),n.length>0&&o.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-md border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-gray-900",children:["Règlement de ",n.length," échéance",n.length>1?"s":""]}),o.jsxs("p",{className:"text-gray-700",children:["Montant total : ",Q.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("div",{className:"mt-2",children:[o.jsx("label",{className:"text-sm text-gray-700",children:"Montant à régler (FCFA)"}),o.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[o.jsx("input",{type:"number",value:l,onChange:L=>f(L.target.value),placeholder:String(Q),className:"px-3 py-2 border border-gray-300 rounded-md w-40"}),o.jsx("button",{className:"px-3 py-2 bg-gray-100 rounded-md text-sm",onClick:()=>f(String(Q)),children:"Utiliser le total"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Pour les protégés, l'inscription doit être réglée en totalité; la validation côté gestionnaire le vérifiera."})]})]}),o.jsxs("div",{className:"flex space-x-3 items-center",children:[M&&o.jsx("div",{className:"text-sm text-gray-600 mr-4",children:"Protégé : seules les échéances d'inscription sont payables."}),o.jsxs(ht,{variant:"primary",onClick:()=>me("Espèces"),className:"flex items-center space-x-2",children:["💵 ",o.jsx("span",{children:"Espèces"})]}),o.jsxs(ht,{variant:"primary",onClick:()=>me("Mobile Money"),className:"flex items-center space-x-2",children:["📱 ",o.jsx("span",{children:"Mobile"})]}),o.jsxs(ht,{variant:"secondary",onClick:()=>me("Chèque"),className:"flex items-center space-x-2",children:[o.jsx(g5,{className:"h-4 w-4"}),o.jsx("span",{children:"Chèque"})]})]})]})})]})]}),o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Historique des paiements"}),o.jsxs("div",{className:"flex items-center space-x-4",children:[i.length>0&&o.jsxs("div",{className:"text-sm text-gray-700 bg-gray-100 px-3 py-1 rounded-md border border-gray-200",children:[i.length," sélectionné",i.length>1?"s":""]}),o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",checked:i.length===z.length&&z.length>0,onChange:L=>K(L.target.checked),className:"w-4 h-4 text-gray-900 border-gray-300 rounded focus:ring-gray-500"}),o.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Tout sélectionner"})]})]})]})}),o.jsxs("div",{className:"p-6",children:[z.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(j5,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-500",children:"Aucun paiement enregistré"}),o.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Les paiements apparaîtront ici une fois effectués"})]}):o.jsx("div",{className:"space-y-3",children:z.map(L=>o.jsx("div",{className:`border rounded-md p-4 transition-all ${i.includes(L.id)?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-300"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[L.canceled?o.jsx("div",{className:"text-sm text-red-600 font-semibold",children:"Annulé"}):o.jsx("input",{type:"checkbox",checked:i.includes(L.id),onChange:V=>fe(L.id,V.target.checked),className:"w-4 h-4 text-gray-900 border-gray-300 rounded focus:ring-gray-500"}),o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-gray-900",children:[L.montant.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(L.datePaiement||L.createdAt).toLocaleDateString("fr-FR")," •",L.modePaiement||"Espèces"," • Reçu : ",L.numeroRecu||"N/A"]}),L.notes&&o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:L.notes})]})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs("button",{onClick:()=>J(L),disabled:L.canceled,className:`flex items-center space-x-2 px-4 py-2 rounded-md transition-colors font-medium ${L.canceled?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:[o.jsx(wf,{className:"h-4 w-4"}),o.jsx("span",{children:"Reçu"})]})})]})},L.id))}),i.length>0&&o.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-md border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-gray-900",children:["Actions sur ",i.length," paiement",i.length>1?"s":""]}),o.jsxs("p",{className:"text-gray-700 text-sm mt-1",children:["Montant total : ",i.reduce((L,V)=>{const se=z.find(U=>U.id===V);return L+(se?.montant||0)},0).toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsxs("button",{onClick:O,className:"flex items-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition-colors font-medium",children:[o.jsx(g1,{className:"h-4 w-4"}),o.jsx("span",{children:"Reçu combiné"})]}),o.jsx("button",{onClick:()=>{i.length!==0&&(_(""),b(!0))},className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors font-medium",children:o.jsx("span",{children:"Annuler"})})]})]})})]})]}),d&&v&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsx(lw,{eleve:{nom:e.nom,prenoms:e.prenoms,matricule:e.matricule,classe:R?`${R.niveau} ${R.section}`:""},montantRegle:v.montant,date:v.datePaiement||v.createdAt,mode:v.modePaiement||"Espèces",cumulReglement:ne.totalPaye,resteAPayer:ne.totalRestant,anneeScolaire:R?.anneeScolaire||"",operateur:v.operateur||"ADMIN",numeroRecu:v.numeroRecu||"REC"+Date.now().toString().slice(-8)}),o.jsx("div",{className:"p-4 border-t border-gray-200 flex justify-end",children:o.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"Fermer"})})]})}),m&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsx(g6,{eleve:e,paiements:z.filter(L=>i.includes(L.id)),classe:R,anneeScolaire:R?.anneeScolaire,totalAttendu:ne.totalDu}),o.jsx("div",{className:"p-4 border-t border-gray-200 flex justify-end",children:o.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"Fermer"})})]})}),g&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-xl w-full mx-4",children:[o.jsxs("div",{className:"p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Annuler ",i.length," paiement",i.length>1?"s":""]}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Veuillez indiquer la raison de l'annulation. Cette note sera enregistrée dans l'historique."}),o.jsx("textarea",{value:N,onChange:L=>_(L.target.value),rows:4,className:"w-full border border-gray-300 rounded p-2",placeholder:"Motif d'annulation (ex: erreur saisie, doublon, remboursement en attente)..."})]}),o.jsxs("div",{className:"p-4 border-t border-gray-200 flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md",children:"Annuler"}),o.jsx("button",{onClick:async()=>{try{for(const L of i)try{la.cancelPayment(L,N||void 0)}catch(V){console.debug("cancel failed",V)}r("Paiement(s) annulé(s)","success"),s([]),b(!1),setTimeout(()=>{},600)}catch(L){console.error(L),r("Erreur lors de l'annulation","error")}},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Confirmer l'annulation"})]})]})}),T&&o.jsx(gc,{open:T.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardées. Voulez-vous quitter sans enregistrer ?",onConfirm:()=>{try{D()}catch{}const L=window;try{L.__preventReDispatch=!0}catch{}try{T.allowNavigation?T.allowNavigation():t()}finally{setTimeout(()=>{try{L.__preventReDispatch=!1}catch{}},80)}},onCancel:()=>T.closePrompt&&T.closePrompt()})]}):o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"flex items-center space-x-4 mb-6",children:o.jsxs(ht,{variant:"ghost",onClick:()=>C&&T?T.openPrompt():t(),className:"flex items-center space-x-2",children:[o.jsx(D0,{className:"h-4 w-4"}),o.jsx("span",{children:"Retour"})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:o.jsx("p",{className:"text-gray-500",children:"Aucune configuration de frais trouvée pour cet élève"})})]})}const Noe=()=>{const e=pe.getAll("eleves"),t=pe.getAll("paiements").filter(a=>!a.canceled),r=pe.getAll("fraisScolaires"),n=pe.getAll("classes");return{eleves:e,paiements:t,fraisScolaires:r,classes:n}},p1=12,A0=e=>new Intl.NumberFormat("fr-FR").format(e)+" FCFA",Eoe=e=>({Payé:"bg-green-100 text-green-800",Partiel:"bg-orange-100 text-orange-800",Impayé:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800",_oe=({alertes:e})=>{const[t,r]=j.useState(!1);return!e||e.echeancesImpayees.length===0?null:o.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"font-semibold text-yellow-900",children:"Alertes d'Échéances Impayées"}),o.jsx("button",{onClick:()=>r(!t),className:"text-yellow-700 hover:bg-yellow-100 px-3 py-1 rounded-md transition-colors text-sm",children:t?"Masquer":"Voir Détails"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:o.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-md p-3",children:[o.jsx("div",{className:"font-semibold text-orange-900",children:"Échéances à Convocation"}),o.jsxs("div",{className:"text-orange-700",children:[e.echeancesImpayees.length," élève(s) nécessitant une convocation dans ",p1," jours"]})]})}),t&&o.jsx("div",{className:"mt-4 space-y-3",children:e.echeancesImpayees.slice(0,5).map(n=>o.jsxs("div",{className:"text-orange-700",children:[yt(n.eleve)," - ",n.totalDu.toLocaleString("fr-FR")," FCFA"]},n.eleve.id))})]})},koe=({searchTerm:e,filterClasse:t,filterStatut:r,classes:n,onSearchChange:a,onClasseChange:i,onStatutChange:s,onPrint:l,onPrintConvocations:f})=>o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200 mt-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{value:e,onChange:d=>a(d.target.value),placeholder:"Rechercher un élève...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md"})]}),o.jsxs("select",{value:t,onChange:d=>i(d.target.value),className:"px-4 py-2 border border-gray-300 rounded-md",children:[o.jsx("option",{value:"",children:"Toutes les classes"}),n.map(d=>o.jsxs("option",{value:d.id,children:[d.niveau," ",d.section]},d.id))]}),o.jsxs("select",{value:r,onChange:d=>s(d.target.value),className:"px-4 py-2 border border-gray-300 rounded-md",children:[o.jsx("option",{value:"",children:"Tous les statuts"}),o.jsx("option",{value:"Payé",children:"Payé"}),o.jsx("option",{value:"Partiel",children:"Partiel"}),o.jsx("option",{value:"Impayé",children:"Impayé"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs(ht,{variant:"ghost",onClick:l,children:[o.jsx(wf,{className:"h-4 w-4"}),o.jsx("span",{children:"Imprimer Liste"})]}),typeof f=="function"&&o.jsxs(ht,{variant:"ghost",onClick:f,children:[o.jsx(ti,{className:"h-4 w-4 text-red-600"}),o.jsx("span",{children:"Convocations"})]})]})]})}),cv=({isOpen:e,onClose:t,children:r,maxWidth:n="2xl"})=>{if(!e)return null;const a={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","4xl":"max-w-4xl"};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:`bg-white rounded-2xl shadow-2xl ${a[n]} w-full mx-4 max-h-[90vh] overflow-y-auto`,children:[r,o.jsx("div",{className:"p-4 border-t border-gray-200 flex justify-end",children:o.jsx("button",{onClick:t,className:"px-6 py-2 bg-gray-100 rounded-lg",children:"Fermer"})})]})})};function joe(){const{showToast:e}=Xr(),[t,r]=j.useState(""),[n,a]=j.useState(""),[i,s]=j.useState(""),[l,f]=j.useState({paymentForm:!1,recu:!1,combinedRecu:!1,convocation:!1,elevePaymentPage:!1}),[d,h]=j.useState(null),[m,x]=j.useState(null),{eleves:v,paiements:y,classes:g}=Noe(),b=j.useMemo(()=>v.map(z=>{try{const ne=la.getSituationEcheances(z.id),Q=g.find(K=>K.id===z.classeId),le=y.filter(K=>K.eleveId===z.id&&!K.canceled),ue=le.length?le[le.length-1]:null;if(ne){const K=Number(ne.totalDu||0),me=Number(ne.totalPaye||0),J=Number(ne.totalRestant??K-me),O=K>0&&me>=K?"Payé":me>0?"Partiel":"Impayé";return{eleve:z,classe:Q,totalDu:K,totalPaye:me,solde:J,statut:O,paiementsEleve:le,dernierPaiement:ue,situationEcheances:ne}}const fe=le.reduce((K,me)=>K+(me.montant||0),0);return{eleve:z,classe:Q,totalDu:0,totalPaye:fe,solde:-fe,statut:fe>0?"Partiel":"Impayé",paiementsEleve:le,dernierPaiement:ue,situationEcheances:null}}catch{const Q=g.find(K=>K.id===z.classeId),le=y.filter(K=>K.eleveId===z.id&&!K.canceled),ue=le.length?le[le.length-1]:null,fe=le.reduce((K,me)=>K+(me.montant||0),0);return{eleve:z,classe:Q,totalDu:0,totalPaye:fe,solde:-fe,statut:fe>0?"Partiel":"Impayé",paiementsEleve:le,dernierPaiement:ue,situationEcheances:null}}}),[v,y,g]),N=j.useMemo(()=>la.getAlertesEcheances(p1),[]);j.useEffect(()=>{const z=()=>{};return window.addEventListener("dataChanged",z),()=>window.removeEventListener("dataChanged",z)},[]);const _=j.useCallback(z=>f(ne=>({...ne,[z]:!0})),[]),S=j.useCallback(z=>f(ne=>({...ne,[z]:!1})),[]),C=j.useMemo(()=>{let z=[...b];if(t){const ne=t.toLowerCase();z=z.filter(Q=>Q.eleve.nom.toLowerCase().includes(ne)||Q.eleve.prenoms.toLowerCase().includes(ne)||Q.eleve.matricule.toLowerCase().includes(ne))}return n&&(z=z.filter(ne=>ne.eleve.classeId===n)),i&&(z=z.filter(ne=>ne.statut===i)),z.sort((ne,Q)=>ne.eleve.nom.localeCompare(Q.eleve.nom))},[b,t,n,i]),T=j.useMemo(()=>({totalRecettes:y.reduce((z,ne)=>z+(ne.montant||0),0),elevesPayes:b.filter(z=>z.statut==="Payé").length,elevesPartiels:b.filter(z=>z.statut==="Partiel").length,elevesImpayes:b.filter(z=>z.statut==="Impayé").length,totalSolde:b.reduce((z,ne)=>z+ne.solde,0)}),[y,b]),k=j.useCallback((z,ne,Q,le,ue)=>{if(S("paymentForm"),ue){x(ue);const fe=v.find(K=>K.id===z);fe&&(h(fe),_("recu"))}e("Paiement enregistré avec succès","success"),setTimeout(()=>{},800)},[v,e,S,_]),P=j.useCallback(z=>{h(z),_("elevePaymentPage")},[_]),D=j.useCallback(()=>{S("elevePaymentPage"),h(null),setTimeout(()=>{},100)},[S]),R=j.useCallback(z=>{const ne=b.find(Q=>Q.eleve.id===z.id);if(!ne||!ne.dernierPaiement){e("Aucun paiement trouvé pour cet élève","error");return}h(z),x(ne.dernierPaiement),_("recu")},[b,e,_]),G=j.useCallback(z=>{const ne=b.find(Q=>Q.eleve.id===z.id);if(!ne||ne.paiementsEleve.length===0){e("Aucun paiement trouvé pour cet élève","error");return}h(z),_("combinedRecu")},[b,e,_]),M=j.useCallback(()=>{try{const z=la.generateConvocations(p1);if(!z||z.length===0){e("Aucune convocation à générer","info");return}const ne=document.getElementById("finances-print-area");if(!ne){e("Zone d'impression introuvable","error");return}const Q=zo("recu"),le=pe.getAll("ecole")[0]||{},ue=le&&le.logo||Q&&Q.logo||"",fe=me=>{try{const J=new Date,O=new Date(J.getFullYear(),J.getMonth(),J.getDate()),ae=12,ee=(me.echeancesEchues||[]).filter(L=>{if(!L.date)return!1;const V=new Date(L.date),se=Math.ceil((V.getTime()-O.getTime())/(1e3*60*60*24));return se>0&&se<=ae}).sort((L,V)=>new Date(L.date).getTime()-new Date(V.date).getTime());if(ee.length>0){const V=new Date(ee[0].date).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"});return`<div class="print-deadline" style="margin-top:8px;"><div>Date limite de paiement :</div><div style="font-weight:700;color:#b91c1c;margin-top:4px;">${V.charAt(0).toUpperCase()+V.slice(1)}</div></div>`}else return'<div class="print-deadline" style="margin-top:8px;"><div>Date limite de paiement :</div><div style="font-weight:700;color:#b91c1c;margin-top:4px;">Dès que possible</div></div>'}catch{return""}},K=z.map(me=>{const J=me.eleve,O=me.classe||{},ae=J.pereTuteur||J.telephone||J.mereTutrice||"-",ee=(me.echeancesEchues||[]).map(L=>`${L.modalite===1?"Inscription":`Versement ${L.modalite}`} — ${Number(L.montantRestant||0).toLocaleString("fr-FR")} FCFA — échéance ${new Date(L.date).toLocaleDateString("fr-FR")}`);return`
          <div class="convocation" style="margin-bottom:8mm;">
            <div style="font-family: 'Times New Roman', Times, serif; font-size:12px; color:#111827;">
              <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                <div style="display:flex; align-items:center; gap:10px;">
                  ${ue?`<img src="${ue}" alt="logo" style="height:48px; width:auto; object-fit:contain;"/>`:'<div style="width:48px;height:48px;background:#f3f4f6;display:flex;align-items:center;justify-content:center;color:#6b7280;font-size:11px;border-radius:6px">Logo</div>'}
                  <div>
                    <div style="font-weight:700; font-size:13px;">${le.nom||Q.header||"École"}</div>
                    <div style="font-size:11px; color:#374151;">Année: ${me.anneeScolaire||""}</div>
                  </div>
                </div>
                <div style="text-align:right; font-size:11px; color:#374151;">Convocation de paiement<br/>Imprimé le ${new Date().toLocaleDateString("fr-FR")}</div>
              </div>

              <div style="display:flex; justify-content:space-between; margin-bottom:8px;">
                  <div>
                    <div style="font-weight:600">Élève</div>
                    <div>${yt(J)}</div>
                    <div style="font-size:11px; color:#6b7280">Matricule: ${J.matricule||"-"}</div>
                    <div style="font-size:11px; color:#6b7280">Tél parent: ${ae}</div>
                  </div>
                <div style="text-align:right">
                  <div style="font-weight:600">Classe</div>
                  <div>${O.niveau||"-"} ${O.section||""}</div>
                </div>
              </div>

              <div style="margin-bottom:6px; font-weight:600">Montant dû: ${(me.totalDu||0).toLocaleString("fr-FR")} FCFA</div>
              <div style="font-size:11px; color:#374151;">${ee.length?'<ul style="margin:0;padding-left:18px;">'+ee.map(L=>`<li>${L}</li>`).join("")+"</ul>":"<div>Aucune échéance impayée.</div>"}</div>
              <div style="margin-top:8px; font-size:12px; color:#111827;">
                <div class="print-important" style="font-weight:800; color:#b91c1c;">IMPORTANT :</div>
                <div style="margin-top:4px; font-weight:600; color:#b91c1c">Veuillez régler le montant dû dans les plus brefs délais — sans régularisation, l'élève risque de ne pas être accepté dans l'école.</div>
                ${fe(me)}
              </div>
            </div>
          </div>
        `}).join(`
`);ne.classList.add("print-four-per-page"),ne.innerHTML=`<div class="convocations-wrapper">${K}</div>`,m1("finances-print-area","Convocations"),setTimeout(()=>{ne.classList.remove("print-four-per-page"),ne.innerHTML=""},800)}catch(z){console.error(z),e("Erreur lors de la génération des convocations","error")}},[e]),H=j.useCallback(()=>{try{const z=document.getElementById("finances-print-area");if(!z){e("Zone d'impression introuvable","error");return}const ne=zo("recu"),le=(pe.getAll("ecole")[0]||{}).nom||ne?.header||"École",ue=C.map(K=>{const me=K.eleve||{},J=me.pereTuteur||me.telephone||me.mereTutrice||"-",O=K.classe?`${K.classe.niveau||""} ${K.classe.section||""}`.trim():"-",ae=Number(K.totalPaye||0),ee=Number(K.totalDu||0),L=Number(K.solde||0),V=L<=0?"Soldé":"Non soldé";return`
          <tr>
            <td style="padding:8px;border:1px solid #e5e7eb">${yt(me)}</td>
            <td style="padding:8px;border:1px solid #e5e7eb">${J}</td>
            <td style="padding:8px;border:1px solid #e5e7eb">${O}</td>
            <td style="padding:8px;border:1px solid #e5e7eb;text-align:right">${ae.toLocaleString("fr-FR")} FCFA</td>
            <td style="padding:8px;border:1px solid #e5e7eb;text-align:right">${ee.toLocaleString("fr-FR")} FCFA</td>
            <td style="padding:8px;border:1px solid #e5e7eb;text-align:right">${L.toLocaleString("fr-FR")} FCFA</td>
            <td style="padding:8px;border:1px solid #e5e7eb;text-align:center">${V}</td>
          </tr>
        `}).join(`
`),fe=`
        <div style="font-family: 'Times New Roman', Times, serif; color:#111827; padding:8mm;">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
            <div style="font-weight:800;font-size:18px">${le}</div>
            <div style="text-align:right;font-size:12px;color:#6b7280">Liste des élèves — Imprimé le ${new Date().toLocaleDateString("fr-FR")}</div>
          </div>

          <table style="width:100%;border-collapse:collapse;font-size:12px;">
            <thead>
              <tr style="background:#f3f4f6;">
                <th style="text-align:left;padding:8px;border:1px solid #e5e7eb;color:#111827">Nom et Prénoms</th>
                <th style="text-align:left;padding:8px;border:1px solid #e5e7eb;color:#111827">Tél parent</th>
                <th style="text-align:left;padding:8px;border:1px solid #e5e7eb;color:#111827">Classe</th>
                <th style="text-align:right;padding:8px;border:1px solid #e5e7eb;color:#111827">Total payé</th>
                <th style="text-align:right;padding:8px;border:1px solid #e5e7eb;color:#111827">Total dû</th>
                <th style="text-align:right;padding:8px;border:1px solid #e5e7eb;color:#111827">Reste à payer</th>
                <th style="text-align:center;padding:8px;border:1px solid #e5e7eb;color:#111827">Solvabilité</th>
              </tr>
            </thead>
            <tbody>
              ${ue}
            </tbody>
          </table>

          <div style="margin-top:12px;font-size:11px;color:#6b7280">Total élèves listés: ${C.length}</div>
        </div>
      `;z.classList.add("print-list-page"),z.innerHTML=fe,wh("finances-print-area","Liste des élèves",!1),setTimeout(()=>{z.classList.remove("print-list-page"),z.innerHTML=""},900)}catch(z){console.error(z),e("Erreur lors de la préparation de l'impression","error")}},[C,e]);return l.elevePaymentPage&&d?o.jsx(Soe,{eleve:d,onBack:D}):o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-extrabold",children:"Gestion Financière"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Suivi des paiements et situations financières"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Total Recettes"}),o.jsxs("div",{className:"text-2xl font-extrabold text-gray-900",children:[T.totalRecettes.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-xs text-gray-400",children:"Cumul des paiements"})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Reste à encaisser"}),o.jsxs("div",{className:"text-2xl font-extrabold text-red-600",children:[T.totalSolde.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-xs text-gray-400",children:"Montant en attente"})]}),o.jsx("div",{className:"px-4 border-l",children:o.jsx(ht,{variant:"primary",onClick:()=>_("paymentForm"),leftIcon:o.jsx(Gi,{className:"h-5 w-5"}),children:"Paiement Rapide"})})]})]}),o.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-green-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-green-100 rounded-md",children:o.jsx(qi,{className:"text-green-700",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500",children:"Élèves Payés"}),o.jsxs("div",{className:"text-xs text-gray-400",children:[T.elevesPayes," élèves"]})]})]}),o.jsxs("div",{className:"text-sm font-bold",children:[o.jsxs("div",{className:"text-green-700",children:[Math.round(T.elevesPayes/(b.length||1)*100),"% des élèves"]}),o.jsx("div",{className:"mt-1",children:o.jsx(C0,{progress:Math.round(T.elevesPayes/(b.length||1)*100),color:"bg-green-500",size:"sm",showPercentage:!1})})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-orange-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-orange-100 rounded-md",children:o.jsx(Gu,{className:"text-orange-600",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500",children:"Paiements Partiels"}),o.jsxs("div",{className:"text-xs text-gray-400",children:[T.elevesPartiels," élèves"]})]})]}),o.jsxs("div",{className:"text-sm font-bold",children:[o.jsxs("div",{className:"text-orange-700",children:[Math.round(T.elevesPartiels/(b.length||1)*100),"% des élèves"]}),o.jsx("div",{className:"mt-1",children:o.jsx(C0,{progress:Math.round(T.elevesPartiels/(b.length||1)*100),color:"bg-orange-500",size:"sm",showPercentage:!1})})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-red-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-red-100 rounded-md",children:o.jsx(T5,{className:"text-red-700",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500",children:"Impayés"}),o.jsxs("div",{className:"text-xs text-gray-400",children:[T.elevesImpayes," élèves"]})]})]}),o.jsxs("div",{className:"text-sm font-bold",children:[o.jsxs("div",{className:"text-red-700",children:[Math.round(T.elevesImpayes/(b.length||1)*100),"% des élèves"]}),o.jsx("div",{className:"mt-1",children:o.jsx(C0,{progress:Math.round(T.elevesImpayes/(b.length||1)*100),color:"bg-red-500",size:"sm",showPercentage:!1})})]})]})]})]}),o.jsx(_oe,{alertes:N}),o.jsx(koe,{searchTerm:t,filterClasse:n,filterStatut:i,classes:g,onSearchChange:r,onClasseChange:a,onStatutChange:s,onPrint:H,onPrintConvocations:M}),o.jsx("div",{id:"finances-print-area",className:"hidden print:block bg-white p-4 mb-4 print-compact"}),o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden mt-4",children:[o.jsx("div",{className:"bg-gray-50 px-4 lg:px-6 py-3 lg:py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Situations Financières"}),o.jsxs("p",{className:"text-gray-600 text-sm lg:text-base",children:[C.length," élève(s) trouvé(s)"]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-2 lg:px-4 py-2 lg:py-3 text-left text-xs lg:text-sm font-semibold text-gray-900",children:"Élève"}),o.jsx("th",{className:"px-2 lg:px-4 py-2 lg:py-3 text-left text-xs lg:text-sm font-semibold text-gray-900 hidden sm:table-cell",children:"Classe"}),o.jsx("th",{className:"px-2 lg:px-4 py-2 lg:py-3 text-right text-xs lg:text-sm font-semibold text-gray-900",children:"Total Dû"}),o.jsx("th",{className:"px-2 lg:px-4 py-2 lg:py-3 text-right text-xs lg:text-sm font-semibold text-gray-900",children:"Total Payé"}),o.jsx("th",{className:"px-2 lg:px-4 py-2 lg:py-3 text-right text-xs lg:text-sm font-semibold text-gray-900",children:"Reste"}),o.jsx("th",{className:"px-2 lg:px-4 py-2 lg:py-3 text-center text-xs lg:text-sm font-semibold text-gray-900",children:"Statut"}),o.jsx("th",{className:"px-2 lg:px-4 py-2 lg:py-3 text-center text-xs lg:text-sm font-semibold text-gray-900",children:"Progression"}),o.jsx("th",{className:"px-2 lg:px-4 py-2 lg:py-3 text-center text-xs lg:text-sm font-semibold text-gray-900 hidden lg:table-cell",children:"Dernier Paiement"}),o.jsx("th",{className:"px-2 lg:px-4 py-2 lg:py-3 text-center text-xs lg:text-sm font-semibold text-gray-900",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:C.map(z=>{const ne=!!z.eleve?.protege;let Q=z.totalDu,le=z.totalPaye,ue=z.solde,fe=z.statut;if(ne&&z.situationEcheances&&Array.isArray(z.situationEcheances.echeances)){const K=z.situationEcheances.echeances.filter(ae=>ae.modalite===1),me=K.reduce((ae,ee)=>ae+(ee.montant||0),0),J=K.reduce((ae,ee)=>ae+(ee.montantPaye||0),0),O=K.reduce((ae,ee)=>ae+(ee.montantRestant||0),0);Q=me,le=J,ue=O,Q>0&&(fe=ue<=0?"Payé":le>0?"Partiel":"Impayé")}return o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-2 lg:px-4 py-3 lg:py-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[z.eleve.photo&&o.jsx("img",{src:z.eleve.photo,alt:yt(z.eleve),className:"h-8 w-8 lg:h-10 lg:w-10 rounded-full object-cover border-2 border-gray-200"}),o.jsxs("div",{className:"cursor-pointer hover:text-teal-600 transition-colors",onClick:()=>P(z.eleve),title:"Cliquer pour ouvrir la page de paiement",children:[o.jsx("div",{className:"text-xs lg:text-sm font-semibold text-gray-900",children:yt(z.eleve)}),o.jsx("div",{className:"text-xs text-gray-500 font-mono hidden sm:block",children:z.eleve.matricule}),o.jsx("div",{className:"text-xs text-gray-500 sm:hidden",children:z.classe?`${z.classe.niveau} ${z.classe.section}`:"Non assigné"})]})]})}),o.jsx("td",{className:"px-2 lg:px-4 py-3 lg:py-4 text-xs lg:text-sm text-gray-700 font-medium hidden sm:table-cell",children:z.classe?`${z.classe.niveau} ${z.classe.section}`:"Non assigné"}),o.jsx("td",{className:"px-2 lg:px-4 py-3 lg:py-4 text-xs lg:text-sm text-gray-900 text-right font-bold",children:A0(Q)}),o.jsx("td",{className:"px-2 lg:px-4 py-3 lg:py-4 text-xs lg:text-sm text-green-700 text-right font-bold",children:A0(le)}),o.jsx("td",{className:"px-2 lg:px-4 py-3 lg:py-4 text-xs lg:text-sm text-right font-bold",children:o.jsx("span",{className:ue>0?"text-red-600":"text-green-600",children:A0(ue)})}),o.jsx("td",{className:"px-2 lg:px-4 py-3 lg:py-4 text-center",children:o.jsx("span",{className:`px-2 lg:px-3 py-1 rounded-full text-xs font-semibold ${Eoe(fe)}`,children:fe})}),o.jsx("td",{className:"px-2 lg:px-4 py-3 lg:py-4 text-center",children:o.jsx("div",{className:"w-16 lg:w-20 mx-auto",children:o.jsx(C0,{progress:Q>0?Math.round(le/Q*100):0,color:fe==="Payé"?"bg-green-500":fe==="Partiel"?"bg-orange-500":"bg-red-500",size:"sm",showPercentage:!1})})}),o.jsx("td",{className:"px-2 lg:px-4 py-3 lg:py-4 text-center text-xs lg:text-sm text-gray-600 hidden lg:table-cell",children:z.dernierPaiement?o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:A0(z.dernierPaiement.montant)}),o.jsx("div",{className:"text-xs text-gray-500",children:new Date(z.dernierPaiement.datePaiement||z.dernierPaiement.createdAt).toLocaleDateString("fr-FR")})]}):o.jsx("span",{className:"text-gray-400",children:"Aucun"})}),o.jsx("td",{className:"px-2 lg:px-4 py-3 lg:py-4",children:o.jsxs("div",{className:"flex items-center justify-center space-x-1 lg:space-x-2",children:[o.jsx(ht,{variant:"ghost",size:"sm",onClick:()=>P(z.eleve),title:"Ouvrir page de paiement",children:o.jsx(Gi,{className:"h-3 w-3 lg:h-4 lg:w-4"})}),z.paiementsEleve.length>0&&o.jsxs(o.Fragment,{children:[o.jsx(ht,{variant:"ghost",size:"sm",onClick:()=>R(z.eleve),title:"Imprimer dernier reçu",children:o.jsx(wf,{className:"h-3 w-3 lg:h-4 lg:w-4"})}),o.jsx(ht,{variant:"ghost",size:"sm",onClick:()=>G(z.eleve),title:"Reçu combiné",className:"hidden sm:inline-flex",children:o.jsx(g1,{className:"h-3 w-3 lg:h-4 lg:w-4"})})]})]})})]},z.eleve.id)})})]})}),C.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(gi,{className:"h-12 w-12 lg:h-16 lg:w-16 text-gray-300 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500 text-base lg:text-lg",children:"Aucune situation financière trouvée"}),o.jsx("p",{className:"text-gray-400 text-xs lg:text-sm mt-2",children:"Ajustez vos filtres ou ajoutez des élèves"})]})]}),l.paymentForm&&o.jsx(boe,{onSubmit:k,onCancel:()=>S("paymentForm")}),o.jsx(cv,{isOpen:l.recu,onClose:()=>S("recu"),maxWidth:"2xl",children:d&&m&&o.jsx(lw,{eleve:{nom:d.nom,prenoms:d.prenoms,matricule:d.matricule,classe:g.find(z=>z.id===d.classeId)?.niveau+" "+g.find(z=>z.id===d.classeId)?.section||""},montantRegle:m.montant,date:m.datePaiement||m.createdAt,mode:m.modePaiement||"Espèces",cumulReglement:b.find(z=>z.eleve.id===d.id)?.totalPaye||0,resteAPayer:b.find(z=>z.eleve.id===d.id)?.solde||0,anneeScolaire:g.find(z=>z.id===d.classeId)?.anneeScolaire||"",operateur:m.operateur||"ADMIN",numeroRecu:m.numeroRecu||"REC"+Date.now().toString().slice(-8)})}),o.jsx(cv,{isOpen:l.combinedRecu,onClose:()=>S("combinedRecu"),maxWidth:"4xl",children:d&&o.jsx(g6,{eleve:d,paiements:b.find(z=>z.eleve.id===d.id)?.paiementsEleve||[],classe:g.find(z=>z.id===d.classeId),anneeScolaire:g.find(z=>z.id===d.classeId)?.anneeScolaire,totalAttendu:b.find(z=>z.eleve.id===d.id)?.totalDu})}),o.jsx(cv,{isOpen:l.convocation,onClose:()=>S("convocation"),maxWidth:"4xl",children:d&&(()=>{try{const ne=Am(d.id).filter(le=>le.remaining>0).map(le=>({modalite:le.modalite||1,date:le.dueDate||le.date||"",attendu:le.montant||0,paye:(le.montant||0)-(le.remaining||0),reste:le.remaining||0})),Q=ne.reduce((le,ue)=>le+ue.reste,0);return o.jsx(woe,{eleve:d,echeances:ne,totalDue:Q,classe:g.find(le=>le.id===d.classeId),anneeScolaire:g.find(le=>le.id===d.classeId)?.anneeScolaire})}catch{return o.jsx("div",{className:"p-8 text-center",children:o.jsx("p",{className:"text-red-600",children:"Erreur lors de la génération de la convocation"})})}})()})]})}function Coe(){const[e,t]=j.useState([]),[r,n]=j.useState(!1),[a,i]=j.useState({date:new Date().toISOString().slice(0,10),type:"Entree",category:"",amount:0,note:""}),[s,l]=j.useState("all"),[f,d]=j.useState(""),[h,m]=j.useState(""),[x,v]=j.useState(""),[y,g]=j.useState("");j.useEffect(()=>{const U=new Date;if(s==="all")m(""),v("");else if(s==="today"){const W=U.toISOString().slice(0,10);m(W),v(W)}else if(s==="month"){const W=new Date(U.getFullYear(),U.getMonth(),1).toISOString().slice(0,10),X=new Date(U.getFullYear(),U.getMonth()+1,0).toISOString().slice(0,10);m(W),v(X)}else if(s==="year"){const W=new Date(U.getFullYear(),0,1).toISOString().slice(0,10),X=new Date(U.getFullYear(),11,31).toISOString().slice(0,10);m(W),v(X)}},[s]);const[b,N]=j.useState(1),[_,S]=j.useState(20),[C,T]=j.useState("date"),[k,P]=j.useState("desc"),[D,R]=j.useState(null),[G,M]=j.useState(!1),[H,z]=j.useState([]),ne=()=>t(pe.getAll("compta")||[]);j.useEffect(()=>{ne();const U=()=>{ne(),n(W=>!W)};return window.addEventListener("dataChanged",U),()=>window.removeEventListener("dataChanged",U)},[]);const Q=()=>i({date:new Date().toISOString().slice(0,10),type:"Entree",category:"",amount:0,note:""}),le=()=>{try{const U={date:a.date||new Date().toISOString(),type:a.type||"Entree",category:a.category||"Général",amount:Number(a.amount)||0,note:a.note||"",createdAt:new Date().toISOString()};pe.create("compta",U),Q(),ne()}catch(U){console.error(U),alert("Erreur en créant l'écriture")}},ue=U=>{if(confirm("Supprimer cette écriture ?"))try{pe.delete("compta",U),ne()}catch(W){console.error(W),alert("Erreur lors de la suppression")}},fe=j.useMemo(()=>{const W=(pe.getAll("paiements")||[]).filter(X=>!X.canceled).reduce((X,de)=>{const F=de.datePaiement||de.date||de.createdAt||new Date().toISOString();let Pe="";try{Pe=new Date(F).toISOString().slice(0,10)}catch{Pe=""}const Ae=Number(de.montant||0);return e.some(Ue=>{if(Ue.type!=="Entree")return!1;let Te="";try{Te=new Date(Ue.date).toISOString().slice(0,10)}catch{Te=""}return Te&&Pe&&Te===Pe&&Number(Ue.amount||0)===Ae})||X.push({id:`pai_${de.id}`,date:F,type:"Entree",category:de.numeroRecu?`Paiement ${de.numeroRecu}`:"Paiement",amount:Ae,note:de.notes||""}),X},[]);return[...e,...W]},[e,r]),K=j.useMemo(()=>{const U=fe.filter(de=>!(f&&de.category!==f||h&&de.date<h||x&&de.date>x)),W=U.filter(de=>de.type==="Entree").reduce((de,F)=>de+Number(F.amount||0),0),X=U.filter(de=>de.type==="Sortie").reduce((de,F)=>de+Number(F.amount||0),0);return{entrees:W,sorties:X,solde:W-X,count:U.length}},[fe,f,h,x]),me=j.useMemo(()=>{const U=new Date,W=U.toISOString().slice(0,10),X=U.toISOString().slice(0,7),de=U.getFullYear(),F=Ue=>{try{return new Date(Ue.date).toISOString().slice(0,10)===W}catch{return!1}},Pe=Ue=>{try{return new Date(Ue.date).toISOString().slice(0,7)===X}catch{return!1}},Ae=Ue=>{try{return new Date(Ue.date).getFullYear()===de}catch{return!1}},We=(Ue,Te)=>Ue.filter(lt=>lt.type===Te).reduce((lt,jt)=>lt+Number(jt.amount||0),0);return{today:{entrees:We(fe.filter(F),"Entree"),sorties:We(fe.filter(F),"Sortie")},month:{entrees:We(fe.filter(Pe),"Entree"),sorties:We(fe.filter(Pe),"Sortie")},year:{entrees:We(fe.filter(Ae),"Entree"),sorties:We(fe.filter(Ae),"Sortie")},countMonth:fe.filter(Pe).length}},[fe]),J=j.useMemo(()=>{const U=fe.filter(F=>F.type==="Entree").reduce((F,Pe)=>F+Number(Pe.amount||0),0),W=fe.filter(F=>F.type==="Sortie").reduce((F,Pe)=>F+Number(Pe.amount||0),0);let X=0;try{const F=pe.getAll("eleves"),Pe=pe.getAll("paiements"),Ae=pe.getAll("classes");X=F.map(Ue=>{try{return la.getSituationEcheances(Ue.id)}catch{return null}}).filter(Boolean).reduce((Ue,Te)=>{const lt=Number(Te.totalRestant||0);return Ue+(lt>0?lt:0)},0)}catch{X=0}const de=U-W;return{totalRecettes:U,impayes:X,totalSorties:W,solde:de}},[e,r]),O=j.useMemo(()=>{let U=fe.filter(W=>!(f&&W.category!==f||h&&W.date<h||x&&W.date>x||y&&!W.category.toLowerCase().includes(y.toLowerCase())&&!W.note?.toLowerCase().includes(y.toLowerCase())));return U=U.sort((W,X)=>{let de,F;switch(C){case"date":de=new Date(W.date).getTime(),F=new Date(X.date).getTime();break;case"category":de=W.category.toLowerCase(),F=X.category.toLowerCase();break;case"amount":de=W.amount,F=X.amount;break;default:de=W.date,F=X.date}return k==="asc"?de<F?-1:de>F?1:0:de>F?-1:de<F?1:0}),U},[fe,f,h,x,y,C,k]),ae=Math.max(1,Math.ceil(O.length/_)),ee=O.slice((b-1)*_,(b-1)*_+_),L=U=>{const W=e.find(X=>X.id===U)||null;R(W),M(!0)},V=U=>{if(D)try{pe.update("compta",D.id,{...D,...U}),M(!1),R(null)}catch(W){console.error(W),alert("Erreur lors de la mise à jour")}},se=()=>{if(O.length===0){alert("Aucune écriture à imprimer avec les filtres actuels");return}const U=O.filter(Ae=>Ae.type==="Entree").reduce((Ae,We)=>Ae+Number(We.amount||0),0),W=O.filter(Ae=>Ae.type==="Sortie").reduce((Ae,We)=>Ae+Number(We.amount||0),0),X=O.map(Ae=>`
      <tr>
        <td style="border: 1px solid #333; padding: 8px; text-align: left; background-color: #f9f9f9;">${new Date(Ae.date).toLocaleDateString("fr-FR")}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: left; background-color: #f9f9f9;">${Ae.category}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; background-color: #e6ffe6;">${Ae.type==="Entree"?Number(Ae.amount).toLocaleString("fr-FR"):""}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; background-color: #ffe6e6;">${Ae.type==="Sortie"?Number(Ae.amount).toLocaleString("fr-FR"):""}</td>
      </tr>
    `).join(`
`),de=`
      <tr style="font-weight: bold; background-color: #ddd;">
        <td colspan="2" style="border: 1px solid #333; padding: 8px; text-align: center; font-weight: bold;">TOTAUX</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; font-weight: bold; background-color: #e6ffe6;">${U.toLocaleString("fr-FR")}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; font-weight: bold; background-color: #ffe6e6;">${W.toLocaleString("fr-FR")}</td>
      </tr>
    `,F=`
      <html>
        <head>
          <title>Journal Comptable</title>
          <style>
            body {
              font-family: 'Times New Roman', Times, serif;
              font-size: 12px;
              color: #000;
              padding: 15mm;
              line-height: 1.4;
            }
            h2 {
              text-align: center;
              margin-bottom: 30px;
              font-size: 18px;
              font-weight: bold;
              text-decoration: underline;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              margin-bottom: 20px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            th {
              border: 2px solid #333;
              padding: 10px;
              text-align: center;
              background-color: #4a5568;
              color: white;
              font-weight: bold;
              font-size: 13px;
            }
            td {
              border: 1px solid #333;
              padding: 8px;
            }
            .signature {
              text-align: right;
              margin-top: 50px;
              font-weight: bold;
              font-size: 14px;
            }
            @media print {
              body { margin: 0; }
              .signature { page-break-inside: avoid; }
            }
          </style>
        </head>
        <body>
          <h2>Journal Comptable</h2>
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Libellé</th>
                <th>Débit</th>
                <th>Crédit</th>
              </tr>
            </thead>
            <tbody>
              ${X}
              ${de}
            </tbody>
          </table>
          <div class="signature">Signature</div>
        </body>
      </html>
    `,Pe=window.open("","_blank","width=800,height=600");if(!Pe){alert("Impossible d'ouvrir la fenêtre d'impression");return}Pe.document.open(),Pe.document.write(F),Pe.document.close(),Pe.focus(),setTimeout(()=>{Pe.print(),Pe.onafterprint=()=>Pe.close()},500)};return o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-extrabold",children:"Comptabilité"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Journal des entrées et sorties — aperçu rapide"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Total Recettes"}),o.jsxs("div",{className:"text-2xl font-extrabold text-gray-900",children:[J.totalRecettes.toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Impayés"}),o.jsxs("div",{className:"text-2xl font-extrabold text-red-600",children:[J.impayes.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-xs text-gray-400",children:"Reste à encaisser"})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Sorties"}),o.jsxs("div",{className:"text-2xl font-extrabold text-red-600",children:[J.totalSorties.toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Solde"}),o.jsxs("div",{className:"text-2xl font-extrabold text-indigo-700",children:[J.solde.toLocaleString("fr-FR")," FCFA"]})]})]})]}),o.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-green-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-green-100 rounded-md",children:o.jsx(Gu,{className:"text-green-700",size:20})}),o.jsx("div",{children:o.jsx("div",{className:"text-xs text-gray-500",children:"Aujourd'hui"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm font-bold",children:[o.jsx("div",{className:"text-green-700",children:"Entrées"}),o.jsxs("div",{className:"text-right text-green-700",children:[me.today.entrees.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-red-600",children:"Sorties"}),o.jsxs("div",{className:"text-right text-red-600",children:[me.today.sorties.toLocaleString("fr-FR")," FCFA"]})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-blue-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-blue-100 rounded-md",children:o.jsx(x1,{className:"text-blue-600",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500",children:"Ce mois"}),o.jsxs("div",{className:"text-xs text-gray-400",children:[me.countMonth," écritures"]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm font-bold",children:[o.jsx("div",{className:"text-green-700",children:"Entrées"}),o.jsxs("div",{className:"text-right text-green-700",children:[me.month.entrees.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-red-600",children:"Sorties"}),o.jsxs("div",{className:"text-right text-red-600",children:[me.month.sorties.toLocaleString("fr-FR")," FCFA"]})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-indigo-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-indigo-100 rounded-md",children:o.jsx(N5,{className:"text-indigo-700",size:20})}),o.jsx("div",{children:o.jsx("div",{className:"text-xs text-gray-500",children:"Cette année"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm font-bold",children:[o.jsx("div",{className:"text-green-700",children:"Entrées"}),o.jsxs("div",{className:"text-right text-green-700",children:[me.year.entrees.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-red-600",children:"Sorties"}),o.jsxs("div",{className:"text-right text-red-600",children:[me.year.sorties.toLocaleString("fr-FR")," FCFA"]})]})]})]}),o.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[o.jsx("div",{className:"text-sm text-gray-600",children:(()=>{let U="Filtre actif : Aucun";return s==="today"?U="Filtre actif : Aujourd'hui":s==="month"?U="Filtre actif : Ce mois":s==="year"?U="Filtre actif : Cette année":s==="custom"&&(U=`Filtre actif : ${h||"..."} → ${x||"..."}`),o.jsx("span",{className:"text-sm text-gray-500",children:U})})()}),o.jsxs("div",{className:"flex items-center space-x-3 text-sm text-gray-600",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"inline-block w-3 h-3 bg-green-600 rounded-full"})," ",o.jsx("span",{children:"Entrées"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"inline-block w-3 h-3 bg-red-600 rounded-full"})," ",o.jsx("span",{children:"Sorties"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(gi,{className:"text-gray-400",size:14}),o.jsx("span",{className:"text-xs",children:"Montants en FCFA"})]})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Période"}),o.jsxs("select",{value:s,onChange:U=>l(U.target.value),className:"p-2 border rounded",children:[o.jsx("option",{value:"all",children:"Toutes"}),o.jsx("option",{value:"today",children:"Aujourd'hui"}),o.jsx("option",{value:"month",children:"Ce mois"}),o.jsx("option",{value:"year",children:"Cette année"}),o.jsx("option",{value:"custom",children:"Personnalisée"})]}),s==="custom"&&o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"date",value:h,onChange:U=>m(U.target.value),className:"p-2 border rounded"}),o.jsx("input",{type:"date",value:x,onChange:U=>v(U.target.value),className:"p-2 border rounded"})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Catégorie"}),o.jsx("input",{placeholder:"Catégorie",value:f,onChange:U=>d(U.target.value),className:"p-2 border rounded"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Rechercher"}),o.jsx("input",{placeholder:"Catégorie ou note",value:y,onChange:U=>g(U.target.value),className:"p-2 border rounded"})]}),o.jsx("button",{onClick:()=>{m(""),v(""),d(""),g(""),l("all"),N(1)},className:"ml-2 px-2 py-1 bg-gray-100 border rounded text-sm",children:"Effacer tous les filtres"})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs("button",{onClick:se,className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm shadow hover:bg-indigo-700 flex items-center space-x-2",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"inline-block",children:[o.jsx("path",{d:"M6 9V2h12v7",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("rect",{x:"6",y:"13",width:"12",height:"9",rx:"1",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("span",{children:"Imprimer"})]})})]}),o.jsxs("div",{className:"bg-white p-4 rounded shadow mb-6",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("h3",{className:"text-sm font-semibold mb-4",children:"Analyse des Finances"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Répartition Générale"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(Mu,{children:o.jsxs(F0,{children:[o.jsxs(Lu,{data:[{name:"Entrées",value:K.entrees,color:"#10b981"},{name:"Sorties",value:K.sorties,color:"#ef4444"}],cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:5,dataKey:"value",children:[o.jsx(Bi,{fill:"#10b981"}),o.jsx(Bi,{fill:"#ef4444"})]}),o.jsx(Du,{formatter:U=>`${Number(U).toLocaleString("fr-FR")} FCFA`}),o.jsx(Zh,{})]})})})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Entrées par Catégorie"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(Mu,{children:o.jsxs(F0,{children:[o.jsx(Lu,{data:(()=>{const U={};fe.filter(X=>X.type==="Entree").forEach(X=>{const de=X.category||"Autre";U[de]=(U[de]||0)+Number(X.amount||0)});const W=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16"];return Object.keys(U).map((X,de)=>({name:X.length>15?X.substring(0,15)+"...":X,value:U[X],color:W[de%W.length]}))})(),cx:"50%",cy:"50%",innerRadius:30,outerRadius:80,paddingAngle:2,dataKey:"value",children:(()=>{const U={};fe.filter(X=>X.type==="Entree").forEach(X=>{const de=X.category||"Autre";U[de]=(U[de]||0)+Number(X.amount||0)});const W=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16"];return Object.keys(U).map((X,de)=>o.jsx(Bi,{fill:W[de%W.length]},`cell-${de}`))})()}),o.jsx(Du,{formatter:U=>`${Number(U).toLocaleString("fr-FR")} FCFA`})]})})})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Sorties par Catégorie"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(Mu,{children:o.jsxs(F0,{children:[o.jsx(Lu,{data:(()=>{const U={};fe.filter(X=>X.type==="Sortie").forEach(X=>{const de=X.category||"Autre";U[de]=(U[de]||0)+Number(X.amount||0)});const W=["#ef4444","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#3b82f6","#10b981"];return Object.keys(U).map((X,de)=>({name:X.length>15?X.substring(0,15)+"...":X,value:U[X],color:W[de%W.length]}))})(),cx:"50%",cy:"50%",innerRadius:30,outerRadius:80,paddingAngle:2,dataKey:"value",children:(()=>{const U={};fe.filter(X=>X.type==="Sortie").forEach(X=>{const de=X.category||"Autre";U[de]=(U[de]||0)+Number(X.amount||0)});const W=["#ef4444","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#3b82f6","#10b981"];return Object.keys(U).map((X,de)=>o.jsx(Bi,{fill:W[de%W.length]},`cell-${de}`))})()}),o.jsx(Du,{formatter:U=>`${Number(U).toLocaleString("fr-FR")} FCFA`})]})})})]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:K.entrees.toLocaleString("fr-FR")}),o.jsx("div",{className:"text-xs text-gray-500",children:"Total Entrées (FCFA)"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-red-600",children:K.sorties.toLocaleString("fr-FR")}),o.jsx("div",{className:"text-xs text-gray-500",children:"Total Sorties (FCFA)"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:`text-2xl font-bold ${K.solde>=0?"text-green-600":"text-red-600"}`,children:K.solde.toLocaleString("fr-FR")}),o.jsx("div",{className:"text-xs text-gray-500",children:"Solde (FCFA)"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:K.count}),o.jsx("div",{className:"text-xs text-gray-500",children:"Nombre d'écritures"})]})]}),O.length===0&&o.jsx("div",{className:"p-6 text-center text-sm text-gray-500",children:"Aucune écriture pour la période sélectionnée — ajoutez une écriture ou changez les filtres."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Date"}),o.jsx("input",{type:"date",value:a.date?.slice(0,10),onChange:U=>i(W=>({...W,date:U.target.value})),className:"mt-1 p-2 border rounded w-full"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Type"}),o.jsxs("select",{value:a.type,onChange:U=>i(W=>({...W,type:U.target.value})),className:"mt-1 p-2 border rounded w-full",children:[o.jsx("option",{value:"Entree",children:"Entrée"}),o.jsx("option",{value:"Sortie",children:"Sortie"})]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Catégorie"}),o.jsx("input",{value:a.category,onChange:U=>i(W=>({...W,category:U.target.value})),className:"mt-1 p-2 border rounded w-full"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Montant"}),o.jsx("input",{type:"number",value:a.amount,onChange:U=>i(W=>({...W,amount:Number(U.target.value)})),className:"mt-1 p-2 border rounded w-full"})]}),o.jsxs("div",{className:"md:col-span-6 flex space-x-2",children:[o.jsx("input",{placeholder:"Note (optionnel)",value:a.note,onChange:U=>i(W=>({...W,note:U.target.value})),className:"mt-1 p-2 border rounded w-full"}),o.jsx("button",{onClick:le,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Ajouter"})]})]})]}),o.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[O.length===0?o.jsx("div",{className:"text-center p-8",children:o.jsx("p",{className:"text-gray-500",children:"Aucune écriture"})}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>{T("date"),P(C==="date"&&k==="desc"?"asc":"desc")},children:["Date ",C==="date"&&(k==="desc"?"↓":"↑")]}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700",children:"Type"}),o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>{T("category"),P(C==="category"&&k==="desc"?"asc":"desc")},children:["Catégorie ",C==="category"&&(k==="desc"?"↓":"↑")]}),o.jsxs("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>{T("amount"),P(C==="amount"&&k==="desc"?"asc":"desc")},children:["Montant ",C==="amount"&&(k==="desc"?"↓":"↑")]}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700",children:"Note"}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ee.map(U=>o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:new Date(U.date).toLocaleDateString("fr-FR")}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:U.type}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:U.category?o.jsx("span",{className:`inline-block px-2 py-0.5 text-xs font-medium rounded ${String(U.category).toLowerCase().includes("inscription")?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:U.category}):o.jsx("span",{className:"text-gray-400",children:"—"})}),o.jsx("td",{className:"px-4 py-3 text-sm text-right font-bold",children:o.jsxs("span",{className:U.type==="Entree"?"text-green-700":"text-red-600",children:[U.type==="Entree"?"+":"-",Number(U.amount).toLocaleString("fr-FR")," FCFA"]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:U.note||""}),o.jsx("td",{className:"px-4 py-3 text-sm text-center space-x-1",children:String(U.id||"").startsWith("pai_")?o.jsxs(o.Fragment,{children:[o.jsx("button",{disabled:!0,title:"Cette ligne provient d'un paiement; modifiez-le depuis l'écran Paiements",className:"px-2 py-1 bg-yellow-300 text-white rounded text-xs opacity-60 cursor-not-allowed",children:"Éditer"}),o.jsx("button",{disabled:!0,title:"Cette ligne provient d'un paiement; suppression non autorisée depuis la comptabilité",className:"px-2 py-1 bg-red-300 text-white rounded text-xs opacity-60 cursor-not-allowed",children:"Supprimer"})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>L(U.id),className:"px-2 py-1 bg-yellow-500 text-white rounded text-xs hover:brightness-95",children:"Éditer"}),o.jsx("button",{onClick:()=>ue(U.id),className:"px-2 py-1 bg-red-600 text-white rounded text-xs hover:brightness-95",children:"Supprimer"})]})})]},U.id))})]})}),o.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",b," / ",ae," — ",O.length," résultats"]}),o.jsxs("div",{className:"space-x-2",children:[o.jsx("button",{disabled:b<=1,onClick:()=>N(U=>Math.max(1,U-1)),className:"px-2 py-1 border rounded",children:"Préc"}),o.jsx("button",{disabled:b>=ae,onClick:()=>N(U=>Math.min(ae,U+1)),className:"px-2 py-1 border rounded",children:"Suiv"}),o.jsxs("select",{value:_,onChange:U=>{S(Number(U.target.value)),N(1)},className:"border p-1 rounded",children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:20,children:"20"}),o.jsx("option",{value:50,children:"50"})]})]})]}),G&&D&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded shadow p-4 w-full max-w-md",children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Éditer écriture"}),o.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[o.jsx("label",{className:"text-xs",children:"Date"}),o.jsx("input",{type:"date",value:D.date?.slice(0,10),onChange:U=>R(W=>W&&{...W,date:U.target.value}),className:"p-2 border rounded"}),o.jsx("label",{className:"text-xs",children:"Type"}),o.jsxs("select",{value:D.type,onChange:U=>R(W=>W&&{...W,type:U.target.value}),className:"p-2 border rounded",children:[o.jsx("option",{value:"Entree",children:"Entrée"}),o.jsx("option",{value:"Sortie",children:"Sortie"})]}),o.jsx("label",{className:"text-xs",children:"Catégorie"}),o.jsx("input",{value:D.category,onChange:U=>R(W=>W&&{...W,category:U.target.value}),className:"p-2 border rounded"}),o.jsx("label",{className:"text-xs",children:"Montant"}),o.jsx("input",{type:"number",value:String(D.amount||0),onChange:U=>R(W=>W&&{...W,amount:Number(U.target.value)}),className:"p-2 border rounded"}),o.jsx("label",{className:"text-xs",children:"Note"}),o.jsx("input",{value:D.note||"",onChange:U=>R(W=>W&&{...W,note:U.target.value}),className:"p-2 border rounded"})]}),o.jsxs("div",{className:"mt-3 flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>{M(!1),R(null)},className:"px-3 py-1 border rounded",children:"Annuler"}),o.jsx("button",{onClick:()=>V(D),className:"px-3 py-1 bg-green-600 text-white rounded",children:"Enregistrer"})]})]})}),o.jsx("div",{id:"print-area",style:{position:"absolute",left:"-9999px",top:"0",width:"0",height:"0",overflow:"hidden"}})]})]})}const Ul=[{title:"Bienvenue sur KlasNet !",description:`Bienvenue dans votre application de gestion scolaire KlasNet. Ce guide va vous accompagner pas à pas pour découvrir chaque fonctionnalité. Prenez le temps de lire chaque étape, puis cliquez sur 'Suivant'.

Note : Vous pouvez relancer ce guide à tout moment en cliquant sur le bouton 'Guide' en haut à droite.`,icon:o.jsx(S5,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Tableau de bord",description:`Le tableau de bord est la page d'accueil. Il affiche en temps réel :
- Le nombre total d'élèves et d'élèves actifs
- Les recettes totales et celles du mois
- Les paiements complétés et en attente
- Des graphiques pour visualiser l'évolution des finances

En bas, retrouvez les 'Actions Rapides' pour accéder directement aux fonctions principales.

Exemple : Cliquez sur 'Nouvel Élève' pour inscrire un nouvel élève en un seul clic.`,icon:o.jsx(Gu,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Gestion des élèves",description:`Dans le menu 'Élèves', vous pouvez :
- Voir la liste de tous les élèves
- Ajouter un nouvel élève (bouton 'Nouvel Élève')
- Modifier ou supprimer un élève existant

Note : Utilisez la barre de recherche pour retrouver rapidement un élève par nom, prénom ou matricule.

Exemple : Pour inscrire un nouvel élève, cliquez sur 'Nouvel Élève', remplissez le formulaire puis validez.`,icon:o.jsx(qi,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Finances et paiements",description:`Dans la section 'Finances', vous pouvez :
- Enregistrer un paiement pour un élève
- Consulter l'historique des paiements
- Voir la situation financière de chaque élève (solde, montant dû, etc.)

Exemple : Pour enregistrer un paiement, cliquez sur 'Nouveau Paiement', sélectionnez l'élève concerné et saisissez le montant.`,icon:o.jsx(gi,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Saisie des notes",description:`Dans la section 'Notes', vous pouvez :
- Saisir les notes des élèves pour chaque matière et période
- Consulter les moyennes et les résultats

Note : Saisissez régulièrement les notes pour suivre la progression des élèves et générer les bulletins facilement.`,icon:o.jsx(Ki,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Configuration",description:`Dans 'Configuration', personnalisez votre application :
- Définissez l'année scolaire active
- Ajoutez ou modifiez les frais scolaires
- Gérez les compositions et les paramètres de l'école

Exemple : Pour changer d'année scolaire, saisissez la nouvelle année puis cliquez sur 'Changer'.

Note : Vérifiez toujours que l'année scolaire active est correcte avant de saisir de nouvelles données.`,icon:o.jsx(R0,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Recherche rapide",description:`La barre de recherche (en haut de chaque page) vous permet de retrouver rapidement :
- Un élève
- Une classe
- Un enseignant
- Une opération financière

Tapez simplement un mot-clé (nom, prénom, etc.) et les résultats s'affichent instantanément.`,icon:o.jsx(xc,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Historique et alertes",description:`KlasNet vous informe en temps réel :
- Alertes sur les paiements en retard
- Notifications pour les actions à effectuer (ex : élèves sans notes)
- Historique des modifications (ajout, suppression, paiement, etc.)

Note : Consultez régulièrement l'historique pour suivre l'activité de l'école et anticiper les besoins.`,icon:o.jsx(ti,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Import/Export Excel",description:`Gagnez du temps grâce à l'importation et l'exportation des listes d'élèves au format Excel.

- Importez facilement une liste d'élèves depuis un fichier Excel.
- Prévisualisez les données avant de valider l'importation.
- Sélectionnez la classe d'affectation et vérifiez les colonnes importantes (Matricule, Nom, Prénoms).
- Exportez la liste actuelle pour la partager ou l'archiver.

Note : Vérifiez toujours l'aperçu avant de valider pour éviter les erreurs de saisie.`,icon:o.jsx(Ls,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Prêt à commencer",description:`Vous êtes prêt à utiliser KlasNet.

N'hésitez pas à explorer chaque menu, à utiliser la recherche et à consulter ce guide en cas de besoin.

Bonne gestion avec KlasNet.`,icon:o.jsx(Oa,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})}];function Aoe({onClose:e}){const[t,r]=j.useState(0);j.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]);const n=a=>{r(a)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 max-w-lg w-full mx-4 relative",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Guide d'utilisation"}),o.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-lg transition-colors",onClick:e,children:o.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{className:"flex items-center mt-4 space-x-1",children:Ul.map((a,i)=>o.jsx("button",{className:`flex-1 h-2 rounded-full transition-all duration-300 ${i<=t?"bg-gray-900":"bg-gray-200"}`,onClick:()=>n(i),"aria-label":`Aller à l'étape ${i+1}`},i))})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"text-center mb-6",children:[Ul[t].icon,o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:Ul[t].title})]}),o.jsx("div",{className:"text-gray-700 text-sm leading-relaxed whitespace-pre-line mb-8 min-h-[120px]",children:Ul[t].description})]}),o.jsx("div",{className:"p-6 border-t border-gray-200",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",onClick:()=>r(a=>Math.max(0,a-1)),disabled:t===0,children:[o.jsx(D0,{className:"h-4 w-4"}),o.jsx("span",{children:"Précédent"})]}),o.jsxs("span",{className:"text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:[t+1," / ",Ul.length]}),t<Ul.length-1?o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",onClick:()=>r(a=>a+1),children:[o.jsx("span",{children:"Suivant"}),o.jsx(p5,{className:"h-4 w-4"})]}):o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",onClick:e,children:[o.jsx(Oa,{className:"h-4 w-4"}),o.jsx("span",{children:"Terminer"})]})]})})]})})}function Toe({user:e}){const[t,r]=j.useState(e?.avatar||null),[n,a]=j.useState(!1),[i,s]=j.useState(!1),[l,f]=j.useState(e?.prenoms||""),[d,h]=j.useState(e?.nom||""),[m,x]=j.useState(e?.role||""),{showToast:v}=Xr(),[y,g]=j.useState(null),[b,N]=j.useState({});if(!e)return o.jsx("div",{className:"p-6",children:"Aucun utilisateur connecté."});const _=async T=>{const k=T.target.files?.[0];if(!k)return;const P=new FileReader;P.onload=()=>r(String(P.result)),P.readAsDataURL(k),g(k.name)},S=async()=>{if(!(!e?.id||!t)){a(!0);try{pe.update("utilisateurs",e.id,{avatar:t});try{v("Avatar enregistré","success")}catch{}}finally{a(!1)}}},C=async()=>{if(!e?.id)return;const T={};if((!l||l.trim().length===0)&&(T.prenom="Prénoms requis."),(!d||d.trim().length===0)&&(T.nom="Nom requis."),N(T),!(Object.keys(T).length>0)){a(!0);try{pe.update("utilisateurs",e.id,{prenoms:l,nom:d,role:m});try{v("Profil mis à jour","success")}catch{}}finally{a(!1),s(!1)}}};return o.jsxs("div",{className:"p-6 max-w-2xl mx-auto bg-white rounded-lg shadow",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Profil utilisateur"}),o.jsxs("div",{className:"flex items-start space-x-6",children:[o.jsxs("div",{className:"w-36",children:[o.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-100 overflow-hidden shadow",children:t?o.jsx("img",{src:t,alt:"avatar",className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:"A"})}),o.jsxs("div",{className:"mt-2 flex flex-col space-y-2",children:[o.jsxs("label",{className:"inline-flex items-center px-3 py-2 bg-white border rounded cursor-pointer text-sm",children:[o.jsx("input",{type:"file",accept:"image/*",onChange:_,className:"hidden"}),"Choisir un fichier"]}),y&&o.jsx("div",{className:"text-xs text-gray-500",children:y}),t&&o.jsx("div",{children:o.jsx("button",{onClick:S,disabled:n,className:"px-3 py-1 bg-teal-600 text-white rounded",children:n?"Enregistrement...":"Enregistrer avatar"})})]})]}),o.jsx("div",{className:"flex-1",children:o.jsx("div",{className:"space-y-2",children:i?o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Prénoms"}),o.jsx("input",{value:l,onChange:T=>f(T.target.value),className:"mt-1 block w-full border rounded px-2 py-1"}),b.prenom&&o.jsx("div",{className:"text-xs text-red-600 mt-1",children:b.prenom})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nom"}),o.jsx("input",{value:d,onChange:T=>h(T.target.value),className:"mt-1 block w-full border rounded px-2 py-1"}),b.nom&&o.jsx("div",{className:"text-xs text-red-600 mt-1",children:b.nom})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Rôle"}),o.jsxs("select",{value:m,onChange:T=>x(T.target.value),className:"mt-1 block w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"Secrétaire",children:"Secrétaire"}),o.jsx("option",{value:"Enseignant",children:"Enseignant"}),o.jsx("option",{value:"Admin",children:"Admin"})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:C,disabled:n,className:"px-3 py-1 bg-teal-600 text-white rounded",children:n?"Enregistrement...":"Enregistrer"}),o.jsx("button",{onClick:()=>{s(!1),N({})},className:"px-3 py-1 border rounded",children:"Annuler"})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Nom"}),o.jsx("div",{className:"font-semibold",children:yt(e)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Rôle"}),o.jsx("div",{className:"text-sm",children:e.role})]}),o.jsx("div",{className:"mt-3",children:o.jsx("button",{onClick:()=>s(!0),className:"px-3 py-1 bg-slate-600 text-white rounded",children:"Modifier le profil"})})]})})})]})]})}function Poe(){const e=Fs.getCurrentUser(),[t,r]=j.useState(""),[n,a]=j.useState(""),[i,s]=j.useState(""),[l,f]=j.useState(null),[d,h]=j.useState(""),[m,x]=j.useState(""),[v,y]=j.useState(!1),[g,b]=j.useState(!1),N=_=>{if(_.preventDefault(),!e)return f("Aucun utilisateur connecté.");if(!n||n!==i)return f("Les nouveaux mots de passe ne correspondent pas.");const S=Fs.changePassword(e.nomUtilisateur,n,t||void 0);f(S?"Mot de passe mis à jour.":"Échec : l'ancien mot de passe est incorrect ou une erreur est survenue."),S&&(r(""),a(""),s(""))};return o.jsxs("div",{className:"p-6 max-w-2xl mx-auto bg-white rounded-lg shadow",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Paramètres du compte"}),o.jsxs("form",{onSubmit:N,className:"space-y-4 text-sm text-gray-700",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nom d'utilisateur"}),o.jsx("div",{className:"font-semibold",children:e?.nomUtilisateur||"—"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Ancien mot de passe"}),o.jsx("input",{type:"password",value:t,onChange:_=>r(_.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nouveau mot de passe"}),o.jsx("input",{type:"password",value:n,onChange:_=>a(_.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Confirmer nouveau mot de passe"}),o.jsx("input",{type:"password",value:i,onChange:_=>s(_.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsx("div",{children:o.jsx("button",{type:"submit",className:"px-3 py-1 bg-teal-600 text-white rounded",children:"Enregistrer"})}),l&&o.jsx("div",{className:"text-sm text-gray-600",children:l})]}),o.jsxs("div",{className:"mt-6 p-4 border-t pt-4",children:[o.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Changer le nom d'utilisateur"}),o.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nouveau nom d'utilisateur"}),o.jsx("input",{value:d,onChange:_=>h(_.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Mot de passe (vérification)"}),o.jsx("input",{type:"password",value:m,onChange:_=>x(_.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsx("div",{children:o.jsx("button",{onClick:()=>{if(f(null),!e)return f("Aucun utilisateur connecté.");if(!d)return f("Entrez un nouveau nom d'utilisateur.");if(!/^[a-z0-9_.-]{3,30}$/i.test(d))return f("Nom utilisateur invalide — utilisez 3 à 30 caractères (lettres, chiffres, _, . ou -).");y(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded",children:"Renommer le compte"})})]})]}),v&&o.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center",children:o.jsxs("div",{className:"bg-white p-6 rounded shadow max-w-md w-full",children:[o.jsx("h4",{className:"font-semibold mb-3",children:"Confirmer le renommage"}),o.jsxs("p",{className:"text-sm text-gray-700 mb-4",children:["Vous allez changer le nom d'utilisateur de ",o.jsx("strong",{children:e?.nomUtilisateur})," en ",o.jsx("strong",{children:d}),". Continuer ?"]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>y(!1),className:"px-3 py-1 border rounded",children:"Annuler"}),o.jsx("button",{disabled:g,onClick:async()=>{if(f(null),!e)return f("Aucun utilisateur connecté.");b(!0);try{if(Fs.changeUsername(e.nomUtilisateur,d,m||void 0)){f("Nom d'utilisateur mis à jour. L'application va se recharger."),y(!1);try{Fs.logout()}catch{}setTimeout(()=>{window.location.reload()},400)}else f("Échec : nom existant ou mot de passe incorrect."),y(!1)}finally{b(!1)}},className:"px-3 py-1 bg-red-600 text-white rounded",children:"Confirmer"})]})]})})]})}function Ooe(){if(pe.getAll("matieres").length>0)return;const e=new Date().toISOString(),t=new Date().getFullYear()+"-"+(new Date().getFullYear()+1),r=[{nom:"Mathématiques",abreviation:"MATH",coefficient:4,type:"Fondamentale",baremeParNiveau:{CE1:{min:0,max:50},CE2:{min:0,max:50},CM1:{min:0,max:50},CM2:{min:0,max:50},CP1:{min:0,max:20},CP2:{min:0,max:20}}},{nom:"Éveil au Milieu",abreviation:"AEM",coefficient:4,type:"Éveil",baremeParNiveau:{CE1:{min:0,max:50},CE2:{min:0,max:50},CM1:{min:0,max:50},CM2:{min:0,max:50},CP1:{min:0,max:20},CP2:{min:0,max:20}}},{nom:"Exploitation de Texte",abreviation:"EXP TEXTE",coefficient:4,type:"Fondamentale",baremeParNiveau:{CE1:{min:0,max:50},CE2:{min:0,max:50},CM1:{min:0,max:50},CM2:{min:0,max:50},CP1:{min:0,max:20},CP2:{min:0,max:20}}},{nom:"Orthographe",abreviation:"ORTH",coefficient:2,type:"Fondamentale",baremeParNiveau:{CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20},CP1:{min:0,max:20},CP2:{min:0,max:20}}}],n=[{nom:"Éveil Scientifique",abreviation:"SCIENCES",coefficient:2,type:"Éveil",baremeParNiveau:{CP1:{min:0,max:20},CP2:{min:0,max:20},CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20}}}],a=[{nom:"Éducation Artistique",abreviation:"ARTS",coefficient:1,type:"Expression",baremeParNiveau:{CP1:{min:0,max:20},CP2:{min:0,max:20},CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20}}},{nom:"Éducation Physique",abreviation:"EPS",coefficient:1,type:"Expression",baremeParNiveau:{CP1:{min:0,max:20},CP2:{min:0,max:20},CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20}}}],i=[...r,...n,...a],s=[];i.forEach(m=>{const x=pe.create("matieres",{...m,obligatoire:m.type==="Fondamentale",classeIds:[],createdAt:e,updatedAt:e});s.push(x)}),[{nom:"1ère Composition",coefficient:1,ordre:1},{nom:"2ème Composition",coefficient:1,ordre:2},{nom:"3ème Composition",coefficient:1,ordre:3},{nom:"Composition de fin d'année",coefficient:2,ordre:4}].forEach(m=>{pe.create("compositions",m)}),["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"].forEach(m=>{["A","B"].forEach(x=>{if(["Petite Section","Moyenne Section","Grande Section"].includes(m)&&x==="B")return;const v=pe.create("classes",{niveau:m,section:x,anneeScolaire:t,enseignantPrincipal:"",effectifMax:35,salle:`Salle ${m} ${x}`,matieres:s.filter(y=>m.includes("Section")?["Fondamentale","Expression"].includes(y.type):!0)});s.forEach(y=>{v.matieres.some(g=>g.id===y.id)&&pe.update("matieres",y.id,{classeIds:[...y.classeIds||[],v.id]})})})}),[{nom:"KOUASSI",prenoms:"Marie",sexe:"F",telephone:"+225 07 XX XX XX XX",adresse:"Abidjan, Cocody",specialite:"Institutrice",diplome:"CEAP",dateEmbauche:"2020-09-01",statut:"Actif",salaire:15e4,photo:"",classesPrincipales:[],matieresEnseignees:[]},{nom:"TRAORE",prenoms:"Amadou",sexe:"M",telephone:"+225 05 XX XX XX XX",adresse:"Abidjan, Yopougon",specialite:"Professeur des écoles",diplome:"Licence Pédagogie",dateEmbauche:"2019-09-01",statut:"Actif",salaire:18e4,photo:"",classesPrincipales:[],matieresEnseignees:[]}].forEach(m=>{pe.create("enseignants",m)});const h=pe.getAll("ecole")[0];if(h){const m=pe.getAll("compositions");pe.update("ecole",h.id,{compositions:m})}console.log("Données par défaut initialisées avec succès")}function Foe(){const[e,t]=j.useState(()=>Fs.getCurrentUser()),[r,n]=j.useState("dashboard"),[a,i]=j.useState(null),[s,l]=j.useState(!1),[f,d]=j.useState(!1);zl.useEffect(()=>{if(e)try{Ooe(),iP()}catch(D){console.error("Erreur lors de l'initialisation des données par défaut:",D)}},[e]),zl.useEffect(()=>{const D=()=>{try{S1()}catch{}};return window.addEventListener("beforeunload",D),()=>window.removeEventListener("beforeunload",D)},[]),zl.useEffect(()=>{const D=R=>{try{const G=window;if(G&&G.__discardModalOpen){try{console.debug("[App] navigate ignored because discard modal open")}catch{}return}let M=!1;if(G.__unsavedGuards&&typeof G.__unsavedGuards.forEach=="function"&&G.__unsavedGuards.forEach(ne=>{try{ne()&&(M=!0)}catch{}}),M){if(R&&typeof R.stopImmediatePropagation=="function")try{R.stopImmediatePropagation()}catch{}G.__autosaveHandlers&&typeof G.__autosaveHandlers.forEach=="function"&&G.__autosaveHandlers.forEach(ne=>{try{ne()}catch{}}),G.__pendingNavigation=R.detail,_(R.detail),b(!0);return}const{page:H,action:z}=R.detail||{};H&&(n(H),z==="new"?(i(null),l(!0)):(l(!1),i(null)))}catch(G){console.debug("navigate guard check failed",G)}};return window.addEventListener("navigate",D),()=>window.removeEventListener("navigate",D)},[]);const h=D=>{n(D),i(null),l(!1)},m=D=>{i(D),l(!0)},x=()=>{i(null),l(!0)},v=()=>{l(!1),i(null)},y=()=>{l(!1),i(null)},[g,b]=zl.useState(!1),[N,_]=zl.useState(null),S=async()=>{const D=window;try{D.__preventReDispatch=!0}catch{}try{D.__forceNavigationInProgress=!0}catch{}try{const R=Array.from(D.__unsavedAllowHandlers||[]);for(const M of R)try{await M()}catch(H){console.debug("allow handler failed",H)}try{window.dispatchEvent(new CustomEvent("unsaved:allow"))}catch{}b(!1);const G=N||D.__pendingNavigation||null;_(null);try{typeof window<"u"&&(D.__pendingNavigation=null)}catch{}if(G&&G.page){const{page:M,action:H}=G;n(M),H==="new"&&(i(null),l(!0))}}catch(R){console.error("confirmGlobalDiscard failed",R),b(!1),_(null)}finally{setTimeout(()=>{try{D.__forceNavigationInProgress=!1}catch{}try{D.__preventReDispatch=!1}catch{}try{D.__unsavedGuards=new Set}catch{}},60)}},C=()=>{b(!1),_(null);try{const D=window;D.__pendingNavigation=null}catch{}},T=D=>{t(D)},k=()=>{try{Fs.logout()}catch{}t(null),n("dashboard")},P=()=>{if(s)switch(r){case"eleves":return o.jsx(Uq,{eleve:a,onSave:v,onCancel:y});case"enseignants":return o.jsx(Wq,{enseignant:a,onSave:v,onCancel:y});case"classes":return o.jsx(Vq,{classe:a,onSave:v,onCancel:y});case"matieres":return o.jsx(Gq,{matiere:a,onSave:v,onCancel:y});default:return o.jsx(qg,{})}switch(r){case"dashboard":return o.jsx(qg,{});case"profil":return o.jsx(Toe,{user:e});case"parametres":return o.jsx(Poe,{});case"finances":return o.jsx(joe,{});case"comptabilite":return o.jsx(Coe,{});case"eleves":return o.jsx($q,{onEleveSelect:m,onNewEleve:x});case"enseignants":return o.jsx(zq,{onEnseignantSelect:m,onNewEnseignant:x});case"classes":return o.jsx(Hq,{onClasseSelect:m,onNewClasse:x});case"matieres":return o.jsx(Kq,{onMatiereSelect:m,onNewMatiere:x});case"notes":return o.jsx(qq,{});case"config":return o.jsx(yoe,{});default:return o.jsx(qg,{})}};return o.jsx(F5,{children:e?o.jsx(D5,{children:o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx(M5,{currentUser:e,onLogout:k,onNavigate:h,currentPage:r,onShowGuide:()=>d(!0)}),o.jsx("main",{children:P()}),g&&o.jsx(gc,{open:g,title:"Quitter sans sauvegarder ?",description:"Certaines pages ont des modifications non sauvegardées. Voulez-vous quitter et perdre ces modifications ?",onConfirm:S,onCancel:C}),f&&o.jsx(Aoe,{onClose:()=>d(!1)})]})}):o.jsx(I5,{onLogin:T})})}f5.createRoot(document.getElementById("root")).render(o.jsx(j.StrictMode,{children:o.jsx(Foe,{})}));export{Doe as c,es as g};
