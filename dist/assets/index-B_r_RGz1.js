const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CombinedRecu-DI1RiGba.js","./RecuPaiement-uhXbpdHO.js"])))=>i.map(i=>d[i]);
function a4(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var wle=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ni(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lx={exports:{}},vu={},cx={exports:{}},xt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TS;function n5(){if(TS)return xt;TS=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function x(te){return te===null||typeof te!="object"?null:(te=m&&te[m]||te["@@iterator"],typeof te=="function"?te:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,v={};function b(te,O,K){this.props=te,this.context=O,this.refs=v,this.updater=K||g}b.prototype.isReactComponent={},b.prototype.setState=function(te,O){if(typeof te!="object"&&typeof te!="function"&&te!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,te,O,"setState")},b.prototype.forceUpdate=function(te){this.updater.enqueueForceUpdate(this,te,"forceUpdate")};function N(){}N.prototype=b.prototype;function E(te,O,K){this.props=te,this.context=O,this.refs=v,this.updater=K||g}var S=E.prototype=new N;S.constructor=E,y(S,b.prototype),S.isPureReactComponent=!0;var C=Array.isArray,T=Object.prototype.hasOwnProperty,k={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function D(te,O,K){var W,X={},V=null,ne=null;if(O!=null)for(W in O.ref!==void 0&&(ne=O.ref),O.key!==void 0&&(V=""+O.key),O)T.call(O,W)&&!P.hasOwnProperty(W)&&(X[W]=O[W]);var L=arguments.length-2;if(L===1)X.children=K;else if(1<L){for(var U=Array(L),H=0;H<L;H++)U[H]=arguments[H+2];X.children=U}if(te&&te.defaultProps)for(W in L=te.defaultProps,L)X[W]===void 0&&(X[W]=L[W]);return{$$typeof:e,type:te,key:V,ref:ne,props:X,_owner:k.current}}function R(te,O){return{$$typeof:e,type:te.type,key:O,ref:te.ref,props:te.props,_owner:te._owner}}function q(te){return typeof te=="object"&&te!==null&&te.$$typeof===e}function M(te){var O={"=":"=0",":":"=2"};return"$"+te.replace(/[=:]/g,function(K){return O[K]})}var z=/\/+/g;function ie(te,O){return typeof te=="object"&&te!==null&&te.key!=null?M(""+te.key):O.toString(36)}function ce(te,O,K,W,X){var V=typeof te;(V==="undefined"||V==="boolean")&&(te=null);var ne=!1;if(te===null)ne=!0;else switch(V){case"string":case"number":ne=!0;break;case"object":switch(te.$$typeof){case e:case t:ne=!0}}if(ne)return ne=te,X=X(ne),te=W===""?"."+ie(ne,0):W,C(X)?(K="",te!=null&&(K=te.replace(z,"$&/")+"/"),ce(X,O,K,"",function(H){return H})):X!=null&&(q(X)&&(X=R(X,K+(!X.key||ne&&ne.key===X.key?"":(""+X.key).replace(z,"$&/")+"/")+te)),O.push(X)),1;if(ne=0,W=W===""?".":W+":",C(te))for(var L=0;L<te.length;L++){V=te[L];var U=W+ie(V,L);ne+=ce(V,O,K,U,X)}else if(U=x(te),typeof U=="function")for(te=U.call(te),L=0;!(V=te.next()).done;)V=V.value,U=W+ie(V,L++),ne+=ce(V,O,K,U,X);else if(V==="object")throw O=String(te),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(te).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.");return ne}function ae(te,O,K){if(te==null)return te;var W=[],X=0;return ce(te,W,"","",function(V){return O.call(K,V,X++)}),W}function me(te){if(te._status===-1){var O=te._result;O=O(),O.then(function(K){(te._status===0||te._status===-1)&&(te._status=1,te._result=K)},function(K){(te._status===0||te._status===-1)&&(te._status=2,te._result=K)}),te._status===-1&&(te._status=0,te._result=O)}if(te._status===1)return te._result.default;throw te._result}var de={current:null},he={transition:null},J={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:he,ReactCurrentOwner:k};function xe(){throw Error("act(...) is not supported in production builds of React.")}return xt.Children={map:ae,forEach:function(te,O,K){ae(te,function(){O.apply(this,arguments)},K)},count:function(te){var O=0;return ae(te,function(){O++}),O},toArray:function(te){return ae(te,function(O){return O})||[]},only:function(te){if(!q(te))throw Error("React.Children.only expected to receive a single React element child.");return te}},xt.Component=b,xt.Fragment=r,xt.Profiler=a,xt.PureComponent=E,xt.StrictMode=n,xt.Suspense=f,xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,xt.act=xe,xt.cloneElement=function(te,O,K){if(te==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+te+".");var W=y({},te.props),X=te.key,V=te.ref,ne=te._owner;if(O!=null){if(O.ref!==void 0&&(V=O.ref,ne=k.current),O.key!==void 0&&(X=""+O.key),te.type&&te.type.defaultProps)var L=te.type.defaultProps;for(U in O)T.call(O,U)&&!P.hasOwnProperty(U)&&(W[U]=O[U]===void 0&&L!==void 0?L[U]:O[U])}var U=arguments.length-2;if(U===1)W.children=K;else if(1<U){L=Array(U);for(var H=0;H<U;H++)L[H]=arguments[H+2];W.children=L}return{$$typeof:e,type:te.type,key:X,ref:V,props:W,_owner:ne}},xt.createContext=function(te){return te={$$typeof:s,_currentValue:te,_currentValue2:te,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},te.Provider={$$typeof:i,_context:te},te.Consumer=te},xt.createElement=D,xt.createFactory=function(te){var O=D.bind(null,te);return O.type=te,O},xt.createRef=function(){return{current:null}},xt.forwardRef=function(te){return{$$typeof:c,render:te}},xt.isValidElement=q,xt.lazy=function(te){return{$$typeof:h,_payload:{_status:-1,_result:te},_init:me}},xt.memo=function(te,O){return{$$typeof:d,type:te,compare:O===void 0?null:O}},xt.startTransition=function(te){var O=he.transition;he.transition={};try{te()}finally{he.transition=O}},xt.unstable_act=xe,xt.useCallback=function(te,O){return de.current.useCallback(te,O)},xt.useContext=function(te){return de.current.useContext(te)},xt.useDebugValue=function(){},xt.useDeferredValue=function(te){return de.current.useDeferredValue(te)},xt.useEffect=function(te,O){return de.current.useEffect(te,O)},xt.useId=function(){return de.current.useId()},xt.useImperativeHandle=function(te,O,K){return de.current.useImperativeHandle(te,O,K)},xt.useInsertionEffect=function(te,O){return de.current.useInsertionEffect(te,O)},xt.useLayoutEffect=function(te,O){return de.current.useLayoutEffect(te,O)},xt.useMemo=function(te,O){return de.current.useMemo(te,O)},xt.useReducer=function(te,O,K){return de.current.useReducer(te,O,K)},xt.useRef=function(te){return de.current.useRef(te)},xt.useState=function(te){return de.current.useState(te)},xt.useSyncExternalStore=function(te,O,K){return de.current.useSyncExternalStore(te,O,K)},xt.useTransition=function(){return de.current.useTransition()},xt.version="18.3.1",xt}var PS;function yc(){return PS||(PS=1,cx.exports=n5()),cx.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OS;function a5(){if(OS)return vu;OS=1;var e=yc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(c,f,d){var h,m={},x=null,g=null;d!==void 0&&(x=""+d),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(g=f.ref);for(h in f)n.call(f,h)&&!i.hasOwnProperty(h)&&(m[h]=f[h]);if(c&&c.defaultProps)for(h in f=c.defaultProps,f)m[h]===void 0&&(m[h]=f[h]);return{$$typeof:t,type:c,key:x,ref:g,props:m,_owner:a.current}}return vu.Fragment=r,vu.jsx=s,vu.jsxs=s,vu}var FS;function i5(){return FS||(FS=1,lx.exports=a5()),lx.exports}var o=i5(),j=yc();const on=Ni(j),s5=a4({__proto__:null,default:on},[j]);var Zd={},ux={exports:{}},Vn={},fx={exports:{}},dx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DS;function o5(){return DS||(DS=1,(function(e){function t(he,J){var xe=he.length;he.push(J);e:for(;0<xe;){var te=xe-1>>>1,O=he[te];if(0<a(O,J))he[te]=J,he[xe]=O,xe=te;else break e}}function r(he){return he.length===0?null:he[0]}function n(he){if(he.length===0)return null;var J=he[0],xe=he.pop();if(xe!==J){he[0]=xe;e:for(var te=0,O=he.length,K=O>>>1;te<K;){var W=2*(te+1)-1,X=he[W],V=W+1,ne=he[V];if(0>a(X,xe))V<O&&0>a(ne,X)?(he[te]=ne,he[V]=xe,te=V):(he[te]=X,he[W]=xe,te=W);else if(V<O&&0>a(ne,xe))he[te]=ne,he[V]=xe,te=V;else break e}}return J}function a(he,J){var xe=he.sortIndex-J.sortIndex;return xe!==0?xe:he.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,c=s.now();e.unstable_now=function(){return s.now()-c}}var f=[],d=[],h=1,m=null,x=3,g=!1,y=!1,v=!1,b=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(he){for(var J=r(d);J!==null;){if(J.callback===null)n(d);else if(J.startTime<=he)n(d),J.sortIndex=J.expirationTime,t(f,J);else break;J=r(d)}}function C(he){if(v=!1,S(he),!y)if(r(f)!==null)y=!0,me(T);else{var J=r(d);J!==null&&de(C,J.startTime-he)}}function T(he,J){y=!1,v&&(v=!1,N(D),D=-1),g=!0;var xe=x;try{for(S(J),m=r(f);m!==null&&(!(m.expirationTime>J)||he&&!M());){var te=m.callback;if(typeof te=="function"){m.callback=null,x=m.priorityLevel;var O=te(m.expirationTime<=J);J=e.unstable_now(),typeof O=="function"?m.callback=O:m===r(f)&&n(f),S(J)}else n(f);m=r(f)}if(m!==null)var K=!0;else{var W=r(d);W!==null&&de(C,W.startTime-J),K=!1}return K}finally{m=null,x=xe,g=!1}}var k=!1,P=null,D=-1,R=5,q=-1;function M(){return!(e.unstable_now()-q<R)}function z(){if(P!==null){var he=e.unstable_now();q=he;var J=!0;try{J=P(!0,he)}finally{J?ie():(k=!1,P=null)}}else k=!1}var ie;if(typeof E=="function")ie=function(){E(z)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ae=ce.port2;ce.port1.onmessage=z,ie=function(){ae.postMessage(null)}}else ie=function(){b(z,0)};function me(he){P=he,k||(k=!0,ie())}function de(he,J){D=b(function(){he(e.unstable_now())},J)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(he){he.callback=null},e.unstable_continueExecution=function(){y||g||(y=!0,me(T))},e.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<he?Math.floor(1e3/he):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(he){switch(x){case 1:case 2:case 3:var J=3;break;default:J=x}var xe=x;x=J;try{return he()}finally{x=xe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(he,J){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var xe=x;x=he;try{return J()}finally{x=xe}},e.unstable_scheduleCallback=function(he,J,xe){var te=e.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?te+xe:te):xe=te,he){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=xe+O,he={id:h++,callback:J,priorityLevel:he,startTime:xe,expirationTime:O,sortIndex:-1},xe>te?(he.sortIndex=xe,t(d,he),r(f)===null&&he===r(d)&&(v?(N(D),D=-1):v=!0,de(C,xe-te))):(he.sortIndex=O,t(f,he),y||g||(y=!0,me(T))),he},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(he){var J=x;return function(){var xe=x;x=J;try{return he.apply(this,arguments)}finally{x=xe}}}})(dx)),dx}var IS;function l5(){return IS||(IS=1,fx.exports=o5()),fx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MS;function c5(){if(MS)return Vn;MS=1;var e=yc(),t=l5();function r(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,p=1;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(l,u){s(l,u),s(l+"Capture",u)}function s(l,u){for(a[l]=u,l=0;l<u.length;l++)n.add(u[l])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function x(l){return f.call(m,l)?!0:f.call(h,l)?!1:d.test(l)?m[l]=!0:(h[l]=!0,!1)}function g(l,u,p,w){if(p!==null&&p.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return w?!1:p!==null?!p.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function y(l,u,p,w){if(u===null||typeof u>"u"||g(l,u,p,w))return!0;if(w)return!1;if(p!==null)switch(p.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function v(l,u,p,w,_,A,I){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=w,this.attributeNamespace=_,this.mustUseProperty=p,this.propertyName=l,this.type=u,this.sanitizeURL=A,this.removeEmptyString=I}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){b[l]=new v(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var u=l[0];b[u]=new v(u,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){b[l]=new v(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){b[l]=new v(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){b[l]=new v(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){b[l]=new v(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){b[l]=new v(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){b[l]=new v(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){b[l]=new v(l,5,!1,l.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function E(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var u=l.replace(N,E);b[u]=new v(u,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var u=l.replace(N,E);b[u]=new v(u,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var u=l.replace(N,E);b[u]=new v(u,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){b[l]=new v(l,1,!1,l.toLowerCase(),null,!1,!1)}),b.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){b[l]=new v(l,1,!1,l.toLowerCase(),null,!0,!0)});function S(l,u,p,w){var _=b.hasOwnProperty(u)?b[u]:null;(_!==null?_.type!==0:w||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(y(u,p,_,w)&&(p=null),w||_===null?x(u)&&(p===null?l.removeAttribute(u):l.setAttribute(u,""+p)):_.mustUseProperty?l[_.propertyName]=p===null?_.type===3?!1:"":p:(u=_.attributeName,w=_.attributeNamespace,p===null?l.removeAttribute(u):(_=_.type,p=_===3||_===4&&p===!0?"":""+p,w?l.setAttributeNS(w,u,p):l.setAttribute(u,p))))}var C=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),k=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),q=Symbol.for("react.provider"),M=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),ie=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),de=Symbol.for("react.offscreen"),he=Symbol.iterator;function J(l){return l===null||typeof l!="object"?null:(l=he&&l[he]||l["@@iterator"],typeof l=="function"?l:null)}var xe=Object.assign,te;function O(l){if(te===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);te=u&&u[1]||""}return`
`+te+l}var K=!1;function W(l,u){if(!l||K)return"";K=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Ne){var w=Ne}Reflect.construct(l,[],u)}else{try{u.call()}catch(Ne){w=Ne}l.call(u.prototype)}else{try{throw Error()}catch(Ne){w=Ne}l()}}catch(Ne){if(Ne&&w&&typeof Ne.stack=="string"){for(var _=Ne.stack.split(`
`),A=w.stack.split(`
`),I=_.length-1,re=A.length-1;1<=I&&0<=re&&_[I]!==A[re];)re--;for(;1<=I&&0<=re;I--,re--)if(_[I]!==A[re]){if(I!==1||re!==1)do if(I--,re--,0>re||_[I]!==A[re]){var le=`
`+_[I].replace(" at new "," at ");return l.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",l.displayName)),le}while(1<=I&&0<=re);break}}}finally{K=!1,Error.prepareStackTrace=p}return(l=l?l.displayName||l.name:"")?O(l):""}function X(l){switch(l.tag){case 5:return O(l.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return l=W(l.type,!1),l;case 11:return l=W(l.type.render,!1),l;case 1:return l=W(l.type,!0),l;default:return""}}function V(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case P:return"Fragment";case k:return"Portal";case R:return"Profiler";case D:return"StrictMode";case ie:return"Suspense";case ce:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case M:return(l.displayName||"Context")+".Consumer";case q:return(l._context.displayName||"Context")+".Provider";case z:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case ae:return u=l.displayName||null,u!==null?u:V(l.type)||"Memo";case me:u=l._payload,l=l._init;try{return V(l(u))}catch{}}return null}function ne(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(u);case 8:return u===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function L(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function U(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function H(l){var u=U(l)?"checked":"value",p=Object.getOwnPropertyDescriptor(l.constructor.prototype,u),w=""+l[u];if(!l.hasOwnProperty(u)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var _=p.get,A=p.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return _.call(this)},set:function(I){w=""+I,A.call(this,I)}}),Object.defineProperty(l,u,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(I){w=""+I},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function oe(l){l._valueTracker||(l._valueTracker=H(l))}function F(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var p=u.getValue(),w="";return l&&(w=U(l)?l.checked?"true":"false":l.value),l=w,l!==p?(u.setValue(l),!0):!1}function Ae(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function je(l,u){var p=u.checked;return xe({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??l._wrapperState.initialChecked})}function Le(l,u){var p=u.defaultValue==null?"":u.defaultValue,w=u.checked!=null?u.checked:u.defaultChecked;p=L(u.value!=null?u.value:p),l._wrapperState={initialChecked:w,initialValue:p,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function Ue(l,u){u=u.checked,u!=null&&S(l,"checked",u,!1)}function Pe(l,u){Ue(l,u);var p=L(u.value),w=u.type;if(p!=null)w==="number"?(p===0&&l.value===""||l.value!=p)&&(l.value=""+p):l.value!==""+p&&(l.value=""+p);else if(w==="submit"||w==="reset"){l.removeAttribute("value");return}u.hasOwnProperty("value")?kt(l,u.type,p):u.hasOwnProperty("defaultValue")&&kt(l,u.type,L(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(l.defaultChecked=!!u.defaultChecked)}function ot(l,u,p){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var w=u.type;if(!(w!=="submit"&&w!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+l._wrapperState.initialValue,p||u===l.value||(l.value=u),l.defaultValue=u}p=l.name,p!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,p!==""&&(l.name=p)}function kt(l,u,p){(u!=="number"||Ae(l.ownerDocument)!==l)&&(p==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+p&&(l.defaultValue=""+p))}var Yt=Array.isArray;function jt(l,u,p,w){if(l=l.options,u){u={};for(var _=0;_<p.length;_++)u["$"+p[_]]=!0;for(p=0;p<l.length;p++)_=u.hasOwnProperty("$"+l[p].value),l[p].selected!==_&&(l[p].selected=_),_&&w&&(l[p].defaultSelected=!0)}else{for(p=""+L(p),u=null,_=0;_<l.length;_++){if(l[_].value===p){l[_].selected=!0,w&&(l[_].defaultSelected=!0);return}u!==null||l[_].disabled||(u=l[_])}u!==null&&(u.selected=!0)}}function za(l,u){if(u.dangerouslySetInnerHTML!=null)throw Error(r(91));return xe({},u,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Rn(l,u){var p=u.value;if(p==null){if(p=u.children,u=u.defaultValue,p!=null){if(u!=null)throw Error(r(92));if(Yt(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),p=u}l._wrapperState={initialValue:L(p)}}function Br(l,u){var p=L(u.value),w=L(u.defaultValue);p!=null&&(p=""+p,p!==l.value&&(l.value=p),u.defaultValue==null&&l.defaultValue!==p&&(l.defaultValue=p)),w!=null&&(l.defaultValue=""+w)}function tr(l){var u=l.textContent;u===l._wrapperState.initialValue&&u!==""&&u!==null&&(l.value=u)}function Ln(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function en(l,u){return l==null||l==="http://www.w3.org/1999/xhtml"?Ln(u):l==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var rr,Cn=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,p,w,_){MSApp.execUnsafeLocalFunction(function(){return l(u,p,w,_)})}:l})(function(l,u){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=u;else{for(rr=rr||document.createElement("div"),rr.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=rr.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;u.firstChild;)l.appendChild(u.firstChild)}});function ut(l,u){if(u){var p=l.firstChild;if(p&&p===l.lastChild&&p.nodeType===3){p.nodeValue=u;return}}l.textContent=u}var Ct={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},se=["Webkit","ms","Moz","O"];Object.keys(Ct).forEach(function(l){se.forEach(function(u){u=u+l.charAt(0).toUpperCase()+l.substring(1),Ct[u]=Ct[l]})});function ke(l,u,p){return u==null||typeof u=="boolean"||u===""?"":p||typeof u!="number"||u===0||Ct.hasOwnProperty(l)&&Ct[l]?(""+u).trim():u+"px"}function Ke(l,u){l=l.style;for(var p in u)if(u.hasOwnProperty(p)){var w=p.indexOf("--")===0,_=ke(p,u[p],w);p==="float"&&(p="cssFloat"),w?l.setProperty(p,_):l[p]=_}}var Je=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function We(l,u){if(u){if(Je[l]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(r(137,l));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(r(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(r(61))}if(u.style!=null&&typeof u.style!="object")throw Error(r(62))}}function at(l,u){if(l.indexOf("-")===-1)return typeof u.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jr=null;function Cr(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var tn=null,Ar=null,$r=null;function Bn(l){if(l=nu(l)){if(typeof tn!="function")throw Error(r(280));var u=l.stateNode;u&&(u=md(u),tn(l.stateNode,l.type,u))}}function so(l){Ar?$r?$r.push(l):$r=[l]:Ar=l}function Ic(){if(Ar){var l=Ar,u=$r;if($r=Ar=null,Bn(l),u)for(l=0;l<u.length;l++)Bn(u[l])}}function ki(l,u){return l(u)}function Xf(){}var Mc=!1;function qf(l,u,p){if(Mc)return l(u,p);Mc=!0;try{return ki(l,u,p)}finally{Mc=!1,(Ar!==null||$r!==null)&&(Xf(),Ic())}}function oo(l,u){var p=l.stateNode;if(p===null)return null;var w=md(p);if(w===null)return null;p=w[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(l=l.type,w=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!w;break e;default:l=!1}if(l)return null;if(p&&typeof p!="function")throw Error(r(231,u,typeof p));return p}var Rc=!1;if(c)try{var ji={};Object.defineProperty(ji,"passive",{get:function(){Rc=!0}}),window.addEventListener("test",ji,ji),window.removeEventListener("test",ji,ji)}catch{Rc=!1}function Cm(l,u,p,w,_,A,I,re,le){var Ne=Array.prototype.slice.call(arguments,3);try{u.apply(p,Ne)}catch(Oe){this.onError(Oe)}}var lo=!1,pl=null,B=!1,Q=null,G={onError:function(l){lo=!0,pl=l}};function Y(l,u,p,w,_,A,I,re,le){lo=!1,pl=null,Cm.apply(G,arguments)}function Z(l,u,p,w,_,A,I,re,le){if(Y.apply(this,arguments),lo){if(lo){var Ne=pl;lo=!1,pl=null}else throw Error(r(198));B||(B=!0,Q=Ne)}}function ee(l){var u=l,p=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(p=u.return),l=u.return;while(l)}return u.tag===3?p:null}function ye(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function Ee(l){if(ee(l)!==l)throw Error(r(188))}function ve(l){var u=l.alternate;if(!u){if(u=ee(l),u===null)throw Error(r(188));return u!==l?null:l}for(var p=l,w=u;;){var _=p.return;if(_===null)break;var A=_.alternate;if(A===null){if(w=_.return,w!==null){p=w;continue}break}if(_.child===A.child){for(A=_.child;A;){if(A===p)return Ee(_),l;if(A===w)return Ee(_),u;A=A.sibling}throw Error(r(188))}if(p.return!==w.return)p=_,w=A;else{for(var I=!1,re=_.child;re;){if(re===p){I=!0,p=_,w=A;break}if(re===w){I=!0,w=_,p=A;break}re=re.sibling}if(!I){for(re=A.child;re;){if(re===p){I=!0,p=A,w=_;break}if(re===w){I=!0,w=A,p=_;break}re=re.sibling}if(!I)throw Error(r(189))}}if(p.alternate!==w)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?l:u}function we(l){return l=ve(l),l!==null?be(l):null}function be(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=be(l);if(u!==null)return u;l=l.sibling}return null}var Fe=t.unstable_scheduleCallback,ze=t.unstable_cancelCallback,Ve=t.unstable_shouldYield,Me=t.unstable_requestPaint,Ie=t.unstable_now,dt=t.unstable_getCurrentPriorityLevel,Lt=t.unstable_ImmediatePriority,Ut=t.unstable_UserBlockingPriority,hr=t.unstable_NormalPriority,co=t.unstable_LowPriority,us=t.unstable_IdlePriority,ii=null,Ur=null;function Lc(l){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(ii,l,void 0,(l.current.flags&128)===128)}catch{}}var mr=Math.clz32?Math.clz32:b6,y6=Math.log,w6=Math.LN2;function b6(l){return l>>>=0,l===0?32:31-(y6(l)/w6|0)|0}var Yf=64,Jf=4194304;function Bc(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Qf(l,u){var p=l.pendingLanes;if(p===0)return 0;var w=0,_=l.suspendedLanes,A=l.pingedLanes,I=p&268435455;if(I!==0){var re=I&~_;re!==0?w=Bc(re):(A&=I,A!==0&&(w=Bc(A)))}else I=p&~_,I!==0?w=Bc(I):A!==0&&(w=Bc(A));if(w===0)return 0;if(u!==0&&u!==w&&(u&_)===0&&(_=w&-w,A=u&-u,_>=A||_===16&&(A&4194240)!==0))return u;if((w&4)!==0&&(w|=p&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=w;0<u;)p=31-mr(u),_=1<<p,w|=l[p],u&=~_;return w}function S6(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function N6(l,u){for(var p=l.suspendedLanes,w=l.pingedLanes,_=l.expirationTimes,A=l.pendingLanes;0<A;){var I=31-mr(A),re=1<<I,le=_[I];le===-1?((re&p)===0||(re&w)!==0)&&(_[I]=S6(re,u)):le<=u&&(l.expiredLanes|=re),A&=~re}}function Am(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function ob(){var l=Yf;return Yf<<=1,(Yf&4194240)===0&&(Yf=64),l}function Tm(l){for(var u=[],p=0;31>p;p++)u.push(l);return u}function $c(l,u,p){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-mr(u),l[u]=p}function _6(l,u){var p=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var w=l.eventTimes;for(l=l.expirationTimes;0<p;){var _=31-mr(p),A=1<<_;u[_]=0,w[_]=-1,l[_]=-1,p&=~A}}function Pm(l,u){var p=l.entangledLanes|=u;for(l=l.entanglements;p;){var w=31-mr(p),_=1<<w;_&u|l[w]&u&&(l[w]|=u),p&=~_}}var At=0;function lb(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var cb,Om,ub,fb,db,Fm=!1,Zf=[],fs=null,ds=null,hs=null,Uc=new Map,zc=new Map,ms=[],E6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hb(l,u){switch(l){case"focusin":case"focusout":fs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":hs=null;break;case"pointerover":case"pointerout":Uc.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":zc.delete(u.pointerId)}}function Wc(l,u,p,w,_,A){return l===null||l.nativeEvent!==A?(l={blockedOn:u,domEventName:p,eventSystemFlags:w,nativeEvent:A,targetContainers:[_]},u!==null&&(u=nu(u),u!==null&&Om(u)),l):(l.eventSystemFlags|=w,u=l.targetContainers,_!==null&&u.indexOf(_)===-1&&u.push(_),l)}function k6(l,u,p,w,_){switch(u){case"focusin":return fs=Wc(fs,l,u,p,w,_),!0;case"dragenter":return ds=Wc(ds,l,u,p,w,_),!0;case"mouseover":return hs=Wc(hs,l,u,p,w,_),!0;case"pointerover":var A=_.pointerId;return Uc.set(A,Wc(Uc.get(A)||null,l,u,p,w,_)),!0;case"gotpointercapture":return A=_.pointerId,zc.set(A,Wc(zc.get(A)||null,l,u,p,w,_)),!0}return!1}function mb(l){var u=uo(l.target);if(u!==null){var p=ee(u);if(p!==null){if(u=p.tag,u===13){if(u=ye(p),u!==null){l.blockedOn=u,db(l.priority,function(){ub(p)});return}}else if(u===3&&p.stateNode.current.memoizedState.isDehydrated){l.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}l.blockedOn=null}function ed(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var p=Im(l.domEventName,l.eventSystemFlags,u[0],l.nativeEvent);if(p===null){p=l.nativeEvent;var w=new p.constructor(p.type,p);jr=w,p.target.dispatchEvent(w),jr=null}else return u=nu(p),u!==null&&Om(u),l.blockedOn=p,!1;u.shift()}return!0}function pb(l,u,p){ed(l)&&p.delete(u)}function j6(){Fm=!1,fs!==null&&ed(fs)&&(fs=null),ds!==null&&ed(ds)&&(ds=null),hs!==null&&ed(hs)&&(hs=null),Uc.forEach(pb),zc.forEach(pb)}function Hc(l,u){l.blockedOn===u&&(l.blockedOn=null,Fm||(Fm=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,j6)))}function Vc(l){function u(_){return Hc(_,l)}if(0<Zf.length){Hc(Zf[0],l);for(var p=1;p<Zf.length;p++){var w=Zf[p];w.blockedOn===l&&(w.blockedOn=null)}}for(fs!==null&&Hc(fs,l),ds!==null&&Hc(ds,l),hs!==null&&Hc(hs,l),Uc.forEach(u),zc.forEach(u),p=0;p<ms.length;p++)w=ms[p],w.blockedOn===l&&(w.blockedOn=null);for(;0<ms.length&&(p=ms[0],p.blockedOn===null);)mb(p),p.blockedOn===null&&ms.shift()}var xl=C.ReactCurrentBatchConfig,td=!0;function C6(l,u,p,w){var _=At,A=xl.transition;xl.transition=null;try{At=1,Dm(l,u,p,w)}finally{At=_,xl.transition=A}}function A6(l,u,p,w){var _=At,A=xl.transition;xl.transition=null;try{At=4,Dm(l,u,p,w)}finally{At=_,xl.transition=A}}function Dm(l,u,p,w){if(td){var _=Im(l,u,p,w);if(_===null)Qm(l,u,w,rd,p),hb(l,w);else if(k6(_,l,u,p,w))w.stopPropagation();else if(hb(l,w),u&4&&-1<E6.indexOf(l)){for(;_!==null;){var A=nu(_);if(A!==null&&cb(A),A=Im(l,u,p,w),A===null&&Qm(l,u,w,rd,p),A===_)break;_=A}_!==null&&w.stopPropagation()}else Qm(l,u,w,null,p)}}var rd=null;function Im(l,u,p,w){if(rd=null,l=Cr(w),l=uo(l),l!==null)if(u=ee(l),u===null)l=null;else if(p=u.tag,p===13){if(l=ye(u),l!==null)return l;l=null}else if(p===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null);return rd=l,null}function xb(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dt()){case Lt:return 1;case Ut:return 4;case hr:case co:return 16;case us:return 536870912;default:return 16}default:return 16}}var ps=null,Mm=null,nd=null;function gb(){if(nd)return nd;var l,u=Mm,p=u.length,w,_="value"in ps?ps.value:ps.textContent,A=_.length;for(l=0;l<p&&u[l]===_[l];l++);var I=p-l;for(w=1;w<=I&&u[p-w]===_[A-w];w++);return nd=_.slice(l,1<w?1-w:void 0)}function ad(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function id(){return!0}function vb(){return!1}function Qn(l){function u(p,w,_,A,I){this._reactName=p,this._targetInst=_,this.type=w,this.nativeEvent=A,this.target=I,this.currentTarget=null;for(var re in l)l.hasOwnProperty(re)&&(p=l[re],this[re]=p?p(A):A[re]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?id:vb,this.isPropagationStopped=vb,this}return xe(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=id)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=id)},persist:function(){},isPersistent:id}),u}var gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rm=Qn(gl),Kc=xe({},gl,{view:0,detail:0}),T6=Qn(Kc),Lm,Bm,Gc,sd=xe({},Kc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Um,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Gc&&(Gc&&l.type==="mousemove"?(Lm=l.screenX-Gc.screenX,Bm=l.screenY-Gc.screenY):Bm=Lm=0,Gc=l),Lm)},movementY:function(l){return"movementY"in l?l.movementY:Bm}}),yb=Qn(sd),P6=xe({},sd,{dataTransfer:0}),O6=Qn(P6),F6=xe({},Kc,{relatedTarget:0}),$m=Qn(F6),D6=xe({},gl,{animationName:0,elapsedTime:0,pseudoElement:0}),I6=Qn(D6),M6=xe({},gl,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),R6=Qn(M6),L6=xe({},gl,{data:0}),wb=Qn(L6),B6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},U6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function z6(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=U6[l])?!!u[l]:!1}function Um(){return z6}var W6=xe({},Kc,{key:function(l){if(l.key){var u=B6[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=ad(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?$6[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Um,charCode:function(l){return l.type==="keypress"?ad(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?ad(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),H6=Qn(W6),V6=xe({},sd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bb=Qn(V6),K6=xe({},Kc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Um}),G6=Qn(K6),X6=xe({},gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),q6=Qn(X6),Y6=xe({},sd,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),J6=Qn(Y6),Q6=[9,13,27,32],zm=c&&"CompositionEvent"in window,Xc=null;c&&"documentMode"in document&&(Xc=document.documentMode);var Z6=c&&"TextEvent"in window&&!Xc,Sb=c&&(!zm||Xc&&8<Xc&&11>=Xc),Nb=" ",_b=!1;function Eb(l,u){switch(l){case"keyup":return Q6.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kb(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var vl=!1;function eF(l,u){switch(l){case"compositionend":return kb(u);case"keypress":return u.which!==32?null:(_b=!0,Nb);case"textInput":return l=u.data,l===Nb&&_b?null:l;default:return null}}function tF(l,u){if(vl)return l==="compositionend"||!zm&&Eb(l,u)?(l=gb(),nd=Mm=ps=null,vl=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Sb&&u.locale!=="ko"?null:u.data;default:return null}}var rF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jb(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!rF[l.type]:u==="textarea"}function Cb(l,u,p,w){so(w),u=fd(u,"onChange"),0<u.length&&(p=new Rm("onChange","change",null,p,w),l.push({event:p,listeners:u}))}var qc=null,Yc=null;function nF(l){Kb(l,0)}function od(l){var u=Nl(l);if(F(u))return l}function aF(l,u){if(l==="change")return u}var Ab=!1;if(c){var Wm;if(c){var Hm="oninput"in document;if(!Hm){var Tb=document.createElement("div");Tb.setAttribute("oninput","return;"),Hm=typeof Tb.oninput=="function"}Wm=Hm}else Wm=!1;Ab=Wm&&(!document.documentMode||9<document.documentMode)}function Pb(){qc&&(qc.detachEvent("onpropertychange",Ob),Yc=qc=null)}function Ob(l){if(l.propertyName==="value"&&od(Yc)){var u=[];Cb(u,Yc,l,Cr(l)),qf(nF,u)}}function iF(l,u,p){l==="focusin"?(Pb(),qc=u,Yc=p,qc.attachEvent("onpropertychange",Ob)):l==="focusout"&&Pb()}function sF(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return od(Yc)}function oF(l,u){if(l==="click")return od(u)}function lF(l,u){if(l==="input"||l==="change")return od(u)}function cF(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var Wa=typeof Object.is=="function"?Object.is:cF;function Jc(l,u){if(Wa(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var p=Object.keys(l),w=Object.keys(u);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var _=p[w];if(!f.call(u,_)||!Wa(l[_],u[_]))return!1}return!0}function Fb(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function Db(l,u){var p=Fb(l);l=0;for(var w;p;){if(p.nodeType===3){if(w=l+p.textContent.length,l<=u&&w>=u)return{node:p,offset:u-l};l=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Fb(p)}}function Ib(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?Ib(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function Mb(){for(var l=window,u=Ae();u instanceof l.HTMLIFrameElement;){try{var p=typeof u.contentWindow.location.href=="string"}catch{p=!1}if(p)l=u.contentWindow;else break;u=Ae(l.document)}return u}function Vm(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}function uF(l){var u=Mb(),p=l.focusedElem,w=l.selectionRange;if(u!==p&&p&&p.ownerDocument&&Ib(p.ownerDocument.documentElement,p)){if(w!==null&&Vm(p)){if(u=w.start,l=w.end,l===void 0&&(l=u),"selectionStart"in p)p.selectionStart=u,p.selectionEnd=Math.min(l,p.value.length);else if(l=(u=p.ownerDocument||document)&&u.defaultView||window,l.getSelection){l=l.getSelection();var _=p.textContent.length,A=Math.min(w.start,_);w=w.end===void 0?A:Math.min(w.end,_),!l.extend&&A>w&&(_=w,w=A,A=_),_=Db(p,A);var I=Db(p,w);_&&I&&(l.rangeCount!==1||l.anchorNode!==_.node||l.anchorOffset!==_.offset||l.focusNode!==I.node||l.focusOffset!==I.offset)&&(u=u.createRange(),u.setStart(_.node,_.offset),l.removeAllRanges(),A>w?(l.addRange(u),l.extend(I.node,I.offset)):(u.setEnd(I.node,I.offset),l.addRange(u)))}}for(u=[],l=p;l=l.parentNode;)l.nodeType===1&&u.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<u.length;p++)l=u[p],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var fF=c&&"documentMode"in document&&11>=document.documentMode,yl=null,Km=null,Qc=null,Gm=!1;function Rb(l,u,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Gm||yl==null||yl!==Ae(w)||(w=yl,"selectionStart"in w&&Vm(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Qc&&Jc(Qc,w)||(Qc=w,w=fd(Km,"onSelect"),0<w.length&&(u=new Rm("onSelect","select",null,u,p),l.push({event:u,listeners:w}),u.target=yl)))}function ld(l,u){var p={};return p[l.toLowerCase()]=u.toLowerCase(),p["Webkit"+l]="webkit"+u,p["Moz"+l]="moz"+u,p}var wl={animationend:ld("Animation","AnimationEnd"),animationiteration:ld("Animation","AnimationIteration"),animationstart:ld("Animation","AnimationStart"),transitionend:ld("Transition","TransitionEnd")},Xm={},Lb={};c&&(Lb=document.createElement("div").style,"AnimationEvent"in window||(delete wl.animationend.animation,delete wl.animationiteration.animation,delete wl.animationstart.animation),"TransitionEvent"in window||delete wl.transitionend.transition);function cd(l){if(Xm[l])return Xm[l];if(!wl[l])return l;var u=wl[l],p;for(p in u)if(u.hasOwnProperty(p)&&p in Lb)return Xm[l]=u[p];return l}var Bb=cd("animationend"),$b=cd("animationiteration"),Ub=cd("animationstart"),zb=cd("transitionend"),Wb=new Map,Hb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xs(l,u){Wb.set(l,u),i(u,[l])}for(var qm=0;qm<Hb.length;qm++){var Ym=Hb[qm],dF=Ym.toLowerCase(),hF=Ym[0].toUpperCase()+Ym.slice(1);xs(dF,"on"+hF)}xs(Bb,"onAnimationEnd"),xs($b,"onAnimationIteration"),xs(Ub,"onAnimationStart"),xs("dblclick","onDoubleClick"),xs("focusin","onFocus"),xs("focusout","onBlur"),xs(zb,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zc));function Vb(l,u,p){var w=l.type||"unknown-event";l.currentTarget=p,Z(w,u,void 0,l),l.currentTarget=null}function Kb(l,u){u=(u&4)!==0;for(var p=0;p<l.length;p++){var w=l[p],_=w.event;w=w.listeners;e:{var A=void 0;if(u)for(var I=w.length-1;0<=I;I--){var re=w[I],le=re.instance,Ne=re.currentTarget;if(re=re.listener,le!==A&&_.isPropagationStopped())break e;Vb(_,re,Ne),A=le}else for(I=0;I<w.length;I++){if(re=w[I],le=re.instance,Ne=re.currentTarget,re=re.listener,le!==A&&_.isPropagationStopped())break e;Vb(_,re,Ne),A=le}}}if(B)throw l=Q,B=!1,Q=null,l}function Ht(l,u){var p=u[ap];p===void 0&&(p=u[ap]=new Set);var w=l+"__bubble";p.has(w)||(Gb(u,l,2,!1),p.add(w))}function Jm(l,u,p){var w=0;u&&(w|=4),Gb(p,l,w,u)}var ud="_reactListening"+Math.random().toString(36).slice(2);function eu(l){if(!l[ud]){l[ud]=!0,n.forEach(function(p){p!=="selectionchange"&&(mF.has(p)||Jm(p,!1,l),Jm(p,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[ud]||(u[ud]=!0,Jm("selectionchange",!1,u))}}function Gb(l,u,p,w){switch(xb(u)){case 1:var _=C6;break;case 4:_=A6;break;default:_=Dm}p=_.bind(null,u,p,l),_=void 0,!Rc||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(_=!0),w?_!==void 0?l.addEventListener(u,p,{capture:!0,passive:_}):l.addEventListener(u,p,!0):_!==void 0?l.addEventListener(u,p,{passive:_}):l.addEventListener(u,p,!1)}function Qm(l,u,p,w,_){var A=w;if((u&1)===0&&(u&2)===0&&w!==null)e:for(;;){if(w===null)return;var I=w.tag;if(I===3||I===4){var re=w.stateNode.containerInfo;if(re===_||re.nodeType===8&&re.parentNode===_)break;if(I===4)for(I=w.return;I!==null;){var le=I.tag;if((le===3||le===4)&&(le=I.stateNode.containerInfo,le===_||le.nodeType===8&&le.parentNode===_))return;I=I.return}for(;re!==null;){if(I=uo(re),I===null)return;if(le=I.tag,le===5||le===6){w=A=I;continue e}re=re.parentNode}}w=w.return}qf(function(){var Ne=A,Oe=Cr(p),De=[];e:{var Te=Wb.get(l);if(Te!==void 0){var He=Rm,qe=l;switch(l){case"keypress":if(ad(p)===0)break e;case"keydown":case"keyup":He=H6;break;case"focusin":qe="focus",He=$m;break;case"focusout":qe="blur",He=$m;break;case"beforeblur":case"afterblur":He=$m;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":He=yb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":He=O6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":He=G6;break;case Bb:case $b:case Ub:He=I6;break;case zb:He=q6;break;case"scroll":He=T6;break;case"wheel":He=J6;break;case"copy":case"cut":case"paste":He=R6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":He=bb}var Ye=(u&4)!==0,pr=!Ye&&l==="scroll",pe=Ye?Te!==null?Te+"Capture":null:Te;Ye=[];for(var ue=Ne,ge;ue!==null;){ge=ue;var Re=ge.stateNode;if(ge.tag===5&&Re!==null&&(ge=Re,pe!==null&&(Re=oo(ue,pe),Re!=null&&Ye.push(tu(ue,Re,ge)))),pr)break;ue=ue.return}0<Ye.length&&(Te=new He(Te,qe,null,p,Oe),De.push({event:Te,listeners:Ye}))}}if((u&7)===0){e:{if(Te=l==="mouseover"||l==="pointerover",He=l==="mouseout"||l==="pointerout",Te&&p!==jr&&(qe=p.relatedTarget||p.fromElement)&&(uo(qe)||qe[Ci]))break e;if((He||Te)&&(Te=Oe.window===Oe?Oe:(Te=Oe.ownerDocument)?Te.defaultView||Te.parentWindow:window,He?(qe=p.relatedTarget||p.toElement,He=Ne,qe=qe?uo(qe):null,qe!==null&&(pr=ee(qe),qe!==pr||qe.tag!==5&&qe.tag!==6)&&(qe=null)):(He=null,qe=Ne),He!==qe)){if(Ye=yb,Re="onMouseLeave",pe="onMouseEnter",ue="mouse",(l==="pointerout"||l==="pointerover")&&(Ye=bb,Re="onPointerLeave",pe="onPointerEnter",ue="pointer"),pr=He==null?Te:Nl(He),ge=qe==null?Te:Nl(qe),Te=new Ye(Re,ue+"leave",He,p,Oe),Te.target=pr,Te.relatedTarget=ge,Re=null,uo(Oe)===Ne&&(Ye=new Ye(pe,ue+"enter",qe,p,Oe),Ye.target=ge,Ye.relatedTarget=pr,Re=Ye),pr=Re,He&&qe)t:{for(Ye=He,pe=qe,ue=0,ge=Ye;ge;ge=bl(ge))ue++;for(ge=0,Re=pe;Re;Re=bl(Re))ge++;for(;0<ue-ge;)Ye=bl(Ye),ue--;for(;0<ge-ue;)pe=bl(pe),ge--;for(;ue--;){if(Ye===pe||pe!==null&&Ye===pe.alternate)break t;Ye=bl(Ye),pe=bl(pe)}Ye=null}else Ye=null;He!==null&&Xb(De,Te,He,Ye,!1),qe!==null&&pr!==null&&Xb(De,pr,qe,Ye,!0)}}e:{if(Te=Ne?Nl(Ne):window,He=Te.nodeName&&Te.nodeName.toLowerCase(),He==="select"||He==="input"&&Te.type==="file")var Qe=aF;else if(jb(Te))if(Ab)Qe=lF;else{Qe=sF;var rt=iF}else(He=Te.nodeName)&&He.toLowerCase()==="input"&&(Te.type==="checkbox"||Te.type==="radio")&&(Qe=oF);if(Qe&&(Qe=Qe(l,Ne))){Cb(De,Qe,p,Oe);break e}rt&&rt(l,Te,Ne),l==="focusout"&&(rt=Te._wrapperState)&&rt.controlled&&Te.type==="number"&&kt(Te,"number",Te.value)}switch(rt=Ne?Nl(Ne):window,l){case"focusin":(jb(rt)||rt.contentEditable==="true")&&(yl=rt,Km=Ne,Qc=null);break;case"focusout":Qc=Km=yl=null;break;case"mousedown":Gm=!0;break;case"contextmenu":case"mouseup":case"dragend":Gm=!1,Rb(De,p,Oe);break;case"selectionchange":if(fF)break;case"keydown":case"keyup":Rb(De,p,Oe)}var nt;if(zm)e:{switch(l){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else vl?Eb(l,p)&&(ft="onCompositionEnd"):l==="keydown"&&p.keyCode===229&&(ft="onCompositionStart");ft&&(Sb&&p.locale!=="ko"&&(vl||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&vl&&(nt=gb()):(ps=Oe,Mm="value"in ps?ps.value:ps.textContent,vl=!0)),rt=fd(Ne,ft),0<rt.length&&(ft=new wb(ft,l,null,p,Oe),De.push({event:ft,listeners:rt}),nt?ft.data=nt:(nt=kb(p),nt!==null&&(ft.data=nt)))),(nt=Z6?eF(l,p):tF(l,p))&&(Ne=fd(Ne,"onBeforeInput"),0<Ne.length&&(Oe=new wb("onBeforeInput","beforeinput",null,p,Oe),De.push({event:Oe,listeners:Ne}),Oe.data=nt))}Kb(De,u)})}function tu(l,u,p){return{instance:l,listener:u,currentTarget:p}}function fd(l,u){for(var p=u+"Capture",w=[];l!==null;){var _=l,A=_.stateNode;_.tag===5&&A!==null&&(_=A,A=oo(l,p),A!=null&&w.unshift(tu(l,A,_)),A=oo(l,u),A!=null&&w.push(tu(l,A,_))),l=l.return}return w}function bl(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function Xb(l,u,p,w,_){for(var A=u._reactName,I=[];p!==null&&p!==w;){var re=p,le=re.alternate,Ne=re.stateNode;if(le!==null&&le===w)break;re.tag===5&&Ne!==null&&(re=Ne,_?(le=oo(p,A),le!=null&&I.unshift(tu(p,le,re))):_||(le=oo(p,A),le!=null&&I.push(tu(p,le,re)))),p=p.return}I.length!==0&&l.push({event:u,listeners:I})}var pF=/\r\n?/g,xF=/\u0000|\uFFFD/g;function qb(l){return(typeof l=="string"?l:""+l).replace(pF,`
`).replace(xF,"")}function dd(l,u,p){if(u=qb(u),qb(l)!==u&&p)throw Error(r(425))}function hd(){}var Zm=null,ep=null;function tp(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var rp=typeof setTimeout=="function"?setTimeout:void 0,gF=typeof clearTimeout=="function"?clearTimeout:void 0,Yb=typeof Promise=="function"?Promise:void 0,vF=typeof queueMicrotask=="function"?queueMicrotask:typeof Yb<"u"?function(l){return Yb.resolve(null).then(l).catch(yF)}:rp;function yF(l){setTimeout(function(){throw l})}function np(l,u){var p=u,w=0;do{var _=p.nextSibling;if(l.removeChild(p),_&&_.nodeType===8)if(p=_.data,p==="/$"){if(w===0){l.removeChild(_),Vc(u);return}w--}else p!=="$"&&p!=="$?"&&p!=="$!"||w++;p=_}while(p);Vc(u)}function gs(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return l}function Jb(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var p=l.data;if(p==="$"||p==="$!"||p==="$?"){if(u===0)return l;u--}else p==="/$"&&u++}l=l.previousSibling}return null}var Sl=Math.random().toString(36).slice(2),si="__reactFiber$"+Sl,ru="__reactProps$"+Sl,Ci="__reactContainer$"+Sl,ap="__reactEvents$"+Sl,wF="__reactListeners$"+Sl,bF="__reactHandles$"+Sl;function uo(l){var u=l[si];if(u)return u;for(var p=l.parentNode;p;){if(u=p[Ci]||p[si]){if(p=u.alternate,u.child!==null||p!==null&&p.child!==null)for(l=Jb(l);l!==null;){if(p=l[si])return p;l=Jb(l)}return u}l=p,p=l.parentNode}return null}function nu(l){return l=l[si]||l[Ci],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Nl(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(r(33))}function md(l){return l[ru]||null}var ip=[],_l=-1;function vs(l){return{current:l}}function Vt(l){0>_l||(l.current=ip[_l],ip[_l]=null,_l--)}function zt(l,u){_l++,ip[_l]=l.current,l.current=u}var ys={},dn=vs(ys),$n=vs(!1),fo=ys;function El(l,u){var p=l.type.contextTypes;if(!p)return ys;var w=l.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===u)return w.__reactInternalMemoizedMaskedChildContext;var _={},A;for(A in p)_[A]=u[A];return w&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=_),_}function Un(l){return l=l.childContextTypes,l!=null}function pd(){Vt($n),Vt(dn)}function Qb(l,u,p){if(dn.current!==ys)throw Error(r(168));zt(dn,u),zt($n,p)}function Zb(l,u,p){var w=l.stateNode;if(u=u.childContextTypes,typeof w.getChildContext!="function")return p;w=w.getChildContext();for(var _ in w)if(!(_ in u))throw Error(r(108,ne(l)||"Unknown",_));return xe({},p,w)}function xd(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||ys,fo=dn.current,zt(dn,l),zt($n,$n.current),!0}function e2(l,u,p){var w=l.stateNode;if(!w)throw Error(r(169));p?(l=Zb(l,u,fo),w.__reactInternalMemoizedMergedChildContext=l,Vt($n),Vt(dn),zt(dn,l)):Vt($n),zt($n,p)}var Ai=null,gd=!1,sp=!1;function t2(l){Ai===null?Ai=[l]:Ai.push(l)}function SF(l){gd=!0,t2(l)}function ws(){if(!sp&&Ai!==null){sp=!0;var l=0,u=At;try{var p=Ai;for(At=1;l<p.length;l++){var w=p[l];do w=w(!0);while(w!==null)}Ai=null,gd=!1}catch(_){throw Ai!==null&&(Ai=Ai.slice(l+1)),Fe(Lt,ws),_}finally{At=u,sp=!1}}return null}var kl=[],jl=0,vd=null,yd=0,ga=[],va=0,ho=null,Ti=1,Pi="";function mo(l,u){kl[jl++]=yd,kl[jl++]=vd,vd=l,yd=u}function r2(l,u,p){ga[va++]=Ti,ga[va++]=Pi,ga[va++]=ho,ho=l;var w=Ti;l=Pi;var _=32-mr(w)-1;w&=~(1<<_),p+=1;var A=32-mr(u)+_;if(30<A){var I=_-_%5;A=(w&(1<<I)-1).toString(32),w>>=I,_-=I,Ti=1<<32-mr(u)+_|p<<_|w,Pi=A+l}else Ti=1<<A|p<<_|w,Pi=l}function op(l){l.return!==null&&(mo(l,1),r2(l,1,0))}function lp(l){for(;l===vd;)vd=kl[--jl],kl[jl]=null,yd=kl[--jl],kl[jl]=null;for(;l===ho;)ho=ga[--va],ga[va]=null,Pi=ga[--va],ga[va]=null,Ti=ga[--va],ga[va]=null}var Zn=null,ea=null,Jt=!1,Ha=null;function n2(l,u){var p=Sa(5,null,null,0);p.elementType="DELETED",p.stateNode=u,p.return=l,u=l.deletions,u===null?(l.deletions=[p],l.flags|=16):u.push(p)}function a2(l,u){switch(l.tag){case 5:var p=l.type;return u=u.nodeType!==1||p.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(l.stateNode=u,Zn=l,ea=gs(u.firstChild),!0):!1;case 6:return u=l.pendingProps===""||u.nodeType!==3?null:u,u!==null?(l.stateNode=u,Zn=l,ea=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(p=ho!==null?{id:Ti,overflow:Pi}:null,l.memoizedState={dehydrated:u,treeContext:p,retryLane:1073741824},p=Sa(18,null,null,0),p.stateNode=u,p.return=l,l.child=p,Zn=l,ea=null,!0):!1;default:return!1}}function cp(l){return(l.mode&1)!==0&&(l.flags&128)===0}function up(l){if(Jt){var u=ea;if(u){var p=u;if(!a2(l,u)){if(cp(l))throw Error(r(418));u=gs(p.nextSibling);var w=Zn;u&&a2(l,u)?n2(w,p):(l.flags=l.flags&-4097|2,Jt=!1,Zn=l)}}else{if(cp(l))throw Error(r(418));l.flags=l.flags&-4097|2,Jt=!1,Zn=l}}}function i2(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Zn=l}function wd(l){if(l!==Zn)return!1;if(!Jt)return i2(l),Jt=!0,!1;var u;if((u=l.tag!==3)&&!(u=l.tag!==5)&&(u=l.type,u=u!=="head"&&u!=="body"&&!tp(l.type,l.memoizedProps)),u&&(u=ea)){if(cp(l))throw s2(),Error(r(418));for(;u;)n2(l,u),u=gs(u.nextSibling)}if(i2(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));e:{for(l=l.nextSibling,u=0;l;){if(l.nodeType===8){var p=l.data;if(p==="/$"){if(u===0){ea=gs(l.nextSibling);break e}u--}else p!=="$"&&p!=="$!"&&p!=="$?"||u++}l=l.nextSibling}ea=null}}else ea=Zn?gs(l.stateNode.nextSibling):null;return!0}function s2(){for(var l=ea;l;)l=gs(l.nextSibling)}function Cl(){ea=Zn=null,Jt=!1}function fp(l){Ha===null?Ha=[l]:Ha.push(l)}var NF=C.ReactCurrentBatchConfig;function au(l,u,p){if(l=p.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(r(309));var w=p.stateNode}if(!w)throw Error(r(147,l));var _=w,A=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===A?u.ref:(u=function(I){var re=_.refs;I===null?delete re[A]:re[A]=I},u._stringRef=A,u)}if(typeof l!="string")throw Error(r(284));if(!p._owner)throw Error(r(290,l))}return l}function bd(l,u){throw l=Object.prototype.toString.call(u),Error(r(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function o2(l){var u=l._init;return u(l._payload)}function l2(l){function u(pe,ue){if(l){var ge=pe.deletions;ge===null?(pe.deletions=[ue],pe.flags|=16):ge.push(ue)}}function p(pe,ue){if(!l)return null;for(;ue!==null;)u(pe,ue),ue=ue.sibling;return null}function w(pe,ue){for(pe=new Map;ue!==null;)ue.key!==null?pe.set(ue.key,ue):pe.set(ue.index,ue),ue=ue.sibling;return pe}function _(pe,ue){return pe=Cs(pe,ue),pe.index=0,pe.sibling=null,pe}function A(pe,ue,ge){return pe.index=ge,l?(ge=pe.alternate,ge!==null?(ge=ge.index,ge<ue?(pe.flags|=2,ue):ge):(pe.flags|=2,ue)):(pe.flags|=1048576,ue)}function I(pe){return l&&pe.alternate===null&&(pe.flags|=2),pe}function re(pe,ue,ge,Re){return ue===null||ue.tag!==6?(ue=rx(ge,pe.mode,Re),ue.return=pe,ue):(ue=_(ue,ge),ue.return=pe,ue)}function le(pe,ue,ge,Re){var Qe=ge.type;return Qe===P?Oe(pe,ue,ge.props.children,Re,ge.key):ue!==null&&(ue.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===me&&o2(Qe)===ue.type)?(Re=_(ue,ge.props),Re.ref=au(pe,ue,ge),Re.return=pe,Re):(Re=Vd(ge.type,ge.key,ge.props,null,pe.mode,Re),Re.ref=au(pe,ue,ge),Re.return=pe,Re)}function Ne(pe,ue,ge,Re){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==ge.containerInfo||ue.stateNode.implementation!==ge.implementation?(ue=nx(ge,pe.mode,Re),ue.return=pe,ue):(ue=_(ue,ge.children||[]),ue.return=pe,ue)}function Oe(pe,ue,ge,Re,Qe){return ue===null||ue.tag!==7?(ue=So(ge,pe.mode,Re,Qe),ue.return=pe,ue):(ue=_(ue,ge),ue.return=pe,ue)}function De(pe,ue,ge){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=rx(""+ue,pe.mode,ge),ue.return=pe,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case T:return ge=Vd(ue.type,ue.key,ue.props,null,pe.mode,ge),ge.ref=au(pe,null,ue),ge.return=pe,ge;case k:return ue=nx(ue,pe.mode,ge),ue.return=pe,ue;case me:var Re=ue._init;return De(pe,Re(ue._payload),ge)}if(Yt(ue)||J(ue))return ue=So(ue,pe.mode,ge,null),ue.return=pe,ue;bd(pe,ue)}return null}function Te(pe,ue,ge,Re){var Qe=ue!==null?ue.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return Qe!==null?null:re(pe,ue,""+ge,Re);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case T:return ge.key===Qe?le(pe,ue,ge,Re):null;case k:return ge.key===Qe?Ne(pe,ue,ge,Re):null;case me:return Qe=ge._init,Te(pe,ue,Qe(ge._payload),Re)}if(Yt(ge)||J(ge))return Qe!==null?null:Oe(pe,ue,ge,Re,null);bd(pe,ge)}return null}function He(pe,ue,ge,Re,Qe){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return pe=pe.get(ge)||null,re(ue,pe,""+Re,Qe);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case T:return pe=pe.get(Re.key===null?ge:Re.key)||null,le(ue,pe,Re,Qe);case k:return pe=pe.get(Re.key===null?ge:Re.key)||null,Ne(ue,pe,Re,Qe);case me:var rt=Re._init;return He(pe,ue,ge,rt(Re._payload),Qe)}if(Yt(Re)||J(Re))return pe=pe.get(ge)||null,Oe(ue,pe,Re,Qe,null);bd(ue,Re)}return null}function qe(pe,ue,ge,Re){for(var Qe=null,rt=null,nt=ue,ft=ue=0,Hr=null;nt!==null&&ft<ge.length;ft++){nt.index>ft?(Hr=nt,nt=null):Hr=nt.sibling;var St=Te(pe,nt,ge[ft],Re);if(St===null){nt===null&&(nt=Hr);break}l&&nt&&St.alternate===null&&u(pe,nt),ue=A(St,ue,ft),rt===null?Qe=St:rt.sibling=St,rt=St,nt=Hr}if(ft===ge.length)return p(pe,nt),Jt&&mo(pe,ft),Qe;if(nt===null){for(;ft<ge.length;ft++)nt=De(pe,ge[ft],Re),nt!==null&&(ue=A(nt,ue,ft),rt===null?Qe=nt:rt.sibling=nt,rt=nt);return Jt&&mo(pe,ft),Qe}for(nt=w(pe,nt);ft<ge.length;ft++)Hr=He(nt,pe,ft,ge[ft],Re),Hr!==null&&(l&&Hr.alternate!==null&&nt.delete(Hr.key===null?ft:Hr.key),ue=A(Hr,ue,ft),rt===null?Qe=Hr:rt.sibling=Hr,rt=Hr);return l&&nt.forEach(function(As){return u(pe,As)}),Jt&&mo(pe,ft),Qe}function Ye(pe,ue,ge,Re){var Qe=J(ge);if(typeof Qe!="function")throw Error(r(150));if(ge=Qe.call(ge),ge==null)throw Error(r(151));for(var rt=Qe=null,nt=ue,ft=ue=0,Hr=null,St=ge.next();nt!==null&&!St.done;ft++,St=ge.next()){nt.index>ft?(Hr=nt,nt=null):Hr=nt.sibling;var As=Te(pe,nt,St.value,Re);if(As===null){nt===null&&(nt=Hr);break}l&&nt&&As.alternate===null&&u(pe,nt),ue=A(As,ue,ft),rt===null?Qe=As:rt.sibling=As,rt=As,nt=Hr}if(St.done)return p(pe,nt),Jt&&mo(pe,ft),Qe;if(nt===null){for(;!St.done;ft++,St=ge.next())St=De(pe,St.value,Re),St!==null&&(ue=A(St,ue,ft),rt===null?Qe=St:rt.sibling=St,rt=St);return Jt&&mo(pe,ft),Qe}for(nt=w(pe,nt);!St.done;ft++,St=ge.next())St=He(nt,pe,ft,St.value,Re),St!==null&&(l&&St.alternate!==null&&nt.delete(St.key===null?ft:St.key),ue=A(St,ue,ft),rt===null?Qe=St:rt.sibling=St,rt=St);return l&&nt.forEach(function(r5){return u(pe,r5)}),Jt&&mo(pe,ft),Qe}function pr(pe,ue,ge,Re){if(typeof ge=="object"&&ge!==null&&ge.type===P&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case T:e:{for(var Qe=ge.key,rt=ue;rt!==null;){if(rt.key===Qe){if(Qe=ge.type,Qe===P){if(rt.tag===7){p(pe,rt.sibling),ue=_(rt,ge.props.children),ue.return=pe,pe=ue;break e}}else if(rt.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===me&&o2(Qe)===rt.type){p(pe,rt.sibling),ue=_(rt,ge.props),ue.ref=au(pe,rt,ge),ue.return=pe,pe=ue;break e}p(pe,rt);break}else u(pe,rt);rt=rt.sibling}ge.type===P?(ue=So(ge.props.children,pe.mode,Re,ge.key),ue.return=pe,pe=ue):(Re=Vd(ge.type,ge.key,ge.props,null,pe.mode,Re),Re.ref=au(pe,ue,ge),Re.return=pe,pe=Re)}return I(pe);case k:e:{for(rt=ge.key;ue!==null;){if(ue.key===rt)if(ue.tag===4&&ue.stateNode.containerInfo===ge.containerInfo&&ue.stateNode.implementation===ge.implementation){p(pe,ue.sibling),ue=_(ue,ge.children||[]),ue.return=pe,pe=ue;break e}else{p(pe,ue);break}else u(pe,ue);ue=ue.sibling}ue=nx(ge,pe.mode,Re),ue.return=pe,pe=ue}return I(pe);case me:return rt=ge._init,pr(pe,ue,rt(ge._payload),Re)}if(Yt(ge))return qe(pe,ue,ge,Re);if(J(ge))return Ye(pe,ue,ge,Re);bd(pe,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,ue!==null&&ue.tag===6?(p(pe,ue.sibling),ue=_(ue,ge),ue.return=pe,pe=ue):(p(pe,ue),ue=rx(ge,pe.mode,Re),ue.return=pe,pe=ue),I(pe)):p(pe,ue)}return pr}var Al=l2(!0),c2=l2(!1),Sd=vs(null),Nd=null,Tl=null,dp=null;function hp(){dp=Tl=Nd=null}function mp(l){var u=Sd.current;Vt(Sd),l._currentValue=u}function pp(l,u,p){for(;l!==null;){var w=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,w!==null&&(w.childLanes|=u)):w!==null&&(w.childLanes&u)!==u&&(w.childLanes|=u),l===p)break;l=l.return}}function Pl(l,u){Nd=l,dp=Tl=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&u)!==0&&(zn=!0),l.firstContext=null)}function ya(l){var u=l._currentValue;if(dp!==l)if(l={context:l,memoizedValue:u,next:null},Tl===null){if(Nd===null)throw Error(r(308));Tl=l,Nd.dependencies={lanes:0,firstContext:l}}else Tl=Tl.next=l;return u}var po=null;function xp(l){po===null?po=[l]:po.push(l)}function u2(l,u,p,w){var _=u.interleaved;return _===null?(p.next=p,xp(u)):(p.next=_.next,_.next=p),u.interleaved=p,Oi(l,w)}function Oi(l,u){l.lanes|=u;var p=l.alternate;for(p!==null&&(p.lanes|=u),p=l,l=l.return;l!==null;)l.childLanes|=u,p=l.alternate,p!==null&&(p.childLanes|=u),p=l,l=l.return;return p.tag===3?p.stateNode:null}var bs=!1;function gp(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function f2(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Fi(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function Ss(l,u,p){var w=l.updateQueue;if(w===null)return null;if(w=w.shared,(vt&2)!==0){var _=w.pending;return _===null?u.next=u:(u.next=_.next,_.next=u),w.pending=u,Oi(l,p)}return _=w.interleaved,_===null?(u.next=u,xp(w)):(u.next=_.next,_.next=u),w.interleaved=u,Oi(l,p)}function _d(l,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194240)!==0)){var w=u.lanes;w&=l.pendingLanes,p|=w,u.lanes=p,Pm(l,p)}}function d2(l,u){var p=l.updateQueue,w=l.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var _=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var I={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};A===null?_=A=I:A=A.next=I,p=p.next}while(p!==null);A===null?_=A=u:A=A.next=u}else _=A=u;p={baseState:w.baseState,firstBaseUpdate:_,lastBaseUpdate:A,shared:w.shared,effects:w.effects},l.updateQueue=p;return}l=p.lastBaseUpdate,l===null?p.firstBaseUpdate=u:l.next=u,p.lastBaseUpdate=u}function Ed(l,u,p,w){var _=l.updateQueue;bs=!1;var A=_.firstBaseUpdate,I=_.lastBaseUpdate,re=_.shared.pending;if(re!==null){_.shared.pending=null;var le=re,Ne=le.next;le.next=null,I===null?A=Ne:I.next=Ne,I=le;var Oe=l.alternate;Oe!==null&&(Oe=Oe.updateQueue,re=Oe.lastBaseUpdate,re!==I&&(re===null?Oe.firstBaseUpdate=Ne:re.next=Ne,Oe.lastBaseUpdate=le))}if(A!==null){var De=_.baseState;I=0,Oe=Ne=le=null,re=A;do{var Te=re.lane,He=re.eventTime;if((w&Te)===Te){Oe!==null&&(Oe=Oe.next={eventTime:He,lane:0,tag:re.tag,payload:re.payload,callback:re.callback,next:null});e:{var qe=l,Ye=re;switch(Te=u,He=p,Ye.tag){case 1:if(qe=Ye.payload,typeof qe=="function"){De=qe.call(He,De,Te);break e}De=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=Ye.payload,Te=typeof qe=="function"?qe.call(He,De,Te):qe,Te==null)break e;De=xe({},De,Te);break e;case 2:bs=!0}}re.callback!==null&&re.lane!==0&&(l.flags|=64,Te=_.effects,Te===null?_.effects=[re]:Te.push(re))}else He={eventTime:He,lane:Te,tag:re.tag,payload:re.payload,callback:re.callback,next:null},Oe===null?(Ne=Oe=He,le=De):Oe=Oe.next=He,I|=Te;if(re=re.next,re===null){if(re=_.shared.pending,re===null)break;Te=re,re=Te.next,Te.next=null,_.lastBaseUpdate=Te,_.shared.pending=null}}while(!0);if(Oe===null&&(le=De),_.baseState=le,_.firstBaseUpdate=Ne,_.lastBaseUpdate=Oe,u=_.shared.interleaved,u!==null){_=u;do I|=_.lane,_=_.next;while(_!==u)}else A===null&&(_.shared.lanes=0);vo|=I,l.lanes=I,l.memoizedState=De}}function h2(l,u,p){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var w=l[u],_=w.callback;if(_!==null){if(w.callback=null,w=p,typeof _!="function")throw Error(r(191,_));_.call(w)}}}var iu={},oi=vs(iu),su=vs(iu),ou=vs(iu);function xo(l){if(l===iu)throw Error(r(174));return l}function vp(l,u){switch(zt(ou,u),zt(su,l),zt(oi,iu),l=u.nodeType,l){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:en(null,"");break;default:l=l===8?u.parentNode:u,u=l.namespaceURI||null,l=l.tagName,u=en(u,l)}Vt(oi),zt(oi,u)}function Ol(){Vt(oi),Vt(su),Vt(ou)}function m2(l){xo(ou.current);var u=xo(oi.current),p=en(u,l.type);u!==p&&(zt(su,l),zt(oi,p))}function yp(l){su.current===l&&(Vt(oi),Vt(su))}var nr=vs(0);function kd(l){for(var u=l;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var wp=[];function bp(){for(var l=0;l<wp.length;l++)wp[l]._workInProgressVersionPrimary=null;wp.length=0}var jd=C.ReactCurrentDispatcher,Sp=C.ReactCurrentBatchConfig,go=0,ar=null,Tr=null,zr=null,Cd=!1,lu=!1,cu=0,_F=0;function hn(){throw Error(r(321))}function Np(l,u){if(u===null)return!1;for(var p=0;p<u.length&&p<l.length;p++)if(!Wa(l[p],u[p]))return!1;return!0}function _p(l,u,p,w,_,A){if(go=A,ar=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,jd.current=l===null||l.memoizedState===null?CF:AF,l=p(w,_),lu){A=0;do{if(lu=!1,cu=0,25<=A)throw Error(r(301));A+=1,zr=Tr=null,u.updateQueue=null,jd.current=TF,l=p(w,_)}while(lu)}if(jd.current=Pd,u=Tr!==null&&Tr.next!==null,go=0,zr=Tr=ar=null,Cd=!1,u)throw Error(r(300));return l}function Ep(){var l=cu!==0;return cu=0,l}function li(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zr===null?ar.memoizedState=zr=l:zr=zr.next=l,zr}function wa(){if(Tr===null){var l=ar.alternate;l=l!==null?l.memoizedState:null}else l=Tr.next;var u=zr===null?ar.memoizedState:zr.next;if(u!==null)zr=u,Tr=l;else{if(l===null)throw Error(r(310));Tr=l,l={memoizedState:Tr.memoizedState,baseState:Tr.baseState,baseQueue:Tr.baseQueue,queue:Tr.queue,next:null},zr===null?ar.memoizedState=zr=l:zr=zr.next=l}return zr}function uu(l,u){return typeof u=="function"?u(l):u}function kp(l){var u=wa(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=l;var w=Tr,_=w.baseQueue,A=p.pending;if(A!==null){if(_!==null){var I=_.next;_.next=A.next,A.next=I}w.baseQueue=_=A,p.pending=null}if(_!==null){A=_.next,w=w.baseState;var re=I=null,le=null,Ne=A;do{var Oe=Ne.lane;if((go&Oe)===Oe)le!==null&&(le=le.next={lane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),w=Ne.hasEagerState?Ne.eagerState:l(w,Ne.action);else{var De={lane:Oe,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null};le===null?(re=le=De,I=w):le=le.next=De,ar.lanes|=Oe,vo|=Oe}Ne=Ne.next}while(Ne!==null&&Ne!==A);le===null?I=w:le.next=re,Wa(w,u.memoizedState)||(zn=!0),u.memoizedState=w,u.baseState=I,u.baseQueue=le,p.lastRenderedState=w}if(l=p.interleaved,l!==null){_=l;do A=_.lane,ar.lanes|=A,vo|=A,_=_.next;while(_!==l)}else _===null&&(p.lanes=0);return[u.memoizedState,p.dispatch]}function jp(l){var u=wa(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=l;var w=p.dispatch,_=p.pending,A=u.memoizedState;if(_!==null){p.pending=null;var I=_=_.next;do A=l(A,I.action),I=I.next;while(I!==_);Wa(A,u.memoizedState)||(zn=!0),u.memoizedState=A,u.baseQueue===null&&(u.baseState=A),p.lastRenderedState=A}return[A,w]}function p2(){}function x2(l,u){var p=ar,w=wa(),_=u(),A=!Wa(w.memoizedState,_);if(A&&(w.memoizedState=_,zn=!0),w=w.queue,Cp(y2.bind(null,p,w,l),[l]),w.getSnapshot!==u||A||zr!==null&&zr.memoizedState.tag&1){if(p.flags|=2048,fu(9,v2.bind(null,p,w,_,u),void 0,null),Wr===null)throw Error(r(349));(go&30)!==0||g2(p,u,_)}return _}function g2(l,u,p){l.flags|=16384,l={getSnapshot:u,value:p},u=ar.updateQueue,u===null?(u={lastEffect:null,stores:null},ar.updateQueue=u,u.stores=[l]):(p=u.stores,p===null?u.stores=[l]:p.push(l))}function v2(l,u,p,w){u.value=p,u.getSnapshot=w,w2(u)&&b2(l)}function y2(l,u,p){return p(function(){w2(u)&&b2(l)})}function w2(l){var u=l.getSnapshot;l=l.value;try{var p=u();return!Wa(l,p)}catch{return!0}}function b2(l){var u=Oi(l,1);u!==null&&Xa(u,l,1,-1)}function S2(l){var u=li();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uu,lastRenderedState:l},u.queue=l,l=l.dispatch=jF.bind(null,ar,l),[u.memoizedState,l]}function fu(l,u,p,w){return l={tag:l,create:u,destroy:p,deps:w,next:null},u=ar.updateQueue,u===null?(u={lastEffect:null,stores:null},ar.updateQueue=u,u.lastEffect=l.next=l):(p=u.lastEffect,p===null?u.lastEffect=l.next=l:(w=p.next,p.next=l,l.next=w,u.lastEffect=l)),l}function N2(){return wa().memoizedState}function Ad(l,u,p,w){var _=li();ar.flags|=l,_.memoizedState=fu(1|u,p,void 0,w===void 0?null:w)}function Td(l,u,p,w){var _=wa();w=w===void 0?null:w;var A=void 0;if(Tr!==null){var I=Tr.memoizedState;if(A=I.destroy,w!==null&&Np(w,I.deps)){_.memoizedState=fu(u,p,A,w);return}}ar.flags|=l,_.memoizedState=fu(1|u,p,A,w)}function _2(l,u){return Ad(8390656,8,l,u)}function Cp(l,u){return Td(2048,8,l,u)}function E2(l,u){return Td(4,2,l,u)}function k2(l,u){return Td(4,4,l,u)}function j2(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function C2(l,u,p){return p=p!=null?p.concat([l]):null,Td(4,4,j2.bind(null,u,l),p)}function Ap(){}function A2(l,u){var p=wa();u=u===void 0?null:u;var w=p.memoizedState;return w!==null&&u!==null&&Np(u,w[1])?w[0]:(p.memoizedState=[l,u],l)}function T2(l,u){var p=wa();u=u===void 0?null:u;var w=p.memoizedState;return w!==null&&u!==null&&Np(u,w[1])?w[0]:(l=l(),p.memoizedState=[l,u],l)}function P2(l,u,p){return(go&21)===0?(l.baseState&&(l.baseState=!1,zn=!0),l.memoizedState=p):(Wa(p,u)||(p=ob(),ar.lanes|=p,vo|=p,l.baseState=!0),u)}function EF(l,u){var p=At;At=p!==0&&4>p?p:4,l(!0);var w=Sp.transition;Sp.transition={};try{l(!1),u()}finally{At=p,Sp.transition=w}}function O2(){return wa().memoizedState}function kF(l,u,p){var w=ks(l);if(p={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null},F2(l))D2(u,p);else if(p=u2(l,u,p,w),p!==null){var _=Tn();Xa(p,l,w,_),I2(p,u,w)}}function jF(l,u,p){var w=ks(l),_={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null};if(F2(l))D2(u,_);else{var A=l.alternate;if(l.lanes===0&&(A===null||A.lanes===0)&&(A=u.lastRenderedReducer,A!==null))try{var I=u.lastRenderedState,re=A(I,p);if(_.hasEagerState=!0,_.eagerState=re,Wa(re,I)){var le=u.interleaved;le===null?(_.next=_,xp(u)):(_.next=le.next,le.next=_),u.interleaved=_;return}}catch{}finally{}p=u2(l,u,_,w),p!==null&&(_=Tn(),Xa(p,l,w,_),I2(p,u,w))}}function F2(l){var u=l.alternate;return l===ar||u!==null&&u===ar}function D2(l,u){lu=Cd=!0;var p=l.pending;p===null?u.next=u:(u.next=p.next,p.next=u),l.pending=u}function I2(l,u,p){if((p&4194240)!==0){var w=u.lanes;w&=l.pendingLanes,p|=w,u.lanes=p,Pm(l,p)}}var Pd={readContext:ya,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useInsertionEffect:hn,useLayoutEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useMutableSource:hn,useSyncExternalStore:hn,useId:hn,unstable_isNewReconciler:!1},CF={readContext:ya,useCallback:function(l,u){return li().memoizedState=[l,u===void 0?null:u],l},useContext:ya,useEffect:_2,useImperativeHandle:function(l,u,p){return p=p!=null?p.concat([l]):null,Ad(4194308,4,j2.bind(null,u,l),p)},useLayoutEffect:function(l,u){return Ad(4194308,4,l,u)},useInsertionEffect:function(l,u){return Ad(4,2,l,u)},useMemo:function(l,u){var p=li();return u=u===void 0?null:u,l=l(),p.memoizedState=[l,u],l},useReducer:function(l,u,p){var w=li();return u=p!==void 0?p(u):u,w.memoizedState=w.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},w.queue=l,l=l.dispatch=kF.bind(null,ar,l),[w.memoizedState,l]},useRef:function(l){var u=li();return l={current:l},u.memoizedState=l},useState:S2,useDebugValue:Ap,useDeferredValue:function(l){return li().memoizedState=l},useTransition:function(){var l=S2(!1),u=l[0];return l=EF.bind(null,l[1]),li().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,p){var w=ar,_=li();if(Jt){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),Wr===null)throw Error(r(349));(go&30)!==0||g2(w,u,p)}_.memoizedState=p;var A={value:p,getSnapshot:u};return _.queue=A,_2(y2.bind(null,w,A,l),[l]),w.flags|=2048,fu(9,v2.bind(null,w,A,p,u),void 0,null),p},useId:function(){var l=li(),u=Wr.identifierPrefix;if(Jt){var p=Pi,w=Ti;p=(w&~(1<<32-mr(w)-1)).toString(32)+p,u=":"+u+"R"+p,p=cu++,0<p&&(u+="H"+p.toString(32)),u+=":"}else p=_F++,u=":"+u+"r"+p.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},AF={readContext:ya,useCallback:A2,useContext:ya,useEffect:Cp,useImperativeHandle:C2,useInsertionEffect:E2,useLayoutEffect:k2,useMemo:T2,useReducer:kp,useRef:N2,useState:function(){return kp(uu)},useDebugValue:Ap,useDeferredValue:function(l){var u=wa();return P2(u,Tr.memoizedState,l)},useTransition:function(){var l=kp(uu)[0],u=wa().memoizedState;return[l,u]},useMutableSource:p2,useSyncExternalStore:x2,useId:O2,unstable_isNewReconciler:!1},TF={readContext:ya,useCallback:A2,useContext:ya,useEffect:Cp,useImperativeHandle:C2,useInsertionEffect:E2,useLayoutEffect:k2,useMemo:T2,useReducer:jp,useRef:N2,useState:function(){return jp(uu)},useDebugValue:Ap,useDeferredValue:function(l){var u=wa();return Tr===null?u.memoizedState=l:P2(u,Tr.memoizedState,l)},useTransition:function(){var l=jp(uu)[0],u=wa().memoizedState;return[l,u]},useMutableSource:p2,useSyncExternalStore:x2,useId:O2,unstable_isNewReconciler:!1};function Va(l,u){if(l&&l.defaultProps){u=xe({},u),l=l.defaultProps;for(var p in l)u[p]===void 0&&(u[p]=l[p]);return u}return u}function Tp(l,u,p,w){u=l.memoizedState,p=p(w,u),p=p==null?u:xe({},u,p),l.memoizedState=p,l.lanes===0&&(l.updateQueue.baseState=p)}var Od={isMounted:function(l){return(l=l._reactInternals)?ee(l)===l:!1},enqueueSetState:function(l,u,p){l=l._reactInternals;var w=Tn(),_=ks(l),A=Fi(w,_);A.payload=u,p!=null&&(A.callback=p),u=Ss(l,A,_),u!==null&&(Xa(u,l,_,w),_d(u,l,_))},enqueueReplaceState:function(l,u,p){l=l._reactInternals;var w=Tn(),_=ks(l),A=Fi(w,_);A.tag=1,A.payload=u,p!=null&&(A.callback=p),u=Ss(l,A,_),u!==null&&(Xa(u,l,_,w),_d(u,l,_))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var p=Tn(),w=ks(l),_=Fi(p,w);_.tag=2,u!=null&&(_.callback=u),u=Ss(l,_,w),u!==null&&(Xa(u,l,w,p),_d(u,l,w))}};function M2(l,u,p,w,_,A,I){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(w,A,I):u.prototype&&u.prototype.isPureReactComponent?!Jc(p,w)||!Jc(_,A):!0}function R2(l,u,p){var w=!1,_=ys,A=u.contextType;return typeof A=="object"&&A!==null?A=ya(A):(_=Un(u)?fo:dn.current,w=u.contextTypes,A=(w=w!=null)?El(l,_):ys),u=new u(p,A),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=Od,l.stateNode=u,u._reactInternals=l,w&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=_,l.__reactInternalMemoizedMaskedChildContext=A),u}function L2(l,u,p,w){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,w),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,w),u.state!==l&&Od.enqueueReplaceState(u,u.state,null)}function Pp(l,u,p,w){var _=l.stateNode;_.props=p,_.state=l.memoizedState,_.refs={},gp(l);var A=u.contextType;typeof A=="object"&&A!==null?_.context=ya(A):(A=Un(u)?fo:dn.current,_.context=El(l,A)),_.state=l.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(Tp(l,u,A,p),_.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(u=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),u!==_.state&&Od.enqueueReplaceState(_,_.state,null),Ed(l,p,_,w),_.state=l.memoizedState),typeof _.componentDidMount=="function"&&(l.flags|=4194308)}function Fl(l,u){try{var p="",w=u;do p+=X(w),w=w.return;while(w);var _=p}catch(A){_=`
Error generating stack: `+A.message+`
`+A.stack}return{value:l,source:u,stack:_,digest:null}}function Op(l,u,p){return{value:l,source:null,stack:p??null,digest:u??null}}function Fp(l,u){try{console.error(u.value)}catch(p){setTimeout(function(){throw p})}}var PF=typeof WeakMap=="function"?WeakMap:Map;function B2(l,u,p){p=Fi(-1,p),p.tag=3,p.payload={element:null};var w=u.value;return p.callback=function(){Bd||(Bd=!0,Xp=w),Fp(l,u)},p}function $2(l,u,p){p=Fi(-1,p),p.tag=3;var w=l.type.getDerivedStateFromError;if(typeof w=="function"){var _=u.value;p.payload=function(){return w(_)},p.callback=function(){Fp(l,u)}}var A=l.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(p.callback=function(){Fp(l,u),typeof w!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var I=u.stack;this.componentDidCatch(u.value,{componentStack:I!==null?I:""})}),p}function U2(l,u,p){var w=l.pingCache;if(w===null){w=l.pingCache=new PF;var _=new Set;w.set(u,_)}else _=w.get(u),_===void 0&&(_=new Set,w.set(u,_));_.has(p)||(_.add(p),l=VF.bind(null,l,u,p),u.then(l,l))}function z2(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function W2(l,u,p,w,_){return(l.mode&1)===0?(l===u?l.flags|=65536:(l.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(u=Fi(-1,1),u.tag=2,Ss(p,u,1))),p.lanes|=1),l):(l.flags|=65536,l.lanes=_,l)}var OF=C.ReactCurrentOwner,zn=!1;function An(l,u,p,w){u.child=l===null?c2(u,null,p,w):Al(u,l.child,p,w)}function H2(l,u,p,w,_){p=p.render;var A=u.ref;return Pl(u,_),w=_p(l,u,p,w,A,_),p=Ep(),l!==null&&!zn?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~_,Di(l,u,_)):(Jt&&p&&op(u),u.flags|=1,An(l,u,w,_),u.child)}function V2(l,u,p,w,_){if(l===null){var A=p.type;return typeof A=="function"&&!tx(A)&&A.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(u.tag=15,u.type=A,K2(l,u,A,w,_)):(l=Vd(p.type,null,w,u,u.mode,_),l.ref=u.ref,l.return=u,u.child=l)}if(A=l.child,(l.lanes&_)===0){var I=A.memoizedProps;if(p=p.compare,p=p!==null?p:Jc,p(I,w)&&l.ref===u.ref)return Di(l,u,_)}return u.flags|=1,l=Cs(A,w),l.ref=u.ref,l.return=u,u.child=l}function K2(l,u,p,w,_){if(l!==null){var A=l.memoizedProps;if(Jc(A,w)&&l.ref===u.ref)if(zn=!1,u.pendingProps=w=A,(l.lanes&_)!==0)(l.flags&131072)!==0&&(zn=!0);else return u.lanes=l.lanes,Di(l,u,_)}return Dp(l,u,p,w,_)}function G2(l,u,p){var w=u.pendingProps,_=w.children,A=l!==null?l.memoizedState:null;if(w.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},zt(Il,ta),ta|=p;else{if((p&1073741824)===0)return l=A!==null?A.baseLanes|p:p,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null,transitions:null},u.updateQueue=null,zt(Il,ta),ta|=l,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=A!==null?A.baseLanes:p,zt(Il,ta),ta|=w}else A!==null?(w=A.baseLanes|p,u.memoizedState=null):w=p,zt(Il,ta),ta|=w;return An(l,u,_,p),u.child}function X2(l,u){var p=u.ref;(l===null&&p!==null||l!==null&&l.ref!==p)&&(u.flags|=512,u.flags|=2097152)}function Dp(l,u,p,w,_){var A=Un(p)?fo:dn.current;return A=El(u,A),Pl(u,_),p=_p(l,u,p,w,A,_),w=Ep(),l!==null&&!zn?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~_,Di(l,u,_)):(Jt&&w&&op(u),u.flags|=1,An(l,u,p,_),u.child)}function q2(l,u,p,w,_){if(Un(p)){var A=!0;xd(u)}else A=!1;if(Pl(u,_),u.stateNode===null)Dd(l,u),R2(u,p,w),Pp(u,p,w,_),w=!0;else if(l===null){var I=u.stateNode,re=u.memoizedProps;I.props=re;var le=I.context,Ne=p.contextType;typeof Ne=="object"&&Ne!==null?Ne=ya(Ne):(Ne=Un(p)?fo:dn.current,Ne=El(u,Ne));var Oe=p.getDerivedStateFromProps,De=typeof Oe=="function"||typeof I.getSnapshotBeforeUpdate=="function";De||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(re!==w||le!==Ne)&&L2(u,I,w,Ne),bs=!1;var Te=u.memoizedState;I.state=Te,Ed(u,w,I,_),le=u.memoizedState,re!==w||Te!==le||$n.current||bs?(typeof Oe=="function"&&(Tp(u,p,Oe,w),le=u.memoizedState),(re=bs||M2(u,p,re,w,Te,le,Ne))?(De||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(u.flags|=4194308)):(typeof I.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=w,u.memoizedState=le),I.props=w,I.state=le,I.context=Ne,w=re):(typeof I.componentDidMount=="function"&&(u.flags|=4194308),w=!1)}else{I=u.stateNode,f2(l,u),re=u.memoizedProps,Ne=u.type===u.elementType?re:Va(u.type,re),I.props=Ne,De=u.pendingProps,Te=I.context,le=p.contextType,typeof le=="object"&&le!==null?le=ya(le):(le=Un(p)?fo:dn.current,le=El(u,le));var He=p.getDerivedStateFromProps;(Oe=typeof He=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(re!==De||Te!==le)&&L2(u,I,w,le),bs=!1,Te=u.memoizedState,I.state=Te,Ed(u,w,I,_);var qe=u.memoizedState;re!==De||Te!==qe||$n.current||bs?(typeof He=="function"&&(Tp(u,p,He,w),qe=u.memoizedState),(Ne=bs||M2(u,p,Ne,w,Te,qe,le)||!1)?(Oe||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(w,qe,le),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(w,qe,le)),typeof I.componentDidUpdate=="function"&&(u.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof I.componentDidUpdate!="function"||re===l.memoizedProps&&Te===l.memoizedState||(u.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||re===l.memoizedProps&&Te===l.memoizedState||(u.flags|=1024),u.memoizedProps=w,u.memoizedState=qe),I.props=w,I.state=qe,I.context=le,w=Ne):(typeof I.componentDidUpdate!="function"||re===l.memoizedProps&&Te===l.memoizedState||(u.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||re===l.memoizedProps&&Te===l.memoizedState||(u.flags|=1024),w=!1)}return Ip(l,u,p,w,A,_)}function Ip(l,u,p,w,_,A){X2(l,u);var I=(u.flags&128)!==0;if(!w&&!I)return _&&e2(u,p,!1),Di(l,u,A);w=u.stateNode,OF.current=u;var re=I&&typeof p.getDerivedStateFromError!="function"?null:w.render();return u.flags|=1,l!==null&&I?(u.child=Al(u,l.child,null,A),u.child=Al(u,null,re,A)):An(l,u,re,A),u.memoizedState=w.state,_&&e2(u,p,!0),u.child}function Y2(l){var u=l.stateNode;u.pendingContext?Qb(l,u.pendingContext,u.pendingContext!==u.context):u.context&&Qb(l,u.context,!1),vp(l,u.containerInfo)}function J2(l,u,p,w,_){return Cl(),fp(_),u.flags|=256,An(l,u,p,w),u.child}var Mp={dehydrated:null,treeContext:null,retryLane:0};function Rp(l){return{baseLanes:l,cachePool:null,transitions:null}}function Q2(l,u,p){var w=u.pendingProps,_=nr.current,A=!1,I=(u.flags&128)!==0,re;if((re=I)||(re=l!==null&&l.memoizedState===null?!1:(_&2)!==0),re?(A=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(_|=1),zt(nr,_&1),l===null)return up(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((u.mode&1)===0?u.lanes=1:l.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(I=w.children,l=w.fallback,A?(w=u.mode,A=u.child,I={mode:"hidden",children:I},(w&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=I):A=Kd(I,w,0,null),l=So(l,w,p,null),A.return=u,l.return=u,A.sibling=l,u.child=A,u.child.memoizedState=Rp(p),u.memoizedState=Mp,l):Lp(u,I));if(_=l.memoizedState,_!==null&&(re=_.dehydrated,re!==null))return FF(l,u,I,w,re,_,p);if(A){A=w.fallback,I=u.mode,_=l.child,re=_.sibling;var le={mode:"hidden",children:w.children};return(I&1)===0&&u.child!==_?(w=u.child,w.childLanes=0,w.pendingProps=le,u.deletions=null):(w=Cs(_,le),w.subtreeFlags=_.subtreeFlags&14680064),re!==null?A=Cs(re,A):(A=So(A,I,p,null),A.flags|=2),A.return=u,w.return=u,w.sibling=A,u.child=w,w=A,A=u.child,I=l.child.memoizedState,I=I===null?Rp(p):{baseLanes:I.baseLanes|p,cachePool:null,transitions:I.transitions},A.memoizedState=I,A.childLanes=l.childLanes&~p,u.memoizedState=Mp,w}return A=l.child,l=A.sibling,w=Cs(A,{mode:"visible",children:w.children}),(u.mode&1)===0&&(w.lanes=p),w.return=u,w.sibling=null,l!==null&&(p=u.deletions,p===null?(u.deletions=[l],u.flags|=16):p.push(l)),u.child=w,u.memoizedState=null,w}function Lp(l,u){return u=Kd({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function Fd(l,u,p,w){return w!==null&&fp(w),Al(u,l.child,null,p),l=Lp(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function FF(l,u,p,w,_,A,I){if(p)return u.flags&256?(u.flags&=-257,w=Op(Error(r(422))),Fd(l,u,I,w)):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(A=w.fallback,_=u.mode,w=Kd({mode:"visible",children:w.children},_,0,null),A=So(A,_,I,null),A.flags|=2,w.return=u,A.return=u,w.sibling=A,u.child=w,(u.mode&1)!==0&&Al(u,l.child,null,I),u.child.memoizedState=Rp(I),u.memoizedState=Mp,A);if((u.mode&1)===0)return Fd(l,u,I,null);if(_.data==="$!"){if(w=_.nextSibling&&_.nextSibling.dataset,w)var re=w.dgst;return w=re,A=Error(r(419)),w=Op(A,w,void 0),Fd(l,u,I,w)}if(re=(I&l.childLanes)!==0,zn||re){if(w=Wr,w!==null){switch(I&-I){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(w.suspendedLanes|I))!==0?0:_,_!==0&&_!==A.retryLane&&(A.retryLane=_,Oi(l,_),Xa(w,l,_,-1))}return ex(),w=Op(Error(r(421))),Fd(l,u,I,w)}return _.data==="$?"?(u.flags|=128,u.child=l.child,u=KF.bind(null,l),_._reactRetry=u,null):(l=A.treeContext,ea=gs(_.nextSibling),Zn=u,Jt=!0,Ha=null,l!==null&&(ga[va++]=Ti,ga[va++]=Pi,ga[va++]=ho,Ti=l.id,Pi=l.overflow,ho=u),u=Lp(u,w.children),u.flags|=4096,u)}function Z2(l,u,p){l.lanes|=u;var w=l.alternate;w!==null&&(w.lanes|=u),pp(l.return,u,p)}function Bp(l,u,p,w,_){var A=l.memoizedState;A===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:_}:(A.isBackwards=u,A.rendering=null,A.renderingStartTime=0,A.last=w,A.tail=p,A.tailMode=_)}function eS(l,u,p){var w=u.pendingProps,_=w.revealOrder,A=w.tail;if(An(l,u,w.children,p),w=nr.current,(w&2)!==0)w=w&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Z2(l,p,u);else if(l.tag===19)Z2(l,p,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}w&=1}if(zt(nr,w),(u.mode&1)===0)u.memoizedState=null;else switch(_){case"forwards":for(p=u.child,_=null;p!==null;)l=p.alternate,l!==null&&kd(l)===null&&(_=p),p=p.sibling;p=_,p===null?(_=u.child,u.child=null):(_=p.sibling,p.sibling=null),Bp(u,!1,_,p,A);break;case"backwards":for(p=null,_=u.child,u.child=null;_!==null;){if(l=_.alternate,l!==null&&kd(l)===null){u.child=_;break}l=_.sibling,_.sibling=p,p=_,_=l}Bp(u,!0,p,null,A);break;case"together":Bp(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Dd(l,u){(u.mode&1)===0&&l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2)}function Di(l,u,p){if(l!==null&&(u.dependencies=l.dependencies),vo|=u.lanes,(p&u.childLanes)===0)return null;if(l!==null&&u.child!==l.child)throw Error(r(153));if(u.child!==null){for(l=u.child,p=Cs(l,l.pendingProps),u.child=p,p.return=u;l.sibling!==null;)l=l.sibling,p=p.sibling=Cs(l,l.pendingProps),p.return=u;p.sibling=null}return u.child}function DF(l,u,p){switch(u.tag){case 3:Y2(u),Cl();break;case 5:m2(u);break;case 1:Un(u.type)&&xd(u);break;case 4:vp(u,u.stateNode.containerInfo);break;case 10:var w=u.type._context,_=u.memoizedProps.value;zt(Sd,w._currentValue),w._currentValue=_;break;case 13:if(w=u.memoizedState,w!==null)return w.dehydrated!==null?(zt(nr,nr.current&1),u.flags|=128,null):(p&u.child.childLanes)!==0?Q2(l,u,p):(zt(nr,nr.current&1),l=Di(l,u,p),l!==null?l.sibling:null);zt(nr,nr.current&1);break;case 19:if(w=(p&u.childLanes)!==0,(l.flags&128)!==0){if(w)return eS(l,u,p);u.flags|=128}if(_=u.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),zt(nr,nr.current),w)break;return null;case 22:case 23:return u.lanes=0,G2(l,u,p)}return Di(l,u,p)}var tS,$p,rS,nS;tS=function(l,u){for(var p=u.child;p!==null;){if(p.tag===5||p.tag===6)l.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},$p=function(){},rS=function(l,u,p,w){var _=l.memoizedProps;if(_!==w){l=u.stateNode,xo(oi.current);var A=null;switch(p){case"input":_=je(l,_),w=je(l,w),A=[];break;case"select":_=xe({},_,{value:void 0}),w=xe({},w,{value:void 0}),A=[];break;case"textarea":_=za(l,_),w=za(l,w),A=[];break;default:typeof _.onClick!="function"&&typeof w.onClick=="function"&&(l.onclick=hd)}We(p,w);var I;p=null;for(Ne in _)if(!w.hasOwnProperty(Ne)&&_.hasOwnProperty(Ne)&&_[Ne]!=null)if(Ne==="style"){var re=_[Ne];for(I in re)re.hasOwnProperty(I)&&(p||(p={}),p[I]="")}else Ne!=="dangerouslySetInnerHTML"&&Ne!=="children"&&Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&Ne!=="autoFocus"&&(a.hasOwnProperty(Ne)?A||(A=[]):(A=A||[]).push(Ne,null));for(Ne in w){var le=w[Ne];if(re=_?.[Ne],w.hasOwnProperty(Ne)&&le!==re&&(le!=null||re!=null))if(Ne==="style")if(re){for(I in re)!re.hasOwnProperty(I)||le&&le.hasOwnProperty(I)||(p||(p={}),p[I]="");for(I in le)le.hasOwnProperty(I)&&re[I]!==le[I]&&(p||(p={}),p[I]=le[I])}else p||(A||(A=[]),A.push(Ne,p)),p=le;else Ne==="dangerouslySetInnerHTML"?(le=le?le.__html:void 0,re=re?re.__html:void 0,le!=null&&re!==le&&(A=A||[]).push(Ne,le)):Ne==="children"?typeof le!="string"&&typeof le!="number"||(A=A||[]).push(Ne,""+le):Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ne)?(le!=null&&Ne==="onScroll"&&Ht("scroll",l),A||re===le||(A=[])):(A=A||[]).push(Ne,le))}p&&(A=A||[]).push("style",p);var Ne=A;(u.updateQueue=Ne)&&(u.flags|=4)}},nS=function(l,u,p,w){p!==w&&(u.flags|=4)};function du(l,u){if(!Jt)switch(l.tailMode){case"hidden":u=l.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?l.tail=null:p.sibling=null;break;case"collapsed":p=l.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:w.sibling=null}}function mn(l){var u=l.alternate!==null&&l.alternate.child===l.child,p=0,w=0;if(u)for(var _=l.child;_!==null;)p|=_.lanes|_.childLanes,w|=_.subtreeFlags&14680064,w|=_.flags&14680064,_.return=l,_=_.sibling;else for(_=l.child;_!==null;)p|=_.lanes|_.childLanes,w|=_.subtreeFlags,w|=_.flags,_.return=l,_=_.sibling;return l.subtreeFlags|=w,l.childLanes=p,u}function IF(l,u,p){var w=u.pendingProps;switch(lp(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mn(u),null;case 1:return Un(u.type)&&pd(),mn(u),null;case 3:return w=u.stateNode,Ol(),Vt($n),Vt(dn),bp(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(l===null||l.child===null)&&(wd(u)?u.flags|=4:l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Ha!==null&&(Jp(Ha),Ha=null))),$p(l,u),mn(u),null;case 5:yp(u);var _=xo(ou.current);if(p=u.type,l!==null&&u.stateNode!=null)rS(l,u,p,w,_),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!w){if(u.stateNode===null)throw Error(r(166));return mn(u),null}if(l=xo(oi.current),wd(u)){w=u.stateNode,p=u.type;var A=u.memoizedProps;switch(w[si]=u,w[ru]=A,l=(u.mode&1)!==0,p){case"dialog":Ht("cancel",w),Ht("close",w);break;case"iframe":case"object":case"embed":Ht("load",w);break;case"video":case"audio":for(_=0;_<Zc.length;_++)Ht(Zc[_],w);break;case"source":Ht("error",w);break;case"img":case"image":case"link":Ht("error",w),Ht("load",w);break;case"details":Ht("toggle",w);break;case"input":Le(w,A),Ht("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!A.multiple},Ht("invalid",w);break;case"textarea":Rn(w,A),Ht("invalid",w)}We(p,A),_=null;for(var I in A)if(A.hasOwnProperty(I)){var re=A[I];I==="children"?typeof re=="string"?w.textContent!==re&&(A.suppressHydrationWarning!==!0&&dd(w.textContent,re,l),_=["children",re]):typeof re=="number"&&w.textContent!==""+re&&(A.suppressHydrationWarning!==!0&&dd(w.textContent,re,l),_=["children",""+re]):a.hasOwnProperty(I)&&re!=null&&I==="onScroll"&&Ht("scroll",w)}switch(p){case"input":oe(w),ot(w,A,!0);break;case"textarea":oe(w),tr(w);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(w.onclick=hd)}w=_,u.updateQueue=w,w!==null&&(u.flags|=4)}else{I=_.nodeType===9?_:_.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Ln(p)),l==="http://www.w3.org/1999/xhtml"?p==="script"?(l=I.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof w.is=="string"?l=I.createElement(p,{is:w.is}):(l=I.createElement(p),p==="select"&&(I=l,w.multiple?I.multiple=!0:w.size&&(I.size=w.size))):l=I.createElementNS(l,p),l[si]=u,l[ru]=w,tS(l,u,!1,!1),u.stateNode=l;e:{switch(I=at(p,w),p){case"dialog":Ht("cancel",l),Ht("close",l),_=w;break;case"iframe":case"object":case"embed":Ht("load",l),_=w;break;case"video":case"audio":for(_=0;_<Zc.length;_++)Ht(Zc[_],l);_=w;break;case"source":Ht("error",l),_=w;break;case"img":case"image":case"link":Ht("error",l),Ht("load",l),_=w;break;case"details":Ht("toggle",l),_=w;break;case"input":Le(l,w),_=je(l,w),Ht("invalid",l);break;case"option":_=w;break;case"select":l._wrapperState={wasMultiple:!!w.multiple},_=xe({},w,{value:void 0}),Ht("invalid",l);break;case"textarea":Rn(l,w),_=za(l,w),Ht("invalid",l);break;default:_=w}We(p,_),re=_;for(A in re)if(re.hasOwnProperty(A)){var le=re[A];A==="style"?Ke(l,le):A==="dangerouslySetInnerHTML"?(le=le?le.__html:void 0,le!=null&&Cn(l,le)):A==="children"?typeof le=="string"?(p!=="textarea"||le!=="")&&ut(l,le):typeof le=="number"&&ut(l,""+le):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(a.hasOwnProperty(A)?le!=null&&A==="onScroll"&&Ht("scroll",l):le!=null&&S(l,A,le,I))}switch(p){case"input":oe(l),ot(l,w,!1);break;case"textarea":oe(l),tr(l);break;case"option":w.value!=null&&l.setAttribute("value",""+L(w.value));break;case"select":l.multiple=!!w.multiple,A=w.value,A!=null?jt(l,!!w.multiple,A,!1):w.defaultValue!=null&&jt(l,!!w.multiple,w.defaultValue,!0);break;default:typeof _.onClick=="function"&&(l.onclick=hd)}switch(p){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return mn(u),null;case 6:if(l&&u.stateNode!=null)nS(l,u,l.memoizedProps,w);else{if(typeof w!="string"&&u.stateNode===null)throw Error(r(166));if(p=xo(ou.current),xo(oi.current),wd(u)){if(w=u.stateNode,p=u.memoizedProps,w[si]=u,(A=w.nodeValue!==p)&&(l=Zn,l!==null))switch(l.tag){case 3:dd(w.nodeValue,p,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&dd(w.nodeValue,p,(l.mode&1)!==0)}A&&(u.flags|=4)}else w=(p.nodeType===9?p:p.ownerDocument).createTextNode(w),w[si]=u,u.stateNode=w}return mn(u),null;case 13:if(Vt(nr),w=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Jt&&ea!==null&&(u.mode&1)!==0&&(u.flags&128)===0)s2(),Cl(),u.flags|=98560,A=!1;else if(A=wd(u),w!==null&&w.dehydrated!==null){if(l===null){if(!A)throw Error(r(318));if(A=u.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(r(317));A[si]=u}else Cl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;mn(u),A=!1}else Ha!==null&&(Jp(Ha),Ha=null),A=!0;if(!A)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=p,u):(w=w!==null,w!==(l!==null&&l.memoizedState!==null)&&w&&(u.child.flags|=8192,(u.mode&1)!==0&&(l===null||(nr.current&1)!==0?Pr===0&&(Pr=3):ex())),u.updateQueue!==null&&(u.flags|=4),mn(u),null);case 4:return Ol(),$p(l,u),l===null&&eu(u.stateNode.containerInfo),mn(u),null;case 10:return mp(u.type._context),mn(u),null;case 17:return Un(u.type)&&pd(),mn(u),null;case 19:if(Vt(nr),A=u.memoizedState,A===null)return mn(u),null;if(w=(u.flags&128)!==0,I=A.rendering,I===null)if(w)du(A,!1);else{if(Pr!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(I=kd(l),I!==null){for(u.flags|=128,du(A,!1),w=I.updateQueue,w!==null&&(u.updateQueue=w,u.flags|=4),u.subtreeFlags=0,w=p,p=u.child;p!==null;)A=p,l=w,A.flags&=14680066,I=A.alternate,I===null?(A.childLanes=0,A.lanes=l,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=I.childLanes,A.lanes=I.lanes,A.child=I.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=I.memoizedProps,A.memoizedState=I.memoizedState,A.updateQueue=I.updateQueue,A.type=I.type,l=I.dependencies,A.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),p=p.sibling;return zt(nr,nr.current&1|2),u.child}l=l.sibling}A.tail!==null&&Ie()>Ml&&(u.flags|=128,w=!0,du(A,!1),u.lanes=4194304)}else{if(!w)if(l=kd(I),l!==null){if(u.flags|=128,w=!0,p=l.updateQueue,p!==null&&(u.updateQueue=p,u.flags|=4),du(A,!0),A.tail===null&&A.tailMode==="hidden"&&!I.alternate&&!Jt)return mn(u),null}else 2*Ie()-A.renderingStartTime>Ml&&p!==1073741824&&(u.flags|=128,w=!0,du(A,!1),u.lanes=4194304);A.isBackwards?(I.sibling=u.child,u.child=I):(p=A.last,p!==null?p.sibling=I:u.child=I,A.last=I)}return A.tail!==null?(u=A.tail,A.rendering=u,A.tail=u.sibling,A.renderingStartTime=Ie(),u.sibling=null,p=nr.current,zt(nr,w?p&1|2:p&1),u):(mn(u),null);case 22:case 23:return Zp(),w=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==w&&(u.flags|=8192),w&&(u.mode&1)!==0?(ta&1073741824)!==0&&(mn(u),u.subtreeFlags&6&&(u.flags|=8192)):mn(u),null;case 24:return null;case 25:return null}throw Error(r(156,u.tag))}function MF(l,u){switch(lp(u),u.tag){case 1:return Un(u.type)&&pd(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return Ol(),Vt($n),Vt(dn),bp(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 5:return yp(u),null;case 13:if(Vt(nr),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(r(340));Cl()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return Vt(nr),null;case 4:return Ol(),null;case 10:return mp(u.type._context),null;case 22:case 23:return Zp(),null;case 24:return null;default:return null}}var Id=!1,pn=!1,RF=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function Dl(l,u){var p=l.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(w){cr(l,u,w)}else p.current=null}function Up(l,u,p){try{p()}catch(w){cr(l,u,w)}}var aS=!1;function LF(l,u){if(Zm=td,l=Mb(),Vm(l)){if("selectionStart"in l)var p={start:l.selectionStart,end:l.selectionEnd};else e:{p=(p=l.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var _=w.anchorOffset,A=w.focusNode;w=w.focusOffset;try{p.nodeType,A.nodeType}catch{p=null;break e}var I=0,re=-1,le=-1,Ne=0,Oe=0,De=l,Te=null;t:for(;;){for(var He;De!==p||_!==0&&De.nodeType!==3||(re=I+_),De!==A||w!==0&&De.nodeType!==3||(le=I+w),De.nodeType===3&&(I+=De.nodeValue.length),(He=De.firstChild)!==null;)Te=De,De=He;for(;;){if(De===l)break t;if(Te===p&&++Ne===_&&(re=I),Te===A&&++Oe===w&&(le=I),(He=De.nextSibling)!==null)break;De=Te,Te=De.parentNode}De=He}p=re===-1||le===-1?null:{start:re,end:le}}else p=null}p=p||{start:0,end:0}}else p=null;for(ep={focusedElem:l,selectionRange:p},td=!1,Ge=u;Ge!==null;)if(u=Ge,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,Ge=l;else for(;Ge!==null;){u=Ge;try{var qe=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(qe!==null){var Ye=qe.memoizedProps,pr=qe.memoizedState,pe=u.stateNode,ue=pe.getSnapshotBeforeUpdate(u.elementType===u.type?Ye:Va(u.type,Ye),pr);pe.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:var ge=u.stateNode.containerInfo;ge.nodeType===1?ge.textContent="":ge.nodeType===9&&ge.documentElement&&ge.removeChild(ge.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Re){cr(u,u.return,Re)}if(l=u.sibling,l!==null){l.return=u.return,Ge=l;break}Ge=u.return}return qe=aS,aS=!1,qe}function hu(l,u,p){var w=u.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var _=w=w.next;do{if((_.tag&l)===l){var A=_.destroy;_.destroy=void 0,A!==void 0&&Up(u,p,A)}_=_.next}while(_!==w)}}function Md(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var p=u=u.next;do{if((p.tag&l)===l){var w=p.create;p.destroy=w()}p=p.next}while(p!==u)}}function zp(l){var u=l.ref;if(u!==null){var p=l.stateNode;switch(l.tag){case 5:l=p;break;default:l=p}typeof u=="function"?u(l):u.current=l}}function iS(l){var u=l.alternate;u!==null&&(l.alternate=null,iS(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&(delete u[si],delete u[ru],delete u[ap],delete u[wF],delete u[bF])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function sS(l){return l.tag===5||l.tag===3||l.tag===4}function oS(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||sS(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Wp(l,u,p){var w=l.tag;if(w===5||w===6)l=l.stateNode,u?p.nodeType===8?p.parentNode.insertBefore(l,u):p.insertBefore(l,u):(p.nodeType===8?(u=p.parentNode,u.insertBefore(l,p)):(u=p,u.appendChild(l)),p=p._reactRootContainer,p!=null||u.onclick!==null||(u.onclick=hd));else if(w!==4&&(l=l.child,l!==null))for(Wp(l,u,p),l=l.sibling;l!==null;)Wp(l,u,p),l=l.sibling}function Hp(l,u,p){var w=l.tag;if(w===5||w===6)l=l.stateNode,u?p.insertBefore(l,u):p.appendChild(l);else if(w!==4&&(l=l.child,l!==null))for(Hp(l,u,p),l=l.sibling;l!==null;)Hp(l,u,p),l=l.sibling}var rn=null,Ka=!1;function Ns(l,u,p){for(p=p.child;p!==null;)lS(l,u,p),p=p.sibling}function lS(l,u,p){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(ii,p)}catch{}switch(p.tag){case 5:pn||Dl(p,u);case 6:var w=rn,_=Ka;rn=null,Ns(l,u,p),rn=w,Ka=_,rn!==null&&(Ka?(l=rn,p=p.stateNode,l.nodeType===8?l.parentNode.removeChild(p):l.removeChild(p)):rn.removeChild(p.stateNode));break;case 18:rn!==null&&(Ka?(l=rn,p=p.stateNode,l.nodeType===8?np(l.parentNode,p):l.nodeType===1&&np(l,p),Vc(l)):np(rn,p.stateNode));break;case 4:w=rn,_=Ka,rn=p.stateNode.containerInfo,Ka=!0,Ns(l,u,p),rn=w,Ka=_;break;case 0:case 11:case 14:case 15:if(!pn&&(w=p.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){_=w=w.next;do{var A=_,I=A.destroy;A=A.tag,I!==void 0&&((A&2)!==0||(A&4)!==0)&&Up(p,u,I),_=_.next}while(_!==w)}Ns(l,u,p);break;case 1:if(!pn&&(Dl(p,u),w=p.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=p.memoizedProps,w.state=p.memoizedState,w.componentWillUnmount()}catch(re){cr(p,u,re)}Ns(l,u,p);break;case 21:Ns(l,u,p);break;case 22:p.mode&1?(pn=(w=pn)||p.memoizedState!==null,Ns(l,u,p),pn=w):Ns(l,u,p);break;default:Ns(l,u,p)}}function cS(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var p=l.stateNode;p===null&&(p=l.stateNode=new RF),u.forEach(function(w){var _=GF.bind(null,l,w);p.has(w)||(p.add(w),w.then(_,_))})}}function Ga(l,u){var p=u.deletions;if(p!==null)for(var w=0;w<p.length;w++){var _=p[w];try{var A=l,I=u,re=I;e:for(;re!==null;){switch(re.tag){case 5:rn=re.stateNode,Ka=!1;break e;case 3:rn=re.stateNode.containerInfo,Ka=!0;break e;case 4:rn=re.stateNode.containerInfo,Ka=!0;break e}re=re.return}if(rn===null)throw Error(r(160));lS(A,I,_),rn=null,Ka=!1;var le=_.alternate;le!==null&&(le.return=null),_.return=null}catch(Ne){cr(_,u,Ne)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)uS(u,l),u=u.sibling}function uS(l,u){var p=l.alternate,w=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ga(u,l),ci(l),w&4){try{hu(3,l,l.return),Md(3,l)}catch(Ye){cr(l,l.return,Ye)}try{hu(5,l,l.return)}catch(Ye){cr(l,l.return,Ye)}}break;case 1:Ga(u,l),ci(l),w&512&&p!==null&&Dl(p,p.return);break;case 5:if(Ga(u,l),ci(l),w&512&&p!==null&&Dl(p,p.return),l.flags&32){var _=l.stateNode;try{ut(_,"")}catch(Ye){cr(l,l.return,Ye)}}if(w&4&&(_=l.stateNode,_!=null)){var A=l.memoizedProps,I=p!==null?p.memoizedProps:A,re=l.type,le=l.updateQueue;if(l.updateQueue=null,le!==null)try{re==="input"&&A.type==="radio"&&A.name!=null&&Ue(_,A),at(re,I);var Ne=at(re,A);for(I=0;I<le.length;I+=2){var Oe=le[I],De=le[I+1];Oe==="style"?Ke(_,De):Oe==="dangerouslySetInnerHTML"?Cn(_,De):Oe==="children"?ut(_,De):S(_,Oe,De,Ne)}switch(re){case"input":Pe(_,A);break;case"textarea":Br(_,A);break;case"select":var Te=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!A.multiple;var He=A.value;He!=null?jt(_,!!A.multiple,He,!1):Te!==!!A.multiple&&(A.defaultValue!=null?jt(_,!!A.multiple,A.defaultValue,!0):jt(_,!!A.multiple,A.multiple?[]:"",!1))}_[ru]=A}catch(Ye){cr(l,l.return,Ye)}}break;case 6:if(Ga(u,l),ci(l),w&4){if(l.stateNode===null)throw Error(r(162));_=l.stateNode,A=l.memoizedProps;try{_.nodeValue=A}catch(Ye){cr(l,l.return,Ye)}}break;case 3:if(Ga(u,l),ci(l),w&4&&p!==null&&p.memoizedState.isDehydrated)try{Vc(u.containerInfo)}catch(Ye){cr(l,l.return,Ye)}break;case 4:Ga(u,l),ci(l);break;case 13:Ga(u,l),ci(l),_=l.child,_.flags&8192&&(A=_.memoizedState!==null,_.stateNode.isHidden=A,!A||_.alternate!==null&&_.alternate.memoizedState!==null||(Gp=Ie())),w&4&&cS(l);break;case 22:if(Oe=p!==null&&p.memoizedState!==null,l.mode&1?(pn=(Ne=pn)||Oe,Ga(u,l),pn=Ne):Ga(u,l),ci(l),w&8192){if(Ne=l.memoizedState!==null,(l.stateNode.isHidden=Ne)&&!Oe&&(l.mode&1)!==0)for(Ge=l,Oe=l.child;Oe!==null;){for(De=Ge=Oe;Ge!==null;){switch(Te=Ge,He=Te.child,Te.tag){case 0:case 11:case 14:case 15:hu(4,Te,Te.return);break;case 1:Dl(Te,Te.return);var qe=Te.stateNode;if(typeof qe.componentWillUnmount=="function"){w=Te,p=Te.return;try{u=w,qe.props=u.memoizedProps,qe.state=u.memoizedState,qe.componentWillUnmount()}catch(Ye){cr(w,p,Ye)}}break;case 5:Dl(Te,Te.return);break;case 22:if(Te.memoizedState!==null){hS(De);continue}}He!==null?(He.return=Te,Ge=He):hS(De)}Oe=Oe.sibling}e:for(Oe=null,De=l;;){if(De.tag===5){if(Oe===null){Oe=De;try{_=De.stateNode,Ne?(A=_.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(re=De.stateNode,le=De.memoizedProps.style,I=le!=null&&le.hasOwnProperty("display")?le.display:null,re.style.display=ke("display",I))}catch(Ye){cr(l,l.return,Ye)}}}else if(De.tag===6){if(Oe===null)try{De.stateNode.nodeValue=Ne?"":De.memoizedProps}catch(Ye){cr(l,l.return,Ye)}}else if((De.tag!==22&&De.tag!==23||De.memoizedState===null||De===l)&&De.child!==null){De.child.return=De,De=De.child;continue}if(De===l)break e;for(;De.sibling===null;){if(De.return===null||De.return===l)break e;Oe===De&&(Oe=null),De=De.return}Oe===De&&(Oe=null),De.sibling.return=De.return,De=De.sibling}}break;case 19:Ga(u,l),ci(l),w&4&&cS(l);break;case 21:break;default:Ga(u,l),ci(l)}}function ci(l){var u=l.flags;if(u&2){try{e:{for(var p=l.return;p!==null;){if(sS(p)){var w=p;break e}p=p.return}throw Error(r(160))}switch(w.tag){case 5:var _=w.stateNode;w.flags&32&&(ut(_,""),w.flags&=-33);var A=oS(l);Hp(l,A,_);break;case 3:case 4:var I=w.stateNode.containerInfo,re=oS(l);Wp(l,re,I);break;default:throw Error(r(161))}}catch(le){cr(l,l.return,le)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function BF(l,u,p){Ge=l,fS(l)}function fS(l,u,p){for(var w=(l.mode&1)!==0;Ge!==null;){var _=Ge,A=_.child;if(_.tag===22&&w){var I=_.memoizedState!==null||Id;if(!I){var re=_.alternate,le=re!==null&&re.memoizedState!==null||pn;re=Id;var Ne=pn;if(Id=I,(pn=le)&&!Ne)for(Ge=_;Ge!==null;)I=Ge,le=I.child,I.tag===22&&I.memoizedState!==null?mS(_):le!==null?(le.return=I,Ge=le):mS(_);for(;A!==null;)Ge=A,fS(A),A=A.sibling;Ge=_,Id=re,pn=Ne}dS(l)}else(_.subtreeFlags&8772)!==0&&A!==null?(A.return=_,Ge=A):dS(l)}}function dS(l){for(;Ge!==null;){var u=Ge;if((u.flags&8772)!==0){var p=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:pn||Md(5,u);break;case 1:var w=u.stateNode;if(u.flags&4&&!pn)if(p===null)w.componentDidMount();else{var _=u.elementType===u.type?p.memoizedProps:Va(u.type,p.memoizedProps);w.componentDidUpdate(_,p.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var A=u.updateQueue;A!==null&&h2(u,A,w);break;case 3:var I=u.updateQueue;if(I!==null){if(p=null,u.child!==null)switch(u.child.tag){case 5:p=u.child.stateNode;break;case 1:p=u.child.stateNode}h2(u,I,p)}break;case 5:var re=u.stateNode;if(p===null&&u.flags&4){p=re;var le=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":le.autoFocus&&p.focus();break;case"img":le.src&&(p.src=le.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var Ne=u.alternate;if(Ne!==null){var Oe=Ne.memoizedState;if(Oe!==null){var De=Oe.dehydrated;De!==null&&Vc(De)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}pn||u.flags&512&&zp(u)}catch(Te){cr(u,u.return,Te)}}if(u===l){Ge=null;break}if(p=u.sibling,p!==null){p.return=u.return,Ge=p;break}Ge=u.return}}function hS(l){for(;Ge!==null;){var u=Ge;if(u===l){Ge=null;break}var p=u.sibling;if(p!==null){p.return=u.return,Ge=p;break}Ge=u.return}}function mS(l){for(;Ge!==null;){var u=Ge;try{switch(u.tag){case 0:case 11:case 15:var p=u.return;try{Md(4,u)}catch(le){cr(u,p,le)}break;case 1:var w=u.stateNode;if(typeof w.componentDidMount=="function"){var _=u.return;try{w.componentDidMount()}catch(le){cr(u,_,le)}}var A=u.return;try{zp(u)}catch(le){cr(u,A,le)}break;case 5:var I=u.return;try{zp(u)}catch(le){cr(u,I,le)}}}catch(le){cr(u,u.return,le)}if(u===l){Ge=null;break}var re=u.sibling;if(re!==null){re.return=u.return,Ge=re;break}Ge=u.return}}var $F=Math.ceil,Rd=C.ReactCurrentDispatcher,Vp=C.ReactCurrentOwner,ba=C.ReactCurrentBatchConfig,vt=0,Wr=null,br=null,nn=0,ta=0,Il=vs(0),Pr=0,mu=null,vo=0,Ld=0,Kp=0,pu=null,Wn=null,Gp=0,Ml=1/0,Ii=null,Bd=!1,Xp=null,_s=null,$d=!1,Es=null,Ud=0,xu=0,qp=null,zd=-1,Wd=0;function Tn(){return(vt&6)!==0?Ie():zd!==-1?zd:zd=Ie()}function ks(l){return(l.mode&1)===0?1:(vt&2)!==0&&nn!==0?nn&-nn:NF.transition!==null?(Wd===0&&(Wd=ob()),Wd):(l=At,l!==0||(l=window.event,l=l===void 0?16:xb(l.type)),l)}function Xa(l,u,p,w){if(50<xu)throw xu=0,qp=null,Error(r(185));$c(l,p,w),((vt&2)===0||l!==Wr)&&(l===Wr&&((vt&2)===0&&(Ld|=p),Pr===4&&js(l,nn)),Hn(l,w),p===1&&vt===0&&(u.mode&1)===0&&(Ml=Ie()+500,gd&&ws()))}function Hn(l,u){var p=l.callbackNode;N6(l,u);var w=Qf(l,l===Wr?nn:0);if(w===0)p!==null&&ze(p),l.callbackNode=null,l.callbackPriority=0;else if(u=w&-w,l.callbackPriority!==u){if(p!=null&&ze(p),u===1)l.tag===0?SF(xS.bind(null,l)):t2(xS.bind(null,l)),vF(function(){(vt&6)===0&&ws()}),p=null;else{switch(lb(w)){case 1:p=Lt;break;case 4:p=Ut;break;case 16:p=hr;break;case 536870912:p=us;break;default:p=hr}p=_S(p,pS.bind(null,l))}l.callbackPriority=u,l.callbackNode=p}}function pS(l,u){if(zd=-1,Wd=0,(vt&6)!==0)throw Error(r(327));var p=l.callbackNode;if(Rl()&&l.callbackNode!==p)return null;var w=Qf(l,l===Wr?nn:0);if(w===0)return null;if((w&30)!==0||(w&l.expiredLanes)!==0||u)u=Hd(l,w);else{u=w;var _=vt;vt|=2;var A=vS();(Wr!==l||nn!==u)&&(Ii=null,Ml=Ie()+500,wo(l,u));do try{WF();break}catch(re){gS(l,re)}while(!0);hp(),Rd.current=A,vt=_,br!==null?u=0:(Wr=null,nn=0,u=Pr)}if(u!==0){if(u===2&&(_=Am(l),_!==0&&(w=_,u=Yp(l,_))),u===1)throw p=mu,wo(l,0),js(l,w),Hn(l,Ie()),p;if(u===6)js(l,w);else{if(_=l.current.alternate,(w&30)===0&&!UF(_)&&(u=Hd(l,w),u===2&&(A=Am(l),A!==0&&(w=A,u=Yp(l,A))),u===1))throw p=mu,wo(l,0),js(l,w),Hn(l,Ie()),p;switch(l.finishedWork=_,l.finishedLanes=w,u){case 0:case 1:throw Error(r(345));case 2:bo(l,Wn,Ii);break;case 3:if(js(l,w),(w&130023424)===w&&(u=Gp+500-Ie(),10<u)){if(Qf(l,0)!==0)break;if(_=l.suspendedLanes,(_&w)!==w){Tn(),l.pingedLanes|=l.suspendedLanes&_;break}l.timeoutHandle=rp(bo.bind(null,l,Wn,Ii),u);break}bo(l,Wn,Ii);break;case 4:if(js(l,w),(w&4194240)===w)break;for(u=l.eventTimes,_=-1;0<w;){var I=31-mr(w);A=1<<I,I=u[I],I>_&&(_=I),w&=~A}if(w=_,w=Ie()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*$F(w/1960))-w,10<w){l.timeoutHandle=rp(bo.bind(null,l,Wn,Ii),w);break}bo(l,Wn,Ii);break;case 5:bo(l,Wn,Ii);break;default:throw Error(r(329))}}}return Hn(l,Ie()),l.callbackNode===p?pS.bind(null,l):null}function Yp(l,u){var p=pu;return l.current.memoizedState.isDehydrated&&(wo(l,u).flags|=256),l=Hd(l,u),l!==2&&(u=Wn,Wn=p,u!==null&&Jp(u)),l}function Jp(l){Wn===null?Wn=l:Wn.push.apply(Wn,l)}function UF(l){for(var u=l;;){if(u.flags&16384){var p=u.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var w=0;w<p.length;w++){var _=p[w],A=_.getSnapshot;_=_.value;try{if(!Wa(A(),_))return!1}catch{return!1}}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function js(l,u){for(u&=~Kp,u&=~Ld,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var p=31-mr(u),w=1<<p;l[p]=-1,u&=~w}}function xS(l){if((vt&6)!==0)throw Error(r(327));Rl();var u=Qf(l,0);if((u&1)===0)return Hn(l,Ie()),null;var p=Hd(l,u);if(l.tag!==0&&p===2){var w=Am(l);w!==0&&(u=w,p=Yp(l,w))}if(p===1)throw p=mu,wo(l,0),js(l,u),Hn(l,Ie()),p;if(p===6)throw Error(r(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,bo(l,Wn,Ii),Hn(l,Ie()),null}function Qp(l,u){var p=vt;vt|=1;try{return l(u)}finally{vt=p,vt===0&&(Ml=Ie()+500,gd&&ws())}}function yo(l){Es!==null&&Es.tag===0&&(vt&6)===0&&Rl();var u=vt;vt|=1;var p=ba.transition,w=At;try{if(ba.transition=null,At=1,l)return l()}finally{At=w,ba.transition=p,vt=u,(vt&6)===0&&ws()}}function Zp(){ta=Il.current,Vt(Il)}function wo(l,u){l.finishedWork=null,l.finishedLanes=0;var p=l.timeoutHandle;if(p!==-1&&(l.timeoutHandle=-1,gF(p)),br!==null)for(p=br.return;p!==null;){var w=p;switch(lp(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&pd();break;case 3:Ol(),Vt($n),Vt(dn),bp();break;case 5:yp(w);break;case 4:Ol();break;case 13:Vt(nr);break;case 19:Vt(nr);break;case 10:mp(w.type._context);break;case 22:case 23:Zp()}p=p.return}if(Wr=l,br=l=Cs(l.current,null),nn=ta=u,Pr=0,mu=null,Kp=Ld=vo=0,Wn=pu=null,po!==null){for(u=0;u<po.length;u++)if(p=po[u],w=p.interleaved,w!==null){p.interleaved=null;var _=w.next,A=p.pending;if(A!==null){var I=A.next;A.next=_,w.next=I}p.pending=w}po=null}return l}function gS(l,u){do{var p=br;try{if(hp(),jd.current=Pd,Cd){for(var w=ar.memoizedState;w!==null;){var _=w.queue;_!==null&&(_.pending=null),w=w.next}Cd=!1}if(go=0,zr=Tr=ar=null,lu=!1,cu=0,Vp.current=null,p===null||p.return===null){Pr=1,mu=u,br=null;break}e:{var A=l,I=p.return,re=p,le=u;if(u=nn,re.flags|=32768,le!==null&&typeof le=="object"&&typeof le.then=="function"){var Ne=le,Oe=re,De=Oe.tag;if((Oe.mode&1)===0&&(De===0||De===11||De===15)){var Te=Oe.alternate;Te?(Oe.updateQueue=Te.updateQueue,Oe.memoizedState=Te.memoizedState,Oe.lanes=Te.lanes):(Oe.updateQueue=null,Oe.memoizedState=null)}var He=z2(I);if(He!==null){He.flags&=-257,W2(He,I,re,A,u),He.mode&1&&U2(A,Ne,u),u=He,le=Ne;var qe=u.updateQueue;if(qe===null){var Ye=new Set;Ye.add(le),u.updateQueue=Ye}else qe.add(le);break e}else{if((u&1)===0){U2(A,Ne,u),ex();break e}le=Error(r(426))}}else if(Jt&&re.mode&1){var pr=z2(I);if(pr!==null){(pr.flags&65536)===0&&(pr.flags|=256),W2(pr,I,re,A,u),fp(Fl(le,re));break e}}A=le=Fl(le,re),Pr!==4&&(Pr=2),pu===null?pu=[A]:pu.push(A),A=I;do{switch(A.tag){case 3:A.flags|=65536,u&=-u,A.lanes|=u;var pe=B2(A,le,u);d2(A,pe);break e;case 1:re=le;var ue=A.type,ge=A.stateNode;if((A.flags&128)===0&&(typeof ue.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(_s===null||!_s.has(ge)))){A.flags|=65536,u&=-u,A.lanes|=u;var Re=$2(A,re,u);d2(A,Re);break e}}A=A.return}while(A!==null)}wS(p)}catch(Qe){u=Qe,br===p&&p!==null&&(br=p=p.return);continue}break}while(!0)}function vS(){var l=Rd.current;return Rd.current=Pd,l===null?Pd:l}function ex(){(Pr===0||Pr===3||Pr===2)&&(Pr=4),Wr===null||(vo&268435455)===0&&(Ld&268435455)===0||js(Wr,nn)}function Hd(l,u){var p=vt;vt|=2;var w=vS();(Wr!==l||nn!==u)&&(Ii=null,wo(l,u));do try{zF();break}catch(_){gS(l,_)}while(!0);if(hp(),vt=p,Rd.current=w,br!==null)throw Error(r(261));return Wr=null,nn=0,Pr}function zF(){for(;br!==null;)yS(br)}function WF(){for(;br!==null&&!Ve();)yS(br)}function yS(l){var u=NS(l.alternate,l,ta);l.memoizedProps=l.pendingProps,u===null?wS(l):br=u,Vp.current=null}function wS(l){var u=l;do{var p=u.alternate;if(l=u.return,(u.flags&32768)===0){if(p=IF(p,u,ta),p!==null){br=p;return}}else{if(p=MF(p,u),p!==null){p.flags&=32767,br=p;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Pr=6,br=null;return}}if(u=u.sibling,u!==null){br=u;return}br=u=l}while(u!==null);Pr===0&&(Pr=5)}function bo(l,u,p){var w=At,_=ba.transition;try{ba.transition=null,At=1,HF(l,u,p,w)}finally{ba.transition=_,At=w}return null}function HF(l,u,p,w){do Rl();while(Es!==null);if((vt&6)!==0)throw Error(r(327));p=l.finishedWork;var _=l.finishedLanes;if(p===null)return null;if(l.finishedWork=null,l.finishedLanes=0,p===l.current)throw Error(r(177));l.callbackNode=null,l.callbackPriority=0;var A=p.lanes|p.childLanes;if(_6(l,A),l===Wr&&(br=Wr=null,nn=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||$d||($d=!0,_S(hr,function(){return Rl(),null})),A=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||A){A=ba.transition,ba.transition=null;var I=At;At=1;var re=vt;vt|=4,Vp.current=null,LF(l,p),uS(p,l),uF(ep),td=!!Zm,ep=Zm=null,l.current=p,BF(p),Me(),vt=re,At=I,ba.transition=A}else l.current=p;if($d&&($d=!1,Es=l,Ud=_),A=l.pendingLanes,A===0&&(_s=null),Lc(p.stateNode),Hn(l,Ie()),u!==null)for(w=l.onRecoverableError,p=0;p<u.length;p++)_=u[p],w(_.value,{componentStack:_.stack,digest:_.digest});if(Bd)throw Bd=!1,l=Xp,Xp=null,l;return(Ud&1)!==0&&l.tag!==0&&Rl(),A=l.pendingLanes,(A&1)!==0?l===qp?xu++:(xu=0,qp=l):xu=0,ws(),null}function Rl(){if(Es!==null){var l=lb(Ud),u=ba.transition,p=At;try{if(ba.transition=null,At=16>l?16:l,Es===null)var w=!1;else{if(l=Es,Es=null,Ud=0,(vt&6)!==0)throw Error(r(331));var _=vt;for(vt|=4,Ge=l.current;Ge!==null;){var A=Ge,I=A.child;if((Ge.flags&16)!==0){var re=A.deletions;if(re!==null){for(var le=0;le<re.length;le++){var Ne=re[le];for(Ge=Ne;Ge!==null;){var Oe=Ge;switch(Oe.tag){case 0:case 11:case 15:hu(8,Oe,A)}var De=Oe.child;if(De!==null)De.return=Oe,Ge=De;else for(;Ge!==null;){Oe=Ge;var Te=Oe.sibling,He=Oe.return;if(iS(Oe),Oe===Ne){Ge=null;break}if(Te!==null){Te.return=He,Ge=Te;break}Ge=He}}}var qe=A.alternate;if(qe!==null){var Ye=qe.child;if(Ye!==null){qe.child=null;do{var pr=Ye.sibling;Ye.sibling=null,Ye=pr}while(Ye!==null)}}Ge=A}}if((A.subtreeFlags&2064)!==0&&I!==null)I.return=A,Ge=I;else e:for(;Ge!==null;){if(A=Ge,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:hu(9,A,A.return)}var pe=A.sibling;if(pe!==null){pe.return=A.return,Ge=pe;break e}Ge=A.return}}var ue=l.current;for(Ge=ue;Ge!==null;){I=Ge;var ge=I.child;if((I.subtreeFlags&2064)!==0&&ge!==null)ge.return=I,Ge=ge;else e:for(I=ue;Ge!==null;){if(re=Ge,(re.flags&2048)!==0)try{switch(re.tag){case 0:case 11:case 15:Md(9,re)}}catch(Qe){cr(re,re.return,Qe)}if(re===I){Ge=null;break e}var Re=re.sibling;if(Re!==null){Re.return=re.return,Ge=Re;break e}Ge=re.return}}if(vt=_,ws(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(ii,l)}catch{}w=!0}return w}finally{At=p,ba.transition=u}}return!1}function bS(l,u,p){u=Fl(p,u),u=B2(l,u,1),l=Ss(l,u,1),u=Tn(),l!==null&&($c(l,1,u),Hn(l,u))}function cr(l,u,p){if(l.tag===3)bS(l,l,p);else for(;u!==null;){if(u.tag===3){bS(u,l,p);break}else if(u.tag===1){var w=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(_s===null||!_s.has(w))){l=Fl(p,l),l=$2(u,l,1),u=Ss(u,l,1),l=Tn(),u!==null&&($c(u,1,l),Hn(u,l));break}}u=u.return}}function VF(l,u,p){var w=l.pingCache;w!==null&&w.delete(u),u=Tn(),l.pingedLanes|=l.suspendedLanes&p,Wr===l&&(nn&p)===p&&(Pr===4||Pr===3&&(nn&130023424)===nn&&500>Ie()-Gp?wo(l,0):Kp|=p),Hn(l,u)}function SS(l,u){u===0&&((l.mode&1)===0?u=1:(u=Jf,Jf<<=1,(Jf&130023424)===0&&(Jf=4194304)));var p=Tn();l=Oi(l,u),l!==null&&($c(l,u,p),Hn(l,p))}function KF(l){var u=l.memoizedState,p=0;u!==null&&(p=u.retryLane),SS(l,p)}function GF(l,u){var p=0;switch(l.tag){case 13:var w=l.stateNode,_=l.memoizedState;_!==null&&(p=_.retryLane);break;case 19:w=l.stateNode;break;default:throw Error(r(314))}w!==null&&w.delete(u),SS(l,p)}var NS;NS=function(l,u,p){if(l!==null)if(l.memoizedProps!==u.pendingProps||$n.current)zn=!0;else{if((l.lanes&p)===0&&(u.flags&128)===0)return zn=!1,DF(l,u,p);zn=(l.flags&131072)!==0}else zn=!1,Jt&&(u.flags&1048576)!==0&&r2(u,yd,u.index);switch(u.lanes=0,u.tag){case 2:var w=u.type;Dd(l,u),l=u.pendingProps;var _=El(u,dn.current);Pl(u,p),_=_p(null,u,w,l,_,p);var A=Ep();return u.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Un(w)?(A=!0,xd(u)):A=!1,u.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,gp(u),_.updater=Od,u.stateNode=_,_._reactInternals=u,Pp(u,w,l,p),u=Ip(null,u,w,!0,A,p)):(u.tag=0,Jt&&A&&op(u),An(null,u,_,p),u=u.child),u;case 16:w=u.elementType;e:{switch(Dd(l,u),l=u.pendingProps,_=w._init,w=_(w._payload),u.type=w,_=u.tag=qF(w),l=Va(w,l),_){case 0:u=Dp(null,u,w,l,p);break e;case 1:u=q2(null,u,w,l,p);break e;case 11:u=H2(null,u,w,l,p);break e;case 14:u=V2(null,u,w,Va(w.type,l),p);break e}throw Error(r(306,w,""))}return u;case 0:return w=u.type,_=u.pendingProps,_=u.elementType===w?_:Va(w,_),Dp(l,u,w,_,p);case 1:return w=u.type,_=u.pendingProps,_=u.elementType===w?_:Va(w,_),q2(l,u,w,_,p);case 3:e:{if(Y2(u),l===null)throw Error(r(387));w=u.pendingProps,A=u.memoizedState,_=A.element,f2(l,u),Ed(u,w,null,p);var I=u.memoizedState;if(w=I.element,A.isDehydrated)if(A={element:w,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},u.updateQueue.baseState=A,u.memoizedState=A,u.flags&256){_=Fl(Error(r(423)),u),u=J2(l,u,w,p,_);break e}else if(w!==_){_=Fl(Error(r(424)),u),u=J2(l,u,w,p,_);break e}else for(ea=gs(u.stateNode.containerInfo.firstChild),Zn=u,Jt=!0,Ha=null,p=c2(u,null,w,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Cl(),w===_){u=Di(l,u,p);break e}An(l,u,w,p)}u=u.child}return u;case 5:return m2(u),l===null&&up(u),w=u.type,_=u.pendingProps,A=l!==null?l.memoizedProps:null,I=_.children,tp(w,_)?I=null:A!==null&&tp(w,A)&&(u.flags|=32),X2(l,u),An(l,u,I,p),u.child;case 6:return l===null&&up(u),null;case 13:return Q2(l,u,p);case 4:return vp(u,u.stateNode.containerInfo),w=u.pendingProps,l===null?u.child=Al(u,null,w,p):An(l,u,w,p),u.child;case 11:return w=u.type,_=u.pendingProps,_=u.elementType===w?_:Va(w,_),H2(l,u,w,_,p);case 7:return An(l,u,u.pendingProps,p),u.child;case 8:return An(l,u,u.pendingProps.children,p),u.child;case 12:return An(l,u,u.pendingProps.children,p),u.child;case 10:e:{if(w=u.type._context,_=u.pendingProps,A=u.memoizedProps,I=_.value,zt(Sd,w._currentValue),w._currentValue=I,A!==null)if(Wa(A.value,I)){if(A.children===_.children&&!$n.current){u=Di(l,u,p);break e}}else for(A=u.child,A!==null&&(A.return=u);A!==null;){var re=A.dependencies;if(re!==null){I=A.child;for(var le=re.firstContext;le!==null;){if(le.context===w){if(A.tag===1){le=Fi(-1,p&-p),le.tag=2;var Ne=A.updateQueue;if(Ne!==null){Ne=Ne.shared;var Oe=Ne.pending;Oe===null?le.next=le:(le.next=Oe.next,Oe.next=le),Ne.pending=le}}A.lanes|=p,le=A.alternate,le!==null&&(le.lanes|=p),pp(A.return,p,u),re.lanes|=p;break}le=le.next}}else if(A.tag===10)I=A.type===u.type?null:A.child;else if(A.tag===18){if(I=A.return,I===null)throw Error(r(341));I.lanes|=p,re=I.alternate,re!==null&&(re.lanes|=p),pp(I,p,u),I=A.sibling}else I=A.child;if(I!==null)I.return=A;else for(I=A;I!==null;){if(I===u){I=null;break}if(A=I.sibling,A!==null){A.return=I.return,I=A;break}I=I.return}A=I}An(l,u,_.children,p),u=u.child}return u;case 9:return _=u.type,w=u.pendingProps.children,Pl(u,p),_=ya(_),w=w(_),u.flags|=1,An(l,u,w,p),u.child;case 14:return w=u.type,_=Va(w,u.pendingProps),_=Va(w.type,_),V2(l,u,w,_,p);case 15:return K2(l,u,u.type,u.pendingProps,p);case 17:return w=u.type,_=u.pendingProps,_=u.elementType===w?_:Va(w,_),Dd(l,u),u.tag=1,Un(w)?(l=!0,xd(u)):l=!1,Pl(u,p),R2(u,w,_),Pp(u,w,_,p),Ip(null,u,w,!0,l,p);case 19:return eS(l,u,p);case 22:return G2(l,u,p)}throw Error(r(156,u.tag))};function _S(l,u){return Fe(l,u)}function XF(l,u,p,w){this.tag=l,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sa(l,u,p,w){return new XF(l,u,p,w)}function tx(l){return l=l.prototype,!(!l||!l.isReactComponent)}function qF(l){if(typeof l=="function")return tx(l)?1:0;if(l!=null){if(l=l.$$typeof,l===z)return 11;if(l===ae)return 14}return 2}function Cs(l,u){var p=l.alternate;return p===null?(p=Sa(l.tag,u,l.key,l.mode),p.elementType=l.elementType,p.type=l.type,p.stateNode=l.stateNode,p.alternate=l,l.alternate=p):(p.pendingProps=u,p.type=l.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=l.flags&14680064,p.childLanes=l.childLanes,p.lanes=l.lanes,p.child=l.child,p.memoizedProps=l.memoizedProps,p.memoizedState=l.memoizedState,p.updateQueue=l.updateQueue,u=l.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=l.sibling,p.index=l.index,p.ref=l.ref,p}function Vd(l,u,p,w,_,A){var I=2;if(w=l,typeof l=="function")tx(l)&&(I=1);else if(typeof l=="string")I=5;else e:switch(l){case P:return So(p.children,_,A,u);case D:I=8,_|=8;break;case R:return l=Sa(12,p,u,_|2),l.elementType=R,l.lanes=A,l;case ie:return l=Sa(13,p,u,_),l.elementType=ie,l.lanes=A,l;case ce:return l=Sa(19,p,u,_),l.elementType=ce,l.lanes=A,l;case de:return Kd(p,_,A,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case q:I=10;break e;case M:I=9;break e;case z:I=11;break e;case ae:I=14;break e;case me:I=16,w=null;break e}throw Error(r(130,l==null?l:typeof l,""))}return u=Sa(I,p,u,_),u.elementType=l,u.type=w,u.lanes=A,u}function So(l,u,p,w){return l=Sa(7,l,w,u),l.lanes=p,l}function Kd(l,u,p,w){return l=Sa(22,l,w,u),l.elementType=de,l.lanes=p,l.stateNode={isHidden:!1},l}function rx(l,u,p){return l=Sa(6,l,null,u),l.lanes=p,l}function nx(l,u,p){return u=Sa(4,l.children!==null?l.children:[],l.key,u),u.lanes=p,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function YF(l,u,p,w,_){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tm(0),this.expirationTimes=Tm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tm(0),this.identifierPrefix=w,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function ax(l,u,p,w,_,A,I,re,le){return l=new YF(l,u,p,re,le),u===1?(u=1,A===!0&&(u|=8)):u=0,A=Sa(3,null,null,u),l.current=A,A.stateNode=l,A.memoizedState={element:w,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},gp(A),l}function JF(l,u,p){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:k,key:w==null?null:""+w,children:l,containerInfo:u,implementation:p}}function ES(l){if(!l)return ys;l=l._reactInternals;e:{if(ee(l)!==l||l.tag!==1)throw Error(r(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Un(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(r(171))}if(l.tag===1){var p=l.type;if(Un(p))return Zb(l,p,u)}return u}function kS(l,u,p,w,_,A,I,re,le){return l=ax(p,w,!0,l,_,A,I,re,le),l.context=ES(null),p=l.current,w=Tn(),_=ks(p),A=Fi(w,_),A.callback=u??null,Ss(p,A,_),l.current.lanes=_,$c(l,_,w),Hn(l,w),l}function Gd(l,u,p,w){var _=u.current,A=Tn(),I=ks(_);return p=ES(p),u.context===null?u.context=p:u.pendingContext=p,u=Fi(A,I),u.payload={element:l},w=w===void 0?null:w,w!==null&&(u.callback=w),l=Ss(_,u,I),l!==null&&(Xa(l,_,I,A),_d(l,_,I)),I}function Xd(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function jS(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var p=l.retryLane;l.retryLane=p!==0&&p<u?p:u}}function ix(l,u){jS(l,u),(l=l.alternate)&&jS(l,u)}function QF(){return null}var CS=typeof reportError=="function"?reportError:function(l){console.error(l)};function sx(l){this._internalRoot=l}qd.prototype.render=sx.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(r(409));Gd(l,u,null,null)},qd.prototype.unmount=sx.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;yo(function(){Gd(null,l,null,null)}),u[Ci]=null}};function qd(l){this._internalRoot=l}qd.prototype.unstable_scheduleHydration=function(l){if(l){var u=fb();l={blockedOn:null,target:l,priority:u};for(var p=0;p<ms.length&&u!==0&&u<ms[p].priority;p++);ms.splice(p,0,l),p===0&&mb(l)}};function ox(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Yd(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function AS(){}function ZF(l,u,p,w,_){if(_){if(typeof w=="function"){var A=w;w=function(){var Ne=Xd(I);A.call(Ne)}}var I=kS(u,w,l,0,null,!1,!1,"",AS);return l._reactRootContainer=I,l[Ci]=I.current,eu(l.nodeType===8?l.parentNode:l),yo(),I}for(;_=l.lastChild;)l.removeChild(_);if(typeof w=="function"){var re=w;w=function(){var Ne=Xd(le);re.call(Ne)}}var le=ax(l,0,!1,null,null,!1,!1,"",AS);return l._reactRootContainer=le,l[Ci]=le.current,eu(l.nodeType===8?l.parentNode:l),yo(function(){Gd(u,le,p,w)}),le}function Jd(l,u,p,w,_){var A=p._reactRootContainer;if(A){var I=A;if(typeof _=="function"){var re=_;_=function(){var le=Xd(I);re.call(le)}}Gd(u,I,l,_)}else I=ZF(p,u,l,_,w);return Xd(I)}cb=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var p=Bc(u.pendingLanes);p!==0&&(Pm(u,p|1),Hn(u,Ie()),(vt&6)===0&&(Ml=Ie()+500,ws()))}break;case 13:yo(function(){var w=Oi(l,1);if(w!==null){var _=Tn();Xa(w,l,1,_)}}),ix(l,1)}},Om=function(l){if(l.tag===13){var u=Oi(l,134217728);if(u!==null){var p=Tn();Xa(u,l,134217728,p)}ix(l,134217728)}},ub=function(l){if(l.tag===13){var u=ks(l),p=Oi(l,u);if(p!==null){var w=Tn();Xa(p,l,u,w)}ix(l,u)}},fb=function(){return At},db=function(l,u){var p=At;try{return At=l,u()}finally{At=p}},tn=function(l,u,p){switch(u){case"input":if(Pe(l,p),u=p.name,p.type==="radio"&&u!=null){for(p=l;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<p.length;u++){var w=p[u];if(w!==l&&w.form===l.form){var _=md(w);if(!_)throw Error(r(90));F(w),Pe(w,_)}}}break;case"textarea":Br(l,p);break;case"select":u=p.value,u!=null&&jt(l,!!p.multiple,u,!1)}},ki=Qp,Xf=yo;var e5={usingClientEntryPoint:!1,Events:[nu,Nl,md,so,Ic,Qp]},gu={findFiberByHostInstance:uo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},t5={bundleType:gu.bundleType,version:gu.version,rendererPackageName:gu.rendererPackageName,rendererConfig:gu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=we(l),l===null?null:l.stateNode},findFiberByHostInstance:gu.findFiberByHostInstance||QF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qd.isDisabled&&Qd.supportsFiber)try{ii=Qd.inject(t5),Ur=Qd}catch{}}return Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e5,Vn.createPortal=function(l,u){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ox(u))throw Error(r(200));return JF(l,u,null,p)},Vn.createRoot=function(l,u){if(!ox(l))throw Error(r(299));var p=!1,w="",_=CS;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(_=u.onRecoverableError)),u=ax(l,1,!1,null,null,p,!1,w,_),l[Ci]=u.current,eu(l.nodeType===8?l.parentNode:l),new sx(u)},Vn.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(r(188)):(l=Object.keys(l).join(","),Error(r(268,l)));return l=we(u),l=l===null?null:l.stateNode,l},Vn.flushSync=function(l){return yo(l)},Vn.hydrate=function(l,u,p){if(!Yd(u))throw Error(r(200));return Jd(null,l,u,!0,p)},Vn.hydrateRoot=function(l,u,p){if(!ox(l))throw Error(r(405));var w=p!=null&&p.hydratedSources||null,_=!1,A="",I=CS;if(p!=null&&(p.unstable_strictMode===!0&&(_=!0),p.identifierPrefix!==void 0&&(A=p.identifierPrefix),p.onRecoverableError!==void 0&&(I=p.onRecoverableError)),u=kS(u,null,l,1,p??null,_,!1,A,I),l[Ci]=u.current,eu(l),w)for(l=0;l<w.length;l++)p=w[l],_=p._getVersion,_=_(p._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[p,_]:u.mutableSourceEagerHydrationData.push(p,_);return new qd(u)},Vn.render=function(l,u,p){if(!Yd(u))throw Error(r(200));return Jd(null,l,u,!1,p)},Vn.unmountComponentAtNode=function(l){if(!Yd(l))throw Error(r(40));return l._reactRootContainer?(yo(function(){Jd(null,null,l,!1,function(){l._reactRootContainer=null,l[Ci]=null})}),!0):!1},Vn.unstable_batchedUpdates=Qp,Vn.unstable_renderSubtreeIntoContainer=function(l,u,p,w){if(!Yd(p))throw Error(r(200));if(l==null||l._reactInternals===void 0)throw Error(r(38));return Jd(l,u,p,!1,w)},Vn.version="18.3.1-next-f1338f8080-20240426",Vn}var RS;function i4(){if(RS)return ux.exports;RS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),ux.exports=c5(),ux.exports}var LS;function u5(){if(LS)return Zd;LS=1;var e=i4();return Zd.createRoot=e.createRoot,Zd.hydrateRoot=e.hydrateRoot,Zd}var p1=u5();const f5=Ni(p1),hx=a4({__proto__:null,default:f5},[p1]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ct=(e,t)=>{const r=j.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:c="",children:f,...d},h)=>j.createElement("svg",{ref:h,...d5,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:["lucide",`lucide-${h5(e)}`,c].join(" "),...d},[...t.map(([m,x])=>j.createElement(m,x)),...Array.isArray(f)?f:[f]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lv=ct("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=ct("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=ct("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m5=ct("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=ct("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=ct("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=ct("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ih=ct("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=ct("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=ct("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x5=ct("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=ct("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=ct("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g5=ct("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=ct("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=ct("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=ct("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cv=ct("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x1=ct("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y5=ct("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=ct("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=ct("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=ct("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b5=ct("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S5=ct("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N5=ct("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uv=ct("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=ct("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=ct("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g1=ct("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=ct("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E5=ct("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v1=ct("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=ct("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=ct("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wc=ct("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F0=ct("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=ct("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k5=ct("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=ct("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=ct("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j5=ct("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=ct("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=ct("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=ct("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C5=ct("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y1=ct("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=ct("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),p4="entetesConfig",A5={eleves:{header:"Liste des lves",footer:"Signature du Directeur",logo:"",logoMinistere:"",pays:"Rpublique de Cte d'Ivoire",ministere:"Ministre de l'ducation Nationale et de l'Alphabtisation",etablissement:"Nom de l'tablissement",columns:["Matricule","Nom & Prnom","Date de naissance"],mention:!1},recu:{header:"Reu de paiement",footer:"Aucun remboursement n'est possible aprs encaissement.",logo:"",columns:["Nom","Montant","Date","Classe"]},transport:{header:"Fiche de renseignement transport",footer:"",logo:"",columns:["Nom","Classe","Montant","Versement"]}};function Ws(){try{const e=localStorage.getItem(p4);if(e)return JSON.parse(e)}catch{}return A5}function x4(e){return Ws()[e]}function Gu(e){localStorage.setItem(p4,JSON.stringify(e))}class Kl{static instance;constructor(){this.initializeDefaultData()}addHistorique(t){const r=this.getAll("historiques"),n=new Date().toISOString(),a=Object.assign({},t,{id:Date.now().toString()+Math.random().toString(36).substr(2,6),date:n,createdAt:n,updatedAt:n});return r.push(a),localStorage.setItem("historiques",JSON.stringify(r)),a}static getInstance(){return Kl.instance||(Kl.instance=new Kl),Kl.instance}initializeDefaultData(){if(["ecole","matieres","classes","enseignants","fraisScolaires","eleves","paiements","notes","moyennesGenerales","utilisateurs","compositions","historiques","compta"].forEach(r=>{localStorage.getItem(r)||localStorage.setItem(r,JSON.stringify([]))}),!localStorage.getItem("utilisateurs")){const r={id:"1",nom:"ADMIN",prenoms:"Systme",nomUtilisateur:"admin",role:"Admin",actif:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};localStorage.setItem("utilisateurs",JSON.stringify([r]))}if(!localStorage.getItem("ecole")||JSON.parse(localStorage.getItem("ecole")||"[]").length===0){const r=new Date().toISOString(),n={nom:"cole Primaire Excellence",codeEtablissement:"EPE2025",adresse:"Abidjan, Cte d'Ivoire",telephone:"+225 XX XX XX XX XX",email:"contact@ecole.ci",logo:"",devise:"FCFA",anneeScolaireActive:new Date().getFullYear()+"-"+(new Date().getFullYear()+1),compositions:[],createdAt:r,updatedAt:r};this.create("ecole",n)}try{const r=Ws(),n=this.getAll("ecole")?.[0];if(n){const a=r.eleves&&typeof r.eleves.etablissement=="string"?r.eleves.etablissement:"",i=r.recu&&typeof r.recu.etablissement=="string"?r.recu.etablissement:"",s=f=>!f||f.toLowerCase().includes("nom de")||f.toLowerCase().includes("tablissement");let c=!1;s(a)&&(r.eleves.etablissement=n.nom||r.eleves.etablissement,r.eleves.logo=n.logo||r.eleves.logo,c=!0),s(i)&&(r.recu.etablissement=n.nom||r.recu.etablissement||"",r.recu.logo=n.logo||r.recu.logo||"",c=!0),c&&Gu(r)}}catch{}}getAll(t){try{const r=localStorage.getItem(t);return r?JSON.parse(r):[]}catch(r){return console.error(`Erreur lors du chargement de ${t}:`,r),[]}}getById(t,r){return this.getAll(t).find(a=>a.id===r)||null}create(t,r){const n=this.getAll(t),a=new Date().toISOString(),i=Object.assign({},r,{id:this.generateId(),createdAt:a,updatedAt:a});n.push(i),localStorage.setItem(t,JSON.stringify(n));try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return i}update(t,r,n){const a=this.getAll(t),i=a.findIndex(s=>s.id===r);if(i!==-1){a[i]={...a[i],...n,updatedAt:new Date().toISOString()},localStorage.setItem(t,JSON.stringify(a));try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return a[i]}return null}delete(t,r){const n=this.getAll(t),a=n.filter(i=>i.id!==r);if(a.length!==n.length){localStorage.setItem(t,JSON.stringify(a));try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return!0}return!1}generateId(){return Date.now().toString()+Math.random().toString(36).substr(2,9)}generateMatricule(){const t=this.getAll("eleves"),r=new Date().getFullYear().toString().substr(2,2),n=(t.length+1).toString().padStart(4,"0");return`${r}${n}`}search(t,r,n){const a=this.getAll(t);if(!r)return a;const i=r.toLowerCase();return a.filter(s=>n.some(c=>{const f=s[c];return f&&f.toString().toLowerCase().includes(i)}))}exportData(){const t=["ecole","matieres","classes","enseignants","eleves","fraisScolaires","paiements","notes","moyennesGenerales","utilisateurs","compositions","historiques","compta"],r={};return t.forEach(n=>{r[n]=this.getAll(n)}),JSON.stringify(r,null,2)}importData(t){try{const r=JSON.parse(t);Object.entries(r).forEach(([n,a])=>{localStorage.setItem(n,JSON.stringify(a))});try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return!0}catch(r){return console.error("Erreur lors de l'importation des donnes:",r),!1}}resetData(){localStorage.clear(),this.initializeDefaultData();try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}}}const fe=Kl.getInstance(),T5=Object.freeze(Object.defineProperty({__proto__:null,db:fe},Symbol.toStringTag,{value:"Module"})),Ll="klasnet_licence",BS="klasnet_last_check",mx="klasnet_time_check",$S=`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoI1o4BX9ixXBWDH+KRGv
L8YdNrzhmTUiy1fJKAqyiA+JT9NCh0fL1xhnLundf0sGbTN6Cd91OkKbxbzpa99S
uWNzd9ISVYZXFFgVfQfBAyUDcjCQxPiypQT9K4aLTJQqf0H4gh985VzvwiwCM0C9
b2NwlCN304JU949CLJhIaExhIuuP0uvYC0heNwp6HjHYClppEmLoEgM3xE6hj/jW
nTraasw8aUSuDqn0dnrxnhRT1pD0ADDVHxfzaUKA0jKmuv2uvBhNvUrWCl9FoyDd
A7nMXmDJG5pnTkKmnNA3eU4ArY1uZsRVYss7iOR6gUa4f/XV8FUhtz00irZC54fW
PwIDAQAB
-----END PUBLIC KEY-----`;class Gl{static instance;publicKeyPem;static getInstance(){return Gl.instance||(Gl.instance=new Gl($S)),Gl.instance}constructor(t){this.publicKeyPem=t||$S}async verifyJwtAndGetPayload(t){const[r,n,a]=t.split(".");if(!r||!n||!a)throw new Error("Invalid JWT format");const s=new TextEncoder().encode(`${r}.${n}`),c=this.base64UrlToUint8Array(a),f=await this.importPublicKey(this.publicKeyPem);if(!await crypto.subtle.verify("RSASSA-PKCS1-v1_5",f,c,s))throw new Error("Invalid signature");const h=atob(n.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(h)}checkTimeManipulation(){try{const t=localStorage.getItem(mx),r=Date.now();if(t){const n=parseInt(t);if(r<n-3600*1e3)return console.warn("Manipulation de date dtecte"),!1}return localStorage.setItem(mx,r.toString()),!0}catch(t){return console.error("Erreur vrification anti-triche:",t),!1}}async checkLicenceStatus(){if(!this.checkTimeManipulation())return{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()};try{const t=localStorage.getItem(Ll);if(!t)return this.createTrialLicence();if((t.match(/\./g)||[]).length===2)try{const r=await this.verifyJwtAndGetPayload(t),n=r.exp&&Number(r.exp)?new Date(Number(r.exp)*1e3):null,a=new Date,i=n?Math.ceil((n.getTime()-a.getTime())/(1e3*60*60*24)):0,s=this.getCurrentEcoleId(),c=r.sub||"";if(c&&!this.isEcoleMatch(c,s))return console.warn(`Licence sub mismatch: token for ${c} but this installation is ${s}`),{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()};const f={isValid:!!n&&i>0,isExpired:!n||i<=0,daysRemaining:Math.max(0,i),type:r.type||"inconnue",dateExpiration:n?n.toISOString():"",lastCheck:new Date().toISOString()};return localStorage.setItem(BS,f.lastCheck),f}catch(r){return console.warn("Licence JWT invalide ou signature incorrecte",r),{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()}}else try{const r=JSON.parse(atob(t));let n=null;r.exp&&(typeof r.exp=="number"?n=new Date(r.exp>1e12?r.exp:r.exp*1e3):n=new Date(r.exp));const a=new Date,i=n?Math.ceil((n.getTime()-a.getTime())/(1e3*60*60*24)):0;return{isValid:!!n&&i>0,isExpired:!n||i<=0,daysRemaining:Math.max(0,i),type:r.type||"essai",dateExpiration:n?n.toISOString():"",lastCheck:new Date().toISOString()}}catch{return{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()}}}catch(t){return console.error("Erreur vrification licence:",t),{isValid:!1,isExpired:!0,daysRemaining:0,type:"erreur",dateExpiration:"",lastCheck:new Date().toISOString()}}}createTrialLicence(){const t=new Date,r=new Date(t.getTime()+10080*60*1e3),a={sub:"ECOLE_ESSAI_"+Date.now(),type:"essai",iat:Math.floor(t.getTime()/1e3),exp:r.toISOString()},i=btoa(JSON.stringify(a));return localStorage.setItem(Ll,i),{isValid:!0,isExpired:!1,daysRemaining:7,type:"essai",dateExpiration:r.toISOString(),lastCheck:new Date().toISOString()}}activateLicence(t){return localStorage.setItem(Ll,t),{success:!0,message:"Licence enregistre. Actualisez le statut pour vrifier la validit."}}async updateLicenceFromServer(){try{const t=await fetch("/api/licence/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentKey:localStorage.getItem(Ll),ecoleId:this.getCurrentEcoleId()})});if(t.ok){const r=await t.json();if(r.newKey)return localStorage.setItem(Ll,r.newKey),!0}}catch{console.log("Mise  jour licence impossible (hors ligne)")}return!1}getCurrentEcoleId(){return fe.getAll("ecole")[0]?.codeEtablissement||"ECOLE_DEFAULT"}normalizeId(t){return t?t.toString().toUpperCase().replace(/[^A-Z0-9]/g,""):""}hasCommonNumericSeq(t,r,n=4){const a=t.match(/\d+/g)||[],i=r.match(/\d+/g)||[];for(const s of a)for(const c of i){if(s===c&&s.length>=n)return!0;if(s.length>=n&&c.length>=n){const f=s.slice(-n),d=c.slice(-n);if(f===d)return!0}}return!1}isEcoleMatch(t,r){const n=this.normalizeId(t),a=this.normalizeId(r);if(!n||!a)return!1;if(n===a||n.includes(a)||a.includes(n)||this.hasCommonNumericSeq(n,a,4))return!0;const i=n.slice(-6),s=a.slice(-6);return!!(i&&s&&i===s)}resetLicence(){localStorage.removeItem(Ll),localStorage.removeItem(BS),localStorage.removeItem(mx)}async importPublicKey(t){const r=t.replace(/-----BEGIN PUBLIC KEY-----|-----END PUBLIC KEY-----|\n/g,""),n=Uint8Array.from(atob(r),a=>a.charCodeAt(0));return await crypto.subtle.importKey("spki",n.buffer,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!1,["verify"])}base64UrlToUint8Array(t){let r=t.replace(/-/g,"+").replace(/_/g,"/");const n=r.length%4;n&&(r+="=".repeat(4-n));const a=atob(r),i=new Uint8Array(a.length);for(let s=0;s<a.length;++s)i[s]=a.charCodeAt(s);return i}}const Bi=Gl.getInstance(),g4=j.createContext({showToast:()=>{}});function Jr(){return j.useContext(g4)}function P5({children:e}){const[t,r]=j.useState([]),n=(c,f="info")=>{const d=Date.now();r(h=>[...h,{id:d,type:f,message:c}]),setTimeout(()=>{r(h=>h.filter(m=>m.id!==d))},4e3)},a=c=>{r(f=>f.filter(d=>d.id!==c))},i=c=>{switch(c){case"success":return o.jsx(ua,{className:"h-5 w-5 text-green-600"});case"error":return o.jsx(wi,{className:"h-5 w-5 text-red-600"});default:return o.jsx(d4,{className:"h-5 w-5 text-blue-600"})}},s=c=>{switch(c){case"success":return"bg-white border-green-200 text-green-800";case"error":return"bg-white border-red-200 text-red-800";default:return"bg-white border-blue-200 text-blue-800"}};return o.jsxs(g4.Provider,{value:{showToast:n},children:[e,o.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(c=>o.jsxs("div",{className:`flex items-center space-x-3 px-4 py-3 rounded-lg border shadow-lg max-w-sm ${s(c.type)}`,children:[i(c.type),o.jsx("span",{className:"flex-1 text-sm font-medium",children:c.message}),o.jsx("button",{onClick:()=>a(c.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Qs,{className:"h-4 w-4"})})]},c.id))})]})}function v4(){const{showToast:e}=Jr(),[t,r]=j.useState(null),[n,a]=j.useState({nom:"",codeEtablissement:"",adresse:"",telephone:"",email:"",logo:"",devise:"FCFA",anneeScolaireActive:new Date().getFullYear()+"-"+(new Date().getFullYear()+1)}),[i,s]=j.useState(!1),[c,f]=j.useState(()=>({}));j.useEffect(()=>{const m=fe.getAll("ecole")[0];m&&(r(m),a({nom:m.nom||"",codeEtablissement:m.codeEtablissement||"",adresse:m.adresse||"",telephone:m.telephone||"",email:m.email||"",logo:m.logo||"",devise:m.devise||"FCFA",anneeScolaireActive:m.anneeScolaireActive||new Date().getFullYear()+"-"+(new Date().getFullYear()+1)}))},[]);const d=m=>{const x=m.target.files?.[0];if(x){const g=new FileReader;g.onload=y=>{a(v=>({...v,logo:y.target?.result}))},g.readAsDataURL(x)}},h=async()=>{const m={};if((!n.nom||n.nom.trim().length<3)&&(m.nom="Entrez le nom complet de l'tablissement (min. 3 caractres)."),(!n.codeEtablissement||n.codeEtablissement.trim().length<2)&&(m.codeEtablissement="Entrez un code tablissement valide."),f(m),Object.keys(m).length>0){try{e("Veuillez corriger les erreurs du formulaire","error")}catch{}return}s(!0);try{if(t){const x=fe.update("ecole",t.id,n);if(x){r(x),e("Configuration de l'cole mise  jour","success");try{const g=Ws();g.eleves&&(g.eleves.etablissement=n.nom||g.eleves.etablissement,g.eleves.logo=n.logo||g.eleves.logo),g.recu&&(g.recu.etablissement=n.nom||g.recu.etablissement||"",g.recu.logo=n.logo||g.recu.logo),Gu(g)}catch{}}}else{const x=fe.create("ecole",n);r(x),e("Configuration de l'cole cre","success");try{window.dispatchEvent(new CustomEvent("ecole:created",{detail:{ecole:x}}))}catch{}try{Bi.createTrialLicence&&Bi.createTrialLicence()}catch{}try{const g=Ws();g.eleves&&(g.eleves.etablissement=n.nom||g.eleves.etablissement,g.eleves.logo=n.logo||g.eleves.logo),g.recu&&(g.recu.etablissement=n.nom||g.recu.etablissement||"",g.recu.logo=n.logo||g.recu.logo),Gu(g)}catch{}}}catch{e("Erreur lors de la sauvegarde","error")}finally{s(!1)}};return o.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(o4,{className:"h-6 w-6 text-gray-600"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Configuration de l'cole"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Paramtres gnraux et informations de l'tablissement"})]})]})}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Informations de l'tablissement"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Ces informations apparatront sur tous les documents imprims"})]}),o.jsxs("div",{className:"p-6 space-y-8",children:[o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"lg:col-span-1",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Logo de l'cole"}),o.jsx("div",{className:"relative",children:o.jsxs("div",{className:"w-full h-48 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center relative overflow-hidden group hover:border-gray-400 transition-colors",children:[n.logo?o.jsxs(o.Fragment,{children:[o.jsx("img",{src:n.logo,alt:"Logo cole",className:"w-full h-full object-contain"}),o.jsx("button",{onClick:()=>a(m=>({...m,logo:""})),className:"absolute top-2 right-2 p-1 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors",children:o.jsx(Qs,{className:"h-4 w-4 text-gray-600"})})]}):o.jsxs("div",{className:"text-center",children:[o.jsx(Us,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-gray-500 text-sm",children:"Cliquez pour ajouter un logo"}),o.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"PNG, JPG jusqu' 5MB"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:d,className:"absolute inset-0 opacity-0 cursor-pointer"})]})})]}),o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom complet de l'tablissement ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.nom,onChange:m=>a(x=>({...x,nom:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"Ex: cole Primaire Excellence"}),c.nom&&o.jsx("div",{className:"text-sm text-red-600 mt-1",children:c.nom})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Code tablissement ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.codeEtablissement,onChange:m=>a(x=>({...x,codeEtablissement:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"Ex: ECOLE001, EPE2025..."}),c.codeEtablissement&&o.jsx("div",{className:"text-sm text-red-600 mt-1",children:c.codeEtablissement}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Code unique d'identification de votre tablissement"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Devise"}),o.jsxs("select",{value:n.devise,onChange:m=>a(x=>({...x,devise:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",children:[o.jsx("option",{value:"FCFA",children:"FCFA"}),o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"USD",children:"USD"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anne scolaire active"}),o.jsx("input",{type:"text",value:n.anneeScolaireActive,onChange:m=>a(x=>({...x,anneeScolaireActive:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"2025-2026"})]})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Coordonnes de contact"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tlphone"}),o.jsx("input",{type:"tel",value:n.telephone,onChange:m=>a(x=>({...x,telephone:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"+225 XX XX XX XX XX"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email (optionnel)"}),o.jsx("input",{type:"email",value:n.email,onChange:m=>a(x=>({...x,email:m.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"contact@ecole.ci"})]})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse complte"}),o.jsx("textarea",{value:n.adresse,onChange:m=>a(x=>({...x,adresse:m.target.value})),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors resize-none",placeholder:"Adresse complte de l'tablissement"})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Aperu sur les documents"}),o.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[n.logo&&o.jsx("img",{src:n.logo,alt:"Logo",className:"h-16 mx-auto mb-4"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("h4",{className:"text-xl font-bold text-gray-900",children:n.nom||"Nom de l'cole"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Code: ",n.codeEtablissement||"CODE_ECOLE"]}),o.jsx("p",{className:"text-gray-600",children:n.adresse||"Adresse de l'cole"}),o.jsxs("p",{className:"text-gray-600",children:[n.telephone||"Tlphone",n.email&&`  ${n.email}`]})]})]})})]}),o.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:o.jsxs("button",{onClick:h,disabled:i||Object.keys(c).length>0,className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 focus:ring-2 focus:ring-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[i?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Js,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:i?"Sauvegarde...":"Enregistrer la configuration"})]})})]})]})]})}function O5({children:e}){const[t,r]=j.useState(null),[n,a]=j.useState(!1),[i,s]=j.useState(""),[c,f]=j.useState(!1),[d,h]=j.useState(""),[m,x]=j.useState(!1);j.useEffect(()=>{g();const v=setInterval(g,3600*1e3),b=()=>{x(!1),g()};return window.addEventListener("ecole:created",b),()=>{clearInterval(v),window.removeEventListener("ecole:created",b)}},[]);const g=async()=>{await Bi.updateLicenceFromServer();const v=await Bi.checkLicenceStatus();r(v)},y=()=>{if(!i.trim()){h("Veuillez entrer une cl de licence");return}f(!0);try{const v=Bi.activateLicence(i.trim());v.success?(h(v.message),s(""),setTimeout(()=>{a(!1),g()},2e3)):h(v.message)}catch{h("Erreur lors de l'activation de la licence")}finally{f(!1)}};return t?t.isValid&&!t.isExpired?o.jsxs(o.Fragment,{children:[e,t.daysRemaining<=7&&o.jsx("div",{className:"fixed bottom-4 right-4 bg-white border border-gray-200 rounded-lg shadow-lg p-4 max-w-sm",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(l4,{className:"h-5 w-5 text-amber-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold text-gray-900",children:"Licence expire bientt"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Plus que ",t.daysRemaining," jour(s)"]})]})]})})]}):m?o.jsx(v4,{}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 max-w-lg w-full",children:[o.jsxs("div",{className:"p-8 text-center border-b border-gray-200",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:o.jsx(m4,{className:"h-8 w-8 text-gray-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Licence Expire"}),o.jsx("p",{className:"text-gray-600",children:"Votre licence KlasNet a expir"})]}),o.jsxs("div",{className:"p-8 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[o.jsx(wi,{className:"h-5 w-5 text-red-600"}),o.jsx("h3",{className:"font-semibold text-gray-900",children:"Statut de la licence"})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Type:"}),o.jsx("span",{className:"font-medium text-gray-900 capitalize",children:t.type})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Expiration:"}),o.jsx("span",{className:"font-medium text-gray-900",children:t.dateExpiration?new Date(t.dateExpiration).toLocaleDateString("fr-FR"):"Non dfinie"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Jours restants:"}),o.jsx("span",{className:"font-bold text-red-600",children:t.daysRemaining})]})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:()=>x(!0),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[o.jsx(F0,{className:"h-5 w-5"}),o.jsx("span",{children:"Configurer l'application"})]}),o.jsxs("button",{onClick:()=>a(!n),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:[o.jsx(O0,{className:"h-5 w-5"}),o.jsx("span",{children:"Activer une nouvelle licence"})]})]}),n&&o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Activation manuelle"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cl de licence"}),o.jsx("textarea",{value:i,onChange:v=>s(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors resize-none font-mono text-sm",rows:4,placeholder:"Collez votre cl de licence ici..."})]}),d&&o.jsx("div",{className:`p-4 rounded-lg ${d.includes("succs")?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:o.jsxs("div",{className:"flex items-center space-x-2",children:[d.includes("succs")?o.jsx(ua,{className:"h-5 w-5"}):o.jsx(wi,{className:"h-5 w-5"}),o.jsx("span",{className:"text-sm",children:d})]})}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:()=>{a(!1),s(""),h("")},className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:y,disabled:c||!i.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:[c?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(O0,{className:"h-4 w-4"}),o.jsx("span",{children:c?"Activation...":"Activer"})]})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Besoin d'une licence ?"}),o.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Tlphone:"})," +2250555863953"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Email:"})," Non disponible"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Site web:"})," Non disponible"]})]})]})]}),o.jsx("div",{className:"bg-gray-50 px-8 py-4 text-center border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-gray-500",children:" 2025 KlasNet - Logiciel de Gestion Scolaire"})})]})}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 max-w-md w-full mx-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Vrification de la licence"}),o.jsx("p",{className:"text-gray-600",children:"Veuillez patienter..."})]})})})}const w1="current_user_id";function Mh(){const e=fe.getAll("utilisateurs"),t={"poupouya@ecole.local":"eyemon2024",directeur:"director2024",enseignant:"teacher2024",poupouya:"eyemon2024"};try{window.localStorage.setItem("__pw_map__",JSON.stringify(t)),console.log("Mots de passe forcs:",t)}catch(c){console.error("Erreur stockage mots de passe:",c)}const r=["poupouya@ecole.local","directeur","enseignant","poupouya"],n=e.map(c=>c.nomUtilisateur),a=r.filter(c=>!n.includes(c)),i=new Date().toISOString();[{nom:"POUPOUYA",prenoms:"Mme",nomUtilisateur:"poupouya@ecole.local",role:"Secrtaire",actif:!0},{nom:"POUPOUYA",prenoms:"Mme",nomUtilisateur:"poupouya",role:"Secrtaire",actif:!0},{nom:"DIRECTEUR",prenoms:"M.",nomUtilisateur:"directeur",role:"Admin",actif:!0},{nom:"ENSEIGNANT",prenoms:"M.",nomUtilisateur:"enseignant",role:"Enseignant",actif:!0},{nom:"TEACHER",prenoms:"Prof",nomUtilisateur:"teacher",role:"Enseignant",actif:!0}].forEach(c=>{a.includes(c.nomUtilisateur)&&(console.log("Cration utilisateur:",c.nomUtilisateur),fe.create("utilisateurs",{...c,createdAt:i}))})}function y4(e,t){Mh();const r={"poupouya@ecole.local":"eyemon2024",directeur:"director2024",enseignant:"teacher2024",poupouya:"eyemon2024"};try{window.localStorage.setItem("__pw_map__",JSON.stringify(r))}catch(s){console.error("Erreur stockage mots de passe:",s)}const n=r;if(console.log("Tentative de connexion:",e),console.log("Mots de passe disponibles:",Object.keys(n)),console.log("Mot de passe fourni:",t),console.log("Mot de passe attendu:",n[e]),n[e]!==t)return null;const i=fe.getAll("utilisateurs").find(s=>s.nomUtilisateur===e&&s.actif)||null;if(console.log("Utilisateur trouv:",i),i){try{window.localStorage.setItem(w1,i.id)}catch{}return i}return null}function b1(){try{window.localStorage.removeItem(w1)}catch{}}function Ya(){Mh();try{const e=window.localStorage.getItem(w1);return e?fe.getById("utilisateurs",e):null}catch{return null}}function w4(e,t,r){try{const n=JSON.parse(String(window.localStorage.getItem("__pw_map__")||"{}"));return typeof r<"u"&&n[e]!==r?!1:(n[e]=t,window.localStorage.setItem("__pw_map__",JSON.stringify(n)),!0)}catch{return!1}}function b4(e,t,r){try{const n=JSON.parse(String(window.localStorage.getItem("__pw_map__")||"{}"));if(n[t]||typeof r<"u"&&n[e]!==r)return!1;const i=fe.getAll("utilisateurs").find(s=>s.nomUtilisateur===e);return i?(fe.update("utilisateurs",i.id,{nomUtilisateur:t}),n[e]&&(n[t]=n[e],delete n[e],window.localStorage.setItem("__pw_map__",JSON.stringify(n))),!0):!1}catch{return!1}}const Is={seedUsers:Mh,login:y4,logout:b1,getCurrentUser:Ya,changePassword:w4,changeUsername:b4},US=Object.freeze(Object.defineProperty({__proto__:null,changePassword:w4,changeUsername:b4,default:Is,getCurrentUser:Ya,login:y4,logout:b1,seedUsers:Mh},Symbol.toStringTag,{value:"Module"}));function Bt(e){if(!e)return"";const t=(e.nom||"").toString().trim(),r=(e.prenoms||"").toString().trim();return!t&&!r?"":t?r?`${t} ${r}`:t:r}function j0(e){if(!e)return"";const t=(e.nom||"").toString().trim(),r=(e.prenoms||"").toString().trim();return!t&&!r?"":r?`${r} ${t}`:t}function F5({onLogin:e}){const[t,r]=j.useState(""),[n,a]=j.useState(""),[i,s]=j.useState(!1),[c,f]=j.useState(!1),{showToast:d}=Jr(),h=async m=>{if(m.preventDefault(),!t||!n){d("Veuillez remplir tous les champs","error");return}f(!0);try{const x=Is.login(t,n);x?(d(`Bienvenue ${Bt(x)}`,"success"),e(x)):d("Nom d'utilisateur ou mot de passe incorrect","error")}catch{d("Erreur de connexion","error")}finally{f(!1)}};return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 w-full max-w-md",children:[o.jsxs("div",{className:"p-8 text-center border-b border-gray-200",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-900 rounded-lg flex items-center justify-center mx-auto mb-4",children:o.jsx(h4,{className:"h-8 w-8 text-white"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"KlasNet"}),o.jsx("p",{className:"text-gray-600",children:"Gestion Scolaire"})]}),o.jsx("div",{className:"p-8",children:o.jsxs("form",{onSubmit:h,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom d'utilisateur"}),o.jsxs("div",{className:"relative",children:[o.jsx(Ho,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:t,onChange:m=>r(m.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"votre_nom_utilisateur",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(S5,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:i?"text":"password",value:n,onChange:m=>a(m.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"",required:!0}),o.jsx("button",{type:"button",onClick:()=>s(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?o.jsx(g5,{className:"h-5 w-5"}):o.jsx(u4,{className:"h-5 w-5"})})]})]}),o.jsx("button",{type:"submit",disabled:c,className:"w-full bg-gray-900 text-white py-3 px-4 rounded-lg font-medium hover:bg-gray-800 focus:ring-2 focus:ring-gray-900 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Connexion..."]}):"Se connecter"})]})}),o.jsx("div",{className:"bg-gray-50 px-8 py-4 text-center border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-gray-500",children:" 2025 KlasNet - Gestion Scolaire Cte d'Ivoire"})})]})})}function D5({currentUser:e,onLogout:t,onNavigate:r,currentPage:n,onShowGuide:a}){const[i,s]=j.useState(new Date),[c,f]=j.useState(!1),[d,h]=j.useState(!1),m=j.useRef(null),x=v=>v?v.charAt(0).toUpperCase()+v.slice(1).toLowerCase():"";j.useEffect(()=>{const v=setInterval(()=>s(new Date),1e3);return()=>clearInterval(v)},[]),j.useEffect(()=>{const v=N=>{const E=N.target;m.current&&!m.current.contains(E)&&f(!1)},b=N=>{N.key==="Escape"&&f(!1)};return document.addEventListener("mousedown",v),document.addEventListener("keydown",b),()=>{document.removeEventListener("mousedown",v),document.removeEventListener("keydown",b)}},[]);const g=[{id:"dashboard",label:"Tableau de bord"},{id:"eleves",label:"lves"},{id:"enseignants",label:"Enseignants"},{id:"classes",label:"Classes"},{id:"matieres",label:"Matires"},{id:"finances",label:"Finances"},{id:"notes",label:"Notes"},{id:"config",label:"Configuration"},{id:"comptabilite",label:"Comptabilit"}],y=()=>f(v=>!v);return o.jsxs("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:[o.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-900 rounded-lg flex items-center justify-center",children:o.jsx(h4,{className:"h-5 w-5 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"KlasNet"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Gestion Scolaire"})]})]}),o.jsx("div",{className:"hidden lg:block bg-gray-50 px-3 py-1 rounded-md border border-gray-200",children:o.jsx("div",{className:"text-xs text-gray-500",children:i.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})})]}),o.jsx("nav",{className:"hidden md:flex space-x-1",children:g.map(v=>o.jsx("button",{onClick:()=>{try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:v.id}}))}catch{r(v.id)}},className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${n===v.id?"bg-gray-900 text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:v.label},v.id))}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{className:"hidden md:block px-3 py-1 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",onClick:()=>a&&a(),children:"Guide"}),o.jsxs("div",{className:"relative",ref:m,children:[o.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 px-3 py-2 rounded-md transition-colors",onClick:y,children:[e&&e.avatar?o.jsx("img",{src:e.avatar,alt:"avatar",className:"h-8 w-8 rounded-full object-cover border border-gray-200"}):o.jsx("div",{className:"h-8 w-8 bg-gray-100 rounded-full flex items-center justify-center border border-gray-200",children:o.jsx(Ho,{className:"h-4 w-4 text-gray-500"})}),o.jsxs("div",{className:"hidden sm:block text-sm text-gray-700",children:[o.jsx("div",{className:"font-medium",children:Bt(e)}),o.jsx("div",{className:"text-xs text-gray-500",children:x(e?.role)})]})]}),c&&o.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-md shadow-lg z-50",children:[o.jsx("button",{onClick:()=>{f(!1);try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"profil"}}))}catch{r("profil")}},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Profil"}),o.jsx("button",{onClick:()=>{f(!1);try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"parametres"}}))}catch{r("parametres")}},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Paramtres"}),o.jsx("div",{className:"border-t border-gray-200"}),o.jsx("button",{onClick:t,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Dconnexion"})]})]}),o.jsx("button",{className:"md:hidden p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors",onClick:()=>h(!d),children:d?o.jsx(Qs,{className:"h-5 w-5"}):o.jsx(_5,{className:"h-5 w-5"})})]})]})}),d&&o.jsx("div",{className:"md:hidden border-t border-gray-200 bg-white",children:o.jsxs("div",{className:"px-4 py-2 space-y-1",children:[g.map(v=>o.jsx("button",{onClick:()=>{try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:v.id}}))}catch{r(v.id)}h(!1)},className:`w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors ${n===v.id?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-50"}`,children:v.label},v.id)),o.jsx("button",{className:"w-full text-left px-3 py-2 text-sm text-gray-600 hover:bg-gray-50 rounded-md transition-colors",onClick:()=>{a&&a(),h(!1)},children:"Guide"})]})})]})}function bf({open:e,title:t="Quitter sans sauvegarder ?",description:r="Vous avez des modifications non sauvegardes. Voulez-vous vraiment quitter et perdre vos changements ?",onConfirm:n,onCancel:a}){return e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),o.jsx("p",{className:"text-sm text-gray-600 mt-2",children:r}),o.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[o.jsx("button",{onClick:a,className:"px-4 py-2 rounded-md bg-gray-100 text-gray-700",children:"Retour"}),o.jsx("button",{onClick:n,className:"px-4 py-2 rounded-md bg-red-600 text-white",children:"Quitter sans sauvegarder"})]})]})}):null}function S4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=S4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function wt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=S4(e))&&(n&&(n+=" "),n+=t);return n}var px={},xx={},zS;function I5(){return zS||(zS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(xx)),xx}var gx={},WS;function N4(){return WS||(WS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(gx)),gx}var vx={},HS;function _4(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(vx)),vx}var yx={},VS;function S1(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],a=r.length;if(a===0)return n;let i=0,s="",c="",f=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const d=r[i];c?d==="\\"&&i+1<a?(i++,s+=r[i]):d===c?c="":s+=d:f?d==='"'||d==="'"?c=d:d==="]"?(f=!1,n.push(s),s=""):s+=d:d==="["?(f=!0,s&&(n.push(s),s="")):d==="."?s&&(n.push(s),s=""):s+=d,i++}return s&&n.push(s),n}e.toPath=t})(yx)),yx}var KS;function N1(){return KS||(KS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=I5(),r=N4(),n=_4(),a=S1();function i(c,f,d){if(c==null)return d;switch(typeof f){case"string":{if(t.isUnsafeProperty(f))return d;const h=c[f];return h===void 0?r.isDeepKey(f)?i(c,a.toPath(f),d):d:h}case"number":case"symbol":{typeof f=="number"&&(f=n.toKey(f));const h=c[f];return h===void 0?d:h}default:{if(Array.isArray(f))return s(c,f,d);if(Object.is(f?.valueOf(),-0)?f="-0":f=String(f),t.isUnsafeProperty(f))return d;const h=c[f];return h===void 0?d:h}}}function s(c,f,d){if(f.length===0)return d;let h=c;for(let m=0;m<f.length;m++){if(h==null||t.isUnsafeProperty(f[m]))return d;h=h[f[m]]}return h===void 0?d:h}e.get=i})(px)),px}var wx,GS;function M5(){return GS||(GS=1,wx=N1().get),wx}var R5=M5();const Vo=Ni(R5);var bx={exports:{}},Mt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XS;function L5(){if(XS)return Mt;XS=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function y(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case r:case a:case n:case f:case d:case x:return v;default:switch(v=v&&v.$$typeof,v){case s:case c:case m:case h:return v;case i:return v;default:return b}}case t:return b}}}return Mt.ContextConsumer=i,Mt.ContextProvider=s,Mt.Element=e,Mt.ForwardRef=c,Mt.Fragment=r,Mt.Lazy=m,Mt.Memo=h,Mt.Portal=t,Mt.Profiler=a,Mt.StrictMode=n,Mt.Suspense=f,Mt.SuspenseList=d,Mt.isContextConsumer=function(v){return y(v)===i},Mt.isContextProvider=function(v){return y(v)===s},Mt.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},Mt.isForwardRef=function(v){return y(v)===c},Mt.isFragment=function(v){return y(v)===r},Mt.isLazy=function(v){return y(v)===m},Mt.isMemo=function(v){return y(v)===h},Mt.isPortal=function(v){return y(v)===t},Mt.isProfiler=function(v){return y(v)===a},Mt.isStrictMode=function(v){return y(v)===n},Mt.isSuspense=function(v){return y(v)===f},Mt.isSuspenseList=function(v){return y(v)===d},Mt.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===r||v===a||v===n||v===f||v===d||typeof v=="object"&&v!==null&&(v.$$typeof===m||v.$$typeof===h||v.$$typeof===s||v.$$typeof===i||v.$$typeof===c||v.$$typeof===g||v.getModuleId!==void 0)},Mt.typeOf=y,Mt}var qS;function B5(){return qS||(qS=1,bx.exports=L5()),bx.exports}var $5=B5(),Xr=e=>e===0?0:e>0?1:-1,da=e=>typeof e=="number"&&e!=+e,Ao=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,et=e=>(typeof e=="number"||e instanceof Number)&&!da(e),bi=e=>et(e)||typeof e=="string",U5=0,Xu=e=>{var t=++U5;return"".concat(e||"").concat(t)},_n=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!et(t)&&typeof t!="string")return n;var i;if(Ao(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return da(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},E4=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function un(e,t,r){return et(e)&&et(t)?e+r*(t-e):t}function z5(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Vo(n,t))===r)}var Yr=e=>e===null||typeof e>"u",Sf=e=>Yr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),W5=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function _1(e){if(typeof e!="string")return!1;var t=W5;return t.includes(e)}var H5=["viewBox","children"],YS=["points","pathLength"],Sx={svg:H5,polygon:YS,polyline:YS},V5=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(j.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{_1(a)&&(n[a]=(i=>r[a](r,i)))}),n},K5=(e,t,r)=>n=>(e(t,r,n),null),Nf=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];_1(a)&&typeof i=="function"&&(n||(n={}),n[a]=K5(i,t,r))}),n},G5=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function k4(e){if(typeof e!="string")return!1;var t=G5;return t.includes(e)}function Zs(e){var t=Object.entries(e).filter(r=>{var[n]=r;return k4(n)});return Object.fromEntries(t)}var JS=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",QS=null,Nx=null,j4=e=>{if(e===QS&&Array.isArray(Nx))return Nx;var t=[];return j.Children.forEach(e,r=>{Yr(r)||($5.isFragment(r)?t=t.concat(j4(r.props.children)):t.push(r))}),Nx=t,QS=e,t};function E1(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>JS(a)):n=[JS(t)],j4(e).forEach(a=>{var i=Vo(a,"type.displayName")||Vo(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var X5=(e,t,r,n)=>{var a;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(a=n&&Sx?.[n])!==null&&a!==void 0?a:[],s=t.startsWith("data-"),c=typeof e!="function"&&(!!n&&i.includes(t)||k4(t)),f=!!r&&_1(t);return s||c||f},Dr=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(j.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var s;X5((s=n)===null||s===void 0?void 0:s[i],i,t,r)&&(a[i]=n[i])}),a},q5=["children","width","height","viewBox","className","style","title","desc"];function fv(){return fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fv.apply(null,arguments)}function Y5(e,t){if(e==null)return{};var r,n,a=J5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function J5(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var k1=j.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:c,title:f,desc:d}=e,h=Y5(e,q5),m=i||{width:n,height:a,x:0,y:0},x=wt("recharts-surface",s);return j.createElement("svg",fv({},Dr(h,!0,"svg"),{className:x,width:n,height:a,style:c,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),j.createElement("title",null,f),j.createElement("desc",null,d),r)}),Q5=["children","className"];function dv(){return dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dv.apply(null,arguments)}function Z5(e,t){if(e==null)return{};var r,n,a=eD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function eD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Yn=j.forwardRef((e,t)=>{var{children:r,className:n}=e,a=Z5(e,Q5),i=wt("recharts-layer",n);return j.createElement("g",dv({className:i},Dr(a,!0),{ref:t}),r)}),C4=i4(),A4=j.createContext(null),tD=()=>j.useContext(A4);function Wt(e){return function(){return e}}const T4=Math.cos,I0=Math.sin,ni=Math.sqrt,M0=Math.PI,Rh=2*M0,hv=Math.PI,mv=2*hv,_o=1e-6,rD=mv-_o;function P4(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function nD(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return P4;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class aD{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?P4:nD(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,c=this._y1,f=n-t,d=a-r,h=s-t,m=c-r,x=h*h+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(x>_o)if(!(Math.abs(m*f-d*h)>_o)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-s,y=a-c,v=f*f+d*d,b=g*g+y*y,N=Math.sqrt(v),E=Math.sqrt(x),S=i*Math.tan((hv-Math.acos((v+x-b)/(2*N*E)))/2),C=S/E,T=S/N;Math.abs(C-1)>_o&&this._append`L${t+C*h},${r+C*m}`,this._append`A${i},${i},0,0,${+(m*g>h*y)},${this._x1=t+T*f},${this._y1=r+T*d}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let c=n*Math.cos(a),f=n*Math.sin(a),d=t+c,h=r+f,m=1^s,x=s?a-i:i-a;this._x1===null?this._append`M${d},${h}`:(Math.abs(this._x1-d)>_o||Math.abs(this._y1-h)>_o)&&this._append`L${d},${h}`,n&&(x<0&&(x=x%mv+mv),x>rD?this._append`A${n},${n},0,1,${m},${t-c},${r-f}A${n},${n},0,1,${m},${this._x1=d},${this._y1=h}`:x>_o&&this._append`A${n},${n},0,${+(x>=hv)},${m},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function j1(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new aD(t)}function C1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function O4(e){this._context=e}O4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Lh(e){return new O4(e)}function F4(e){return e[0]}function D4(e){return e[1]}function I4(e,t){var r=Wt(!0),n=null,a=Lh,i=null,s=j1(c);e=typeof e=="function"?e:e===void 0?F4:Wt(e),t=typeof t=="function"?t:t===void 0?D4:Wt(t);function c(f){var d,h=(f=C1(f)).length,m,x=!1,g;for(n==null&&(i=a(g=s())),d=0;d<=h;++d)!(d<h&&r(m=f[d],d,f))===x&&((x=!x)?i.lineStart():i.lineEnd()),x&&i.point(+e(m,d,f),+t(m,d,f));if(g)return i=null,g+""||null}return c.x=function(f){return arguments.length?(e=typeof f=="function"?f:Wt(+f),c):e},c.y=function(f){return arguments.length?(t=typeof f=="function"?f:Wt(+f),c):t},c.defined=function(f){return arguments.length?(r=typeof f=="function"?f:Wt(!!f),c):r},c.curve=function(f){return arguments.length?(a=f,n!=null&&(i=a(n)),c):a},c.context=function(f){return arguments.length?(f==null?n=i=null:i=a(n=f),c):n},c}function e0(e,t,r){var n=null,a=Wt(!0),i=null,s=Lh,c=null,f=j1(d);e=typeof e=="function"?e:e===void 0?F4:Wt(+e),t=typeof t=="function"?t:Wt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?D4:Wt(+r);function d(m){var x,g,y,v=(m=C1(m)).length,b,N=!1,E,S=new Array(v),C=new Array(v);for(i==null&&(c=s(E=f())),x=0;x<=v;++x){if(!(x<v&&a(b=m[x],x,m))===N)if(N=!N)g=x,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),y=x-1;y>=g;--y)c.point(S[y],C[y]);c.lineEnd(),c.areaEnd()}N&&(S[x]=+e(b,x,m),C[x]=+t(b,x,m),c.point(n?+n(b,x,m):S[x],r?+r(b,x,m):C[x]))}if(E)return c=null,E+""||null}function h(){return I4().defined(a).curve(s).context(i)}return d.x=function(m){return arguments.length?(e=typeof m=="function"?m:Wt(+m),n=null,d):e},d.x0=function(m){return arguments.length?(e=typeof m=="function"?m:Wt(+m),d):e},d.x1=function(m){return arguments.length?(n=m==null?null:typeof m=="function"?m:Wt(+m),d):n},d.y=function(m){return arguments.length?(t=typeof m=="function"?m:Wt(+m),r=null,d):t},d.y0=function(m){return arguments.length?(t=typeof m=="function"?m:Wt(+m),d):t},d.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:Wt(+m),d):r},d.lineX0=d.lineY0=function(){return h().x(e).y(t)},d.lineY1=function(){return h().x(e).y(r)},d.lineX1=function(){return h().x(n).y(t)},d.defined=function(m){return arguments.length?(a=typeof m=="function"?m:Wt(!!m),d):a},d.curve=function(m){return arguments.length?(s=m,i!=null&&(c=s(i)),d):s},d.context=function(m){return arguments.length?(m==null?i=c=null:c=s(i=m),d):i},d}class M4{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function iD(e){return new M4(e,!0)}function sD(e){return new M4(e,!1)}const A1={draw(e,t){const r=ni(t/M0);e.moveTo(r,0),e.arc(0,0,r,0,Rh)}},oD={draw(e,t){const r=ni(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},R4=ni(1/3),lD=R4*2,cD={draw(e,t){const r=ni(t/lD),n=r*R4;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},uD={draw(e,t){const r=ni(t),n=-r/2;e.rect(n,n,r,r)}},fD=.8908130915292852,L4=I0(M0/10)/I0(7*M0/10),dD=I0(Rh/10)*L4,hD=-T4(Rh/10)*L4,mD={draw(e,t){const r=ni(t*fD),n=dD*r,a=hD*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=Rh*i/5,c=T4(s),f=I0(s);e.lineTo(f*r,-c*r),e.lineTo(c*n-f*a,f*n+c*a)}e.closePath()}},_x=ni(3),pD={draw(e,t){const r=-ni(t/(_x*3));e.moveTo(0,r*2),e.lineTo(-_x*r,-r),e.lineTo(_x*r,-r),e.closePath()}},Na=-.5,_a=ni(3)/2,pv=1/ni(12),xD=(pv/2+1)*3,gD={draw(e,t){const r=ni(t/xD),n=r/2,a=r*pv,i=n,s=r*pv+r,c=-i,f=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(c,f),e.lineTo(Na*n-_a*a,_a*n+Na*a),e.lineTo(Na*i-_a*s,_a*i+Na*s),e.lineTo(Na*c-_a*f,_a*c+Na*f),e.lineTo(Na*n+_a*a,Na*a-_a*n),e.lineTo(Na*i+_a*s,Na*s-_a*i),e.lineTo(Na*c+_a*f,Na*f-_a*c),e.closePath()}};function vD(e,t){let r=null,n=j1(a);e=typeof e=="function"?e:Wt(e||A1),t=typeof t=="function"?t:Wt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Wt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Wt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function R0(){}function L0(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function B4(e){this._context=e}B4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:L0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:L0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function yD(e){return new B4(e)}function $4(e){this._context=e}$4.prototype={areaStart:R0,areaEnd:R0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:L0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function wD(e){return new $4(e)}function U4(e){this._context=e}U4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:L0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function bD(e){return new U4(e)}function z4(e){this._context=e}z4.prototype={areaStart:R0,areaEnd:R0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function SD(e){return new z4(e)}function ZS(e){return e<0?-1:1}function eN(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),c=(i*a+s*n)/(n+a);return(ZS(i)+ZS(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(c))||0}function tN(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Ex(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,c=(i-n)/3;e._context.bezierCurveTo(n+c,a+c*t,i-c,s-c*r,i,s)}function B0(e){this._context=e}B0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ex(this,this._t0,tN(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ex(this,tN(this,r=eN(this,e,t)),r);break;default:Ex(this,this._t0,r=eN(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function W4(e){this._context=new H4(e)}(W4.prototype=Object.create(B0.prototype)).point=function(e,t){B0.prototype.point.call(this,t,e)};function H4(e){this._context=e}H4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function ND(e){return new B0(e)}function _D(e){return new W4(e)}function V4(e){this._context=e}V4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=rN(e),a=rN(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function rN(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function ED(e){return new V4(e)}function Bh(e,t){this._context=e,this._t=t}Bh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function kD(e){return new Bh(e,.5)}function jD(e){return new Bh(e,0)}function CD(e){return new Bh(e,1)}function ic(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,c=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<c;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function xv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function AD(e,t){return e[t]}function TD(e){const t=[];return t.key=e,t}function PD(){var e=Wt([]),t=xv,r=ic,n=AD;function a(i){var s=Array.from(e.apply(this,arguments),TD),c,f=s.length,d=-1,h;for(const m of i)for(c=0,++d;c<f;++c)(s[c][d]=[0,+n(m,s[c].key,d,i)]).data=m;for(c=0,h=C1(t(s));c<f;++c)s[h[c]].index=c;return r(s,h),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Wt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Wt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?xv:typeof i=="function"?i:Wt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??ic,a):r},a}function OD(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}ic(e,t)}}function FD(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,c=0;s<a;++s)c+=e[s][r][1]||0;n[r][1]+=n[r][0]=-c/2}ic(e,t)}}function DD(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var c=0,f=0,d=0;c<s;++c){for(var h=e[t[c]],m=h[n][1]||0,x=h[n-1][1]||0,g=(m-x)/2,y=0;y<c;++y){var v=e[t[y]],b=v[n][1]||0,N=v[n-1][1]||0;g+=b-N}f+=m,d+=g*m}a[n-1][1]+=a[n-1][0]=r,f&&(r-=d/f)}a[n-1][1]+=a[n-1][0]=r,ic(e,t)}}var ID=["type","size","sizeType"];function gv(){return gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gv.apply(null,arguments)}function nN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nN(Object(r),!0).forEach(function(n){MD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MD(e,t,r){return(t=RD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RD(e){var t=LD(e,"string");return typeof t=="symbol"?t:t+""}function LD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BD(e,t){if(e==null)return{};var r,n,a=$D(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $D(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var K4={symbolCircle:A1,symbolCross:oD,symbolDiamond:cD,symbolSquare:uD,symbolStar:mD,symbolTriangle:pD,symbolWye:gD},UD=Math.PI/180,zD=e=>{var t="symbol".concat(Sf(e));return K4[t]||A1},WD=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*UD;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},HD=(e,t)=>{K4["symbol".concat(Sf(e))]=t},T1=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=BD(e,ID),i=aN(aN({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var c=()=>{var x=zD(s),g=vD().type(x).size(WD(r,n,s));return g()},{className:f,cx:d,cy:h}=i,m=Dr(i,!0);return d===+d&&h===+h&&r===+r?j.createElement("path",gv({},m,{className:wt("recharts-symbols",f),transform:"translate(".concat(d,", ").concat(h,")"),d:c()})):null};T1.registerSymbol=HD;function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vv.apply(null,arguments)}function iN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function VD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iN(Object(r),!0).forEach(function(n){P1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P1(e,t,r){return(t=KD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KD(e){var t=GD(e,"string");return typeof t=="symbol"?t:t+""}function GD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ea=32;class O1 extends j.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=Ea/2,i=Ea/6,s=Ea/3,c=t.inactive?n:t.color,f=r??t.type;if(f==="none")return null;if(f==="plainline")return j.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:Ea,y2:a,className:"recharts-legend-icon"});if(f==="line")return j.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(Ea,"M").concat(2*s,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(f==="rect")return j.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Ea/8,"h").concat(Ea,"v").concat(Ea*3/4,"h").concat(-Ea,"z"),className:"recharts-legend-icon"});if(j.isValidElement(t.legendIcon)){var d=VD({},t);return delete d.legendIcon,j.cloneElement(t.legendIcon,d)}return j.createElement(T1,{fill:c,cx:a,cy:a,size:Ea,sizeType:"diameter",type:f})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:s}=this.props,c={x:0,y:0,width:Ea,height:Ea},f={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((h,m)=>{var x=h.formatter||a,g=wt({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:h.inactive});if(h.type==="none")return null;var y=h.inactive?i:h.color,v=x?x(h.value,h,m):h.value;return j.createElement("li",vv({className:g,style:f,key:"legend-item-".concat(m)},Nf(this.props,h,m)),j.createElement(k1,{width:r,height:r,viewBox:c,style:d,"aria-label":"".concat(v," legend icon")},this.renderIcon(h,s)),j.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},v))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return j.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}P1(O1,"displayName","Legend");P1(O1,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var kx={},jx={},sN;function XD(){return sN||(sN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],c=n(s);a.has(c)||a.set(c,s)}return Array.from(a.values())}e.uniqBy=t})(jx)),jx}var Cx={},oN;function G4(){return oN||(oN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Cx)),Cx}var Ax={},Tx={},Px={},lN;function qD(){return lN||(lN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Px)),Px}var cN;function F1(){return cN||(cN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qD();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Tx)),Tx}var Ox={},uN;function YD(){return uN||(uN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Ox)),Ox}var fN;function JD(){return fN||(fN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=F1(),r=YD();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(Ax)),Ax}var Fx={},Dx={},dN;function QD(){return dN||(dN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=N1();function r(n){return function(a){return t.get(a,n)}}e.property=r})(Dx)),Dx}var Ix={},Mx={},Rx={},Lx={},hN;function X4(){return hN||(hN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Lx)),Lx}var Bx={},mN;function q4(){return mN||(mN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Bx)),Bx}var $x={},pN;function Y4(){return pN||(pN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})($x)),$x}var xN;function ZD(){return xN||(xN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D1(),r=X4(),n=q4(),a=Y4();function i(m,x,g){return typeof g!="function"?t.isMatch(m,x):s(m,x,function y(v,b,N,E,S,C){const T=g(v,b,N,E,S,C);return T!==void 0?!!T:s(v,b,y,C)},new Map)}function s(m,x,g,y){if(x===m)return!0;switch(typeof x){case"object":return c(m,x,g,y);case"function":return Object.keys(x).length>0?s(m,{...x},g,y):a.eq(m,x);default:return r.isObject(m)?typeof x=="string"?x==="":!0:a.eq(m,x)}}function c(m,x,g,y){if(x==null)return!0;if(Array.isArray(x))return d(m,x,g,y);if(x instanceof Map)return f(m,x,g,y);if(x instanceof Set)return h(m,x,g,y);const v=Object.keys(x);if(m==null)return v.length===0;if(v.length===0)return!0;if(y&&y.has(x))return y.get(x)===m;y&&y.set(x,m);try{for(let b=0;b<v.length;b++){const N=v[b];if(!n.isPrimitive(m)&&!(N in m)||x[N]===void 0&&m[N]!==void 0||x[N]===null&&m[N]!==null||!g(m[N],x[N],N,m,x,y))return!1}return!0}finally{y&&y.delete(x)}}function f(m,x,g,y){if(x.size===0)return!0;if(!(m instanceof Map))return!1;for(const[v,b]of x.entries()){const N=m.get(v);if(g(N,b,v,m,x,y)===!1)return!1}return!0}function d(m,x,g,y){if(x.length===0)return!0;if(!Array.isArray(m))return!1;const v=new Set;for(let b=0;b<x.length;b++){const N=x[b];let E=!1;for(let S=0;S<m.length;S++){if(v.has(S))continue;const C=m[S];let T=!1;if(g(C,N,b,m,x,y)&&(T=!0),T){v.add(S),E=!0;break}}if(!E)return!1}return!0}function h(m,x,g,y){return x.size===0?!0:m instanceof Set?d([...m],[...x],g,y):!1}e.isMatchWith=i,e.isSetMatch=h})(Rx)),Rx}var gN;function D1(){return gN||(gN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZD();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(Mx)),Mx}var Ux={},zx={},Wx={},vN;function eI(){return vN||(vN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(Wx)),Wx}var Hx={},yN;function J4(){return yN||(yN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Hx)),Hx}var Vx={},wN;function Q4(){return wN||(wN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",c="[object Date]",f="[object Map]",d="[object Set]",h="[object Array]",m="[object Function]",x="[object ArrayBuffer]",g="[object Object]",y="[object Error]",v="[object DataView]",b="[object Uint8Array]",N="[object Uint8ClampedArray]",E="[object Uint16Array]",S="[object Uint32Array]",C="[object BigUint64Array]",T="[object Int8Array]",k="[object Int16Array]",P="[object Int32Array]",D="[object BigInt64Array]",R="[object Float32Array]",q="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=x,e.arrayTag=h,e.bigInt64ArrayTag=D,e.bigUint64ArrayTag=C,e.booleanTag=a,e.dataViewTag=v,e.dateTag=c,e.errorTag=y,e.float32ArrayTag=R,e.float64ArrayTag=q,e.functionTag=m,e.int16ArrayTag=k,e.int32ArrayTag=P,e.int8ArrayTag=T,e.mapTag=f,e.numberTag=n,e.objectTag=g,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=E,e.uint32ArrayTag=S,e.uint8ArrayTag=b,e.uint8ClampedArrayTag=N})(Vx)),Vx}var Kx={},bN;function tI(){return bN||(bN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Kx)),Kx}var SN;function Z4(){return SN||(SN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=eI(),r=J4(),n=Q4(),a=q4(),i=tI();function s(h,m){return c(h,void 0,h,new Map,m)}function c(h,m,x,g=new Map,y=void 0){const v=y?.(h,m,x,g);if(v!==void 0)return v;if(a.isPrimitive(h))return h;if(g.has(h))return g.get(h);if(Array.isArray(h)){const b=new Array(h.length);g.set(h,b);for(let N=0;N<h.length;N++)b[N]=c(h[N],N,x,g,y);return Object.hasOwn(h,"index")&&(b.index=h.index),Object.hasOwn(h,"input")&&(b.input=h.input),b}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const b=new RegExp(h.source,h.flags);return b.lastIndex=h.lastIndex,b}if(h instanceof Map){const b=new Map;g.set(h,b);for(const[N,E]of h)b.set(N,c(E,N,x,g,y));return b}if(h instanceof Set){const b=new Set;g.set(h,b);for(const N of h)b.add(c(N,void 0,x,g,y));return b}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(i.isTypedArray(h)){const b=new(Object.getPrototypeOf(h)).constructor(h.length);g.set(h,b);for(let N=0;N<h.length;N++)b[N]=c(h[N],N,x,g,y);return b}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const b=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return g.set(h,b),f(b,h,x,g,y),b}if(typeof File<"u"&&h instanceof File){const b=new File([h],h.name,{type:h.type});return g.set(h,b),f(b,h,x,g,y),b}if(h instanceof Blob){const b=new Blob([h],{type:h.type});return g.set(h,b),f(b,h,x,g,y),b}if(h instanceof Error){const b=new h.constructor;return g.set(h,b),b.message=h.message,b.name=h.name,b.stack=h.stack,b.cause=h.cause,f(b,h,x,g,y),b}if(typeof h=="object"&&d(h)){const b=Object.create(Object.getPrototypeOf(h));return g.set(h,b),f(b,h,x,g,y),b}return h}function f(h,m,x=h,g,y){const v=[...Object.keys(m),...t.getSymbols(m)];for(let b=0;b<v.length;b++){const N=v[b],E=Object.getOwnPropertyDescriptor(h,N);(E==null||E.writable)&&(h[N]=c(m[N],N,x,g,y))}}function d(h){switch(r.getTag(h)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=c,e.copyProperties=f})(zx)),zx}var NN;function rI(){return NN||(NN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Z4();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(Ux)),Ux}var _N;function nI(){return _N||(_N=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D1(),r=rI();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(Ix)),Ix}var Gx={},Xx={},qx={},EN;function aI(){return EN||(EN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Z4(),r=Q4();function n(a,i){return t.cloneDeepWith(a,(s,c,f,d)=>{const h=i?.(s,c,f,d);if(h!==void 0)return h;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new a.constructor(a?.valueOf());return t.copyProperties(m,a),m}case r.argumentsTag:{const m={};return t.copyProperties(m,a),m.length=a.length,m[Symbol.iterator]=a[Symbol.iterator],m}default:return}})}e.cloneDeepWith=n})(qx)),qx}var kN;function iI(){return kN||(kN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aI();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(Xx)),Xx}var Yx={},Jx={},jN;function eC(){return jN||(jN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Jx)),Jx}var Qx={},CN;function sI(){return CN||(CN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=J4();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(Qx)),Qx}var AN;function oI(){return AN||(AN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=N4(),r=eC(),n=sI(),a=S1();function i(s,c){let f;if(Array.isArray(c)?f=c:typeof c=="string"&&t.isDeepKey(c)&&s?.[c]==null?f=a.toPath(c):f=[c],f.length===0)return!1;let d=s;for(let h=0;h<f.length;h++){const m=f[h];if((d==null||!Object.hasOwn(d,m))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(m)&&m<d.length))return!1;d=d[m]}return!0}e.has=i})(Yx)),Yx}var TN;function lI(){return TN||(TN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D1(),r=_4(),n=iI(),a=N1(),i=oI();function s(c,f){switch(typeof c){case"object":{Object.is(c?.valueOf(),-0)&&(c="-0");break}case"number":{c=r.toKey(c);break}}return f=n.cloneDeep(f),function(d){const h=a.get(d,c);return h===void 0?i.has(d,c):f===void 0?h===void 0:t.isMatch(h,f)}}e.matchesProperty=s})(Gx)),Gx}var PN;function cI(){return PN||(PN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G4(),r=QD(),n=nI(),a=lI();function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(Fx)),Fx}var ON;function uI(){return ON||(ON=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=XD(),r=G4(),n=JD(),a=cI();function i(s,c=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(c)):[]}e.uniqBy=i})(kx)),kx}var Zx,FN;function fI(){return FN||(FN=1,Zx=uI().uniqBy),Zx}var dI=fI();const DN=Ni(dI);function tC(e,t,r){return t===!0?DN(e,r):typeof t=="function"?DN(e,t):e}var eg={exports:{}},tg={},rg={exports:{}},ng={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IN;function hI(){if(IN)return ng;IN=1;var e=yc();function t(m,x){return m===x&&(m!==0||1/m===1/x)||m!==m&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function c(m,x){var g=x(),y=n({inst:{value:g,getSnapshot:x}}),v=y[0].inst,b=y[1];return i(function(){v.value=g,v.getSnapshot=x,f(v)&&b({inst:v})},[m,g,x]),a(function(){return f(v)&&b({inst:v}),m(function(){f(v)&&b({inst:v})})},[m]),s(g),g}function f(m){var x=m.getSnapshot;m=m.value;try{var g=x();return!r(m,g)}catch{return!0}}function d(m,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:c;return ng.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,ng}var MN;function mI(){return MN||(MN=1,rg.exports=hI()),rg.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RN;function pI(){if(RN)return tg;RN=1;var e=yc(),t=mI();function r(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,c=e.useMemo,f=e.useDebugValue;return tg.useSyncExternalStoreWithSelector=function(d,h,m,x,g){var y=i(null);if(y.current===null){var v={hasValue:!1,value:null};y.current=v}else v=y.current;y=c(function(){function N(k){if(!E){if(E=!0,S=k,k=x(k),g!==void 0&&v.hasValue){var P=v.value;if(g(P,k))return C=P}return C=k}if(P=C,n(S,k))return P;var D=x(k);return g!==void 0&&g(P,D)?(S=k,P):(S=k,C=D)}var E=!1,S,C,T=m===void 0?null:m;return[function(){return N(h())},T===null?void 0:function(){return N(T())}]},[h,m,x,g]);var b=a(d,y[0],y[1]);return s(function(){v.hasValue=!0,v.value=b},[b]),f(b),b},tg}var LN;function xI(){return LN||(LN=1,eg.exports=pI()),eg.exports}var gI=xI(),I1=j.createContext(null),vI=e=>e,lr=()=>{var e=j.useContext(I1);return e?e.store.dispatch:vI},C0=()=>{},yI=()=>C0,wI=(e,t)=>e===t;function Ze(e){var t=j.useContext(I1);return gI.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:yI,t?t.store.getState:C0,t?t.store.getState:C0,t?e:C0,wI)}function bI(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function SI(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function NI(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var BN=e=>Array.isArray(e)?e:[e];function _I(e){const t=Array.isArray(e[0])?e[0]:e;return NI(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function EI(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var kI=class{constructor(e){this.value=e}deref(){return this.value}},jI=typeof WeakRef<"u"?WeakRef:kI,CI=0,$N=1;function t0(){return{s:CI,v:void 0,o:null,p:null}}function rC(e,t={}){let r=t0();const{resultEqualityCheck:n}=t;let a,i=0;function s(){let c=r;const{length:f}=arguments;for(let m=0,x=f;m<x;m++){const g=arguments[m];if(typeof g=="function"||typeof g=="object"&&g!==null){let y=c.o;y===null&&(c.o=y=new WeakMap);const v=y.get(g);v===void 0?(c=t0(),y.set(g,c)):c=v}else{let y=c.p;y===null&&(c.p=y=new Map);const v=y.get(g);v===void 0?(c=t0(),y.set(g,c)):c=v}}const d=c;let h;if(c.s===$N)h=c.v;else if(h=e.apply(null,arguments),i++,n){const m=a?.deref?.()??a;m!=null&&n(m,h)&&(h=m,i!==0&&i--),a=typeof h=="object"&&h!==null||typeof h=="function"?new jI(h):h}return d.s=$N,d.v=h,h}return s.clearCache=()=>{r=t0(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function AI(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,c,f={},d=a.pop();typeof d=="object"&&(f=d,d=a.pop()),bI(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const h={...r,...f},{memoize:m,memoizeOptions:x=[],argsMemoize:g=rC,argsMemoizeOptions:y=[]}=h,v=BN(x),b=BN(y),N=_I(a),E=m(function(){return i++,d.apply(null,arguments)},...v),S=g(function(){s++;const T=EI(N,arguments);return c=E.apply(null,T),c},...b);return Object.assign(S,{resultFunc:d,memoizedResultFunc:E,dependencies:N,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>c,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var Se=AI(rC),TI=Object.assign((e,t=Se)=>{SI(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,c,f)=>(s[r[f]]=c,s),{}))},{withTypes:()=>TI}),ag={},ig={},sg={},UN;function PI(){return UN||(UN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),c=t(a);if(s===c&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?c-s:s-c}return 0};e.compareValues=r})(sg)),sg}var og={},lg={},zN;function nC(){return zN||(zN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(lg)),lg}var WN;function OI(){return WN||(WN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nC(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(og)),og}var HN;function FI(){return HN||(HN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PI(),r=OI(),n=S1();function a(i,s,c,f){if(i==null)return[];c=f?void 0:c,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(g=>String(g));const d=(g,y)=>{let v=g;for(let b=0;b<y.length&&v!=null;++b)v=v[y[b]];return v},h=(g,y)=>y==null||g==null?y:typeof g=="object"&&"key"in g?Object.hasOwn(y,g.key)?y[g.key]:d(y,g.path):typeof g=="function"?g(y):Array.isArray(g)?d(y,g):typeof y=="object"?y[g]:y,m=s.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||r.isKey(g)?g:{key:g,path:n.toPath(g)}));return i.map(g=>({original:g,criteria:m.map(y=>h(y,g))})).slice().sort((g,y)=>{for(let v=0;v<m.length;v++){const b=t.compareValues(g.criteria[v],y.criteria[v],c[v]);if(b!==0)return b}return 0}).map(g=>g.original)}e.orderBy=a})(ig)),ig}var cg={},VN;function DI(){return VN||(VN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(c,f)=>{for(let d=0;d<c.length;d++){const h=c[d];Array.isArray(h)&&f<i?s(h,f+1):a.push(h)}};return s(r,0),a}e.flatten=t})(cg)),cg}var ug={},KN;function aC(){return KN||(KN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=eC(),r=F1(),n=X4(),a=Y4();function i(s,c,f){return n.isObject(f)&&(typeof c=="number"&&r.isArrayLike(f)&&t.isIndex(c)&&c<f.length||typeof c=="string"&&c in f)?a.eq(f[c],s):!1}e.isIterateeCall=i})(ug)),ug}var GN;function II(){return GN||(GN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FI(),r=DI(),n=aC();function a(i,...s){const c=s.length;return c>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:c>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(ag)),ag}var fg,XN;function MI(){return XN||(XN=1,fg=II().sortBy),fg}var RI=MI();const $h=Ni(RI);var iC=e=>e.legend.settings,LI=e=>e.legend.size,BI=e=>e.legend.payload,$I=Se([BI,iC],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?$h(n,r):n});function UI(){return Ze($I)}var r0=1;function sC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=j.useState({height:0,left:0,top:0,width:0}),n=j.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>r0||Math.abs(s.left-t.left)>r0||Math.abs(s.top-t.top)>r0||Math.abs(s.width-t.width)>r0)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function sn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var zI=typeof Symbol=="function"&&Symbol.observable||"@@observable",qN=zI,dg=()=>Math.random().toString(36).substring(7).split("").join("."),WI={INIT:`@@redux/INIT${dg()}`,REPLACE:`@@redux/REPLACE${dg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${dg()}`},$0=WI;function M1(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function oC(e,t,r){if(typeof e!="function")throw new Error(sn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(sn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(sn(1));return r(oC)(e,t)}let n=e,a=t,i=new Map,s=i,c=0,f=!1;function d(){s===i&&(s=new Map,i.forEach((b,N)=>{s.set(N,b)}))}function h(){if(f)throw new Error(sn(3));return a}function m(b){if(typeof b!="function")throw new Error(sn(4));if(f)throw new Error(sn(5));let N=!0;d();const E=c++;return s.set(E,b),function(){if(N){if(f)throw new Error(sn(6));N=!1,d(),s.delete(E),i=null}}}function x(b){if(!M1(b))throw new Error(sn(7));if(typeof b.type>"u")throw new Error(sn(8));if(typeof b.type!="string")throw new Error(sn(17));if(f)throw new Error(sn(9));try{f=!0,a=n(a,b)}finally{f=!1}return(i=s).forEach(E=>{E()}),b}function g(b){if(typeof b!="function")throw new Error(sn(10));n=b,x({type:$0.REPLACE})}function y(){const b=m;return{subscribe(N){if(typeof N!="object"||N===null)throw new Error(sn(11));function E(){const C=N;C.next&&C.next(h())}return E(),{unsubscribe:b(E)}},[qN](){return this}}}return x({type:$0.INIT}),{dispatch:x,subscribe:m,getState:h,replaceReducer:g,[qN]:y}}function HI(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:$0.INIT})>"u")throw new Error(sn(12));if(typeof r(void 0,{type:$0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(sn(13))})}function lC(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{HI(r)}catch(i){a=i}return function(s={},c){if(a)throw a;let f=!1;const d={};for(let h=0;h<n.length;h++){const m=n[h],x=r[m],g=s[m],y=x(g,c);if(typeof y>"u")throw c&&c.type,new Error(sn(14));d[m]=y,f=f||y!==g}return f=f||n.length!==Object.keys(s).length,f?d:s}}function U0(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function VI(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(sn(15))};const s={getState:a.getState,dispatch:(f,...d)=>i(f,...d)},c=e.map(f=>f(s));return i=U0(...c)(a.dispatch),{...a,dispatch:i}}}function cC(e){return M1(e)&&"type"in e&&typeof e.type=="string"}var uC=Symbol.for("immer-nothing"),YN=Symbol.for("immer-draftable"),ha=Symbol.for("immer-state");function Ja(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var sc=Object.getPrototypeOf;function Ko(e){return!!e&&!!e[ha]}function Yi(e){return e?fC(e)||Array.isArray(e)||!!e[YN]||!!e.constructor?.[YN]||_f(e)||zh(e):!1}var KI=Object.prototype.constructor.toString();function fC(e){if(!e||typeof e!="object")return!1;const t=sc(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===KI}function z0(e,t){Uh(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Uh(e){const t=e[ha];return t?t.type_:Array.isArray(e)?1:_f(e)?2:zh(e)?3:0}function yv(e,t){return Uh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function dC(e,t,r){const n=Uh(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function GI(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function _f(e){return e instanceof Map}function zh(e){return e instanceof Set}function Eo(e){return e.copy_||e.base_}function wv(e,t){if(_f(e))return new Map(e);if(zh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=fC(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[ha];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],c=n[s];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[s]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[s]})}return Object.create(sc(e),n)}else{const n=sc(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function R1(e,t=!1){return Wh(e)||Ko(e)||!Yi(e)||(Uh(e)>1&&Object.defineProperties(e,{set:{value:n0},add:{value:n0},clear:{value:n0},delete:{value:n0}}),Object.freeze(e),t&&Object.values(e).forEach(r=>R1(r,!0))),e}function n0(){Ja(2)}function Wh(e){return Object.isFrozen(e)}var XI={};function Go(e){const t=XI[e];return t||Ja(0,e),t}var qu;function hC(){return qu}function qI(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function JN(e,t){t&&(Go("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function bv(e){Sv(e),e.drafts_.forEach(YI),e.drafts_=null}function Sv(e){e===qu&&(qu=e.parent_)}function QN(e){return qu=qI(qu,e)}function YI(e){const t=e[ha];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function ZN(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ha].modified_&&(bv(t),Ja(4)),Yi(e)&&(e=W0(t,e),t.parent_||H0(t,e)),t.patches_&&Go("Patches").generateReplacementPatches_(r[ha].base_,e,t.patches_,t.inversePatches_)):e=W0(t,r,[]),bv(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==uC?e:void 0}function W0(e,t,r){if(Wh(t))return t;const n=t[ha];if(!n)return z0(t,(a,i)=>e_(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return H0(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),z0(i,(c,f)=>e_(e,n,a,c,f,r,s)),H0(e,a,!1),r&&e.patches_&&Go("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function e_(e,t,r,n,a,i,s){if(Ko(a)){const c=i&&t&&t.type_!==3&&!yv(t.assigned_,n)?i.concat(n):void 0,f=W0(e,a,c);if(dC(r,n,f),Ko(f))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Yi(a)&&!Wh(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;W0(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(_f(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&H0(e,a)}}function H0(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&R1(t,r)}function JI(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:hC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=L1;r&&(a=[n],i=Yu);const{revoke:s,proxy:c}=Proxy.revocable(a,i);return n.draft_=c,n.revoke_=s,c}var L1={get(e,t){if(t===ha)return e;const r=Eo(e);if(!yv(r,t))return QI(e,r,t);const n=r[t];return e.finalized_||!Yi(n)?n:n===hg(e.base_,t)?(mg(e),e.copy_[t]=_v(n,e)):n},has(e,t){return t in Eo(e)},ownKeys(e){return Reflect.ownKeys(Eo(e))},set(e,t,r){const n=mC(Eo(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=hg(Eo(e),t),i=a?.[ha];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(GI(r,a)&&(r!==void 0||yv(e.base_,t)))return!0;mg(e),Nv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return hg(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,mg(e),Nv(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Eo(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Ja(11)},getPrototypeOf(e){return sc(e.base_)},setPrototypeOf(){Ja(12)}},Yu={};z0(L1,(e,t)=>{Yu[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Yu.deleteProperty=function(e,t){return Yu.set.call(this,e,t,void 0)};Yu.set=function(e,t,r){return L1.set.call(this,e[0],t,r,e[0])};function hg(e,t){const r=e[ha];return(r?Eo(r):e)[t]}function QI(e,t,r){const n=mC(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function mC(e,t){if(!(t in e))return;let r=sc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=sc(r)}}function Nv(e){e.modified_||(e.modified_=!0,e.parent_&&Nv(e.parent_))}function mg(e){e.copy_||(e.copy_=wv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var ZI=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(f=i,...d){return s.produce(f,h=>r.call(this,h,...d))}}typeof r!="function"&&Ja(6),n!==void 0&&typeof n!="function"&&Ja(7);let a;if(Yi(t)){const i=QN(this),s=_v(t,void 0);let c=!0;try{a=r(s),c=!1}finally{c?bv(i):Sv(i)}return JN(i,n),ZN(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===uC&&(a=void 0),this.autoFreeze_&&R1(a,!0),n){const i=[],s=[];Go("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Ja(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...c)=>this.produceWithPatches(s,f=>t(f,...c));let n,a;return[this.produce(t,r,(s,c)=>{n=s,a=c}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Yi(e)||Ja(8),Ko(e)&&(e=Hi(e));const t=QN(this),r=_v(e,void 0);return r[ha].isManual_=!0,Sv(t),r}finishDraft(e,t){const r=e&&e[ha];(!r||!r.isManual_)&&Ja(9);const{scope_:n}=r;return JN(n,t),ZN(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Go("Patches").applyPatches_;return Ko(e)?n(e,t):this.produce(e,a=>n(a,t))}};function _v(e,t){const r=_f(e)?Go("MapSet").proxyMap_(e,t):zh(e)?Go("MapSet").proxySet_(e,t):JI(e,t);return(t?t.scope_:hC()).drafts_.push(r),r}function Hi(e){return Ko(e)||Ja(10,e),pC(e)}function pC(e){if(!Yi(e)||Wh(e))return e;const t=e[ha];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=wv(e,t.scope_.immer_.useStrictShallowCopy_)}else r=wv(e,!0);return z0(r,(n,a)=>{dC(r,n,pC(a))}),t&&(t.finalized_=!1),r}var eM=new ZI,xC=eM.produce;function gC(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var tM=gC(),rM=gC,nM=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?U0:U0.apply(null,arguments)};function Ma(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(fa(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>cC(n)&&n.type===e,r}var vC=class Au extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Au.prototype)}static get[Symbol.species](){return Au}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Au(...t[0].concat(this)):new Au(...t.concat(this))}};function t_(e){return Yi(e)?xC(e,()=>{}):e}function a0(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function aM(e){return typeof e=="boolean"}var iM=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new vC;return r&&(aM(r)?s.push(tM):s.push(rM(r.extraArgument))),s},sM="RTK_autoBatch",r_=e=>t=>{setTimeout(t,e)},oM=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const c=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:r_(10):e.type==="callback"?e.queueNotification:r_(e.timeout),d=()=>{s=!1,i&&(i=!1,c.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const m=()=>a&&h(),x=n.subscribe(m);return c.add(h),()=>{x(),c.delete(h)}},dispatch(h){try{return a=!h?.meta?.[sM],i=!a,i&&(s||(s=!0,f(d))),n.dispatch(h)}finally{a=!0}}})},lM=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new vC(e);return n&&a.push(oM(typeof n=="object"?n:void 0)),a};function cM(e){const t=iM(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let c;if(typeof r=="function")c=r;else if(M1(r))c=lC(r);else throw new Error(fa(1));let f;typeof n=="function"?f=n(t):f=t();let d=U0;a&&(d=nM({trace:!1,...typeof a=="object"&&a}));const h=VI(...f),m=lM(h);let x=typeof s=="function"?s(m):m();const g=d(...x);return oC(c,i,g)}function yC(e){const t={},r=[];let n;const a={addCase(i,s){const c=typeof i=="string"?i:i.type;if(!c)throw new Error(fa(28));if(c in t)throw new Error(fa(29));return t[c]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function uM(e){return typeof e=="function"}function fM(e,t){let[r,n,a]=yC(t),i;if(uM(e))i=()=>t_(e());else{const c=t_(e);i=()=>c}function s(c=i(),f){let d=[r[f.type],...n.filter(({matcher:h})=>h(f)).map(({reducer:h})=>h)];return d.filter(h=>!!h).length===0&&(d=[a]),d.reduce((h,m)=>{if(m)if(Ko(h)){const g=m(h,f);return g===void 0?h:g}else{if(Yi(h))return xC(h,x=>m(x,f));{const x=m(h,f);if(x===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return h},c)}return s.getInitialState=i,s}var dM="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",hM=(e=21)=>{let t="",r=e;for(;r--;)t+=dM[Math.random()*64|0];return t},mM=Symbol.for("rtk-slice-createasyncthunk");function pM(e,t){return`${e}/${t}`}function xM({creators:e}={}){const t=e?.asyncThunk?.[mM];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(fa(11));const s=(typeof n.reducers=="function"?n.reducers(vM()):n.reducers)||{},c=Object.keys(s),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,C){const T=typeof S=="string"?S:S.type;if(!T)throw new Error(fa(12));if(T in f.sliceCaseReducersByType)throw new Error(fa(13));return f.sliceCaseReducersByType[T]=C,d},addMatcher(S,C){return f.sliceMatchers.push({matcher:S,reducer:C}),d},exposeAction(S,C){return f.actionCreators[S]=C,d},exposeCaseReducer(S,C){return f.sliceCaseReducersByName[S]=C,d}};c.forEach(S=>{const C=s[S],T={reducerName:S,type:pM(a,S),createNotation:typeof n.reducers=="function"};wM(C)?SM(T,C,d,t):yM(T,C,d)});function h(){const[S={},C=[],T=void 0]=typeof n.extraReducers=="function"?yC(n.extraReducers):[n.extraReducers],k={...S,...f.sliceCaseReducersByType};return fM(n.initialState,P=>{for(let D in k)P.addCase(D,k[D]);for(let D of f.sliceMatchers)P.addMatcher(D.matcher,D.reducer);for(let D of C)P.addMatcher(D.matcher,D.reducer);T&&P.addDefaultCase(T)})}const m=S=>S,x=new Map,g=new WeakMap;let y;function v(S,C){return y||(y=h()),y(S,C)}function b(){return y||(y=h()),y.getInitialState()}function N(S,C=!1){function T(P){let D=P[S];return typeof D>"u"&&C&&(D=a0(g,T,b)),D}function k(P=m){const D=a0(x,C,()=>new WeakMap);return a0(D,P,()=>{const R={};for(const[q,M]of Object.entries(n.selectors??{}))R[q]=gM(M,P,()=>a0(g,P,b),C);return R})}return{reducerPath:S,getSelectors:k,get selectors(){return k(T)},selectSlice:T}}const E={name:a,reducer:v,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:b,...N(i),injectInto(S,{reducerPath:C,...T}={}){const k=C??i;return S.inject({reducerPath:k,reducer:v},T),{...E,...N(k,!0)}}};return E}}function gM(e,t,r,n){function a(i,...s){let c=t(i);return typeof c>"u"&&n&&(c=r()),e(c,...s)}return a.unwrapped=e,a}var xa=xM();function vM(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function yM({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!bM(n))throw new Error(fa(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?Ma(e,s):Ma(e))}function wM(e){return e._reducerDefinitionType==="asyncThunk"}function bM(e){return e._reducerDefinitionType==="reducerWithPrepare"}function SM({type:e,reducerName:t},r,n,a){if(!a)throw new Error(fa(18));const{payloadCreator:i,fulfilled:s,pending:c,rejected:f,settled:d,options:h}=r,m=a(e,i,h);n.exposeAction(t,m),s&&n.addCase(m.fulfilled,s),c&&n.addCase(m.pending,c),f&&n.addCase(m.rejected,f),d&&n.addMatcher(m.settled,d),n.exposeCaseReducer(t,{fulfilled:s||i0,pending:c||i0,rejected:f||i0,settled:d||i0})}function i0(){}var NM="task",wC="listener",bC="completed",B1="cancelled",_M=`task-${B1}`,EM=`task-${bC}`,Ev=`${wC}-${B1}`,kM=`${wC}-${bC}`,Hh=class{constructor(e){this.code=e,this.message=`${NM} ${B1} (reason: ${e})`}name="TaskAbortError";message},$1=(e,t)=>{if(typeof e!="function")throw new TypeError(fa(32))},V0=()=>{},SC=(e,t=V0)=>(e.catch(t),e),NC=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Do=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Io=e=>{if(e.aborted){const{reason:t}=e;throw new Hh(t)}};function _C(e,t){let r=V0;return new Promise((n,a)=>{const i=()=>a(new Hh(e.reason));if(e.aborted){i();return}r=NC(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=V0})}var jM=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Hh?"cancelled":"rejected",error:r}}finally{t?.()}},K0=e=>t=>SC(_C(e,t).then(r=>(Io(e),r))),EC=e=>{const t=K0(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Jl}=Object,n_={},Vh="listenerMiddleware",CM=(e,t)=>{const r=n=>NC(e,()=>Do(n,e.reason));return(n,a)=>{$1(n);const i=new AbortController;r(i);const s=jM(async()=>{Io(e),Io(i.signal);const c=await n({pause:K0(i.signal),delay:EC(i.signal),signal:i.signal});return Io(i.signal),c},()=>Do(i,EM));return a?.autoJoin&&t.push(s.catch(V0)),{result:K0(e)(s),cancel(){Do(i,_M)}}}},AM=(e,t)=>{const r=async(n,a)=>{Io(t);let i=()=>{};const c=[new Promise((f,d)=>{let h=e({predicate:n,effect:(m,x)=>{x.unsubscribe(),f([m,x.getState(),x.getOriginalState()])}});i=()=>{h(),d()}})];a!=null&&c.push(new Promise(f=>setTimeout(f,a,null)));try{const f=await _C(t,Promise.race(c));return Io(t),f}finally{i()}};return(n,a)=>SC(r(n,a))},kC=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=Ma(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(fa(21));return $1(i),{predicate:a,type:t,effect:i}},jC=Jl(e=>{const{type:t,predicate:r,effect:n}=kC(e);return{id:hM(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(fa(22))}}},{withTypes:()=>jC}),a_=(e,t)=>{const{type:r,effect:n,predicate:a}=kC(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},kv=e=>{e.pending.forEach(t=>{Do(t,Ev)})},TM=e=>()=>{e.forEach(kv),e.clear()},i_=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},CC=Jl(Ma(`${Vh}/add`),{withTypes:()=>CC}),PM=Ma(`${Vh}/removeAll`),AC=Jl(Ma(`${Vh}/remove`),{withTypes:()=>AC}),OM=(...e)=>{console.error(`${Vh}/error`,...e)},Ef=(e={})=>{const t=new Map,{extra:r,onError:n=OM}=e;$1(n);const a=h=>(h.unsubscribe=()=>t.delete(h.id),t.set(h.id,h),m=>{h.unsubscribe(),m?.cancelActive&&kv(h)}),i=h=>{const m=a_(t,h)??jC(h);return a(m)};Jl(i,{withTypes:()=>i});const s=h=>{const m=a_(t,h);return m&&(m.unsubscribe(),h.cancelActive&&kv(m)),!!m};Jl(s,{withTypes:()=>s});const c=async(h,m,x,g)=>{const y=new AbortController,v=AM(i,y.signal),b=[];try{h.pending.add(y),await Promise.resolve(h.effect(m,Jl({},x,{getOriginalState:g,condition:(N,E)=>v(N,E).then(Boolean),take:v,delay:EC(y.signal),pause:K0(y.signal),extra:r,signal:y.signal,fork:CM(y.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{t.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((N,E,S)=>{N!==y&&(Do(N,Ev),S.delete(N))})},cancel:()=>{Do(y,Ev),h.pending.delete(y)},throwIfCancelled:()=>{Io(y.signal)}})))}catch(N){N instanceof Hh||i_(n,N,{raisedBy:"effect"})}finally{await Promise.all(b),Do(y,kM),h.pending.delete(y)}},f=TM(t);return{middleware:h=>m=>x=>{if(!cC(x))return m(x);if(CC.match(x))return i(x.payload);if(PM.match(x)){f();return}if(AC.match(x))return s(x.payload);let g=h.getState();const y=()=>{if(g===n_)throw new Error(fa(23));return g};let v;try{if(v=m(x),t.size>0){const b=h.getState(),N=Array.from(t.values());for(const E of N){let S=!1;try{S=E.predicate(x,b,g)}catch(C){S=!1,i_(n,C,{raisedBy:"predicate"})}S&&c(E,x,h,y)}}}finally{g=n_}return v},startListening:i,stopListening:s,clearListeners:f}};function fa(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var FM={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},TC=xa({name:"chartLayout",initialState:FM,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:DM,setLayout:IM,setChartSize:MM,setScale:RM}=TC.actions,LM=TC.reducer;function s_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s_(Object(r),!0).forEach(function(n){BM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BM(e,t,r){return(t=$M(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $M(e){var t=UM(e,"string");return typeof t=="symbol"?t:t+""}function UM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G0=Math.PI/180,zM=e=>e*180/Math.PI,Er=(e,t,r,n)=>({x:e+Math.cos(-G0*n)*r,y:t+Math.sin(-G0*n)*r}),PC=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},WM=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},HM=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=WM({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var c=(r-a)/s,f=Math.acos(c);return n>i&&(f=2*Math.PI-f),{radius:s,angle:zM(f),angleInRadian:f}},VM=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},KM=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},GM=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=HM({x:r,y:n},t),{innerRadius:s,outerRadius:c}=t;if(a<s||a>c||a===0)return null;var{startAngle:f,endAngle:d}=VM(t),h=i,m;if(f<=d){for(;h>d;)h-=360;for(;h<f;)h+=360;m=h>=f&&h<=d}else{for(;h>f;)h-=360;for(;h<d;)h+=360;m=h>=d&&h<=f}return m?o_(o_({},t),{},{radius:a,angle:KM(h,t)}):null};function OC(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function l_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l_(Object(r),!0).forEach(function(n){XM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XM(e,t,r){return(t=qM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qM(e){var t=YM(e,"string");return typeof t=="symbol"?t:t+""}function YM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ir(e,t,r){return Yr(e)||Yr(t)?r:bi(t)?Vo(e,t,r):typeof t=="function"?t(e):r}var JM=(e,t,r,n,a)=>{var i,s=-1,c=(i=t?.length)!==null&&i!==void 0?i:0;if(c<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var f=0;f<c;f++){var d=f>0?r[f-1].coordinate:r[c-1].coordinate,h=r[f].coordinate,m=f>=c-1?r[0].coordinate:r[f+1].coordinate,x=void 0;if(Xr(h-d)!==Xr(m-h)){var g=[];if(Xr(m-h)===Xr(a[1]-a[0])){x=m;var y=h+a[1]-a[0];g[0]=Math.min(y,(y+d)/2),g[1]=Math.max(y,(y+d)/2)}else{x=d;var v=m+a[1]-a[0];g[0]=Math.min(h,(v+h)/2),g[1]=Math.max(h,(v+h)/2)}var b=[Math.min(h,(x+h)/2),Math.max(h,(x+h)/2)];if(e>b[0]&&e<=b[1]||e>=g[0]&&e<=g[1]){({index:s}=r[f]);break}}else{var N=Math.min(d,m),E=Math.max(d,m);if(e>(N+h)/2&&e<=(E+h)/2){({index:s}=r[f]);break}}}else if(t){for(var S=0;S<c;S++)if(S===0&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S>0&&S<c-1&&e>(t[S].coordinate+t[S-1].coordinate)/2&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S===c-1&&e>(t[S].coordinate+t[S-1].coordinate)/2){({index:s}=t[S]);break}}return s},QM=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:c}=t;if((c==="vertical"||c==="horizontal"&&s==="middle")&&i!=="center"&&et(e[i]))return Fa(Fa({},e),{},{[i]:e[i]+(n||0)});if((c==="horizontal"||c==="vertical"&&i==="center")&&s!=="middle"&&et(e[s]))return Fa(Fa({},e),{},{[s]:e[s]+(a||0)})}return e},al=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",FC=(e,t,r,n)=>{if(n)return e.map(c=>c.coordinate);var a,i,s=e.map(c=>(c.coordinate===t&&(a=!0),c.coordinate===r&&(i=!0),c.coordinate));return a||s.push(t),i||s.push(r),s},DC=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:c,isCategorical:f,categoricalDomain:d,tickCount:h,ticks:m,niceTicks:x,axisType:g}=e;if(!s)return null;var y=c==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,v=a==="category"&&s.bandwidth?s.bandwidth()/y:0;if(v=g==="angleAxis"&&i&&i.length>=2?Xr(i[0]-i[1])*2*v:v,m||x){var b=(m||x||[]).map((N,E)=>{var S=n?n.indexOf(N):N;return{coordinate:s(S)+v,value:N,offset:v,index:E}});return b.filter(N=>!da(N.coordinate))}return f&&d?d.map((N,E)=>({coordinate:s(N)+v,value:N,index:E,offset:v})):s.ticks&&h!=null?s.ticks(h).map((N,E)=>({coordinate:s(N)+v,value:N,offset:v,index:E})):s.domain().map((N,E)=>({coordinate:s(N)+v,value:n?n[N]:N,index:E,offset:v}))},c_=1e-4,ZM=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-c_,i=Math.max(n[0],n[1])+c_,s=e(t[0]),c=e(t[r-1]);(s<a||s>i||c<a||c>i)&&e.domain([t[0],t[r-1]])}},e8=(e,t)=>{if(!t||t.length!==2||!et(t[0])||!et(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!et(e[0])||e[0]<r)&&(a[0]=r),(!et(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},t8=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var c=da(e[s][r][1])?e[s][r][0]:e[s][r][1];c>=0?(e[s][r][0]=a,e[s][r][1]=a+c,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+c,i=e[s][r][1])}},r8=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=da(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},n8={sign:t8,expand:OD,none:ic,silhouette:FD,wiggle:DD,positive:r8},a8=(e,t,r)=>{var n=n8[r],a=PD().keys(t).value((i,s)=>+ir(i,s,0)).order(xv).offset(n);return a(e)};function i8(e){return e==null?void 0:String(e)}var u_=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var c=ir(i,t.dataKey,t.scale.domain()[s]);return Yr(c)?null:t.scale(c)-a/2+n},s8=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},o8=e=>{var t=e.flat(2).filter(et);return[Math.min(...t),Math.max(...t)]},l8=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],c8=(e,t,r)=>{if(e!=null)return l8(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,c=s.reduce((f,d)=>{var h=OC(d,t,r),m=o8(h);return[Math.min(f[0],m[0]),Math.max(f[1],m[1])]},[1/0,-1/0]);return[Math.min(c[0],n[0]),Math.max(c[1],n[1])]},[1/0,-1/0]))},f_=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,d_=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,U1=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=$h(t,h=>h.coordinate),i=1/0,s=1,c=a.length;s<c;s++){var f=a[s],d=a[s-1];i=Math.min((f.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function h_(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Fa(Fa({},t),{},{dataKey:r,payload:n,value:a,name:i})}function Kh(e,t){if(e)return String(e);if(typeof t=="string")return t}function u8(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?GM({x:e,y:t},n):null}var f8=(e,t,r,n)=>{var a=t.find(d=>d&&d.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return Fa(Fa(Fa({},n),Er(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var c=a.coordinate,{angle:f}=n;return Fa(Fa(Fa({},n),Er(n.cx,n.cy,c,f)),{},{angle:f,radius:c})}return{x:0,y:0}},d8=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,ts=e=>e.layout.width,rs=e=>e.layout.height,h8=e=>e.layout.scale,IC=e=>e.layout.margin,Gh=Se(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Xh=Se(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),MC="data-recharts-item-index",RC="data-recharts-item-data-key",kf=60;function m_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m_(Object(r),!0).forEach(function(n){m8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m8(e,t,r){return(t=p8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p8(e){var t=x8(e,"string");return typeof t=="symbol"?t:t+""}function x8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g8=e=>e.brush.height;function v8(e){var t=Xh(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:kf;return r+a}return r},0)}function y8(e){var t=Xh(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:kf;return r+a}return r},0)}function w8(e){var t=Gh(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function b8(e){var t=Gh(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Mr=Se([ts,rs,IC,g8,v8,y8,w8,b8,iC,LI],(e,t,r,n,a,i,s,c,f,d)=>{var h={left:(r.left||0)+a,right:(r.right||0)+i},m={top:(r.top||0)+s,bottom:(r.bottom||0)+c},x=s0(s0({},m),h),g=x.bottom;x.bottom+=n,x=QM(x,f,d);var y=e-x.left-x.right,v=t-x.top-x.bottom;return s0(s0({brushBottom:g},x),{},{width:Math.max(y,0),height:Math.max(v,0)})}),S8=Se(Mr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),z1=Se(ts,rs,(e,t)=>({x:0,y:0,width:e,height:t})),N8=j.createContext(null),Ba=()=>j.useContext(N8)!=null,qh=e=>e.brush,Yh=Se([qh,Mr,IC],(e,t,r)=>({height:e.height,x:et(e.x)?e.x:t.left,y:et(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:et(e.width)?e.width:t.width})),W1=()=>{var e,t=Ba(),r=Ze(S8),n=Ze(Yh),a=(e=Ze(qh))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},_8={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},LC=()=>{var e;return(e=Ze(Mr))!==null&&e!==void 0?e:_8},H1=()=>Ze(ts),V1=()=>Ze(rs),E8=()=>Ze(e=>e.layout.margin),Et=e=>e.layout.layoutType,K1=()=>Ze(Et),k8={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},BC=xa({name:"legend",initialState:k8,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Hi(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:p_,setLegendSettings:j8,addLegendPayload:$C,removeLegendPayload:UC}=BC.actions,C8=BC.reducer,A8=["contextPayload"];function jv(){return jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jv.apply(null,arguments)}function x_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x_(Object(r),!0).forEach(function(n){G1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function G1(e,t,r){return(t=T8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T8(e){var t=P8(e,"string");return typeof t=="symbol"?t:t+""}function P8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function O8(e,t){if(e==null)return{};var r,n,a=F8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function F8(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function D8(e){return e.value}function I8(e){var{contextPayload:t}=e,r=O8(e,A8),n=tC(t,e.payloadUniqBy,D8),a=oc(oc({},r),{},{payload:n});return j.isValidElement(e.content)?j.cloneElement(e.content,a):typeof e.content=="function"?j.createElement(e.content,a):j.createElement(O1,a)}function M8(e,t,r,n,a,i){var{layout:s,align:c,verticalAlign:f}=t,d,h;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(c==="center"&&s==="vertical"?d={left:((n||0)-i.width)/2}:d=c==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(f==="middle"?h={top:((a||0)-i.height)/2}:h=f==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),oc(oc({},d),h)}function R8(e){var t=lr();return j.useEffect(()=>{t(j8(e))},[t,e]),null}function L8(e){var t=lr();return j.useEffect(()=>(t(p_(e)),()=>{t(p_({width:0,height:0}))}),[t,e]),null}function B8(e){var t=UI(),r=tD(),n=E8(),{width:a,height:i,wrapperStyle:s,portal:c}=e,[f,d]=sC([t]),h=H1(),m=V1();if(h==null||m==null)return null;var x=h-(n.left||0)-(n.right||0),g=Jh.getWidthOrHeight(e.layout,i,a,x),y=c?s:oc(oc({position:"absolute",width:g?.width||a||"auto",height:g?.height||i||"auto"},M8(s,e,n,h,m,f)),s),v=c??r;if(v==null)return null;var b=j.createElement("div",{className:"recharts-legend-wrapper",style:y,ref:d},j.createElement(R8,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),j.createElement(L8,{width:f.width,height:f.height}),j.createElement(I8,jv({},e,g,{margin:n,chartWidth:h,chartHeight:m,contextPayload:t})));return C4.createPortal(b,v)}class Jh extends j.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&et(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return j.createElement(B8,this.props)}}G1(Jh,"displayName","Legend");G1(Jh,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Cv(){return Cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cv.apply(null,arguments)}function g_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g_(Object(r),!0).forEach(function(n){$8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $8(e,t,r){return(t=U8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U8(e){var t=z8(e,"string");return typeof t=="symbol"?t:t+""}function z8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W8(e){return Array.isArray(e)&&bi(e[0])&&bi(e[1])?e.join(" ~ "):e}var H8=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:c,wrapperClassName:f,labelClassName:d,label:h,labelFormatter:m,accessibilityLayer:x=!1}=e,g=()=>{if(i&&i.length){var T={padding:0,margin:0},k=(c?$h(i,c):i).map((P,D)=>{if(P.type==="none")return null;var R=P.formatter||s||W8,{value:q,name:M}=P,z=q,ie=M;if(R){var ce=R(q,M,P,D,i);if(Array.isArray(ce))[z,ie]=ce;else if(ce!=null)z=ce;else return null}var ae=pg({display:"block",paddingTop:4,paddingBottom:4,color:P.color||"#000"},n);return j.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:ae},bi(ie)?j.createElement("span",{className:"recharts-tooltip-item-name"},ie):null,bi(ie)?j.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,j.createElement("span",{className:"recharts-tooltip-item-value"},z),j.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return j.createElement("ul",{className:"recharts-tooltip-item-list",style:T},k)}return null},y=pg({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=pg({margin:0},a),b=!Yr(h),N=b?h:"",E=wt("recharts-default-tooltip",f),S=wt("recharts-tooltip-label",d);b&&m&&i!==void 0&&i!==null&&(N=m(h,i));var C=x?{role:"status","aria-live":"assertive"}:{};return j.createElement("div",Cv({className:E,style:y},C),j.createElement("p",{className:S,style:v},j.isValidElement(N)?N:"".concat(N)),g())},yu="recharts-tooltip-wrapper",V8={visibility:"hidden"};function K8(e){var{coordinate:t,translateX:r,translateY:n}=e;return wt(yu,{["".concat(yu,"-right")]:et(r)&&t&&et(t.x)&&r>=t.x,["".concat(yu,"-left")]:et(r)&&t&&et(t.x)&&r<t.x,["".concat(yu,"-bottom")]:et(n)&&t&&et(t.y)&&n>=t.y,["".concat(yu,"-top")]:et(n)&&t&&et(t.y)&&n<t.y})}function v_(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:c,viewBox:f,viewBoxDimension:d}=e;if(i&&et(i[n]))return i[n];var h=r[n]-c-(a>0?a:0),m=r[n]+a;if(t[n])return s[n]?h:m;var x=f[n];if(x==null)return 0;if(s[n]){var g=h,y=x;return g<y?Math.max(m,x):Math.max(h,x)}if(d==null)return 0;var v=m+c,b=x+d;return v>b?Math.max(h,x):Math.max(m,x)}function G8(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function X8(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:c,viewBox:f}=e,d,h,m;return s.height>0&&s.width>0&&r?(h=v_({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:f,viewBoxDimension:f.width}),m=v_({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:f,viewBoxDimension:f.height}),d=G8({translateX:h,translateY:m,useTranslate3d:c})):d=V8,{cssProperties:d,cssClasses:K8({translateX:h,translateY:m,coordinate:r})}}function y_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y_(Object(r),!0).forEach(function(n){Av(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Av(e,t,r){return(t=q8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q8(e){var t=Y8(e,"string");return typeof t=="symbol"?t:t+""}function Y8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class J8 extends j.PureComponent{constructor(){super(...arguments),Av(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Av(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:c,isAnimationActive:f,offset:d,position:h,reverseDirection:m,useTranslate3d:x,viewBox:g,wrapperStyle:y,lastBoundingBox:v,innerRef:b,hasPortalFromProps:N}=this.props,{cssClasses:E,cssProperties:S}=X8({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:d,position:h,reverseDirection:m,tooltipBox:{height:v.height,width:v.width},useTranslate3d:x,viewBox:g}),C=N?{}:o0(o0({transition:f&&t?"transform ".concat(n,"ms ").concat(a):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&c?"visible":"hidden",position:"absolute",top:0,left:0}),T=o0(o0({},C),{},{visibility:!this.state.dismissed&&t&&c?"visible":"hidden"},y);return j.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:E,style:T,ref:b},i)}}var Q8=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),il={devToolsEnabled:!1,isSsr:Q8()},zC=()=>Ze(e=>e.rootProps.accessibilityLayer);function ma(e){return Number.isFinite(e)}function lc(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Tv(){return Tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tv.apply(null,arguments)}function w_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function b_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w_(Object(r),!0).forEach(function(n){Z8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z8(e,t,r){return(t=eR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eR(e){var t=tR(e,"string");return typeof t=="symbol"?t:t+""}function tR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S_={curveBasisClosed:wD,curveBasisOpen:bD,curveBasis:yD,curveBumpX:iD,curveBumpY:sD,curveLinearClosed:SD,curveLinear:Lh,curveMonotoneX:ND,curveMonotoneY:_D,curveNatural:ED,curveStep:kD,curveStepAfter:CD,curveStepBefore:jD},l0=e=>ma(e.x)&&ma(e.y),wu=e=>e.x,bu=e=>e.y,rR=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Sf(e));return(r==="curveMonotone"||r==="curveBump")&&t?S_["".concat(r).concat(t==="vertical"?"Y":"X")]:S_[r]||Lh},nR=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=rR(t,a),c=i?r.filter(l0):r,f;if(Array.isArray(n)){var d=i?n.filter(m=>l0(m)):n,h=c.map((m,x)=>b_(b_({},m),{},{base:d[x]}));return a==="vertical"?f=e0().y(bu).x1(wu).x0(m=>m.base.x):f=e0().x(wu).y1(bu).y0(m=>m.base.y),f.defined(l0).curve(s),f(h)}return a==="vertical"&&et(n)?f=e0().y(bu).x1(wu).x0(n):et(n)?f=e0().x(wu).y1(bu).y0(n):f=I4().x(wu).y(bu),f.defined(l0).curve(s),f(c)},WC=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?nR(e):n;return j.createElement("path",Tv({},Zs(e),V5(e),{className:wt("recharts-curve",t),d:i===null?void 0:i,ref:a}))},aR=["x","y","top","left","width","height","className"];function Pv(){return Pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pv.apply(null,arguments)}function N_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N_(Object(r),!0).forEach(function(n){sR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sR(e,t,r){return(t=oR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oR(e){var t=lR(e,"string");return typeof t=="symbol"?t:t+""}function lR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cR(e,t){if(e==null)return{};var r,n,a=uR(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uR(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var fR=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),dR=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:c}=e,f=cR(e,aR),d=iR({x:t,y:r,top:n,left:a,width:i,height:s},f);return!et(t)||!et(r)||!et(i)||!et(s)||!et(n)||!et(a)?null:j.createElement("path",Pv({},Dr(d,!0),{className:wt("recharts-cross",c),d:fR(t,r,i,s,n,a)}))};function hR(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function __(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?__(Object(r),!0).forEach(function(n){pR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):__(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pR(e,t,r){return(t=xR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xR(e){var t=gR(e,"string");return typeof t=="symbol"?t:t+""}function gR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mn(e,t){var r=mR({},e),n=t,a=Object.keys(t),i=a.reduce((s,c)=>(s[c]===void 0&&n[c]!==void 0&&(s[c]=n[c]),s),r);return i}function vR(){}function E_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function k_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E_(Object(r),!0).forEach(function(n){yR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yR(e,t,r){return(t=wR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wR(e){var t=bR(e,"string");return typeof t=="symbol"?t:t+""}function bR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SR=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),HC=(e,t,r)=>e.map(n=>"".concat(SR(n)," ").concat(t,"ms ").concat(r)).join(","),NR=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),Ju=(e,t)=>Object.keys(t).reduce((r,n)=>k_(k_({},r),{},{[n]:e(n,t[n])}),{});function j_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ln(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j_(Object(r),!0).forEach(function(n){_R(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _R(e,t,r){return(t=ER(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ER(e){var t=kR(e,"string");return typeof t=="symbol"?t:t+""}function kR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var X0=(e,t,r)=>e+(t-e)*r,Ov=e=>{var{from:t,to:r}=e;return t!==r},VC=(e,t,r)=>{var n=Ju((a,i)=>{if(Ov(i)){var[s,c]=e(i.from,i.to,i.velocity);return ln(ln({},i),{},{from:s,velocity:c})}return i},t);return r<1?Ju((a,i)=>Ov(i)?ln(ln({},i),{},{velocity:X0(i.velocity,n[a].velocity,r),from:X0(i.from,n[a].from,r)}):i,t):VC(e,n,r-1)};function jR(e,t,r,n,a,i){var s,c=n.reduce((x,g)=>ln(ln({},x),{},{[g]:{from:e[g],velocity:0,to:t[g]}}),{}),f=()=>Ju((x,g)=>g.from,c),d=()=>!Object.values(c).filter(Ov).length,h=null,m=x=>{s||(s=x);var g=x-s,y=g/r.dt;c=VC(r,c,y),a(ln(ln(ln({},e),t),f())),s=x,d()||(h=i.setTimeout(m))};return()=>(h=i.setTimeout(m),()=>{h()})}function CR(e,t,r,n,a,i,s){var c=null,f=a.reduce((m,x)=>ln(ln({},m),{},{[x]:[e[x],t[x]]}),{}),d,h=m=>{d||(d=m);var x=(m-d)/n,g=Ju((v,b)=>X0(...b,r(x)),f);if(i(ln(ln(ln({},e),t),g)),x<1)c=s.setTimeout(h);else{var y=Ju((v,b)=>X0(...b,r(1)),f);i(ln(ln(ln({},e),t),y))}};return()=>(c=s.setTimeout(h),()=>{c()})}const AR=(e,t,r,n,a,i)=>{var s=NR(e,t);return r.isStepper===!0?jR(e,t,r,s,a,i):CR(e,t,r,n,s,a,i)};var q0=1e-4,KC=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],GC=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),C_=(e,t)=>r=>{var n=KC(e,t);return GC(n,r)},TR=(e,t)=>r=>{var n=KC(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return GC(a,r)},A_=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var f=s[0].split("(");f[0]==="cubic-bezier"&&f[1].split(")")[0].split(",").length===4&&([t,n,r,a]=f[1].split(")")[0].split(",").map(y=>parseFloat(y)))}}else s.length===4&&([t,n,r,a]=s);var d=C_(t,r),h=C_(n,a),m=TR(t,r),x=y=>y>1?1:y<0?0:y,g=y=>{for(var v=y>1?1:y,b=v,N=0;N<8;++N){var E=d(b)-v,S=m(b);if(Math.abs(E-v)<q0||S<q0)return h(b);b=x(b-E/S)}return h(b)};return g.isStepper=!1,g},PR=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,c,f)=>{var d=-(s-c)*r,h=f*n,m=f+(d-h)*a/1e3,x=f*a/1e3+s;return Math.abs(x-c)<q0&&Math.abs(m)<q0?[c,0]:[x,m]};return i.isStepper=!0,i.dt=a,i},OR=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return A_(e);case"spring":return PR();default:if(e.split("(")[0]==="cubic-bezier")return A_(e)}return typeof e=="function"?e:null};function FR(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var c=s,[f,...d]=c;if(typeof f=="number"){a=e.setTimeout(i.bind(null,d),f);return}i(f),a=e.setTimeout(i.bind(null,d));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class DR{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function IR(){return FR(new DR)}var MR=j.createContext(IR);function RR(e,t){var r=j.useContext(MR);return j.useMemo(()=>t??r(e),[e,t,r])}var LR={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},T_={t:0},xg={t:1};function Qh(e){var t=Mn(e,LR),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:c,onAnimationStart:f,children:d}=t,h=RR(t.animationId,t.animationManager),[m,x]=j.useState(r?T_:xg),g=j.useRef(null);return j.useEffect(()=>{r||x(xg)},[r]),j.useEffect(()=>{if(!r||!n)return vR;var y=AR(T_,xg,OR(i),a,x,h.getTimeoutController()),v=()=>{g.current=y()};return h.start([f,s,v,a,c]),()=>{h.stop(),g.current&&g.current(),c()}},[r,n,a,i,s,f,c,h]),d(m.t)}function Zh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=j.useRef(Xu(t)),n=j.useRef(e);return n.current!==e&&(r.current=Xu(t),n.current=e),r.current}function P_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function O_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P_(Object(r),!0).forEach(function(n){BR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BR(e,t,r){return(t=$R(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $R(e){var t=UR(e,"string");return typeof t=="symbol"?t:t+""}function UR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y0(){return Y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y0.apply(null,arguments)}var F_=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,c=r>=0?1:-1,f=n>=0&&r>=0||n<0&&r<0?1:0,d;if(i>0&&a instanceof Array){for(var h=[0,0,0,0],m=0,x=4;m<x;m++)h[m]=a[m]>i?i:a[m];d="M".concat(e,",").concat(t+s*h[0]),h[0]>0&&(d+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(f,",").concat(e+c*h[0],",").concat(t)),d+="L ".concat(e+r-c*h[1],",").concat(t),h[1]>0&&(d+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(f,`,
        `).concat(e+r,",").concat(t+s*h[1])),d+="L ".concat(e+r,",").concat(t+n-s*h[2]),h[2]>0&&(d+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(f,`,
        `).concat(e+r-c*h[2],",").concat(t+n)),d+="L ".concat(e+c*h[3],",").concat(t+n),h[3]>0&&(d+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(f,`,
        `).concat(e,",").concat(t+n-s*h[3])),d+="Z"}else if(i>0&&a===+a&&a>0){var g=Math.min(i,a);d="M ".concat(e,",").concat(t+s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+c*g,",").concat(t,`
            L `).concat(e+r-c*g,",").concat(t,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+r,",").concat(t+s*g,`
            L `).concat(e+r,",").concat(t+n-s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+r-c*g,",").concat(t+n,`
            L `).concat(e+c*g,",").concat(t+n,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e,",").concat(t+n-s*g," Z")}else d="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return d},zR={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},XC=e=>{var t=Mn(e,zR),r=j.useRef(null),[n,a]=j.useState(-1);j.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ce=r.current.getTotalLength();ce&&a(ce)}catch{}},[]);var{x:i,y:s,width:c,height:f,radius:d,className:h}=t,{animationEasing:m,animationDuration:x,animationBegin:g,isAnimationActive:y,isUpdateAnimationActive:v}=t,b=j.useRef(c),N=j.useRef(f),E=j.useRef(i),S=j.useRef(s),C=j.useMemo(()=>({x:i,y:s,width:c,height:f,radius:d}),[i,s,c,f,d]),T=Zh(C,"rectangle-");if(i!==+i||s!==+s||c!==+c||f!==+f||c===0||f===0)return null;var k=wt("recharts-rectangle",h);if(!v)return j.createElement("path",Y0({},Dr(t,!0),{className:k,d:F_(i,s,c,f,d)}));var P=b.current,D=N.current,R=E.current,q=S.current,M="0px ".concat(n===-1?1:n,"px"),z="".concat(n,"px 0px"),ie=HC(["strokeDasharray"],x,typeof m=="string"?m:void 0);return j.createElement(Qh,{animationId:T,key:T,canBegin:n>0,duration:x,easing:m,isActive:v,begin:g},ce=>{var ae=un(P,c,ce),me=un(D,f,ce),de=un(R,i,ce),he=un(q,s,ce);r.current&&(b.current=ae,N.current=me,E.current=de,S.current=he);var J;return y?ce>0?J={transition:ie,strokeDasharray:z}:J={strokeDasharray:M}:J={strokeDasharray:z},j.createElement("path",Y0({},Dr(t,!0),{className:k,d:F_(de,he,ae,me,d),ref:r,style:O_(O_({},J),t.style)}))})};function qC(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Er(t,r,n,a),c=Er(t,r,n,i);return{points:[s,c],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Fv(){return Fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fv.apply(null,arguments)}var WR=(e,t)=>{var r=Xr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},c0=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:c,cornerIsExternal:f}=e,d=c*(s?1:-1)+n,h=Math.asin(c/d)/G0,m=f?a:a+i*h,x=Er(t,r,d,m),g=Er(t,r,n,m),y=f?a-i*h:a,v=Er(t,r,d*Math.cos(h*G0),y);return{center:x,circleTangency:g,lineTangency:v,theta:h}},YC=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,c=WR(i,s),f=i+c,d=Er(t,r,a,i),h=Er(t,r,a,f),m="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(i>f),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(n>0){var x=Er(t,r,n,i),g=Er(t,r,n,f);m+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(i<=f),`,
            `).concat(x.x,",").concat(x.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},HR=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:c,startAngle:f,endAngle:d}=e,h=Xr(d-f),{circleTangency:m,lineTangency:x,theta:g}=c0({cx:t,cy:r,radius:a,angle:f,sign:h,cornerRadius:i,cornerIsExternal:c}),{circleTangency:y,lineTangency:v,theta:b}=c0({cx:t,cy:r,radius:a,angle:d,sign:-h,cornerRadius:i,cornerIsExternal:c}),N=c?Math.abs(f-d):Math.abs(f-d)-g-b;if(N<0)return s?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):YC({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:f,endAngle:d});var E="M ".concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(N>180),",").concat(+(h<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(v.x,",").concat(v.y,`
  `);if(n>0){var{circleTangency:S,lineTangency:C,theta:T}=c0({cx:t,cy:r,radius:n,angle:f,sign:h,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),{circleTangency:k,lineTangency:P,theta:D}=c0({cx:t,cy:r,radius:n,angle:d,sign:-h,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),R=c?Math.abs(f-d):Math.abs(f-d)-T-D;if(R<0&&i===0)return"".concat(E,"L").concat(t,",").concat(r,"Z");E+="L".concat(P.x,",").concat(P.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(k.x,",").concat(k.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(R>180),",").concat(+(h>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(C.x,",").concat(C.y,"Z")}else E+="L".concat(t,",").concat(r,"Z");return E},VR={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},JC=e=>{var t=Mn(e,VR),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:c,cornerIsExternal:f,startAngle:d,endAngle:h,className:m}=t;if(i<a||d===h)return null;var x=wt("recharts-sector",m),g=i-a,y=_n(s,g,0,!0),v;return y>0&&Math.abs(d-h)<360?v=HR({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(y,g/2),forceCornerRadius:c,cornerIsExternal:f,startAngle:d,endAngle:h}):v=YC({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:h}),j.createElement("path",Fv({},Dr(t,!0),{className:x,d:v}))};function KR(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:c,cy:f,innerRadius:d,outerRadius:h,angle:m}=t,x=Er(c,f,d,m),g=Er(c,f,h,m);n=x.x,a=x.y,i=g.x,s=g.y}else return qC(t);return[{x:n,y:a},{x:i,y:s}]}var gg={},vg={},yg={},D_;function GR(){return D_||(D_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nC();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(yg)),yg}var I_;function XR(){return I_||(I_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GR();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(vg)),vg}var M_;function qR(){return M_||(M_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aC(),r=XR();function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const c=Math.max(Math.ceil((i-a)/(s||1)),0),f=new Array(c);for(let d=0;d<c;d++)f[d]=a,a+=s;return f}e.range=n})(gg)),gg}var wg,R_;function YR(){return R_||(R_=1,wg=qR().range),wg}var JR=YR();const QC=Ni(JR);function Ls(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function QR(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function X1(e){let t,r,n;e.length!==2?(t=Ls,r=(c,f)=>Ls(e(c),f),n=(c,f)=>e(c)-f):(t=e===Ls||e===QR?e:ZR,r=e,n=e);function a(c,f,d=0,h=c.length){if(d<h){if(t(f,f)!==0)return h;do{const m=d+h>>>1;r(c[m],f)<0?d=m+1:h=m}while(d<h)}return d}function i(c,f,d=0,h=c.length){if(d<h){if(t(f,f)!==0)return h;do{const m=d+h>>>1;r(c[m],f)<=0?d=m+1:h=m}while(d<h)}return d}function s(c,f,d=0,h=c.length){const m=a(c,f,d,h-1);return m>d&&n(c[m-1],f)>-n(c[m],f)?m-1:m}return{left:a,center:s,right:i}}function ZR(){return 0}function ZC(e){return e===null?NaN:+e}function*eL(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const tL=X1(Ls),jf=tL.right;X1(ZC).center;class L_ extends Map{constructor(t,r=aL){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(B_(this,t))}has(t){return super.has(B_(this,t))}set(t,r){return super.set(rL(this,t),r)}delete(t){return super.delete(nL(this,t))}}function B_({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function rL({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function nL({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function aL(e){return e!==null&&typeof e=="object"?e.valueOf():e}function iL(e=Ls){if(e===Ls)return eA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function eA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const sL=Math.sqrt(50),oL=Math.sqrt(10),lL=Math.sqrt(2);function J0(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=sL?10:i>=oL?5:i>=lL?2:1;let c,f,d;return a<0?(d=Math.pow(10,-a)/s,c=Math.round(e*d),f=Math.round(t*d),c/d<e&&++c,f/d>t&&--f,d=-d):(d=Math.pow(10,a)*s,c=Math.round(e/d),f=Math.round(t/d),c*d<e&&++c,f*d>t&&--f),f<c&&.5<=r&&r<2?J0(e,t,r*2):[c,f,d]}function Dv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?J0(t,e,r):J0(e,t,r);if(!(i>=a))return[];const c=i-a+1,f=new Array(c);if(n)if(s<0)for(let d=0;d<c;++d)f[d]=(i-d)/-s;else for(let d=0;d<c;++d)f[d]=(i-d)*s;else if(s<0)for(let d=0;d<c;++d)f[d]=(a+d)/-s;else for(let d=0;d<c;++d)f[d]=(a+d)*s;return f}function Iv(e,t,r){return t=+t,e=+e,r=+r,J0(e,t,r)[2]}function Mv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Iv(t,e,r):Iv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function $_(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function U_(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function tA(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?eA:iL(a);n>r;){if(n-r>600){const f=n-r+1,d=t-r+1,h=Math.log(f),m=.5*Math.exp(2*h/3),x=.5*Math.sqrt(h*m*(f-m)/f)*(d-f/2<0?-1:1),g=Math.max(r,Math.floor(t-d*m/f+x)),y=Math.min(n,Math.floor(t+(f-d)*m/f+x));tA(e,t,g,y,a)}const i=e[t];let s=r,c=n;for(Su(e,r,t),a(e[n],i)>0&&Su(e,r,n);s<c;){for(Su(e,s,c),++s,--c;a(e[s],i)<0;)++s;for(;a(e[c],i)>0;)--c}a(e[r],i)===0?Su(e,r,c):(++c,Su(e,c,n)),c<=t&&(r=c+1),t<=c&&(n=c-1)}return e}function Su(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function cL(e,t,r){if(e=Float64Array.from(eL(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return U_(e);if(t>=1)return $_(e);var n,a=(n-1)*t,i=Math.floor(a),s=$_(tA(e,i).subarray(0,i+1)),c=U_(e.subarray(i+1));return s+(c-s)*(a-i)}}function uL(e,t,r=ZC){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),c=+r(e[i+1],i+1,e);return s+(c-s)*(a-i)}}function fL(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function $a(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ns(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Rv=Symbol("implicit");function q1(){var e=new L_,t=[],r=[],n=Rv;function a(i){let s=e.get(i);if(s===void 0){if(n!==Rv)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new L_;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return q1(t,r).unknown(n)},$a.apply(a,arguments),a}function Y1(){var e=q1().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,c=!1,f=0,d=0,h=.5;delete e.unknown;function m(){var x=t().length,g=a<n,y=g?a:n,v=g?n:a;i=(v-y)/Math.max(1,x-f+d*2),c&&(i=Math.floor(i)),y+=(v-y-i*(x-f))*h,s=i*(1-f),c&&(y=Math.round(y),s=Math.round(s));var b=fL(x).map(function(N){return y+i*N});return r(g?b.reverse():b)}return e.domain=function(x){return arguments.length?(t(x),m()):t()},e.range=function(x){return arguments.length?([n,a]=x,n=+n,a=+a,m()):[n,a]},e.rangeRound=function(x){return[n,a]=x,n=+n,a=+a,c=!0,m()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(x){return arguments.length?(c=!!x,m()):c},e.padding=function(x){return arguments.length?(f=Math.min(1,d=+x),m()):f},e.paddingInner=function(x){return arguments.length?(f=Math.min(1,x),m()):f},e.paddingOuter=function(x){return arguments.length?(d=+x,m()):d},e.align=function(x){return arguments.length?(h=Math.max(0,Math.min(1,x)),m()):h},e.copy=function(){return Y1(t(),[n,a]).round(c).paddingInner(f).paddingOuter(d).align(h)},$a.apply(m(),arguments)}function rA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return rA(t())},e}function dL(){return rA(Y1.apply(null,arguments).paddingInner(1))}function J1(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function nA(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Cf(){}var Qu=.7,Q0=1/Qu,Ql="\\s*([+-]?\\d+)\\s*",Zu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",vi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hL=/^#([0-9a-f]{3,8})$/,mL=new RegExp(`^rgb\\(${Ql},${Ql},${Ql}\\)$`),pL=new RegExp(`^rgb\\(${vi},${vi},${vi}\\)$`),xL=new RegExp(`^rgba\\(${Ql},${Ql},${Ql},${Zu}\\)$`),gL=new RegExp(`^rgba\\(${vi},${vi},${vi},${Zu}\\)$`),vL=new RegExp(`^hsl\\(${Zu},${vi},${vi}\\)$`),yL=new RegExp(`^hsla\\(${Zu},${vi},${vi},${Zu}\\)$`),z_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};J1(Cf,ef,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:W_,formatHex:W_,formatHex8:wL,formatHsl:bL,formatRgb:H_,toString:H_});function W_(){return this.rgb().formatHex()}function wL(){return this.rgb().formatHex8()}function bL(){return aA(this).formatHsl()}function H_(){return this.rgb().formatRgb()}function ef(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=hL.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?V_(t):r===3?new Xn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?u0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?u0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mL.exec(e))?new Xn(t[1],t[2],t[3],1):(t=pL.exec(e))?new Xn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=xL.exec(e))?u0(t[1],t[2],t[3],t[4]):(t=gL.exec(e))?u0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=vL.exec(e))?X_(t[1],t[2]/100,t[3]/100,1):(t=yL.exec(e))?X_(t[1],t[2]/100,t[3]/100,t[4]):z_.hasOwnProperty(e)?V_(z_[e]):e==="transparent"?new Xn(NaN,NaN,NaN,0):null}function V_(e){return new Xn(e>>16&255,e>>8&255,e&255,1)}function u0(e,t,r,n){return n<=0&&(e=t=r=NaN),new Xn(e,t,r,n)}function SL(e){return e instanceof Cf||(e=ef(e)),e?(e=e.rgb(),new Xn(e.r,e.g,e.b,e.opacity)):new Xn}function Lv(e,t,r,n){return arguments.length===1?SL(e):new Xn(e,t,r,n??1)}function Xn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}J1(Xn,Lv,nA(Cf,{brighter(e){return e=e==null?Q0:Math.pow(Q0,e),new Xn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Qu:Math.pow(Qu,e),new Xn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Xn(Mo(this.r),Mo(this.g),Mo(this.b),Z0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:K_,formatHex:K_,formatHex8:NL,formatRgb:G_,toString:G_}));function K_(){return`#${To(this.r)}${To(this.g)}${To(this.b)}`}function NL(){return`#${To(this.r)}${To(this.g)}${To(this.b)}${To((isNaN(this.opacity)?1:this.opacity)*255)}`}function G_(){const e=Z0(this.opacity);return`${e===1?"rgb(":"rgba("}${Mo(this.r)}, ${Mo(this.g)}, ${Mo(this.b)}${e===1?")":`, ${e})`}`}function Z0(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Mo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function To(e){return e=Mo(e),(e<16?"0":"")+e.toString(16)}function X_(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Qa(e,t,r,n)}function aA(e){if(e instanceof Qa)return new Qa(e.h,e.s,e.l,e.opacity);if(e instanceof Cf||(e=ef(e)),!e)return new Qa;if(e instanceof Qa)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,c=i-a,f=(i+a)/2;return c?(t===i?s=(r-n)/c+(r<n)*6:r===i?s=(n-t)/c+2:s=(t-r)/c+4,c/=f<.5?i+a:2-i-a,s*=60):c=f>0&&f<1?0:s,new Qa(s,c,f,e.opacity)}function _L(e,t,r,n){return arguments.length===1?aA(e):new Qa(e,t,r,n??1)}function Qa(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}J1(Qa,_L,nA(Cf,{brighter(e){return e=e==null?Q0:Math.pow(Q0,e),new Qa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Qu:Math.pow(Qu,e),new Qa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Xn(bg(e>=240?e-240:e+120,a,n),bg(e,a,n),bg(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Qa(q_(this.h),f0(this.s),f0(this.l),Z0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Z0(this.opacity);return`${e===1?"hsl(":"hsla("}${q_(this.h)}, ${f0(this.s)*100}%, ${f0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function q_(e){return e=(e||0)%360,e<0?e+360:e}function f0(e){return Math.max(0,Math.min(1,e||0))}function bg(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Q1=e=>()=>e;function EL(e,t){return function(r){return e+r*t}}function kL(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function jL(e){return(e=+e)==1?iA:function(t,r){return r-t?kL(t,r,e):Q1(isNaN(t)?r:t)}}function iA(e,t){var r=t-e;return r?EL(e,r):Q1(isNaN(e)?t:e)}const Y_=(function e(t){var r=jL(t);function n(a,i){var s=r((a=Lv(a)).r,(i=Lv(i)).r),c=r(a.g,i.g),f=r(a.b,i.b),d=iA(a.opacity,i.opacity);return function(h){return a.r=s(h),a.g=c(h),a.b=f(h),a.opacity=d(h),a+""}}return n.gamma=e,n})(1);function CL(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function AL(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function TL(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=bc(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(c){for(s=0;s<n;++s)i[s]=a[s](c);return i}}function PL(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function eh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function OL(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=bc(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Bv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sg=new RegExp(Bv.source,"g");function FL(e){return function(){return e}}function DL(e){return function(t){return e(t)+""}}function IL(e,t){var r=Bv.lastIndex=Sg.lastIndex=0,n,a,i,s=-1,c=[],f=[];for(e=e+"",t=t+"";(n=Bv.exec(e))&&(a=Sg.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),c[s]?c[s]+=i:c[++s]=i),(n=n[0])===(a=a[0])?c[s]?c[s]+=a:c[++s]=a:(c[++s]=null,f.push({i:s,x:eh(n,a)})),r=Sg.lastIndex;return r<t.length&&(i=t.slice(r),c[s]?c[s]+=i:c[++s]=i),c.length<2?f[0]?DL(f[0].x):FL(t):(t=f.length,function(d){for(var h=0,m;h<t;++h)c[(m=f[h]).i]=m.x(d);return c.join("")})}function bc(e,t){var r=typeof t,n;return t==null||r==="boolean"?Q1(t):(r==="number"?eh:r==="string"?(n=ef(t))?(t=n,Y_):IL:t instanceof ef?Y_:t instanceof Date?PL:AL(t)?CL:Array.isArray(t)?TL:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?OL:eh)(e,t)}function Z1(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function ML(e,t){t===void 0&&(t=e,e=bc);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var c=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[c](s-c)}}function RL(e){return function(){return e}}function th(e){return+e}var J_=[0,1];function Dn(e){return e}function $v(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:RL(isNaN(t)?NaN:.5)}function LL(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function BL(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=$v(a,n),i=r(s,i)):(n=$v(n,a),i=r(i,s)),function(c){return i(n(c))}}function $L(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=$v(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(c){var f=jf(e,c,1,n)-1;return i[f](a[f](c))}}function Af(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function em(){var e=J_,t=J_,r=bc,n,a,i,s=Dn,c,f,d;function h(){var x=Math.min(e.length,t.length);return s!==Dn&&(s=LL(e[0],e[x-1])),c=x>2?$L:BL,f=d=null,m}function m(x){return x==null||isNaN(x=+x)?i:(f||(f=c(e.map(n),t,r)))(n(s(x)))}return m.invert=function(x){return s(a((d||(d=c(t,e.map(n),eh)))(x)))},m.domain=function(x){return arguments.length?(e=Array.from(x,th),h()):e.slice()},m.range=function(x){return arguments.length?(t=Array.from(x),h()):t.slice()},m.rangeRound=function(x){return t=Array.from(x),r=Z1,h()},m.clamp=function(x){return arguments.length?(s=x?!0:Dn,h()):s!==Dn},m.interpolate=function(x){return arguments.length?(r=x,h()):r},m.unknown=function(x){return arguments.length?(i=x,m):i},function(x,g){return n=x,a=g,h()}}function ey(){return em()(Dn,Dn)}function UL(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function rh(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function cc(e){return e=rh(Math.abs(e)),e?e[1]:NaN}function zL(e,t){return function(r,n){for(var a=r.length,i=[],s=0,c=e[0],f=0;a>0&&c>0&&(f+c+1>n&&(c=Math.max(1,n-f)),i.push(r.substring(a-=c,a+c)),!((f+=c+1)>n));)c=e[s=(s+1)%e.length];return i.reverse().join(t)}}function WL(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var HL=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tf(e){if(!(t=HL.exec(e)))throw new Error("invalid format: "+e);var t;return new ty({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}tf.prototype=ty.prototype;function ty(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ty.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function VL(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var sA;function KL(e,t){var r=rh(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(sA=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+rh(e,Math.max(0,t+i-1))[0]}function Q_(e,t){var r=rh(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const Z_={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:UL,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Q_(e*100,t),r:Q_,s:KL,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function eE(e){return e}var tE=Array.prototype.map,rE=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function GL(e){var t=e.grouping===void 0||e.thousands===void 0?eE:zL(tE.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?eE:WL(tE.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function d(m){m=tf(m);var x=m.fill,g=m.align,y=m.sign,v=m.symbol,b=m.zero,N=m.width,E=m.comma,S=m.precision,C=m.trim,T=m.type;T==="n"?(E=!0,T="g"):Z_[T]||(S===void 0&&(S=12),C=!0,T="g"),(b||x==="0"&&g==="=")&&(b=!0,x="0",g="=");var k=v==="$"?r:v==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",P=v==="$"?n:/[%p]/.test(T)?s:"",D=Z_[T],R=/[defgprs%]/.test(T);S=S===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function q(M){var z=k,ie=P,ce,ae,me;if(T==="c")ie=D(M)+ie,M="";else{M=+M;var de=M<0||1/M<0;if(M=isNaN(M)?f:D(Math.abs(M),S),C&&(M=VL(M)),de&&+M==0&&y!=="+"&&(de=!1),z=(de?y==="("?y:c:y==="-"||y==="("?"":y)+z,ie=(T==="s"?rE[8+sA/3]:"")+ie+(de&&y==="("?")":""),R){for(ce=-1,ae=M.length;++ce<ae;)if(me=M.charCodeAt(ce),48>me||me>57){ie=(me===46?a+M.slice(ce+1):M.slice(ce))+ie,M=M.slice(0,ce);break}}}E&&!b&&(M=t(M,1/0));var he=z.length+M.length+ie.length,J=he<N?new Array(N-he+1).join(x):"";switch(E&&b&&(M=t(J+M,J.length?N-ie.length:1/0),J=""),g){case"<":M=z+M+ie+J;break;case"=":M=z+J+M+ie;break;case"^":M=J.slice(0,he=J.length>>1)+z+M+ie+J.slice(he);break;default:M=J+z+M+ie;break}return i(M)}return q.toString=function(){return m+""},q}function h(m,x){var g=d((m=tf(m),m.type="f",m)),y=Math.max(-8,Math.min(8,Math.floor(cc(x)/3)))*3,v=Math.pow(10,-y),b=rE[8+y/3];return function(N){return g(v*N)+b}}return{format:d,formatPrefix:h}}var d0,ry,oA;XL({thousands:",",grouping:[3],currency:["$",""]});function XL(e){return d0=GL(e),ry=d0.format,oA=d0.formatPrefix,d0}function qL(e){return Math.max(0,-cc(Math.abs(e)))}function YL(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(cc(t)/3)))*3-cc(Math.abs(e)))}function JL(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,cc(t)-cc(e))+1}function lA(e,t,r,n){var a=Mv(e,t,r),i;switch(n=tf(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=YL(a,s))&&(n.precision=i),oA(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=JL(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=qL(a))&&(n.precision=i-(n.type==="%")*2);break}}return ry(n)}function eo(e){var t=e.domain;return e.ticks=function(r){var n=t();return Dv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return lA(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],c=n[i],f,d,h=10;for(c<s&&(d=s,s=c,c=d,d=a,a=i,i=d);h-- >0;){if(d=Iv(s,c,r),d===f)return n[a]=s,n[i]=c,t(n);if(d>0)s=Math.floor(s/d)*d,c=Math.ceil(c/d)*d;else if(d<0)s=Math.ceil(s*d)/d,c=Math.floor(c*d)/d;else break;f=d}return e},e}function cA(){var e=ey();return e.copy=function(){return Af(e,cA())},$a.apply(e,arguments),eo(e)}function uA(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,th),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return uA(e).unknown(t)},e=arguments.length?Array.from(e,th):[0,1],eo(r)}function fA(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function nE(e){return Math.log(e)}function aE(e){return Math.exp(e)}function QL(e){return-Math.log(-e)}function ZL(e){return-Math.exp(-e)}function e7(e){return isFinite(e)?+("1e"+e):e<0?0:e}function t7(e){return e===10?e7:e===Math.E?Math.exp:t=>Math.pow(e,t)}function r7(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function iE(e){return(t,r)=>-e(-t,r)}function ny(e){const t=e(nE,aE),r=t.domain;let n=10,a,i;function s(){return a=r7(n),i=t7(n),r()[0]<0?(a=iE(a),i=iE(i),e(QL,ZL)):e(nE,aE),t}return t.base=function(c){return arguments.length?(n=+c,s()):n},t.domain=function(c){return arguments.length?(r(c),s()):r()},t.ticks=c=>{const f=r();let d=f[0],h=f[f.length-1];const m=h<d;m&&([d,h]=[h,d]);let x=a(d),g=a(h),y,v;const b=c==null?10:+c;let N=[];if(!(n%1)&&g-x<b){if(x=Math.floor(x),g=Math.ceil(g),d>0){for(;x<=g;++x)for(y=1;y<n;++y)if(v=x<0?y/i(-x):y*i(x),!(v<d)){if(v>h)break;N.push(v)}}else for(;x<=g;++x)for(y=n-1;y>=1;--y)if(v=x>0?y/i(-x):y*i(x),!(v<d)){if(v>h)break;N.push(v)}N.length*2<b&&(N=Dv(d,h,b))}else N=Dv(x,g,Math.min(g-x,b)).map(i);return m?N.reverse():N},t.tickFormat=(c,f)=>{if(c==null&&(c=10),f==null&&(f=n===10?"s":","),typeof f!="function"&&(!(n%1)&&(f=tf(f)).precision==null&&(f.trim=!0),f=ry(f)),c===1/0)return f;const d=Math.max(1,n*c/t.ticks().length);return h=>{let m=h/i(Math.round(a(h)));return m*n<n-.5&&(m*=n),m<=d?f(h):""}},t.nice=()=>r(fA(r(),{floor:c=>i(Math.floor(a(c))),ceil:c=>i(Math.ceil(a(c)))})),t}function dA(){const e=ny(em()).domain([1,10]);return e.copy=()=>Af(e,dA()).base(e.base()),$a.apply(e,arguments),e}function sE(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function oE(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ay(e){var t=1,r=e(sE(t),oE(t));return r.constant=function(n){return arguments.length?e(sE(t=+n),oE(t)):t},eo(r)}function hA(){var e=ay(em());return e.copy=function(){return Af(e,hA()).constant(e.constant())},$a.apply(e,arguments)}function lE(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function n7(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function a7(e){return e<0?-e*e:e*e}function iy(e){var t=e(Dn,Dn),r=1;function n(){return r===1?e(Dn,Dn):r===.5?e(n7,a7):e(lE(r),lE(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},eo(t)}function sy(){var e=iy(em());return e.copy=function(){return Af(e,sy()).exponent(e.exponent())},$a.apply(e,arguments),e}function i7(){return sy.apply(null,arguments).exponent(.5)}function cE(e){return Math.sign(e)*e*e}function s7(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function mA(){var e=ey(),t=[0,1],r=!1,n;function a(i){var s=s7(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(cE(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,th)).map(cE)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return mA(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},$a.apply(a,arguments),eo(a)}function pA(){var e=[],t=[],r=[],n;function a(){var s=0,c=Math.max(1,t.length);for(r=new Array(c-1);++s<c;)r[s-1]=uL(e,s/c);return i}function i(s){return s==null||isNaN(s=+s)?n:t[jf(r,s)]}return i.invertExtent=function(s){var c=t.indexOf(s);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let c of s)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(Ls),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return pA().domain(e).range(t).unknown(n)},$a.apply(i,arguments)}function xA(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(f){return f!=null&&f<=f?a[jf(n,f,0,r)]:i}function c(){var f=-1;for(n=new Array(r);++f<r;)n[f]=((f+1)*t-(f-r)*e)/(r+1);return s}return s.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,c()):[e,t]},s.range=function(f){return arguments.length?(r=(a=Array.from(f)).length-1,c()):a.slice()},s.invertExtent=function(f){var d=a.indexOf(f);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},s.unknown=function(f){return arguments.length&&(i=f),s},s.thresholds=function(){return n.slice()},s.copy=function(){return xA().domain([e,t]).range(a).unknown(i)},$a.apply(eo(s),arguments)}function gA(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[jf(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return gA().domain(e).range(t).unknown(r)},$a.apply(a,arguments)}const Ng=new Date,_g=new Date;function Rr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),c=a.ceil(i);return i-s<c-i?s:c},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,c)=>{const f=[];if(i=a.ceil(i),c=c==null?1:Math.floor(c),!(i<s)||!(c>0))return f;let d;do f.push(d=new Date(+i)),t(i,c),e(i);while(d<i&&i<s);return f},a.filter=i=>Rr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,c)=>{if(s>=s)if(c<0)for(;++c<=0;)for(;t(s,-1),!i(s););else for(;--c>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Ng.setTime(+i),_g.setTime(+s),e(Ng),e(_g),Math.floor(r(Ng,_g))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const nh=Rr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);nh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Rr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):nh);nh.range;const $i=1e3,Da=$i*60,Ui=Da*60,Ji=Ui*24,oy=Ji*7,uE=Ji*30,Eg=Ji*365,Po=Rr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*$i)},(e,t)=>(t-e)/$i,e=>e.getUTCSeconds());Po.range;const ly=Rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$i)},(e,t)=>{e.setTime(+e+t*Da)},(e,t)=>(t-e)/Da,e=>e.getMinutes());ly.range;const cy=Rr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Da)},(e,t)=>(t-e)/Da,e=>e.getUTCMinutes());cy.range;const uy=Rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$i-e.getMinutes()*Da)},(e,t)=>{e.setTime(+e+t*Ui)},(e,t)=>(t-e)/Ui,e=>e.getHours());uy.range;const fy=Rr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ui)},(e,t)=>(t-e)/Ui,e=>e.getUTCHours());fy.range;const Tf=Rr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Da)/Ji,e=>e.getDate()-1);Tf.range;const tm=Rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ji,e=>e.getUTCDate()-1);tm.range;const vA=Rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ji,e=>Math.floor(e/Ji));vA.range;function sl(e){return Rr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Da)/oy)}const rm=sl(0),ah=sl(1),o7=sl(2),l7=sl(3),uc=sl(4),c7=sl(5),u7=sl(6);rm.range;ah.range;o7.range;l7.range;uc.range;c7.range;u7.range;function ol(e){return Rr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/oy)}const nm=ol(0),ih=ol(1),f7=ol(2),d7=ol(3),fc=ol(4),h7=ol(5),m7=ol(6);nm.range;ih.range;f7.range;d7.range;fc.range;h7.range;m7.range;const dy=Rr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());dy.range;const hy=Rr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());hy.range;const Qi=Rr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Qi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Rr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Qi.range;const Zi=Rr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Zi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Rr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Zi.range;function yA(e,t,r,n,a,i){const s=[[Po,1,$i],[Po,5,5*$i],[Po,15,15*$i],[Po,30,30*$i],[i,1,Da],[i,5,5*Da],[i,15,15*Da],[i,30,30*Da],[a,1,Ui],[a,3,3*Ui],[a,6,6*Ui],[a,12,12*Ui],[n,1,Ji],[n,2,2*Ji],[r,1,oy],[t,1,uE],[t,3,3*uE],[e,1,Eg]];function c(d,h,m){const x=h<d;x&&([d,h]=[h,d]);const g=m&&typeof m.range=="function"?m:f(d,h,m),y=g?g.range(d,+h+1):[];return x?y.reverse():y}function f(d,h,m){const x=Math.abs(h-d)/m,g=X1(([,,b])=>b).right(s,x);if(g===s.length)return e.every(Mv(d/Eg,h/Eg,m));if(g===0)return nh.every(Math.max(Mv(d,h,m),1));const[y,v]=s[x/s[g-1][2]<s[g][2]/x?g-1:g];return y.every(v)}return[c,f]}const[p7,x7]=yA(Zi,hy,nm,vA,fy,cy),[g7,v7]=yA(Qi,dy,rm,Tf,uy,ly);function kg(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function jg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Nu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function y7(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,c=e.months,f=e.shortMonths,d=_u(a),h=Eu(a),m=_u(i),x=Eu(i),g=_u(s),y=Eu(s),v=_u(c),b=Eu(c),N=_u(f),E=Eu(f),S={a:de,A:he,b:J,B:xe,c:null,d:xE,e:xE,f:z7,g:Q7,G:e9,H:B7,I:$7,j:U7,L:wA,m:W7,M:H7,p:te,q:O,Q:yE,s:wE,S:V7,u:K7,U:G7,V:X7,w:q7,W:Y7,x:null,X:null,y:J7,Y:Z7,Z:t9,"%":vE},C={a:K,A:W,b:X,B:V,c:null,d:gE,e:gE,f:i9,g:p9,G:g9,H:r9,I:n9,j:a9,L:SA,m:s9,M:o9,p:ne,q:L,Q:yE,s:wE,S:l9,u:c9,U:u9,V:f9,w:d9,W:h9,x:null,X:null,y:m9,Y:x9,Z:v9,"%":vE},T={a:q,A:M,b:z,B:ie,c:ce,d:mE,e:mE,f:I7,g:hE,G:dE,H:pE,I:pE,j:P7,L:D7,m:T7,M:O7,p:R,q:A7,Q:R7,s:L7,S:F7,u:_7,U:E7,V:k7,w:N7,W:j7,x:ae,X:me,y:hE,Y:dE,Z:C7,"%":M7};S.x=k(r,S),S.X=k(n,S),S.c=k(t,S),C.x=k(r,C),C.X=k(n,C),C.c=k(t,C);function k(U,H){return function(oe){var F=[],Ae=-1,je=0,Le=U.length,Ue,Pe,ot;for(oe instanceof Date||(oe=new Date(+oe));++Ae<Le;)U.charCodeAt(Ae)===37&&(F.push(U.slice(je,Ae)),(Pe=fE[Ue=U.charAt(++Ae)])!=null?Ue=U.charAt(++Ae):Pe=Ue==="e"?" ":"0",(ot=H[Ue])&&(Ue=ot(oe,Pe)),F.push(Ue),je=Ae+1);return F.push(U.slice(je,Ae)),F.join("")}}function P(U,H){return function(oe){var F=Nu(1900,void 0,1),Ae=D(F,U,oe+="",0),je,Le;if(Ae!=oe.length)return null;if("Q"in F)return new Date(F.Q);if("s"in F)return new Date(F.s*1e3+("L"in F?F.L:0));if(H&&!("Z"in F)&&(F.Z=0),"p"in F&&(F.H=F.H%12+F.p*12),F.m===void 0&&(F.m="q"in F?F.q:0),"V"in F){if(F.V<1||F.V>53)return null;"w"in F||(F.w=1),"Z"in F?(je=jg(Nu(F.y,0,1)),Le=je.getUTCDay(),je=Le>4||Le===0?ih.ceil(je):ih(je),je=tm.offset(je,(F.V-1)*7),F.y=je.getUTCFullYear(),F.m=je.getUTCMonth(),F.d=je.getUTCDate()+(F.w+6)%7):(je=kg(Nu(F.y,0,1)),Le=je.getDay(),je=Le>4||Le===0?ah.ceil(je):ah(je),je=Tf.offset(je,(F.V-1)*7),F.y=je.getFullYear(),F.m=je.getMonth(),F.d=je.getDate()+(F.w+6)%7)}else("W"in F||"U"in F)&&("w"in F||(F.w="u"in F?F.u%7:"W"in F?1:0),Le="Z"in F?jg(Nu(F.y,0,1)).getUTCDay():kg(Nu(F.y,0,1)).getDay(),F.m=0,F.d="W"in F?(F.w+6)%7+F.W*7-(Le+5)%7:F.w+F.U*7-(Le+6)%7);return"Z"in F?(F.H+=F.Z/100|0,F.M+=F.Z%100,jg(F)):kg(F)}}function D(U,H,oe,F){for(var Ae=0,je=H.length,Le=oe.length,Ue,Pe;Ae<je;){if(F>=Le)return-1;if(Ue=H.charCodeAt(Ae++),Ue===37){if(Ue=H.charAt(Ae++),Pe=T[Ue in fE?H.charAt(Ae++):Ue],!Pe||(F=Pe(U,oe,F))<0)return-1}else if(Ue!=oe.charCodeAt(F++))return-1}return F}function R(U,H,oe){var F=d.exec(H.slice(oe));return F?(U.p=h.get(F[0].toLowerCase()),oe+F[0].length):-1}function q(U,H,oe){var F=g.exec(H.slice(oe));return F?(U.w=y.get(F[0].toLowerCase()),oe+F[0].length):-1}function M(U,H,oe){var F=m.exec(H.slice(oe));return F?(U.w=x.get(F[0].toLowerCase()),oe+F[0].length):-1}function z(U,H,oe){var F=N.exec(H.slice(oe));return F?(U.m=E.get(F[0].toLowerCase()),oe+F[0].length):-1}function ie(U,H,oe){var F=v.exec(H.slice(oe));return F?(U.m=b.get(F[0].toLowerCase()),oe+F[0].length):-1}function ce(U,H,oe){return D(U,t,H,oe)}function ae(U,H,oe){return D(U,r,H,oe)}function me(U,H,oe){return D(U,n,H,oe)}function de(U){return s[U.getDay()]}function he(U){return i[U.getDay()]}function J(U){return f[U.getMonth()]}function xe(U){return c[U.getMonth()]}function te(U){return a[+(U.getHours()>=12)]}function O(U){return 1+~~(U.getMonth()/3)}function K(U){return s[U.getUTCDay()]}function W(U){return i[U.getUTCDay()]}function X(U){return f[U.getUTCMonth()]}function V(U){return c[U.getUTCMonth()]}function ne(U){return a[+(U.getUTCHours()>=12)]}function L(U){return 1+~~(U.getUTCMonth()/3)}return{format:function(U){var H=k(U+="",S);return H.toString=function(){return U},H},parse:function(U){var H=P(U+="",!1);return H.toString=function(){return U},H},utcFormat:function(U){var H=k(U+="",C);return H.toString=function(){return U},H},utcParse:function(U){var H=P(U+="",!0);return H.toString=function(){return U},H}}}var fE={"-":"",_:" ",0:"0"},Qr=/^\s*\d+/,w7=/^%/,b7=/[\\^$*+?|[\]().{}]/g;function _t(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function S7(e){return e.replace(b7,"\\$&")}function _u(e){return new RegExp("^(?:"+e.map(S7).join("|")+")","i")}function Eu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function N7(e,t,r){var n=Qr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function _7(e,t,r){var n=Qr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function E7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function k7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function j7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function dE(e,t,r){var n=Qr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function hE(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function C7(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function A7(e,t,r){var n=Qr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function T7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function mE(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function P7(e,t,r){var n=Qr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function pE(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function O7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function F7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function D7(e,t,r){var n=Qr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function I7(e,t,r){var n=Qr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function M7(e,t,r){var n=w7.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function R7(e,t,r){var n=Qr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function L7(e,t,r){var n=Qr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function xE(e,t){return _t(e.getDate(),t,2)}function B7(e,t){return _t(e.getHours(),t,2)}function $7(e,t){return _t(e.getHours()%12||12,t,2)}function U7(e,t){return _t(1+Tf.count(Qi(e),e),t,3)}function wA(e,t){return _t(e.getMilliseconds(),t,3)}function z7(e,t){return wA(e,t)+"000"}function W7(e,t){return _t(e.getMonth()+1,t,2)}function H7(e,t){return _t(e.getMinutes(),t,2)}function V7(e,t){return _t(e.getSeconds(),t,2)}function K7(e){var t=e.getDay();return t===0?7:t}function G7(e,t){return _t(rm.count(Qi(e)-1,e),t,2)}function bA(e){var t=e.getDay();return t>=4||t===0?uc(e):uc.ceil(e)}function X7(e,t){return e=bA(e),_t(uc.count(Qi(e),e)+(Qi(e).getDay()===4),t,2)}function q7(e){return e.getDay()}function Y7(e,t){return _t(ah.count(Qi(e)-1,e),t,2)}function J7(e,t){return _t(e.getFullYear()%100,t,2)}function Q7(e,t){return e=bA(e),_t(e.getFullYear()%100,t,2)}function Z7(e,t){return _t(e.getFullYear()%1e4,t,4)}function e9(e,t){var r=e.getDay();return e=r>=4||r===0?uc(e):uc.ceil(e),_t(e.getFullYear()%1e4,t,4)}function t9(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_t(t/60|0,"0",2)+_t(t%60,"0",2)}function gE(e,t){return _t(e.getUTCDate(),t,2)}function r9(e,t){return _t(e.getUTCHours(),t,2)}function n9(e,t){return _t(e.getUTCHours()%12||12,t,2)}function a9(e,t){return _t(1+tm.count(Zi(e),e),t,3)}function SA(e,t){return _t(e.getUTCMilliseconds(),t,3)}function i9(e,t){return SA(e,t)+"000"}function s9(e,t){return _t(e.getUTCMonth()+1,t,2)}function o9(e,t){return _t(e.getUTCMinutes(),t,2)}function l9(e,t){return _t(e.getUTCSeconds(),t,2)}function c9(e){var t=e.getUTCDay();return t===0?7:t}function u9(e,t){return _t(nm.count(Zi(e)-1,e),t,2)}function NA(e){var t=e.getUTCDay();return t>=4||t===0?fc(e):fc.ceil(e)}function f9(e,t){return e=NA(e),_t(fc.count(Zi(e),e)+(Zi(e).getUTCDay()===4),t,2)}function d9(e){return e.getUTCDay()}function h9(e,t){return _t(ih.count(Zi(e)-1,e),t,2)}function m9(e,t){return _t(e.getUTCFullYear()%100,t,2)}function p9(e,t){return e=NA(e),_t(e.getUTCFullYear()%100,t,2)}function x9(e,t){return _t(e.getUTCFullYear()%1e4,t,4)}function g9(e,t){var r=e.getUTCDay();return e=r>=4||r===0?fc(e):fc.ceil(e),_t(e.getUTCFullYear()%1e4,t,4)}function v9(){return"+0000"}function vE(){return"%"}function yE(e){return+e}function wE(e){return Math.floor(+e/1e3)}var Bl,_A,EA;y9({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function y9(e){return Bl=y7(e),_A=Bl.format,Bl.parse,EA=Bl.utcFormat,Bl.utcParse,Bl}function w9(e){return new Date(e)}function b9(e){return e instanceof Date?+e:+new Date(+e)}function my(e,t,r,n,a,i,s,c,f,d){var h=ey(),m=h.invert,x=h.domain,g=d(".%L"),y=d(":%S"),v=d("%I:%M"),b=d("%I %p"),N=d("%a %d"),E=d("%b %d"),S=d("%B"),C=d("%Y");function T(k){return(f(k)<k?g:c(k)<k?y:s(k)<k?v:i(k)<k?b:n(k)<k?a(k)<k?N:E:r(k)<k?S:C)(k)}return h.invert=function(k){return new Date(m(k))},h.domain=function(k){return arguments.length?x(Array.from(k,b9)):x().map(w9)},h.ticks=function(k){var P=x();return e(P[0],P[P.length-1],k??10)},h.tickFormat=function(k,P){return P==null?T:d(P)},h.nice=function(k){var P=x();return(!k||typeof k.range!="function")&&(k=t(P[0],P[P.length-1],k??10)),k?x(fA(P,k)):h},h.copy=function(){return Af(h,my(e,t,r,n,a,i,s,c,f,d))},h}function S9(){return $a.apply(my(g7,v7,Qi,dy,rm,Tf,uy,ly,Po,_A).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function N9(){return $a.apply(my(p7,x7,Zi,hy,nm,tm,fy,cy,Po,EA).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function am(){var e=0,t=1,r,n,a,i,s=Dn,c=!1,f;function d(m){return m==null||isNaN(m=+m)?f:s(a===0?.5:(m=(i(m)-r)*a,c?Math.max(0,Math.min(1,m)):m))}d.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(m){return arguments.length?(c=!!m,d):c},d.interpolator=function(m){return arguments.length?(s=m,d):s};function h(m){return function(x){var g,y;return arguments.length?([g,y]=x,s=m(g,y),d):[s(0),s(1)]}}return d.range=h(bc),d.rangeRound=h(Z1),d.unknown=function(m){return arguments.length?(f=m,d):f},function(m){return i=m,r=m(e),n=m(t),a=r===n?0:1/(n-r),d}}function to(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function kA(){var e=eo(am()(Dn));return e.copy=function(){return to(e,kA())},ns.apply(e,arguments)}function jA(){var e=ny(am()).domain([1,10]);return e.copy=function(){return to(e,jA()).base(e.base())},ns.apply(e,arguments)}function CA(){var e=ay(am());return e.copy=function(){return to(e,CA()).constant(e.constant())},ns.apply(e,arguments)}function py(){var e=iy(am());return e.copy=function(){return to(e,py()).exponent(e.exponent())},ns.apply(e,arguments)}function _9(){return py.apply(null,arguments).exponent(.5)}function AA(){var e=[],t=Dn;function r(n){if(n!=null&&!isNaN(n=+n))return t((jf(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ls),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>cL(e,i/n))},r.copy=function(){return AA(t).domain(e)},ns.apply(r,arguments)}function im(){var e=0,t=.5,r=1,n=1,a,i,s,c,f,d=Dn,h,m=!1,x;function g(v){return isNaN(v=+v)?x:(v=.5+((v=+h(v))-i)*(n*v<n*i?c:f),d(m?Math.max(0,Math.min(1,v)):v))}g.domain=function(v){return arguments.length?([e,t,r]=v,a=h(e=+e),i=h(t=+t),s=h(r=+r),c=a===i?0:.5/(i-a),f=i===s?0:.5/(s-i),n=i<a?-1:1,g):[e,t,r]},g.clamp=function(v){return arguments.length?(m=!!v,g):m},g.interpolator=function(v){return arguments.length?(d=v,g):d};function y(v){return function(b){var N,E,S;return arguments.length?([N,E,S]=b,d=ML(v,[N,E,S]),g):[d(0),d(.5),d(1)]}}return g.range=y(bc),g.rangeRound=y(Z1),g.unknown=function(v){return arguments.length?(x=v,g):x},function(v){return h=v,a=v(e),i=v(t),s=v(r),c=a===i?0:.5/(i-a),f=i===s?0:.5/(s-i),n=i<a?-1:1,g}}function TA(){var e=eo(im()(Dn));return e.copy=function(){return to(e,TA())},ns.apply(e,arguments)}function PA(){var e=ny(im()).domain([.1,1,10]);return e.copy=function(){return to(e,PA()).base(e.base())},ns.apply(e,arguments)}function OA(){var e=ay(im());return e.copy=function(){return to(e,OA()).constant(e.constant())},ns.apply(e,arguments)}function xy(){var e=iy(im());return e.copy=function(){return to(e,xy()).exponent(e.exponent())},ns.apply(e,arguments)}function E9(){return xy.apply(null,arguments).exponent(.5)}const Tu=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Y1,scaleDiverging:TA,scaleDivergingLog:PA,scaleDivergingPow:xy,scaleDivergingSqrt:E9,scaleDivergingSymlog:OA,scaleIdentity:uA,scaleImplicit:Rv,scaleLinear:cA,scaleLog:dA,scaleOrdinal:q1,scalePoint:dL,scalePow:sy,scaleQuantile:pA,scaleQuantize:xA,scaleRadial:mA,scaleSequential:kA,scaleSequentialLog:jA,scaleSequentialPow:py,scaleSequentialQuantile:AA,scaleSequentialSqrt:_9,scaleSequentialSymlog:CA,scaleSqrt:i7,scaleSymlog:hA,scaleThreshold:gA,scaleTime:S9,scaleUtc:N9,tickFormat:lA},Symbol.toStringTag,{value:"Module"}));var ro=e=>e.chartData,gy=Se([ro],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),vy=(e,t,r,n)=>n?gy(e):ro(e);function dc(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(ma(t)&&ma(r))return!0}return!1}function bE(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function k9(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(ma(r))a=r;else if(typeof r=="function")return;if(ma(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(dc(s))return s}}function j9(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(dc(n))return bE(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,c;if(a==="auto")t!=null&&(s=Math.min(...t));else if(et(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t?.[0]))}catch{}else if(typeof a=="string"&&f_.test(a)){var f=f_.exec(a);if(f==null||t==null)s=void 0;else{var d=+f[1];s=t[0]-d}}else s=t?.[0];if(i==="auto")t!=null&&(c=Math.max(...t));else if(et(i))c=i;else if(typeof i=="function")try{t!=null&&(c=i(t?.[1]))}catch{}else if(typeof i=="string"&&d_.test(i)){var h=d_.exec(i);if(h==null||t==null)c=void 0;else{var m=+h[1];c=t[1]+m}}else c=t?.[1];var x=[s,c];if(dc(x))return t==null?x:bE(x,t,r)}}}var Sc=1e9,C9={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},wy,Zt=!0,Ra="[DecimalError] ",Ro=Ra+"Invalid argument: ",yy=Ra+"Exponent out of range: ",Nc=Math.floor,ko=Math.pow,A9=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,oa,Vr=1e7,Kt=7,FA=9007199254740991,sh=Nc(FA/Kt),Xe={};Xe.absoluteValue=Xe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Xe.comparedTo=Xe.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Xe.decimalPlaces=Xe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Kt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Xe.dividedBy=Xe.div=function(e){return Vi(this,new this.constructor(e))};Xe.dividedToIntegerBy=Xe.idiv=function(e){var t=this,r=t.constructor;return $t(Vi(t,new r(e),0,1),r.precision)};Xe.equals=Xe.eq=function(e){return!this.cmp(e)};Xe.exponent=function(){return kr(this)};Xe.greaterThan=Xe.gt=function(e){return this.cmp(e)>0};Xe.greaterThanOrEqualTo=Xe.gte=function(e){return this.cmp(e)>=0};Xe.isInteger=Xe.isint=function(){return this.e>this.d.length-2};Xe.isNegative=Xe.isneg=function(){return this.s<0};Xe.isPositive=Xe.ispos=function(){return this.s>0};Xe.isZero=function(){return this.s===0};Xe.lessThan=Xe.lt=function(e){return this.cmp(e)<0};Xe.lessThanOrEqualTo=Xe.lte=function(e){return this.cmp(e)<1};Xe.logarithm=Xe.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(oa))throw Error(Ra+"NaN");if(r.s<1)throw Error(Ra+(r.s?"NaN":"-Infinity"));return r.eq(oa)?new n(0):(Zt=!1,t=Vi(rf(r,i),rf(e,i),i),Zt=!0,$t(t,a))};Xe.minus=Xe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?MA(t,e):DA(t,(e.s=-e.s,e))};Xe.modulo=Xe.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Ra+"NaN");return r.s?(Zt=!1,t=Vi(r,e,0,1).times(e),Zt=!0,r.minus(t)):$t(new n(r),a)};Xe.naturalExponential=Xe.exp=function(){return IA(this)};Xe.naturalLogarithm=Xe.ln=function(){return rf(this)};Xe.negated=Xe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Xe.plus=Xe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?DA(t,e):MA(t,(e.s=-e.s,e))};Xe.precision=Xe.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ro+e);if(t=kr(a)+1,n=a.d.length-1,r=n*Kt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Xe.squareRoot=Xe.sqrt=function(){var e,t,r,n,a,i,s,c=this,f=c.constructor;if(c.s<1){if(!c.s)return new f(0);throw Error(Ra+"NaN")}for(e=kr(c),Zt=!1,a=Math.sqrt(+c),a==0||a==1/0?(t=xi(c.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Nc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new f(t)):n=new f(a.toString()),r=f.precision,a=s=r+3;;)if(i=n,n=i.plus(Vi(c,i,s+2)).times(.5),xi(i.d).slice(0,s)===(t=xi(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if($t(i,r+1,0),i.times(i).eq(c)){n=i;break}}else if(t!="9999")break;s+=4}return Zt=!0,$t(n,r)};Xe.times=Xe.mul=function(e){var t,r,n,a,i,s,c,f,d,h=this,m=h.constructor,x=h.d,g=(e=new m(e)).d;if(!h.s||!e.s)return new m(0);for(e.s*=h.s,r=h.e+e.e,f=x.length,d=g.length,f<d&&(i=x,x=g,g=i,s=f,f=d,d=s),i=[],s=f+d,n=s;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=f+n;a>n;)c=i[a]+g[n]*x[a-n-1]+t,i[a--]=c%Vr|0,t=c/Vr|0;i[a]=(i[a]+t)%Vr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Zt?$t(e,m.precision):e};Xe.toDecimalPlaces=Xe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Si(e,0,Sc),t===void 0?t=n.rounding:Si(t,0,8),$t(r,e+kr(r)+1,t))};Xe.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Xo(n,!0):(Si(e,0,Sc),t===void 0?t=a.rounding:Si(t,0,8),n=$t(new a(n),e+1,t),r=Xo(n,!0,e+1)),r};Xe.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Xo(a):(Si(e,0,Sc),t===void 0?t=i.rounding:Si(t,0,8),n=$t(new i(a),e+kr(a)+1,t),r=Xo(n.abs(),!1,e+kr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Xe.toInteger=Xe.toint=function(){var e=this,t=e.constructor;return $t(new t(e),kr(e)+1,t.rounding)};Xe.toNumber=function(){return+this};Xe.toPower=Xe.pow=function(e){var t,r,n,a,i,s,c=this,f=c.constructor,d=12,h=+(e=new f(e));if(!e.s)return new f(oa);if(c=new f(c),!c.s){if(e.s<1)throw Error(Ra+"Infinity");return c}if(c.eq(oa))return c;if(n=f.precision,e.eq(oa))return $t(c,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=c.s,s){if((r=h<0?-h:h)<=FA){for(a=new f(oa),t=Math.ceil(n/Kt+4),Zt=!1;r%2&&(a=a.times(c),NE(a.d,t)),r=Nc(r/2),r!==0;)c=c.times(c),NE(c.d,t);return Zt=!0,e.s<0?new f(oa).div(a):$t(a,n)}}else if(i<0)throw Error(Ra+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,c.s=1,Zt=!1,a=e.times(rf(c,n+d)),Zt=!0,a=IA(a),a.s=i,a};Xe.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=kr(a),n=Xo(a,r<=i.toExpNeg||r>=i.toExpPos)):(Si(e,1,Sc),t===void 0?t=i.rounding:Si(t,0,8),a=$t(new i(a),e,t),r=kr(a),n=Xo(a,e<=r||r<=i.toExpNeg,e)),n};Xe.toSignificantDigits=Xe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Si(e,1,Sc),t===void 0?t=n.rounding:Si(t,0,8)),$t(new n(r),e,t)};Xe.toString=Xe.valueOf=Xe.val=Xe.toJSON=Xe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=kr(e),r=e.constructor;return Xo(e,t<=r.toExpNeg||t>=r.toExpPos)};function DA(e,t){var r,n,a,i,s,c,f,d,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),Zt?$t(t,m):t;if(f=e.d,d=t.d,s=e.e,a=t.e,f=f.slice(),i=s-a,i){for(i<0?(n=f,i=-i,c=d.length):(n=d,a=s,c=f.length),s=Math.ceil(m/Kt),c=s>c?s+1:c+1,i>c&&(i=c,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(c=f.length,i=d.length,c-i<0&&(i=c,n=d,d=f,f=n),r=0;i;)r=(f[--i]=f[i]+d[i]+r)/Vr|0,f[i]%=Vr;for(r&&(f.unshift(r),++a),c=f.length;f[--c]==0;)f.pop();return t.d=f,t.e=a,Zt?$t(t,m):t}function Si(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ro+e)}function xi(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Kt-n.length,r&&(i+=Os(r)),i+=n;s=e[t],n=s+"",r=Kt-n.length,r&&(i+=Os(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Vi=(function(){function e(n,a){var i,s=0,c=n.length;for(n=n.slice();c--;)i=n[c]*a+s,n[c]=i%Vr|0,s=i/Vr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var c,f;if(i!=s)f=i>s?1:-1;else for(c=f=0;c<i;c++)if(n[c]!=a[c]){f=n[c]>a[c]?1:-1;break}return f}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*Vr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var c,f,d,h,m,x,g,y,v,b,N,E,S,C,T,k,P,D,R=n.constructor,q=n.s==a.s?1:-1,M=n.d,z=a.d;if(!n.s)return new R(n);if(!a.s)throw Error(Ra+"Division by zero");for(f=n.e-a.e,P=z.length,T=M.length,g=new R(q),y=g.d=[],d=0;z[d]==(M[d]||0);)++d;if(z[d]>(M[d]||0)&&--f,i==null?E=i=R.precision:s?E=i+(kr(n)-kr(a))+1:E=i,E<0)return new R(0);if(E=E/Kt+2|0,d=0,P==1)for(h=0,z=z[0],E++;(d<T||h)&&E--;d++)S=h*Vr+(M[d]||0),y[d]=S/z|0,h=S%z|0;else{for(h=Vr/(z[0]+1)|0,h>1&&(z=e(z,h),M=e(M,h),P=z.length,T=M.length),C=P,v=M.slice(0,P),b=v.length;b<P;)v[b++]=0;D=z.slice(),D.unshift(0),k=z[0],z[1]>=Vr/2&&++k;do h=0,c=t(z,v,P,b),c<0?(N=v[0],P!=b&&(N=N*Vr+(v[1]||0)),h=N/k|0,h>1?(h>=Vr&&(h=Vr-1),m=e(z,h),x=m.length,b=v.length,c=t(m,v,x,b),c==1&&(h--,r(m,P<x?D:z,x))):(h==0&&(c=h=1),m=z.slice()),x=m.length,x<b&&m.unshift(0),r(v,m,b),c==-1&&(b=v.length,c=t(z,v,P,b),c<1&&(h++,r(v,P<b?D:z,b))),b=v.length):c===0&&(h++,v=[0]),y[d++]=h,c&&v[0]?v[b++]=M[C]||0:(v=[M[C]],b=1);while((C++<T||v[0]!==void 0)&&E--)}return y[0]||y.shift(),g.e=f,$t(g,s?i+kr(g)+1:i)}})();function IA(e,t){var r,n,a,i,s,c,f=0,d=0,h=e.constructor,m=h.precision;if(kr(e)>16)throw Error(yy+kr(e));if(!e.s)return new h(oa);for(Zt=!1,c=m,s=new h(.03125);e.abs().gte(.1);)e=e.times(s),d+=5;for(n=Math.log(ko(2,d))/Math.LN10*2+5|0,c+=n,r=a=i=new h(oa),h.precision=c;;){if(a=$t(a.times(e),c),r=r.times(++f),s=i.plus(Vi(a,r,c)),xi(s.d).slice(0,c)===xi(i.d).slice(0,c)){for(;d--;)i=$t(i.times(i),c);return h.precision=m,t==null?(Zt=!0,$t(i,m)):i}i=s}}function kr(e){for(var t=e.e*Kt,r=e.d[0];r>=10;r/=10)t++;return t}function Cg(e,t,r){if(t>e.LN10.sd())throw Zt=!0,r&&(e.precision=r),Error(Ra+"LN10 precision limit exceeded");return $t(new e(e.LN10),t)}function Os(e){for(var t="";e--;)t+="0";return t}function rf(e,t){var r,n,a,i,s,c,f,d,h,m=1,x=10,g=e,y=g.d,v=g.constructor,b=v.precision;if(g.s<1)throw Error(Ra+(g.s?"NaN":"-Infinity"));if(g.eq(oa))return new v(0);if(t==null?(Zt=!1,d=b):d=t,g.eq(10))return t==null&&(Zt=!0),Cg(v,d);if(d+=x,v.precision=d,r=xi(y),n=r.charAt(0),i=kr(g),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(e),r=xi(g.d),n=r.charAt(0),m++;i=kr(g),n>1?(g=new v("0."+r),i++):g=new v(n+"."+r.slice(1))}else return f=Cg(v,d+2,b).times(i+""),g=rf(new v(n+"."+r.slice(1)),d-x).plus(f),v.precision=b,t==null?(Zt=!0,$t(g,b)):g;for(c=s=g=Vi(g.minus(oa),g.plus(oa),d),h=$t(g.times(g),d),a=3;;){if(s=$t(s.times(h),d),f=c.plus(Vi(s,new v(a),d)),xi(f.d).slice(0,d)===xi(c.d).slice(0,d))return c=c.times(2),i!==0&&(c=c.plus(Cg(v,d+2,b).times(i+""))),c=Vi(c,new v(m),d),v.precision=b,t==null?(Zt=!0,$t(c,b)):c;c=f,a+=2}}function SE(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Nc(r/Kt),e.d=[],n=(r+1)%Kt,r<0&&(n+=Kt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Kt;n<a;)e.d.push(+t.slice(n,n+=Kt));t=t.slice(n),n=Kt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Zt&&(e.e>sh||e.e<-sh))throw Error(yy+r)}else e.s=0,e.e=0,e.d=[0];return e}function $t(e,t,r){var n,a,i,s,c,f,d,h,m=e.d;for(s=1,i=m[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Kt,a=t,d=m[h=0];else{if(h=Math.ceil((n+1)/Kt),i=m.length,h>=i)return e;for(d=i=m[h],s=1;i>=10;i/=10)s++;n%=Kt,a=n-Kt+s}if(r!==void 0&&(i=ko(10,s-a-1),c=d/i%10|0,f=t<0||m[h+1]!==void 0||d%i,f=r<4?(c||f)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||f||r==6&&(n>0?a>0?d/ko(10,s-a):0:m[h-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return f?(i=kr(e),m.length=1,t=t-i-1,m[0]=ko(10,(Kt-t%Kt)%Kt),e.e=Nc(-t/Kt)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(n==0?(m.length=h,i=1,h--):(m.length=h+1,i=ko(10,Kt-n),m[h]=a>0?(d/ko(10,s-a)%ko(10,a)|0)*i:0),f)for(;;)if(h==0){(m[0]+=i)==Vr&&(m[0]=1,++e.e);break}else{if(m[h]+=i,m[h]!=Vr)break;m[h--]=0,i=1}for(n=m.length;m[--n]===0;)m.pop();if(Zt&&(e.e>sh||e.e<-sh))throw Error(yy+kr(e));return e}function MA(e,t){var r,n,a,i,s,c,f,d,h,m,x=e.constructor,g=x.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new x(e),Zt?$t(t,g):t;if(f=e.d,m=t.d,n=t.e,d=e.e,f=f.slice(),s=d-n,s){for(h=s<0,h?(r=f,s=-s,c=m.length):(r=m,n=d,c=f.length),a=Math.max(Math.ceil(g/Kt),c)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=f.length,c=m.length,h=a<c,h&&(c=a),a=0;a<c;a++)if(f[a]!=m[a]){h=f[a]<m[a];break}s=0}for(h&&(r=f,f=m,m=r,t.s=-t.s),c=f.length,a=m.length-c;a>0;--a)f[c++]=0;for(a=m.length;a>s;){if(f[--a]<m[a]){for(i=a;i&&f[--i]===0;)f[i]=Vr-1;--f[i],f[a]+=Vr}f[a]-=m[a]}for(;f[--c]===0;)f.pop();for(;f[0]===0;f.shift())--n;return f[0]?(t.d=f,t.e=n,Zt?$t(t,g):t):new x(0)}function Xo(e,t,r){var n,a=kr(e),i=xi(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Os(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Os(-a-1)+i,r&&(n=r-s)>0&&(i+=Os(n))):a>=s?(i+=Os(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Os(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Os(n))),e.s<0?"-"+i:i}function NE(e,t){if(e.length>t)return e.length=t,!0}function RA(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Ro+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return SE(s,i.toString())}else if(typeof i!="string")throw Error(Ro+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,A9.test(i))SE(s,i);else throw Error(Ro+i)}if(a.prototype=Xe,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=RA,a.config=a.set=T9,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function T9(e){if(!e||typeof e!="object")throw Error(Ra+"Object expected");var t,r,n,a=["precision",1,Sc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Nc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Ro+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ro+r+": "+n);return this}var wy=RA(C9);oa=new wy(1);const Dt=wy;var P9=e=>e,LA={},BA=e=>e===LA,_E=e=>function t(){return arguments.length===0||arguments.length===1&&BA(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},$A=(e,t)=>e===1?t:_E(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==LA).length;return i>=e?t(...n):$A(e-i,_E(function(){for(var s=arguments.length,c=new Array(s),f=0;f<s;f++)c[f]=arguments[f];var d=n.map(h=>BA(h)?c.shift():h);return t(...d,...c)}))}),sm=e=>$A(e.length,e),Uv=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},O9=sm((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),F9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return P9;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((c,f)=>f(c),i(...arguments))}},zv=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),UA=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,c)=>{var f;return s===((f=t)===null||f===void 0?void 0:f[c])})||(t=a,r=e(...a)),r}};function zA(e){var t;return e===0?t=1:t=Math.floor(new Dt(e).abs().log(10).toNumber())+1,t}function WA(e,t,r){for(var n=new Dt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}sm((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});sm((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});sm((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var HA=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},VA=(e,t,r)=>{if(e.lte(0))return new Dt(0);var n=zA(e.toNumber()),a=new Dt(10).pow(n),i=e.div(a),s=n!==1?.05:.1,c=new Dt(Math.ceil(i.div(s).toNumber())).add(r).mul(s),f=c.mul(a);return t?new Dt(f.toNumber()):new Dt(Math.ceil(f.toNumber()))},D9=(e,t,r)=>{var n=new Dt(1),a=new Dt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new Dt(10).pow(zA(e)-1),a=new Dt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Dt(Math.floor(e)))}else e===0?a=new Dt(Math.floor((t-1)/2)):r||(a=new Dt(Math.floor(e)));var s=Math.floor((t-1)/2),c=F9(O9(f=>a.add(new Dt(f-s).mul(n)).toNumber()),Uv);return c(0,t)},KA=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Dt(0),tickMin:new Dt(0),tickMax:new Dt(0)};var s=VA(new Dt(r).sub(t).div(n-1),a,i),c;t<=0&&r>=0?c=new Dt(0):(c=new Dt(t).add(r).div(2),c=c.sub(new Dt(c).mod(s)));var f=Math.ceil(c.sub(t).div(s).toNumber()),d=Math.ceil(new Dt(r).sub(c).div(s).toNumber()),h=f+d+1;return h>n?KA(t,r,n,a,i+1):(h<n&&(d=r>0?d+(n-h):d,f=r>0?f:f+(n-h)),{step:s,tickMin:c.sub(new Dt(f).mul(s)),tickMax:c.add(new Dt(d).mul(s))})};function I9(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,c]=HA([t,r]);if(s===-1/0||c===1/0){var f=c===1/0?[s,...Uv(0,n-1).map(()=>1/0)]:[...Uv(0,n-1).map(()=>-1/0),c];return t>r?zv(f):f}if(s===c)return D9(s,n,a);var{step:d,tickMin:h,tickMax:m}=KA(s,c,i,a,0),x=WA(h,m.add(new Dt(.1).mul(d)),d);return t>r?zv(x):x}function M9(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=HA([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var c=Math.max(t,2),f=VA(new Dt(s).sub(i).div(c-1),a,0),d=[...WA(new Dt(i),new Dt(s),f),s];return a===!1&&(d=d.map(h=>Math.round(h))),r>n?zv(d):d}var R9=UA(I9),L9=UA(M9),GA=e=>e.rootProps.maxBarSize,B9=e=>e.rootProps.barGap,XA=e=>e.rootProps.barCategoryGap,$9=e=>e.rootProps.barSize,Pf=e=>e.rootProps.stackOffset,by=e=>e.options.chartName,Sy=e=>e.rootProps.syncId,qA=e=>e.rootProps.syncMethod,Ny=e=>e.options.eventEmitter,Ri={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},aa={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},om=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},U9={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ri.angleAxisId,includeHidden:!1,name:void 0,reversed:Ri.reversed,scale:Ri.scale,tick:Ri.tick,tickCount:void 0,ticks:void 0,type:Ri.type,unit:void 0},z9={allowDataOverflow:aa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:aa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:aa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:aa.scale,tick:aa.tick,tickCount:aa.tickCount,ticks:void 0,type:aa.type,unit:void 0},W9={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ri.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ri.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ri.scale,tick:Ri.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},H9={allowDataOverflow:aa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:aa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:aa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:aa.scale,tick:aa.tick,tickCount:aa.tickCount,ticks:void 0,type:"category",unit:void 0},_y=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?W9:U9,Ey=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?H9:z9,lm=e=>e.polarOptions,ky=Se([ts,rs,Mr],PC),YA=Se([lm,ky],(e,t)=>{if(e!=null)return _n(e.innerRadius,t,0)}),JA=Se([lm,ky],(e,t)=>{if(e!=null)return _n(e.outerRadius,t,t*.8)}),V9=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},QA=Se([lm],V9);Se([_y,QA],om);var ZA=Se([ky,YA,JA],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Se([Ey,ZA],om);var eT=Se([Et,lm,YA,JA,ts,rs],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:c,startAngle:f,endAngle:d}=t;return{cx:_n(s,a,a/2),cy:_n(c,i,i/2),innerRadius:r,outerRadius:n,startAngle:f,endAngle:d,clockWise:!1}}}),er=(e,t)=>t,Of=(e,t,r)=>r;function jy(e){return e?.id}var Lr=e=>{var t=Et(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},_c=e=>e.tooltip.settings.axisId,Zr=e=>{var t=Lr(e),r=_c(e);return Ff(e,t,r)},tT=Se([Zr],e=>e?.dataKey);function rT(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(c=>{var f,d=(f=c.data)!==null&&f!==void 0?f:n;if(!(d==null||d.length===0)){var h=jy(c);d.forEach((m,x)=>{var g=i==null||a?x:String(ir(m,i,null)),y=ir(m,c.dataKey,0),v;s.has(g)?v=s.get(g):v={},Object.assign(v,{[h]:y}),s.set(g,v)})}}),Array.from(s.values())}function cm(e){return e.stackId!=null&&e.dataKey!=null}function EE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EE(Object(r),!0).forEach(function(n){K9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function K9(e,t,r){return(t=G9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G9(e){var t=X9(e,"string");return typeof t=="symbol"?t:t+""}function X9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wv=[0,"auto"],ra={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},nT=(e,t)=>e.cartesianAxis.xAxis[t],as=(e,t)=>{var r=nT(e,t);return r??ra},na={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Wv,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:kf},aT=(e,t)=>e.cartesianAxis.yAxis[t],is=(e,t)=>{var r=aT(e,t);return r??na},q9={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Cy=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??q9},yr=(e,t,r)=>{switch(t){case"xAxis":return as(e,r);case"yAxis":return is(e,r);case"zAxis":return Cy(e,r);case"angleAxis":return _y(e,r);case"radiusAxis":return Ey(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Y9=(e,t,r)=>{switch(t){case"xAxis":return as(e,r);case"yAxis":return is(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Ff=(e,t,r)=>{switch(t){case"xAxis":return as(e,r);case"yAxis":return is(e,r);case"angleAxis":return _y(e,r);case"radiusAxis":return Ey(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},iT=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Ay(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Ty=e=>e.graphicalItems.cartesianItems,J9=Se([er,Of],Ay),Py=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),Df=Se([Ty,yr,J9],Py),sT=Se([Df],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(cm)),oT=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),lT=Se([Df],oT),Oy=e=>e.map(t=>t.data).filter(Boolean).flat(1),Q9=Se([Df],Oy),Fy=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Dy=Se([Q9,vy],Fy),Iy=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:ir(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:ir(a,n)}))):e.map(n=>({value:n})),um=Se([Dy,yr,Df],Iy);function cT(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function ll(e){return e.filter(t=>bi(t)||t instanceof Date).map(Number).filter(t=>da(t)===!1)}function Z9(e,t,r){return!r||typeof t!="number"||da(t)?[]:r.length?ll(r.flatMap(n=>{var a=ir(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!ma(i)||!ma(s)))return[t-i,t+s]})):[]}var eB=Se([sT,vy,Zr],rT),uT=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,c]=i,f=c.map(jy);return[s,{stackedData:a8(e,f,r),graphicalItems:c}]}))},Hv=Se([eB,sT,Pf],uT),fT=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var i=c8(e,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},tB=Se([Hv,ro,er],fT),dT=(e,t,r,n,a)=>r.length>0?e.flatMap(i=>r.flatMap(s=>{var c,f,d=(c=n[s.id])===null||c===void 0?void 0:c.filter(m=>cT(a,m)),h=ir(i,(f=t.dataKey)!==null&&f!==void 0?f:s.dataKey);return{value:h,errorDomain:Z9(i,h,d)}})).filter(Boolean):t?.dataKey!=null?e.map(i=>({value:ir(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),fm=e=>e.errorBars,hT=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>cT(r,n));Se([lT,fm,er],hT);var rB=Se([Dy,yr,lT,fm,er],dT);function nB(e){var{value:t}=e;if(bi(t)||t instanceof Date)return t}var kE=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=ll(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},aB=(e,t,r)=>{var n=e.map(nB).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&E4(n))?QC(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},My=e=>{var t;if(e==null||!("domain"in e))return Wv;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=ll(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:Wv},lh=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),c=Math.max(...i);return[s,c]}},mT=e=>e.referenceElements.dots,Ec=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),iB=Se([mT,er,Of],Ec),pT=e=>e.referenceElements.areas,sB=Se([pT,er,Of],Ec),xT=e=>e.referenceElements.lines,oB=Se([xT,er,Of],Ec),gT=(e,t)=>{var r=ll(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},lB=Se(iB,er,gT),vT=(e,t)=>{var r=ll(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},cB=Se([sB,er],vT),yT=(e,t)=>{var r=ll(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},uB=Se(oB,er,yT),fB=Se(lB,uB,cB,(e,t,r)=>lh(e,r,t)),wT=Se([yr],My),Ry=(e,t,r,n,a,i,s)=>{var c=k9(t,e.allowDataOverflow);if(c!=null)return c;var f=i==="vertical"&&s==="xAxis"||i==="horizontal"&&s==="yAxis",d=f?lh(r,a,kE(n)):lh(a,kE(n));return j9(t,d,e.allowDataOverflow)},dB=Se([yr,wT,tB,rB,fB,Et,er],Ry),hB=[0,1],Ly=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:c,type:f}=e,d=al(t,i);return d&&c==null?QC(0,r.length):f==="category"?aB(n,e,d):a==="expand"?hB:s}},By=Se([yr,Et,Dy,um,Pf,er,dB],Ly),bT=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var c="scale".concat(Sf(i));return c in Tu?c:"point"}}},kc=Se([yr,Et,iT,by,er],bT);function mB(e){if(e!=null){if(e in Tu)return Tu[e]();var t="scale".concat(Sf(e));if(t in Tu)return Tu[t]()}}function $y(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=mB(t);if(a!=null){var i=a.domain(r).range(n);return ZM(i),i}}}var Uy=(e,t,r)=>{var n=My(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&dc(e))return R9(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&dc(e))return L9(e,t.tickCount,t.allowDecimals)}},zy=Se([By,Ff,kc],Uy),Wy=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&dc(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],c=r[r.length-1];return[Math.min(a,i),Math.max(s,c)]}return t},pB=Se([yr,By,zy,er],Wy),xB=Se(um,yr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(ll(e.map(c=>c.value))).sort((c,f)=>c-f);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),ST=Se(xB,Et,XA,Mr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!ma(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=_n(r,e*i),c=e*i/2;return c-s-(c-s)/i*s}return 0}),gB=(e,t)=>{var r=as(e,t);return r==null||typeof r.padding!="string"?0:ST(e,"xAxis",t,r.padding)},vB=(e,t)=>{var r=is(e,t);return r==null||typeof r.padding!="string"?0:ST(e,"yAxis",t,r.padding)},yB=Se(as,gB,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),wB=Se(is,vB,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),bB=Se([Mr,yB,Yh,qh,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),SB=Se([Mr,Et,wB,Yh,qh,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),If=(e,t,r,n)=>{var a;switch(t){case"xAxis":return bB(e,r,n);case"yAxis":return SB(e,r,n);case"zAxis":return(a=Cy(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return QA(e);case"radiusAxis":return ZA(e,r);default:return}},NT=Se([yr,If],om),jc=Se([yr,kc,pB,NT],$y);Se([Df,fm,er],hT);function _T(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var dm=(e,t)=>t,hm=(e,t,r)=>r,NB=Se(Gh,dm,hm,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(_T)),_B=Se(Xh,dm,hm,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(_T)),ET=(e,t)=>({width:e.width,height:t.height}),EB=(e,t)=>{var r=typeof t.width=="number"?t.width:kf;return{width:r,height:e.height}},kT=Se(Mr,as,ET),kB=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},jB=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},CB=Se(rs,Mr,NB,dm,hm,(e,t,r,n,a)=>{var i={},s;return r.forEach(c=>{var f=ET(t,c);s==null&&(s=kB(t,n,e));var d=n==="top"&&!a||n==="bottom"&&a;i[c.id]=s-Number(d)*f.height,s+=(d?-1:1)*f.height}),i}),AB=Se(ts,Mr,_B,dm,hm,(e,t,r,n,a)=>{var i={},s;return r.forEach(c=>{var f=EB(t,c);s==null&&(s=jB(t,n,e));var d=n==="left"&&!a||n==="right"&&a;i[c.id]=s-Number(d)*f.width,s+=(d?-1:1)*f.width}),i}),TB=(e,t)=>{var r=as(e,t);if(r!=null)return CB(e,r.orientation,r.mirror)},PB=Se([Mr,as,TB,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),OB=(e,t)=>{var r=is(e,t);if(r!=null)return AB(e,r.orientation,r.mirror)},FB=Se([Mr,is,OB,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),jT=Se(Mr,is,(e,t)=>{var r=typeof t.width=="number"?t.width:kf;return{width:r,height:e.height}}),jE=(e,t,r)=>{switch(t){case"xAxis":return kT(e,r).width;case"yAxis":return jT(e,r).height;default:return}},CT=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,c=al(e,n),f=t.map(d=>d.value);if(s&&c&&i==="category"&&a&&E4(f))return f}},Hy=Se([Et,um,yr,er],CT),AT=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=al(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(c=>c.value)}},Vy=Se([Et,um,Ff,er],AT),CE=Se([Et,Y9,kc,jc,Hy,Vy,If,zy,er],(e,t,r,n,a,i,s,c,f)=>{if(t==null)return null;var d=al(e,f);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:f,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:c,range:s,realScaleType:r,scale:n}}),DB=(e,t,r,n,a,i,s,c,f)=>{if(!(t==null||n==null)){var d=al(e,f),{type:h,ticks:m,tickCount:x}=t,g=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,y=h==="category"&&n.bandwidth?n.bandwidth()/g:0;y=f==="angleAxis"&&i!=null&&i.length>=2?Xr(i[0]-i[1])*2*y:y;var v=m||a;if(v){var b=v.map((N,E)=>{var S=s?s.indexOf(N):N;return{index:E,coordinate:n(S)+y,value:N,offset:y}});return b.filter(N=>!da(N.coordinate))}return d&&c?c.map((N,E)=>({coordinate:n(N)+y,value:N,index:E,offset:y})):n.ticks?n.ticks(x).map(N=>({coordinate:n(N)+y,value:N,offset:y})):n.domain().map((N,E)=>({coordinate:n(N)+y,value:s?s[N]:N,index:E,offset:y}))}},TT=Se([Et,Ff,kc,jc,zy,If,Hy,Vy,er],DB),IB=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var c=al(e,s),{tickCount:f}=t,d=0;return d=s==="angleAxis"&&n?.length>=2?Xr(n[0]-n[1])*2*d:d,c&&i?i.map((h,m)=>({coordinate:r(h)+d,value:h,index:m,offset:d})):r.ticks?r.ticks(f).map(h=>({coordinate:r(h)+d,value:h,offset:d})):r.domain().map((h,m)=>({coordinate:r(h)+d,value:a?a[h]:h,index:m,offset:d}))}},hc=Se([Et,Ff,jc,If,Hy,Vy,er],IB),mc=Se(yr,jc,(e,t)=>{if(!(e==null||t==null))return oh(oh({},e),{},{scale:t})}),MB=Se([yr,kc,By,NT],$y);Se((e,t,r)=>Cy(e,r),MB,(e,t)=>{if(!(e==null||t==null))return oh(oh({},e),{},{scale:t})});var RB=Se([Et,Gh,Xh],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),PT=e=>e.options.defaultTooltipEventType,OT=e=>e.options.validateTooltipEventTypes;function FT(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Ky(e,t){var r=PT(e),n=OT(e);return FT(t,r,n)}function LB(e){return Ze(t=>Ky(t,e))}var DT=(e,t)=>{var r,n=Number(t);if(!(da(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},BB=e=>e.tooltip.settings,Ds={active:!1,index:null,dataKey:void 0,coordinate:void 0},$B={itemInteraction:{click:Ds,hover:Ds},axisInteraction:{click:Ds,hover:Ds},keyboardInteraction:Ds,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},IT=xa({name:"tooltip",initialState:$B,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Hi(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:UB,removeTooltipEntrySettings:zB,setTooltipSettingsState:WB,setActiveMouseOverItemIndex:MT,mouseLeaveItem:HB,mouseLeaveChart:RT,setActiveClickItemIndex:VB,setMouseOverAxisIndex:LT,setMouseClickAxisIndex:KB,setSyncInteraction:Vv,setKeyboardInteraction:Kv}=IT.actions,GB=IT.reducer;function AE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function h0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AE(Object(r),!0).forEach(function(n){XB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XB(e,t,r){return(t=qB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qB(e){var t=YB(e,"string");return typeof t=="symbol"?t:t+""}function YB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JB(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function QB(e){return e.index!=null}var BT=(e,t,r,n)=>{if(t==null)return Ds;var a=JB(e,t,r);if(a==null)return Ds;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(QB(a)){if(i)return h0(h0({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return h0(h0({},Ds),{},{coordinate:a.coordinate})},Gy=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!ma(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},$T=(e,t,r,n,a,i,s,c)=>{if(!(i==null||c==null)){var f=s[0],d=f==null?void 0:c(f.positions,i);if(d!=null)return d;var h=a?.[Number(i)];if(h)switch(r){case"horizontal":return{x:h.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:h.coordinate}}}},UT=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},Mf=e=>e.options.tooltipPayloadSearcher,Cc=e=>e.tooltip;function TE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function PE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TE(Object(r),!0).forEach(function(n){ZB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZB(e,t,r){return(t=e$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e$(e){var t=t$(e,"string");return typeof t=="symbol"?t:t+""}function t$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r$(e,t){return e??t}var zT=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:c,computedData:f,dataStartIndex:d,dataEndIndex:h}=r,m=[];return e.reduce((x,g)=>{var y,{dataDefinedOnItem:v,settings:b}=g,N=r$(v,c),E=Array.isArray(N)?OC(N,d,h):N,S=(y=b?.dataKey)!==null&&y!==void 0?y:n,C=b?.nameKey,T;if(n&&Array.isArray(E)&&!Array.isArray(E[0])&&s==="axis"?T=z5(E,n,a):T=i(E,t,f,C),Array.isArray(T))T.forEach(P=>{var D=PE(PE({},b),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});x.push(h_({tooltipEntrySettings:D,dataKey:P.dataKey,payload:P.payload,value:ir(P.payload,P.dataKey),name:P.name}))});else{var k;x.push(h_({tooltipEntrySettings:b,dataKey:S,payload:T,value:ir(T,S),name:(k=ir(T,C))!==null&&k!==void 0?k:b?.name}))}return x},m)}},Xy=Se([Zr,Et,iT,by,Lr],bT),n$=Se([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),a$=Se([Lr,_c],Ay),Rf=Se([n$,Zr,a$],Py),i$=Se([Rf],e=>e.filter(cm)),s$=Se([Rf],Oy),Ac=Se([s$,ro],Fy),o$=Se([i$,ro,Zr],rT),qy=Se([Ac,Zr,Rf],Iy),l$=Se([Zr],My),c$=Se([Rf],e=>e.filter(cm)),u$=Se([o$,c$,Pf],uT),f$=Se([u$,ro,Lr],fT),d$=Se([Rf],oT),h$=Se([Ac,Zr,d$,fm,Lr],dT),m$=Se([mT,Lr,_c],Ec),p$=Se([m$,Lr],gT),x$=Se([pT,Lr,_c],Ec),g$=Se([x$,Lr],vT),v$=Se([xT,Lr,_c],Ec),y$=Se([v$,Lr],yT),w$=Se([p$,y$,g$],lh),b$=Se([Zr,l$,f$,h$,w$,Et,Lr],Ry),WT=Se([Zr,Et,Ac,qy,Pf,Lr,b$],Ly),S$=Se([WT,Zr,Xy],Uy),N$=Se([Zr,WT,S$,Lr],Wy),HT=e=>{var t=Lr(e),r=_c(e),n=!1;return If(e,t,r,n)},VT=Se([Zr,HT],om),KT=Se([Zr,Xy,N$,VT],$y),_$=Se([Et,qy,Zr,Lr],CT),E$=Se([Et,qy,Zr,Lr],AT),k$=(e,t,r,n,a,i,s,c)=>{if(t){var{type:f}=t,d=al(e,c);if(n){var h=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,m=f==="category"&&n.bandwidth?n.bandwidth()/h:0;return m=c==="angleAxis"&&a!=null&&a?.length>=2?Xr(a[0]-a[1])*2*m:m,d&&s?s.map((x,g)=>({coordinate:n(x)+m,value:x,index:g,offset:m})):n.domain().map((x,g)=>({coordinate:n(x)+m,value:i?i[x]:x,index:g,offset:m}))}}},ss=Se([Et,Zr,Xy,KT,HT,_$,E$,Lr],k$),Yy=Se([PT,OT,BB],(e,t,r)=>FT(r.shared,e,t)),GT=e=>e.tooltip.settings.trigger,Jy=e=>e.tooltip.settings.defaultIndex,mm=Se([Cc,Yy,GT,Jy],BT),qo=Se([mm,Ac],Gy),XT=Se([ss,qo],DT),qT=Se([mm],e=>{if(e)return e.dataKey}),YT=Se([Cc,Yy,GT,Jy],UT),j$=Se([ts,rs,Et,Mr,ss,Jy,YT,Mf],$T),C$=Se([mm,j$],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),A$=Se([mm],e=>e.active),T$=Se([YT,qo,ro,tT,XT,Mf,Yy],zT);Se([T$],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function OE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OE(Object(r),!0).forEach(function(n){P$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P$(e,t,r){return(t=O$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O$(e){var t=F$(e,"string");return typeof t=="symbol"?t:t+""}function F$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D$=()=>Ze(Zr),I$=()=>{var e=D$(),t=Ze(ss),r=Ze(KT);return U1(FE(FE({},e),{},{scale:r}),t)},M$=()=>Ze(by),Qy=(e,t)=>t,JT=(e,t,r)=>r,Zy=(e,t,r,n)=>n,R$=Se(ss,e=>$h(e,t=>t.coordinate)),ew=Se([Cc,Qy,JT,Zy],BT),QT=Se([ew,Ac],Gy),L$=(e,t,r)=>{if(t!=null){var n=Cc(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},ZT=Se([Cc,Qy,JT,Zy],UT),ch=Se([ts,rs,Et,Mr,ss,Zy,ZT,Mf],$T),B$=Se([ew,ch],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),e3=Se(ss,QT,DT),$$=Se([ZT,QT,ro,tT,e3,Mf,Qy],zT),U$=Se([ew],e=>({isActive:e.active,activeIndex:e.index})),z$=(e,t,r,n,a,i,s,c)=>{if(!(!e||!t||!n||!a||!i)){var f=u8(e.chartX,e.chartY,t,r,c);if(f){var d=d8(f,t),h=JM(d,s,i,n,a),m=f8(t,i,h,f);return{activeIndex:String(h),activeCoordinate:m}}}};function Gv(){return Gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gv.apply(null,arguments)}function DE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function m0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DE(Object(r),!0).forEach(function(n){W$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W$(e,t,r){return(t=H$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H$(e){var t=V$(e,"string");return typeof t=="symbol"?t:t+""}function V$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K$(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:c,tooltipEventType:f,chartName:d}=e,h=t,m=r,x=n;if(!c||!h||d!=="ScatterChart"&&f!=="axis")return null;var g,y;if(d==="ScatterChart")g=h,y=dR;else if(d==="BarChart")g=hR(s,h,a,i),y=XC;else if(s==="radial"){var{cx:v,cy:b,radius:N,startAngle:E,endAngle:S}=qC(h);g={cx:v,cy:b,startAngle:E,endAngle:S,innerRadius:N,outerRadius:N},y=JC}else g={points:KR(s,h,a)},y=WC;var C=typeof c=="object"&&"className"in c?c.className:void 0,T=m0(m0(m0(m0({stroke:"#ccc",pointerEvents:"none"},a),g),Dr(c,!1)),{},{payload:m,payloadIndex:x,className:wt("recharts-tooltip-cursor",C)});return j.isValidElement(c)?j.cloneElement(c,T):j.createElement(y,T)}function G$(e){var t=I$(),r=LC(),n=K1(),a=M$();return j.createElement(K$,Gv({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var t3=j.createContext(null),X$=()=>j.useContext(t3),Ag={exports:{}},IE;function q$(){return IE||(IE=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(f,d,h){this.fn=f,this.context=d,this.once=h||!1}function i(f,d,h,m,x){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new a(h,m||f,x),y=r?r+d:d;return f._events[y]?f._events[y].fn?f._events[y]=[f._events[y],g]:f._events[y].push(g):(f._events[y]=g,f._eventsCount++),f}function s(f,d){--f._eventsCount===0?f._events=new n:delete f._events[d]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],h,m;if(this._eventsCount===0)return d;for(m in h=this._events)t.call(h,m)&&d.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},c.prototype.listeners=function(d){var h=r?r+d:d,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var x=0,g=m.length,y=new Array(g);x<g;x++)y[x]=m[x].fn;return y},c.prototype.listenerCount=function(d){var h=r?r+d:d,m=this._events[h];return m?m.fn?1:m.length:0},c.prototype.emit=function(d,h,m,x,g,y){var v=r?r+d:d;if(!this._events[v])return!1;var b=this._events[v],N=arguments.length,E,S;if(b.fn){switch(b.once&&this.removeListener(d,b.fn,void 0,!0),N){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,h),!0;case 3:return b.fn.call(b.context,h,m),!0;case 4:return b.fn.call(b.context,h,m,x),!0;case 5:return b.fn.call(b.context,h,m,x,g),!0;case 6:return b.fn.call(b.context,h,m,x,g,y),!0}for(S=1,E=new Array(N-1);S<N;S++)E[S-1]=arguments[S];b.fn.apply(b.context,E)}else{var C=b.length,T;for(S=0;S<C;S++)switch(b[S].once&&this.removeListener(d,b[S].fn,void 0,!0),N){case 1:b[S].fn.call(b[S].context);break;case 2:b[S].fn.call(b[S].context,h);break;case 3:b[S].fn.call(b[S].context,h,m);break;case 4:b[S].fn.call(b[S].context,h,m,x);break;default:if(!E)for(T=1,E=new Array(N-1);T<N;T++)E[T-1]=arguments[T];b[S].fn.apply(b[S].context,E)}}return!0},c.prototype.on=function(d,h,m){return i(this,d,h,m,!1)},c.prototype.once=function(d,h,m){return i(this,d,h,m,!0)},c.prototype.removeListener=function(d,h,m,x){var g=r?r+d:d;if(!this._events[g])return this;if(!h)return s(this,g),this;var y=this._events[g];if(y.fn)y.fn===h&&(!x||y.once)&&(!m||y.context===m)&&s(this,g);else{for(var v=0,b=[],N=y.length;v<N;v++)(y[v].fn!==h||x&&!y[v].once||m&&y[v].context!==m)&&b.push(y[v]);b.length?this._events[g]=b.length===1?b[0]:b:s(this,g)}return this},c.prototype.removeAllListeners=function(d){var h;return d?(h=r?r+d:d,this._events[h]&&s(this,h)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c})(Ag)),Ag.exports}var Y$=q$();const J$=Ni(Y$);var nf=new J$,Xv="recharts.syncEvent.tooltip",ME="recharts.syncEvent.brush";function r3(e,t){if(t){var r=Number.parseInt(t,10);if(!da(r))return e?.[r]}}var Q$={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},n3=xa({name:"options",initialState:Q$,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Z$=n3.reducer,{createEventEmitter:eU}=n3.actions;function tU(e){return e.tooltip.syncInteraction}var rU={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},a3=xa({name:"chartData",initialState:rU,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:RE,setDataStartEndIndexes:nU,setComputedData:ble}=a3.actions,aU=a3.reducer,iU=["x","y"];function LE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function No(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LE(Object(r),!0).forEach(function(n){sU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sU(e,t,r){return(t=oU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oU(e){var t=lU(e,"string");return typeof t=="symbol"?t:t+""}function lU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cU(e,t){if(e==null)return{};var r,n,a=uU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var i3=()=>{};function fU(){var e=Ze(Sy),t=Ze(Ny),r=lr(),n=Ze(qA),a=Ze(ss),i=K1(),s=W1(),c=Ze(f=>f.rootProps.className);j.useEffect(()=>{if(e==null)return i3;var f=(d,h,m)=>{if(t!==m&&e===d){if(n==="index"){var x;if(s&&h!==null&&h!==void 0&&(x=h.payload)!==null&&x!==void 0&&x.coordinate){var g=h.payload.coordinate,{x:y,y:v}=g,b=cU(g,iU),N=No(No(No({},b),typeof y=="number"&&{x:Math.max(s.x,Math.min(y,s.x+s.width))}),typeof v=="number"&&{y:Math.max(s.y,Math.min(v,s.y+s.height))}),E=No(No({},h),{},{payload:No(No({},h.payload),{},{coordinate:N})});r(E)}else r(h);return}if(a!=null){var S;if(typeof n=="function"){var C={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},T=n(a,C);S=a[T]}else n==="value"&&(S=a.find(ie=>String(ie.value)===h.payload.label));var{coordinate:k}=h.payload;if(S==null||h.payload.active===!1||k==null||s==null){r(Vv({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:P,y:D}=k,R=Math.min(P,s.x+s.width),q=Math.min(D,s.y+s.height),M={x:i==="horizontal"?S.coordinate:R,y:i==="horizontal"?q:S.coordinate},z=Vv({active:h.payload.active,coordinate:M,dataKey:h.payload.dataKey,index:String(S.index),label:h.payload.label});r(z)}}};return nf.on(Xv,f),()=>{nf.off(Xv,f)}},[c,r,t,e,n,a,i,s])}function dU(){var e=Ze(Sy),t=Ze(Ny),r=lr();j.useEffect(()=>{if(e==null)return i3;var n=(a,i,s)=>{t!==s&&e===a&&r(nU(i))};return nf.on(ME,n),()=>{nf.off(ME,n)}},[r,t,e])}function hU(){var e=lr();j.useEffect(()=>{e(eU())},[e]),fU(),dU()}function mU(e,t,r,n,a,i){var s=Ze(x=>L$(x,e,t)),c=Ze(Ny),f=Ze(Sy),d=Ze(qA),h=Ze(tU),m=h?.active;j.useEffect(()=>{if(!m&&f!=null&&c!=null){var x=Vv({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n});nf.emit(Xv,f,x,c)}},[m,r,s,a,n,c,f,d,i])}function BE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $E(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BE(Object(r),!0).forEach(function(n){pU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pU(e,t,r){return(t=xU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xU(e){var t=gU(e,"string");return typeof t=="symbol"?t:t+""}function gU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vU(e){return e.dataKey}function yU(e,t){return j.isValidElement(e)?j.cloneElement(e,t):typeof e=="function"?j.createElement(e,t):j.createElement(H8,t)}var UE=[],wU={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!il.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Du(e){var t=Mn(e,wU),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:c,isAnimationActive:f,offset:d,payloadUniqBy:h,position:m,reverseDirection:x,useTranslate3d:g,wrapperStyle:y,cursor:v,shared:b,trigger:N,defaultIndex:E,portal:S,axisId:C}=t,T=lr(),k=typeof E=="number"?String(E):E;j.useEffect(()=>{T(WB({shared:b,trigger:N,axisId:C,active:r,defaultIndex:k}))},[T,b,N,C,r,k]);var P=W1(),D=zC(),R=LB(b),{activeIndex:q,isActive:M}=Ze(X=>U$(X,R,N,k)),z=Ze(X=>$$(X,R,N,k)),ie=Ze(X=>e3(X,R,N,k)),ce=Ze(X=>B$(X,R,N,k)),ae=z,me=X$(),de=r??M,[he,J]=sC([ae,de]),xe=R==="axis"?ie:void 0;mU(R,N,ce,xe,q,de);var te=S??me;if(te==null)return null;var O=ae??UE;de||(O=UE),c&&O.length&&(O=tC(ae.filter(X=>X.value!=null&&(X.hide!==!0||t.includeHidden)),h,vU));var K=O.length>0,W=j.createElement(J8,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:f,active:de,coordinate:ce,hasPayload:K,offset:d,position:m,reverseDirection:x,useTranslate3d:g,viewBox:P,wrapperStyle:y,lastBoundingBox:he,innerRef:J,hasPortalFromProps:!!S},yU(s,$E($E({},t),{},{payload:O,label:xe,active:de,coordinate:ce,accessibilityLayer:D})));return j.createElement(j.Fragment,null,C4.createPortal(W,te),de&&j.createElement(G$,{cursor:v,tooltipEventType:R,coordinate:ce,payload:ae,index:q}))}var Tg={},Pg={},Og={},zE;function bU(){return zE||(zE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,c=null;const f=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),h=()=>{c!==null&&(r.apply(s,c),s=void 0,c=null)},m=()=>{d&&h(),v()};let x=null;const g=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,m()},n)},y=()=>{x!==null&&(clearTimeout(x),x=null)},v=()=>{y(),s=void 0,c=null},b=()=>{h()},N=function(...E){if(a?.aborted)return;s=this,c=E;const S=x==null;g(),f&&S&&h()};return N.schedule=g,N.cancel=v,N.flush=b,a?.addEventListener("abort",v,{once:!0}),N}e.debounce=t})(Og)),Og}var WE;function SU(){return WE||(WE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bU();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:c=!0,maxWait:f}=i,d=Array(2);s&&(d[0]="leading"),c&&(d[1]="trailing");let h,m=null;const x=t.debounce(function(...v){h=n.apply(this,v),m=null},a,{edges:d}),g=function(...v){return f!=null&&(m===null&&(m=Date.now()),Date.now()-m>=f)?(h=n.apply(this,v),m=Date.now(),x.cancel(),x.schedule(),h):(x.apply(this,v),h)},y=()=>(x.flush(),h);return g.cancel=x.cancel,g.flush=y,g}e.debounce=r})(Pg)),Pg}var HE;function NU(){return HE||(HE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SU();function r(n,a=0,i={}){const{leading:s=!0,trailing:c=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:c})}e.throttle=r})(Tg)),Tg}var Fg,VE;function _U(){return VE||(VE=1,Fg=NU().throttle),Fg}var EU=_U();const kU=Ni(EU);var Iu=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function KE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KE(Object(r),!0).forEach(function(n){jU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jU(e,t,r){return(t=CU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CU(e){var t=AU(e,"string");return typeof t=="symbol"?t:t+""}function AU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mu=j.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:s=0,minHeight:c,maxHeight:f,children:d,debounce:h=0,id:m,className:x,onResize:g,style:y={}}=e,v=j.useRef(null),b=j.useRef();b.current=g,j.useImperativeHandle(t,()=>v.current);var[N,E]=j.useState({containerWidth:n.width,containerHeight:n.height}),S=j.useCallback((T,k)=>{E(P=>{var D=Math.round(T),R=Math.round(k);return P.containerWidth===D&&P.containerHeight===R?P:{containerWidth:D,containerHeight:R}})},[]);j.useEffect(()=>{var T=R=>{var q,{width:M,height:z}=R[0].contentRect;S(M,z),(q=b.current)===null||q===void 0||q.call(b,M,z)};h>0&&(T=kU(T,h,{trailing:!0,leading:!1}));var k=new ResizeObserver(T),{width:P,height:D}=v.current.getBoundingClientRect();return S(P,D),k.observe(v.current),()=>{k.disconnect()}},[S,h]);var C=j.useMemo(()=>{var{containerWidth:T,containerHeight:k}=N;if(T<0||k<0)return null;Iu(Ao(a)||Ao(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),Iu(!r||r>0,"The aspect(%s) must be greater than zero.",r);var P=Ao(a)?T:a,D=Ao(i)?k:i;return r&&r>0&&(P?D=P/r:D&&(P=D*r),f&&D>f&&(D=f)),Iu(P>0||D>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,P,D,a,i,s,c,r),j.Children.map(d,R=>j.cloneElement(R,{width:P,height:D,style:Dg({width:P,height:D},R.props.style)}))},[r,d,i,f,c,s,N,a]);return j.createElement("div",{id:m?"".concat(m):void 0,className:wt("recharts-responsive-container",x),style:Dg(Dg({},y),{},{width:a,height:i,minWidth:s,minHeight:c,maxHeight:f}),ref:v},j.createElement("div",{style:{width:0,height:0,overflow:"visible"}},C))}),zi=e=>null;zi.displayName="Cell";function TU(e,t,r){return(t=PU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PU(e){var t=OU(e,"string");return typeof t=="symbol"?t:t+""}function OU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class FU{constructor(t){TU(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function GE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GE(Object(r),!0).forEach(function(n){IU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IU(e,t,r){return(t=MU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MU(e){var t=RU(e,"string");return typeof t=="symbol"?t:t+""}function RU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LU={cacheSize:2e3,enableCache:!0},s3=DU({},LU),XE=new FU(s3.cacheSize),BU={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},qE="recharts_measurement_span";function $U(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",c=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(c)}var YE=(e,t)=>{try{var r=document.getElementById(qE);r||(r=document.createElement("span"),r.setAttribute("id",qE),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,BU,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Ru=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||il.isSsr)return{width:0,height:0};if(!s3.enableCache)return YE(t,r);var n=$U(t,r),a=XE.get(n);if(a)return a;var i=YE(t,r);return XE.set(n,i),i},JE=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,QE=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,UU=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,zU=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,o3={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},WU=Object.keys(o3),Xl="NaN";function HU(e,t){return e*o3[t]}class Kn{static parse(t){var r,[,n,a]=(r=zU.exec(t))!==null&&r!==void 0?r:[];return new Kn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,da(t)&&(this.unit=""),r!==""&&!UU.test(r)&&(this.num=NaN,this.unit=""),WU.includes(r)&&(this.num=HU(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Kn(NaN,""):new Kn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Kn(NaN,""):new Kn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Kn(NaN,""):new Kn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Kn(NaN,""):new Kn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return da(this.num)}}function l3(e){if(e.includes(Xl))return Xl;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=JE.exec(t))!==null&&r!==void 0?r:[],s=Kn.parse(n??""),c=Kn.parse(i??""),f=a==="*"?s.multiply(c):s.divide(c);if(f.isNaN())return Xl;t=t.replace(JE,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,h,m,x]=(d=QE.exec(t))!==null&&d!==void 0?d:[],g=Kn.parse(h??""),y=Kn.parse(x??""),v=m==="+"?g.add(y):g.subtract(y);if(v.isNaN())return Xl;t=t.replace(QE,v.toString())}return t}var ZE=/\(([^()]*)\)/;function VU(e){for(var t=e,r;(r=ZE.exec(t))!=null;){var[,n]=r;t=t.replace(ZE,l3(n))}return t}function KU(e){var t=e.replace(/\s+/g,"");return t=VU(t),t=l3(t),t}function GU(e){try{return KU(e)}catch{return Xl}}function Ig(e){var t=GU(e.slice(5,-1));return t===Xl?"":t}var XU=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],qU=["dx","dy","angle","className","breakAll"];function qv(){return qv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qv.apply(null,arguments)}function ek(e,t){if(e==null)return{};var r,n,a=YU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var c3=/[ \f\n\r\t\v\u2028\u2029]+/,u3=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Yr(t)||(r?a=t.toString().split(""):a=t.toString().split(c3));var i=a.map(c=>({word:c,width:Ru(c,n).width})),s=r?0:Ru("",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},JU=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:c,breakAll:f}=e,d=et(i),h=s,m=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return M.reduce((z,ie)=>{var{word:ce,width:ae}=ie,me=z[z.length-1];if(me&&(n==null||a||me.width+ae+r<Number(n)))me.words.push(ce),me.width+=ae+r;else{var de={words:[ce],width:ae};z.push(de)}return z},[])},x=m(t),g=q=>q.reduce((M,z)=>M.width>z.width?M:z);if(!d||a)return x;var y=x.length>i||g(x).width>Number(n);if(!y)return x;for(var v="",b=q=>{var M=h.slice(0,q),z=u3({breakAll:f,style:c,children:M+v}).wordsWithComputedWidth,ie=m(z),ce=ie.length>i||g(ie).width>Number(n);return[ce,ie]},N=0,E=h.length-1,S=0,C;N<=E&&S<=h.length-1;){var T=Math.floor((N+E)/2),k=T-1,[P,D]=b(k),[R]=b(T);if(!P&&!R&&(N=T+1),P&&R&&(E=T-1),!P&&R){C=D;break}S++}return C||x},tk=e=>{var t=Yr(e)?[]:e.toString().split(c3);return[{words:t}]},QU=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!il.isSsr){var c,f,d=u3({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:h,spaceWidth:m}=d;c=h,f=m}else return tk(n);return JU({breakAll:i,children:n,maxLines:s,style:a},c,f,t,r)}return tk(n)},rk="#808080",pm=j.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:c="start",verticalAnchor:f="end",fill:d=rk}=e,h=ek(e,XU),m=j.useMemo(()=>QU({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:s,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,s,h.style,h.width]),{dx:x,dy:g,angle:y,className:v,breakAll:b}=h,N=ek(h,qU);if(!bi(r)||!bi(n)||m.length===0)return null;var E=r+(et(x)?x:0),S=n+(et(g)?g:0),C;switch(f){case"start":C=Ig("calc(".concat(i,")"));break;case"middle":C=Ig("calc(".concat((m.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:C=Ig("calc(".concat(m.length-1," * -").concat(a,")"));break}var T=[];if(s){var k=m[0].width,{width:P}=h;T.push("scale(".concat(et(P)?P/k:1,")"))}return y&&T.push("rotate(".concat(y,", ").concat(E,", ").concat(S,")")),T.length&&(N.transform=T.join(" ")),j.createElement("text",qv({},Dr(N,!0),{ref:t,x:E,y:S,className:wt("recharts-text",v),textAnchor:c,fill:d.includes("url")?rk:d}),m.map((D,R)=>{var q=D.words.join(b?"":" ");return j.createElement("tspan",{x:E,dy:R===0?C:a,key:"".concat(q,"-").concat(R)},q)}))});pm.displayName="Text";var ZU=["labelRef"];function ez(e,t){if(e==null)return{};var r,n,a=tz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function nk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nk(Object(r),!0).forEach(function(n){rz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rz(e,t,r){return(t=nz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nz(e){var t=az(e,"string");return typeof t=="symbol"?t:t+""}function az(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Li(){return Li=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Li.apply(null,arguments)}var f3=j.createContext(null),iz=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,s=j.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return j.createElement(f3.Provider,{value:s},i)},d3=()=>{var e=j.useContext(f3),t=W1();return e||t},sz=j.createContext(null),oz=()=>{var e=j.useContext(sz),t=Ze(eT);return e||t},lz=e=>{var{value:t,formatter:r}=e,n=Yr(e.children)?t:e.children;return typeof r=="function"?r(n):n},tw=e=>e!=null&&typeof e=="function",cz=(e,t)=>{var r=Xr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},uz=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:c,cy:f,innerRadius:d,outerRadius:h,startAngle:m,endAngle:x,clockWise:g}=a,y=(d+h)/2,v=cz(m,x),b=v>=0?1:-1,N,E;switch(t){case"insideStart":N=m+b*i,E=g;break;case"insideEnd":N=x-b*i,E=!g;break;case"end":N=x+b*i,E=g;break;default:throw new Error("Unsupported position ".concat(t))}E=v<=0?E:!E;var S=Er(c,f,y,N),C=Er(c,f,y,N+(E?1:-1)*359),T="M".concat(S.x,",").concat(S.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(E?0:1,`,
    `).concat(C.x,",").concat(C.y),k=Yr(e.id)?Xu("recharts-radial-line-"):e.id;return j.createElement("text",Li({},n,{dominantBaseline:"central",className:wt("recharts-radial-bar-label",s)}),j.createElement("defs",null,j.createElement("path",{id:k,d:T})),j.createElement("textPath",{xlinkHref:"#".concat(k)},r))},fz=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:c,endAngle:f}=e,d=(c+f)/2;if(r==="outside"){var{x:h,y:m}=Er(n,a,s+t,d);return{x:h,y:m,textAnchor:h>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var x=(i+s)/2,{x:g,y}=Er(n,a,x,d);return{x:g,y,textAnchor:"middle",verticalAnchor:"middle"}},h3=e=>"cx"in e&&et(e.cx),dz=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!h3(r)&&(i=r);var{x:s,y:c,width:f,height:d}=t,h=d>=0?1:-1,m=h*n,x=h>0?"end":"start",g=h>0?"start":"end",y=f>=0?1:-1,v=y*n,b=y>0?"end":"start",N=y>0?"start":"end";if(a==="top"){var E={x:s+f/2,y:c-h*n,textAnchor:"middle",verticalAnchor:x};return gr(gr({},E),i?{height:Math.max(c-i.y,0),width:f}:{})}if(a==="bottom"){var S={x:s+f/2,y:c+d+m,textAnchor:"middle",verticalAnchor:g};return gr(gr({},S),i?{height:Math.max(i.y+i.height-(c+d),0),width:f}:{})}if(a==="left"){var C={x:s-v,y:c+d/2,textAnchor:b,verticalAnchor:"middle"};return gr(gr({},C),i?{width:Math.max(C.x-i.x,0),height:d}:{})}if(a==="right"){var T={x:s+f+v,y:c+d/2,textAnchor:N,verticalAnchor:"middle"};return gr(gr({},T),i?{width:Math.max(i.x+i.width-T.x,0),height:d}:{})}var k=i?{width:f,height:d}:{};return a==="insideLeft"?gr({x:s+v,y:c+d/2,textAnchor:N,verticalAnchor:"middle"},k):a==="insideRight"?gr({x:s+f-v,y:c+d/2,textAnchor:b,verticalAnchor:"middle"},k):a==="insideTop"?gr({x:s+f/2,y:c+m,textAnchor:"middle",verticalAnchor:g},k):a==="insideBottom"?gr({x:s+f/2,y:c+d-m,textAnchor:"middle",verticalAnchor:x},k):a==="insideTopLeft"?gr({x:s+v,y:c+m,textAnchor:N,verticalAnchor:g},k):a==="insideTopRight"?gr({x:s+f-v,y:c+m,textAnchor:b,verticalAnchor:g},k):a==="insideBottomLeft"?gr({x:s+v,y:c+d-m,textAnchor:N,verticalAnchor:x},k):a==="insideBottomRight"?gr({x:s+f-v,y:c+d-m,textAnchor:b,verticalAnchor:x},k):a&&typeof a=="object"&&(et(a.x)||Ao(a.x))&&(et(a.y)||Ao(a.y))?gr({x:s+_n(a.x,f),y:c+_n(a.y,d),textAnchor:"end",verticalAnchor:"end"},k):gr({x:s+f/2,y:c+d/2,textAnchor:"middle",verticalAnchor:"middle"},k)},hz={offset:5};function Fs(e){var t=Mn(e,hz),{viewBox:r,position:n,value:a,children:i,content:s,className:c="",textBreakAll:f,labelRef:d}=t,h=oz(),m=d3(),x=n==="center"?m:h??m,g=r||x;if(!g||Yr(a)&&Yr(i)&&!j.isValidElement(s)&&typeof s!="function")return null;var y=gr(gr({},t),{},{viewBox:g});if(j.isValidElement(s)){var{labelRef:v}=y,b=ez(y,ZU);return j.cloneElement(s,b)}var N;if(typeof s=="function"){if(N=j.createElement(s,y),j.isValidElement(N))return N}else N=lz(t);var E=h3(g),S=Dr(t,!0);if(E&&(n==="insideStart"||n==="insideEnd"||n==="end"))return uz(t,n,N,S,g);var C=E?fz(g,t.offset,t.position):dz(t,g);return j.createElement(pm,Li({ref:d,className:wt("recharts-label",c)},S,C,{breakAll:f}),N)}Fs.displayName="Label";var mz=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?j.createElement(Fs,Li({key:"label-implicit"},n)):bi(e)?j.createElement(Fs,Li({key:"label-implicit",value:e},n)):j.isValidElement(e)?e.type===Fs?j.cloneElement(e,gr({key:"label-implicit"},n)):j.createElement(Fs,Li({key:"label-implicit",content:e},n)):tw(e)?j.createElement(Fs,Li({key:"label-implicit",content:e},n)):e&&typeof e=="object"?j.createElement(Fs,Li({},e,{key:"label-implicit"},n)):null};function pz(e){var{label:t}=e,r=d3();return mz(t,r)||null}var Mg={},Rg={},ak;function xz(){return ak||(ak=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Rg)),Rg}var Lg={},ik;function gz(){return ik||(ik=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Lg)),Lg}var sk;function vz(){return sk||(sk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xz(),r=gz(),n=F1();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(Mg)),Mg}var Bg,ok;function yz(){return ok||(ok=1,Bg=vz().last),Bg}var wz=yz();const bz=Ni(wz);var Sz=["valueAccessor"],Nz=["dataKey","clockWise","id","textBreakAll"];function uh(){return uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uh.apply(null,arguments)}function lk(e,t){if(e==null)return{};var r,n,a=_z(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _z(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ez=e=>Array.isArray(e.value)?bz(e.value):e.value,m3=j.createContext(void 0),kz=m3.Provider,p3=j.createContext(void 0),jz=p3.Provider;function Cz(){return j.useContext(m3)}function Az(){return j.useContext(p3)}function A0(e){var{valueAccessor:t=Ez}=e,r=lk(e,Sz),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,c=lk(r,Nz),f=Cz(),d=Az(),h=f||d;return!h||!h.length?null:j.createElement(Yn,{className:"recharts-label-list"},h.map((m,x)=>{var g,y=Yr(n)?t(m,x):ir(m&&m.payload,n),v=Yr(i)?{}:{id:"".concat(i,"-").concat(x)};return j.createElement(Fs,uh({},Dr(m,!0),c,v,{fill:(g=r.fill)!==null&&g!==void 0?g:m.fill,parentViewBox:m.parentViewBox,value:y,textBreakAll:s,viewBox:m.viewBox,key:"label-".concat(x),index:x}))}))}A0.displayName="LabelList";function x3(e){var{label:t}=e;return t?t===!0?j.createElement(A0,{key:"labelList-implicit"}):j.isValidElement(t)||tw(t)?j.createElement(A0,{key:"labelList-implicit",content:t}):typeof t=="object"?j.createElement(A0,uh({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var g3=e=>e.graphicalItems.polarItems,Tz=Se([er,Of],Ay),rw=Se([g3,yr,Tz],Py),Pz=Se([rw],Oy),nw=Se([Pz,gy],Fy),Oz=Se([nw,yr,rw],Iy),Fz=Se([nw,yr,rw],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=ir(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:ir(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),ck=()=>{},Dz=Se([yr,wT,ck,Fz,ck,Et,er],Ry),v3=Se([yr,Et,nw,Oz,Pf,er,Dz],Ly),Iz=Se([v3,yr,kc],Uy);Se([yr,v3,Iz,er],Wy);var Mz={radiusAxis:{},angleAxis:{}},y3=xa({name:"polarAxis",initialState:Mz,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Sle,removeRadiusAxis:Nle,addAngleAxis:_le,removeAngleAxis:Ele}=y3.actions,Rz=y3.reducer;function uk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uk(Object(r),!0).forEach(function(n){Lz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lz(e,t,r){return(t=Bz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bz(e){var t=$z(e,"string");return typeof t=="symbol"?t:t+""}function $z(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uz=(e,t)=>t,aw=Se([g3,Uz],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),zz=[],iw=(e,t,r)=>r?.length===0?zz:r,w3=Se([gy,aw,iw],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>fk(fk({},t.presentationProps),i.props))),a!=null)return a}}),Wz=Se([w3,aw,iw],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=ir(n,t.nameKey,t.name),c;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?c=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?c=n.fill:c=t.fill,{value:Kh(s,t.dataKey),color:c,payload:n,type:t.legendType}})}),Hz=Se([w3,aw,iw,Mr],(e,t,r,n)=>{if(!(t==null||e==null))return WW({offset:n,pieSettings:t,displayedData:e,cells:r})}),$g={},dk;function Vz(){return dk||(dk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})($g)),$g}var Ug,hk;function Kz(){return hk||(hk=1,Ug=Vz().isPlainObject),Ug}var Gz=Kz();const Xz=Ni(Gz);function mk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mk(Object(r),!0).forEach(function(n){qz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qz(e,t,r){return(t=Yz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yz(e){var t=Jz(e,"string");return typeof t=="symbol"?t:t+""}function Jz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fh(){return fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fh.apply(null,arguments)}var xk=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},Qz={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Zz=e=>{var t=Mn(e,Qz),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:c}=t,{animationEasing:f,animationDuration:d,animationBegin:h,isUpdateAnimationActive:m}=t,x=j.useRef(),[g,y]=j.useState(-1),v=j.useRef(a),b=j.useRef(i),N=j.useRef(s),E=j.useRef(r),S=j.useRef(n),C=Zh(e,"trapezoid-");if(j.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var ce=x.current.getTotalLength();ce&&y(ce)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var T=wt("recharts-trapezoid",c);if(!m)return j.createElement("g",null,j.createElement("path",fh({},Dr(t,!0),{className:T,d:xk(r,n,a,i,s)})));var k=v.current,P=b.current,D=N.current,R=E.current,q=S.current,M="0px ".concat(g===-1?1:g,"px"),z="".concat(g,"px 0px"),ie=HC(["strokeDasharray"],d,f);return j.createElement(Qh,{animationId:C,key:C,canBegin:g>0,duration:d,easing:f,isActive:m,begin:h},ce=>{var ae=un(k,a,ce),me=un(P,i,ce),de=un(D,s,ce),he=un(R,r,ce),J=un(q,n,ce);x.current&&(v.current=ae,b.current=me,N.current=de,E.current=he,S.current=J);var xe=ce>0?{transition:ie,strokeDasharray:z}:{strokeDasharray:M};return j.createElement("path",fh({},Dr(t,!0),{className:T,d:xk(he,J,ae,me,de),ref:x,style:pk(pk({},xe),t.style)}))})},eW=["option","shapeType","propTransformer","activeClassName","isActive"];function tW(e,t){if(e==null)return{};var r,n,a=rW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function gk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gk(Object(r),!0).forEach(function(n){nW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nW(e,t,r){return(t=aW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aW(e){var t=iW(e,"string");return typeof t=="symbol"?t:t+""}function iW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sW(e,t){return dh(dh({},t),e)}function oW(e,t){return e==="symbols"}function vk(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return j.createElement(XC,r);case"trapezoid":return j.createElement(Zz,r);case"sector":return j.createElement(JC,r);case"symbols":if(oW(t))return j.createElement(T1,r);break;default:return null}}function lW(e){return j.isValidElement(e)?e.props:e}function b3(e){var{option:t,shapeType:r,propTransformer:n=sW,activeClassName:a="recharts-active-shape",isActive:i}=e,s=tW(e,eW),c;if(j.isValidElement(t))c=j.cloneElement(t,dh(dh({},s),lW(t)));else if(typeof t=="function")c=t(s);else if(Xz(t)&&typeof t!="boolean"){var f=n(t,s);c=j.createElement(vk,{shapeType:r,elementProps:f})}else{var d=s;c=j.createElement(vk,{shapeType:r,elementProps:d})}return i?j.createElement(Yn,{className:a},c):c}var sw=(e,t)=>{var r=lr();return(n,a)=>i=>{e?.(n,a,i),r(MT({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},ow=e=>{var t=lr();return(r,n)=>a=>{e?.(r,n,a),t(HB())}},lw=(e,t)=>{var r=lr();return(n,a)=>i=>{e?.(n,a,i),r(VB({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function S3(e){var{fn:t,args:r}=e,n=lr(),a=Ba();return j.useEffect(()=>{if(!a){var i=t(r);return n(UB(i)),()=>{n(zB(i))}}},[t,r,n,a]),null}var N3=()=>{};function cW(e){var{legendPayload:t}=e,r=lr(),n=Ba();return j.useEffect(()=>n?N3:(r($C(t)),()=>{r(UC(t))}),[r,n,t]),null}function uW(e){var{legendPayload:t}=e,r=lr(),n=Ze(Et);return j.useEffect(()=>n!=="centric"&&n!=="radial"?N3:(r($C(t)),()=>{r(UC(t))}),[r,n,t]),null}var zg,fW=()=>{var[e]=j.useState(()=>Xu("uid-"));return e},dW=(zg=s5.useId)!==null&&zg!==void 0?zg:fW;function hW(e,t){var r=dW();return t||(e?"".concat(e,"-").concat(r):r)}var mW=j.createContext(void 0),_3=e=>{var{id:t,type:r,children:n}=e,a=hW("recharts-".concat(r),t);return j.createElement(mW.Provider,{value:a},n(a))},pW={cartesianItems:[],polarItems:[]},E3=xa({name:"graphicalItems",initialState:pW,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=Hi(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=Hi(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Hi(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:xW,replaceCartesianGraphicalItem:gW,removeCartesianGraphicalItem:vW,addPolarGraphicalItem:yW,removePolarGraphicalItem:wW}=E3.actions,bW=E3.reducer;function SW(e){var t=lr(),r=j.useRef(null);return j.useEffect(()=>{r.current===null?t(xW(e)):r.current!==e&&t(gW({prev:r.current,next:e})),r.current=e},[t,e]),j.useEffect(()=>()=>{r.current&&(t(vW(r.current)),r.current=null)},[t]),null}function NW(e){var t=lr();return j.useEffect(()=>(t(yW(e)),()=>{t(wW(e))}),[t,e]),null}var _W=["onMouseEnter","onClick","onMouseLeave"],EW=["id"],kW=["id"];function cw(e,t){if(e==null)return{};var r,n,a=jW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yk(Object(r),!0).forEach(function(n){CW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CW(e,t,r){return(t=AW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AW(e){var t=TW(e,"string");return typeof t=="symbol"?t:t+""}function TW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hs(){return Hs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hs.apply(null,arguments)}function PW(e){var t=j.useMemo(()=>E1(e.children,zi),[e.children]),r=Ze(n=>Wz(n,e.id,t));return r==null?null:j.createElement(uW,{legendPayload:r})}function OW(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:c,hide:f,tooltipType:d}=e;return{dataDefinedOnItem:n.map(h=>h.tooltipPayload),positions:n.map(h=>h.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:Kh(c,t),hide:f,type:d,color:s,unit:""}}}var FW=(e,t)=>e>t?"start":e<t?"end":"middle",DW=(e,t,r)=>_n(typeof t=="function"?t(e):t,r,r*.8),IW=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,c=PC(i,s),f=a+_n(e.cx,i,i/2),d=n+_n(e.cy,s,s/2),h=_n(e.innerRadius,c,0),m=DW(r,e.outerRadius,c),x=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:f,cy:d,innerRadius:h,outerRadius:m,maxRadius:x}},MW=(e,t)=>{var r=Xr(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function RW(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var LW=(e,t)=>{if(j.isValidElement(e))return j.cloneElement(e,t);if(typeof e=="function")return e(t);var r=wt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return j.createElement(WC,Hs({},t,{type:"linear",className:r}))},BW=(e,t,r)=>{if(j.isValidElement(e))return j.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),j.isValidElement(n)))return n;var a=wt("recharts-pie-label-text",RW(e));return j.createElement(pm,Hs({},t,{alignmentBaseline:"middle",className:a}),n)};function $W(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var c=Zs(r),f=Dr(a,!1),d=Dr(i,!1),h=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,m=t.map((x,g)=>{var y=(x.startAngle+x.endAngle)/2,v=Er(x.cx,x.cy,x.outerRadius+h,y),b=Qt(Qt(Qt(Qt({},c),x),{},{stroke:"none"},f),{},{index:g,textAnchor:FW(v.x,x.cx)},v),N=Qt(Qt(Qt(Qt({},c),x),{},{fill:"none",stroke:x.fill},d),{},{index:g,points:[Er(x.cx,x.cy,x.outerRadius,y),v],key:"line"});return j.createElement(Yn,{key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(g)},i&&LW(i,N),BW(a,b,ir(x,s)))});return j.createElement(Yn,{className:"recharts-pie-labels"},m)}function UW(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?j.createElement(x3,{label:a}):j.createElement($W,{sectors:t,props:r,showLabels:n})}function zW(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=Ze(qo),{onMouseEnter:s,onClick:c,onMouseLeave:f}=a,d=cw(a,_W),h=sw(s,a.dataKey),m=ow(f),x=lw(c,a.dataKey);return t==null||t.length===0?null:j.createElement(j.Fragment,null,t.map((g,y)=>{if(g?.startAngle===0&&g?.endAngle===0&&t.length!==1)return null;var v=r&&String(y)===i,b=i?n:null,N=v?r:b,E=Qt(Qt({},g),{},{stroke:g.stroke,tabIndex:-1,[MC]:y,[RC]:a.dataKey});return j.createElement(Yn,Hs({tabIndex:-1,className:"recharts-pie-sector"},Nf(d,g,y),{onMouseEnter:h(g,y),onMouseLeave:m(g,y),onClick:x(g,y),key:"sector-".concat(g?.startAngle,"-").concat(g?.endAngle,"-").concat(g.midAngle,"-").concat(y)}),j.createElement(b3,Hs({option:N,isActive:v,shapeType:"sector"},E)))}))}function WW(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:c,endAngle:f,dataKey:d,nameKey:h,tooltipType:m}=r,x=Math.abs(r.minAngle),g=MW(c,f),y=Math.abs(g),v=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,b=n.filter(k=>ir(k,d,0)!==0).length,N=(y>=360?b:b-1)*v,E=y-b*x-N,S=n.reduce((k,P)=>{var D=ir(P,d,0);return k+(et(D)?D:0)},0),C;if(S>0){var T;C=n.map((k,P)=>{var D=ir(k,d,0),R=ir(k,h,P),q=IW(r,i,k),M=(et(D)?D:0)/S,z,ie=Qt(Qt({},k),a&&a[P]&&a[P].props);P?z=T.endAngle+Xr(g)*v*(D!==0?1:0):z=c;var ce=z+Xr(g)*((D!==0?x:0)+M*E),ae=(z+ce)/2,me=(q.innerRadius+q.outerRadius)/2,de=[{name:R,value:D,payload:ie,dataKey:d,type:m}],he=Er(q.cx,q.cy,me,ae);return T=Qt(Qt(Qt(Qt({},r.presentationProps),{},{percent:M,cornerRadius:s,name:R,tooltipPayload:de,midAngle:ae,middleRadius:me,tooltipPosition:he},ie),q),{},{value:D,startAngle:z,endAngle:ce,payload:ie,paddingAngle:Xr(g)*v}),T})}return C}function HW(e){var{showLabels:t,sectors:r,children:n}=e,a=j.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return j.createElement(jz,{value:t?a:void 0},n)}function VW(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:c,activeShape:f,inactiveShape:d,onAnimationStart:h,onAnimationEnd:m}=t,x=Zh(t,"recharts-pie-"),g=r.current,[y,v]=j.useState(!1),b=j.useCallback(()=>{typeof m=="function"&&m(),v(!1)},[m]),N=j.useCallback(()=>{typeof h=="function"&&h(),v(!0)},[h]);return j.createElement(HW,{showLabels:!y,sectors:n},j.createElement(Qh,{animationId:x,begin:i,duration:s,isActive:a,easing:c,onAnimationStart:N,onAnimationEnd:b,key:x},E=>{var S=[],C=n&&n[0],T=C?.startAngle;return n?.forEach((k,P)=>{var D=g&&g[P],R=P>0?Vo(k,"paddingAngle",0):0;if(D){var q=un(D.endAngle-D.startAngle,k.endAngle-k.startAngle,E),M=Qt(Qt({},k),{},{startAngle:T+R,endAngle:T+q+R});S.push(M),T=M.endAngle}else{var{endAngle:z,startAngle:ie}=k,ce=un(0,z-ie,E),ae=Qt(Qt({},k),{},{startAngle:T+R,endAngle:T+ce+R});S.push(ae),T=ae.endAngle}}),r.current=S,j.createElement(Yn,null,j.createElement(zW,{sectors:S,activeShape:f,inactiveShape:d,allOtherPieProps:t}))}),j.createElement(UW,{showLabels:!y,sectors:n,props:t}),t.children)}var KW={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!il.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function GW(e){var{id:t}=e,r=cw(e,EW),{hide:n,className:a,rootTabIndex:i}=e,s=j.useMemo(()=>E1(e.children,zi),[e.children]),c=Ze(h=>Hz(h,t,s)),f=j.useRef(null),d=wt("recharts-pie",a);return n||c==null?(f.current=null,j.createElement(Yn,{tabIndex:i,className:d})):j.createElement(j.Fragment,null,j.createElement(S3,{fn:OW,args:Qt(Qt({},e),{},{sectors:c})}),j.createElement(Yn,{tabIndex:i,className:d},j.createElement(VW,{props:Qt(Qt({},r),{},{sectors:c}),previousSectorsRef:f})))}function Lu(e){var t=Mn(e,KW),{id:r}=t,n=cw(t,kW),a=Zs(n);return j.createElement(_3,{id:r,type:"pie"},i=>j.createElement(j.Fragment,null,j.createElement(NW,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),j.createElement(PW,Hs({},n,{id:i})),j.createElement(GW,Hs({},n,{id:i}))))}Lu.displayName="Pie";function wk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wk(Object(r),!0).forEach(function(n){XW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XW(e,t,r){return(t=qW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qW(e){var t=YW(e,"string");return typeof t=="symbol"?t:t+""}function YW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JW={xAxis:{},yAxis:{},zAxis:{}},k3=xa({name:"cartesianAxis",initialState:JW,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=bk(bk({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:QW,removeXAxis:ZW,addYAxis:eH,removeYAxis:tH,addZAxis:kle,removeZAxis:jle,updateYAxisWidth:rH}=k3.actions,nH=k3.reducer,aH=Se([Mr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),iH=Se([aH,ts,rs],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),j3=()=>Ze(iH),sH="Invariant failed";function oH(e,t){throw new Error(sH)}var lH=["x","y"];function Yv(){return Yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yv.apply(null,arguments)}function Sk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ku(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sk(Object(r),!0).forEach(function(n){cH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cH(e,t,r){return(t=uH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uH(e){var t=fH(e,"string");return typeof t=="symbol"?t:t+""}function fH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dH(e,t){if(e==null)return{};var r,n,a=hH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function mH(e,t){var{x:r,y:n}=e,a=dH(e,lH),i="".concat(r),s=parseInt(i,10),c="".concat(n),f=parseInt(c,10),d="".concat(t.height||a.height),h=parseInt(d,10),m="".concat(t.width||a.width),x=parseInt(m,10);return ku(ku(ku(ku(ku({},t),a),s?{x:s}:{}),f?{y:f}:{}),{},{height:h,width:x,name:t.name,radius:t.radius})}function uw(e){return j.createElement(b3,Yv({shapeType:"rectangle",propTransformer:mH,activeClassName:"recharts-active-bar"},e))}var pH=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(et(t))return t;var i=et(n)||Yr(n);return i?t(n,a):(i||oH(),r)}},xH={},C3=xa({name:"errorBars",initialState:xH,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:Cle,replaceErrorBar:Ale,removeErrorBar:Tle}=C3.actions,gH=C3.reducer,vH=["children"];function yH(e,t){if(e==null)return{};var r,n,a=wH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function wH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bH={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},SH=j.createContext(bH);function NH(e){var{children:t}=e,r=yH(e,vH);return j.createElement(SH.Provider,{value:r},t)}function A3(e,t){var r,n,a=Ze(d=>as(d,e)),i=Ze(d=>is(d,t)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:ra.allowDataOverflow,c=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:na.allowDataOverflow,f=s||c;return{needClip:f,needClipX:s,needClipY:c}}function _H(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=j3(),{needClipX:i,needClipY:s,needClip:c}=A3(t,r);if(!c)return null;var{x:f,y:d,width:h,height:m}=a;return j.createElement("clipPath",{id:"clipPath-".concat(n)},j.createElement("rect",{x:i?f:f-h/2,y:s?d:d-m/2,width:i?h:h*2,height:s?m:m*2}))}var EH=["onMouseEnter","onMouseLeave","onClick"],kH=["value","background","tooltipPosition"],jH=["id"],CH=["onMouseEnter","onClick","onMouseLeave"];function Vs(){return Vs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vs.apply(null,arguments)}function Nk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nk(Object(r),!0).forEach(function(n){AH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AH(e,t,r){return(t=TH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TH(e){var t=PH(e,"string");return typeof t=="symbol"?t:t+""}function PH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hh(e,t){if(e==null)return{};var r,n,a=OH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function OH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var FH=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Kh(r,t),payload:e}]};function DH(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:c}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:Kh(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:c}}}function IH(e){var t=Ze(qo),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:c,onClick:f}=i,d=hh(i,EH),h=sw(s,n),m=ow(c),x=lw(f,n);if(!a||r==null)return null;var g=Dr(a,!1);return j.createElement(j.Fragment,null,r.map((y,v)=>{var{value:b,background:N,tooltipPosition:E}=y,S=hh(y,kH);if(!N)return null;var C=h(y,v),T=m(y,v),k=x(y,v),P=Fn(Fn(Fn(Fn(Fn({option:a,isActive:String(v)===t},S),{},{fill:"#eee"},N),g),Nf(d,y,v)),{},{onMouseEnter:C,onMouseLeave:T,onClick:k,dataKey:n,index:v,className:"recharts-bar-background-rectangle"});return j.createElement(uw,Vs({key:"background-bar-".concat(P.index)},P))}))}function MH(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return Fn(Fn({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return j.createElement(kz,{value:t?a:void 0},r)}function RH(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,c=Ze(qo),f=Ze(qT),d=r&&String(i)===c&&(f==null||s===f),h=d?r:t;return j.createElement(uw,Vs({},n,a,{isActive:d,option:h,index:i,dataKey:s}))}function LH(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return j.createElement(uw,Vs({},r,n,{isActive:!1,option:t,index:a,dataKey:i}))}function BH(e){var{data:t,props:r}=e,n=Zs(r),{id:a}=n,i=hh(n,jH),{shape:s,dataKey:c,activeBar:f}=r,{onMouseEnter:d,onClick:h,onMouseLeave:m}=r,x=hh(r,CH),g=sw(d,c),y=ow(m),v=lw(h,c);return t?j.createElement(j.Fragment,null,t.map((b,N)=>j.createElement(Yn,Vs({className:"recharts-bar-rectangle"},Nf(x,b,N),{onMouseEnter:g(b,N),onMouseLeave:y(b,N),onClick:v(b,N),key:"rectangle-".concat(b?.x,"-").concat(b?.y,"-").concat(b?.value,"-").concat(N)}),f?j.createElement(RH,{shape:s,activeBar:f,baseProps:i,entry:b,index:N,dataKey:c}):j.createElement(LH,{shape:s,baseProps:i,entry:b,index:N,dataKey:c})))):null}function $H(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:c,animationEasing:f,onAnimationEnd:d,onAnimationStart:h}=t,m=r.current,x=Zh(t,"recharts-bar-"),[g,y]=j.useState(!1),v=!g,b=j.useCallback(()=>{typeof d=="function"&&d(),y(!1)},[d]),N=j.useCallback(()=>{typeof h=="function"&&h(),y(!0)},[h]);return j.createElement(MH,{showLabels:v,rects:n},j.createElement(Qh,{animationId:x,begin:s,duration:c,isActive:i,easing:f,onAnimationEnd:b,onAnimationStart:N,key:x},E=>{var S=E===1?n:n?.map((C,T)=>{var k=m&&m[T];if(k)return Fn(Fn({},C),{},{x:un(k.x,C.x,E),y:un(k.y,C.y,E),width:un(k.width,C.width,E),height:un(k.height,C.height,E)});if(a==="horizontal"){var P=un(0,C.height,E);return Fn(Fn({},C),{},{y:C.y+C.height-P,height:P})}var D=un(0,C.width,E);return Fn(Fn({},C),{},{width:D})});return E>0&&(r.current=S??null),S==null?null:j.createElement(Yn,null,j.createElement(BH,{props:t,data:S}))}),j.createElement(x3,{label:t.label}),t.children)}function UH(e){var t=j.useRef(null);return j.createElement($H,{previousRectanglesRef:t,props:e})}var T3=0,zH=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:ir(e,t)}};class WH extends j.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:c,background:f,id:d}=this.props;if(t||r==null)return null;var h=wt("recharts-bar",a),m=d;return j.createElement(Yn,{className:h,id:d},c&&j.createElement("defs",null,j.createElement(_H,{clipPathId:m,xAxisId:i,yAxisId:s})),j.createElement(Yn,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(m,")"):void 0},j.createElement(IH,{data:r,dataKey:n,background:f,allOtherBarProps:this.props}),j.createElement(UH,this.props)))}}var HH={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!il.isSsr,legendType:"rect",minPointSize:T3,xAxisId:0,yAxisId:0};function VH(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:c,animationDuration:f,animationEasing:d,isAnimationActive:h}=e,{needClip:m}=A3(t,r),x=K1(),g=Ba(),y=E1(e.children,zi),v=Ze(E=>yV(E,t,r,g,e.id,y));if(x!=="vertical"&&x!=="horizontal")return null;var b,N=v?.[0];return N==null||N.height==null||N.width==null?b=0:b=x==="vertical"?N.height/2:N.width/2,j.createElement(NH,{xAxisId:t,yAxisId:r,data:v,dataPointFormatter:zH,errorBarOffset:b},j.createElement(WH,Vs({},e,{layout:x,needClip:m,data:v,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:c,animationDuration:f,animationEasing:d,isAnimationActive:h})))}function KH(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:c,xAxisTicks:f,yAxisTicks:d,stackedData:h,displayedData:m,offset:x,cells:g,parentViewBox:y}=e,v=t==="horizontal"?c:s,b=h?v.scale.domain():null,N=s8({numericAxis:v});return m.map((E,S)=>{var C,T,k,P,D,R;h?C=e8(h[S],b):(C=ir(E,r),Array.isArray(C)||(C=[N,C]));var q=pH(n,T3)(C[1],S);if(t==="horizontal"){var M,[z,ie]=[c.scale(C[0]),c.scale(C[1])];T=u_({axis:s,ticks:f,bandSize:i,offset:a.offset,entry:E,index:S}),k=(M=ie??z)!==null&&M!==void 0?M:void 0,P=a.size;var ce=z-ie;if(D=da(ce)?0:ce,R={x:T,y:x.top,width:P,height:x.height},Math.abs(q)>0&&Math.abs(D)<Math.abs(q)){var ae=Xr(D||q)*(Math.abs(q)-Math.abs(D));k-=ae,D+=ae}}else{var[me,de]=[s.scale(C[0]),s.scale(C[1])];if(T=me,k=u_({axis:c,ticks:d,bandSize:i,offset:a.offset,entry:E,index:S}),P=de-me,D=a.size,R={x:x.left,y:k,width:x.width,height:D},Math.abs(q)>0&&Math.abs(P)<Math.abs(q)){var he=Xr(P||q)*(Math.abs(q)-Math.abs(P));P+=he}}if(T==null||k==null||P==null||D==null)return null;var J=Fn(Fn({},E),{},{x:T,y:k,width:P,height:D,value:h?C:C[1],payload:E,background:R,tooltipPosition:{x:T+P/2,y:k+D/2},parentViewBox:y},g&&g[S]&&g[S].props);return J}).filter(Boolean)}function GH(e){var t=Mn(e,HH),r=Ba();return j.createElement(_3,{id:t.id,type:"bar"},n=>j.createElement(j.Fragment,null,j.createElement(cW,{legendPayload:FH(t)}),j.createElement(S3,{fn:DH,args:t}),j.createElement(SW,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:i8(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),j.createElement(VH,Vs({},t,{id:n}))))}var P3=j.memo(GH);P3.displayName="Bar";function _k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_k(Object(r),!0).forEach(function(n){XH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_k(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XH(e,t,r){return(t=qH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qH(e){var t=YH(e,"string");return typeof t=="symbol"?t:t+""}function YH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JH=(e,t)=>t,QH=(e,t,r)=>r,ZH=(e,t,r,n)=>n,eV=(e,t,r,n,a)=>a,Lf=Se([Ty,eV],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),tV=Se([Lf],e=>e?.maxBarSize),rV=(e,t,r,n,a,i)=>i,Ek=(e,t,r)=>{var n=r??e;if(!Yr(n))return _n(n,t,0)},nV=Se([Et,Ty,JH,QH,ZH],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),aV=(e,t,r,n)=>{var a=Et(e);return a==="horizontal"?Hv(e,"yAxis",r,n):Hv(e,"xAxis",t,n)},iV=(e,t,r)=>{var n=Et(e);return n==="horizontal"?jE(e,"xAxis",t):jE(e,"yAxis",r)},sV=(e,t,r)=>{var n={},a=e.filter(cm),i=e.filter(d=>d.stackId==null),s=a.reduce((d,h)=>(d[h.stackId]||(d[h.stackId]=[]),d[h.stackId].push(h),d),n),c=Object.entries(s).map(d=>{var[h,m]=d,x=m.map(y=>y.dataKey),g=Ek(t,r,m[0].barSize);return{stackId:h,dataKeys:x,barSize:g}}),f=i.map(d=>{var h=[d.dataKey].filter(x=>x!=null),m=Ek(t,r,d.barSize);return{stackId:void 0,dataKeys:h,barSize:m}});return[...c,...f]},oV=Se([nV,$9,iV],sV),lV=(e,t,r,n,a)=>{var i,s,c=Lf(e,t,r,n,a);if(c!=null){var f=Et(e),d=GA(e),{maxBarSize:h}=c,m=Yr(h)?d:h,x,g;return f==="horizontal"?(x=mc(e,"xAxis",t,n),g=hc(e,"xAxis",t,n)):(x=mc(e,"yAxis",r,n),g=hc(e,"yAxis",r,n)),(i=(s=U1(x,g,!0))!==null&&s!==void 0?s:m)!==null&&i!==void 0?i:0}},O3=(e,t,r,n)=>{var a=Et(e),i,s;return a==="horizontal"?(i=mc(e,"xAxis",t,n),s=hc(e,"xAxis",t,n)):(i=mc(e,"yAxis",r,n),s=hc(e,"yAxis",r,n)),U1(i,s)};function cV(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=_n(e,r,0,!0),c,f=[];if(ma(n[0].barSize)){var d=!1,h=r/i,m=n.reduce((N,E)=>N+(E.barSize||0),0);m+=(i-1)*s,m>=r&&(m-=(i-1)*s,s=0),m>=r&&h>0&&(d=!0,h*=.9,m=i*h);var x=(r-m)/2>>0,g={offset:x-s,size:0};c=n.reduce((N,E)=>{var S,C={stackId:E.stackId,dataKeys:E.dataKeys,position:{offset:g.offset+g.size+s,size:d?h:(S=E.barSize)!==null&&S!==void 0?S:0}},T=[...N,C];return g=T[T.length-1].position,T},f)}else{var y=_n(t,r,0,!0);r-2*y-(i-1)*s<=0&&(s=0);var v=(r-2*y-(i-1)*s)/i;v>1&&(v>>=0);var b=ma(a)?Math.min(v,a):v;c=n.reduce((N,E,S)=>[...N,{stackId:E.stackId,dataKeys:E.dataKeys,position:{offset:y+(v+s)*S+(v-b)/2,size:b}}],f)}return c}}var uV=(e,t,r,n,a,i,s)=>{var c=Yr(s)?t:s,f=cV(r,n,a!==i?a:i,e,c);return a!==i&&f!=null&&(f=f.map(d=>p0(p0({},d),{},{position:p0(p0({},d.position),{},{offset:d.position.offset-a/2})}))),f},fV=Se([oV,GA,B9,XA,lV,O3,tV],uV),dV=(e,t,r,n)=>mc(e,"xAxis",t,n),hV=(e,t,r,n)=>mc(e,"yAxis",r,n),mV=(e,t,r,n)=>hc(e,"xAxis",t,n),pV=(e,t,r,n)=>hc(e,"yAxis",r,n),xV=Se([fV,Lf],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),gV=(e,t)=>{var r=jy(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},vV=Se([aV,Lf],gV),yV=Se([Mr,z1,dV,hV,mV,pV,xV,Et,vy,O3,vV,Lf,rV],(e,t,r,n,a,i,s,c,f,d,h,m,x)=>{var{chartData:g,dataStartIndex:y,dataEndIndex:v}=f;if(!(m==null||s==null||t==null||c!=="horizontal"&&c!=="vertical"||r==null||n==null||a==null||i==null||d==null)){var{data:b}=m,N;if(b!=null&&b.length>0?N=b:N=g?.slice(y,v+1),N!=null)return KH({layout:c,barSettings:m,pos:s,parentViewBox:t,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:h,displayedData:N,offset:e,cells:x})}}),F3=e=>{var{chartData:t}=e,r=lr(),n=Ba();return j.useEffect(()=>n?()=>{}:(r(RE(t)),()=>{r(RE(void 0))}),[t,r,n]),null},kk={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},D3=xa({name:"brush",initialState:kk,reducers:{setBrushSettings(e,t){return t.payload==null?kk:t.payload}}}),{setBrushSettings:Ple}=D3.actions,wV=D3.reducer;function bV(e,t,r){return(t=SV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SV(e){var t=NV(e,"string");return typeof t=="symbol"?t:t+""}function NV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class fw{static create(t){return new fw(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}bV(fw,"EPS",1e-4);function _V(e){return(e%180+180)%180}var EV=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=_V(a),s=i*Math.PI/180,c=Math.atan(n/r),f=s>c&&s<Math.PI-c?n/Math.sin(s):r/Math.cos(s);return Math.abs(f)},kV={dots:[],areas:[],lines:[]},I3=xa({name:"referenceElements",initialState:kV,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Hi(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Hi(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Hi(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Ole,removeDot:Fle,addArea:Dle,removeArea:Ile,addLine:Mle,removeLine:Rle}=I3.actions,jV=I3.reducer,CV=j.createContext(void 0),AV=e=>{var{children:t}=e,[r]=j.useState("".concat(Xu("recharts"),"-clip")),n=j3();if(n==null)return null;var{x:a,y:i,width:s,height:c}=n;return j.createElement(CV.Provider,{value:r},j.createElement("defs",null,j.createElement("clipPath",{id:r},j.createElement("rect",{x:a,y:i,height:c,width:s}))),t)};function pc(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function M3(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function TV(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return EV(n,r)}function PV(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:c}=e;return t===1?{start:n?a:i,end:n?a+s:i+c}:{start:n?a+s:i+c,end:n?a:i}}function mh(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function OV(e,t){return M3(e,t+1)}function FV(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:c}=t,f=0,d=1,h=s,m=function(){var y=n?.[f];if(y===void 0)return{v:M3(n,d)};var v=f,b,N=()=>(b===void 0&&(b=r(y,v)),b),E=y.coordinate,S=f===0||mh(e,E,N,h,c);S||(f=0,h=s,d+=1),S&&(h=E+e*(N()/2+a),f+=d)},x;d<=i.length;)if(x=m(),x)return x.v;return[]}function jk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jk(Object(r),!0).forEach(function(n){DV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DV(e,t,r){return(t=IV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IV(e){var t=MV(e,"string");return typeof t=="symbol"?t:t+""}function MV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RV(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:c}=t,{end:f}=t,d=function(x){var g=i[x],y,v=()=>(y===void 0&&(y=r(g,x)),y);if(x===s-1){var b=e*(g.coordinate+e*v()/2-f);i[x]=g=gn(gn({},g),{},{tickCoord:b>0?g.coordinate-b*e:g.coordinate})}else i[x]=g=gn(gn({},g),{},{tickCoord:g.coordinate});var N=mh(e,g.tickCoord,v,c,f);N&&(f=g.tickCoord-e*(v()/2+a),i[x]=gn(gn({},g),{},{isShow:!0}))},h=s-1;h>=0;h--)d(h);return i}function LV(e,t,r,n,a,i){var s=(n||[]).slice(),c=s.length,{start:f,end:d}=t;if(i){var h=n[c-1],m=r(h,c-1),x=e*(h.coordinate+e*m/2-d);s[c-1]=h=gn(gn({},h),{},{tickCoord:x>0?h.coordinate-x*e:h.coordinate});var g=mh(e,h.tickCoord,()=>m,f,d);g&&(d=h.tickCoord-e*(m/2+a),s[c-1]=gn(gn({},h),{},{isShow:!0}))}for(var y=i?c-1:c,v=function(E){var S=s[E],C,T=()=>(C===void 0&&(C=r(S,E)),C);if(E===0){var k=e*(S.coordinate-e*T()/2-f);s[E]=S=gn(gn({},S),{},{tickCoord:k<0?S.coordinate-k*e:S.coordinate})}else s[E]=S=gn(gn({},S),{},{tickCoord:S.coordinate});var P=mh(e,S.tickCoord,T,f,d);P&&(f=S.tickCoord+e*(T()/2+a),s[E]=gn(gn({},S),{},{isShow:!0}))},b=0;b<y;b++)v(b);return s}function dw(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:c,interval:f,tickFormatter:d,unit:h,angle:m}=e;if(!a||!a.length||!n)return[];if(et(f)||il.isSsr){var x;return(x=OV(a,et(f)?f:0))!==null&&x!==void 0?x:[]}var g=[],y=c==="top"||c==="bottom"?"width":"height",v=h&&y==="width"?Ru(h,{fontSize:t,letterSpacing:r}):{width:0,height:0},b=(S,C)=>{var T=typeof d=="function"?d(S.value,C):S.value;return y==="width"?TV(Ru(T,{fontSize:t,letterSpacing:r}),v,m):Ru(T,{fontSize:t,letterSpacing:r})[y]},N=a.length>=2?Xr(a[1].coordinate-a[0].coordinate):1,E=PV(i,N,y);return f==="equidistantPreserveStart"?FV(N,E,b,a,s):(f==="preserveStart"||f==="preserveStartEnd"?g=LV(N,E,b,a,s,f==="preserveStartEnd"):g=RV(N,E,b,a,s),g.filter(S=>S.isShow))}var BV=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){t.forEach(h=>{if(h){var m=h.getBoundingClientRect();m.width>s&&(s=m.width)}});var c=r?r.getBoundingClientRect().width:0,f=a+i,d=s+f+c+(r?n:0);return Math.round(d)}return 0},$V=["axisLine","width","height","className","hide","ticks"],UV=["viewBox"],zV=["viewBox"];function Jv(e,t){if(e==null)return{};var r,n,a=WV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function WV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Yo(){return Yo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yo.apply(null,arguments)}function Ck(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ck(Object(r),!0).forEach(function(n){HV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ck(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HV(e,t,r){return(t=VV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VV(e){var t=KV(e,"string");return typeof t=="symbol"?t:t+""}function KV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hw={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function GV(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:c,otherSvgProps:f}=e;if(!c)return null;var d=Or(Or(Or({},f),Dr(c,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var h=+(i==="top"&&!s||i==="bottom"&&s);d=Or(Or({},d),{},{x1:t,y1:r+h*a,x2:t+n,y2:r+h*a})}else{var m=+(i==="left"&&!s||i==="right"&&s);d=Or(Or({},d),{},{x1:t+m*n,y1:r,x2:t+m*n,y2:r+a})}return j.createElement("line",Yo({},d,{className:wt("recharts-cartesian-axis-line",Vo(c,"className"))}))}function XV(e,t,r,n,a,i,s,c,f){var d,h,m,x,g,y,v=c?-1:1,b=e.tickSize||s,N=et(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":d=h=e.coordinate,x=r+ +!c*a,m=x-v*b,y=m-v*f,g=N;break;case"left":m=x=e.coordinate,h=t+ +!c*n,d=h-v*b,g=d-v*f,y=N;break;case"right":m=x=e.coordinate,h=t+ +c*n,d=h+v*b,g=d+v*f,y=N;break;default:d=h=e.coordinate,x=r+ +c*a,m=x+v*b,y=m+v*f,g=N;break}return{line:{x1:d,y1:m,x2:h,y2:x},tick:{x:g,y}}}function qV(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function YV(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function JV(e){var{option:t,tickProps:r,value:n}=e,a,i=wt(r.className,"recharts-cartesian-axis-tick-value");if(j.isValidElement(t))a=j.cloneElement(t,Or(Or({},r),{},{className:i}));else if(typeof t=="function")a=t(Or(Or({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=wt(s,t?.className)),a=j.createElement(pm,Yo({},r,{className:s}),n)}return a}function QV(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:s,padding:c,tickTextProps:f,orientation:d,mirror:h,x:m,y:x,width:g,height:y,tickSize:v,tickMargin:b,fontSize:N,letterSpacing:E,getTicksConfig:S,events:C}=e,T=dw(Or(Or({},S),{},{ticks:t}),N,E),k=qV(d,h),P=YV(d,h),D=Zs(S),R=Dr(r,!1),q=Or(Or({},D),{},{fill:"none"},Dr(n,!1)),M=T.map((z,ie)=>{var{line:ce,tick:ae}=XV(z,m,x,g,y,d,v,h,b),me=Or(Or(Or(Or({textAnchor:k,verticalAnchor:P},D),{},{stroke:"none",fill:a},R),ae),{},{index:ie,payload:z,visibleTicksCount:T.length,tickFormatter:i,padding:c},f);return j.createElement(Yn,Yo({className:"recharts-cartesian-axis-tick",key:"tick-".concat(z.value,"-").concat(z.coordinate,"-").concat(z.tickCoord)},Nf(C,z,ie)),n&&j.createElement("line",Yo({},q,ce,{className:wt("recharts-cartesian-axis-tick-line",Vo(n,"className"))})),r&&j.createElement(JV,{option:r,tickProps:me,value:"".concat(typeof i=="function"?i(z.value,ie):z.value).concat(s||"")}))});return M.length>0?j.createElement("g",{className:"recharts-cartesian-axis-ticks"},M):null}var ZV=j.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:c}=e,f=Jv(e,$V),[d,h]=j.useState(""),[m,x]=j.useState(""),g=j.useRef([]);j.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return BV({ticks:g.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var y=j.useCallback(v=>{if(v){var b=v.getElementsByClassName("recharts-cartesian-axis-tick-value");g.current=Array.from(b);var N=b[0];if(N){var E=window.getComputedStyle(N),S=E.fontSize,C=E.letterSpacing;(S!==d||C!==m)&&(h(S),x(C))}}},[d,m]);return s||n!=null&&n<=0||a!=null&&a<=0?null:j.createElement(Yn,{className:wt("recharts-cartesian-axis",i),ref:y},j.createElement(GV,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Zs(e)}),j.createElement(QV,{ticks:c,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:d,letterSpacing:m,getTicksConfig:e,events:f}),j.createElement(iz,{x:e.x,y:e.y,width:e.width,height:e.height},j.createElement(pz,{label:e.label}),e.children))}),eK=j.memo(ZV,(e,t)=>{var{viewBox:r}=e,n=Jv(e,UV),{viewBox:a}=t,i=Jv(t,zV);return pc(r,a)&&pc(n,i)}),mw=j.forwardRef((e,t)=>{var r=Mn(e,hw);return j.createElement(eK,Yo({},r,{ref:t}))});mw.displayName="CartesianAxis";var tK=["x1","y1","x2","y2","key"],rK=["offset"],nK=["xAxisId","yAxisId"],aK=["xAxisId","yAxisId"];function Ak(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ak(Object(r),!0).forEach(function(n){iK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ak(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iK(e,t,r){return(t=sK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sK(e){var t=oK(e,"string");return typeof t=="symbol"?t:t+""}function oK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oo(){return Oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oo.apply(null,arguments)}function ph(e,t){if(e==null)return{};var r,n,a=lK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cK=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:c}=e;return j.createElement("rect",{x:n,y:a,ry:c,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function R3(e,t){var r;if(j.isValidElement(e))r=j.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:s,key:c}=t,f=ph(t,tK),d=Zs(f),{offset:h}=d,m=ph(d,rK);r=j.createElement("line",Oo({},m,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:c}))}return r}function uK(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,c=ph(e,nK),f=a.map((d,h)=>{var m=bn(bn({},c),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(h),index:h});return R3(n,m)});return j.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function fK(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,c=ph(e,aK),f=a.map((d,h)=>{var m=bn(bn({},c),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(h),index:h});return R3(n,m)});return j.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function dK(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:c,horizontal:f=!0}=e;if(!f||!t||!t.length)return null;var d=c.map(m=>Math.round(m+a-a)).sort((m,x)=>m-x);a!==d[0]&&d.unshift(0);var h=d.map((m,x)=>{var g=!d[x+1],y=g?a+s-m:d[x+1]-m;if(y<=0)return null;var v=x%t.length;return j.createElement("rect",{key:"react-".concat(x),y:m,x:n,height:y,width:i,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return j.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function hK(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:c,verticalPoints:f}=e;if(!t||!r||!r.length)return null;var d=f.map(m=>Math.round(m+a-a)).sort((m,x)=>m-x);a!==d[0]&&d.unshift(0);var h=d.map((m,x)=>{var g=!d[x+1],y=g?a+s-m:d[x+1]-m;if(y<=0)return null;var v=x%r.length;return j.createElement("rect",{key:"react-".concat(x),x:m,y:i,width:y,height:c,stroke:"none",fill:r[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return j.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var mK=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return FC(dw(bn(bn(bn({},hw),r),{},{ticks:DC(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},pK=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return FC(dw(bn(bn(bn({},hw),r),{},{ticks:DC(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},xK={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function L3(e){var t=H1(),r=V1(),n=LC(),a=bn(bn({},Mn(e,xK)),{},{x:et(e.x)?e.x:n.left,y:et(e.y)?e.y:n.top,width:et(e.width)?e.width:n.width,height:et(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:c,y:f,width:d,height:h,syncWithTicks:m,horizontalValues:x,verticalValues:g}=a,y=Ba(),v=Ze(R=>CE(R,"xAxis",i,y)),b=Ze(R=>CE(R,"yAxis",s,y));if(!et(d)||d<=0||!et(h)||h<=0||!et(c)||c!==+c||!et(f)||f!==+f)return null;var N=a.verticalCoordinatesGenerator||mK,E=a.horizontalCoordinatesGenerator||pK,{horizontalPoints:S,verticalPoints:C}=a;if((!S||!S.length)&&typeof E=="function"){var T=x&&x.length,k=E({yAxis:b?bn(bn({},b),{},{ticks:T?x:b.ticks}):void 0,width:t,height:r,offset:n},T?!0:m);Iu(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(S=k)}if((!C||!C.length)&&typeof N=="function"){var P=g&&g.length,D=N({xAxis:v?bn(bn({},v),{},{ticks:P?g:v.ticks}):void 0,width:t,height:r,offset:n},P?!0:m);Iu(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(C=D)}return j.createElement("g",{className:"recharts-cartesian-grid"},j.createElement(cK,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),j.createElement(dK,Oo({},a,{horizontalPoints:S})),j.createElement(hK,Oo({},a,{verticalPoints:C})),j.createElement(uK,Oo({},a,{offset:n,horizontalPoints:S,xAxis:v,yAxis:b})),j.createElement(fK,Oo({},a,{offset:n,verticalPoints:C,xAxis:v,yAxis:b})))}L3.displayName="CartesianGrid";var gK=["dangerouslySetInnerHTML","ticks"],vK=["id"],yK=["domain"],wK=["domain"];function Qv(){return Qv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qv.apply(null,arguments)}function xh(e,t){if(e==null)return{};var r,n,a=bK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function SK(e){var t=lr();return j.useEffect(()=>(t(QW(e)),()=>{t(ZW(e))}),[e,t]),null}var NK=e=>{var{xAxisId:t,className:r}=e,n=Ze(z1),a=Ba(),i="xAxis",s=Ze(b=>jc(b,i,t,a)),c=Ze(b=>TT(b,i,t,a)),f=Ze(b=>kT(b,t)),d=Ze(b=>PB(b,t)),h=Ze(b=>nT(b,t));if(f==null||d==null||h==null)return null;var{dangerouslySetInnerHTML:m,ticks:x}=e,g=xh(e,gK),{id:y}=h,v=xh(h,vK);return j.createElement(mw,Qv({},g,v,{scale:s,x:d.x,y:d.y,width:f.width,height:f.height,className:wt("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:c}))},_K={allowDataOverflow:ra.allowDataOverflow,allowDecimals:ra.allowDecimals,allowDuplicatedCategory:ra.allowDuplicatedCategory,height:ra.height,hide:!1,mirror:ra.mirror,orientation:ra.orientation,padding:ra.padding,reversed:ra.reversed,scale:ra.scale,tickCount:ra.tickCount,type:ra.type,xAxisId:0},EK=e=>{var t,r,n,a,i,s=Mn(e,_K);return j.createElement(j.Fragment,null,j.createElement(SK,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),j.createElement(NK,s))},kK=(e,t)=>{var{domain:r}=e,n=xh(e,yK),{domain:a}=t,i=xh(t,wK);return pc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:pc({domain:r},{domain:a}):!1},B3=j.memo(EK,kK);B3.displayName="XAxis";var jK=["dangerouslySetInnerHTML","ticks"],CK=["id"],AK=["domain"],TK=["domain"];function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zv.apply(null,arguments)}function gh(e,t){if(e==null)return{};var r,n,a=PK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function OK(e){var t=lr();return j.useEffect(()=>(t(eH(e)),()=>{t(tH(e))}),[e,t]),null}var FK=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=j.useRef(null),s=j.useRef(null),c=Ze(z1),f=Ba(),d=lr(),h="yAxis",m=Ze(T=>jc(T,h,t,f)),x=Ze(T=>jT(T,t)),g=Ze(T=>FB(T,t)),y=Ze(T=>TT(T,h,t,f)),v=Ze(T=>aT(T,t));if(j.useLayoutEffect(()=>{if(!(n!=="auto"||!x||tw(a)||j.isValidElement(a)||v==null)){var T=i.current;if(T){var k=T.getCalculatedWidth();Math.round(x.width)!==Math.round(k)&&d(rH({id:t,width:k}))}}},[y,x,d,a,t,n,v]),x==null||g==null||v==null)return null;var{dangerouslySetInnerHTML:b,ticks:N}=e,E=gh(e,jK),{id:S}=v,C=gh(v,CK);return j.createElement(mw,Zv({},E,C,{ref:i,labelRef:s,scale:m,x:g.x,y:g.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:x.width,height:x.height,className:wt("recharts-".concat(h," ").concat(h),r),viewBox:c,ticks:y}))},DK={allowDataOverflow:na.allowDataOverflow,allowDecimals:na.allowDecimals,allowDuplicatedCategory:na.allowDuplicatedCategory,hide:!1,mirror:na.mirror,orientation:na.orientation,padding:na.padding,reversed:na.reversed,scale:na.scale,tickCount:na.tickCount,type:na.type,width:na.width,yAxisId:0},IK=e=>{var t,r,n,a,i,s=Mn(e,DK);return j.createElement(j.Fragment,null,j.createElement(OK,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),j.createElement(FK,s))},MK=(e,t)=>{var{domain:r}=e,n=gh(e,AK),{domain:a}=t,i=gh(t,TK);return pc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:pc({domain:r},{domain:a}):!1},$3=j.memo(IK,MK);$3.displayName="YAxis";var Wg={exports:{}},Hg={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tk;function RK(){if(Tk)return Hg;Tk=1;var e=yc();function t(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return Hg.useSyncExternalStoreWithSelector=function(f,d,h,m,x){var g=a(null);if(g.current===null){var y={hasValue:!1,value:null};g.current=y}else y=g.current;g=s(function(){function b(T){if(!N){if(N=!0,E=T,T=m(T),x!==void 0&&y.hasValue){var k=y.value;if(x(k,T))return S=k}return S=T}if(k=S,r(E,T))return k;var P=m(T);return x!==void 0&&x(k,P)?(E=T,k):(E=T,S=P)}var N=!1,E,S,C=h===void 0?null:h;return[function(){return b(d())},C===null?void 0:function(){return b(C())}]},[d,h,m,x]);var v=n(f,g[0],g[1]);return i(function(){y.hasValue=!0,y.value=v},[v]),c(v),v},Hg}var Pk;function LK(){return Pk||(Pk=1,Wg.exports=RK()),Wg.exports}LK();function BK(e){e()}function $K(){let e=null,t=null;return{clear(){e=null,t=null},notify(){BK(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var Ok={notify(){},get:()=>[]};function UK(e,t){let r,n=Ok,a=0,i=!1;function s(v){h();const b=n.subscribe(v);let N=!1;return()=>{N||(N=!0,b(),m())}}function c(){n.notify()}function f(){y.onStateChange&&y.onStateChange()}function d(){return i}function h(){a++,r||(r=e.subscribe(f),n=$K())}function m(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Ok)}function x(){i||(i=!0,h())}function g(){i&&(i=!1,m())}const y={addNestedSub:s,notifyNestedSubs:c,handleChangeWrapper:f,isSubscribed:d,trySubscribe:x,tryUnsubscribe:g,getListeners:()=>n};return y}var zK=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",WK=zK(),HK=()=>typeof navigator<"u"&&navigator.product==="ReactNative",VK=HK(),KK=()=>WK||VK?j.useLayoutEffect:j.useEffect,GK=KK(),XK=Symbol.for("react-redux-context"),qK=typeof globalThis<"u"?globalThis:{};function YK(){if(!j.createContext)return{};const e=qK[XK]??=new Map;let t=e.get(j.createContext);return t||(t=j.createContext(null),e.set(j.createContext,t)),t}var JK=YK();function QK(e){const{children:t,context:r,serverState:n,store:a}=e,i=j.useMemo(()=>{const f=UK(a);return{store:a,subscription:f,getServerState:n?()=>n:void 0}},[a,n]),s=j.useMemo(()=>a.getState(),[a]);GK(()=>{const{subscription:f}=i;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),s!==a.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[i,s]);const c=r||JK;return j.createElement(c.Provider,{value:i},t)}var ZK=QK,eG=(e,t)=>t,pw=Se([eG,Et,eT,Lr,VT,ss,R$,Mr],z$),xw=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},U3=Ma("mouseClick"),z3=Ef();z3.startListening({actionCreator:U3,effect:(e,t)=>{var r=e.payload,n=pw(t.getState(),xw(r));n?.activeIndex!=null&&t.dispatch(KB({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var e1=Ma("mouseMove"),W3=Ef();W3.startListening({actionCreator:e1,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Ky(n,n.tooltip.settings.shared),i=pw(n,xw(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(LT({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(RT()))}});var Fk={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},H3=xa({name:"rootProps",initialState:Fk,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:Fk.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),tG=H3.reducer,{updateOptions:rG}=H3.actions,V3=xa({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:nG}=V3.actions,aG=V3.reducer,K3=Ma("keyDown"),G3=Ma("focus"),gw=Ef();gw.startListening({actionCreator:K3,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(Gy(a,Ac(r))),c=ss(r);if(i==="Enter"){var f=ch(r,"axis","hover",String(a.index));t.dispatch(Kv({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:f}));return}var d=RB(r),h=d==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,x=s+m*h;if(!(c==null||x>=c.length||x<0)){var g=ch(r,"axis","hover",String(x));t.dispatch(Kv({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:g}))}}}}});gw.startListening({actionCreator:G3,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=ch(r,"axis","hover",String(i));t.dispatch(Kv({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var ja=Ma("externalEvent"),X3=Ef();X3.startListening({actionCreator:ja,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:C$(r),activeDataKey:qT(r),activeIndex:qo(r),activeLabel:XT(r),activeTooltipIndex:qo(r),isTooltipActive:A$(r)};e.payload.handler(n,e.payload.reactEvent)}}});var iG=Se([Cc],e=>e.tooltipItemPayloads),sG=Se([iG,Mf,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(c=>c.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),q3=Ma("touchMove"),Y3=Ef();Y3.startListening({actionCreator:q3,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Ky(n,n.tooltip.settings.shared);if(a==="axis"){var i=pw(n,xw({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(LT({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,c=r.touches[0],f=document.elementFromPoint(c.clientX,c.clientY);if(!f||!f.getAttribute)return;var d=f.getAttribute(MC),h=(s=f.getAttribute(RC))!==null&&s!==void 0?s:void 0,m=sG(t.getState(),d,h);t.dispatch(MT({activeDataKey:h,activeIndex:d,activeCoordinate:m}))}}});var oG=lC({brush:wV,cartesianAxis:nH,chartData:aU,errorBars:gH,graphicalItems:bW,layout:LM,legend:C8,options:Z$,polarAxis:Rz,polarOptions:aG,referenceElements:jV,rootProps:tG,tooltip:GB}),lG=function(t){return cM({reducer:oG,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([z3.middleware,W3.middleware,gw.middleware,X3.middleware,Y3.middleware]),devTools:il.devToolsEnabled})};function J3(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Ba(),i=j.useRef(null);if(a)return r;i.current==null&&(i.current=lG(t));var s=I1;return j.createElement(ZK,{context:s,store:i.current},r)}function Q3(e){var{layout:t,width:r,height:n,margin:a}=e,i=lr(),s=Ba();return j.useEffect(()=>{s||(i(IM(t)),i(MM({width:r,height:n})),i(DM(a)))},[i,s,t,r,n,a]),null}function Z3(e){var t=lr();return j.useEffect(()=>{t(rG(e))},[t,e]),null}var cG=["children"];function uG(e,t){if(e==null)return{};var r,n,a=fG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vh(){return vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vh.apply(null,arguments)}var dG={width:"100%",height:"100%"},hG=j.forwardRef((e,t)=>{var r=H1(),n=V1(),a=zC();if(!lc(r)||!lc(n))return null;var{children:i,otherAttributes:s,title:c,desc:f}=e,d,h;return typeof s.tabIndex=="number"?d=s.tabIndex:d=a?0:void 0,typeof s.role=="string"?h=s.role:h=a?"application":void 0,j.createElement(k1,vh({},s,{title:c,desc:f,role:h,tabIndex:d,width:r,height:n,style:dG,ref:t}),i)}),mG=e=>{var{children:t}=e,r=Ze(Yh);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return j.createElement(k1,{width:n,height:a,x:s,y:i},t)},Dk=j.forwardRef((e,t)=>{var{children:r}=e,n=uG(e,cG),a=Ba();return a?j.createElement(mG,null,r):j.createElement(hG,vh({ref:t},n),r)});function pG(){var e=lr(),[t,r]=j.useState(null),n=Ze(h8);return j.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;ma(i)&&i!==n&&e(RM(i))}},[t,e,n]),r}function Ik(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ik(Object(r),!0).forEach(function(n){gG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ik(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gG(e,t,r){return(t=vG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vG(e){var t=yG(e,"string");return typeof t=="symbol"?t:t+""}function yG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wG=j.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:c,onMouseDown:f,onMouseEnter:d,onMouseLeave:h,onMouseMove:m,onMouseUp:x,onTouchEnd:g,onTouchMove:y,onTouchStart:v,style:b,width:N}=e,E=lr(),[S,C]=j.useState(null),[T,k]=j.useState(null);hU();var P=pG(),D=j.useCallback(O=>{P(O),typeof t=="function"&&t(O),C(O),k(O)},[P,t,C,k]),R=j.useCallback(O=>{E(U3(O)),E(ja({handler:i,reactEvent:O}))},[E,i]),q=j.useCallback(O=>{E(e1(O)),E(ja({handler:d,reactEvent:O}))},[E,d]),M=j.useCallback(O=>{E(RT()),E(ja({handler:h,reactEvent:O}))},[E,h]),z=j.useCallback(O=>{E(e1(O)),E(ja({handler:m,reactEvent:O}))},[E,m]),ie=j.useCallback(()=>{E(G3())},[E]),ce=j.useCallback(O=>{E(K3(O.key))},[E]),ae=j.useCallback(O=>{E(ja({handler:s,reactEvent:O}))},[E,s]),me=j.useCallback(O=>{E(ja({handler:c,reactEvent:O}))},[E,c]),de=j.useCallback(O=>{E(ja({handler:f,reactEvent:O}))},[E,f]),he=j.useCallback(O=>{E(ja({handler:x,reactEvent:O}))},[E,x]),J=j.useCallback(O=>{E(ja({handler:v,reactEvent:O}))},[E,v]),xe=j.useCallback(O=>{E(q3(O)),E(ja({handler:y,reactEvent:O}))},[E,y]),te=j.useCallback(O=>{E(ja({handler:g,reactEvent:O}))},[E,g]);return j.createElement(t3.Provider,{value:S},j.createElement(A4.Provider,{value:T},j.createElement("div",{className:wt("recharts-wrapper",n),style:xG({position:"relative",cursor:"default",width:N,height:a},b),onClick:R,onContextMenu:ae,onDoubleClick:me,onFocus:ie,onKeyDown:ce,onMouseDown:de,onMouseEnter:q,onMouseLeave:M,onMouseMove:z,onMouseUp:he,onTouchEnd:te,onTouchMove:xe,onTouchStart:J,ref:D},r)))}),bG=["children","className","width","height","style","compact","title","desc"];function SG(e,t){if(e==null)return{};var r,n,a=NG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function NG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eP=j.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:i,style:s,compact:c,title:f,desc:d}=e,h=SG(e,bG),m=Zs(h);return c?j.createElement(Dk,{otherAttributes:m,title:f,desc:d},r):j.createElement(wG,{className:n,style:s,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},j.createElement(Dk,{otherAttributes:m,title:f,desc:d,ref:t},j.createElement(AV,null,r)))}),_G=["width","height"];function t1(){return t1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t1.apply(null,arguments)}function EG(e,t){if(e==null)return{};var r,n,a=kG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function kG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var jG={top:5,right:5,bottom:5,left:5},CG={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:jG,reverseStackOrder:!1,syncMethod:"index"},AG=j.forwardRef(function(t,r){var n,a=Mn(t.categoricalChartProps,CG),{width:i,height:s}=a,c=EG(a,_G);if(!lc(i)||!lc(s))return null;var{chartName:f,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:m,categoricalChartProps:x}=t,g={chartName:f,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:m,eventEmitter:void 0};return j.createElement(J3,{preloadedState:{options:g},reduxStoreName:(n=x.id)!==null&&n!==void 0?n:f},j.createElement(F3,{chartData:x.data}),j.createElement(Q3,{width:i,height:s,layout:a.layout,margin:a.margin}),j.createElement(Z3,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),j.createElement(eP,t1({},c,{width:i,height:s,ref:r})))}),TG=["axis","item"],PG=j.forwardRef((e,t)=>j.createElement(AG,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:TG,tooltipPayloadSearcher:r3,categoricalChartProps:e,ref:t}));function OG(e){var t=lr();return j.useEffect(()=>{t(nG(e))},[t,e]),null}var FG=["width","height","layout"];function r1(){return r1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r1.apply(null,arguments)}function DG(e,t){if(e==null)return{};var r,n,a=IG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function IG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var MG={top:5,right:5,bottom:5,left:5},RG={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:MG,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},LG=j.forwardRef(function(t,r){var n,a=Mn(t.categoricalChartProps,RG),{width:i,height:s,layout:c}=a,f=DG(a,FG);if(!lc(i)||!lc(s))return null;var{chartName:d,defaultTooltipEventType:h,validateTooltipEventTypes:m,tooltipPayloadSearcher:x}=t,g={chartName:d,defaultTooltipEventType:h,validateTooltipEventTypes:m,tooltipPayloadSearcher:x,eventEmitter:void 0};return j.createElement(J3,{preloadedState:{options:g},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:d},j.createElement(F3,{chartData:a.data}),j.createElement(Q3,{width:i,height:s,layout:c,margin:a.margin}),j.createElement(Z3,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),j.createElement(OG,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),j.createElement(eP,r1({width:i,height:s},f,{ref:r})))}),BG=["item"],$G={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},T0=j.forwardRef((e,t)=>{var r=Mn(e,$G);return j.createElement(LG,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:BG,tooltipPayloadSearcher:r3,categoricalChartProps:r,ref:t})});const tP=6048e5,UG=864e5,Mk=Symbol.for("constructDateFrom");function Ks(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Mk in e?e[Mk](t):e instanceof Date?new e.constructor(t):new Date(t)}function ai(e,t){return Ks(t||e,e)}let zG={};function xm(){return zG}function af(e,t){const r=xm(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=ai(e,t?.in),i=a.getDay(),s=(i<n?7:0)+i-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function yh(e,t){return af(e,{...t,weekStartsOn:1})}function rP(e,t){const r=ai(e,t?.in),n=r.getFullYear(),a=Ks(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=yh(a),s=Ks(r,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const c=yh(s);return r.getTime()>=i.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function Rk(e){const t=ai(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function WG(e,...t){const r=Ks.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function Lk(e,t){const r=ai(e,t?.in);return r.setHours(0,0,0,0),r}function HG(e,t,r){const[n,a]=WG(r?.in,e,t),i=Lk(n),s=Lk(a),c=+i-Rk(i),f=+s-Rk(s);return Math.round((c-f)/UG)}function VG(e,t){const r=rP(e,t),n=Ks(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),yh(n)}function KG(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function GG(e){return!(!KG(e)&&typeof e!="number"||isNaN(+ai(e)))}function XG(e,t){const r=ai(e,t?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const qG={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},YG=(e,t,r)=>{let n;const a=qG[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Zl(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const JG={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},QG={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ZG={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},eX={date:Zl({formats:JG,defaultWidth:"full"}),time:Zl({formats:QG,defaultWidth:"full"}),dateTime:Zl({formats:ZG,defaultWidth:"full"})},tX={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},rX=(e,t,r,n)=>tX[e];function mi(e){return(t,r)=>{const n=r?.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,c=r?.width?String(r.width):s;a=e.formattingValues[c]||e.formattingValues[s]}else{const s=e.defaultWidth,c=r?.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const nX={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},aX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},iX={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},sX={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},oX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},lX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},cX=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},uX={ordinalNumber:cX,era:mi({values:nX,defaultWidth:"wide"}),quarter:mi({values:aX,defaultWidth:"wide",argumentCallback:e=>e-1}),month:mi({values:iX,defaultWidth:"wide"}),day:mi({values:sX,defaultWidth:"wide"}),dayPeriod:mi({values:oX,defaultWidth:"wide",formattingValues:lX,defaultFormattingWidth:"wide"})};function pi(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],c=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(c)?dX(c,m=>m.test(s)):fX(c,m=>m.test(s));let d;d=e.valueCallback?e.valueCallback(f):f,d=r.valueCallback?r.valueCallback(d):d;const h=t.slice(s.length);return{value:d,rest:h}}}function fX(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function dX(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function nP(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;const c=t.slice(a.length);return{value:s,rest:c}}}const hX=/^(\d+)(th|st|nd|rd)?/i,mX=/\d+/i,pX={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},xX={any:[/^b/i,/^(a|c)/i]},gX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},vX={any:[/1/i,/2/i,/3/i,/4/i]},yX={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},wX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},bX={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},SX={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},NX={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},_X={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},EX={ordinalNumber:nP({matchPattern:hX,parsePattern:mX,valueCallback:e=>parseInt(e,10)}),era:pi({matchPatterns:pX,defaultMatchWidth:"wide",parsePatterns:xX,defaultParseWidth:"any"}),quarter:pi({matchPatterns:gX,defaultMatchWidth:"wide",parsePatterns:vX,defaultParseWidth:"any",valueCallback:e=>e+1}),month:pi({matchPatterns:yX,defaultMatchWidth:"wide",parsePatterns:wX,defaultParseWidth:"any"}),day:pi({matchPatterns:bX,defaultMatchWidth:"wide",parsePatterns:SX,defaultParseWidth:"any"}),dayPeriod:pi({matchPatterns:NX,defaultMatchWidth:"any",parsePatterns:_X,defaultParseWidth:"any"})},kX={code:"en-US",formatDistance:YG,formatLong:eX,formatRelative:rX,localize:uX,match:EX,options:{weekStartsOn:0,firstWeekContainsDate:1}};function jX(e,t){const r=ai(e,t?.in);return HG(r,XG(r))+1}function CX(e,t){const r=ai(e,t?.in),n=+yh(r)-+VG(r);return Math.round(n/tP)+1}function aP(e,t){const r=ai(e,t?.in),n=r.getFullYear(),a=xm(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=Ks(t?.in||e,0);s.setFullYear(n+1,0,i),s.setHours(0,0,0,0);const c=af(s,t),f=Ks(t?.in||e,0);f.setFullYear(n,0,i),f.setHours(0,0,0,0);const d=af(f,t);return+r>=+c?n+1:+r>=+d?n:n-1}function AX(e,t){const r=xm(),n=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,a=aP(e,t),i=Ks(t?.in||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),af(i,t)}function TX(e,t){const r=ai(e,t?.in),n=+af(r,t)-+AX(r,t);return Math.round(n/tP)+1}function Pt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Ts={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Pt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Pt(r+1,2)},d(e,t){return Pt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Pt(e.getHours()%12||12,t.length)},H(e,t){return Pt(e.getHours(),t.length)},m(e,t){return Pt(e.getMinutes(),t.length)},s(e,t){return Pt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Pt(a,t.length)}},$l={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Bk={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Ts.y(e,t)},Y:function(e,t,r,n){const a=aP(e,n),i=a>0?a:1-a;if(t==="YY"){const s=i%100;return Pt(s,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Pt(i,t.length)},R:function(e,t){const r=rP(e);return Pt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Pt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Pt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Pt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Ts.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Pt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=TX(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Pt(a,t.length)},I:function(e,t,r){const n=CX(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Pt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Ts.d(e,t)},D:function(e,t,r){const n=jX(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Pt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Pt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Pt(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Pt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=$l.noon:n===0?a=$l.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=$l.evening:n>=12?a=$l.afternoon:n>=4?a=$l.morning:a=$l.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Ts.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Ts.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Pt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Pt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ts.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Ts.s(e,t)},S:function(e,t){return Ts.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Uk(n);case"XXXX":case"XX":return jo(n);case"XXXXX":case"XXX":default:return jo(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Uk(n);case"xxxx":case"xx":return jo(n);case"xxxxx":case"xxx":default:return jo(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+$k(n,":");case"OOOO":default:return"GMT"+jo(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+$k(n,":");case"zzzz":default:return"GMT"+jo(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Pt(n,t.length)},T:function(e,t,r){return Pt(+e,t.length)}};function $k(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+Pt(i,2)}function Uk(e,t){return e%60===0?(e>0?"-":"+")+Pt(Math.abs(e)/60,2):jo(e,t)}function jo(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Pt(Math.trunc(n/60),2),i=Pt(n%60,2);return r+a+t+i}const zk=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},iP=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},PX=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return zk(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",zk(n,t)).replace("{{time}}",iP(a,t))},OX={p:iP,P:PX},FX=/^D+$/,DX=/^Y+$/,IX=["D","DD","YY","YYYY"];function MX(e){return FX.test(e)}function RX(e){return DX.test(e)}function LX(e,t,r){const n=BX(e,t,r);if(console.warn(n),IX.includes(e))throw new RangeError(n)}function BX(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const $X=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,UX=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zX=/^'([^]*?)'?$/,WX=/''/g,HX=/[a-zA-Z]/;function P0(e,t,r){const n=xm(),a=r?.locale??n.locale??kX,i=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,s=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,c=ai(e,r?.in);if(!GG(c))throw new RangeError("Invalid time value");let f=t.match(UX).map(h=>{const m=h[0];if(m==="p"||m==="P"){const x=OX[m];return x(h,a.formatLong)}return h}).join("").match($X).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const m=h[0];if(m==="'")return{isToken:!1,value:VX(h)};if(Bk[m])return{isToken:!0,value:h};if(m.match(HX))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:h}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const d={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return f.map(h=>{if(!h.isToken)return h.value;const m=h.value;(!r?.useAdditionalWeekYearTokens&&RX(m)||!r?.useAdditionalDayOfYearTokens&&MX(m))&&LX(m,t,String(e));const x=Bk[m[0]];return x(c,m,a.localize,d)}).join("")}function VX(e){const t=e.match(zX);return t?t[1].replace(WX,"'"):e}function Bf({type:e,libelle:t,classe:r,enseignant:n,hideFooter:a=!1,rightMeta:i}){const s=x4(e),c=fe.getAll("ecole")?.[0],f=c&&c.logo?c.logo:s.logo||"",d=s.logoMinistere||"",h=d&&d!==f,m=c&&c.nom?c.nom:s.etablissement||s.header,x=i?"grid grid-cols-[80px_1fr_80px] items-start gap-3 mb-1 print:mb-0":"grid grid-cols-[80px_1fr_80px] items-center gap-3 mb-1 print:mb-0";return o.jsxs("div",{className:"w-full mb-1",children:[o.jsxs("div",{className:x,children:[o.jsx("div",{className:"flex flex-col items-start",children:f?o.jsx("img",{src:f,alt:"logo",style:{maxHeight:64,width:"auto"},className:"logo-left object-contain"}):o.jsx("div",{className:"h-12 w-12 bg-gray-200 rounded flex items-center justify-center text-xs text-gray-600",children:"Logo"})}),o.jsxs("div",{className:"text-center px-1",children:[o.jsx("div",{className:"text-sm text-gray-700",children:s.pays}),o.jsx("div",{className:"font-bold text-base tracking-wider text-blue-800",children:s.ministere}),o.jsx("div",{className:"font-extrabold text-lg mt-0",children:m}),o.jsx("div",{className:"text-sm text-teal-700 mt-0 entete-libelle font-semibold",children:t||s.header}),(r||n)&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[r&&o.jsxs("span",{className:"mr-2",children:["Classe: ",r]}),n&&o.jsxs("span",{children:["Enseignant: ",n]})]}),(c||s)&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[c?.adresse&&o.jsx("div",{children:c.adresse}),o.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[c?.telephone&&o.jsxs("div",{children:["Tel: ",c.telephone]}),c?.email&&o.jsxs("div",{children:["Email: ",c.email]})]})]})]}),o.jsxs("div",{className:"flex flex-col items-end",children:[i?o.jsx("div",{className:"text-right text-xs text-gray-600",children:i}):null,h?o.jsx("img",{src:d,alt:"logo-ministere",style:{maxHeight:56,width:"auto"},className:"logo-right object-contain"}):o.jsx("div",{style:{height:56,width:56}})]})]}),!a&&o.jsx("div",{className:"text-xs text-right text-gray-600 print:text-xs",children:s.footer})]})}const Wk=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(String(n.result)),n.onerror=r,n.readAsDataURL(e)});function KX({onClose:e}){const[t,r]=j.useState(()=>Ws()),[n,a]=j.useState("eleves");function i(c){r(c),Gu(c)}function s(c,f){const d={...t,[n]:{...t[n],[c]:f}};i(d)}return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-3xl w-full",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-bold",children:"Paramtrage des enttes"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{className:"px-3 py-1 border rounded",onClick:()=>{r(Ws())},children:"Restaurer"}),o.jsx("button",{className:"px-3 py-1",onClick:e,children:"Fermer"})]})]}),o.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[o.jsx("div",{className:"col-span-3",children:o.jsxs("nav",{className:"flex flex-col gap-2",children:[o.jsx("button",{className:`text-left px-3 py-2 rounded ${n==="eleves"?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,onClick:()=>a("eleves"),children:"lves"}),o.jsx("button",{className:`text-left px-3 py-2 rounded ${n==="recu"?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,onClick:()=>a("recu"),children:"Reu"}),o.jsx("button",{className:`text-left px-3 py-2 rounded ${n==="transport"?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,onClick:()=>a("transport"),children:"Transport"})]})}),o.jsxs("div",{className:"col-span-6 bg-gray-50 p-3 rounded",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Entte"}),o.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:t[n].header,onChange:c=>s("header",c.target.value)}),o.jsx("label",{className:"block text-sm text-gray-700 mt-3",children:"Pied de page"}),o.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:t[n].footer||"",onChange:c=>s("footer",c.target.value)}),o.jsx("label",{className:"block text-sm text-gray-700 mt-3",children:"Colonnes (spares par une virgule)"}),o.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:t[n].columns.join(", "),onChange:c=>s("columns",c.target.value.split(",").map(f=>f.trim()))}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Logo principal"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async c=>{const f=c.target.files?.[0];if(f)try{const d=await Wk(f);s("logo",d)}catch{}}}),t[n].logo?o.jsx("img",{src:t[n].logo,alt:"logo",className:"h-12 mt-2"}):null]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Logo Ministre"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async c=>{const f=c.target.files?.[0];if(f)try{const d=await Wk(f);s("logoMinistere",d)}catch{}}}),t[n].logoMinistere?o.jsx("img",{src:t[n].logoMinistere,alt:"logo-min",className:"h-12 mt-2"}):null]})]}),o.jsxs("div",{className:"col-span-3",children:[o.jsx("h4",{className:"font-semibold mb-2",children:"Aperu"}),o.jsx("div",{className:"border p-3 bg-white rounded",children:o.jsx(Bf,{type:n,libelle:t[n].header})}),o.jsx("div",{className:"mt-3 flex justify-end",children:o.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded",onClick:()=>{i(t),e()},children:"Enregistrer"})})]})]})]})})}function Tc({title:e,subtitle:t,actions:r,children:n}){return o.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-extrabold text-gray-900",children:e}),t&&o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t})]}),r&&o.jsx("div",{className:"mt-4 sm:mt-0 flex items-center gap-3",children:r})]}),o.jsx("div",{className:"space-y-6",children:n})]})})}class ql{static instance;static getInstance(){return ql.instance||(ql.instance=new ql),ql.instance}cancelPayment(t,r){const n=fe.getById("paiements",t);if(!n)throw new Error("Paiement introuvable");try{const i=Number(n.avance||0);i>0&&fe.getAll("credits").filter(c=>c.eleveId===n.eleveId&&Math.abs(Number(c.montant||0)-i)<1).forEach(c=>fe.delete("credits",c.id))}catch{}const a={canceled:!0,updatedAt:new Date().toISOString()};return r&&(a.cancelNote=r),fe.update("paiements",t,a),fe.addHistorique({type:"autre",cible:"Paiement",cibleId:t,description:`Annulation du paiement ${t} de ${n.montant} FCFA${r?`  Motif: ${r}`:""}`,utilisateur:n&&n.operateur||"SYSTEM"}),!0}getSituationEcheances(t){const r=fe.getById("eleves",t);if(!r)return null;const n=fe.getById("classes",r.classeId);if(!n)return null;const a=fe.getAll("fraisScolaires").find(y=>y.niveau===n.niveau&&y.anneeScolaire===n.anneeScolaire);if(!a||!a.echeances)return null;const i=fe.getAll("paiements").filter(y=>y.eleveId===t&&!y.canceled),s=new Date,c={};i.forEach(y=>{if(y.allocations&&y.allocations.length>0)y.allocations.forEach(v=>{const b=a.echeances.find(N=>!!(N.id&&N.id===v.echeanceId||`${n.niveau}-${N.modalite}`===v.echeanceId));b&&b.modalite!=null&&(c[b.modalite]=(c[b.modalite]||0)+v.montant)});else{const v=y;let b=null;v.modalite?b=Number(v.modalite):v.typeFrais==="inscription"?b=1:v.typeFrais==="scolarite"&&v.versementIndex&&(b=Number(v.versementIndex)+1),b&&(c[b]=(c[b]||0)+y.montant)}});const f=a.echeances.map(y=>{const v=c[y.modalite||0]||0,b=Math.max(0,y.montant-v),N=new Date(y.date),E=N<s&&b>0,S=E?Math.floor((s.getTime()-N.getTime())/(1e3*60*60*24)):0;let C=`Versement ${y.modalite}`;return y.modalite===1?C="Inscription":y.modalite&&y.modalite>1&&(C=`Versement ${y.modalite-1}`),{echeanceId:y.id||`${n.niveau}-${y.modalite}`,modalite:y.modalite||0,label:y.label||C,date:y.date,montant:y.montant,montantPaye:v,montantRestant:b,isEchue:E,joursRetard:S}}),d=f.reduce((y,v)=>y+v.montant,0),h=f.reduce((y,v)=>y+v.montantPaye,0),m=f.reduce((y,v)=>y+v.montantRestant,0),x=f.filter(y=>y.isEchue),g=f.filter(y=>y.montantRestant>0&&!y.isEchue).sort((y,v)=>new Date(y.date).getTime()-new Date(v.date).getTime())[0]||null;return{eleveId:t,eleve:r,classe:n,echeances:f,totalDu:d,totalPaye:h,totalRestant:m,echeancesEchues:x,prochainEcheance:g}}getAlertesEcheances(t=12){const r=fe.getAll("eleves").filter(i=>i.statut==="Actif"),n=new Date,a=[];return r.forEach(i=>{const s=this.getSituationEcheances(i.id);if(!s)return;const c=s.echeances.filter(d=>d.montantRestant>0);if(c.length===0)return;if(c.some(d=>{const h=new Date(d.date);return Math.ceil((h.getTime()-n.getTime())/(1e3*60*60*24))<=t})){const d=c.filter(m=>{const x=new Date(m.date);return Math.ceil((x.getTime()-n.getTime())/(1e3*60*60*24))<=t}),h=d.reduce((m,x)=>m+x.montantRestant,0);a.push({eleve:i,echeances:d,totalDu:h})}}),{echeancesImpayees:a}}processPaymentIntelligent(t,r,n,a={}){const i=this.getSituationEcheances(t);if(!i)throw new Error("Impossible de calculer la situation des chances");let s=r;const c=[],f=Array.isArray(a.selectedEcheances)?a.selectedEcheances:void 0,d=i.echeances.filter(v=>v.montantRestant>0),h=f&&f.length>0?d.filter(v=>f.includes(v.echeanceId)):d,m=[...h.filter(v=>v.isEchue).sort((v,b)=>new Date(v.date).getTime()-new Date(b.date).getTime()),...h.filter(v=>!v.isEchue).sort((v,b)=>new Date(v.date).getTime()-new Date(b.date).getTime())],x=!!i.eleve?.protege;if(x&&f&&f.length>0){if(h.find(N=>N.modalite!==1))throw new Error("lve protg : seules les chances d'inscription (modalit 1) peuvent tre rgles");const b=h.reduce((N,E)=>N+(E.modalite===1?E.montantRestant:0),0);if(r<b)throw new Error("lve protg : l'inscription doit tre rgle en totalit")}else if(x&&(!f||f.length===0)){const v=i.echeances.filter(b=>b.modalite===1).reduce((b,N)=>b+N.montantRestant,0);if(r<v)throw new Error("lve protg : l'inscription doit tre rgle en totalit")}for(const v of m){if(s<=0)break;if(v.montantRestant<=0)continue;if(v.modalite===1){if(s<v.montantRestant)throw new Error("L'inscription doit tre rgle en totalit");c.push({echeanceId:v.echeanceId,montant:v.montantRestant}),s-=v.montantRestant;continue}const b=Math.min(s,v.montantRestant);c.push({echeanceId:v.echeanceId,montant:b}),s-=b}const g={eleveId:t,montant:r,datePaiement:n,typeFrais:a&&a.typeFrais||"scolarite",versementIndex:a&&a.versementIndex||void 0,modePaiement:a&&a.modePaiement||"Espces",numeroRecu:a&&a.numeroRecu||`REC-${Date.now()}`,operateur:a&&a.operateur||"SYSTEM",notes:a&&a.notes||"",allocations:c,avance:s,updatedAt:new Date().toISOString()};return{paiement:fe.create("paiements",g),allocations:c,avance:s,situation:this.getSituationEcheances(t)}}generateConvocations(t=12){return this.getAlertesEcheances(t).echeancesImpayees.map(n=>({eleve:n.eleve,classe:fe.getById("classes",n.eleve.classeId),echeancesEchues:n.echeances,totalDu:n.totalDu,anneeScolaire:fe.getById("classes",n.eleve.classeId)?.anneeScolaire||""}))}}const sf=ql.getInstance();function Vg(){const[e,t]=j.useState(!1),[r,n]=j.useState(0),a=()=>{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"eleves",action:"new"}}))},i=()=>{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"finances"}})),window.dispatchEvent(new CustomEvent("open-payment-form"))},s=()=>{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"notes"}})),window.dispatchEvent(new CustomEvent("open-notes-entry"))},c=fe.getAll("eleves"),f=fe.getAll("paiements").filter(C=>!C.canceled),d=fe.getAll("fraisScolaires"),h=fe.getAll("classes"),m=fe.getAll("notes"),x=j.useMemo(()=>sf.getAlertesEcheances(),[r]),g=j.useMemo(()=>c.filter(C=>!m.some(T=>T.eleveId===C.id)),[c,m,r]),y=j.useMemo(()=>{const C=c.length,T=c.filter(q=>q.statut==="Actif").length,k=f.reduce((q,M)=>q+M.montant,0),P=f.filter(q=>{const M=new Date(q.datePaiement),z=new Date;return M.getMonth()===z.getMonth()&&M.getFullYear()===z.getFullYear()}).reduce((q,M)=>q+M.montant,0),D=c.map(q=>{const M=sf.getSituationEcheances(q.id);if(!M)return{eleveId:q.id,statut:"Non Pay",solde:0};if(M.eleve&&M.eleve.protege){const ae=(M.echeances||[]).filter(J=>J.modalite===1),me=ae.reduce((J,xe)=>J+(xe.montant||0),0),de=ae.reduce((J,xe)=>J+(xe.montantPaye||0),0);let he="Non Pay";return me>0&&de>=me?he="Pay":de>0&&(he="Partiellement Pay"),{eleveId:q.id,statut:he,solde:me-de}}const z=M.totalDu||0,ie=M.totalPaye||0;let ce="Non Pay";return z>0&&ie>=z?ce="Pay":ie>0&&(ce="Partiellement Pay"),{eleveId:q.id,statut:ce,solde:z-ie}}),R={soldes:D.filter(q=>q.statut==="Pay").length,partiels:D.filter(q=>q.statut==="Partiellement Pay").length,impayes:D.filter(q=>q.statut==="Non Pay").length};return{totalEleves:C,elevesActifs:T,totalRecettes:k,recettesMoisCourant:P,elevesParStatut:R}},[c,f,d,h,r]),v=j.useMemo(()=>{const C=Array.from({length:12},(T,k)=>({mois:P0(new Date(2024,k,1),"MMM"),recettes:0}));return f.forEach(T=>{const k=new Date(T.datePaiement);if(!isNaN(k.getTime())){const P=k.getMonth();P>=0&&P<12&&(C[P].recettes+=T.montant)}}),C},[f,r]),b=[{name:"Pay",value:y.elevesParStatut.soldes,color:"#10b981"},{name:"Partiel",value:y.elevesParStatut.partiels,color:"#f59e0b"},{name:"Non Pay",value:y.elevesParStatut.impayes,color:"#ef4444"}],N=C=>new Intl.NumberFormat("fr-FR").format(C)+" FCFA",[E,S]=j.useState(null);return j.useEffect(()=>S(fe.getAll("ecole")[0]||null),[r]),j.useEffect(()=>{const C=()=>n(T=>T+1);return window.addEventListener("dataChanged",C),()=>window.removeEventListener("dataChanged",C)},[]),o.jsxs(Tc,{title:"Tableau de bord",subtitle:`Anne scolaire ${E?.anneeScolaireActive||"Non configure"}`,actions:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:a,className:"px-3 py-2 bg-teal-600 text-white rounded-md",children:"Nouvel lve"}),o.jsx("button",{onClick:i,className:"px-3 py-2 bg-gray-900 text-white rounded-md",children:"Paiement"})]}),children:[(g.length>0||(x?.echeancesEchues?.length||0)>0||(x?.echeancesProches?.length||0)>0)&&o.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(d4,{className:"h-5 w-5 text-gray-600 mt-0.5 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Alertes"}),o.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[g.length>0&&o.jsxs("p",{children:[g.length," lve(s) n'ont aucune note enregistre."]}),x?.echeancesEchues?.length>0&&o.jsxs("p",{children:[x.echeancesEchues.length," lve(s) ont des chances chues."]}),x?.echeancesProches?.length>0&&o.jsxs("p",{children:[x.echeancesProches.length," chance(s) dans les 7 prochains jours."]})]})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"lves Actifs"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:y.elevesActifs}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Total: ",y.totalEleves]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(zs,{className:"h-6 w-6 text-gray-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Recettes Totales"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:N(y.totalRecettes)}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center",children:[o.jsx(D0,{className:"inline h-3 w-3 mr-1"}),"Ce mois: ",N(y.recettesMoisCourant)]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(Bs,{className:"h-6 w-6 text-gray-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Paiements Complts"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:y.elevesParStatut.soldes}),o.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[o.jsx(ua,{className:"h-4 w-4 text-green-600"}),o.jsx("span",{className:"text-sm text-gray-500",children:"Frais pays"})]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(ua,{className:"h-6 w-6 text-gray-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Non Pay"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:y.elevesParStatut.impayes}),o.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[o.jsx(wi,{className:"h-4 w-4 text-red-600"}),o.jsx("span",{className:"text-sm text-gray-500",children:"En attente"})]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(y1,{className:"h-6 w-6 text-gray-600"})})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[o.jsx(D0,{className:"h-5 w-5 text-gray-600"})," volution des Recettes"]}),o.jsx(Mu,{width:"100%",height:260,children:o.jsxs(PG,{data:v,children:[o.jsx(L3,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),o.jsx(B3,{dataKey:"mois",tick:{fontSize:12}}),o.jsx($3,{tickFormatter:C=>new Intl.NumberFormat("fr-FR",{notation:"compact"}).format(C),tick:{fontSize:12}}),o.jsx(Du,{formatter:C=>N(Number(C))}),o.jsx(P3,{dataKey:"recettes",fill:"#374151",radius:[2,2,0,0]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[o.jsx(ua,{className:"h-5 w-5 text-gray-600"})," Situation des Paiements"]}),o.jsx(Mu,{width:"100%",height:260,children:o.jsxs(T0,{children:[o.jsx(Lu,{data:b,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",children:b.map((C,T)=>o.jsx(zi,{fill:C.color},`cell-${T}`))}),o.jsx(Du,{})]})}),o.jsx("div",{className:"flex justify-center space-x-6 mt-4",children:b.map(C=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:C.color}})," ",o.jsxs("span",{className:"text-sm text-gray-600",children:[C.name," (",C.value,")"]})]},C.name))})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Actions Rapides"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("button",{className:"group p-6 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-left",onClick:a,children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:o.jsx(zs,{className:"h-5 w-5 text-gray-600"})})}),o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Nouvel lve"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Inscrire un nouvel lve"})]}),o.jsxs("button",{className:"group p-6 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-left",onClick:i,children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:o.jsx(Bs,{className:"h-5 w-5 text-gray-600"})})}),o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Nouveau Paiement"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Enregistrer un paiement"})]}),o.jsxs("button",{className:"group p-6 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-left",onClick:s,children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:o.jsx(qi,{className:"h-5 w-5 text-gray-600"})})}),o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Saisir Notes"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Enregistrer les notes"})]})]})]}),e&&o.jsx(KX,{onClose:()=>t(!1)})]})}const GX="modulepreload",XX=function(e,t){return new URL(e,t).href},Hk={},yn=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let d=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const s=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),f=c?.nonce||c?.getAttribute("nonce");a=d(r.map(h=>{if(h=XX(h,n),h in Hk)return;Hk[h]=!0;const m=h.endsWith(".css"),x=m?'[rel="stylesheet"]':"";if(n)for(let y=s.length-1;y>=0;y--){const v=s[y];if(v.href===h&&(!m||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${x}`))return;const g=document.createElement("link");if(g.rel=m?"stylesheet":GX,m||(g.as="script"),g.crossOrigin="",g.href=h,f&&g.setAttribute("nonce",f),document.head.appendChild(g),m)return new Promise((y,v)=>{g.addEventListener("load",y),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(s){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=s,window.dispatchEvent(c),!c.defaultPrevented)throw s}return a.then(s=>{for(const c of s||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})},qX={primary:"bg-teal-600 text-white hover:bg-teal-700",secondary:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",ghost:"bg-transparent text-gray-700 hover:bg-gray-50",danger:"bg-red-600 text-white hover:bg-red-700"},Vk={sm:"px-2 py-1 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-base"};function Ft({variant:e="primary",className:t="",children:r,leftIcon:n,rightIcon:a,size:i="md",...s}){const c=`rounded-md font-medium inline-flex items-center space-x-2 ${Vk[i]||Vk.md}`;return o.jsxs("button",{className:`${c} ${qX[e]} ${t}`,...s,children:[n&&o.jsx("span",{className:"inline-flex mr-1",children:n}),o.jsx("span",{className:"inline-flex items-center",children:r}),a&&o.jsx("span",{className:"inline-flex ml-1",children:a})]})}class YX{cache=new Map;cacheTimeout=300*1e3;generateHash(t,r){return`${t}-${r}`}getSituationEcheances(t,r){const n=this.generateHash(t,r),a=this.cache.get(t);if(a&&a.dataHash===n&&Date.now()-a.timestamp<this.cacheTimeout)return a.data;try{const i=sf.getSituationEcheances(t);return this.cache.set(t,{data:i,timestamp:Date.now(),dataHash:n}),i}catch(i){return console.warn("Error calculating financial situation for",t,i),null}}invalidate(t){this.cache.delete(t)}invalidateAll(){this.cache.clear()}cleanup(){const t=Date.now();for(const[r,n]of this.cache.entries())t-n.timestamp>this.cacheTimeout&&this.cache.delete(r)}}const n1=new YX;typeof window<"u"&&setInterval(()=>n1.cleanup(),60*1e3);function JX({onEleveSelect:e,onNewEleve:t}){const{showToast:r}=Jr(),[n,a]=j.useState([]),[i,s]=j.useState(!1),[c,f]=j.useState(""),d=se=>{a(se?en.map(ke=>ke.id):[])},h=(se,ke)=>{a(Ke=>ke?[...Ke,se]:Ke.filter(Je=>Je!==se))},m=()=>{n.length!==0&&window.confirm(`Supprimer ${n.length} lve(s) ?`)&&(n.forEach(se=>fe.delete("eleves",se)),setTimeout(()=>{},100))},x=()=>{c&&(n.forEach(se=>fe.update("eleves",se,{classeId:c})),s(!1),a([]),setTimeout(()=>{},100))},[g,y]=j.useState(null),[v,b]=j.useState([]),[N,E]=j.useState([]),[S,C]=j.useState({matricule:"",nom:"",prenoms:"",nomPrenoms:""}),[T,k]=j.useState(""),[P,D]=j.useState(!1),[R,q]=j.useState(!1),M=j.useRef(null),z=j.useRef(null),[ie,ce]=j.useState(null),[ae,me]=j.useState(!1),[de,he]=j.useState(null),[J,xe]=j.useState(!1),te=async se=>{const ke=se.target.files?.[0];if(ke){console.log("handleImportExcel: file selected",ke?.name,ke?.size),y(ke);try{const Je=(await yn(()=>Promise.resolve().then(()=>Cu),void 0,import.meta.url)).importerElevesDepuisExcel;if(console.log("handleImportExcel: importer function loaded",!!Je),typeof Je!="function")throw new Error("Module d'import introuvable");const We=await Je(ke);if(console.log("handleImportExcel: importer result",We&&(Array.isArray(We)?We.length:Object.keys(We).length)),!We)throw new Error("Aucune donne retourne par l'importeur");Array.isArray(We)?(E(We),D(!0)):We.columns?(b(We.columns),E(We.preview||[]),q(!0)):(E(We.preview||[]),D(!0))}catch(Ke){const Je=Ke instanceof Error?Ke.message:String(Ke);r("Erreur lors de l'importation: "+Je,"error"),console.error("Import error:",Ke)}}},O=async()=>{if(!g)return;q(!1);const{importerElevesDepuisExcel:se}=await yn(async()=>{const{importerElevesDepuisExcel:Ke}=await Promise.resolve().then(()=>Cu);return{importerElevesDepuisExcel:Ke}},void 0,import.meta.url),ke=await se(g,S);E(ke),D(!0)},K=async()=>{if(!T){alert("Slectionnez une classe pour l'importation.");return}const{db:se}=await yn(async()=>{const{db:ke}=await Promise.resolve().then(()=>T5);return{db:ke}},void 0,import.meta.url);N.forEach(ke=>{const Ke=se.getAll("eleves").find(Je=>Je.matricule&&Je.matricule===(ke.matricule||"")||Je.nom===(ke.nom||"")&&Je.prenoms===(ke.prenoms||""));if(Ke)se.update("eleves",Ke.id,{classeId:T});else{const Je=se.generateMatricule();se.create("eleves",{...ke,id:Je,classeId:T,anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:ke.pereTuteur||"",mereTutrice:ke.mereTutrice||"",telephone:ke.telephone||"",adresse:ke.adresse||"",photo:ke.photo||"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}}),D(!1),E([]),k(""),y(null),M.current&&(M.current.value="")},W=async()=>{const{exporterElevesEnExcel:se}=await yn(async()=>{const{exporterElevesEnExcel:at}=await Promise.resolve().then(()=>Cu);return{exporterElevesEnExcel:at}},void 0,import.meta.url),ke=await se(ot),Ke=new Blob([ke],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Je=window.URL.createObjectURL(Ke),We=document.createElement("a");We.href=Je,We.download=`eleves_klasnet_${new Date().toISOString().split("T")[0]}.xlsx`,We.click(),window.URL.revokeObjectURL(Je)},X=j.useMemo(()=>{const ke=fe.getAll("paiements").length;return Ke=>{try{const Je=n1.getSituationEcheances(Ke.id,ke);if(!Je)return"Non dfini";if(Je.eleve&&Je.eleve.protege){const jr=(Je.echeances||[]).filter(Ar=>Ar.modalite===1),Cr=jr.reduce((Ar,$r)=>Ar+($r.montant||0),0),tn=jr.reduce((Ar,$r)=>Ar+($r.montantPaye||0),0);return Cr>0&&tn>=Cr?"Pay":tn>0&&tn<Cr?"Partiel":"Impay"}const We=Je.totalDu||0,at=Je.totalPaye||0;return We===0?"Non dfini":at>=We?"Pay":at>0&&at<We?"Partiel":"Impay"}catch(Je){return console.warn("Unable to compute financial status for",Ke.id,Je),"Non dfini"}}},[]);function V(se){switch(se){case"Pay":return"bg-green-100 text-green-800";case"Partiel":return"bg-orange-100 text-orange-800";case"Impay":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}const[ne,L]=j.useState(""),[U,H]=j.useState(""),[oe,F]=j.useState(""),[Ae,je]=j.useState("nom"),[Le,Ue]=j.useState("asc"),[,Pe]=j.useState(0);j.useEffect(()=>{const se=()=>{n1.invalidateAll(),Pe(ke=>ke+1)};return window.addEventListener("dataChanged",se),()=>window.removeEventListener("dataChanged",se)},[]);const ot=fe.getAll("eleves"),kt=fe.getAll("classes"),Yt=x4("eleves"),jt=kt.find(se=>se.id===U),za=jt?`${jt.niveau} ${jt.section||""}`.trim():"Toutes les classes",Rn=jt?jt.anneeScolaire:kt[0]?.anneeScolaire||"",Br=`${za}${Rn?"  "+Rn:""}  ${Yt.header}`,tr=(()=>{if(!jt)return["N","Matricule","Nom & Prnom","Date de naissance","Classe"];const ke=(Array.isArray(Yt.columns)?[...Yt.columns]:[]).filter(at=>!/classe/i.test(String(at))&&!/date\s*de\s*naiss/i.test(String(at))&&!/date.*naiss/i.test(String(at))),Ke=ke.some(at=>/matricul/i.test(String(at))),Je=ke.filter(at=>!(/nom/.test(String(at).toLowerCase())&&/pr/i.test(String(at).toLowerCase()))&&!/matricul/i.test(String(at))),We=["N"];return Ke&&We.push("Matricule"),We.push("Nom & Prnom"),We.push(...Je),We.filter((at,jr,Cr)=>Cr.indexOf(at)===jr)})(),Ln=(()=>{const se=tr.length;if(se===0)return[];if(!jt){if(se===5)return["5%","10%","50%","14%","21%"];if(se>1&&tr.findIndex(jr=>/nom/i.test(String(jr))&&/pr/i.test(String(jr)))>=0){const Cr=Math.floor(81/(se-2));return["5%","14%",...Array(se-2).fill(`${Cr}%`)]}const We=Math.floor(100/se);return Array(se).fill(`${We}%`)}const ke=tr.some(We=>/matricul/i.test(String(We))),Ke=tr.some(We=>/nom/i.test(String(We))&&/pr/i.test(String(We)));if(jt){const We=tr.length;if(We===1)return["100%"];if(We===2)return Ke?["10%","90%"]:["25%","75%"];if(We===3)return ke&&Ke?["5%","15%","80%"]:["20%","45%","35%"];if(We===4)return ke&&Ke?["5%","12%","45%","38%"]:["20%","45%","35%"];const at=ke?12:0,jr=Ke?45:60,Cr=5,tn=We-(ke&&Ke?3:2),Ar=tn>0?Math.max(4,Math.floor((100-Cr-at-jr)/tn)):0,$r=[];ke&&$r.push(`${at}%`),Ke&&$r.push(`${jr}%`);for(let ki=0;ki<tn;ki++)$r.push(`${Ar}%`);const Bn={};Bn["n"]=`${Cr}%`;let so=0;return ke&&(Bn.matricule=$r[so++]),Ke&&(Bn["nom & prnom"]=$r[so++],Bn["nom & prnoms"]=Bn["nom & prnom"]),tr.map(ki=>Bn[String(ki).toLowerCase()]||`${Ar}%`)}const Je=Math.floor(100/se);return Array(se).fill(`${Je}%`)})(),en=j.useMemo(()=>{let se=[...ot];if(ne){const ke=ne.toLowerCase();se=se.filter(Ke=>Ke.nom.toLowerCase().includes(ke)||Ke.prenoms.toLowerCase().includes(ke)||Ke.matricule.toLowerCase().includes(ke)||Ke.pereTuteur.toLowerCase().includes(ke)||Ke.mereTutrice.toLowerCase().includes(ke))}return U&&(se=se.filter(ke=>ke.classeId===U)),oe&&(se=se.filter(ke=>X(ke)===oe)),se.sort((ke,Ke)=>{let Je=ke[Ae],We=Ke[Ae];return(typeof Je>"u"||Je===null)&&(Je=""),(typeof We>"u"||We===null)&&(We=""),typeof Je=="string"&&(Je=Je.toLowerCase(),We=We.toLowerCase()),Le==="asc"?Je<We?-1:Je>We?1:0:Je>We?-1:Je<We?1:0}),se},[ot,ne,U,oe,Ae,Le]),rr=se=>{Ae===se?Ue(Le==="asc"?"desc":"asc"):(je(se),Ue("asc"))},Cn=se=>{window.confirm(`tes-vous sr de vouloir supprimer l'lve ${se.prenoms} ${se.nom} ?`)&&(fe.delete("eleves",se.id),fe.addHistorique({type:"suppression",cible:"lve",cibleId:se.id,description:`Suppression de l'lve ${se.prenoms} ${se.nom}`,utilisateur:"ADMIN"}),setTimeout(()=>{},100))},ut=se=>{const ke=kt.find(Ke=>Ke.id===se);return ke?`${ke.niveau} ${ke.section}`:"Non assign"},Ct=se=>{switch(se){case"Actif":return"bg-green-100 text-green-800";case"Inactif":return"bg-gray-100 text-gray-800";case"Transfr":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return o.jsxs(Tc,{title:"Gestion des lves",subtitle:`${en.length} lve(s) trouv(s)`,actions:o.jsxs(o.Fragment,{children:[o.jsx("input",{ref:M,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:te}),o.jsxs(Ft,{variant:"secondary",className:"px-3",onClick:()=>M.current?.click(),children:[o.jsx(Us,{className:"h-4 w-4"}),o.jsx("span",{children:"Importer"})]}),o.jsxs(Ft,{variant:"secondary",className:"px-3",onClick:W,children:[o.jsx(c4,{className:"h-4 w-4"}),o.jsx("span",{children:"Exporter"})]}),o.jsx("input",{ref:z,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:async se=>{const ke=se.target.files?.[0];if(ke)try{const Ke=await yn(()=>Promise.resolve().then(()=>Cu),void 0,import.meta.url);if(typeof Ke.previewImporterPaiementsDepuisExcel!="function")throw new Error("Importeur de paiements introuvable");const Je=await Ke.previewImporterPaiementsDepuisExcel(ke);he(Je),xe(!0)}catch(Ke){const Je=Ke instanceof Error?Ke.message:String(Ke);r("Erreur import paiements: "+Je,"error"),console.error(Ke)}}}),o.jsxs(Ft,{variant:"secondary",className:"px-3",onClick:()=>z.current?.click(),children:[o.jsx(Us,{className:"h-4 w-4"}),o.jsx("span",{children:"Importer paiements"})]}),o.jsxs(Ft,{variant:"primary",onClick:t,children:[o.jsx(Wo,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvel lve"})]}),o.jsxs(Ft,{variant:"secondary",onClick:()=>window.print(),className:"px-3",children:[o.jsx(E5,{className:"h-4 w-4"}),o.jsx("span",{children:"Imprimer / PDF"})]}),R&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-8 relative animate-fade-in flex flex-col items-center",children:[o.jsx("h2",{className:"text-xl font-bold mb-4",children:"Slectionnez les colonnes  importer"}),o.jsxs("div",{className:"space-y-3 w-full",children:[o.jsxs("div",{children:[o.jsx("label",{children:"Matricule :"}),o.jsxs("select",{value:S.matricule,onChange:se=>C({...S,matricule:se.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),v.map(se=>o.jsx("option",{value:se,children:se},se))]})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Nom :"}),o.jsxs("select",{value:S.nom,onChange:se=>C({...S,nom:se.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),v.map(se=>o.jsx("option",{value:se,children:se},se))]})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Prnoms :"}),o.jsxs("select",{value:S.prenoms,onChange:se=>C({...S,prenoms:se.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),v.map(se=>o.jsx("option",{value:se,children:se},se))]})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Noms et Prnoms (si tout est dans une seule colonne) :"}),o.jsxs("select",{value:S.nomPrenoms,onChange:se=>C({...S,nomPrenoms:se.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),v.map(se=>o.jsx("option",{value:se,children:se},se))]}),o.jsx("div",{className:"text-xs text-gray-500",children:"Si cette colonne est slectionne, le nom sera le premier mot, le reste les prnoms."})]})]}),o.jsxs("div",{className:"mt-4 flex justify-end space-x-2 w-full",children:[o.jsx("button",{className:"px-4 py-2 bg-gray-200 rounded",onClick:()=>q(!1),children:"Annuler"}),o.jsx("button",{className:"px-4 py-2 bg-teal-600 text-white rounded",onClick:O,children:"Valider"})]}),o.jsxs("div",{className:"mt-4 w-full",children:[o.jsx("h3",{className:"font-semibold mb-2",children:"Aperu des donnes :"}),o.jsxs("table",{className:"w-full text-xs border",children:[o.jsx("thead",{children:o.jsx("tr",{children:v.map(se=>o.jsx("th",{className:"border px-1",children:se},se))})}),o.jsx("tbody",{children:N.map((se,ke)=>o.jsx("tr",{children:v.map((Ke,Je)=>o.jsx("td",{className:"border px-1",children:se[Je]},Je))},ke))})]})]})]})}),P&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-[90vw] p-8 relative animate-fade-in flex flex-col items-center",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Aperu de l'importation"}),o.jsx("div",{className:"w-full max-h-[60vh] overflow-y-auto mb-6 border rounded-lg",children:o.jsxs("table",{className:"w-full text-sm border-collapse",children:[o.jsx("thead",{className:"bg-gray-100 sticky top-0",children:o.jsxs("tr",{className:"text-center",children:[o.jsx("th",{className:"py-2 px-3 border",children:"Matricule"}),o.jsx("th",{className:"py-2 px-3 border",children:"Nom"}),o.jsx("th",{className:"py-2 px-3 border",children:"Prnoms"})]})}),o.jsx("tbody",{children:N.map((se,ke)=>o.jsxs("tr",{className:"text-center hover:bg-gray-50",children:[o.jsx("td",{className:"py-2 px-3 border",children:se.matricule}),o.jsx("td",{className:"py-2 px-3 border",children:se.nom}),o.jsx("td",{className:"py-2 px-3 border",children:se.prenoms})]},ke))})]})}),o.jsxs("div",{className:"mb-6 w-full flex flex-col items-center",children:[o.jsx("label",{className:"font-semibold mb-2",children:"Classe d'affectation :"}),o.jsxs("select",{value:T,onChange:se=>k(se.target.value),className:"px-3 py-2 border rounded w-full max-w-xs",children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),kt.map(se=>o.jsxs("option",{value:se.id,children:[se.niveau," ",se.section]},se.id))]})]}),o.jsxs("div",{className:"flex justify-end gap-4 w-full",children:[o.jsx("button",{className:"px-4 py-2 bg-gray-400 text-white rounded",onClick:()=>D(!1),children:"Annuler"}),o.jsx("button",{className:"px-4 py-2 bg-teal-600 text-white rounded font-bold",onClick:K,children:"Valider l'importation"})]})]})}),ae&&ie&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-[90vw] p-6 relative animate-fade-in",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rsultat de l'import des paiements"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{className:"border rounded p-3",children:[o.jsxs("h3",{className:"font-semibold",children:["Paiements appliqus (",ie.applied.length,")"]}),o.jsx("div",{className:"mt-2 max-h-60 overflow-auto text-sm",children:o.jsxs("table",{className:"w-full text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"py-1",children:"Ligne"}),o.jsx("th",{className:"py-1",children:"lve"}),o.jsx("th",{className:"py-1",children:"Mois"}),o.jsx("th",{className:"py-1",children:"Montant"})]})}),o.jsx("tbody",{children:ie.applied.map((se,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"py-1",children:se.row}),o.jsx("td",{className:"py-1",children:se.eleveId}),o.jsx("td",{className:"py-1",children:se.month}),o.jsx("td",{className:"py-1",children:se.montant})]},ke))})]})})]}),o.jsxs("div",{className:"border rounded p-3",children:[o.jsxs("h3",{className:"font-semibold",children:["Lignes non rsolues (",ie.unresolved.length,")"]}),o.jsx("div",{className:"mt-2 max-h-60 overflow-auto text-sm",children:o.jsxs("table",{className:"w-full text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"py-1",children:"Ligne"}),o.jsx("th",{className:"py-1",children:"Nom"}),o.jsx("th",{className:"py-1",children:"Classe"}),o.jsx("th",{className:"py-1",children:"Contact"})]})}),o.jsx("tbody",{children:ie.unresolved.map((se,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"py-1",children:se.row}),o.jsx("td",{className:"py-1",children:se.name}),o.jsx("td",{className:"py-1",children:se.classe}),o.jsx("td",{className:"py-1",children:se.contact||""})]},ke))})]})})]})]}),o.jsx("div",{className:"flex justify-end gap-2",children:o.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:()=>{me(!1),ce(null)},children:"Fermer"})})]})}),J&&de&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-[95vw] p-6 relative animate-fade-in",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Aperu des paiements dtects"}),o.jsxs("div",{className:"max-h-[55vh] overflow-auto mb-4",children:[o.jsxs("table",{className:"w-full text-sm border-collapse",children:[o.jsx("thead",{className:"bg-gray-100 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"p-2 border",children:"Ligne"}),o.jsx("th",{className:"p-2 border",children:"lve suggr"}),o.jsx("th",{className:"p-2 border",children:"Nom"}),o.jsx("th",{className:"p-2 border",children:"Classe"}),o.jsx("th",{className:"p-2 border",children:"Mois"}),o.jsx("th",{className:"p-2 border",children:"Montant"})]})}),o.jsx("tbody",{children:de.proposals.map((se,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"p-2",children:se.row}),o.jsx("td",{className:"p-2",children:se.match?se.match.name:""}),o.jsx("td",{className:"p-2",children:se.name}),o.jsx("td",{className:"p-2",children:se.classe}),o.jsx("td",{className:"p-2",children:se.month}),o.jsx("td",{className:"p-2",children:se.montant})]},ke))})]}),o.jsxs("div",{className:"mt-4",children:[o.jsxs("h3",{className:"font-semibold",children:["Lignes non rsolues (",de.unresolved.length,")"]}),o.jsx("div",{className:"max-h-40 overflow-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"p-2 border",children:"Ligne"}),o.jsx("th",{className:"p-2 border",children:"Nom"}),o.jsx("th",{className:"p-2 border",children:"Classe"})]})}),o.jsx("tbody",{children:de.unresolved.map((se,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"p-2",children:se.row}),o.jsx("td",{className:"p-2",children:se.name}),o.jsx("td",{className:"p-2",children:se.classe})]},ke))})]})})]})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:()=>{xe(!1),he(null)},children:"Annuler"}),o.jsx("button",{className:"px-4 py-2 bg-teal-600 text-white rounded",onClick:async()=>{try{const ke=await(await yn(()=>Promise.resolve().then(()=>Cu),void 0,import.meta.url)).applyPaiementsDepuisProposals(de.proposals);ce(ke),me(!0),xe(!1),he(null)}catch(se){const ke=se instanceof Error?se.message:String(se);r("Erreur lors de l'application: "+ke,"error")}},children:"Appliquer les paiements"})]})]})})]}),children:[o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(wc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher un lve...",value:ne,onChange:se=>L(se.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]}),o.jsxs("select",{value:U,onChange:se=>H(se.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Toutes les classes"}),kt.map(se=>o.jsxs("option",{value:se.id,children:[se.niveau," ",se.section]},se.id))]}),o.jsxs("select",{value:oe,onChange:se=>F(se.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Tous les statuts financiers"}),o.jsx("option",{value:"Pay",children:"Pay"}),o.jsx("option",{value:"Partiel",children:"Partiel"}),o.jsx("option",{value:"Impay",children:"Impay"})]}),o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:[o.jsx(cv,{className:"h-4 w-4"}),o.jsx("span",{children:"Plus de filtres"})]})]})}),o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden",children:[o.jsxs("div",{id:"print-area",className:"hidden print:block bg-white p-4 mb-4",children:[o.jsx(Bf,{type:"eleves",libelle:Br}),o.jsx("div",{className:"mb-2 overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse",style:{tableLayout:"fixed"},children:[o.jsx("colgroup",{children:tr.map((se,ke)=>o.jsx("col",{style:{width:Ln[ke]}},ke))}),o.jsx("thead",{children:o.jsx("tr",{children:tr.map((se,ke)=>o.jsx("th",{className:"border px-2 py-1 text-left text-sm font-medium align-top",children:se},ke))})})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"min-w-full border-collapse",style:{tableLayout:"fixed"},children:[o.jsx("colgroup",{children:tr.map((se,ke)=>o.jsx("col",{style:{width:Ln[ke]}},ke))}),o.jsx("tbody",{children:en.map((se,ke)=>o.jsx("tr",{className:ke%2===0?"bg-white":"bg-gray-50",children:tr.map((Ke,Je)=>{const We=Ke.toLowerCase();let at="";if(jt){if(We==="n")return at=ke+1,o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je);if(We.includes("matricul"))return at=se.matricule||"",o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je);if(We.includes("nom")&&We.includes("pr"))return at=Bt(se),o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je);if(We.includes("date")&&We.includes("naiss"))return at="",o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je)}if(!jt&&We==="n")return at=ke+1,o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je);if(We.includes("matricul"))at=se.matricule||"";else if(We.includes("nom")&&We.includes("pr"))at=Bt(se);else if(We.includes("nom")&&!We.includes("pr"))at=se.nom||"";else if((We.includes("pr")||We.includes("prnom")||We.includes("prenoms"))&&!We.includes("nom"))at=se.prenoms||"";else if(We.includes("date")&&We.includes("naiss"))at=se.dateNaissance?new Date(se.dateNaissance).toLocaleDateString("fr-FR"):"";else if(We.includes("classe"))at=ut(se.classeId);else if(We.includes("sexe"))at=se.sexe==="M"?"Masculin":"Fminin";else if(We.includes("parent"))at=`P: ${se.pereTuteur||""}  M: ${se.mereTutrice||""}`;else if(We.includes("statut financi")||We.includes("financier"))at=X(se);else if(/\b(?:n|no\.?|#|num(?:ero|ro)?|numero)\b/.test(We))at=ke+1;else{const Cr=Ke.toLowerCase().replace(/\s+/g,"").replace(/&/g,"and"),tn=Object.keys(se).find(Ar=>Ar.toLowerCase()===Cr);at=tn?se[tn]:""}return o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je)})},se.id))})]}),o.jsx("div",{className:"text-xs text-right text-gray-500 mt-2",children:Yt.footer})]})]}),n.length>0&&o.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[o.jsxs("span",{className:"font-medium text-gray-700",children:[n.length," slectionn(s)"]}),o.jsx(Ft,{variant:"danger",onClick:m,children:"Supprimer"}),o.jsx(Ft,{variant:"primary",onClick:()=>s(!0),children:"Changer de classe"}),o.jsx(Ft,{variant:"ghost",onClick:()=>a([]),children:"Tout dslectionner"})]}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-[90vw] mx-4",children:[o.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 text-center",children:"Changement de Classe"}),o.jsxs("p",{className:"text-gray-600 text-center mt-1",children:[n.length," lve(s) slectionn(s)"]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Nouvelle classe d'affectation"}),o.jsxs("select",{value:c,onChange:se=>f(se.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),kt.map(se=>o.jsxs("option",{value:se.id,children:[se.niveau," ",se.section," (",se.anneeScolaire,")"]},se.id))]})]}),o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsx("p",{className:"text-gray-700 text-sm",children:" Cette action modifiera la classe de tous les lves slectionns"})})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-4 mt-6 pt-6 border-t border-gray-200",children:[o.jsx(Ft,{variant:"secondary",className:"w-full sm:w-auto",onClick:()=>s(!1),children:"Annuler"}),o.jsx(Ft,{variant:"primary",className:"w-full sm:w-auto",onClick:x,disabled:!c,children:"Valider le Changement"})]}),o.jsxs(o.Fragment,{children:[o.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Changer la classe de ",n.length," lve(s)"]}),o.jsxs("select",{value:c,onChange:se=>f(se.target.value),className:"w-full mb-4 border rounded px-3 py-2",children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),kt.map(se=>o.jsxs("option",{value:se.id,children:[se.niveau," ",se.section]},se.id))]}),o.jsxs("div",{className:"flex justify-end space-x-2 w-full",children:[o.jsx(Ft,{variant:"secondary",onClick:()=>s(!1),children:"Annuler"}),o.jsx(Ft,{variant:"primary",onClick:x,children:"Valider"})]})]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-2 py-3 text-center",children:o.jsx("input",{type:"checkbox",checked:n.length===en.length&&en.length>0,onChange:se=>d(se.target.checked)})}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"N"}),o.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-100",onClick:()=>rr("matricule"),children:["Matricule ",Ae==="matricule"&&(Le==="asc"?"":"")]}),o.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-100",onClick:()=>rr("nom"),children:["Nom et Prnoms ",Ae==="nom"&&(Le==="asc"?"":"")]}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Sexe"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Date Naissance"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Classe"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Parents"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Statut"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Statut Financier"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:en.map((se,ke)=>o.jsxs("tr",{className:`hover:bg-gray-50 ${n.includes(se.id)?"bg-teal-50":""}`,children:[o.jsx("td",{className:"px-2 py-3 text-center",children:o.jsx("input",{type:"checkbox",checked:n.includes(se.id),onChange:Ke=>h(se.id,Ke.target.checked)})}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:ke+1}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:se.matricule}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[se.photo&&o.jsx("img",{src:se.photo,alt:Bt(se),className:"h-8 w-8 rounded-full object-cover"}),o.jsx("div",{children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:Bt(se)})})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${se.sexe==="M"?"bg-blue-100 text-blue-800":"bg-pink-100 text-pink-800"}`,children:se.sexe==="M"?"Masculin":"Fminin"})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(se.dateNaissance).toLocaleDateString("fr-FR")}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:ut(se.classeId)}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:o.jsxs("div",{children:[o.jsxs("div",{className:"font-medium",children:["P: ",se.pereTuteur]}),o.jsxs("div",{children:["M: ",se.mereTutrice]}),se.protege&&se.garantId&&(()=>{const Ke=fe.getById("enseignants",se.garantId);return Ke?o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Garant: ",Bt(Ke)]}):null})()]})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Ct(se.statut)}`,children:se.statut})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${V(X(se))}`,children:X(se)})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>e(se),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Voir dtails",children:o.jsx(u4,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>e(se),className:"p-1 text-gray-600 hover:bg-gray-50 rounded",title:"Modifier",children:o.jsx(zo,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>Cn(se),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Supprimer",children:o.jsx($s,{className:"h-4 w-4"})})]})})]},se.id))})]})})]}),en.length===0&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-gray-500",children:"Aucun lve trouv"})})]})}function gm(e,t="Vous avez des modifications non sauvegardes. Vouliez-vous quitter sans enregistrer ?"){const[r,n]=j.useState(!1),a=j.useRef(!1);a.current=!!e;const i=j.useRef(null);return j.useEffect(()=>{let d=null,h=null;try{const v=window;v.__unsavedGuards||(v.__unsavedGuards=new Set),d=()=>{try{const b=window;if(b&&b.__skipUnsavedGuards||b&&b.__forceNavigationInProgress)return!1}catch{}return!!a.current},v.__unsavedGuards.add(d),v.__unsavedAllowHandlers||(v.__unsavedAllowHandlers=new Set),h=()=>{try{a.current=!1,n(!1)}catch{}},v.__unsavedAllowHandlers.add(h);try{console.debug("[useUnsavedWarning] registered guard",{id:h&&h.toString().slice(0,40)})}catch{}}catch{}const m=v=>{if(a.current)return v.preventDefault(),v.returnValue=t,t},x=()=>{a.current&&(history.pushState(null,document.title,window.location.href),n(!0))},g=v=>{try{console.debug("[useUnsavedWarning] handleAppNavigate called, dirty=",a.current)}catch{}try{const b=window;if(b&&b.__forceNavigationInProgress){console.debug("[useUnsavedWarning] skipping due to forceNavigation flag");return}}catch{}if(a.current){try{v&&typeof v.stopImmediatePropagation=="function"&&v.stopImmediatePropagation()}catch{}i.current=v?.detail||{page:null};try{const b=window;try{console.debug("[useUnsavedWarning] calling autosave handlers")}catch{}b.__autosaveHandlers&&typeof b.__autosaveHandlers.forEach=="function"&&b.__autosaveHandlers.forEach(N=>{try{N()}catch(E){console.debug("autosave handler failed",E)}})}catch{}n(!0);try{history.pushState(null,document.title,window.location.href)}catch{}}},y=()=>{try{console.debug("[useUnsavedWarning] unsaved:allow received, running allowHandler")}catch{}try{typeof h=="function"&&h()}catch{}};return window.addEventListener("unsaved:allow",y),window.addEventListener("beforeunload",m),window.addEventListener("popstate",x),window.addEventListener("navigate",g,!0),()=>{try{window.removeEventListener("beforeunload",m),window.removeEventListener("popstate",x),window.removeEventListener("navigate",g,!0),window.removeEventListener("unsaved:allow",y)}catch{}try{const v=window;d&&v&&v.__unsavedGuards&&v.__unsavedGuards.delete(d),h&&v&&v.__unsavedAllowHandlers&&v.__unsavedAllowHandlers.delete(h)}catch{}}},[t]),{showPrompt:r,openPrompt:()=>n(!0),closePrompt:()=>n(!1),allowNavigation:()=>{n(!1),a.current=!1;const d=i.current;i.current=null,setTimeout(()=>{try{const h=window;if(h&&(h.__preventReDispatch||h.__forceNavigationInProgress)){try{console.debug("[useUnsavedWarning] skipping re-dispatch because app will handle navigation")}catch{}return}d&&d.page?window.dispatchEvent(new CustomEvent("navigate",{detail:d})):history.back()}catch(h){console.debug("allowNavigation failed",h)}},0)}}}function vm(e,t){const r=`autosave:${e}`,n=j.useRef(t);return n.current=t,j.useEffect(()=>{if(t!==void 0)try{const c=JSON.stringify(t);localStorage.setItem(r,c)}catch(c){console.debug("autosave write failed",c)}},[r,t]),j.useEffect(()=>{const c=window,f=()=>{try{const d=n.current;if(d===void 0)return;localStorage.setItem(r,JSON.stringify(d));try{console.debug("[useAutoSave] saved",r)}catch{}}catch(d){console.debug("autosave immediate write failed",d)}};c.__autosaveHandlers||(c.__autosaveHandlers=new Set),c.__autosaveHandlers.add(f);try{console.debug("[useAutoSave] registered handler",r)}catch{}return()=>{try{c.__autosaveHandlers.delete(f)}catch{}}},[r]),{load:()=>{try{const c=localStorage.getItem(r);return c?JSON.parse(c):null}catch(c){return console.debug("autosave read failed",c),null}},clear:()=>{try{localStorage.removeItem(r)}catch{}},saveNow:()=>{try{const c=n.current;if(c===void 0)return;localStorage.setItem(r,JSON.stringify(c));try{console.debug("[useAutoSave] saveNow called",r)}catch{}}catch(c){console.debug("autosave saveNow failed",c)}}}}function QX({eleve:e,onSave:t,onCancel:r}){const{showToast:n}=Jr(),[a,i]=j.useState({matricule:"",nom:"",prenoms:"",sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:"",anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:"",adresse:"",photo:"",protege:!1,garantId:""}),[s,c]=j.useState({}),[f,d]=j.useState(!1),h=fe.getAll("classes"),m=fe.getAll("enseignants");j.useEffect(()=>{if(e){const M={matricule:e.matricule,nom:e.nom,prenoms:e.prenoms,sexe:e.sexe,dateNaissance:e.dateNaissance,lieuNaissance:e.lieuNaissance,classeId:e.classeId,anneeEntree:e.anneeEntree,statut:e.statut,pereTuteur:e.pereTuteur,mereTutrice:e.mereTutrice,telephone:e.telephone,adresse:e.adresse,photo:e.photo||"",protege:e.protege||!1,garantId:e.garantId||""};i(M),x.current=M,fe.getAll("enseignants")}else{const M=fe.generateMatricule(),z={...a,matricule:M};i(z),x.current=z}},[e]);const x=j.useRef({}),g=j.useMemo(()=>{try{return JSON.stringify(x.current||{})!==JSON.stringify(a||{})}catch{return!1}},[a]),y=gm(g),v=e?.id?`eleve:${e.id}`:"eleve:new",{load:b,clear:N}=vm(v,a),E=j.useRef(null),[S,C]=j.useState(!1);j.useEffect(()=>{try{const M=b();M&&i(z=>({...z,...M}))}catch{}},[]);const T=()=>{try{N()}catch{}const M=window;try{M.__preventReDispatch=!0}catch{}try{y&&y.allowNavigation?y.allowNavigation():r()}finally{setTimeout(()=>{try{M.__preventReDispatch=!1}catch{}},80)}},k=()=>{y&&y.closePrompt&&y.closePrompt()},P=()=>{const M={};a.nom.trim()||(M.nom="Le nom est obligatoire"),a.prenoms.trim()||(M.prenoms="Les prnoms sont obligatoires"),a.classeId||(M.classeId="La classe est obligatoire"),a.protege&&!a.garantId&&(M.garantId="Un garant (enseignant) est requis pour un lve protg");const z=fe.getAll("eleves");return a.matricule&&a.matricule.trim()&&z.find(ce=>ce.matricule===a.matricule&&ce.id!==e?.id)&&(M.matricule="Ce matricule existe dj"),c(M),Object.keys(M).length===0},D=async M=>{if(M.preventDefault(),!!P()){d(!0);try{e?(fe.update("eleves",e.id,a),n("lve mis  jour avec succs","success")):(fe.create("eleves",a),n("lve ajout avec succs","success"));try{N()}catch{}t()}catch{n("Erreur lors de la sauvegarde de l'lve","error")}finally{d(!1)}}},R=(M,z)=>{i(ie=>({...ie,[M]:z})),s[M]&&c(ie=>({...ie,[M]:""}))},q=M=>{const z=M.target.files?.[0];if(z){const ie=new FileReader;ie.onload=ce=>{i(ae=>({...ae,photo:ce.target?.result}))},ie.readAsDataURL(z)}};return o.jsxs("div",{className:"p-6 max-w-5xl mx-auto",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Modifier l'lve":"Nouvel lve"}),o.jsx("p",{className:"text-gray-600 mt-1",children:e?"Modifiez les informations de l'lve":"Ajoutez un nouvel lve"})]}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",children:o.jsx(Qs,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations personnelles"}),o.jsxs("div",{className:"flex items-start space-x-8",children:[o.jsxs("div",{className:"flex-shrink-0",children:[o.jsxs("div",{className:"w-32 h-32 bg-white rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center relative overflow-hidden group hover:border-gray-400 transition-colors",children:[a.photo?o.jsx("img",{src:a.photo,alt:"Photo lve",className:"w-full h-full object-cover rounded-lg"}):o.jsxs("div",{className:"text-center",children:[o.jsx(Ho,{className:"h-10 w-10 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Photo lve"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:q,className:"absolute inset-0 opacity-0 cursor-pointer"})]}),o.jsxs("button",{type:"button",className:"mt-3 w-full flex items-center justify-center px-3 py-2 text-sm bg-gray-700 text-white rounded-md hover:bg-gray-800 transition-colors",children:[o.jsx(Us,{className:"h-4 w-4 mr-2"}),"Changer photo"]})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Matricule ",o.jsx("span",{className:"text-gray-400 text-sm",children:"(optionnel)"})]}),o.jsx("input",{type:"text",value:a.matricule,onChange:M=>R("matricule",M.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.matricule?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Gnr automatiquement"}),s.matricule&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.matricule]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:M=>R("nom",M.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.nom?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Nom de famille"}),s.nom&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.nom]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Prnoms ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.prenoms,onChange:M=>R("prenoms",M.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.prenoms?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Prnoms"}),s.prenoms&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.prenoms]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Sexe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:`flex items-center justify-center p-3 border rounded-md cursor-pointer transition-all ${a.sexe==="M"?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"M",checked:a.sexe==="M",onChange:M=>R("sexe",M.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:" Masculin"})]}),o.jsxs("label",{className:`flex items-center justify-center p-3 border rounded-md cursor-pointer transition-all ${a.sexe==="F"?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"F",checked:a.sexe==="F",onChange:M=>R("sexe",M.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:" Fminin"})]})]})]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations scolaires"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Date de naissance ",o.jsx("span",{className:"text-gray-400 text-sm",children:"(optionnel)"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(Ih,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:a.dateNaissance,onChange:M=>R("dateNaissance",M.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.dateNaissance?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`})]}),s.dateNaissance&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.dateNaissance]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Lieu de naissance"}),o.jsxs("div",{className:"relative",children:[o.jsx(uv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.lieuNaissance,onChange:M=>R("lieuNaissance",M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"Ville de naissance"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Classe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:a.classeId,onChange:M=>R("classeId",M.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.classeId?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),h.map(M=>o.jsxs("option",{value:M.id,children:[M.niveau," ",M.section," (",M.anneeScolaire,")"]},M.id))]}),s.classeId&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.classeId]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Anne d'entre"}),o.jsx("input",{type:"text",value:a.anneeEntree,onChange:M=>R("anneeEntree",M.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"2025"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Statut"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"Actif",label:"Actif"},{value:"Inactif",label:"Inactif"},{value:"Transfr",label:"Transfr"}].map(M=>o.jsxs("label",{className:`flex items-center justify-center p-2 border rounded-md cursor-pointer transition-all ${a.statut===M.value?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"statut",value:M.value,checked:a.statut===M.value,onChange:z=>R("statut",z.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium text-sm",children:M.label})]},M.value))})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations familiales"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Pre / Tuteur"}),o.jsxs("div",{className:"relative",children:[o.jsx(zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.pereTuteur,onChange:M=>R("pereTuteur",M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"Nom du pre ou tuteur"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Mre / Tutrice"}),o.jsxs("div",{className:"relative",children:[o.jsx(zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.mereTutrice,onChange:M=>R("mereTutrice",M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"Nom de la mre ou tutrice"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Tlphone"}),o.jsxs("div",{className:"relative",children:[o.jsx(g1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"tel",value:a.telephone,onChange:M=>R("telephone",M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"+225 XX XX XX XX XX"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Adresse"}),o.jsxs("div",{className:"relative",children:[o.jsx(uv,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),o.jsx("textarea",{value:a.adresse,onChange:M=>R("adresse",M.target.value),rows:3,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors resize-none",placeholder:"Adresse de rsidence"})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statut spcial"}),o.jsx("div",{className:"flex items-center space-x-4",children:o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:a.protege,onChange:M=>R("protege",M.target.checked),className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:"lve protg (ne paie que l'inscription)"})]})}),a.protege&&o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Garant (enseignant)"}),o.jsxs("select",{value:a.garantId,onChange:M=>R("garantId",M.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"-- Aucun --"}),m.map(M=>o.jsx("option",{value:M.id,children:Bt(M)},M.id))]})]})]})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:()=>{if(!g)return r();try{E.current={type:"cancel"},y&&y.openPrompt&&y.openPrompt()}catch{if(window.confirm("Vous avez des modifications non sauvegardes. Quitter sans enregistrer ?")){try{N()}catch{}r()}}},className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors font-medium",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 focus:ring-2 focus:ring-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:[f?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Js,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:e?f?"Sauvegarde...":"Mettre  jour l'lve":f?"Sauvegarde...":"Enregistrer l'lve"})]})]})]})]}),y&&o.jsx(bf,{open:!!y.showPrompt,onConfirm:T,onCancel:k})]})}function ZX({onEnseignantSelect:e,onNewEnseignant:t}){const[r,n]=j.useState(""),[a,i]=j.useState(""),s=fe.getAll("enseignants"),c=fe.getAll("classes"),f=j.useMemo(()=>{let x=[...s];if(r){const g=r.toLowerCase();x=x.filter(y=>y.nom.toLowerCase().includes(g)||y.prenoms.toLowerCase().includes(g)||(y.specialite||"").toLowerCase().includes(g)||(y.email||"").toLowerCase().includes(g)||Bt(y).toLowerCase().includes(g))}return a&&(x=x.filter(g=>g.statut===a)),x.sort((g,y)=>g.nom.localeCompare(y.nom))},[s,r,a]),d=x=>{const g=c.filter(y=>y.enseignantPrincipal===`${x.prenoms} ${x.nom}`);if(g.length>0){alert(`Impossible de supprimer cet enseignant car il est assign  ${g.length} classe(s).`);return}window.confirm(`tes-vous sr de vouloir supprimer l'enseignant ${x.prenoms} ${x.nom} ?`)&&fe.delete("enseignants",x.id)},h=x=>{switch(x){case"Actif":return"bg-green-100 text-green-800";case"Inactif":return"bg-gray-100 text-gray-800";case"Cong":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},m=x=>c.filter(g=>g.enseignantPrincipal===x);return o.jsxs(Tc,{title:"Gestion des Enseignants",subtitle:`${f.length} enseignant(s) trouv(s)`,actions:o.jsx(o.Fragment,{children:o.jsxs(Ft,{variant:"primary",onClick:t,children:[o.jsx(Wo,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvel Enseignant"})]})}),children:[o.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(wc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher un enseignant...",value:r,onChange:x=>n(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),o.jsxs("select",{value:a,onChange:x=>i(x.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"Tous les statuts"}),o.jsx("option",{value:"Actif",children:"Actif"}),o.jsx("option",{value:"Inactif",children:"Inactif"}),o.jsx("option",{value:"Cong",children:"En cong"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(x=>{const g=m(Bt(x));return o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[x.photo?o.jsx("img",{src:x.photo,alt:Bt(x),className:"h-12 w-12 rounded-full object-cover"}):o.jsx("div",{className:"h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center",children:o.jsx(Ho,{className:"h-6 w-6 text-gray-400"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Bt(x)}),o.jsx("p",{className:"text-sm text-gray-500",children:x.specialite})]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>e(x),className:"p-2 text-gray-600 hover:bg-gray-50 rounded",title:"Modifier",children:o.jsx(zo,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>d(x),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Supprimer",children:o.jsx($s,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"mb-4",children:o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${h(x.statut)}`,children:x.statut})}),o.jsxs("div",{className:"space-y-2 mb-4",children:[x.telephone&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(g1,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm text-gray-600",children:x.telephone})]}),x.email&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(N5,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm text-gray-600",children:x.email})]})]}),o.jsx("div",{className:"mb-4",children:o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium",children:"Diplme:"})," ",x.diplome]})}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Classes assignes (",g.length,")"]}),g.length>0?o.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.slice(0,3).map(y=>o.jsxs("span",{className:"px-2 py-1 bg-teal-100 text-teal-800 text-xs rounded",children:[y.niveau," ",y.section]},y.id)),g.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",g.length-3]})]}):o.jsx("span",{className:"text-xs text-gray-500",children:"Aucune classe assigne"})]}),o.jsx("div",{className:"pt-4 border-t border-gray-100",children:o.jsxs("p",{className:"text-xs text-gray-500",children:["Embauch le ",new Date(x.dateEmbauche).toLocaleDateString("fr-FR")]})})]},x.id)})}),f.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Ho,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucun enseignant trouv"}),o.jsx(Ft,{variant:"primary",onClick:t,className:"mt-4",children:"Ajouter votre premier enseignant"})]})]})}function eq({enseignant:e,onSave:t,onCancel:r}){const{showToast:n}=Jr(),[a,i]=j.useState({nom:"",prenoms:"",sexe:"M",telephone:"",adresse:"",specialite:"",diplome:"",dateEmbauche:"",statut:"Actif",salaire:0,photo:"",classesPrincipales:[],matieresEnseignees:[]}),[s,c]=j.useState({}),[f,d]=j.useState(!1);j.useEffect(()=>{e&&i({nom:e.nom,prenoms:e.prenoms,sexe:e.sexe,telephone:e.telephone,adresse:e.adresse,specialite:e.specialite,diplome:e.diplome,dateEmbauche:e.dateEmbauche,statut:e.statut,salaire:e.salaire,photo:e.photo||"",classesPrincipales:e.classesPrincipales||[],matieresEnseignees:e.matieresEnseignees||[]})},[e]);const h=()=>{const y={};return a.nom.trim()||(y.nom="Le nom est obligatoire"),a.prenoms.trim()||(y.prenoms="Les prnoms sont obligatoires"),a.specialite.trim()||(y.specialite="La spcialit est obligatoire"),a.diplome.trim()||(y.diplome="Le diplme est obligatoire"),a.dateEmbauche||(y.dateEmbauche="La date d'embauche est obligatoire"),a.salaire<0&&(y.salaire="Le salaire doit tre positif"),fe.getAll("enseignants").find(N=>N.nom.toLowerCase()===a.nom.toLowerCase()&&N.prenoms.toLowerCase()===a.prenoms.toLowerCase()&&N.id!==e?.id)&&(y.nom="Un enseignant avec ce nom et ces prnoms existe dj"),c(y),Object.keys(y).length===0},m=async y=>{if(y.preventDefault(),!!h()){d(!0);try{e?(fe.update("enseignants",e.id,a),n("Enseignant mis  jour avec succs","success")):(fe.create("enseignants",a),n("Enseignant ajout avec succs","success")),t()}catch{n("Erreur lors de la sauvegarde de l'enseignant","error")}finally{d(!1)}}},x=(y,v)=>{i(b=>({...b,[y]:v})),s[y]&&c(b=>({...b,[y]:""}))},g=y=>{const v=y.target.files?.[0];if(v){const b=new FileReader;b.onload=N=>{i(E=>({...E,photo:N.target?.result}))},b.readAsDataURL(v)}};return o.jsx("div",{className:"p-6 max-w-5xl mx-auto",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-8",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:o.jsx(Ho,{className:"h-8 w-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:e?"Modifier l'enseignant":"Nouvel enseignant"}),o.jsx("p",{className:"text-blue-100 mt-1",children:e?"Modifiez les informations de l'enseignant":"Ajoutez un nouvel enseignant"})]})]}),o.jsx("button",{onClick:r,className:"text-white hover:bg-white hover:bg-opacity-20 p-3 rounded-xl transition-colors",children:o.jsx(Qs,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:m,className:"p-8 space-y-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-6",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[o.jsx("span",{className:"bg-blue-100 p-2 rounded-lg mr-3",children:""}),"Informations personnelles"]}),o.jsxs("div",{className:"flex items-start space-x-8",children:[o.jsxs("div",{className:"flex-shrink-0",children:[o.jsxs("div",{className:"w-32 h-32 bg-white rounded-2xl border-4 border-dashed border-gray-300 flex items-center justify-center relative overflow-hidden group hover:border-blue-400 transition-colors",children:[a.photo?o.jsx("img",{src:a.photo,alt:"Photo enseignant",className:"w-full h-full object-cover rounded-xl"}):o.jsxs("div",{className:"text-center",children:[o.jsx(Ho,{className:"h-10 w-10 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Photo enseignant"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"absolute inset-0 opacity-0 cursor-pointer"})]}),o.jsxs("button",{type:"button",className:"mt-3 w-full flex items-center justify-center px-3 py-2 text-sm bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:[o.jsx(Us,{className:"h-4 w-4 mr-2"}),"Changer photo"]})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:y=>x("nom",y.target.value),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.nom?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Nom de famille"}),s.nom&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.nom]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Prnoms ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.prenoms,onChange:y=>x("prenoms",y.target.value),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.prenoms?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Prnoms"}),s.prenoms&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.prenoms]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Sexe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:`flex items-center justify-center p-3 border-2 rounded-xl cursor-pointer transition-all ${a.sexe==="M"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"M",checked:a.sexe==="M",onChange:y=>x("sexe",y.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:" Masculin"})]}),o.jsxs("label",{className:`flex items-center justify-center p-3 border-2 rounded-xl cursor-pointer transition-all ${a.sexe==="F"?"border-pink-500 bg-pink-50 text-pink-700":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"F",checked:a.sexe==="F",onChange:y=>x("sexe",y.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:" Fminin"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Tlphone"}),o.jsxs("div",{className:"relative",children:[o.jsx(g1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"tel",value:a.telephone,onChange:y=>x("telephone",y.target.value),className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all",placeholder:"+225 XX XX XX XX XX"})]})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[o.jsx("span",{className:"bg-green-100 p-2 rounded-lg mr-3",children:""}),"Informations professionnelles"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Spcialit ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(x1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.specialite,onChange:y=>x("specialite",y.target.value),className:`w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.specialite?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Ex: Instituteur, Professeur des coles..."})]}),s.specialite&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.specialite]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Diplme ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.diplome,onChange:y=>x("diplome",y.target.value),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.diplome?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Ex: CEAP, Licence, Master..."}),s.diplome&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.diplome]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Date d'embauche ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(Ih,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:a.dateEmbauche,onChange:y=>x("dateEmbauche",y.target.value),className:`w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.dateEmbauche?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`})]}),s.dateEmbauche&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.dateEmbauche]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Salaire (FCFA)"}),o.jsx("input",{type:"number",value:a.salaire,onChange:y=>x("salaire",parseInt(y.target.value)),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.salaire?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,min:"0",placeholder:"150000"}),s.salaire&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.salaire]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Statut"}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"Actif",label:" Actif",color:"green"},{value:"Inactif",label:" Inactif",color:"gray"},{value:"Cong",label:" En cong",color:"orange"}].map(y=>o.jsxs("label",{className:`flex items-center justify-center p-3 border-2 rounded-xl cursor-pointer transition-all ${a.statut===y.value?`border-${y.color}-500 bg-${y.color}-50 text-${y.color}-700`:"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"statut",value:y.value,checked:a.statut===y.value,onChange:v=>x("statut",v.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium text-sm",children:y.label})]},y.value))})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[o.jsx("span",{className:"bg-yellow-100 p-2 rounded-lg mr-3",children:""}),"Informations de contact"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Adresse"}),o.jsxs("div",{className:"relative",children:[o.jsx(uv,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),o.jsx("textarea",{value:a.adresse,onChange:y=>x("adresse",y.target.value),rows:3,className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all resize-none",placeholder:"Adresse de rsidence"})]})]})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:r,className:"px-8 py-4 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors font-semibold",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-3 px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:ring-4 focus:ring-blue-100 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",disabled:f,children:[f?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Js,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:e?f?"Sauvegarde...":"Mettre  jour l'enseignant":f?"Sauvegarde...":"Enregistrer l'enseignant"})]})]})]})]})})}function sP(e,t="Aperu",r=!0){const n=document.getElementById(e);if(n)try{const a=n.innerHTML,s=new DOMParser().parseFromString(a,"text/html");s.querySelectorAll(".no-print, button").forEach(y=>y.remove());const c=s.body.innerHTML,f=`
      <style>
        @page { 
          size: A4 portrait; 
          margin: 8mm; 
          background: white;
        }
        
        :root { 
          --page-height: 297mm; 
          --print-margin: 8mm; 
          --cut-gap: 6mm;
          --primary-blue: #1e40af;
          --primary-green: #059669;
          --accent-gold: #d97706;
          --text-dark: #1f2937;
          --text-gray: #6b7280;
          --border-light: #e5e7eb;
          --bg-light: #f9fafb;
        }
        
        html, body { 
          height: 100%; 
          margin: 0; 
          padding: 0; 
          background: white;
          font-family: 'Times New Roman', Times, serif;
          color: var(--text-dark);
          line-height: 1.4;
        }

        /* Layout containers */
        .receipt-wrapper { 
          width: 210mm; 
          margin: 0 auto; 
          box-sizing: border-box; 
          height: var(--page-height); 
        }
        
        .print-content { 
          box-sizing: border-box; 
          padding: calc(var(--print-margin) - 2mm); 
          display: block; 
          height: calc(var(--page-height)); 
        }

        /* Two-up layout improvements */
        .print-content.two-up { 
          display: flex; 
          flex-direction: column; 
          justify-content: space-between; 
          gap: var(--cut-gap); 
          page-break-after: always; 
        }
        /* Visible cut indicator for two-up double receipts */
        .print-content.two-up::before {
          content: ' Dcouper ici';
          position: absolute;
          left: 50%;
          transform: translateX(-50%);
          top: calc(50% - 10px);
          background: white;
          padding: 4px 10px;
          border-radius: 999px;
          font-weight: 700;
          color: var(--primary-blue);
          border: 1px solid rgba(0,0,0,0.06);
          z-index: 10;
        }
        
        .print-content.two-up .receipt-compact {
          /* Force each receipt to occupy exactly 50% of the printable area (minus cut gap) */
          height: calc((var(--page-height) - (var(--print-margin) * 2) - var(--cut-gap)) / 2);
          box-sizing: border-box;
          padding: 8px 12px;
          background: white;
          border: 2px solid var(--primary-blue);
          border-radius: 8px;
          box-shadow: 0 2px 8px rgba(30, 64, 175, 0.1);
          position: relative;
          overflow: hidden;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
        }

        /* Main receipt card styling */
        .receipt-compact { 
          box-sizing: border-box; 
          width: 100%; 
          max-width: 780px; 
          margin: 0 auto; 
          background: white; 
          padding: 20px 24px; 
          border-radius: 12px; 
          border: 2px solid var(--primary-blue);
          box-shadow: 0 4px 12px rgba(30, 64, 175, 0.12);
          page-break-inside: avoid; 
          break-inside: avoid; 
          display: flex; 
          flex-direction: column;
          position: relative;
          overflow: hidden;
        }

        /* Decorative elements */
        .receipt-compact::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 4px;
          background: linear-gradient(90deg, var(--primary-blue) 0%, var(--primary-green) 50%, var(--accent-gold) 100%);
        }

        .receipt-compact::after {
          content: '';
          position: absolute;
          top: 12px;
          right: 12px;
          width: 60px;
          height: 60px;
          background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-green) 100%);
          border-radius: 50%;
          opacity: 0.05;
          z-index: 0;
        }

        .receipt-compact > * {
          position: relative;
          z-index: 1;
        }

        /* Page break styling for non two-up */
        .print-content:not(.two-up) .receipt-compact:not(:last-child) { 
          page-break-after: always; 
        }
        
        .receipt-compact + .receipt-compact { 
          margin-top: 10mm; 
          border-top: 2px dashed var(--primary-blue); 
          position: relative; 
        }
        
        .receipt-compact + .receipt-compact::before { 
          content: ' Dcouper ici'; 
          position: absolute; 
          top: -8mm; 
          left: 50%; 
          transform: translateX(-50%); 
          background: white; 
          padding: 4px 16px; 
          color: var(--primary-blue); 
          font-size: 11px; 
          font-weight: 600;
          border: 1px solid var(--primary-blue);
          border-radius: 20px;
          z-index: 10;
        }

        /* Header improvements */
        .receipt-compact .entete { 
          display: flex; 
          align-items: center; 
          justify-content: center; 
          gap: 16px; 
          padding-bottom: 12px; 
          border-bottom: 2px solid var(--bg-light);
          margin-bottom: 16px;
        }
        
        .receipt-compact .entete img { 
          width: 70px; 
          height: 70px; 
          object-fit: contain; 
          border-radius: 8px;
          border: 2px solid var(--border-light);
          padding: 4px;
          background: var(--bg-light);
        }
        
        .receipt-compact .entete .entete-text { 
          text-align: center; 
          flex: 1;
        }
        
        .receipt-compact .entete .entete-text .school-name { 
          font-weight: 800; 
          font-size: 22px; 
          letter-spacing: -0.025em; 
          color: var(--primary-blue);
          text-shadow: 0 1px 2px rgba(30, 64, 175, 0.1);
          margin-bottom: 4px;
        }
        
        .receipt-compact .entete .entete-text .libelle { 
          color: var(--primary-green); 
          font-weight: 600; 
          font-size: 14px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        .receipt-compact .meta { 
          display: flex; 
          justify-content: space-between; 
          font-size: 12px; 
          color: var(--text-gray); 
          margin-top: 8px;
          padding: 8px 12px;
          background: var(--bg-light);
          border-radius: 6px;
          border-left: 3px solid var(--accent-gold);
        }

        /* Student info styling */
        .receipt-compact .student-row { 
          display: flex; 
          justify-content: space-between; 
          align-items: flex-start; 
          gap: 16px; 
          margin: 16px 0;
          padding: 12px;
          background: linear-gradient(135deg, rgba(30, 64, 175, 0.02) 0%, rgba(5, 150, 105, 0.02) 100%);
          border-radius: 8px;
          border: 1px solid var(--border-light);
        }
        
        .receipt-compact .student-row .left { 
          flex: 1;
          max-width: 65%; 
        }
        
        .receipt-compact .student-row .right { 
          text-align: right; 
          color: var(--text-dark); 
          font-weight: 700;
          font-size: 18px; /* slightly larger for amounts */
        }

        /* Title styling */
        h4 { 
          text-align: center; 
          font-size: 20px; 
          margin: 16px 0 20px; 
          font-weight: 800;
          color: var(--primary-blue);
          text-transform: uppercase;
          letter-spacing: 1px;
          position: relative;
        }

        h4::after {
          content: '';
          position: absolute;
          bottom: -6px;
          left: 50%;
          transform: translateX(-50%);
          width: 80px;
          height: 3px;
          background: linear-gradient(90deg, var(--primary-blue), var(--primary-green));
          border-radius: 2px;
        }

        /* Table improvements */
        table { 
          width: 100%; 
          border-collapse: separate;
          border-spacing: 0;
          font-size: 15px;
          margin: 16px 0;
          border-radius: 8px;
          overflow: hidden;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        thead tr { 
          background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
          color: white; 
        }
        
        th, td { 
          padding: 12px 16px; 
          border-bottom: 1px solid var(--border-light);
          vertical-align: middle;
        }
        
        th { 
          text-align: left; 
          font-weight: 700;
          font-size: 13px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        tbody tr:nth-child(even) {
          background: rgba(249, 250, 251, 0.5);
        }
        
        tbody tr:hover {
          background: rgba(30, 64, 175, 0.03);
        }
        
        td.amount, .text-right { 
          text-align: right; 
          font-weight: 700; 
          color: var(--primary-green);
          font-size: 15px;
        }

        tfoot tr {
          background: var(--bg-light);
          border-top: 2px solid var(--primary-blue);
        }

        tfoot td {
          font-weight: 900;
          font-size: 18px;
          color: var(--primary-blue);
          border-bottom: none;
        }

        /* Summary box improvements */
        .summary-box { 
          margin-top: 20px; 
          padding: 20px; 
          border-radius: 12px; 
          background: linear-gradient(135deg, rgba(30, 64, 175, 0.02) 0%, rgba(5, 150, 105, 0.02) 100%);
          border: 2px solid var(--border-light);
          border-left: 4px solid var(--primary-blue);
          page-break-inside: avoid; 
        }
        
        .summary-grid { 
          display: grid; 
          grid-template-columns: 1fr auto; 
          gap: 12px 20px; 
          align-items: center; 
        }
        
        .summary-grid .label { 
          color: var(--text-gray);
          font-weight: 500;
          font-size: 13px;
        }
        
        .summary-grid .value { 
          text-align: right; 
          font-weight: 900;
          font-size: 16px; /* bigger for clarity */
        }
        
        .summary-grid .value.secondary { 
          font-weight: 700; 
          color: var(--text-dark); 
        }
        
        .summary-grid .value.alert { 
          color: #dc2626;
        }

        /* Footer styling */
        .muted { 
          color: var(--text-gray); 
          text-align: center; 
          margin-top: 20px; 
          font-size: 11px;
          font-style: italic;
          padding-top: 12px;
          border-top: 1px solid var(--border-light);
        }

        /* Compact mode adjustments */
        .print-content.two-up .receipt-compact .entete img { 
          width: 45px; 
          height: 45px; 
        }
        
        .print-content.two-up .receipt-compact .entete .entete-text .school-name { 
          font-size: 16px; 
        }
        
        .print-content.two-up h4 { 
          font-size: 14px; 
          margin: 12px 0 16px; 
        }
        
        .print-content.two-up table { 
          font-size: 11px; 
          margin: 12px 0;
        }
        
        .print-content.two-up th, .print-content.two-up td { 
          padding: 8px 12px; 
        }
        
        .print-content.two-up .summary-box { 
          padding: 12px 16px; 
          margin-top: 12px;
        }

        .print-content.two-up .summary-grid {
          gap: 8px 16px;
        }

        .print-content.two-up .summary-grid .value {
          font-size: 13px;
        }

        /* Force compact mode */
        .force-compact .receipt-compact { 
          padding: 12px 16px; 
          border-radius: 6px; 
        }
        
        .force-compact .receipt-compact .entete img { 
          width: 35px; 
          height: 35px; 
        }
        
        .force-compact .receipt-compact .entete .entete-text .school-name { 
          font-size: 14px; 
        }
        
        .force-compact h4 { 
          font-size: 12px;
          margin: 8px 0 12px;
        }
        
        .force-compact table { 
          font-size: 10px;
          margin: 10px 0;
        }
        
        .force-compact th, .force-compact td { 
          padding: 6px 10px; 
        }
        
        .force-compact .summary-box { 
          padding: 10px 12px; 
          margin-top: 10px;
        }
        
        .force-compact .muted { 
          font-size: 9px;
          margin-top: 12px;
        }

        /* Print-specific adjustments */
        @media print {
          body { 
            -webkit-print-color-adjust: exact; 
            color-adjust: exact; 
            print-color-adjust: exact;
          }
          
          .receipt-compact { 
            box-shadow: none !important; 
            border: 2px solid var(--primary-blue) !important;
          }
          
          .receipt-wrapper { 
            padding: 0; 
          }

          /* Ensure gradients print properly */
          .receipt-compact::before,
          thead tr,
          h4::after {
            -webkit-print-color-adjust: exact;
            color-adjust: exact;
            print-color-adjust: exact;
          }
        }
      </style>
    `;let d="";if(r)try{const y=s.querySelectorAll(".receipt-compact");if(y&&y.length>0){const v=[];for(let b=0;b<y.length;b+=2){const N=y[b].outerHTML,E=y[b+1]?y[b+1].outerHTML:"";v.push(`<div class="print-content two-up">${N}${E}</div>`)}d=v.join("")}else d=`<div class="print-content two-up"><div class="receipt-compact">${c}</div><div class="receipt-compact">${c}</div></div>`}catch{d=`<div class="print-content two-up"><div class="receipt-compact">${c}</div><div class="receipt-compact">${c}</div></div>`}else d=`<div class="print-content">${c}</div>`;const x=`<!doctype html><html><head><meta charset="utf-8"/><title>${t}</title>${f}</head><body><div class="receipt-wrapper">${d}</div>${`
      <script>
        (function(){
          const TWO_UP = ${r?"true":"false"};
          function sleep(ms){return new Promise(r=>setTimeout(r,ms));}

          function mmToPx(mm){
            const div = document.createElement('div');
            div.style.position = 'absolute';
            div.style.left = '-9999px';
            div.style.height = mm + 'mm';
            document.body.appendChild(div);
            const px = div.getBoundingClientRect().height;
            document.body.removeChild(div);
            return px;
          }

          async function adjustAndPrint(){
            await sleep(200); // Allow more time for styles to load

            const pageHeightPx = mmToPx(297);
            const marginPx = mmToPx(8); // Updated margin
            const printablePx = pageHeightPx - marginPx * 2;

            const wrapper = document.querySelector('.receipt-wrapper');
            if (!wrapper){ 
              await sleep(200); 
              try{ window.print(); } catch(e){} 
              return; 
            }

            const cutGapPx = mmToPx(6); // Updated gap
            const receipts = Array.from(wrapper.querySelectorAll('.receipt-compact'));
            if (receipts.length === 0){ 
              await sleep(200); 
              try{ window.print(); } catch(e){} 
              return; 
            }

            const combinedHeight = receipts.reduce((acc, r) => acc + r.getBoundingClientRect().height, 0) + (receipts.length - 1) * cutGapPx;

            if (!TWO_UP){
              if (combinedHeight <= printablePx){ 
                await sleep(150); 
                try{ window.print(); } catch(e){} 
                return; 
              }
            } else {
              const perReceiptLimit = (printablePx - cutGapPx) / 2;
              const worst = Math.max(...receipts.map(r => r.getBoundingClientRect().height));
              if (worst <= perReceiptLimit){ 
                await sleep(150); 
                try{ window.print(); } catch(e){} 
                return; 
              }
            }

            let targetScale = 1;
            if (!TWO_UP){
              targetScale = Math.min(1, printablePx / combinedHeight);
            } else {
              const worst = Math.max(...receipts.map(r => r.getBoundingClientRect().height));
              const perReceiptLimit = (printablePx - cutGapPx) / 2;
              targetScale = Math.min(1, perReceiptLimit / worst);
            }

            const MIN_SCALE = 0.35; // Slightly higher minimum for better readability
            targetScale = Math.max(MIN_SCALE, targetScale);

            if (targetScale < 0.8){
              try{
                const outer = document.querySelector('.receipt-wrapper');
                if (outer && !outer.classList.contains('force-compact')){
                  outer.classList.add('force-compact');
                  await sleep(100);
                  
                  const receiptsAfterCompact = Array.from(outer.querySelectorAll('.receipt-compact'));
                  const worstAfter = Math.max(...receiptsAfterCompact.map(r => r.getBoundingClientRect().height));
                  const newPerLimit = (printablePx - cutGapPx) / 2;
                  
                  if (!TWO_UP){
                    const combinedAfter = receiptsAfterCompact.reduce((acc, r) => acc + r.getBoundingClientRect().height, 0) + (receiptsAfterCompact.length - 1) * cutGapPx;
                    targetScale = Math.min(1, printablePx / combinedAfter);
                  } else {
                    targetScale = Math.min(1, newPerLimit / worstAfter);
                  }
                  targetScale = Math.max(MIN_SCALE, targetScale);
                }
              } catch(e) { /* ignore */ }
            }

            // Smooth scaling with better progression
            document.body.style.transformOrigin = 'top left';
            const steps = 8;
            for (let i = 0; i < steps; i++){
              const progress = (i + 1) / steps;
              const easeProgress = 1 - Math.pow(1 - progress, 3); // Ease out cubic
              const s = 1 - ((1 - targetScale) * easeProgress);
              document.body.style.transform = 'scale(' + s + ')';
              await sleep(30);
            }

            // Final adjustments for two-up fallback
            const afterWorst = Math.max(...receipts.map(r => r.getBoundingClientRect().height * targetScale));
            if (TWO_UP){
              const perReceiptLimit = (printablePx - cutGapPx) / 2;
              if (afterWorst > perReceiptLimit + 2){
                try{
                  const newWrapper = document.createElement('div');
                  newWrapper.className = 'receipt-wrapper';
                  const content = document.createElement('div');
                  content.className = 'print-content';
                  
                  receipts.forEach((r, idx) => {
                    const c = document.createElement('div');
                    c.className = 'receipt-compact';
                    c.innerHTML = r.innerHTML;
                    content.appendChild(c);
                    if (idx < receipts.length - 1){
                      const br = document.createElement('div');
                      br.style.pageBreakAfter = 'always';
                      content.appendChild(br);
                    }
                  });
                  
                  newWrapper.appendChild(content);
                  document.body.innerHTML = '';
                  document.body.appendChild(newWrapper);
                  document.body.style.transform = '';
                } catch (e) { /* ignore */ }
              }
            }

            await sleep(200);
            try{ window.print(); } catch(e){}
          }

          adjustAndPrint();
        })();
      <\/script>
    `}</body></html>`,g=window.open("","_blank");if(!g)return;g.document.open(),g.document.write(x),g.document.close(),g.focus(),setTimeout(()=>{try{g.print()}catch{}},400)}catch{const i=document.getElementById(e);if(!i)return;const s=window.open("","_blank");if(!s)return;s.document.open(),s.document.write("<html><head><title>"+t+"</title></head><body>"+i.innerHTML+"</body></html>"),s.document.close(),s.print()}}function tq({onClasseSelect:e,onNewClasse:t}){const r=()=>sP("classes-print-area","Liste des classes",!1),{showToast:n}=Jr(),a=fe.getAll("classes"),[i,s]=j.useState(!1),[c,f]=j.useState(a),[d,h]=j.useState(""),[m,x]=j.useState(""),g=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"],y=fe.getAll("enseignants"),v=fe.getAll("eleves"),b=j.useMemo(()=>{let C=[...c];if(d){const k=d.toLowerCase();C=C.filter(P=>P.niveau.toLowerCase().includes(k)||P.section.toLowerCase().includes(k)||P.enseignantPrincipal.toLowerCase().includes(k)||P.salle.toLowerCase().includes(k))}m&&(C=C.filter(k=>k.niveau===m));const T=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];return C.sort((k,P)=>{const D=T.indexOf(k.niveau),R=T.indexOf(P.niveau);return D!==R?D-R:k.section.localeCompare(P.section)})},[a,d,m]),N=C=>{s(!0);const T=v.filter(k=>k.classeId===C.id);if(T.length>0){n(`Impossible de supprimer cette classe car elle contient ${T.length} lve(s).`,"error"),s(!1);return}window.confirm(`tes-vous sr de vouloir supprimer la classe ${C.niveau} ${C.section} ?`)&&(fe.delete("classes",C.id),f(c.filter(k=>k.id!==C.id)),n("Classe supprime avec succs","success")),s(!1)},E=C=>v.filter(T=>T.classeId===C&&T.statut==="Actif").length,S=C=>{const T=y.find(k=>Bt(k)===C||j0(k)===C||`${k.prenoms} ${k.nom}`===C);return T?Bt(T):C};return o.jsxs(Tc,{title:"Gestion des Classes",subtitle:`${b.length} classe(s) trouve(s)`,actions:o.jsxs(o.Fragment,{children:[o.jsx(Ft,{variant:"secondary",onClick:r,children:"Aperu & Impression"}),o.jsxs(Ft,{variant:"primary",onClick:t,children:[o.jsx(Wo,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvelle Classe"})]})]}),children:[i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsxs("svg",{className:"animate-spin h-10 w-10 text-teal-600 mb-4",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),o.jsx("span",{className:"text-white text-lg font-semibold",children:"Chargement..."})]})}),o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(wc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher une classe...",value:d,onChange:C=>h(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]}),o.jsxs("select",{value:m,onChange:C=>x(C.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Tous les niveaux"}),g.map(C=>o.jsx("option",{value:C,children:C},C))]})]})}),o.jsxs("div",{id:"print-area",className:"hidden print:block bg-white p-4 mb-4 print-compact",children:[o.jsx(Bf,{type:"eleves",libelle:"Liste des classes"}),o.jsx("div",{className:"mb-2 overflow-x-auto",children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px",tableLayout:"fixed"},children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"6%"}}),o.jsx("col",{style:{width:"18%"}}),o.jsx("col",{style:{width:"12%"}}),o.jsx("col",{style:{width:"14%"}}),o.jsx("col",{style:{width:"24%"}}),o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"16%"}})]}),o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"border px-2 py-1",children:"N"}),o.jsx("th",{className:"border px-2 py-1",children:"Niveau"}),o.jsx("th",{className:"border px-2 py-1",children:"Section"}),o.jsx("th",{className:"border px-2 py-1",children:"Anne scolaire"}),o.jsx("th",{className:"border px-2 py-1",children:"Enseignant principal"}),o.jsx("th",{className:"border px-2 py-1",children:"Effectif max"}),o.jsx("th",{className:"border px-2 py-1",children:"Effectif actuel"})]})})]})}),o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px",tableLayout:"fixed"},children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"6%"}}),o.jsx("col",{style:{width:"18%"}}),o.jsx("col",{style:{width:"12%"}}),o.jsx("col",{style:{width:"14%"}}),o.jsx("col",{style:{width:"24%"}}),o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"16%"}})]}),o.jsx("tbody",{children:b.map((C,T)=>o.jsxs("tr",{children:[o.jsx("td",{children:T+1}),o.jsx("td",{children:C.niveau}),o.jsx("td",{children:C.section}),o.jsx("td",{children:C.anneeScolaire}),o.jsx("td",{children:S(C.enseignantPrincipal)}),o.jsx("td",{children:C.effectifMax}),o.jsx("td",{children:E(C.id)})]},C.id))})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(C=>{const T=E(C.id),k=T/C.effectifMax*100;return o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:[C.niveau," ",C.section]}),o.jsx("p",{className:"text-sm text-gray-500",children:C.anneeScolaire})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(Ft,{variant:"ghost",className:"p-2",onClick:()=>e(C),title:"Modifier",children:o.jsx(zo,{className:"h-4 w-4"})}),o.jsx(Ft,{variant:"danger",className:"p-2",onClick:()=>N(C),title:"Supprimer",children:o.jsx($s,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(zs,{className:"h-4 w-4 text-gray-400"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Enseignant: ",S(C.enseignantPrincipal)]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(qi,{className:"h-4 w-4 text-gray-400"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Salle: ",C.salle]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-1",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Effectif"}),o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[T,"/",C.effectifMax]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded h-2",children:o.jsx("div",{className:`h-2 rounded ${k>=90?"bg-red-500":k>=75?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.min(k,100)}%`}})}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[k.toFixed(0),"% de remplissage"]})]}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[C.matieres.length," matire(s)"]}),o.jsxs("div",{className:"flex flex-wrap gap-1",children:[C.matieres.slice(0,3).map(P=>o.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:P.nom},P.id)),C.matieres.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs rounded",children:["+",C.matieres.length-3]})]})]})]})]},C.id)})}),b.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("p",{className:"text-gray-500",children:"Aucune classe trouve"}),o.jsx(Ft,{variant:"primary",onClick:t,className:"mt-4",children:"Crer une classe"})]})]})}function rq({classe:e,onSave:t,onCancel:r}){const[n,a]=j.useState({niveau:"CP1",section:"A",anneeScolaire:new Date().getFullYear()+"-"+(new Date().getFullYear()+1),enseignantPrincipal:"",effectifMax:35,salle:""}),{showToast:i}=Jr(),[s,c]=j.useState([]),[f,d]=j.useState({}),[h,m]=j.useState(!1),x=fe.getAll("matieres"),g=fe.getAll("enseignants");j.useEffect(()=>{e&&(a({niveau:e.niveau,section:e.section,anneeScolaire:e.anneeScolaire,enseignantPrincipal:e.enseignantPrincipal,effectifMax:e.effectifMax,salle:e.salle}),c(e.matieres))},[e]);const y=()=>{const S={};return n.niveau||(S.niveau="Le niveau est obligatoire"),n.section.trim()||(S.section="La section est obligatoire"),n.anneeScolaire.trim()||(S.anneeScolaire="L'anne scolaire est obligatoire"),n.enseignantPrincipal.trim()||(S.enseignantPrincipal="L'enseignant principal est obligatoire"),(n.effectifMax<1||n.effectifMax>50)&&(S.effectifMax="L'effectif maximum doit tre entre 1 et 50"),n.salle.trim()||(S.salle="La salle est obligatoire"),s.length===0&&(S.matieres="Au moins une matire doit tre slectionne"),fe.getAll("classes").find(k=>k.niveau===n.niveau&&k.section===n.section&&k.anneeScolaire===n.anneeScolaire&&k.id!==e?.id)&&(S.section="Cette classe existe dj pour cette anne scolaire"),d(S),Object.keys(S).length===0},v=async S=>{if(S.preventDefault(),!!y()){m(!0);try{const C=new Date().toISOString(),T={...n,matieres:s,updatedAt:C,...e?{}:{createdAt:C}};if(e){const k=fe.update("classes",e.id,T);k&&(i("Classe mise  jour avec succs","success"),t(k))}else{const k=fe.create("classes",T);i("Classe ajoute avec succs","success"),t(k)}}catch{i("Erreur lors de la sauvegarde de la classe","error")}finally{m(!1)}}},b=(S,C)=>{a(T=>({...T,[S]:C})),f[S]&&d(T=>({...T,[S]:""}))},N=S=>{c(C=>C.find(k=>k.id===S.id)?C.filter(k=>k.id!==S.id):[...C,S]),f.matieres&&d(C=>({...C,matieres:""}))},E=S=>x.filter(C=>C.type===S);return o.jsx("div",{className:"p-6 max-w-5xl mx-auto",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Modifier la classe":"Nouvelle classe"}),o.jsx("p",{className:"text-gray-600 mt-1",children:e?"Modifiez les informations de la classe":"Crez une nouvelle classe"})]}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",children:o.jsx(Qs,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de base"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Niveau ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:n.niveau,onChange:S=>b("niveau",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.niveau?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,children:[o.jsx("option",{value:"Petite Section",children:"Petite Section"}),o.jsx("option",{value:"Moyenne Section",children:"Moyenne Section"}),o.jsx("option",{value:"Grande Section",children:"Grande Section"}),o.jsx("option",{value:"CP1",children:"CP1"}),o.jsx("option",{value:"CP2",children:"CP2"}),o.jsx("option",{value:"CE1",children:"CE1"}),o.jsx("option",{value:"CE2",children:"CE2"}),o.jsx("option",{value:"CM1",children:"CM1"}),o.jsx("option",{value:"CM2",children:"CM2"})]}),f.niveau&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.niveau]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Section ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.section,onChange:S=>b("section",S.target.value.toUpperCase()),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.section?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"A, B, C...",maxLength:2}),f.section&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.section]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Anne scolaire ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.anneeScolaire,onChange:S=>b("anneeScolaire",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.anneeScolaire?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"2025-2026"}),f.anneeScolaire&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.anneeScolaire]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gestion et organisation"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Enseignant principal ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:n.enseignantPrincipal,onChange:S=>b("enseignantPrincipal",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.enseignantPrincipal?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,children:[o.jsx("option",{value:"",children:"Slectionner un enseignant"}),g.filter(S=>S.statut==="Actif").map(S=>o.jsx("option",{value:Bt(S),children:Bt(S)},S.id))]}),f.enseignantPrincipal&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.enseignantPrincipal]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Effectif maximum ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",value:n.effectifMax,onChange:S=>b("effectifMax",parseInt(S.target.value)),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.effectifMax?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,min:"1",max:"50"}),f.effectifMax&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.effectifMax]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Salle de classe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.salle,onChange:S=>b("salle",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.salle?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Ex: Salle 1, Salle A..."}),f.salle&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.salle]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Matires enseignes ",o.jsx("span",{className:"text-red-500",children:"*"})]}),f.matieres&&o.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:o.jsxs("p",{className:"text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-2",children:""}),f.matieres]})}),o.jsx("div",{className:"space-y-8",children:["Fondamentale","veil","Expression"].map(S=>o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:S}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E(S).map(C=>{const T=s.find(k=>k.id===C.id);return o.jsxs("label",{className:`flex items-center p-3 border rounded-md cursor-pointer transition-all ${T?"border-gray-900 bg-gray-50":"border-gray-300 hover:border-gray-400 bg-white"}`,children:[o.jsx("input",{type:"checkbox",checked:!!T,onChange:()=>N(C),className:"sr-only"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-gray-900",children:C.nom}),o.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Coefficient: ",C.coefficient,C.obligatoire&&o.jsx("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 text-gray-700 text-xs rounded",children:"Obligatoire"})]})]}),T&&o.jsx("div",{className:"w-6 h-6 bg-gray-900 rounded-full flex items-center justify-center ml-3",children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},C.id)})})]},S))}),o.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-md border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[s.length," matire(s) slectionne(s)"]}),o.jsxs("p",{className:"text-gray-700 mt-1",children:["Coefficient total: ",s.reduce((S,C)=>S+C.coefficient,0)]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.length}),o.jsx("p",{className:"text-gray-600 text-sm",children:"matires"})]})]})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors font-medium",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 focus:ring-2 focus:ring-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:h,children:[h?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Js,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:e?h?"Sauvegarde...":"Mettre  jour la classe":h?"Sauvegarde...":"Crer la classe"})]})]})]})]})})}function nq({onMatiereSelect:e,onNewMatiere:t}){const{showToast:r}=Jr(),[n,a]=j.useState(!1),[i,s]=j.useState(""),[c,f]=j.useState(""),d=fe.getAll("matieres"),h=fe.getAll("classes"),[m,x]=j.useState(d),g=j.useMemo(()=>{let N=[...m];if(i){const E=i.toLowerCase();N=N.filter(S=>S.nom.toLowerCase().includes(E)||S.type.toLowerCase().includes(E))}return c&&(N=N.filter(E=>E.type===c)),N.sort((E,S)=>E.nom.localeCompare(S.nom))},[m,i,c]),y=N=>{a(!0);const E=h.filter(S=>S.matieres.some(C=>C.id===N.id));if(E.length>0){r(`Impossible de supprimer cette matire car elle est utilise dans ${E.length} classe(s).`,"error"),a(!1);return}window.confirm(`tes-vous sr de vouloir supprimer la matire "${N.nom}" ?`)&&(fe.delete("matieres",N.id),x(m.filter(S=>S.id!==N.id)),r("Matire supprime avec succs","success")),a(!1)},v=N=>{switch(N){case"Fondamentale":return"bg-blue-100 text-blue-800";case"veil":return"bg-green-100 text-green-800";case"Expression":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},b=N=>h.filter(E=>E.matieres.some(S=>S.id===N));return o.jsxs(Tc,{title:"Gestion des Matires",subtitle:`${g.length} matire(s) trouve(s)`,actions:o.jsx(o.Fragment,{children:o.jsxs(Ft,{variant:"primary",onClick:t,children:[o.jsx(Wo,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvelle Matire"})]})}),children:[n&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsxs("svg",{className:"animate-spin h-10 w-10 text-teal-600 mb-4",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),o.jsx("span",{className:"text-white text-lg font-semibold",children:"Chargement..."})]})}),o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(wc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher une matire...",value:i,onChange:N=>s(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]}),o.jsxs("select",{value:c,onChange:N=>f(N.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Tous les types"}),o.jsx("option",{value:"Fondamentale",children:"Fondamentale"}),o.jsx("option",{value:"veil",children:"veil"}),o.jsx("option",{value:"Expression",children:"Expression"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(N=>{const E=b(N.id);return o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(qi,{className:"h-4 w-4 text-gray-600"}),o.jsx("h3",{className:"text-base font-semibold text-gray-900",children:N.nom})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(Ft,{variant:"ghost",className:"p-2",onClick:()=>e(N),title:"Modifier",children:o.jsx(zo,{className:"h-4 w-4"})}),o.jsx(Ft,{variant:"danger",className:"p-2",onClick:()=>y(N),title:"Supprimer",children:o.jsx($s,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${v(N.type)}`,children:N.type}),N.obligatoire&&o.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Obligatoire"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Coefficient:"}),o.jsx("span",{className:"text-lg font-bold text-gray-900",children:N.coefficient})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Abrviation:"}),o.jsx("span",{className:"text-sm font-bold text-gray-900 bg-gray-100 px-2 py-1 rounded",children:N.abreviation})]}),o.jsxs("div",{children:[o.jsxs("span",{className:"text-sm text-gray-600",children:["Utilise dans ",E.length," classe(s)"]}),E.length>0&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[E.slice(0,3).map(S=>o.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded",children:[S.niveau," ",S.section]},S.id)),E.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs rounded",children:["+",E.length-3]})]})]}),o.jsx("div",{className:"pt-2 border-t border-gray-100",children:o.jsxs("p",{className:"text-xs text-gray-500",children:["Cre le ",new Date(N.createdAt).toLocaleDateString("fr-FR")]})})]})]},N.id)})}),g.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(qi,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucune matire trouve"}),o.jsx(Ft,{variant:"primary",onClick:t,className:"mt-4",children:"Crer votre premire matire"})]})]})}function aq({matiere:e,onSave:t,onCancel:r}){const{showToast:n}=Jr(),[a,i]=j.useState({nom:"",abreviation:"",coefficient:1,type:"Fondamentale",obligatoire:!0,classeIds:[],baremeParNiveau:{}}),[s,c]=j.useState({}),[f,d]=j.useState(!1),[h,m]=j.useState("CP1"),x=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];j.useEffect(()=>{if(e){const k={nom:e.nom,abreviation:e.abreviation,coefficient:e.coefficient,type:e.type,obligatoire:e.obligatoire,classeIds:e.classeIds||[],baremeParNiveau:e.baremeParNiveau||{}};i(k),g.current=k}},[e]);const g=j.useRef({}),y=j.useMemo(()=>{try{return JSON.stringify(g.current||{})!==JSON.stringify(a||{})}catch{return!1}},[a]),v=gm(y),b=`matiere:${e?.id||"new"}`,{load:N,clear:E}=vm(b,a);j.useEffect(()=>{try{const k=N();k&&(i(P=>({...P,...k})),g.current=JSON.parse(JSON.stringify(k||{})))}catch{}},[]);const S=()=>{const k={};a.nom.trim()||(k.nom="Le nom de la matire est obligatoire"),a.abreviation.trim()||(k.abreviation="L'abrviation est obligatoire"),(a.coefficient<1||a.coefficient>10)&&(k.coefficient="Le coefficient doit tre entre 1 et 10");const P=fe.getAll("matieres");return P.find(q=>{const M=(q.nom||"").toString().toLowerCase(),z=(a.nom||"").toString().toLowerCase();return M===z&&q.id!==e?.id})&&(k.nom="Une matire avec ce nom existe dj"),P.find(q=>{const M=(q.abreviation||"").toString().toLowerCase(),z=(a.abreviation||"").toString().toLowerCase();return M===z&&q.id!==e?.id})&&(k.abreviation="Une matire avec cette abrviation existe dj"),c(k),Object.keys(k).length===0},C=async k=>{if(k.preventDefault(),!!S()){d(!0);try{if(e){const P=fe.update("matieres",e.id,a);if(P){n("Matire mise  jour avec succs","success"),t(P);try{E()}catch{}g.current=JSON.parse(JSON.stringify(a||{}))}}else{const P=new Date().toISOString(),D={...a,updatedAt:P},R=fe.create("matieres",D);n("Matire ajoute avec succs","success"),t(R);try{E()}catch{}g.current=JSON.parse(JSON.stringify(a||{}))}}catch{n("Erreur lors de la sauvegarde de la matire","error")}finally{d(!1)}}},T=(k,P)=>{i(D=>({...D,[k]:P})),s[k]&&c(D=>({...D,[k]:""}))};return o.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Modifier la matire":"Nouvelle matire"}),o.jsx("p",{className:"text-gray-600 mt-1",children:e?"Modifiez les informations de la matire":"Crez une nouvelle matire"})]}),o.jsx("button",{onClick:()=>y&&v?v.openPrompt():r(),className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",children:o.jsx(Qs,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:C,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de base"}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom de la matire ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:k=>T("nom",k.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.nom?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Ex: Mathmatiques, Franais, Sciences..."}),s.nom&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.nom]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Abrviation ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.abreviation,onChange:k=>T("abreviation",k.target.value.toUpperCase()),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.abreviation?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Ex: MATH, FR, AEM...",maxLength:10}),s.abreviation&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.abreviation]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Abrviation utilise dans les tableaux de notes (max 10 caractres)"})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configuration avance"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Type de matire ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("div",{className:"space-y-3",children:[{value:"Fondamentale",label:"Fondamentale",desc:"Matires principales (Franais, Maths...)"},{value:"veil",label:"veil",desc:"Matires d'veil (Sciences, Histoire...)"},{value:"Expression",label:"Expression",desc:"Matires d'expression (Arts, Sport...)"}].map(k=>o.jsxs("label",{className:`flex items-center p-4 border rounded-md cursor-pointer transition-all ${a.type===k.value?"border-gray-900 bg-gray-50":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"type",value:k.value,checked:a.type===k.value,onChange:P=>T("type",P.target.value),className:"sr-only"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-gray-900",children:k.label}),o.jsx("div",{className:"text-sm text-gray-600 mt-1",children:k.desc})]}),a.type===k.value&&o.jsx("div",{className:"w-6 h-6 bg-gray-900 rounded-full flex items-center justify-center ml-3",children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},k.value))})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Coefficient ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"number",value:a.coefficient,onChange:k=>T("coefficient",parseInt(k.target.value)),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.coefficient?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,min:"1",max:"100"}),s.coefficient&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.coefficient]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Poids de la matire dans le calcul de la moyenne (1-100)"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:a.obligatoire,onChange:k=>T("obligatoire",k.target.checked),className:"w-4 h-4 text-gray-900 border border-gray-300 rounded focus:ring-gray-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Matire obligatoire"})]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500 ml-8",children:"Les matires obligatoires doivent tre enseignes dans toutes les classes du niveau correspondant"})]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configuration des barmes par niveau"}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:x.map(k=>o.jsx("button",{type:"button",onClick:()=>m(k),className:`px-3 py-2 rounded-md text-sm font-medium transition-all ${h===k?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:k},k))}),o.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[o.jsxs("h4",{className:"font-semibold text-gray-900 mb-4",children:["Barme pour ",h]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Note minimale"}),o.jsx("input",{type:"number",min:"0",value:a.baremeParNiveau[h]?.min||0,onChange:k=>{const P={...a.baremeParNiveau,[h]:{...a.baremeParNiveau[h],min:Number(k.target.value)}};T("baremeParNiveau",P)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Note maximale"}),o.jsx("input",{type:"number",min:"1",value:a.baremeParNiveau[h]?.max||20,onChange:k=>{const P={...a.baremeParNiveau,[h]:{...a.baremeParNiveau[h],max:Number(k.target.value)}};T("baremeParNiveau",P)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors"})]})]}),o.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-md",children:[o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsxs("strong",{children:["Exemple pour ",h,":"]}),h==="CE2"?" Mathmatiques /50, Orthographe /20":" Notes gnralement /20"]}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Les notes seront automatiquement converties pour le calcul des moyennes"})]})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Aperu des barmes configurs"}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:x.map(k=>{const P=a.baremeParNiveau[k];return o.jsxs("div",{className:"bg-white rounded-md p-3 border border-gray-200",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:k}),o.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["/",P?.max||20]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["Min: ",P?.min||0]})]},k)})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:()=>y&&v?v.openPrompt():r(),className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors font-medium",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 focus:ring-2 focus:ring-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:[f?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Js,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:e?f?"Sauvegarde...":"Mettre  jour la matire":f?"Sauvegarde...":"Crer la matire"})]})]})]})]}),v&&o.jsx(bf,{open:v.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardes. Voulez-vous quitter sans enregistrer ?",onConfirm:()=>{try{E()}catch{}v.allowNavigation?v.allowNavigation():r()},onCancel:()=>v.closePrompt&&v.closePrompt()})]})}function iq(){const{showToast:e}=Jr(),[t,r]=j.useState(""),[n,a]=j.useState(""),[i,s]=j.useState({}),[c,f]=j.useState(!1),[d,h]=j.useState(20),m=j.useMemo(()=>fe.getAll("classes"),[]),x=j.useMemo(()=>fe.getAll("compositions"),[]),g=j.useMemo(()=>fe.getAll("notes"),[]),y=m.find(V=>V.id===t),v=j.useMemo(()=>fe.getAll("eleves").filter(V=>V.classeId===t&&V.statut==="Actif").sort((V,ne)=>V.nom.localeCompare(ne.nom)),[t]),b=j.useMemo(()=>y?x.filter(V=>!V.niveau||V.niveau===y.niveau).sort((V,ne)=>V.ordre-ne.ordre):x,[y,x]),N=j.useMemo(()=>fe.getAll("matieres"),[]),E=j.useRef({}),S=j.useMemo(()=>y?(y.matieres||[]).map(L=>{if(typeof L=="string")return N.find(je=>je.id===L)||{id:L,nom:L,abreviation:L,coefficient:1,type:"Fondamentale",baremeParNiveau:{}};if(L&&typeof L=="object"&&L.abreviation)return L;const U=L&&L.id||null,H=L&&L.nom||null;let oe=null;if(U&&(oe=N.find(Ae=>Ae.id===U)||null),!oe&&H&&(oe=N.find(Ae=>Ae.nom===H)||null),oe)return oe;const F=L&&L.abreviation||(H?String(H).slice(0,3).toUpperCase():"");return{id:U||L&&L.id||Math.random().toString(36).slice(2,9),nom:H||L&&L.nom||"Matire",abreviation:F,coefficient:L&&L.coefficient||1,type:L&&L.type||"Fondamentale",baremeParNiveau:L&&L.baremeParNiveau||{}}}).sort((L,U)=>L.nom.localeCompare(U.nom)):[],[y,N]);j.useEffect(()=>{if(!n||!t)return;const V={};v.forEach(ne=>{V[ne.id]={},S.forEach(L=>{const U=g.find(H=>H.eleveId===ne.id&&H.matiereId===L.id&&H.compositionId===n&&H.classeId===t);U&&(V[ne.id][L.id]=U.valeur)})}),s(ne=>{try{const L=JSON.stringify(ne||{}),U=JSON.stringify(V||{});if(L===U)return ne}catch{}return V});try{E.current=JSON.parse(JSON.stringify(V||{}))}catch{E.current=V||{}}},[n,t,v,S,g]);const C=j.useMemo(()=>{try{return JSON.stringify(E.current||{})!==JSON.stringify(i||{})}catch{return!1}},[i]),T=gm(C),k=`notes:${t}:${n}`,{load:P,clear:D}=vm(k,i);j.useEffect(()=>{if(!(!t||!n))try{const V=P();V&&s(ne=>({...ne,...V}))}catch{}},[t,n]),j.useEffect(()=>{},[i]),j.useEffect(()=>{const V=()=>{!t&&m.length>0&&r(m[0].id),!n&&b.length>0&&a(b[0].id)};return window.addEventListener("open-notes-entry",V),()=>window.removeEventListener("open-notes-entry",V)},[t,n,m,b]);const R=(V,ne,L)=>{const U=S.find(F=>F.id===ne),H=U&&y?q(U,y.niveau):20;let oe=Number.isFinite(Number(L))?Number(L):0;oe<0&&(oe=0),oe>H&&(oe=H),s(F=>({...F,[V]:{...F[V],[ne]:oe}}))},q=(V,ne)=>V.baremeParNiveau?.[ne]?.max||20,M=V=>i[V]?S.reduce((ne,L)=>{const U=i[V][L.id]||0;return ne+U},0):0,z=V=>{if(!i[V]||!y)return 0;let ne=0,L=0;return S.forEach(U=>{const H=i[V][U.id]||0,oe=q(U,y.niveau),F=d===20?H/oe*20:H/oe*10;ne+=F*U.coefficient,L+=d*U.coefficient}),L>0?ne/L*d:0},ie=()=>{const V=v.map(F=>({eleveId:F.id,moyenne:z(F.id)})),ne={};V.forEach(F=>{ne[F.eleveId]=F.moyenne});const L=V.filter(F=>F.moyenne>0);L.sort((F,Ae)=>Ae.moyenne-F.moyenne);const U={};let H=Number.NaN,oe=0;for(let F=0;F<L.length;F++){const Ae=L[F];if(!Number.isNaN(H)&&Math.abs(Ae.moyenne-H)<1e-9)U[Ae.eleveId]=oe;else{const je=F+1;U[Ae.eleveId]=je,oe=je,H=Ae.moyenne}}return{moyennesMap:ne,ranksMap:U,sortedByRank:L}},{moyennesMap:ce,ranksMap:ae,sortedByRank:me}=j.useMemo(()=>ie(),[v,S,i,d,n,t]),[de,he]=j.useState("nom"),J=j.useMemo(()=>{if(de==="nom")return[...v].sort((U,H)=>U.nom.localeCompare(H.nom));const V=me.map(U=>U.eleveId),ne=V.map(U=>v.find(H=>H.id===U)).filter(Boolean),L=v.filter(U=>!V.includes(U.id)).sort((U,H)=>U.nom.localeCompare(H.nom));return[...ne,...L]},[de,v,me]),xe=async()=>{if(!n||!t){e("Slectionnez une classe et une composition","error");return}f(!0);try{Object.entries(i).forEach(([V,ne])=>{Object.entries(ne).forEach(([L,U])=>{if(U>=0){const H=S.find(Le=>Le.id===L);if(!H||!y)return;let oe=q(H,y.niveau),F=Number(U)||0;F<0&&(F=0),F>oe&&(F=oe);const Ae=g.find(Le=>Le.eleveId===V&&Le.matiereId===L&&Le.compositionId===n&&Le.classeId===t),je={eleveId:V,matiereId:L,compositionId:n,classeId:t,valeur:F,bareme:oe,date:new Date().toISOString()};Ae?fe.update("notes",Ae.id,je):fe.create("notes",je)}})}),Object.keys(ce).forEach(V=>{const ne=ce[V],L=ae[V]||0;if(ne>0){const U=fe.getAll("moyennesGenerales").find(oe=>oe.eleveId===V&&oe.compositionId===n&&oe.classeId===t),H={eleveId:V,classeId:t,compositionId:n,moyenne:ne,rang:L,dateCalcul:new Date().toISOString()};U?fe.update("moyennesGenerales",U.id,H):fe.create("moyennesGenerales",H)}}),e("Notes enregistres avec succs","success");try{E.current=JSON.parse(JSON.stringify(i||{}))}catch{E.current=i||{}}try{D()}catch{}}catch(V){console.error(V),e("Erreur lors de l'enregistrement des notes","error")}finally{f(!1)}},te=()=>{try{D()}catch{}T&&T.allowNavigation&&T.allowNavigation()},O=()=>{T&&T.closePrompt&&T.closePrompt()},K=()=>y?S.reduce((V,ne)=>V+q(ne,y.niveau),0):0,W=()=>{if(!y)return 1;const V=K();return d===20?V/20:V/10},X=()=>{if(!y||!n||J.length===0){e("Aucune donne  imprimer","error");return}const V=J.map((oe,F)=>{const Ae=M(oe.id),je=ce[oe.id]||0,Le=ae[oe.id]||0,Ue=S.map(Pe=>`<td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #f9f9f9;">${i[oe.id]?.[Pe.id]||""}</td>`).join(`
`);return`
        <tr>
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #f9f9f9;">${F+1}</td>
          <td style="border: 1px solid #333; padding: 8px; text-align: left; background-color: #f9f9f9;">${Bt(oe)}</td>
          ${Ue}
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #e6ffe6; font-weight: bold;">${Ae.toFixed(1)}</td>
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #ffe6e6; font-weight: bold;">${je.toFixed(2)}</td>
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #f9f9f9; font-weight: bold;">${Le>0?Le:""}</td>
        </tr>
      `}).join(`
`),ne=S.map(oe=>`<th style="border: 2px solid #333; padding: 10px; text-align: center; background-color: #4a5568; color: white; font-weight: bold; font-size: 13px;">${oe.abreviation}</th>`).join(`
`),L=x.find(oe=>oe.id===n)?.nom||"Composition",U=`
      <html>
        <head>
          <title>Rsultats de Composition - ${y.niveau} ${y.section}</title>
          <style>
            body {
              font-family: 'Times New Roman', Times, serif;
              font-size: 12px;
              color: #000;
              padding: 15mm;
              line-height: 1.4;
            }
            h2 {
              text-align: center;
              margin-bottom: 20px;
              font-size: 18px;
              font-weight: bold;
            }
            .header-info {
              text-align: center;
              margin-bottom: 30px;
              font-size: 14px;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              margin-bottom: 20px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            th {
              border: 2px solid #333;
              padding: 10px;
              text-align: center;
              background-color: #4a5568;
              color: white;
              font-weight: bold;
              font-size: 13px;
            }
            td {
              border: 1px solid #333;
              padding: 8px;
            }
            .signature {
              text-align: right;
              margin-top: 50px;
              font-weight: bold;
              font-size: 14px;
            }
            @media print {
              body { margin: 0; }
              .signature { page-break-inside: avoid; }
            }
          </style>
        </head>
        <body>
          <h2>Rsultats de Composition</h2>
          <div class="header-info">
            <strong>Classe:</strong> ${y.niveau} ${y.section}<br>
            <strong>Composition:</strong> ${L}<br>
            <strong>Base de moyenne:</strong> /${d}
          </div>
          <table>
            <thead>
              <tr>
                <th>N</th>
                <th>Noms et Prnoms</th>
                ${ne}
                <th>Total</th>
                <th>Moyenne</th>
                <th>Rang</th>
              </tr>
            </thead>
            <tbody>
              ${V}
            </tbody>
          </table>
          <div class="signature">Signature</div>
        </body>
      </html>
    `,H=window.open("","_blank","width=800,height=600");if(!H){e("Impossible d'ouvrir la fentre d'impression","error");return}H.document.open(),H.document.write(U),H.document.close(),H.focus(),setTimeout(()=>{H.print(),H.onafterprint=()=>H.close()},500)};return o.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-white border border-gray-200 p-6 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Notes par Classe"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Saisie et calcul des moyennes selon le systme ivoirien"})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Base de calcul"}),o.jsxs("div",{className:"flex space-x-2 mt-2",children:[o.jsx("button",{onClick:()=>h(10),className:`px-3 py-2 rounded-md font-medium transition-all ${d===10?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"/10"}),o.jsx("button",{onClick:()=>h(20),className:`px-3 py-2 rounded-md font-medium transition-all ${d===20?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"/20"})]})]})]})}),o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Trier par :"}),o.jsx("button",{onClick:()=>he("nom"),className:`px-3 py-1 rounded ${de==="nom"?"bg-gray-900 text-white":"bg-gray-100"}`,children:"Nom"}),o.jsx("button",{onClick:()=>he("rang"),className:`px-3 py-1 rounded ${de==="rang"?"bg-gray-900 text-white":"bg-gray-100"}`,children:"Rang"})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Slection des paramtres"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Classe"}),o.jsxs("select",{value:t,onChange:V=>{r(V.target.value),a(""),s({})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),m.map(V=>{const ne=fe.getAll("eleves").filter(L=>L.classeId===V.id&&L.statut==="Actif").length;return o.jsxs("option",{value:V.id,children:[V.niveau," ",V.section," (",ne," lves)"]},V.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Composition"}),o.jsxs("select",{value:n,onChange:V=>{a(V.target.value),s({})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",disabled:!t,children:[o.jsx("option",{value:"",children:"Slectionner une composition"}),b.map(V=>o.jsxs("option",{value:V.id,children:[V.nom," (coeff. ",V.coefficient,")"]},V.id))]})]}),o.jsx("div",{className:"flex items-end",children:o.jsxs("button",{onClick:xe,disabled:c||!n||!t,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition-colors disabled:opacity-50",children:[c?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(Js,{className:"h-4 w-4"}),o.jsx("span",{children:c?"Sauvegarde...":"Enregistrer"})]})})]})]}),t&&n&&S.length>0&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Saisie des notes - ",y?.niveau," ",y?.section]}),o.jsxs("p",{className:"text-gray-600 text-sm",children:[x.find(V=>V.id===n)?.nom,"  Total /",K(),"  Moyenne /",d]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Notes compltes"}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[Object.keys(i).filter(V=>{const ne=i[V]||{};return S.every(L=>ne[L.id]!==void 0)}).length,"/",v.length]})]}),o.jsxs("button",{onClick:X,className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm shadow hover:bg-indigo-700 flex items-center space-x-2",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"inline-block",children:[o.jsx("path",{d:"M6 9V2h12v7",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("rect",{x:"6",y:"13",width:"12",height:"9",rx:"1",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("span",{children:"Imprimer"})]})]})]})}),o.jsx("div",{className:"p-6 overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-semibold text-gray-900 min-w-[60px]",children:"N"}),o.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-semibold text-gray-900 min-w-[200px]",children:"Noms et Prnoms"}),S.map(V=>o.jsx("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[80px]",children:o.jsx("div",{children:V.abreviation})},V.id)),o.jsxs("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[80px]",children:[o.jsx("div",{children:"Total"}),o.jsxs("div",{className:"text-xs text-gray-500 font-normal",children:["/",K()]})]}),o.jsxs("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[80px]",children:[o.jsx("div",{children:"Moy"}),o.jsxs("div",{className:"text-xs text-gray-500 font-normal",children:["/",d]})]}),o.jsx("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[60px]",children:"Rang"})]})}),o.jsx("tbody",{children:J.map((V,ne)=>{const L=M(V.id),U=ce[V.id]||0,H=ae[V.id]||0;return o.jsxs("tr",{className:ne%2===0?"bg-white":"bg-gray-50",children:[o.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm font-medium text-gray-900",children:ne+1}),o.jsx("td",{className:"border border-gray-300 px-3 py-2",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[V.photo&&o.jsx("img",{src:V.photo,alt:`${V.prenoms} ${V.nom}`,className:"h-6 w-6 rounded-full object-cover"}),o.jsx("div",{className:"text-sm font-medium text-gray-900",children:Bt(V)})]})}),S.map(oe=>{const F=q(oe,y?.niveau||""),Ae=i[V.id]?.[oe.id]||"";return o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:o.jsx("input",{type:"number",min:"0",max:F,step:"0.5",value:Ae,onChange:je=>R(V.id,oe.id,Number(je.target.value)),className:"w-full px-2 py-1 border border-gray-300 rounded text-center font-bold focus:ring-2 focus:ring-gray-500 focus:border-gray-500",placeholder:"0"})},oe.id)}),o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:o.jsx("div",{className:"font-bold text-blue-600",children:L.toFixed(1)})}),o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:o.jsx("div",{className:`font-bold ${U>=d*.5?"text-green-600":"text-red-600"}`,children:U.toFixed(2)})}),o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:H>0&&o.jsxs("div",{className:`font-bold ${H===1?"text-yellow-600":H<=3?"text-green-600":"text-gray-600"}`,children:[H,H===1&&o.jsx(j5,{className:"inline h-3 w-3 ml-1"})]})})]},V.id)})})]})}),v.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(zs,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucun lve dans cette classe"})]})]}),t&&y&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations sur le calcul des moyennes"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx(k5,{className:"h-6 w-6 text-gray-600 mx-auto mb-2"}),o.jsx("div",{className:"text-xl font-bold text-gray-900",children:K()}),o.jsx("p",{className:"text-gray-700 font-medium",children:"Total maximum"}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Somme des barmes de toutes les matires"})]})}),o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx(p5,{className:"h-6 w-6 text-gray-600 mx-auto mb-2"}),o.jsx("div",{className:"text-xl font-bold text-gray-900",children:W().toFixed(1)}),o.jsx("p",{className:"text-gray-700 font-medium",children:"Diviseur"}),o.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Pour obtenir la moyenne /",d]})]})}),o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx(qi,{className:"h-6 w-6 text-gray-600 mx-auto mb-2"}),o.jsx("div",{className:"text-xl font-bold text-gray-900",children:S.length}),o.jsx("p",{className:"text-gray-700 font-medium",children:"Matires"}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Configures pour cette classe"})]})})]}),o.jsxs("div",{className:"mt-6 bg-gray-50 rounded-md p-4",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Dtail des matires"}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:S.map(V=>{const ne=q(V,y.niveau),L=d===20?ne/20:ne/10;return o.jsxs("div",{className:"bg-white rounded-md p-3 border border-gray-200",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:V.abreviation}),o.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["/",ne]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["Diviseur: ",L.toFixed(1)]})]},V.id)})})]})]}),t&&n&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statistiques de la classe"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-gray-900",children:v.length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"lves"})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-green-600",children:v.filter(V=>z(V.id)>=d*.5).length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Admis"}),o.jsxs("p",{className:"text-xs text-gray-500",children:[" ",d/2,"/",d]})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-red-600",children:v.filter(V=>{const ne=z(V.id);return ne>0&&ne<d*.5}).length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"chec"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["< ",d/2,"/",d]})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-gray-900",children:(()=>{const V=v.map(ne=>z(ne.id)).filter(ne=>ne>0);return V.length>0?(V.reduce((ne,L)=>ne+L,0)/V.length).toFixed(2):"0"})()}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Moy. Classe"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["/",d]})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-gray-900",children:Object.keys(i).reduce((V,ne)=>{const L=i[ne]||{},U=Object.values(L).filter(H=>H!=null).length;return V+U},0)}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Notes saisies"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["/ ",v.length*S.length]})]})]})]}),T&&o.jsx(bf,{open:T.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardes. Voulez-vous quitter sans enregistrer ?",onConfirm:te,onCancel:O})]})}function sq(e){const t=e.split("-"),r=parseInt(t[0],10);return isNaN(r)?new Date().getFullYear():r}function oq(e,t){const r=sq(t),n=r+1,a=[`${r}-09-01`,`${r}-10-05`,`${r}-11-05`,`${r}-12-05`,`${n}-01-05`,`${n}-02-05`,`${n}-03-05`];let i=35e3,s=15e3,c=15e3;["Petite Section","Moyenne Section","Grande Section"].includes(e)&&(i=35e3,s=15e3,c=1e4),["CP1","CP2","CE1","CE2"].includes(e)&&(i=35e3,s=15e3,c=15e3),e==="CM1"&&(i=35e3,s=2e4,c=15e3),e==="CM2"&&(i=45e3,s=2e4,c=15e3);const f=[{modalite:1,label:"Inscription",date:a[0],montant:i,id:`${e}-1`},{modalite:2,label:"Versement 1",date:a[1],montant:s,id:`${e}-2`},{modalite:3,label:"Versement 2",date:a[2],montant:c,id:`${e}-3`},{modalite:4,label:"Versement 3",date:a[3],montant:1e4,id:`${e}-4`},{modalite:5,label:"Versement 4",date:a[4],montant:1e4,id:`${e}-5`},{modalite:6,label:"Versement 5",date:a[5],montant:1e4,id:`${e}-6`},{modalite:7,label:"Versement 6",date:a[6],montant:1e4,id:`${e}-7`}],d=f.reduce((h,m)=>h+m.montant,0);return{niveau:e,anneeScolaire:t,montant:d,fraisInscription:0,echeances:f.map(h=>({date:h.date,montant:h.montant,modalite:h.modalite,label:h.label,id:h.id}))}}const lq=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];function cq(e){(fe.getAll("fraisScolaires")||[]).forEach(n=>{if(n&&n.annee&&!n.anneeScolaire)try{fe.update("fraisScolaires",n.id,{...n,anneeScolaire:n.annee,updatedAt:new Date().toISOString()})}catch{}});let r=0;return lq.forEach(n=>{if(!(fe.getAll("fraisScolaires")||[]).find(i=>i.niveau===n&&i.anneeScolaire===e)){const i=oq(n,e);fe.create("fraisScolaires",i),r++}}),r}function oP(){const e="2025-2026",t=cq(e);return t>0&&console.log(`Frais scolaires initialiss: ${t} niveaux crs pour ${e}`),t}const Kk=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];function uq(){const{showToast:e}=Jr(),[t,r]=j.useState([]),[n,a]=j.useState(null),[i,s]=j.useState(!1),[c,f]=j.useState({niveau:"CP1",anneeScolaire:"2025-2026",echeances:[{date:"2025-09-01",montant:35e3,modalite:1,label:"Inscription"}]});j.useEffect(()=>{d(),fe.getAll("fraisScolaires").length===0&&(oP(),d())},[]);const d=()=>{const E=fe.getAll("fraisScolaires");r(E)},h=()=>{f({niveau:"CP1",anneeScolaire:"2025-2026",echeances:[{date:"2025-09-01",montant:35e3,modalite:1,label:"Inscription"}]}),a(null),s(!1)},m=E=>{f({niveau:E.niveau,anneeScolaire:E.anneeScolaire,echeances:(E.echeances||[]).map(S=>({date:S.date,montant:S.montant,modalite:S.modalite||1,label:S.label||""}))}),a(E.id),s(!0)},x=E=>{window.confirm(`Supprimer les frais pour ${E.niveau} (${E.anneeScolaire}) ?`)&&(fe.delete("fraisScolaires",E.id),d(),e("Frais supprims","success"))},g=()=>{const E=c.echeances.reduce((C,T)=>C+T.montant,0),S={niveau:c.niveau,anneeScolaire:c.anneeScolaire,fraisInscription:0,montant:E,echeances:c.echeances.map((C,T)=>({id:`${c.niveau}-${c.anneeScolaire}-${T+1}`,date:C.date,montant:C.montant,modalite:C.modalite,label:C.label}))};if(n)fe.update("fraisScolaires",n,S),e("Frais mis  jour","success");else{if(t.find(T=>T.niveau===c.niveau&&T.anneeScolaire===c.anneeScolaire)){e("Des frais existent dj pour ce niveau et cette anne","error");return}fe.create("fraisScolaires",S),e("Frais ajouts","success")}d(),h()},y=()=>{f(E=>({...E,echeances:[...E.echeances,{date:"",montant:1e4,modalite:E.echeances.length+1,label:`Versement ${E.echeances.length}`}]}))},v=(E,S,C)=>{f(T=>({...T,echeances:T.echeances.map((k,P)=>P===E?{...k,[S]:S==="montant"||S==="modalite"?Number(C):C}:k)}))},b=E=>{f(S=>({...S,echeances:S.echeances.filter((C,T)=>T!==E)}))},N=E=>(E.echeances||[]).reduce((S,C)=>S+(C.montant||0),0);return o.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 text-white p-8 rounded-2xl shadow-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:o.jsx(Bs,{className:"h-8 w-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Configuration des Frais Scolaires"}),o.jsx("p",{className:"text-green-100 mt-2",children:"Gestion des modalits de paiement par niveau"})]})]}),o.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-2 px-6 py-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-xl transition-all",children:[o.jsx(Wo,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:"Nouveau Frais"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 gap-6",children:Kk.map(E=>{const S=t.filter(C=>C.niveau===E);return o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:E}),o.jsxs("p",{className:"text-gray-600 text-sm",children:[S.length," configuration(s)"]})]}),o.jsx("div",{className:"p-6",children:S.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Bs,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-500",children:"Aucun frais configur pour ce niveau"}),o.jsx("button",{onClick:()=>{f(C=>({...C,niveau:E})),s(!0)},className:"mt-3 text-teal-600 hover:text-teal-700 font-medium",children:"Configurer les frais"})]}):o.jsx("div",{className:"space-y-4",children:S.map(C=>o.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:C.anneeScolaire}),o.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[N(C).toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>m(C),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:o.jsx(zo,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>x(C),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:o.jsx($s,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:(C.echeances||[]).map((T,k)=>o.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsxs("span",{className:"text-xs font-medium text-gray-600",children:["Modalit ",T.modalite]}),o.jsx("span",{className:"text-xs text-gray-500",children:new Date(T.date).toLocaleDateString("fr-FR")})]}),o.jsx("p",{className:"text-xs text-gray-600 font-medium",children:T.label||`Modalit ${T.modalite}`}),o.jsxs("p",{className:"font-bold text-gray-900",children:[(T.montant||0).toLocaleString("fr-FR")," FCFA"]})]},k))})]},C.id))})})]},E)})}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 text-white p-6",children:o.jsx("h3",{className:"text-xl font-bold",children:n?"Modifier les frais":"Nouveau frais scolaire"})}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Niveau"}),o.jsx("select",{value:c.niveau,onChange:E=>f(S=>({...S,niveau:E.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-green-100 focus:border-green-500 transition-all",children:Kk.map(E=>o.jsx("option",{value:E,children:E},E))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Anne scolaire"}),o.jsx("input",{type:"text",value:c.anneeScolaire,onChange:E=>f(S=>({...S,anneeScolaire:E.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-green-100 focus:border-green-500 transition-all",placeholder:"2025-2026"})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"chances de paiement"}),o.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",c.echeances.reduce((E,S)=>E+S.montant,0).toLocaleString("fr-FR")," FCFA"]}),o.jsxs("button",{onClick:y,className:"flex items-center space-x-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:[o.jsx(Wo,{className:"h-4 w-4"}),o.jsx("span",{children:"Ajouter"})]})]}),o.jsx("div",{className:"space-y-4",children:c.echeances.map((E,S)=>o.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modalit"}),o.jsx("input",{type:"number",min:"1",value:E.modalite,onChange:C=>v(S,"modalite",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-center font-bold"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Label"}),o.jsx("input",{type:"text",value:E.label,onChange:C=>v(S,"label",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent font-medium",placeholder:"Ex: Inscription, Versement 1..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'chance"}),o.jsx("input",{type:"date",value:E.date,onChange:C=>v(S,"date",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent font-mono"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant (FCFA)"}),o.jsx("input",{type:"number",min:"0",value:E.montant,onChange:C=>v(S,"montant",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-right font-bold text-green-700"})]}),o.jsx("div",{children:o.jsx("button",{onClick:()=>b(S),className:"w-full p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",disabled:c.echeances.length===1,children:o.jsx($s,{className:"h-4 w-4 mx-auto"})})})]})},S))}),o.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-blue-900 font-semibold",children:"Total des frais:"}),o.jsxs("span",{className:"text-2xl font-bold text-blue-700",children:[c.echeances.reduce((E,S)=>E+S.montant,0).toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"mt-2 text-sm text-blue-600",children:[c.echeances.length," modalit(s) de paiement configure(s)"]})]})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{onClick:h,className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:g,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-600 to-teal-600 text-white rounded-xl hover:from-green-700 hover:to-teal-700 transition-all",children:[o.jsx(Js,{className:"h-5 w-5"}),o.jsx("span",{children:n?"Mettre  jour":"Enregistrer"})]})]})]})]})})]})}const Gk=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];function fq(){const{showToast:e}=Jr(),[t,r]=j.useState([]),[n,a]=j.useState(null),[i,s]=j.useState(!1),[c,f]=j.useState({nom:"",coefficient:1,niveau:"",ordre:1});j.useEffect(()=>{d()},[]);const d=()=>{const v=fe.getAll("compositions");r(v.sort((b,N)=>b.ordre-N.ordre))},h=()=>{f({nom:"",coefficient:1,niveau:"",ordre:1}),a(null),s(!1)},m=v=>{f({nom:v.nom,coefficient:v.coefficient,niveau:v.niveau||"",ordre:v.ordre}),a(v),s(!0)},x=()=>{if(!c.nom.trim()){e("Le nom est obligatoire","error");return}if(t.some(b=>b.nom.toLowerCase()===c.nom.trim().toLowerCase()&&b.niveau===(c.niveau||void 0)&&b.id!==n?.id)){e("Cette composition existe dj pour ce niveau","error");return}const v={nom:c.nom.trim(),coefficient:c.coefficient,niveau:c.niveau||void 0,ordre:c.ordre};n?(fe.update("compositions",n.id,v),e("Composition mise  jour","success")):(fe.create("compositions",v),e("Composition ajoute","success")),d(),h()},g=v=>{window.confirm("Supprimer cette composition ? Toutes les notes associes seront perdues.")&&(fe.getAll("notes").filter(E=>E.compositionId===v).forEach(E=>fe.delete("notes",E.id)),fe.getAll("moyennesGenerales").filter(E=>E.compositionId===v).forEach(E=>fe.delete("moyennesGenerales",E.id)),fe.delete("compositions",v),d(),e("Composition supprime","success"))},y=v=>t.filter(b=>!b.niveau||b.niveau===v);return o.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-8 rounded-2xl shadow-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:o.jsx(qi,{className:"h-8 w-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Configuration des Compositions"}),o.jsx("p",{className:"text-purple-100 mt-2",children:"Gestion des priodes d'valuation par niveau"})]})]}),o.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-2 px-6 py-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-xl transition-all",children:[o.jsx(Wo,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:"Nouvelle Composition"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:Gk.map(v=>o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:v}),o.jsxs("p",{className:"text-gray-600 text-sm",children:[y(v).length," composition(s)"]})]}),o.jsx("div",{className:"p-6",children:y(v).length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(x1,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-500 mb-3",children:"Aucune composition spcifique"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Les compositions gnrales s'appliquent  ce niveau"})]}):o.jsx("div",{className:"space-y-3",children:y(v).map(b=>o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:b.nom}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Coefficient: ",b.coefficient,"  Ordre: ",b.ordre]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>m(b),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:o.jsx(zo,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>g(b.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:o.jsx($s,{className:"h-4 w-4"})})]})]},b.id))})})]},v))}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-blue-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Compositions Gnrales"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"S'appliquent  tous les niveaux sauf configuration spcifique"})]}),o.jsx("div",{className:"p-6",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.filter(v=>!v.niveau).map(v=>o.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl p-4 border border-gray-200 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:v.nom}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsx("button",{onClick:()=>m(v),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",children:o.jsx(zo,{className:"h-3 w-3"})}),o.jsx("button",{onClick:()=>g(v.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",children:o.jsx($s,{className:"h-3 w-3"})})]})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:v.coefficient}),o.jsx("p",{className:"text-gray-600 text-xs",children:"Coefficient"}),o.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:["Ordre: ",v.ordre]})]})]},v.id))})})]}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4",children:[o.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 rounded-t-2xl",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-xl font-bold",children:n?"Modifier la composition":"Nouvelle composition"}),o.jsx("button",{onClick:h,className:"text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition-colors",children:o.jsx(Qs,{className:"h-5 w-5"})})]})}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom de la composition ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:c.nom,onChange:v=>f(b=>({...b,nom:v.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all",placeholder:"Ex: 1re Composition, Devoir de Nol..."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Coefficient ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",min:"1",max:"10",value:c.coefficient,onChange:v=>f(b=>({...b,coefficient:Number(v.target.value)})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Ordre d'affichage"}),o.jsx("input",{type:"number",min:"1",value:c.ordre,onChange:v=>f(b=>({...b,ordre:Number(v.target.value)})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Niveau spcifique (optionnel)"}),o.jsxs("select",{value:c.niveau,onChange:v=>f(b=>({...b,niveau:v.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all",children:[o.jsx("option",{value:"",children:"Tous les niveaux"}),Gk.map(v=>o.jsx("option",{value:v,children:v},v))]}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Laissez vide pour appliquer  tous les niveaux"})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{onClick:h,className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:x,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl hover:from-purple-700 hover:to-indigo-700 transition-all",children:[o.jsx(Js,{className:"h-5 w-5"}),o.jsx("span",{children:n?"Mettre  jour":"Enregistrer"})]})]})]})]})})]})}const Xk=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(String(n.result)),n.onerror=r,n.readAsDataURL(e)});function dq(){const[e,t]=j.useState(()=>Ws()),[r,n]=j.useState("eleves");function a(s,c,f){t(d=>{const h=d[s];return{...d,[s]:{...h,[c]:f}}})}const i=()=>{Gu(e),alert("Configurations d'impression sauvegardes")};return o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Configuration des impressions"}),o.jsx("p",{className:"mb-6 text-sm text-gray-600 max-w-3xl",children:"ditez l'en-tte, le pied de page, les logos et les colonnes pour chaque type de document. Chaque onglet dispose d'un aperu plac sous le formulaire."}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex items-center gap-3",children:["eleves","recu","transport"].map(s=>o.jsx("button",{onClick:()=>n(s),className:`px-4 py-2 rounded-md font-semibold shadow-sm ${r===s?"bg-teal-600 text-white":"bg-white border text-gray-700"}`,children:s==="eleves"?"LVES":s==="recu"?"REU":"TRANSPORT"},s))}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow space-y-6",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["Paramtres  ",r==="eleves"?"Liste lves":r==="recu"?"Reu de paiement":"Transport"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"En-tte"}),o.jsx("textarea",{rows:2,value:e[r].header,onChange:s=>a(r,"header",s.target.value),className:"w-full border rounded px-3 py-2 mt-1 resize-none",placeholder:r==="eleves"?"Ministre de l'ducation Nationale  Nom de l'tablissement":r==="recu"?"Reu de paiement":"Fiche de renseignement transport"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pied de page"}),o.jsx("textarea",{rows:2,value:e[r].footer||"",onChange:s=>a(r,"footer",s.target.value),className:"w-full border rounded px-3 py-2 mt-1 resize-none",placeholder:r==="recu"?"Aucun remboursement n'est possible aprs encaissement.":""})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Colonnes (spares par des virgules)"}),o.jsx("input",{value:e[r].columns.join(", "),onChange:s=>a(r,"columns",s.target.value.split(",").map(c=>c.trim())),className:"w-full border rounded px-3 py-2 mt-1",placeholder:r==="eleves"?"Matricule, Nom & Prnom":r==="recu"?"Nom, Montant, Date, Classe":"Nom, Classe, Montant, Versement"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Logo principal"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async s=>{const c=s.target.files?.[0];if(!c)return;const f=await Xk(c);a(r,"logo",f)},className:"mt-1"}),o.jsx("div",{className:"mt-2 text-sm text-gray-600",children:e[r].logo?o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:e[r].logo,alt:"logo",className:"h-14"}),o.jsx("button",{className:"px-3 py-1 border rounded text-sm",onClick:()=>a(r,"logo",""),children:"Supprimer"})]}):o.jsx("div",{children:"Aucun fichier slectionn"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Logo Ministre"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async s=>{const c=s.target.files?.[0];if(!c)return;const f=await Xk(c);a(r,"logoMinistere",f)},className:"mt-1"}),o.jsx("div",{className:"mt-2 text-sm text-gray-600",children:e[r].logoMinistere?o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:e[r].logoMinistere,alt:"logo-min",className:"h-14"}),o.jsx("button",{className:"px-3 py-1 border rounded text-sm",onClick:()=>a(r,"logoMinistere",""),children:"Supprimer"})]}):o.jsx("div",{children:"Aucun fichier slectionn"})})]})]}),o.jsxs("div",{className:"flex items-center justify-between mt-4",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Options"}),o.jsxs("div",{className:"space-x-2",children:[o.jsx("button",{onClick:()=>t(Ws()),className:"px-3 py-1 border rounded",children:"Restaurer"}),o.jsx("button",{onClick:i,className:"px-3 py-1 bg-teal-600 text-white rounded",children:"Sauvegarder"})]})]})]}),o.jsx("div",{className:"border-t pt-4",children:o.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h4",{className:"font-semibold",children:["Aperu  ",r==="eleves"?"Liste lves":r==="recu"?"Reu":"Transport"]}),o.jsx("div",{className:"text-sm text-gray-500",children:r==="eleves"?"Liste des lves":r==="recu"?"Reu de paiement":"Fiche de renseignement transport"})]}),o.jsxs("div",{className:"border rounded bg-white p-4",children:[o.jsx(Bf,{type:r,libelle:e[r].header}),o.jsxs("div",{className:"mt-4 text-sm text-gray-700",children:[r==="eleves"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:"Ministre de l'ducation Nationale et de l'Alphabtisation"}),o.jsx("div",{className:"mt-1",children:"GROUPE SCOLAIRE BAPTISTE MISSIONNAIRE DE KOUMASSI"}),o.jsx("div",{className:"mt-3 font-medium",children:"Liste des lves"})]}),r==="recu"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:"Reu de paiement"}),o.jsx("div",{className:"mt-2 text-gray-600",children:"Aucun remboursement n'est possible aprs encaissement."})]}),r==="transport"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:"Fiche de renseignement transport"}),o.jsx("div",{className:"mt-2 text-gray-600",children:"Informations : nom, classe, montant, versement"})]})]})]})]})})]})]})]})}function hq(){const{showToast:e}=Jr(),t=j.useRef(null),r=async()=>{try{const i=await yn(()=>import("./jszip.min-2BuQKcUJ.js").then(v=>v.j),[],import.meta.url),s=i&&(i.default||i),c=new s,f=JSON.parse(fe.exportData()),d=new Date().toISOString().split("T")[0],h=c.folder(`backup_${d}/data`);Object.entries(f).forEach(([v,b])=>{h.file(`${v}.json`,JSON.stringify(b,null,2))}),c.folder(`backup_${d}/meta`).file("info.json",JSON.stringify({generatedAt:new Date().toISOString(),app:"KlasNet"},null,2));const x=await c.generateAsync({type:"blob"}),g=window.URL.createObjectURL(x),y=document.createElement("a");y.href=g,y.download=`klasnet_backup_${d}.zip`,y.click(),window.URL.revokeObjectURL(g),e("Sauvegarde ZIP exporte avec succs","success")}catch{const s=fe.exportData(),c=new Blob([s],{type:"application/json"}),f=window.URL.createObjectURL(c),d=document.createElement("a"),h=new Date().toISOString().split("T")[0];d.href=f,d.download=`klasnet_backup_${h}.json`,d.click(),window.URL.revokeObjectURL(f),e("Sauvegarde exporte (fallback JSON)","success")}},n=i=>{const s=i.target.files?.[0];if(!s)return;const c=new FileReader;c.onload=f=>{try{const d=f.target?.result;fe.importData(d)?e("Donnes importes avec succs","success"):e("Erreur lors de limportation des donnes","error")}catch{e("Erreur lors de la lecture du fichier","error")}},c.readAsText(s)},a=()=>{window.confirm("tes-vous sr de vouloir rinitialiser toutes les donnes ? Cette action est irrversible.")&&(fe.resetData(),e("Donnes rinitialises avec succs","success"))};return o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Sauvegarde et Restauration"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Export / import / rinitialisation des donnes de l'application"})]}),o.jsxs("div",{className:"max-w-xl bg-white p-6 rounded shadow-sm border",children:[o.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"Utilisez ces commandes pour exporter une sauvegarde complte de l'application, importer une sauvegarde ou rinitialiser la base de donnes locale."}),o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsx("button",{onClick:r,className:"w-full px-4 py-2 bg-blue-600 text-white rounded",children:"Exporter les donnes"}),o.jsx("button",{onClick:()=>t.current?.click(),className:"w-full px-4 py-2 border rounded",children:"Importer des donnes"}),o.jsx("button",{onClick:a,className:"w-full px-4 py-2 bg-red-600 text-white rounded",children:"Rinitialiser toutes les donnes"})]}),o.jsx("input",{ref:t,type:"file",accept:".json",onChange:n,className:"hidden"})]})]})}function mq(){const[e,t]=j.useState([]);return j.useEffect(()=>{t(fe.getAll("historiques").sort((r,n)=>n.date.localeCompare(r.date)))},[]),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 max-w-2xl mx-auto",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Historique des actions"}),e.length===0?o.jsx("div",{className:"text-gray-500 text-center",children:"Aucune action enregistre."}):o.jsxs("table",{className:"w-full text-sm border",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"border px-2 py-1",children:"Date"}),o.jsx("th",{className:"border px-2 py-1",children:"Type"}),o.jsx("th",{className:"border px-2 py-1",children:"Cible"}),o.jsx("th",{className:"border px-2 py-1",children:"Description"}),o.jsx("th",{className:"border px-2 py-1",children:"Utilisateur"})]})}),o.jsx("tbody",{children:e.map(r=>o.jsxs("tr",{children:[o.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:new Date(r.date).toLocaleString()}),o.jsx("td",{className:"border px-2 py-1 capitalize",children:r.type}),o.jsx("td",{className:"border px-2 py-1",children:r.cible}),o.jsx("td",{className:"border px-2 py-1",children:r.description}),o.jsx("td",{className:"border px-2 py-1",children:r.utilisateur||"-"})]},r.id))})]})]})}function pq(){const{showToast:e}=Jr(),[t,r]=j.useState(null),[n,a]=j.useState(""),[i,s]=j.useState(!1),[c,f]=j.useState(!1),[d,h]=j.useState(!1),[m,x]=j.useState(null);j.useEffect(()=>{g()},[]);const g=async()=>{f(!0);try{await Bi.updateLicenceFromServer();const N=await Bi.checkLicenceStatus();r(N)}catch(N){console.error("Erreur refresh licence:",N)}finally{f(!1)}},y=async()=>{if(!n.trim()){e("Veuillez entrer une cl de licence","error");return}s(!0);try{const N=Bi.activateLicence(n.trim());N.success?(e(N.message,"success"),a(""),await g()):e(N.message,"error")}catch{e("Erreur lors de l'activation","error")}finally{s(!1)}},v=()=>t?t.isValid&&!t.isExpired?o.jsx(ua,{className:"h-8 w-8 text-green-600"}):o.jsx(wi,{className:"h-8 w-8 text-red-600"}):o.jsx(l4,{className:"h-8 w-8 text-gray-400"}),b=()=>t?t.isValid&&!t.isExpired?t.daysRemaining<=7?"from-yellow-500 to-orange-500":"from-green-500 to-teal-500":"from-red-500 to-red-600":"from-gray-500 to-gray-600";return o.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[o.jsx("div",{className:`bg-gradient-to-r ${b()} text-white p-8 rounded-2xl shadow-lg`,children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:v()}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Gestion des Licences"}),o.jsx("p",{className:"text-white text-opacity-90 mt-2",children:t?.isValid?`Licence ${t.type} active - ${t.daysRemaining} jour(s) restant(s)`:"Licence expire ou invalide"})]})]})}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Statut de la Licence"}),o.jsxs("button",{onClick:g,disabled:c,className:"flex items-center space-x-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors disabled:opacity-50",children:[o.jsx(v1,{className:`h-4 w-4 ${c?"animate-spin":""}`}),o.jsx("span",{children:"Actualiser"})]})]})}),o.jsxs("div",{className:"p-6",children:[t?o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-xl",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600 capitalize",children:t.type}),o.jsx("p",{className:"text-blue-800 font-medium",children:"Type de licence"})]}),o.jsxs("div",{className:"text-center p-6 bg-purple-50 rounded-xl",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.daysRemaining}),o.jsx("p",{className:"text-purple-800 font-medium",children:"Jours restants"})]}),o.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-xl",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.isValid?"":""}),o.jsx("p",{className:"text-green-800 font-medium",children:t.isValid?"Valide":"Expire"})]})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Vrification en cours..."})]}),t&&o.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Dtails"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Date d'expiration:"}),o.jsx("div",{className:"font-medium text-gray-900",children:t.dateExpiration?new Date(t.dateExpiration).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Non dfinie"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Dernire vrification:"}),o.jsx("div",{className:"font-medium text-gray-900",children:new Date(t.lastCheck).toLocaleString("fr-FR")})]})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-blue-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Activation de Licence"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Entrez votre cl de licence pour activer ou renouveler"})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Cl de licence"}),o.jsx("textarea",{value:n,onChange:N=>a(N.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-teal-100 focus:border-teal-500 transition-all resize-none font-mono text-sm",rows:4,placeholder:"Collez votre cl de licence ici..."})]}),o.jsxs("div",{className:"flex justify-end space-x-4",children:[o.jsx("button",{onClick:()=>a(""),className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors",children:"Effacer"}),o.jsxs("button",{onClick:y,disabled:i||!n.trim(),className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-xl hover:from-teal-700 hover:to-blue-700 transition-all disabled:opacity-50",children:[i?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(O0,{className:"h-4 w-4"}),o.jsx("span",{children:i?"Activation...":"Activer la licence"})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gnrateur de Cls (dsactiv)"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"La gnration de cls a t dsactive dans le client. Utilisez un service serveur scuris pour mettre des licences."})]}),o.jsx("div",{className:"p-6",children:o.jsxs("button",{disabled:!0,title:"Gnration de cls dsactive",className:"flex items-center space-x-2 px-6 py-3 bg-gray-200 text-gray-500 rounded-xl cursor-not-allowed",children:[o.jsx(O0,{className:"h-5 w-5"}),o.jsx("span",{children:"Gnration dsactive"})]})})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Actions Avances"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Utilisez avec prcaution"})]}),o.jsx("div",{className:"p-6",children:o.jsx("div",{className:"flex space-x-4",children:o.jsx("button",{onClick:()=>{window.confirm("Rinitialiser la licence ? Cela supprimera la licence actuelle.")&&(Bi.resetLicence(),g(),e("Licence rinitialise","success"))},className:"px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors",children:"Rinitialiser la licence"})})})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations Systme"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:o.jsx("div",{className:"text-sm",children:o.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Tlphone:"})," +2250555863953"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Email:"})," Non disponible"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Site web:"})," Non disponible"]})]})})})]})]})}let wh;try{wh=require("./defaultFraisScolaires").ensureDefaultFrais}catch{wh=void 0}function xq(e){const{useDFA:t=!1,dfa:r={},seuilAdmission:n=10,nouvelleAnnee:a,fallbackToReset:i=!0,preserveEleves:s=!0,resetFinances:c=!0}=e,f=fe.getAll("eleves"),d=fe.getAll("classes"),h=fe.getAll("notes"),m=fe.getAll("paiements"),x={date:new Date().toISOString(),eleves:f,classes:d,notes:h,paiements:m,compositions:fe.getAll("compositions"),fraisScolaires:fe.getAll("fraisScolaires"),type:"archive_pre_passage_annee"};try{const N=new Blob([JSON.stringify(x,null,2)],{type:"application/json"}),E=window.URL.createObjectURL(N),S=document.createElement("a");S.href=E,S.download=`archive_pre_passage_${new Date().getFullYear()}.json`,S.click(),window.URL.revokeObjectURL(E)}catch{}fe.addHistorique({type:"autre",cible:"Systme",description:`Passage d'anne dclench (${t?"DFA":"Reset simple"}) vers ${a}`,utilisateur:"ADMIN"});let g=0,y=0;if(t){if(h.length===0&&!i)throw new Error("Aucune note disponible pour calculer la DFA");if(h.length===0&&i)return b();const N=Object.keys(r).length?r:(function(){const C={},T=fe.getAll("notes"),k={};return T.forEach(P=>{const D=P.eleveId,R=Number(P.valeur||0),q=Number(P.bareme||20)||20,M=R/q*20;k[D]=k[D]||[],k[D].push(M)}),Object.keys(k).forEach(P=>{const D=k[P],R=D.reduce((q,M)=>q+M,0)/D.length;C[P]=Math.round(R*100)/100}),C})(),E=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];f.forEach(S=>{const C=N[S.id]??0,T=d.find(P=>P.id===S.classeId);if(!T)return;const k=E.indexOf(T.niveau);if(C>=n)if(k>=0&&k<E.length-1){const P=E[k+1],D=d.find(R=>R.niveau===P&&R.section===T.section&&R.anneeScolaire===a);D&&(fe.update("eleves",S.id,{classeId:D.id,anneeEntree:a}),g++)}else fe.update("eleves",S.id,{statut:"Inactif"}),g++;else fe.update("eleves",S.id,{anneeEntree:a}),y++})}else return b();d.forEach(N=>{fe.update("classes",N.id,{anneeScolaire:a})});const v=fe.getAll("ecole")[0];return v&&fe.update("ecole",v.id,{anneeScolaireActive:a}),c&&fe.getAll("paiements").forEach(N=>fe.delete("paiements",N.id)),{promoted:g,heldBack:y};function b(){s?fe.getAll("eleves").forEach(S=>{fe.update("eleves",S.id,{classeId:"",anneeEntree:a})}):fe.getAll("eleves").forEach(S=>{fe.update("eleves",S.id,{statut:"Inactif"})});try{wh&&wh(a)}catch{}c&&fe.getAll("paiements").forEach(E=>fe.delete("paiements",E.id)),d.forEach(E=>{fe.update("classes",E.id,{anneeScolaire:a})});const N=fe.getAll("ecole")[0];return N&&fe.update("ecole",N.id,{anneeScolaireActive:a}),fe.addHistorique({type:"autre",cible:"Systme",description:`Reset simple appliqu pour anne ${a}`,utilisateur:"ADMIN"}),{promoted:0,heldBack:0}}}function gq(){const[e,t]=j.useState(!0),[r,n]=j.useState(10),[a,i]=j.useState(()=>{const P=new Date().getFullYear()+1;return`${P}-${P+1}`}),[s,c]=j.useState(!0),[f,d]=j.useState(!0),[h,m]=j.useState(null),[x,g]=j.useState(!1),[y,v]=j.useState(!1),[b,N]=j.useState(""),[E,S]=j.useState({promoted:0,heldBack:0,total:0}),C=()=>{v(!0),N("")},T=async()=>{if(b.trim()!==a.trim()){m("La confirmation ne correspond pas  la nouvelle anne. Tapez exactement la valeur affiche pour confirmer.");return}v(!1),g(!0),m(null);try{const P=xq({useDFA:e,seuilAdmission:r,nouvelleAnnee:a,preserveEleves:s,resetFinances:f});m(`Opration termine. Promus: ${P?.promoted??0}, Redoublants: ${P?.heldBack??0}`)}catch(P){m(`Erreur: ${P?.message||String(P)}`)}finally{g(!1)}},k=()=>{const P=fe.getAll("eleves"),D=fe.getAll("classes"),R=fe.getAll("notes"),q={};R.forEach(ce=>{const ae=ce.eleveId,me=Number(ce.valeur||0),de=Number(ce.bareme||20)||20,he=me/de*20;q[ae]=q[ae]||[],q[ae].push(he)});const M={};Object.keys(q).forEach(ce=>{const ae=q[ce],me=ae.reduce((de,he)=>de+he,0)/ae.length;M[ce]=Math.round(me*100)/100});let z=0,ie=0;P.forEach(ce=>{const ae=M[ce.id]??0;D.find(de=>de.id===ce.classeId)&&(ae>=r?z++:ie++)}),S({promoted:z,heldBack:ie,total:P.length})};return j.useEffect(()=>{k()},[e,r,a,s]),o.jsxs(Tc,{title:"Passage d'anne scolaire",subtitle:"Clturer l'anne actuelle et prparer la nouvelle",children:[o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white p-4 rounded border border-gray-200",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold",children:"Prparation du passage"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Les moyennes sont normalises sur une chelle sur 20 avant dcision. Par exemple, une moyenne 5/10 est convertie en 10/20  le seuil d'admission est donc compar sur /20."})]}),o.jsxs("div",{className:"text-sm text-gray-500 flex items-center space-x-3",children:[o.jsx(wi,{className:"w-5 h-5 text-yellow-600"}),o.jsx("span",{children:"Opration irrversible  une archive sera propose"})]})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:e,onChange:P=>t(P.target.checked)}),o.jsx("span",{children:"Utiliser DFA (moyennes) pour promouvoir les lves"})]}),o.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("label",{className:"text-sm text-gray-700",children:"Seuil admission (sur 20)"}),o.jsx("input",{type:"number",value:r,onChange:P=>n(Number(P.target.value)),className:"border rounded px-2 py-1 w-20"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Nouvelle anne scolaire"}),o.jsx("input",{value:a,onChange:P=>i(P.target.value),className:"border rounded px-2 py-1 w-48 mt-1"})]}),o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:e,onChange:P=>t(P.target.checked)}),o.jsx("span",{children:"Utiliser DFA (moyennes)"})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:s,onChange:P=>c(P.target.checked)}),o.jsx("span",{children:"Conserver les lves (dsaffecter si besoin)"})]})]})]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Nouvelle anne scolaire"}),o.jsx("input",{value:a,onChange:P=>i(P.target.value),className:"border rounded px-2 py-1 w-48 mt-1"})]}),o.jsx("div",{className:"mt-3",children:o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:f,onChange:P=>d(P.target.checked)}),o.jsx("span",{children:"Rinitialiser les paiements / finances"})]})}),o.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ft,{onClick:C,disabled:x,variant:"danger",children:x?"Excution...":"Lancer le passage"}),o.jsx(Ft,{onClick:()=>{m(null)},variant:"ghost",children:"Effacer"})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs("button",{className:"flex items-center text-sm text-gray-600 hover:text-gray-900",onClick:k,title:"Rafrachir l'aperu",children:[o.jsx(v1,{className:"w-4 h-4 mr-2"})," Rafrachir l'aperu"]})})]}),h&&o.jsx("div",{className:"mt-4 p-3 bg-gray-50 border rounded text-sm",children:h})]}),o.jsxs("div",{className:"bg-white p-4 rounded border border-gray-200",children:[o.jsx("h3",{className:"text-md font-semibold mb-2",children:"Aperu (non destructif)"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Estimation base sur les notes existantes (toutes normalises sur 20)."}),o.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"p-4 bg-green-50 rounded flex items-center space-x-3",children:[o.jsx(ua,{className:"w-6 h-6 text-green-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-bold",children:E.promoted}),o.jsx("div",{className:"text-sm text-gray-600",children:"Promus estims"})]})]}),o.jsxs("div",{className:"p-4 bg-yellow-50 rounded flex items-center space-x-3",children:[o.jsx(wi,{className:"w-6 h-6 text-yellow-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-bold",children:E.heldBack}),o.jsx("div",{className:"text-sm text-gray-600",children:"Redoublants estims"})]})]}),o.jsxs("div",{className:"p-4 bg-gray-50 rounded flex items-center space-x-3",children:[o.jsx(y1,{className:"w-6 h-6 text-gray-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-bold",children:E.total}),o.jsx("div",{className:"text-sm text-gray-600",children:"Total lves analyss"})]})]})]})]})]}),y&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-md",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Confirmer le passage d'anne"}),o.jsx("p",{className:"text-sm text-gray-700 mt-2",children:"Cette opration est irrversible. Pour confirmer, tapez exactement la nouvelle anne scolaire :"}),o.jsx("div",{className:"mt-3 font-mono text-sm bg-gray-100 p-2 rounded",children:a}),o.jsx("input",{value:b,onChange:P=>N(P.target.value),placeholder:"Tapez la nouvelle anne pour confirmer",className:"mt-3 w-full border rounded px-2 py-1"}),o.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[o.jsx(Ft,{variant:"ghost",onClick:()=>v(!1),children:"Annuler"}),o.jsx(Ft,{variant:"danger",onClick:T,children:"Confirmer et lancer"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var bh={};bh.version="0.18.5";var lP=1252,vq=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],vw={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yw=function(e){vq.indexOf(e)!=-1&&(lP=vw[0]=e)};function yq(){yw(1252)}var Za=function(e){yw(e)};function ww(){Za(1200),yq()}function qk(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function wq(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function cP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Pu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?wq(e.slice(2)):t==254&&r==255?cP(e.slice(2)):t==65279?e.slice(1):e},x0=function(t){return String.fromCharCode(t)},Yk=function(t){return String.fromCharCode(t)},of,Ms="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0,f=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),s=(r&3)<<4|n>>4,a=e.charCodeAt(d++),c=(n&15)<<2|a>>6,f=a&63,isNaN(n)?c=f=64:isNaN(a)&&(f=64),t+=Ms.charAt(i)+Ms.charAt(s)+Ms.charAt(c)+Ms.charAt(f);return t}function pa(e){var t="",r=0,n=0,a=0,i=0,s=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Ms.indexOf(e.charAt(d++)),s=Ms.indexOf(e.charAt(d++)),r=i<<2|s>>4,t+=String.fromCharCode(r),c=Ms.indexOf(e.charAt(d++)),n=(s&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),f=Ms.indexOf(e.charAt(d++)),a=(c&3)<<6|f,f!==64&&(t+=String.fromCharCode(a));return t}var pt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),os=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Gs(e){return pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Jk(e){return pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var la=function(t){return pt?os(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ym(e){if(typeof ArrayBuffer>"u")return la(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function no(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function bq(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function bw(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return bw(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Gr=pt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:os(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Sq(e){for(var t=[],r=0,n=e.length+250,a=Gs(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var c=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|c>>6&15|(s&3)<<4,a[r++]=128|c&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Gs(65535),n=65530)}return t.push(a.slice(0,r)),Gr(t)}var In=/\u0000/g,Ou=/[\u0001-\u0006]/g;function ec(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ei(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}function Sw(e,t){var r=""+e;return r.length>=t?r:ur(" ",t-r.length)+r}function Sh(e,t){var r=""+e;return r.length>=t?r:r+ur(" ",t-r.length)}function Nq(e,t){var r=""+Math.round(e);return r.length>=t?r:ur("0",t-r.length)+r}function _q(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}var Qk=Math.pow(2,32);function Ul(e,t){if(e>Qk||e<-Qk)return Nq(e,t);var r=Math.round(e);return _q(r,t)}function Nh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Zk=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Kg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Eq(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},ej={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},kq={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _h(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,c=0,f=1,d=0,h=0,m=Math.floor(a);d<t&&(m=Math.floor(a),c=m*s+i,h=m*d+f,!(a-m<5e-8));)a=1/(a-m),i=s,s=c,f=d,d=h;if(h>t&&(d>t?(h=f,c=i):(h=d,c=s)),!r)return[0,n*c,h];var x=Math.floor(n*c/h);return[x,n*c-x*h,h]}function Fo(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),s=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=Oq(f,s))}return c.y=s[0],c.m=s[1],c.d=s[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var uP=new Date(1899,11,31,0,0,0),jq=uP.getTime(),Cq=new Date(1900,2,1,0,0,0);function fP(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Cq&&(r+=1440*60*1e3),(r-(jq+(e.getTimezoneOffset()-uP.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Nw(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Aq(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Tq(e){var t=e<0?12:11,r=Nw(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Pq(e){var t=Nw(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function cf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Tq(e):t===10?r=e.toFixed(10).substr(0,12):r=Pq(e),Nw(Aq(r.toUpperCase()))}function Jo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):cf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return La(14,fP(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Oq(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Fq(e,t,r,n){var a="",i=0,s=0,c=r.y,f,d=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:f=c%100,d=2;break;default:f=c%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,d=t.length;break;case 3:return Kg[r.m-1][1];case 5:return Kg[r.m-1][0];default:return Kg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,d=t.length;break;case 3:return Zk[r.q][0];default:return Zk[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ei(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=ei(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:f=c,d=1;break}var h=d>0?ei(f,d):"";return h}function Rs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var dP=/%/g;function Dq(e,t,r){var n=t.replace(dP,""),a=t.length-n.length;return Ki(e,n,r*Math.pow(10,2*a))+ur("%",a)}function Iq(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ki(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function hP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+hP(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,h){return f+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var mP=/# (\?+)( ?)\/( ?)(\d+)/;function Mq(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,c=n;return r+(i===0?"":""+i)+" "+(s===0?ur(" ",e[1].length+1+e[4].length):Sw(s,e[1].length)+e[2]+"/"+e[3]+ei(c,e[4].length))}function Rq(e,t,r){return r+(t===0?"":""+t)+ur(" ",e[1].length+2+e[4].length)}var pP=/^#*0*\.([0#]+)/,xP=/\).*[0#]/,gP=/\(###\) ###\\?-####/;function Pn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function tj(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function rj(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Lq(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Bq(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ca(e,t,r){if(e.charCodeAt(0)===40&&!t.match(xP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ca("n",n,r):"("+Ca("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Iq(e,t,r);if(t.indexOf("%")!==-1)return Dq(e,t,r);if(t.indexOf("E")!==-1)return hP(t,r);if(t.charCodeAt(0)===36)return"$"+Ca(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,c,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ul(f,t.length);if(t.match(/^[#?]+$/))return a=Ul(r,0),a==="0"&&(a=""),a.length>t.length?a:Pn(t.substr(0,t.length-a.length))+a;if(i=t.match(mP))return Mq(i,f,d);if(t.match(/^#+0+$/))return d+Ul(f,t.length-t.indexOf("0"));if(i=t.match(pP))return a=tj(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Pn(i[1])).replace(/\.$/,"."+Pn(i[1])).replace(/\.(\d*)$/,function(y,v){return"."+v+ur("0",Pn(i[1]).length-v.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+tj(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Rs(Ul(f,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ca(e,t,-r):Rs(""+(Math.floor(r)+Lq(r,i[1].length)))+"."+ei(rj(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ca(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ec(Ca(e,t.replace(/[\\-]/g,""),r)),s=0,ec(ec(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(gP))return a=Ca(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=_h(f,Math.pow(10,s)-1,!1),a=""+d,h=Ki("n",i[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=Sh(c[2],s),h.length<i[4].length&&(h=Pn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=_h(f,Math.pow(10,s)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Sw(c[1],s)+i[2]+"/"+i[3]+Sh(c[2],s):ur(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Ul(r,0),t.length<=a.length?a:Pn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,x=t.length-a.length-m;return Pn(t.substr(0,m)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=rj(r,i[1].length),r<0?"-"+Ca(e,t,-r):Rs(Bq(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ei(0,3-y.length):"")+y})+"."+ei(s,i[1].length);switch(t){case"###,##0.00":return Ca(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Rs(Ul(f,0));return g!=="0"?d+g:"";case"###,###.00":return Ca(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ca(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function $q(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ki(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Uq(e,t,r){var n=t.replace(dP,""),a=t.length-n.length;return Ki(e,n,r*Math.pow(10,2*a))+ur("%",a)}function vP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+vP(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,h){return f+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function di(e,t,r){if(e.charCodeAt(0)===40&&!t.match(xP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?di("n",n,r):"("+di("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return $q(e,t,r);if(t.indexOf("%")!==-1)return Uq(e,t,r);if(t.indexOf("E")!==-1)return vP(t,r);if(t.charCodeAt(0)===36)return"$"+di(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,c,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ei(f,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Pn(t.substr(0,t.length-a.length))+a;if(i=t.match(mP))return Rq(i,f,d);if(t.match(/^#+0+$/))return d+ei(f,t.length-t.indexOf("0"));if(i=t.match(pP))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Pn(i[1])).replace(/\.$/,"."+Pn(i[1])),a=a.replace(/\.(\d*)$/,function(y,v){return"."+v+ur("0",Pn(i[1]).length-v.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Rs(""+f);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+di(e,t,-r):Rs(""+r)+"."+ur("0",i[1].length);if(i=t.match(/^#,#*,#0/))return di(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ec(di(e,t.replace(/[\\-]/g,""),r)),s=0,ec(ec(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(gP))return a=di(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=_h(f,Math.pow(10,s)-1,!1),a=""+d,h=Ki("n",i[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=Sh(c[2],s),h.length<i[4].length&&(h=Pn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=_h(f,Math.pow(10,s)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Sw(c[1],s)+i[2]+"/"+i[3]+Sh(c[2],s):ur(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Pn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,x=t.length-a.length-m;return Pn(t.substr(0,m)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+di(e,t,-r):Rs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ei(0,3-y.length):"")+y})+"."+ei(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Rs(""+f);return g!=="0"?d+g:"";default:if(t.match(/\.[0#?]*$/))return di(e,t.slice(0,t.lastIndexOf(".")),r)+Pn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ki(e,t,r){return(r|0)===r?di(e,t,r):Ca(e,t,r)}function zq(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var yP=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Nh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(yP))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Wq(e,t,r,n){for(var a=[],i="",s=0,c="",f="t",d,h,m,x="H";s<e.length;)switch(c=e.charAt(s)){case"G":if(!Nh(e,s))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(m=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++s;break;case"\\":var g=e.charAt(++s),y=g==="("||g===")"?g:"t";a[a.length]={t:y,v:g},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(d==null&&(d=Fo(t,r,e.charAt(s+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},f=c,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Fo(t,r),d==null))return"";for(i=c;++s<e.length&&e.charAt(s).toLowerCase()===c;)i+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),a[a.length]={t:c,v:i},f=c;break;case"A":case"a":case"":var v={t:c,v:c};if(d==null&&(d=Fo(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(d!=null&&(v.v=d.H>=12?"P":"A"),v.t="T",x="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(d!=null&&(v.v=d.H>=12?"PM":"AM"),v.t="T",s+=5,x="h"):e.substr(s,5).toUpperCase()==="/"?(d!=null&&(v.v=d.H>=12?"":""),v.t="T",s+=5,x="h"):(v.t="t",++s),d==null&&v.t==="T")return"";a[a.length]=v,f=c;break;case"[":for(i=c;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(yP)){if(d==null&&(d=Fo(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pc(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=c;++s<e.length&&(c=e.charAt(s))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++s<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(s))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++s)===c;)i+=c;a[a.length]={t:c,v:i},f=c;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++s;break}var b=0,N=0,E;for(s=a.length-1,f="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=x,f="h",b<1&&(b=1);break;case"s":(E=a[s].v.match(/\.0+$/))&&(N=Math.max(N,E[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":f=a[s].t;break;case"m":f==="s"&&(a[s].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[s].v.match(/[Hh]/)&&(b=1),b<2&&a[s].v.match(/[Mm]/)&&(b=2),b<3&&a[s].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var S="",C;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=Fq(a[s].t.charCodeAt(0),a[s].v,d,N),a[s].t="t";break;case"n":case"?":for(C=s+1;a[C]!=null&&((c=a[C].t)==="?"||c==="D"||(c===" "||c==="t")&&a[C+1]!=null&&(a[C+1].t==="?"||a[C+1].t==="t"&&a[C+1].v==="/")||a[s].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[C].v==="/"||a[C].v===" "&&a[C+1]!=null&&a[C+1].t=="?"));)a[s].v+=a[C].v,a[C]={v:"",t:";"},++C;S+=a[s].v,s=C-1;break;case"G":a[s].t="t",a[s].v=Jo(t,r);break}var T="",k,P;if(S.length>0){S.charCodeAt(0)==40?(k=t<0&&S.charCodeAt(0)===45?-t:t,P=Ki("n",S,k)):(k=t<0&&n>1?-t:t,P=Ki("n",S,k),k<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),C=P.length-1;var D=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){D=s;break}var R=a.length;if(D===a.length&&P.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(C>=a[s].v.length-1?(C-=a[s].v.length,a[s].v=P.substr(C+1,a[s].v.length)):C<0?a[s].v="":(a[s].v=P.substr(0,C+1),C=-1),a[s].t="t",R=s);C>=0&&R<a.length&&(a[R].v=P.substr(0,C+1)+a[R].v)}else if(D!==a.length&&P.indexOf("E")===-1){for(C=P.indexOf(".")-1,s=D;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(h=a[s].v.indexOf(".")>-1&&s===D?a[s].v.indexOf(".")-1:a[s].v.length-1,T=a[s].v.substr(h+1);h>=0;--h)C>=0&&(a[s].v.charAt(h)==="0"||a[s].v.charAt(h)==="#")&&(T=P.charAt(C--)+T);a[s].v=T,a[s].t="t",R=s}for(C>=0&&R<a.length&&(a[R].v=P.substr(0,C+1)+a[R].v),C=P.indexOf(".")+1,s=D;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==D)){for(h=a[s].v.indexOf(".")>-1&&s===D?a[s].v.indexOf(".")+1:0,T=a[s].v.substr(0,h);h<a[s].v.length;++h)C<P.length&&(T+=P.charAt(C++));a[s].v=T,a[s].t="t",R=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(k=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Ki(a[s].t,a[s].v,k),a[s].t="t");var q="";for(s=0;s!==a.length;++s)a[s]!=null&&(q+=a[s].v);return q}var nj=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function aj(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Hq(e,t){var r=zq(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(nj),c=r[1].match(nj);return aj(t,s)?[n,r[0]]:aj(t,c)?[n,r[1]]:[n,r[s!=null&&c!=null?2:1]]}return[n,i]}function La(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[e],n==null&&(n=r.table&&r.table[ej[e]]||it[ej[e]]),n==null&&(n=kq[e]||"General");break}if(Nh(n,0))return Jo(t,r);t instanceof Date&&(t=fP(t,r.date1904));var a=Hq(n,t);if(Nh(a[1]))return Jo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Wq(a[1],t,r,a[0])}function Gi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(it[r]==null){t<0&&(t=r);continue}if(it[r]==e){t=r;break}}t<0&&(t=391)}return it[t]=e,t}function wm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Gi(e[t],t)}function Oc(){it=Eq()}var Vq={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},wP=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Kq(e){var t=typeof e=="number"?it[e]:e;return t=t.replace(wP,"(\\d+)"),new RegExp("^"+t+"$")}function Gq(e,t,r){var n=-1,a=-1,i=-1,s=-1,c=-1,f=-1;(t.match(wP)||[]).forEach(function(m,x){var g=parseInt(r[x+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":s=g;break;case"s":f=g;break;case"m":s>=0?c=g:a=g;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return s==-1&&c==-1&&f==-1?d:n==-1&&a==-1&&i==-1?h:d+"T"+h}var Xq=(function(){var e={};e.version="1.2.0";function t(){for(var P=0,D=new Array(256),R=0;R!=256;++R)P=R,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,D[R]=P;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(P){var D=0,R=0,q=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)M[q]=P[q];for(q=0;q!=256;++q)for(R=P[q],D=256+q;D<4096;D+=256)R=M[D]=R>>>8^P[R&255];var z=[];for(q=1;q!=16;++q)z[q-1]=typeof Int32Array<"u"?M.subarray(q*256,q*256+256):M.slice(q*256,q*256+256);return z}var a=n(r),i=a[0],s=a[1],c=a[2],f=a[3],d=a[4],h=a[5],m=a[6],x=a[7],g=a[8],y=a[9],v=a[10],b=a[11],N=a[12],E=a[13],S=a[14];function C(P,D){for(var R=D^-1,q=0,M=P.length;q<M;)R=R>>>8^r[(R^P.charCodeAt(q++))&255];return~R}function T(P,D){for(var R=D^-1,q=P.length-15,M=0;M<q;)R=S[P[M++]^R&255]^E[P[M++]^R>>8&255]^N[P[M++]^R>>16&255]^b[P[M++]^R>>>24]^v[P[M++]]^y[P[M++]]^g[P[M++]]^x[P[M++]]^m[P[M++]]^h[P[M++]]^d[P[M++]]^f[P[M++]]^c[P[M++]]^s[P[M++]]^i[P[M++]]^r[P[M++]];for(q+=15;M<q;)R=R>>>8^r[(R^P[M++])&255];return~R}function k(P,D){for(var R=D^-1,q=0,M=P.length,z=0,ie=0;q<M;)z=P.charCodeAt(q++),z<128?R=R>>>8^r[(R^z)&255]:z<2048?(R=R>>>8^r[(R^(192|z>>6&31))&255],R=R>>>8^r[(R^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,ie=P.charCodeAt(q++)&1023,R=R>>>8^r[(R^(240|z>>8&7))&255],R=R>>>8^r[(R^(128|z>>2&63))&255],R=R>>>8^r[(R^(128|ie>>6&15|(z&3)<<4))&255],R=R>>>8^r[(R^(128|ie&63))&255]):(R=R>>>8^r[(R^(224|z>>12&15))&255],R=R>>>8^r[(R^(128|z>>6&63))&255],R=R>>>8^r[(R^(128|z&63))&255]);return~R}return e.table=r,e.bstr=C,e.buf=T,e.str=k,e})(),tt=(function(){var t={};t.version="1.2.1";function r(B,Q){for(var G=B.split("/"),Y=Q.split("/"),Z=0,ee=0,ye=Math.min(G.length,Y.length);Z<ye;++Z){if(ee=G[Z].length-Y[Z].length)return ee;if(G[Z]!=Y[Z])return G[Z]<Y[Z]?-1:1}return G.length-Y.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var Q=B.lastIndexOf("/");return Q===-1?B:B.slice(0,Q+1)}function a(B){if(B.charAt(B.length-1)=="/")return a(B.slice(0,-1));var Q=B.lastIndexOf("/");return Q===-1?B:B.slice(Q+1)}function i(B,Q){typeof Q=="string"&&(Q=new Date(Q));var G=Q.getHours();G=G<<6|Q.getMinutes(),G=G<<5|Q.getSeconds()>>>1,B.write_shift(2,G);var Y=Q.getFullYear()-1980;Y=Y<<4|Q.getMonth()+1,Y=Y<<5|Q.getDate(),B.write_shift(2,Y)}function s(B){var Q=B.read_shift(2)&65535,G=B.read_shift(2)&65535,Y=new Date,Z=G&31;G>>>=5;var ee=G&15;G>>>=4,Y.setMilliseconds(0),Y.setFullYear(G+1980),Y.setMonth(ee-1),Y.setDate(Z);var ye=Q&31;Q>>>=5;var Ee=Q&63;return Q>>>=6,Y.setHours(Q),Y.setMinutes(Ee),Y.setSeconds(ye<<1),Y}function c(B){cn(B,0);for(var Q={},G=0;B.l<=B.length-4;){var Y=B.read_shift(2),Z=B.read_shift(2),ee=B.l+Z,ye={};switch(Y){case 21589:G=B.read_shift(1),G&1&&(ye.mtime=B.read_shift(4)),Z>5&&(G&2&&(ye.atime=B.read_shift(4)),G&4&&(ye.ctime=B.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}B.l=ee,Q[Y]=ye}return Q}var f;function d(){return f||(f={})}function h(B,Q){if(B[0]==80&&B[1]==75)return tn(B,Q);if((B[0]|32)==109&&(B[1]|32)==105)return qf(B,Q);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var G=3,Y=512,Z=0,ee=0,ye=0,Ee=0,ve=0,we=[],be=B.slice(0,512);cn(be,0);var Fe=m(be);switch(G=Fe[0],G){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Fe[1]==0)return tn(B,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+G)}Y!==512&&(be=B.slice(0,Y),cn(be,28));var ze=B.slice(0,Y);x(be,G);var Ve=be.read_shift(4,"i");if(G===3&&Ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ve);be.l+=4,ye=be.read_shift(4,"i"),be.l+=4,be.chk("00100000","Mini Stream Cutoff Size: "),Ee=be.read_shift(4,"i"),Z=be.read_shift(4,"i"),ve=be.read_shift(4,"i"),ee=be.read_shift(4,"i");for(var Me=-1,Ie=0;Ie<109&&(Me=be.read_shift(4,"i"),!(Me<0));++Ie)we[Ie]=Me;var dt=g(B,Y);b(ve,ee,dt,Y,we);var Lt=E(dt,ye,we,Y);Lt[ye].name="!Directory",Z>0&&Ee!==ie&&(Lt[Ee].name="!MiniFAT"),Lt[we[0]].name="!FAT",Lt.fat_addrs=we,Lt.ssz=Y;var Ut={},hr=[],co=[],us=[];S(ye,Lt,dt,hr,Z,Ut,co,Ee),y(co,us,hr),hr.shift();var ii={FileIndex:co,FullPaths:us};return Q&&Q.raw&&(ii.raw={header:ze,sectors:dt}),ii}function m(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(ce,"Header Signature: "),B.l+=16;var Q=B.read_shift(2,"u");return[B.read_shift(2,"u"),Q]}function x(B,Q){var G=9;switch(B.l+=2,G=B.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+G);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+G);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+G)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function g(B,Q){for(var G=Math.ceil(B.length/Q)-1,Y=[],Z=1;Z<G;++Z)Y[Z-1]=B.slice(Z*Q,(Z+1)*Q);return Y[G-1]=B.slice(G*Q),Y}function y(B,Q,G){for(var Y=0,Z=0,ee=0,ye=0,Ee=0,ve=G.length,we=[],be=[];Y<ve;++Y)we[Y]=be[Y]=Y,Q[Y]=G[Y];for(;Ee<be.length;++Ee)Y=be[Ee],Z=B[Y].L,ee=B[Y].R,ye=B[Y].C,we[Y]===Y&&(Z!==-1&&we[Z]!==Z&&(we[Y]=we[Z]),ee!==-1&&we[ee]!==ee&&(we[Y]=we[ee])),ye!==-1&&(we[ye]=Y),Z!==-1&&Y!=we[Y]&&(we[Z]=we[Y],be.lastIndexOf(Z)<Ee&&be.push(Z)),ee!==-1&&Y!=we[Y]&&(we[ee]=we[Y],be.lastIndexOf(ee)<Ee&&be.push(ee));for(Y=1;Y<ve;++Y)we[Y]===Y&&(ee!==-1&&we[ee]!==ee?we[Y]=we[ee]:Z!==-1&&we[Z]!==Z&&(we[Y]=we[Z]));for(Y=1;Y<ve;++Y)if(B[Y].type!==0){if(Ee=Y,Ee!=we[Ee])do Ee=we[Ee],Q[Y]=Q[Ee]+"/"+Q[Y];while(Ee!==0&&we[Ee]!==-1&&Ee!=we[Ee]);we[Y]=-1}for(Q[0]+="/",Y=1;Y<ve;++Y)B[Y].type!==2&&(Q[Y]+="/")}function v(B,Q,G){for(var Y=B.start,Z=B.size,ee=[],ye=Y;G&&Z>0&&ye>=0;)ee.push(Q.slice(ye*z,ye*z+z)),Z-=z,ye=Co(G,ye*4);return ee.length===0?_e(0):Gr(ee).slice(0,B.size)}function b(B,Q,G,Y,Z){var ee=ie;if(B===ie){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var ye=G[B],Ee=(Y>>>2)-1;if(!ye)return;for(var ve=0;ve<Ee&&(ee=Co(ye,ve*4))!==ie;++ve)Z.push(ee);b(Co(ye,Y-4),Q-1,G,Y,Z)}}function N(B,Q,G,Y,Z){var ee=[],ye=[];Z||(Z=[]);var Ee=Y-1,ve=0,we=0;for(ve=Q;ve>=0;){Z[ve]=!0,ee[ee.length]=ve,ye.push(B[ve]);var be=G[Math.floor(ve*4/Y)];if(we=ve*4&Ee,Y<4+we)throw new Error("FAT boundary crossed: "+ve+" 4 "+Y);if(!B[be])break;ve=Co(B[be],we)}return{nodes:ee,data:xj([ye])}}function E(B,Q,G,Y){var Z=B.length,ee=[],ye=[],Ee=[],ve=[],we=Y-1,be=0,Fe=0,ze=0,Ve=0;for(be=0;be<Z;++be)if(Ee=[],ze=be+Q,ze>=Z&&(ze-=Z),!ye[ze]){ve=[];var Me=[];for(Fe=ze;Fe>=0;){Me[Fe]=!0,ye[Fe]=!0,Ee[Ee.length]=Fe,ve.push(B[Fe]);var Ie=G[Math.floor(Fe*4/Y)];if(Ve=Fe*4&we,Y<4+Ve)throw new Error("FAT boundary crossed: "+Fe+" 4 "+Y);if(!B[Ie]||(Fe=Co(B[Ie],Ve),Me[Fe]))break}ee[ze]={nodes:Ee,data:xj([ve])}}return ee}function S(B,Q,G,Y,Z,ee,ye,Ee){for(var ve=0,we=Y.length?2:0,be=Q[B].data,Fe=0,ze=0,Ve;Fe<be.length;Fe+=128){var Me=be.slice(Fe,Fe+128);cn(Me,64),ze=Me.read_shift(2),Ve=Tw(Me,0,ze-we),Y.push(Ve);var Ie={name:Ve,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},dt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);dt!==0&&(Ie.ct=C(Me,Me.l-8));var Lt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Lt!==0&&(Ie.mt=C(Me,Me.l-8)),Ie.start=Me.read_shift(4,"i"),Ie.size=Me.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=ie,Ie.name=""),Ie.type===5?(ve=Ie.start,Z>0&&ve!==ie&&(Q[ve].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",Q[Ie.start]===void 0&&(Q[Ie.start]=N(G,Ie.start,Q.fat_addrs,Q.ssz)),Q[Ie.start].name=Ie.name,Ie.content=Q[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:ve!==ie&&Ie.start!==ie&&Q[ve]&&(Ie.content=v(Ie,Q[ve].data,(Q[Ee]||{}).data))),Ie.content&&cn(Ie.content,0),ee[Ve]=Ie,ye.push(Ie)}}function C(B,Q){return new Date((sa(B,Q+4)/1e7*Math.pow(2,32)+sa(B,Q)/1e7-11644473600)*1e3)}function T(B,Q){return d(),h(f.readFileSync(B),Q)}function k(B,Q){var G=Q&&Q.type;switch(G||pt&&Buffer.isBuffer(B)&&(G="buffer"),G||"base64"){case"file":return T(B,Q);case"base64":return h(la(pa(B)),Q);case"binary":return h(la(B),Q)}return h(B,Q)}function P(B,Q){var G=Q||{},Y=G.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=Y+"/",B.FileIndex[0]={name:Y,type:5}),G.CLSID&&(B.FileIndex[0].clsid=G.CLSID),D(B)}function D(B){var Q="Sh33tJ5";if(!tt.find(B,"/"+Q)){var G=_e(4);G[0]=55,G[1]=G[3]=50,G[2]=54,B.FileIndex.push({name:Q,type:2,content:G,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+Q),R(B)}}function R(B,Q){P(B);for(var G=!1,Y=!1,Z=B.FullPaths.length-1;Z>=0;--Z){var ee=B.FileIndex[Z];switch(ee.type){case 0:Y?G=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(ee.R*ee.L*ee.C)&&(G=!0),ee.R>-1&&ee.L>-1&&ee.R==ee.L&&(G=!0);break;default:G=!0;break}}if(!(!G&&!Q)){var ye=new Date(1987,1,19),Ee=0,ve=Object.create?Object.create(null):{},we=[];for(Z=0;Z<B.FullPaths.length;++Z)ve[B.FullPaths[Z]]=!0,B.FileIndex[Z].type!==0&&we.push([B.FullPaths[Z],B.FileIndex[Z]]);for(Z=0;Z<we.length;++Z){var be=n(we[Z][0]);Y=ve[be],Y||(we.push([be,{name:a(be).replace("/",""),type:1,clsid:me,ct:ye,mt:ye,content:null}]),ve[be]=!0)}for(we.sort(function(Ve,Me){return r(Ve[0],Me[0])}),B.FullPaths=[],B.FileIndex=[],Z=0;Z<we.length;++Z)B.FullPaths[Z]=we[Z][0],B.FileIndex[Z]=we[Z][1];for(Z=0;Z<we.length;++Z){var Fe=B.FileIndex[Z],ze=B.FullPaths[Z];if(Fe.name=a(ze).replace("/",""),Fe.L=Fe.R=Fe.C=-(Fe.color=1),Fe.size=Fe.content?Fe.content.length:0,Fe.start=0,Fe.clsid=Fe.clsid||me,Z===0)Fe.C=we.length>1?1:-1,Fe.size=0,Fe.type=5;else if(ze.slice(-1)=="/"){for(Ee=Z+1;Ee<we.length&&n(B.FullPaths[Ee])!=ze;++Ee);for(Fe.C=Ee>=we.length?-1:Ee,Ee=Z+1;Ee<we.length&&n(B.FullPaths[Ee])!=n(ze);++Ee);Fe.R=Ee>=we.length?-1:Ee,Fe.type=1}else n(B.FullPaths[Z+1]||"")==n(ze)&&(Fe.R=Z+1),Fe.type=2}}}function q(B,Q){var G=Q||{};if(G.fileType=="mad")return oo(B,G);switch(R(B),G.fileType){case"zip":return $r(B,G)}var Y=(function(Ve){for(var Me=0,Ie=0,dt=0;dt<Ve.FileIndex.length;++dt){var Lt=Ve.FileIndex[dt];if(Lt.content){var Ut=Lt.content.length;Ut>0&&(Ut<4096?Me+=Ut+63>>6:Ie+=Ut+511>>9)}}for(var hr=Ve.FullPaths.length+3>>2,co=Me+7>>3,us=Me+127>>7,ii=co+Ie+hr+us,Ur=ii+127>>7,Lc=Ur<=109?0:Math.ceil((Ur-109)/127);ii+Ur+Lc+127>>7>Ur;)Lc=++Ur<=109?0:Math.ceil((Ur-109)/127);var mr=[1,Lc,Ur,us,hr,Ie,Me,0];return Ve.FileIndex[0].size=Me<<6,mr[7]=(Ve.FileIndex[0].start=mr[0]+mr[1]+mr[2]+mr[3]+mr[4]+mr[5])+(mr[6]+7>>3),mr})(B),Z=_e(Y[7]<<9),ee=0,ye=0;{for(ee=0;ee<8;++ee)Z.write_shift(1,ae[ee]);for(ee=0;ee<8;++ee)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),ee=0;ee<3;++ee)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,Y[2]),Z.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:ie),Z.write_shift(4,Y[3]),Z.write_shift(-4,Y[1]?Y[0]-1:ie),Z.write_shift(4,Y[1]),ee=0;ee<109;++ee)Z.write_shift(-4,ee<Y[2]?Y[1]+ee:-1)}if(Y[1])for(ye=0;ye<Y[1];++ye){for(;ee<236+ye*127;++ee)Z.write_shift(-4,ee<Y[2]?Y[1]+ee:-1);Z.write_shift(-4,ye===Y[1]-1?ie:ye+1)}var Ee=function(Ve){for(ye+=Ve;ee<ye-1;++ee)Z.write_shift(-4,ee+1);Ve&&(++ee,Z.write_shift(-4,ie))};for(ye=ee=0,ye+=Y[1];ee<ye;++ee)Z.write_shift(-4,de.DIFSECT);for(ye+=Y[2];ee<ye;++ee)Z.write_shift(-4,de.FATSECT);Ee(Y[3]),Ee(Y[4]);for(var ve=0,we=0,be=B.FileIndex[0];ve<B.FileIndex.length;++ve)be=B.FileIndex[ve],be.content&&(we=be.content.length,!(we<4096)&&(be.start=ye,Ee(we+511>>9)));for(Ee(Y[6]+7>>3);Z.l&511;)Z.write_shift(-4,de.ENDOFCHAIN);for(ye=ee=0,ve=0;ve<B.FileIndex.length;++ve)be=B.FileIndex[ve],be.content&&(we=be.content.length,!(!we||we>=4096)&&(be.start=ye,Ee(we+63>>6)));for(;Z.l&511;)Z.write_shift(-4,de.ENDOFCHAIN);for(ee=0;ee<Y[4]<<2;++ee){var Fe=B.FullPaths[ee];if(!Fe||Fe.length===0){for(ve=0;ve<17;++ve)Z.write_shift(4,0);for(ve=0;ve<3;++ve)Z.write_shift(4,-1);for(ve=0;ve<12;++ve)Z.write_shift(4,0);continue}be=B.FileIndex[ee],ee===0&&(be.start=be.size?be.start-1:ie);var ze=ee===0&&G.root||be.name;if(we=2*(ze.length+1),Z.write_shift(64,ze,"utf16le"),Z.write_shift(2,we),Z.write_shift(1,be.type),Z.write_shift(1,be.color),Z.write_shift(-4,be.L),Z.write_shift(-4,be.R),Z.write_shift(-4,be.C),be.clsid)Z.write_shift(16,be.clsid,"hex");else for(ve=0;ve<4;++ve)Z.write_shift(4,0);Z.write_shift(4,be.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,be.start),Z.write_shift(4,be.size),Z.write_shift(4,0)}for(ee=1;ee<B.FileIndex.length;++ee)if(be=B.FileIndex[ee],be.size>=4096)if(Z.l=be.start+1<<9,pt&&Buffer.isBuffer(be.content))be.content.copy(Z,Z.l,0,be.size),Z.l+=be.size+511&-512;else{for(ve=0;ve<be.size;++ve)Z.write_shift(1,be.content[ve]);for(;ve&511;++ve)Z.write_shift(1,0)}for(ee=1;ee<B.FileIndex.length;++ee)if(be=B.FileIndex[ee],be.size>0&&be.size<4096)if(pt&&Buffer.isBuffer(be.content))be.content.copy(Z,Z.l,0,be.size),Z.l+=be.size+63&-64;else{for(ve=0;ve<be.size;++ve)Z.write_shift(1,be.content[ve]);for(;ve&63;++ve)Z.write_shift(1,0)}if(pt)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function M(B,Q){var G=B.FullPaths.map(function(ve){return ve.toUpperCase()}),Y=G.map(function(ve){var we=ve.split("/");return we[we.length-(ve.slice(-1)=="/"?2:1)]}),Z=!1;Q.charCodeAt(0)===47?(Z=!0,Q=G[0].slice(0,-1)+Q):Z=Q.indexOf("/")!==-1;var ee=Q.toUpperCase(),ye=Z===!0?G.indexOf(ee):Y.indexOf(ee);if(ye!==-1)return B.FileIndex[ye];var Ee=!ee.match(Ou);for(ee=ee.replace(In,""),Ee&&(ee=ee.replace(Ou,"!")),ye=0;ye<G.length;++ye)if((Ee?G[ye].replace(Ou,"!"):G[ye]).replace(In,"")==ee||(Ee?Y[ye].replace(Ou,"!"):Y[ye]).replace(In,"")==ee)return B.FileIndex[ye];return null}var z=64,ie=-2,ce="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ie,FREESECT:-1,HEADER_SIGNATURE:ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function he(B,Q,G){d();var Y=q(B,G);f.writeFileSync(Q,Y)}function J(B){for(var Q=new Array(B.length),G=0;G<B.length;++G)Q[G]=String.fromCharCode(B[G]);return Q.join("")}function xe(B,Q){var G=q(B,Q);switch(Q&&Q.type||"buffer"){case"file":return d(),f.writeFileSync(Q.filename,G),G;case"binary":return typeof G=="string"?G:J(G);case"base64":return lf(typeof G=="string"?G:J(G));case"buffer":if(pt)return Buffer.isBuffer(G)?G:os(G);case"array":return typeof G=="string"?la(G):G}return G}var te;function O(B){try{var Q=B.InflateRaw,G=new Q;if(G._processChunk(new Uint8Array([3,0]),G._finishFlushFlag),G.bytesRead)te=B;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function K(B,Q){if(!te)return jr(B,Q);var G=te.InflateRaw,Y=new G,Z=Y._processChunk(B.slice(B.l),Y._finishFlushFlag);return B.l+=Y.bytesRead,Z}function W(B){return te?te.deflateRawSync(B):ut(B)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function L(B){var Q=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var U=typeof Uint8Array<"u",H=U?new Uint8Array(256):[],oe=0;oe<256;++oe)H[oe]=L(oe);function F(B,Q){var G=H[B&255];return Q<=8?G>>>8-Q:(G=G<<8|H[B>>8&255],Q<=16?G>>>16-Q:(G=G<<8|H[B>>16&255],G>>>24-Q))}function Ae(B,Q){var G=Q&7,Y=Q>>>3;return(B[Y]|(G<=6?0:B[Y+1]<<8))>>>G&3}function je(B,Q){var G=Q&7,Y=Q>>>3;return(B[Y]|(G<=5?0:B[Y+1]<<8))>>>G&7}function Le(B,Q){var G=Q&7,Y=Q>>>3;return(B[Y]|(G<=4?0:B[Y+1]<<8))>>>G&15}function Ue(B,Q){var G=Q&7,Y=Q>>>3;return(B[Y]|(G<=3?0:B[Y+1]<<8))>>>G&31}function Pe(B,Q){var G=Q&7,Y=Q>>>3;return(B[Y]|(G<=1?0:B[Y+1]<<8))>>>G&127}function ot(B,Q,G){var Y=Q&7,Z=Q>>>3,ee=(1<<G)-1,ye=B[Z]>>>Y;return G<8-Y||(ye|=B[Z+1]<<8-Y,G<16-Y)||(ye|=B[Z+2]<<16-Y,G<24-Y)||(ye|=B[Z+3]<<24-Y),ye&ee}function kt(B,Q,G){var Y=Q&7,Z=Q>>>3;return Y<=5?B[Z]|=(G&7)<<Y:(B[Z]|=G<<Y&255,B[Z+1]=(G&7)>>8-Y),Q+3}function Yt(B,Q,G){var Y=Q&7,Z=Q>>>3;return G=(G&1)<<Y,B[Z]|=G,Q+1}function jt(B,Q,G){var Y=Q&7,Z=Q>>>3;return G<<=Y,B[Z]|=G&255,G>>>=8,B[Z+1]=G,Q+8}function za(B,Q,G){var Y=Q&7,Z=Q>>>3;return G<<=Y,B[Z]|=G&255,G>>>=8,B[Z+1]=G&255,B[Z+2]=G>>>8,Q+16}function Rn(B,Q){var G=B.length,Y=2*G>Q?2*G:Q+5,Z=0;if(G>=Q)return B;if(pt){var ee=Jk(Y);if(B.copy)B.copy(ee);else for(;Z<B.length;++Z)ee[Z]=B[Z];return ee}else if(U){var ye=new Uint8Array(Y);if(ye.set)ye.set(B);else for(;Z<G;++Z)ye[Z]=B[Z];return ye}return B.length=Y,B}function Br(B){for(var Q=new Array(B),G=0;G<B;++G)Q[G]=0;return Q}function tr(B,Q,G){var Y=1,Z=0,ee=0,ye=0,Ee=0,ve=B.length,we=U?new Uint16Array(32):Br(32);for(ee=0;ee<32;++ee)we[ee]=0;for(ee=ve;ee<G;++ee)B[ee]=0;ve=B.length;var be=U?new Uint16Array(ve):Br(ve);for(ee=0;ee<ve;++ee)we[Z=B[ee]]++,Y<Z&&(Y=Z),be[ee]=0;for(we[0]=0,ee=1;ee<=Y;++ee)we[ee+16]=Ee=Ee+we[ee-1]<<1;for(ee=0;ee<ve;++ee)Ee=B[ee],Ee!=0&&(be[ee]=we[Ee+16]++);var Fe=0;for(ee=0;ee<ve;++ee)if(Fe=B[ee],Fe!=0)for(Ee=F(be[ee],Y)>>Y-Fe,ye=(1<<Y+4-Fe)-1;ye>=0;--ye)Q[Ee|ye<<Fe]=Fe&15|ee<<4;return Y}var Ln=U?new Uint16Array(512):Br(512),en=U?new Uint16Array(32):Br(32);if(!U){for(var rr=0;rr<512;++rr)Ln[rr]=0;for(rr=0;rr<32;++rr)en[rr]=0}(function(){for(var B=[],Q=0;Q<32;Q++)B.push(5);tr(B,en,32);var G=[];for(Q=0;Q<=143;Q++)G.push(8);for(;Q<=255;Q++)G.push(9);for(;Q<=279;Q++)G.push(7);for(;Q<=287;Q++)G.push(8);tr(G,Ln,288)})();var Cn=(function(){for(var Q=U?new Uint8Array(32768):[],G=0,Y=0;G<ne.length-1;++G)for(;Y<ne[G+1];++Y)Q[Y]=G;for(;Y<32768;++Y)Q[Y]=29;var Z=U?new Uint8Array(259):[];for(G=0,Y=0;G<V.length-1;++G)for(;Y<V[G+1];++Y)Z[Y]=G;function ee(Ee,ve){for(var we=0;we<Ee.length;){var be=Math.min(65535,Ee.length-we),Fe=we+be==Ee.length;for(ve.write_shift(1,+Fe),ve.write_shift(2,be),ve.write_shift(2,~be&65535);be-- >0;)ve[ve.l++]=Ee[we++]}return ve.l}function ye(Ee,ve){for(var we=0,be=0,Fe=U?new Uint16Array(32768):[];be<Ee.length;){var ze=Math.min(65535,Ee.length-be);if(ze<10){for(we=kt(ve,we,+(be+ze==Ee.length)),we&7&&(we+=8-(we&7)),ve.l=we/8|0,ve.write_shift(2,ze),ve.write_shift(2,~ze&65535);ze-- >0;)ve[ve.l++]=Ee[be++];we=ve.l*8;continue}we=kt(ve,we,+(be+ze==Ee.length)+2);for(var Ve=0;ze-- >0;){var Me=Ee[be];Ve=(Ve<<5^Me)&32767;var Ie=-1,dt=0;if((Ie=Fe[Ve])&&(Ie|=be&-32768,Ie>be&&(Ie-=32768),Ie<be))for(;Ee[Ie+dt]==Ee[be+dt]&&dt<250;)++dt;if(dt>2){Me=Z[dt],Me<=22?we=jt(ve,we,H[Me+1]>>1)-1:(jt(ve,we,3),we+=5,jt(ve,we,H[Me-23]>>5),we+=3);var Lt=Me<8?0:Me-4>>2;Lt>0&&(za(ve,we,dt-V[Me]),we+=Lt),Me=Q[be-Ie],we=jt(ve,we,H[Me]>>3),we-=3;var Ut=Me<4?0:Me-2>>1;Ut>0&&(za(ve,we,be-Ie-ne[Me]),we+=Ut);for(var hr=0;hr<dt;++hr)Fe[Ve]=be&32767,Ve=(Ve<<5^Ee[be])&32767,++be;ze-=dt-1}else Me<=143?Me=Me+48:we=Yt(ve,we,1),we=jt(ve,we,H[Me]),Fe[Ve]=be&32767,++be}we=jt(ve,we,0)-1}return ve.l=(we+7)/8|0,ve.l}return function(ve,we){return ve.length<8?ee(ve,we):ye(ve,we)}})();function ut(B){var Q=_e(50+Math.floor(B.length*1.1)),G=Cn(B,Q);return Q.slice(0,G)}var Ct=U?new Uint16Array(32768):Br(32768),se=U?new Uint16Array(32768):Br(32768),ke=U?new Uint16Array(128):Br(128),Ke=1,Je=1;function We(B,Q){var G=Ue(B,Q)+257;Q+=5;var Y=Ue(B,Q)+1;Q+=5;var Z=Le(B,Q)+4;Q+=4;for(var ee=0,ye=U?new Uint8Array(19):Br(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,we=U?new Uint8Array(8):Br(8),be=U?new Uint8Array(8):Br(8),Fe=ye.length,ze=0;ze<Z;++ze)ye[X[ze]]=ee=je(B,Q),ve<ee&&(ve=ee),we[ee]++,Q+=3;var Ve=0;for(we[0]=0,ze=1;ze<=ve;++ze)be[ze]=Ve=Ve+we[ze-1]<<1;for(ze=0;ze<Fe;++ze)(Ve=ye[ze])!=0&&(Ee[ze]=be[Ve]++);var Me=0;for(ze=0;ze<Fe;++ze)if(Me=ye[ze],Me!=0){Ve=H[Ee[ze]]>>8-Me;for(var Ie=(1<<7-Me)-1;Ie>=0;--Ie)ke[Ve|Ie<<Me]=Me&7|ze<<3}var dt=[];for(ve=1;dt.length<G+Y;)switch(Ve=ke[Pe(B,Q)],Q+=Ve&7,Ve>>>=3){case 16:for(ee=3+Ae(B,Q),Q+=2,Ve=dt[dt.length-1];ee-- >0;)dt.push(Ve);break;case 17:for(ee=3+je(B,Q),Q+=3;ee-- >0;)dt.push(0);break;case 18:for(ee=11+Pe(B,Q),Q+=7;ee-- >0;)dt.push(0);break;default:dt.push(Ve),ve<Ve&&(ve=Ve);break}var Lt=dt.slice(0,G),Ut=dt.slice(G);for(ze=G;ze<286;++ze)Lt[ze]=0;for(ze=Y;ze<30;++ze)Ut[ze]=0;return Ke=tr(Lt,Ct,286),Je=tr(Ut,se,30),Q}function at(B,Q){if(B[0]==3&&!(B[1]&3))return[Gs(Q),2];for(var G=0,Y=0,Z=Jk(Q||1<<18),ee=0,ye=Z.length>>>0,Ee=0,ve=0;(Y&1)==0;){if(Y=je(B,G),G+=3,Y>>>1)Y>>1==1?(Ee=9,ve=5):(G=We(B,G),Ee=Ke,ve=Je);else{G&7&&(G+=8-(G&7));var we=B[G>>>3]|B[(G>>>3)+1]<<8;if(G+=32,we>0)for(!Q&&ye<ee+we&&(Z=Rn(Z,ee+we),ye=Z.length);we-- >0;)Z[ee++]=B[G>>>3],G+=8;continue}for(;;){!Q&&ye<ee+32767&&(Z=Rn(Z,ee+32767),ye=Z.length);var be=ot(B,G,Ee),Fe=Y>>>1==1?Ln[be]:Ct[be];if(G+=Fe&15,Fe>>>=4,(Fe>>>8&255)===0)Z[ee++]=Fe;else{if(Fe==256)break;Fe-=257;var ze=Fe<8?0:Fe-4>>2;ze>5&&(ze=0);var Ve=ee+V[Fe];ze>0&&(Ve+=ot(B,G,ze),G+=ze),be=ot(B,G,ve),Fe=Y>>>1==1?en[be]:se[be],G+=Fe&15,Fe>>>=4;var Me=Fe<4?0:Fe-2>>1,Ie=ne[Fe];for(Me>0&&(Ie+=ot(B,G,Me),G+=Me),!Q&&ye<Ve&&(Z=Rn(Z,Ve+100),ye=Z.length);ee<Ve;)Z[ee]=Z[ee-Ie],++ee}}}return Q?[Z,G+7>>>3]:[Z.slice(0,ee),G+7>>>3]}function jr(B,Q){var G=B.slice(B.l||0),Y=at(G,Q);return B.l+=Y[1],Y[0]}function Cr(B,Q){if(B)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function tn(B,Q){var G=B;cn(G,0);var Y=[],Z=[],ee={FileIndex:Y,FullPaths:Z};P(ee,{root:Q.root});for(var ye=G.length-4;(G[ye]!=80||G[ye+1]!=75||G[ye+2]!=5||G[ye+3]!=6)&&ye>=0;)--ye;G.l=ye+4,G.l+=4;var Ee=G.read_shift(2);G.l+=6;var ve=G.read_shift(4);for(G.l=ve,ye=0;ye<Ee;++ye){G.l+=20;var we=G.read_shift(4),be=G.read_shift(4),Fe=G.read_shift(2),ze=G.read_shift(2),Ve=G.read_shift(2);G.l+=8;var Me=G.read_shift(4),Ie=c(G.slice(G.l+Fe,G.l+Fe+ze));G.l+=Fe+ze+Ve;var dt=G.l;G.l=Me+4,Ar(G,we,be,ee,Ie),G.l=dt}return ee}function Ar(B,Q,G,Y,Z){B.l+=2;var ee=B.read_shift(2),ye=B.read_shift(2),Ee=s(B);if(ee&8257)throw new Error("Unsupported ZIP encryption");for(var ve=B.read_shift(4),we=B.read_shift(4),be=B.read_shift(4),Fe=B.read_shift(2),ze=B.read_shift(2),Ve="",Me=0;Me<Fe;++Me)Ve+=String.fromCharCode(B[B.l++]);if(ze){var Ie=c(B.slice(B.l,B.l+ze));(Ie[21589]||{}).mt&&(Ee=Ie[21589].mt),((Z||{})[21589]||{}).mt&&(Ee=Z[21589].mt)}B.l+=ze;var dt=B.slice(B.l,B.l+we);switch(ye){case 8:dt=K(B,be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var Lt=!1;ee&8&&(ve=B.read_shift(4),ve==134695760&&(ve=B.read_shift(4),Lt=!0),we=B.read_shift(4),be=B.read_shift(4)),we!=Q&&Cr(Lt,"Bad compressed size: "+Q+" != "+we),be!=G&&Cr(Lt,"Bad uncompressed size: "+G+" != "+be),ji(Y,Ve,dt,{unsafe:!0,mt:Ee})}function $r(B,Q){var G=Q||{},Y=[],Z=[],ee=_e(1),ye=G.compression?8:0,Ee=0,ve=0,we=0,be=0,Fe=0,ze=B.FullPaths[0],Ve=ze,Me=B.FileIndex[0],Ie=[],dt=0;for(ve=1;ve<B.FullPaths.length;++ve)if(Ve=B.FullPaths[ve].slice(ze.length),Me=B.FileIndex[ve],!(!Me.size||!Me.content||Ve=="Sh33tJ5")){var Lt=be,Ut=_e(Ve.length);for(we=0;we<Ve.length;++we)Ut.write_shift(1,Ve.charCodeAt(we)&127);Ut=Ut.slice(0,Ut.l),Ie[Fe]=Xq.buf(Me.content,0);var hr=Me.content;ye==8&&(hr=W(hr)),ee=_e(30),ee.write_shift(4,67324752),ee.write_shift(2,20),ee.write_shift(2,Ee),ee.write_shift(2,ye),Me.mt?i(ee,Me.mt):ee.write_shift(4,0),ee.write_shift(-4,Ie[Fe]),ee.write_shift(4,hr.length),ee.write_shift(4,Me.content.length),ee.write_shift(2,Ut.length),ee.write_shift(2,0),be+=ee.length,Y.push(ee),be+=Ut.length,Y.push(Ut),be+=hr.length,Y.push(hr),ee=_e(46),ee.write_shift(4,33639248),ee.write_shift(2,0),ee.write_shift(2,20),ee.write_shift(2,Ee),ee.write_shift(2,ye),ee.write_shift(4,0),ee.write_shift(-4,Ie[Fe]),ee.write_shift(4,hr.length),ee.write_shift(4,Me.content.length),ee.write_shift(2,Ut.length),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(4,0),ee.write_shift(4,Lt),dt+=ee.l,Z.push(ee),dt+=Ut.length,Z.push(Ut),++Fe}return ee=_e(22),ee.write_shift(4,101010256),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,Fe),ee.write_shift(2,Fe),ee.write_shift(4,dt),ee.write_shift(4,be),ee.write_shift(2,0),Gr([Gr(Y),Gr(Z),ee])}var Bn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function so(B,Q){if(B.ctype)return B.ctype;var G=B.name||"",Y=G.match(/\.([^\.]+)$/);return Y&&Bn[Y[1]]||Q&&(Y=(G=Q).match(/[\.\\]([^\.\\])+$/),Y&&Bn[Y[1]])?Bn[Y[1]]:"application/octet-stream"}function Ic(B){for(var Q=lf(B),G=[],Y=0;Y<Q.length;Y+=76)G.push(Q.slice(Y,Y+76));return G.join(`\r
`)+`\r
`}function ki(B){var Q=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var be=we.charCodeAt(0).toString(16).toUpperCase();return"="+(be.length==1?"0"+be:be)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var G=[],Y=Q.split(`\r
`),Z=0;Z<Y.length;++Z){var ee=Y[Z];if(ee.length==0){G.push("");continue}for(var ye=0;ye<ee.length;){var Ee=76,ve=ee.slice(ye,ye+Ee);ve.charAt(Ee-1)=="="?Ee--:ve.charAt(Ee-2)=="="?Ee-=2:ve.charAt(Ee-3)=="="&&(Ee-=3),ve=ee.slice(ye,ye+Ee),ye+=Ee,ye<ee.length&&(ve+="="),G.push(ve)}}return G.join(`\r
`)}function Xf(B){for(var Q=[],G=0;G<B.length;++G){for(var Y=B[G];G<=B.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+B[++G];Q.push(Y)}for(var Z=0;Z<Q.length;++Z)Q[Z]=Q[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(ee){return String.fromCharCode(parseInt(ee.slice(1),16))});return la(Q.join(`\r
`))}function Mc(B,Q,G){for(var Y="",Z="",ee="",ye,Ee=0;Ee<10;++Ee){var ve=Q[Ee];if(!ve||ve.match(/^\s*$/))break;var we=ve.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":Y=we[2].trim();break;case"content-type":ee=we[2].trim();break;case"content-transfer-encoding":Z=we[2].trim();break}}switch(++Ee,Z.toLowerCase()){case"base64":ye=la(pa(Q.slice(Ee).join("")));break;case"quoted-printable":ye=Xf(Q.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var be=ji(B,Y.slice(G.length),ye,{unsafe:!0});ee&&(be.ctype=ee)}function qf(B,Q){if(J(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var G=Q&&Q.root||"",Y=(pt&&Buffer.isBuffer(B)?B.toString("binary"):J(B)).split(`\r
`),Z=0,ee="";for(Z=0;Z<Y.length;++Z)if(ee=Y[Z],!!/^Content-Location:/i.test(ee)&&(ee=ee.slice(ee.indexOf("file")),G||(G=ee.slice(0,ee.lastIndexOf("/")+1)),ee.slice(0,G.length)!=G))for(;G.length>0&&(G=G.slice(0,G.length-1),G=G.slice(0,G.lastIndexOf("/")+1),ee.slice(0,G.length)!=G););var ye=(Y[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var Ee="--"+(ye[1]||""),ve=[],we=[],be={FileIndex:ve,FullPaths:we};P(be);var Fe,ze=0;for(Z=0;Z<Y.length;++Z){var Ve=Y[Z];Ve!==Ee&&Ve!==Ee+"--"||(ze++&&Mc(be,Y.slice(Fe,Z),G),Fe=Z)}return be}function oo(B,Q){var G=Q||{},Y=G.boundary||"SheetJS";Y="------="+Y;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],ee=B.FullPaths[0],ye=ee,Ee=B.FileIndex[0],ve=1;ve<B.FullPaths.length;++ve)if(ye=B.FullPaths[ve].slice(ee.length),Ee=B.FileIndex[ve],!(!Ee.size||!Ee.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dt){return"_x"+dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dt){return"_u"+dt.charCodeAt(0).toString(16)+"_"});for(var we=Ee.content,be=pt&&Buffer.isBuffer(we)?we.toString("binary"):J(we),Fe=0,ze=Math.min(1024,be.length),Ve=0,Me=0;Me<=ze;++Me)(Ve=be.charCodeAt(Me))>=32&&Ve<128&&++Fe;var Ie=Fe>=ze*4/5;Z.push(Y),Z.push("Content-Location: "+(G.root||"file:///C:/SheetJS/")+ye),Z.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),Z.push("Content-Type: "+so(Ee,ye)),Z.push(""),Z.push(Ie?ki(be):Ic(be))}return Z.push(Y+`--\r
`),Z.join(`\r
`)}function Rc(B){var Q={};return P(Q,B),Q}function ji(B,Q,G,Y){var Z=Y&&Y.unsafe;Z||P(B);var ee=!Z&&tt.find(B,Q);if(!ee){var ye=B.FullPaths[0];Q.slice(0,ye.length)==ye?ye=Q:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+Q).replace("//","/")),ee={name:a(Q),type:2},B.FileIndex.push(ee),B.FullPaths.push(ye),Z||tt.utils.cfb_gc(B)}return ee.content=G,ee.size=G?G.length:0,Y&&(Y.CLSID&&(ee.clsid=Y.CLSID),Y.mt&&(ee.mt=Y.mt),Y.ct&&(ee.ct=Y.ct)),ee}function Cm(B,Q){P(B);var G=tt.find(B,Q);if(G){for(var Y=0;Y<B.FileIndex.length;++Y)if(B.FileIndex[Y]==G)return B.FileIndex.splice(Y,1),B.FullPaths.splice(Y,1),!0}return!1}function lo(B,Q,G){P(B);var Y=tt.find(B,Q);if(Y){for(var Z=0;Z<B.FileIndex.length;++Z)if(B.FileIndex[Z]==Y)return B.FileIndex[Z].name=a(G),B.FullPaths[Z]=G,!0}return!1}function pl(B){R(B,!0)}return t.find=M,t.read=k,t.parse=h,t.write=xe,t.writeFile=he,t.utils={cfb_new:Rc,cfb_add:ji,cfb_del:Cm,cfb_mov:lo,cfb_gc:pl,ReadShift:Bu,CheckField:zP,prep_blob:cn,bconcat:Gr,use_zlib:O,_deflateRaw:ut,_inflateRaw:jr,consts:de},t})();function qq(e){return typeof e=="string"?ym(e):Array.isArray(e)?bq(e):e}function $f(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=ym(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?gi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([qq(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=no(t)),c.write(t),c.close(),t}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+e)}function Yq(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function dr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ij(e,t){for(var r=[],n=dr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function bm(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Sm(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Jq(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Eh=new Date(1899,11,30,0,0,0);function Ir(e,t){var r=e.getTime(),n=Eh.getTime()+(e.getTimezoneOffset()-Eh.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var bP=new Date,Qq=Eh.getTime()+(bP.getTimezoneOffset()-Eh.getTimezoneOffset())*6e4,sj=bP.getTimezoneOffset();function Nm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Qq),t.getTimezoneOffset()!==sj&&t.setTime(t.getTime()+(t.getTimezoneOffset()-sj)*6e4),t}function Zq(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var oj=new Date("2017-02-19T19:06:09.000Z"),SP=isNaN(oj.getFullYear())?new Date("2/19/17"):oj,eY=SP.getFullYear()==2017;function Xt(e,t){var r=new Date(e);if(eY)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(SP.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Qo(e,t){if(pt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return gi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return gi(cP(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return gi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return gi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function qt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=qt(e[r]));return t}function ur(e,t){for(var r="";r.length<t;)r+=e;return r}function ti(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var tY=["january","february","march","april","may","june","july","august","september","october","november","december"];function xc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&tY.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var rY=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],c=1;c<i.length;++c)s.push(a),s.push(i[c]);return s}})();function NP(e){return e?e.content&&e.type?Qo(e.content,!0):e.data?Pu(e.data):e.asNodeBuffer&&pt?Pu(e.asNodeBuffer().toString("binary")):e.asBinary?Pu(e.asBinary()):e._data&&e._data.getContent?Pu(Qo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function _P(e){if(!e)return null;if(e.data)return qk(e.data);if(e.asNodeBuffer&&pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?qk(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function nY(e){return e&&e.name.slice(-4)===".bin"?_P(e):NP(e)}function Pa(e,t){for(var r=e.FullPaths||dr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function _w(e,t){var r=Pa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Nr(e,t,r){if(!r)return nY(_w(e,t));if(!t)return null;try{return Nr(e,t)}catch{return null}}function ca(e,t,r){if(!r)return NP(_w(e,t));if(!t)return null;try{return ca(e,t)}catch{return null}}function aY(e,t,r){return _P(_w(e,t))}function lj(e){for(var t=e.FullPaths||dr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function mt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return pt?n=os(r):n=Sq(r),tt.utils.cfb_add(e,t,n)}tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ew(){return tt.utils.cfb_new()}function EP(e,t){switch(t.type){case"base64":return tt.read(e,{type:"base64"});case"binary":return tt.read(e,{type:"binary"});case"buffer":case"array":return tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Fu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var wr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,iY=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,cj=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,sY=/<[^>]*>/g,jn=wr.match(cj)?cj:sY,oY=/<\w*:/,lY=/<(\/?)\w+:/;function lt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(iY),c=0,f="",d=0,h="",m="",x=1;if(s)for(d=0;d!=s.length;++d){for(m=s[d],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(h=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(x=(a=m.charCodeAt(i+1))==34||a==39?1:0,f=m.slice(i+1+x,m.length-x),c=0;c!=h.length&&h.charCodeAt(c)!==58;++c);if(c===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=f,n[h.toLowerCase()]=f;else{var g=(c===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(c+1);if(n[g]&&h.slice(c-3,c)=="ext")continue;n[g]=f,n[g.toLowerCase()]=f}}return n}function _i(e){return e.replace(lY,"<$1")}var kP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kw=bm(kP),yt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(c,f){return kP[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,f){return String.fromCharCode(parseInt(f,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}})(),jw=/[&<>'"]/g,cY=/[\u0000-\u0008\u000b-\u001f]/g;function It(e){var t=e+"";return t.replace(jw,function(r){return kw[r]}).replace(cY,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function uj(e){return It(e).replace(/ /g,"_x0020_")}var jP=/[\u0000-\u001f]/g;function Cw(e){var t=e+"";return t.replace(jw,function(r){return kw[r]}).replace(/\n/g,"<br/>").replace(jP,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function uY(e){var t=e+"";return t.replace(jw,function(r){return kw[r]}).replace(jP,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var fj=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function fY(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Gt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gg(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),c=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function dj(e){var t=Gs(2*e.length),r,n,a=1,i=0,s=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(r=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function hj(e){return os(e,"binary").toString("utf8")}var g0="foo bar baz",Rt=pt&&(hj(g0)==Gg(g0)&&hj||dj(g0)==Gg(g0)&&dj)||Gg,gi=pt?function(e){return os(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},uf=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),CP=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),dY=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),hY=/<\/?(?:vt:)?variant>/g,mY=/<(?:vt:)([^>]*)>([\s\S]*)</;function mj(e,t){var r=lt(e),n=e.match(dY(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(hY,"").match(mY);s&&a.push({v:Rt(s[2]),t:s[1]})}),a}var AP=/(^\s|\s$|\n)/;function fn(e,t){return"<"+e+(t.match(AP)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ff(e){return dr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?ff(r):"")+(t!=null?(t.match(AP)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function a1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function pY(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",It(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",It(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",a1(e));throw new Error("Unable to serialize "+e)}function Aw(e){if(pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Rt(no(bw(e)));throw new Error("Bad input format: expected Buffer or string")}var df=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Fr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},cl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ia={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function xY(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function gY(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var pj=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},xj=pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:os(t)})):pj(e)}:pj,gj=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Wi(e,a)));return n.join("").replace(In,"")},Tw=pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(In,""):gj(e,t,r)}:gj,vj=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},TP=pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):vj(e,t,r)}:vj,yj=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Vl(e,a)));return n.join("")},Uf=pt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):yj(t,r,n)}:yj,PP=function(e,t){var r=sa(e,t);return r>0?Uf(e,t+4,t+4+r-1):""},OP=PP,FP=function(e,t){var r=sa(e,t);return r>0?Uf(e,t+4,t+4+r-1):""},DP=FP,IP=function(e,t){var r=2*sa(e,t);return r>0?Uf(e,t+4,t+4+r-1):""},MP=IP,RP=function(t,r){var n=sa(t,r);return n>0?Tw(t,r+4,r+4+n):""},LP=RP,BP=function(e,t){var r=sa(e,t);return r>0?Uf(e,t+4,t+4+r):""},$P=BP,UP=function(e,t){return xY(e,t)},kh=UP,Pw=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};pt&&(OP=function(t,r){if(!Buffer.isBuffer(t))return PP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},DP=function(t,r){if(!Buffer.isBuffer(t))return FP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},MP=function(t,r){if(!Buffer.isBuffer(t))return IP(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},LP=function(t,r){if(!Buffer.isBuffer(t))return RP(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},$P=function(t,r){if(!Buffer.isBuffer(t))return BP(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},kh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):UP(t,r)},Pw=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Vl=function(e,t){return e[t]},Wi=function(e,t){return e[t+1]*256+e[t]},vY=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},sa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Co=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},yY=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Bu(e,t){var r="",n,a,i=[],s,c,f,d;switch(t){case"dbcs":if(d=this.l,pt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode(Wi(this,d)),d+=2;e*=2;break;case"utf8":r=Uf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Tw(this,this.l,this.l+e);break;case"wstr":return Bu.call(this,e,"dbcs");case"lpstr-ansi":r=OP(this,this.l),e=4+sa(this,this.l);break;case"lpstr-cp":r=DP(this,this.l),e=4+sa(this,this.l);break;case"lpwstr":r=MP(this,this.l),e=4+2*sa(this,this.l);break;case"lpp4":e=4+sa(this,this.l),r=LP(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+sa(this,this.l),r=$P(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Vl(this,this.l+e++))!==0;)i.push(x0(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Wi(this,this.l+e))!==0;)i.push(x0(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return s=Vl(this,d),this.l=d+1,c=Bu.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(x0(Wi(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return s=Vl(this,d),this.l=d+1,c=Bu.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(x0(Vl(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=Vl(this,this.l),this.l++,n;case 2:return n=(t==="i"?vY:Wi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Co:yY)(this,this.l),this.l+=4,n):(a=sa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=kh(this,this.l):a=kh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=TP(this,this.l,e);break}}return this.l+=e,r}var wY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},bY=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},SY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function NY(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)SY(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,wY(this,t,this.l);break;case 8:if(n=8,r==="f"){gY(this,t,this.l);break}case 16:break;case-4:n=4,bY(this,t,this.l);break}return this.l+=n,this}function zP(e,t){var r=TP(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function cn(e,t){e.l=t,e.read_shift=Bu,e.chk=zP,e.write_shift=NY}function kn(e,t){e.l+=t}function _e(e){var t=Gs(e);return cn(t,0),t}function ls(e,t,r){if(e){var n,a,i;cn(e,e.l||0);for(var s=e.length,c=0,f=0;e.l<s;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var d=vf[c]||vf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;f=e.l+i;var h=d.f&&d.f(e,i,r);if(e.l=f,t(h,d,c))return}}}function qn(){var e=[],t=pt?256:2048,r=function(d){var h=_e(d);return cn(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},s=function(){return a(),Gr(e)},c=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:s,_bufs:e}}function Ce(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=vf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Pw(r)&&e.push(r)}}function $u(e,t,r){var n=qt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function wj(e,t,r){var n=qt(e);return n.s=$u(n.s,t.s,r),n.e=$u(n.e,t.s,r),n}function Uu(e,t){if(e.cRel&&e.c<0)for(e=qt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=qt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=st(e);return!e.cRel&&e.cRel!=null&&(r=kY(r)),!e.rRel&&e.rRel!=null&&(r=_Y(r)),r}function Xg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sr(e.s.c)+":"+(e.e.cRel?"":"$")+sr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+vr(e.s.r)+":"+(e.e.rRel?"":"$")+vr(e.e.r):Uu(e.s,t.biff)+":"+Uu(e.e,t.biff)}function Ow(e){return parseInt(EY(e),10)-1}function vr(e){return""+(e+1)}function _Y(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function EY(e){return e.replace(/\$(\d+)$/,"$1")}function Fw(e){for(var t=jY(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function kY(e){return e.replace(/^([A-Z])/,"$$$1")}function jY(e){return e.replace(/^\$([A-Z])/,"$1")}function CY(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function or(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function st(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Jn(e){var t=e.indexOf(":");return t==-1?{s:or(e),e:or(e)}:{s:or(e.slice(0,t)),e:or(e.slice(t+1))}}function ht(e,t){return typeof t>"u"||typeof t=="number"?ht(e.s,e.e):(typeof e!="string"&&(e=st(e)),typeof t!="string"&&(t=st(t)),e==t?e:e+":"+t)}function bt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function bj(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=La(e.z,r?Ir(t):t)}catch{}try{return e.w=La((e.XF||{}).numFmtId||(r?14:0),r?Ir(t):t)}catch{return""+t}}function es(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?cs[e.v]||e.v:t==null?bj(e,e.v):bj(e,t))}function ao(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function WP(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?or(n.origin):n.origin;s=f.r,c=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=bt(i["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),s==-1&&(d.e.r=s=h.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[m].length;++x)if(!(typeof t[m][x]>"u")){var g={v:t[m][x]},y=s+m,v=c+x;if(d.s.r>y&&(d.s.r=y),d.s.c>v&&(d.s.c=v),d.e.r<y&&(d.e.r=y),d.e.c<v&&(d.e.c=v),t[m][x]&&typeof t[m][x]=="object"&&!Array.isArray(t[m][x])&&!(t[m][x]instanceof Date))g=t[m][x];else if(Array.isArray(g.v)&&(g.f=t[m][x][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||it[14],n.cellDates?(g.t="d",g.w=La(g.z,Ir(g.v))):(g.t="n",g.v=Ir(g.v),g.w=La(g.z,g.v))):g.t="s";if(a)i[y]||(i[y]=[]),i[y][v]&&i[y][v].z&&(g.z=i[y][v].z),i[y][v]=g;else{var b=st({c:v,r:y});i[b]&&i[b].z&&(g.z=i[b].z),i[b]=g}}}return d.s.c<1e7&&(i["!ref"]=ht(d)),i}function Fc(e,t){return WP(null,e,t)}function AY(e){return e.read_shift(4,"i")}function ri(e,t){return t||(t=_e(4)),t.write_shift(4,e),t}function En(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function qr(e,t){var r=!1;return t==null&&(r=!0,t=_e(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function TY(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function PY(e,t){return t||(t=_e(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Dw(e,t){var r=e.l,n=e.read_shift(1),a=En(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)i.push(TY(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function OY(e,t){var r=!1;return t==null&&(r=!0,t=_e(15+4*e.t.length)),t.write_shift(1,0),qr(e.t,t),r?t.slice(0,t.l):t}var FY=Dw;function DY(e,t){var r=!1;return t==null&&(r=!0,t=_e(23+4*e.t.length)),t.write_shift(1,1),qr(e.t,t),t.write_shift(4,1),PY({},t),r?t.slice(0,t.l):t}function Ua(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ul(e,t){return t==null&&(t=_e(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function fl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function dl(e,t){return t==null&&(t=_e(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var IY=En,HP=qr;function Iw(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function jh(e,t){var r=!1;return t==null&&(r=!0,t=_e(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var MY=En,i1=Iw,Mw=jh;function Rw(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?kh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Co(t,0)>>2;return r?a/100:a}function VP(e,t){t==null&&(t=_e(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function KP(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function RY(e,t){return t||(t=_e(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var hl=KP,Dc=RY;function Nn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zo(e,t){return(t||_e(8)).write_shift(8,e,"f")}function LY(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=Lo[a];d&&(t.rgb=mf(d));break;case 2:t.rgb=mf([s,c,f]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Ch(e,t){if(t||(t=_e(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function BY(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function $Y(e,t){t||(t=_e(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function GP(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function UY(e){return GP(e,1)}function zY(e){return GP(e,2)}var Lw=2,Gn=3,v0=11,Sj=12,Ah=19,y0=64,WY=65,HY=71,VY=4108,KY=4126,Kr=80,XP=81,GY=[Kr,XP],s1={1:{n:"CodePage",t:Lw},2:{n:"Category",t:Kr},3:{n:"PresentationFormat",t:Kr},4:{n:"ByteCount",t:Gn},5:{n:"LineCount",t:Gn},6:{n:"ParagraphCount",t:Gn},7:{n:"SlideCount",t:Gn},8:{n:"NoteCount",t:Gn},9:{n:"HiddenCount",t:Gn},10:{n:"MultimediaClipCount",t:Gn},11:{n:"ScaleCrop",t:v0},12:{n:"HeadingPairs",t:VY},13:{n:"TitlesOfParts",t:KY},14:{n:"Manager",t:Kr},15:{n:"Company",t:Kr},16:{n:"LinksUpToDate",t:v0},17:{n:"CharacterCount",t:Gn},19:{n:"SharedDoc",t:v0},22:{n:"HyperlinksChanged",t:v0},23:{n:"AppVersion",t:Gn,p:"version"},24:{n:"DigSig",t:WY},26:{n:"ContentType",t:Kr},27:{n:"ContentStatus",t:Kr},28:{n:"Language",t:Kr},29:{n:"Version",t:Kr},255:{},2147483648:{n:"Locale",t:Ah},2147483651:{n:"Behavior",t:Ah},1919054434:{}},o1={1:{n:"CodePage",t:Lw},2:{n:"Title",t:Kr},3:{n:"Subject",t:Kr},4:{n:"Author",t:Kr},5:{n:"Keywords",t:Kr},6:{n:"Comments",t:Kr},7:{n:"Template",t:Kr},8:{n:"LastAuthor",t:Kr},9:{n:"RevNumber",t:Kr},10:{n:"EditTime",t:y0},11:{n:"LastPrinted",t:y0},12:{n:"CreatedDate",t:y0},13:{n:"ModifiedDate",t:y0},14:{n:"PageCount",t:Gn},15:{n:"WordCount",t:Gn},16:{n:"CharCount",t:Gn},17:{n:"Thumbnail",t:HY},18:{n:"Application",t:Kr},19:{n:"DocSecurity",t:Gn},255:{},2147483648:{n:"Locale",t:Ah},2147483651:{n:"Behavior",t:Ah},1919054434:{}},Nj={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XY=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function qY(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var YY=qY([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Lo=qt(YY),cs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qP={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},l1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},w0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Bw(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function JY(e){var t=Bw();if(!e||!e.match)return t;var r={};if((e.match(jn)||[]).forEach(function(n){var a=lt(n);switch(a[0].replace(oY,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[l1[a.ContentType]]!==void 0&&t[l1[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Fr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function YP(e,t){var r=Jq(l1),n=[],a;n[n.length]=wr,n[n.length]=Be("Types",null,{xmlns:Fr.CT,"xmlns:xsd":Fr.xsd,"xmlns:xsi":Fr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Be("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){e[f]&&e[f].length>0&&(a=e[f][0],n[n.length]=Be("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:w0[f][t.bookType]||w0[f].xlsx}))},s=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:w0[f][t.bookType]||w0[f].xlsx})})},c=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return i("workbooks"),s("sheets"),s("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),s("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var gt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function zu(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(jn)||[]).forEach(function(a){var i=lt(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Fu(i.Target,t);r[c]=s,n[i.Id]=s}}),r["!id"]=n,r}function tc(e){var t=[wr,Be("Relationships",null,{xmlns:Fr.RELS})];return dr(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ot(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[gt.HLINK,gt.XPATH,gt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var QY="application/vnd.oasis.opendocument.spreadsheet";function ZY(e,t){for(var r=Aw(e),n,a;n=df.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=lt(n[0],!1),a.path=="/"&&a.type!==QY)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function eJ(e){var t=[wr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function _j(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function tJ(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function rJ(e){var t=[wr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(_j(e[r][0],e[r][1])),t.push(tJ("",e[r][0]));return t.push(_j("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function JP(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+bh.version+"</meta:generator></office:meta></office:document-meta>"}var Ia=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],nJ=(function(){for(var e=new Array(Ia.length),t=0;t<Ia.length;++t){var r=Ia[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function QP(e){var t={};e=Rt(e);for(var r=0;r<Ia.length;++r){var n=Ia[r],a=e.match(nJ[r]);a!=null&&a.length>0&&(t[n[1]]=yt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Xt(t[n[1]]))}return t}function qg(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=It(t),n[n.length]=r?Be(e,t,r):fn(e,t))}function ZP(e,t){var r=t||{},n=[wr,Be("cp:coreProperties",null,{"xmlns:cp":Fr.CORE_PROPS,"xmlns:dc":Fr.dc,"xmlns:dcterms":Fr.dcterms,"xmlns:dcmitype":Fr.dcmitype,"xmlns:xsi":Fr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&qg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:a1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&qg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:a1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Ia.length;++i){var s=Ia[i],c=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&qg(s[0],c,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Bo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],eO=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function tO(e,t,r,n){var a=[];if(typeof e=="string")a=mj(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(h){return{v:h}}));var s=typeof t=="string"?mj(t,n).map(function(h){return h.v}):t,c=0,f=0;if(s.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=s.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=s.slice(c,c+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=s.slice(c,c+f);break}c+=f}}function aJ(e,t,r){var n={};return t||(t={}),e=Rt(e),Bo.forEach(function(a){var i=(e.match(uf(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=yt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&tO(n.HeadingPairs,n.TitlesOfParts,t,r),t}function rO(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=wr,t[t.length]=Be("Properties",null,{xmlns:Fr.EXT_PROPS,"xmlns:vt":Fr.vt}),Bo.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=It(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+It(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var iJ=/<[^>]+>[^<]*/g;function sJ(e,t){var r={},n="",a=e.match(iJ);if(a)for(var i=0;i!=a.length;++i){var s=a[i],c=lt(s);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=yt(c.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var f=s.split(">"),d=f[0].slice(4),h=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=yt(h);break;case"bool":r[n]=Gt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Xt(h);break;case"cy":case"error":r[n]=yt(h);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,d,f)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function nO(e){var t=[wr,Be("Properties",null,{xmlns:Fr.CUST_PROPS,"xmlns:vt":Fr.vt})];if(!e)return t.join("");var r=1;return dr(e).forEach(function(a){++r,t[t.length]=Be("property",pY(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:It(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var c1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Yg;function oJ(e,t,r){Yg||(Yg=bm(c1)),t=Yg[t]||t,e[t]=r}function lJ(e,t){var r=[];return dr(c1).map(function(n){for(var a=0;a<Ia.length;++a)if(Ia[a][1]==n)return Ia[a];for(a=0;a<Bo.length;++a)if(Bo[a][1]==n)return Bo[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(fn(c1[n[1]]||n[1],a))}}),Be("DocumentProperties",r.join(""),{xmlns:ia.o})}function cJ(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&dr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Ia.length;++s)if(i==Ia[s][1])return;for(s=0;s<Bo.length;++s)if(i==Bo[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var c=e[i],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),a.push(Be(uj(i),c,{"dt:dt":f}))}}),t&&dr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],c="string";typeof s=="number"?(c="float",s=String(s)):s===!0||s===!1?(c="boolean",s=s?"1":"0"):s instanceof Date?(c="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Be(uj(i),s,{"dt:dt":c}))}}),"<"+n+' xmlns="'+ia.o+'">'+a.join("")+"</"+n+">"}function $w(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function uJ(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=_e(8);return s.write_shift(4,n),s.write_shift(4,a),s}function aO(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function iO(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function sO(e,t,r){return t===31?iO(e):aO(e,t,r)}function u1(e,t,r){return sO(e,t,r===!1?0:4)}function fJ(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return sO(e,t,0)}function dJ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(In,""),e.l-a&2&&(e.l+=2)}return r}function hJ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(In,"");return r}function mJ(e){var t=e.l,r=Th(e,XP);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Th(e,Gn);return[r,n]}function pJ(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(mJ(e));return r}function Ej(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(In,"").replace(Ou,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function oO(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function xJ(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Th(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==Sj&&n!==t&&GY.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Sj?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return aO(e,n,4).replace(In,"");case 31:return iO(e);case 64:return $w(e);case 65:return oO(e);case 71:return xJ(e);case 80:return u1(e,n,!i.raw).replace(In,"");case 81:return fJ(e,n).replace(In,"");case 4108:return pJ(e);case 4126:case 4127:return n==4127?dJ(e):hJ(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function kj(e,t){var r=_e(4),n=_e(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=_e(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=uJ(t);break;case 31:case 80:for(n=_e(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Gr([r,n])}function jj(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,c=0,f=-1,d={};for(s=0;s!=a;++s){var h=e.read_shift(4),m=e.read_shift(4);i[s]=[h,m+r]}i.sort(function(E,S){return E[1]-S[1]});var x={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var g=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,g=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],g=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],g=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(g=!1,e.l=i[s][1]),g)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var y=t[i[s][0]];if(x[y.n]=Th(e,y.t,{raw:!0}),y.p==="version"&&(x[y.n]=String(x[y.n]>>16)+"."+("0000"+String(x[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(x[y.n]){case 0:x[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Za(c=x[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[y.n])}}else if(i[s][0]===1){if(c=x.CodePage=Th(e,Lw),Za(c),f!==-1){var v=e.l;e.l=i[f][1],d=Ej(e,c),e.l=v}}else if(i[s][0]===0){if(c===0){f=s,e.l=i[s+1][1];continue}d=Ej(e,c)}else{var b=d[i[s][0]],N;switch(e[e.l]){case 65:e.l+=4,N=oO(e);break;case 30:e.l+=4,N=u1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,N=u1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,N=e.read_shift(4,"i");break;case 19:e.l+=4,N=e.read_shift(4);break;case 5:e.l+=4,N=e.read_shift(8,"f");break;case 11:e.l+=4,N=xr(e,4);break;case 64:e.l+=4,N=Xt($w(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[b]=N}}return e.l=r+n,x}var lO=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function gJ(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Cj(e,t,r){var n=_e(8),a=[],i=[],s=8,c=0,f=_e(8),d=_e(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),i.push(f),a.push(d),s+=8+f.length,!t){d=_e(8),d.write_shift(4,0),a.unshift(d);var h=[_e(4)];for(h[0].write_shift(4,e.length),c=0;c<e.length;++c){var m=e[c][0];for(f=_e(8+2*(m.length+1)+(m.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,m.length+1),f.write_shift(0,m,"dbcs");f.l!=f.length;)f.write_shift(1,0);h.push(f)}f=Gr(h),i.unshift(f),s+=8+f.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(lO.indexOf(e[c][0])>-1||eO.indexOf(e[c][0])>-1)&&e[c][1]!=null){var x=e[c][1],g=0;if(t){g=+t[e[c][0]];var y=r[g];if(y.p=="version"&&typeof x=="string"){var v=x.split(".");x=(+v[0]<<16)+(+v[1]||0)}f=kj(y.t,x)}else{var b=gJ(x);b==-1&&(b=31,x=String(x)),f=kj(b,x)}i.push(f),d=_e(8),d.write_shift(4,t?g:2+c),a.push(d),s+=8+f.length}var N=8*(i.length+1);for(c=0;c<i.length;++c)a[c].write_shift(4,N),N+=i[c].length;return n.write_shift(4,s),n.write_shift(4,i.length),Gr([n].concat(a).concat(i))}function Aj(e,t,r){var n=e.content;if(!n)return{};cn(n,0);var a,i,s,c,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),h=n.read_shift(16);if(h!==tt.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(s=n.read_shift(16),f=n.read_shift(4));var m=jj(n,t),x={SystemIdentifier:d};for(var g in m)x[g]=m[g];if(x.FMTID=i,a===1)return x;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var y;try{y=jj(n,null)}catch{}for(g in y)x[g]=y[g];return x.FMTID=[i,s],x}function Tj(e,t,r,n,a,i){var s=_e(a?68:48),c=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var f=Cj(e,r,n);if(c.push(f),a){var d=Cj(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+f.length),c.push(d)}return Gr(c)}function Ps(e,t){return e.read_shift(t),null}function vJ(e,t){t||(t=_e(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function yJ(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function xr(e,t){return e.read_shift(t)===1}function On(e,t){return t||(t=_e(2)),t.write_shift(2,+!!e),t}function _r(e){return e.read_shift(2,"u")}function Oa(e,t){return t||(t=_e(2)),t.write_shift(2,e),t}function cO(e,t){return yJ(e,t,_r)}function wJ(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function uO(e,t,r){return r||(r=_e(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function zf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function bJ(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,c,f={};a&&(s=e.read_shift(2)),n&&(c=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,d);return a&&(e.l+=4*s),n&&(e.l+=c),f.t=h,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function SJ(e){var t=e.t||"",r=_e(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=_e(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Gr(a)}function el(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Wf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):el(e,n,r)}function ml(e,t,r){if(r.biff>5)return Wf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function fO(e,t,r){return r||(r=_e(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function NJ(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function _J(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(In,"");return n&&(e.l+=24),a}function EJ(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(In,"");return r+s}function kJ(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return _J(e);case"0303000000000000c000000000000046":return EJ(e);default:throw new Error("Unsupported Moniker "+r)}}function b0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(In,""):"";return r}function Pj(e,t){t||(t=_e(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function jJ(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,c,f,d="",h,m;a&16&&(i=b0(e,r-e.l)),a&128&&(s=b0(e,r-e.l)),(a&257)===257&&(c=b0(e,r-e.l)),(a&257)===1&&(f=kJ(e,r-e.l)),a&8&&(d=b0(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(m=$w(e)),e.l=r;var x=s||c||f||"";x&&d&&(x+="#"+d),x||(x="#"+d),a&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var g={Target:x};return h&&(g.guid=h),m&&(g.time=m),i&&(g.Tooltip=i),g}function CJ(e){var t=_e(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),Pj(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var c=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&Pj(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)t.write_shift(1,n.charCodeAt(r+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function dO(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function hO(e,t){var r=dO(e);return r[3]=0,r}function Ei(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function tl(e,t,r,n){return n||(n=_e(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function AJ(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function TJ(e,t,r){return t===0?"":ml(e,t,r)}function PJ(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function mO(e){var t=e.read_shift(2),r=Rw(e);return[t,r]}function OJ(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=zf(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function _m(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function pO(e,t){return t||(t=_e(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function xO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var FJ=xO;function gO(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function DJ(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function IJ(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function xn(e){e.l+=2,e.l+=e.read_shift(2)}var MJ={0:xn,4:xn,5:xn,6:xn,7:IJ,8:xn,9:xn,10:xn,11:xn,12:xn,13:DJ,14:xn,15:xn,16:xn,17:xn,18:xn,19:xn,20:xn,21:gO};function RJ(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(MJ[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function S0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Uw(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=_e(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function LJ(e,t){return t===0||e.read_shift(2),1200}function BJ(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=ml(e,0,r);return e.read_shift(t+n-e.l),a}function $J(e,t){var r=!t||t.biff==8,n=_e(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function UJ(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function zJ(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=zf(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function WJ(e,t){var r=!t||t.biff>=8?2:1,n=_e(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function HJ(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(bJ(e));return i.Count=n,i.Unique=a,i}function VJ(e,t){var r=_e(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=SJ(e[a]);var i=Gr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function KJ(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function GJ(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function XJ(e){var t=AJ(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function qJ(e){return e.read_shift(2),e.read_shift(4)}function Oj(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function YJ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:c,Selected:f,TabRatio:d}}function JJ(){var e=_e(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function QJ(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function ZJ(e){var t=_e(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function eQ(){}function tQ(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=zf(e,0,r),n}function rQ(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=_e(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function nQ(e){var t=Ei(e);return t.isst=e.read_shift(4),t}function aQ(e,t,r,n){var a=_e(10);return tl(e,t,n,a),a.write_shift(4,r),a}function iQ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ei(e);r.biff==2&&e.l++;var i=Wf(e,n-e.l,r);return a.val=i,a}function sQ(e,t,r,n,a){var i=!a||a.biff==8,s=_e(8+ +i+(1+i)*r.length);return tl(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function oQ(e,t,r){var n=e.read_shift(2),a=ml(e,0,r);return[n,a]}function lQ(e,t,r,n){var a=r&&r.biff==5;n||(n=_e(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var cQ=ml;function Fj(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=n,{s:{r:i,c},e:{r:s,c:f}}}function uQ(e,t){var r=t.biff==8||!t.biff?4:2,n=_e(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function fQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=mO(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function dQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(mO(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function hQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function mQ(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=XY[c>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function pQ(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=mQ(e,t,n.fStyle,r),n}function Dj(e,t,r,n){var a=r&&r.biff==5;n||(n=_e(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function xQ(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function gQ(e){var t=_e(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Ij(e,t,r){var n=Ei(e);(r.biff==2||t==9)&&++e.l;var a=wJ(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function vQ(e,t,r,n,a,i){var s=_e(8);return tl(e,t,n,s),uO(r,i,s),s}function yQ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ei(e),a=Nn(e);return n.val=a,n}function wQ(e,t,r,n){var a=_e(14);return tl(e,t,n,a),Zo(r,a),a}var Mj=TJ;function bQ(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=el(e,i),c=[];n>e.l;)c.push(Wf(e));return[i,a,s,c]}function Rj(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=OJ(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var SQ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Lj(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),f=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=el(e,s,r);a&32&&(d=SQ[d.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var m=n==e.l||c===0||!(h>0)?[]:Rre(e,h,r,c);return{chKey:i,Name:d,itab:f,rgce:m}}function vO(e,t,r){if(r.biff<8)return NQ(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(PJ(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function NQ(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=zf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function _Q(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=el(e,n,r),s=el(e,a,r);return[i,s]}function EQ(e,t,r){var n=xO(e);e.l++;var a=e.read_shift(1);return t-=8,[Lre(e,t,r),a,n]}function Bj(e,t,r){var n=FJ(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Ire(e,t,r)]}function kQ(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function jQ(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=ml(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},c,s,i]}}function CQ(e,t,r){return jQ(e,t,r)}function AQ(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(_m(e));return r}function TQ(e){var t=_e(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)pO(e[r],t);return t}function PQ(e,t,r){if(r&&r.biff<8)return FQ(e,t,r);var n=gO(e),a=RJ(e,t-22,n[1]);return{cmo:n,ft:a}}var OQ={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function FQ(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((OQ[n]||kn)(e,t,r)),{cmo:[a,n,i],ft:s}}function DQ(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=NJ(e,6,r);var c=e.read_shift(2);e.read_shift(2),_r(e,2);var f=e.read_shift(2);e.l+=f;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var h=e[e.l],m=el(e,e.lens[d+1]-e.lens[d]-1);if(a+=m,a.length>=(h?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function IQ(e,t){var r=_m(e);e.l+=16;var n=jJ(e,t-24);return[r,n]}function MQ(e){var t=_e(24),r=or(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Gr([t,CJ(e[1])])}function RQ(e,t){e.read_shift(2);var r=_m(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(In,""),[r,n]}function LQ(e){var t=e[1].Tooltip,r=_e(10+2*(t.length+1));r.write_shift(2,2048);var n=or(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function BQ(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Nj[r]||r,r=e.read_shift(2),t[1]=Nj[r]||r,t}function $Q(e){return e||(e=_e(4)),e.write_shift(2,1),e.write_shift(2,1),e}function UQ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(hO(e));return r}function zQ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(hO(e));return r}function WQ(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function yO(e,t,r){if(!r.cellStyles)return kn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:s,ixfe:c,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function HQ(e,t){var r=_e(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function VQ(e,t){var r={};return t<32||(e.l+=16,r.header=Nn(e),r.footer=Nn(e),e.l+=2),r}function KQ(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function GQ(e){for(var t=_e(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var XQ=Ei,qQ=cO,YQ=Wf;function JQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function QQ(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ei(e);++e.l;var a=ml(e,t-7,r);return n.t="str",n.val=a,n}function ZQ(e){var t=Ei(e);++e.l;var r=Nn(e);return t.t="n",t.val=r,t}function eZ(e,t,r){var n=_e(15);return Gf(n,e,t),n.write_shift(8,r,"f"),n}function tZ(e){var t=Ei(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function rZ(e,t,r){var n=_e(9);return Gf(n,e,t),n.write_shift(2,r),n}function nZ(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function aZ(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function iZ(e,t,r){var n=e.l+t,a=Ei(e),i=e.read_shift(2),s=el(e,i,r);return e.l=n,a.t="str",a.val=s,a}var sZ=[2,3,48,49,131,139,140,245],f1=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=bm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,f){var d=[],h=Gs(1);switch(f.type){case"base64":h=la(pa(c));break;case"binary":h=la(c);break;case"buffer":case"array":h=c;break}cn(h,0);var m=h.read_shift(1),x=!!(m&136),g=!1,y=!1;switch(m){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var v=0,b=521;m==2&&(v=h.read_shift(2)),h.l+=3,m!=2&&(v=h.read_shift(4)),v>1048576&&(v=1e6),m!=2&&(b=h.read_shift(2));var N=h.read_shift(2),E=f.codepage||1252;m!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(E=e[h[h.l]]),h.l+=1,h.l+=2),y&&(h.l+=36);for(var S=[],C={},T=Math.min(h.length,m==2?521:b-10-(g?264:0)),k=y?32:11;h.l<T&&h[h.l]!=13;)switch(C={},C.name=of.utils.decode(E,h.slice(h.l,h.l+k)).replace(/[\u0000\r\n].*$/g,""),h.l+=k,C.type=String.fromCharCode(h.read_shift(1)),m!=2&&!y&&(C.offset=h.read_shift(4)),C.len=h.read_shift(1),m==2&&(C.offset=h.read_shift(2)),C.dec=h.read_shift(1),C.name.length&&S.push(C),m!=2&&(h.l+=y?13:14),C.type){case"B":(!g||C.len!=8)&&f.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(h[h.l]!==13&&(h.l=b-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=b;var P=0,D=0;for(d[0]=[],D=0;D!=S.length;++D)d[0][D]=S[D].name;for(;v-- >0;){if(h[h.l]===42){h.l+=N;continue}for(++h.l,d[++P]=[],D=0,D=0;D!=S.length;++D){var R=h.slice(h.l,h.l+S[D].len);h.l+=S[D].len,cn(R,0);var q=of.utils.decode(E,R);switch(S[D].type){case"C":q.trim().length&&(d[P][D]=q.replace(/\s+$/,""));break;case"D":q.length===8?d[P][D]=new Date(+q.slice(0,4),+q.slice(4,6)-1,+q.slice(6,8)):d[P][D]=q;break;case"F":d[P][D]=parseFloat(q.trim());break;case"+":case"I":d[P][D]=y?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(q.trim().toUpperCase()){case"Y":case"T":d[P][D]=!0;break;case"N":case"F":d[P][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+q+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[P][D]="##MEMO##"+(y?parseInt(q.trim(),10):R.read_shift(4));break;case"N":q=q.replace(/\u0000/g,"").trim(),q&&q!="."&&(d[P][D]=+q||0);break;case"@":d[P][D]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":d[P][D]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":d[P][D]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[P][D]=-R.read_shift(-8,"f");break;case"B":if(g&&S[D].len==8){d[P][D]=R.read_shift(8,"f");break}case"G":case"P":R.l+=S[D].len;break;case"0":if(S[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[D].type)}}}if(m!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=S,d}function n(c,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var h=Fc(r(c,d),d);return h["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,h}function a(c,f){try{return ao(n(c,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(c,f){var d=f||{};if(+d.codepage>=0&&Za(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=qn(),m=Fh(c,{header:1,raw:!0,cellDates:!0}),x=m[0],g=m.slice(1),y=c["!cols"]||[],v=0,b=0,N=0,E=1;for(v=0;v<x.length;++v){if(((y[v]||{}).DBF||{}).name){x[v]=y[v].DBF.name,++N;continue}if(x[v]!=null){if(++N,typeof x[v]=="number"&&(x[v]=x[v].toString(10)),typeof x[v]!="string")throw new Error("DBF Invalid column name "+x[v]+" |"+typeof x[v]+"|");if(x.indexOf(x[v])!==v){for(b=0;b<1024;++b)if(x.indexOf(x[v]+"_"+b)==-1){x[v]+="_"+b;break}}}}var S=bt(c["!ref"]),C=[],T=[],k=[];for(v=0;v<=S.e.c-S.s.c;++v){var P="",D="",R=0,q=[];for(b=0;b<g.length;++b)g[b][v]!=null&&q.push(g[b][v]);if(q.length==0||x[v]==null){C[v]="?";continue}for(b=0;b<q.length;++b){switch(typeof q[b]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=q[b]instanceof Date?"D":"C";break;default:D="C"}R=Math.max(R,String(q[b]).length),P=P&&P!=D?"C":D}R>250&&(R=250),D=((y[v]||{}).DBF||{}).type,D=="C"&&y[v].DBF.len>R&&(R=y[v].DBF.len),P=="B"&&D=="N"&&(P="N",k[v]=y[v].DBF.dec,R=y[v].DBF.len),T[v]=P=="C"||D=="N"?R:i[P]||0,E+=T[v],C[v]=P}var M=h.next(32);for(M.write_shift(4,318902576),M.write_shift(4,g.length),M.write_shift(2,296+32*N),M.write_shift(2,E),v=0;v<4;++v)M.write_shift(4,0);for(M.write_shift(4,0|(+t[lP]||3)<<8),v=0,b=0;v<x.length;++v)if(x[v]!=null){var z=h.next(32),ie=(x[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,ie,"sbcs"),z.write_shift(1,C[v]=="?"?"C":C[v],"sbcs"),z.write_shift(4,b),z.write_shift(1,T[v]||i[C[v]]||0),z.write_shift(1,k[v]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),b+=T[v]||i[C[v]]||0}var ce=h.next(264);for(ce.write_shift(4,13),v=0;v<65;++v)ce.write_shift(4,0);for(v=0;v<g.length;++v){var ae=h.next(E);for(ae.write_shift(1,0),b=0;b<x.length;++b)if(x[b]!=null)switch(C[b]){case"L":ae.write_shift(1,g[v][b]==null?63:g[v][b]?84:70);break;case"B":ae.write_shift(8,g[v][b]||0,"f");break;case"N":var me="0";for(typeof g[v][b]=="number"&&(me=g[v][b].toFixed(k[b]||0)),N=0;N<T[b]-me.length;++N)ae.write_shift(1,32);ae.write_shift(1,me,"sbcs");break;case"D":g[v][b]?(ae.write_shift(4,("0000"+g[v][b].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(g[v][b].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+g[v][b].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var de=String(g[v][b]!=null?g[v][b]:"").slice(0,T[b]);for(ae.write_shift(1,de,"sbcs"),N=0;N<T[b]-de.length;++N)ae.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),wO=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+dr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,g){var y=e[g];return typeof y=="number"?Yk(y):y},n=function(x,g,y){var v=g.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return v==59?x:Yk(v)};e["|"]=254;function a(x,g){switch(g.type){case"base64":return i(pa(x),g);case"binary":return i(x,g);case"buffer":return i(pt&&Buffer.isBuffer(x)?x.toString("binary"):no(x),g);case"array":return i(Qo(x),g)}throw new Error("Unrecognized type "+g.type)}function i(x,g){var y=x.split(/[\n\r]+/),v=-1,b=-1,N=0,E=0,S=[],C=[],T=null,k={},P=[],D=[],R=[],q=0,M;for(+g.codepage>=0&&Za(+g.codepage);N!==y.length;++N){q=0;var z=y[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ie=z.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),ce=ie[0],ae;if(z.length>0)switch(ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ie[1].charAt(0)=="P"&&C.push(z.slice(3).replace(/;;/g,";"));break;case"C":var me=!1,de=!1,he=!1,J=!1,xe=-1,te=-1;for(E=1;E<ie.length;++E)switch(ie[E].charAt(0)){case"A":break;case"X":b=parseInt(ie[E].slice(1))-1,de=!0;break;case"Y":for(v=parseInt(ie[E].slice(1))-1,de||(b=0),M=S.length;M<=v;++M)S[M]=[];break;case"K":ae=ie[E].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(ti(ae))?isNaN(xc(ae).getDate())||(ae=Xt(ae)):(ae=ti(ae),T!==null&&Pc(T)&&(ae=Nm(ae))),me=!0;break;case"E":J=!0;var O=rc(ie[E].slice(1),{r:v,c:b});S[v][b]=[S[v][b],O];break;case"S":he=!0,S[v][b]=[S[v][b],"S5S"];break;case"G":break;case"R":xe=parseInt(ie[E].slice(1))-1;break;case"C":te=parseInt(ie[E].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+z)}if(me&&(S[v][b]&&S[v][b].length==2?S[v][b][0]=ae:S[v][b]=ae,T=null),he){if(J)throw new Error("SYLK shared formula cannot have own formula");var K=xe>-1&&S[xe][te];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");S[v][b][1]=LO(K[1],{r:v-xe,c:b-te})}break;case"F":var W=0;for(E=1;E<ie.length;++E)switch(ie[E].charAt(0)){case"X":b=parseInt(ie[E].slice(1))-1,++W;break;case"Y":for(v=parseInt(ie[E].slice(1))-1,M=S.length;M<=v;++M)S[M]=[];break;case"M":q=parseInt(ie[E].slice(1))/20;break;case"F":break;case"G":break;case"P":T=C[parseInt(ie[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=ie[E].slice(1).split(" "),M=parseInt(R[0],10);M<=parseInt(R[1],10);++M)q=parseInt(R[2],10),D[M-1]=q===0?{hidden:!0}:{wch:q},Xs(D[M-1]);break;case"C":b=parseInt(ie[E].slice(1))-1,D[b]||(D[b]={});break;case"R":v=parseInt(ie[E].slice(1))-1,P[v]||(P[v]={}),q>0?(P[v].hpt=q,P[v].hpx=vc(q)):q===0&&(P[v].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+z)}W<1&&(T=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+z)}}return P.length>0&&(k["!rows"]=P),D.length>0&&(k["!cols"]=D),g&&g.sheetRows&&(S=S.slice(0,g.sheetRows)),[S,k]}function s(x,g){var y=a(x,g),v=y[0],b=y[1],N=Fc(v,g);return dr(b).forEach(function(E){N[E]=b[E]}),N}function c(x,g){return ao(s(x,g),g)}function f(x,g,y,v){var b="C;Y"+(y+1)+";X"+(v+1)+";K";switch(x.t){case"n":b+=x.v||0,x.f&&!x.F&&(b+=";E"+Gw(x.f,{r:y,c:v}));break;case"b":b+=x.v?"TRUE":"FALSE";break;case"e":b+=x.w||x.v;break;case"d":b+='"'+(x.w||x.v)+'"';break;case"s":b+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(x,g){g.forEach(function(y,v){var b="F;W"+(v+1)+" "+(v+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=pf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=xf(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&x.push(b)})}function h(x,g){g.forEach(function(y,v){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*gf(y.hpx)+";"),b.length>2&&x.push(b+"R"+(v+1))})}function m(x,g){var y=["ID;PWXL;N;E"],v=[],b=bt(x["!ref"]),N,E=Array.isArray(x),S=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),x["!cols"]&&d(y,x["!cols"]),x["!rows"]&&h(y,x["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var C=b.s.r;C<=b.e.r;++C)for(var T=b.s.c;T<=b.e.c;++T){var k=st({r:C,c:T});N=E?(x[C]||[])[T]:x[k],!(!N||N.v==null&&(!N.f||N.F))&&v.push(f(N,x,C,T))}return y.join(S)+S+v.join(S)+S+"E"+S}return{to_workbook:c,to_sheet:s,from_sheet:m}})(),bO=(function(){function e(i,s){switch(s.type){case"base64":return t(pa(i),s);case"binary":return t(i,s);case"buffer":return t(pt&&Buffer.isBuffer(i)?i.toString("binary"):no(i),s);case"array":return t(Qo(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var c=i.split(`
`),f=-1,d=-1,h=0,m=[];h!==c.length;++h){if(c[h].trim()==="BOT"){m[++f]=[],d=0;continue}if(!(f<0)){var x=c[h].trim().split(","),g=x[0],y=x[1];++h;for(var v=c[h]||"";(v.match(/["]/g)||[]).length&1&&h<c.length-1;)v+=`
`+c[++h];switch(v=v.trim(),+g){case-1:if(v==="BOT"){m[++f]=[],d=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?m[f][d]=!0:v==="FALSE"?m[f][d]=!1:isNaN(ti(y))?isNaN(xc(y).getDate())?m[f][d]=y:m[f][d]=Xt(y):m[f][d]=ti(y),++d;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),m[f][d++]=v!==""?v:null;break}if(v==="EOD")break}}return s&&s.sheetRows&&(m=m.slice(0,s.sheetRows)),m}function r(i,s){return Fc(e(i,s),s)}function n(i,s){return ao(r(i,s),s)}var a=(function(){var i=function(f,d,h,m,x){f.push(d),f.push(h+","+m),f.push('"'+x.replace(/"/g,'""')+'"')},s=function(f,d,h,m){f.push(d+","+h),f.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var d=[],h=bt(f["!ref"]),m,x=Array.isArray(f);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,h.e.r-h.s.r+1,""),i(d,"TUPLES",0,h.e.c-h.s.c+1,""),i(d,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){s(d,-1,0,"BOT");for(var y=h.s.c;y<=h.e.c;++y){var v=st({r:g,c:y});if(m=x?(f[g]||[])[y]:f[v],!m){s(d,1,0,"");continue}switch(m.t){case"n":var b=m.w;!b&&m.v!=null&&(b=m.v),b==null?m.f&&!m.F?s(d,1,0,"="+m.f):s(d,1,0,""):s(d,0,b,"V");break;case"b":s(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":s(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=La(m.z||it[14],Ir(Xt(m.v)))),s(d,0,m.w,"V");break;default:s(d,1,0,"")}}}s(d,-1,0,"EOD");var N=`\r
`,E=d.join(N);return E}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),SO=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,x){for(var g=m.split(`
`),y=-1,v=-1,b=0,N=[];b!==g.length;++b){var E=g[b].trim().split(":");if(E[0]==="cell"){var S=or(E[1]);if(N.length<=S.r)for(y=N.length;y<=S.r;++y)N[y]||(N[y]=[]);switch(y=S.r,v=S.c,E[2]){case"t":N[y][v]=e(E[3]);break;case"v":N[y][v]=+E[3];break;case"vtf":var C=E[E.length-1];case"vtc":switch(E[3]){case"nl":N[y][v]=!!+E[4];break;default:N[y][v]=+E[4];break}E[2]=="vtf"&&(N[y][v]=[N[y][v],C])}}}return x&&x.sheetRows&&(N=N.slice(0,x.sheetRows)),N}function n(m,x){return Fc(r(m,x),x)}function a(m,x){return ao(n(m,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var x=[],g=[],y,v="",b=Jn(m["!ref"]),N=Array.isArray(m),E=b.s.r;E<=b.e.r;++E)for(var S=b.s.c;S<=b.e.c;++S)if(v=st({r:E,c:S}),y=N?(m[E]||[])[S]:m[v],!(!y||y.v==null||y.t==="z")){switch(g=["cell",v,"t"],y.t){case"s":case"str":g.push(t(y.v));break;case"n":y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=t(y.f)):(g[2]="v",g[3]=y.v);break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var C=Ir(Xt(y.v));g[2]="vtc",g[3]="nd",g[4]=""+C,g[5]=y.w||La(y.z||it[14],C);break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(m){return[i,s,c,s,d(m),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}})(),gc=(function(){function e(h,m,x,g,y){y.raw?m[x][g]=h:h===""||(h==="TRUE"?m[x][g]=!0:h==="FALSE"?m[x][g]=!1:isNaN(ti(h))?isNaN(xc(h).getDate())?m[x][g]=h:m[x][g]=Xt(h):m[x][g]=ti(h))}function t(h,m){var x=m||{},g=[];if(!h||h.length===0)return g;for(var y=h.split(/[\r\n]/),v=y.length-1;v>=0&&y[v].length===0;)--v;for(var b=10,N=0,E=0;E<=v;++E)N=y[E].indexOf(" "),N==-1?N=y[E].length:N++,b=Math.max(b,N);for(E=0;E<=v;++E){g[E]=[];var S=0;for(e(y[E].slice(0,b).trim(),g,E,S,x),S=1;S<=(y[E].length-b)/10+1;++S)e(y[E].slice(b+(S-1)*10,b+S*10).trim(),g,E,S,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var m={},x=!1,g=0,y=0;g<h.length;++g)(y=h.charCodeAt(g))==34?x=!x:!x&&y in r&&(m[y]=(m[y]||0)+1);y=[];for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&y.push([m[g],g]);if(!y.length){m=n;for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&y.push([m[g],g])}return y.sort(function(v,b){return v[0]-b[0]||n[v[1]]-n[b[1]]}),r[y.pop()[1]]||44}function i(h,m){var x=m||{},g="",y=x.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=a(h.slice(0,1024)):x&&x.FS?g=x.FS:g=a(h.slice(0,1024));var b=0,N=0,E=0,S=0,C=0,T=g.charCodeAt(0),k=!1,P=0,D=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var R=x.dateNF!=null?Kq(x.dateNF):null;function q(){var M=h.slice(S,C),z={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)z.t="z";else if(x.raw)z.t="s",z.v=M;else if(M.trim().length===0)z.t="s",z.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(z.t="s",z.v=M.slice(2,-1).replace(/""/g,'"')):bte(M)?(z.t="n",z.f=M.slice(1)):(z.t="s",z.v=M);else if(M=="TRUE")z.t="b",z.v=!0;else if(M=="FALSE")z.t="b",z.v=!1;else if(!isNaN(E=ti(M)))z.t="n",x.cellText!==!1&&(z.w=M),z.v=E;else if(!isNaN(xc(M).getDate())||R&&M.match(R)){z.z=x.dateNF||it[14];var ie=0;R&&M.match(R)&&(M=Gq(M,x.dateNF,M.match(R)||[]),ie=1),x.cellDates?(z.t="d",z.v=Xt(M,ie)):(z.t="n",z.v=Ir(Xt(M,ie))),x.cellText!==!1&&(z.w=La(z.z,z.v instanceof Date?Ir(z.v):z.v)),x.cellNF||delete z.z}else z.t="s",z.v=M;if(z.t=="z"||(x.dense?(y[b]||(y[b]=[]),y[b][N]=z):y[st({c:N,r:b})]=z),S=C+1,D=h.charCodeAt(S),v.e.c<N&&(v.e.c=N),v.e.r<b&&(v.e.r=b),P==T)++N;else if(N=0,++b,x.sheetRows&&x.sheetRows<=b)return!0}e:for(;C<h.length;++C)switch(P=h.charCodeAt(C)){case 34:D===34&&(k=!k);break;case T:case 10:case 13:if(!k&&q())break e;break}return C-S>0&&q(),y["!ref"]=ht(v),y}function s(h,m){return!(m&&m.PRN)||m.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,m):Fc(t(h,m),m)}function c(h,m){var x="",g=m.type=="string"?[0,0,0,0]:tb(h,m);switch(m.type){case"base64":x=pa(h);break;case"binary":x=h;break;case"buffer":m.codepage==65001?x=h.toString("utf8"):m.codepage&&typeof of<"u"||(x=pt&&Buffer.isBuffer(h)?h.toString("binary"):no(h));break;case"array":x=Qo(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+m.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=Rt(x.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?x=Rt(x):m.type=="binary"&&typeof of<"u",x.slice(0,19)=="socialcalc:version:"?SO.to_sheet(m.type=="string"?x:Rt(x),m):s(x,m)}function f(h,m){return ao(c(h,m),m)}function d(h){for(var m=[],x=bt(h["!ref"]),g,y=Array.isArray(h),v=x.s.r;v<=x.e.r;++v){for(var b=[],N=x.s.c;N<=x.e.c;++N){var E=st({r:v,c:N});if(g=y?(h[v]||[])[N]:h[E],!g||g.v==null){b.push("          ");continue}for(var S=(g.w||(es(g),g.w)||"").slice(0,10);S.length<10;)S+=" ";b.push(S+(N===0?" ":""))}m.push(b.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:d}})();function oZ(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=wO.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return gc.to_workbook(e,t)}}var $o=(function(){function e(O,K,W){if(O){cn(O,O.l||0);for(var X=W.Enum||xe;O.l<O.length;){var V=O.read_shift(2),ne=X[V]||X[65535],L=O.read_shift(2),U=O.l+L,H=ne.f&&ne.f(O,L,W);if(O.l=U,K(H,ne,V))return}}}function t(O,K){switch(K.type){case"base64":return r(la(pa(O)),K);case"binary":return r(la(O),K);case"buffer":case"array":return r(O,K)}throw"Unsupported type "+K.type}function r(O,K){if(!O)return O;var W=K||{},X=W.dense?[]:{},V="Sheet1",ne="",L=0,U={},H=[],oe=[],F={s:{r:0,c:0},e:{r:0,c:0}},Ae=W.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)W.Enum=xe,e(O,function(Pe,ot,kt){switch(kt){case 0:W.vers=Pe,Pe>=4096&&(W.qpro=!0);break;case 6:F=Pe;break;case 204:Pe&&(ne=Pe);break;case 222:ne=Pe;break;case 15:case 51:W.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:kt==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=W.dateNF||it[14],W.cellDates&&(Pe[1].t="d",Pe[1].v=Nm(Pe[1].v))),W.qpro&&Pe[3]>L&&(X["!ref"]=ht(F),U[V]=X,H.push(V),X=W.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},L=Pe[3],V=ne||"Sheet"+(L+1),ne="");var Yt=W.dense?(X[Pe[0].r]||[])[Pe[0].c]:X[st(Pe[0])];if(Yt){Yt.t=Pe[1].t,Yt.v=Pe[1].v,Pe[1].z!=null&&(Yt.z=Pe[1].z),Pe[1].f!=null&&(Yt.f=Pe[1].f);break}W.dense?(X[Pe[0].r]||(X[Pe[0].r]=[]),X[Pe[0].r][Pe[0].c]=Pe[1]):X[st(Pe[0])]=Pe[1];break}},W);else if(O[2]==26||O[2]==14)W.Enum=te,O[2]==14&&(W.qpro=!0,O.l=0),e(O,function(Pe,ot,kt){switch(kt){case 204:V=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>L&&(X["!ref"]=ht(F),U[V]=X,H.push(V),X=W.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},L=Pe[3],V="Sheet"+(L+1)),Ae>0&&Pe[0].r>=Ae)break;W.dense?(X[Pe[0].r]||(X[Pe[0].r]=[]),X[Pe[0].r][Pe[0].c]=Pe[1]):X[st(Pe[0])]=Pe[1],F.e.c<Pe[0].c&&(F.e.c=Pe[0].c),F.e.r<Pe[0].r&&(F.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(oe[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:oe[Pe[0]]=Pe[1],Pe[0]==L&&(V=Pe[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(X["!ref"]=ht(F),U[ne||V]=X,H.push(ne||V),!oe.length)return{SheetNames:H,Sheets:U};for(var je={},Le=[],Ue=0;Ue<oe.length;++Ue)U[H[Ue]]?(Le.push(oe[Ue]||H[Ue]),je[oe[Ue]]=U[oe[Ue]]||U[H[Ue]]):(Le.push(oe[Ue]),je[oe[Ue]]={"!ref":"A1"});return{SheetNames:Le,Sheets:je}}function n(O,K){var W=K||{};if(+W.codepage>=0&&Za(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var X=qn(),V=bt(O["!ref"]),ne=Array.isArray(O),L=[];$e(X,0,i(1030)),$e(X,6,f(V));for(var U=Math.min(V.e.r,8191),H=V.s.r;H<=U;++H)for(var oe=vr(H),F=V.s.c;F<=V.e.c;++F){H===V.s.r&&(L[F]=sr(F));var Ae=L[F]+oe,je=ne?(O[H]||[])[F]:O[Ae];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?$e(X,13,g(H,F,je.v)):$e(X,14,v(H,F,je.v));else{var Le=es(je);$e(X,15,m(H,F,Le.slice(0,239)))}}return $e(X,1),X.end()}function a(O,K){var W=K||{};if(+W.codepage>=0&&Za(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var X=qn();$e(X,0,s(O));for(var V=0,ne=0;V<O.SheetNames.length;++V)(O.Sheets[O.SheetNames[V]]||{})["!ref"]&&$e(X,27,J(O.SheetNames[V],ne++));var L=0;for(V=0;V<O.SheetNames.length;++V){var U=O.Sheets[O.SheetNames[V]];if(!(!U||!U["!ref"])){for(var H=bt(U["!ref"]),oe=Array.isArray(U),F=[],Ae=Math.min(H.e.r,8191),je=H.s.r;je<=Ae;++je)for(var Le=vr(je),Ue=H.s.c;Ue<=H.e.c;++Ue){je===H.s.r&&(F[Ue]=sr(Ue));var Pe=F[Ue]+Le,ot=oe?(U[je]||[])[Ue]:U[Pe];if(!(!ot||ot.t=="z"))if(ot.t=="n")$e(X,23,q(je,Ue,L,ot.v));else{var kt=es(ot);$e(X,22,P(je,Ue,L,kt.slice(0,239)))}}++L}}return $e(X,1),X.end()}function i(O){var K=_e(2);return K.write_shift(2,O),K}function s(O){var K=_e(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var W=0,X=0,V=0,ne=0;ne<O.SheetNames.length;++ne){var L=O.SheetNames[ne],U=O.Sheets[L];if(!(!U||!U["!ref"])){++V;var H=Jn(U["!ref"]);W<H.e.r&&(W=H.e.r),X<H.e.c&&(X=H.e.c)}}return W>8191&&(W=8191),K.write_shift(2,W),K.write_shift(1,V),K.write_shift(1,X),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function c(O,K,W){var X={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&W.qpro?(X.s.c=O.read_shift(1),O.l++,X.s.r=O.read_shift(2),X.e.c=O.read_shift(1),O.l++,X.e.r=O.read_shift(2),X):(X.s.c=O.read_shift(2),X.s.r=O.read_shift(2),K==12&&W.qpro&&(O.l+=2),X.e.c=O.read_shift(2),X.e.r=O.read_shift(2),K==12&&W.qpro&&(O.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function f(O){var K=_e(8);return K.write_shift(2,O.s.c),K.write_shift(2,O.s.r),K.write_shift(2,O.e.c),K.write_shift(2,O.e.r),K}function d(O,K,W){var X=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(X[0].c=O.read_shift(1),X[3]=O.read_shift(1),X[0].r=O.read_shift(2),O.l+=2):(X[2]=O.read_shift(1),X[0].c=O.read_shift(2),X[0].r=O.read_shift(2)),X}function h(O,K,W){var X=O.l+K,V=d(O,K,W);if(V[1].t="s",W.vers==20768){O.l++;var ne=O.read_shift(1);return V[1].v=O.read_shift(ne,"utf8"),V}return W.qpro&&O.l++,V[1].v=O.read_shift(X-O.l,"cstr"),V}function m(O,K,W){var X=_e(7+W.length);X.write_shift(1,255),X.write_shift(2,K),X.write_shift(2,O),X.write_shift(1,39);for(var V=0;V<X.length;++V){var ne=W.charCodeAt(V);X.write_shift(1,ne>=128?95:ne)}return X.write_shift(1,0),X}function x(O,K,W){var X=d(O,K,W);return X[1].v=O.read_shift(2,"i"),X}function g(O,K,W){var X=_e(7);return X.write_shift(1,255),X.write_shift(2,K),X.write_shift(2,O),X.write_shift(2,W,"i"),X}function y(O,K,W){var X=d(O,K,W);return X[1].v=O.read_shift(8,"f"),X}function v(O,K,W){var X=_e(13);return X.write_shift(1,255),X.write_shift(2,K),X.write_shift(2,O),X.write_shift(8,W,"f"),X}function b(O,K,W){var X=O.l+K,V=d(O,K,W);if(V[1].v=O.read_shift(8,"f"),W.qpro)O.l=X;else{var ne=O.read_shift(2);C(O.slice(O.l,O.l+ne),V),O.l+=ne}return V}function N(O,K,W){var X=K&32768;return K&=-32769,K=(X?O:0)+(K>=8192?K-16384:K),(X?"":"$")+(W?sr(K):vr(K))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(O,K){cn(O,0);for(var W=[],X=0,V="",ne="",L="",U="";O.l<O.length;){var H=O[O.l++];switch(H){case 0:W.push(O.read_shift(8,"f"));break;case 1:ne=N(K[0].c,O.read_shift(2),!0),V=N(K[0].r,O.read_shift(2),!1),W.push(ne+V);break;case 2:{var oe=N(K[0].c,O.read_shift(2),!0),F=N(K[0].r,O.read_shift(2),!1);ne=N(K[0].c,O.read_shift(2),!0),V=N(K[0].r,O.read_shift(2),!1),W.push(oe+F+":"+ne+V)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(O.read_shift(2));break;case 6:{for(var Ae="";H=O[O.l++];)Ae+=String.fromCharCode(H);W.push('"'+Ae.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:U=W.pop(),L=W.pop(),W.push(["AND","OR"][H-20]+"("+L+","+U+")");break;default:if(H<32&&S[H])U=W.pop(),L=W.pop(),W.push(L+S[H]+U);else if(E[H]){if(X=E[H][1],X==69&&(X=O[O.l++]),X>W.length){console.error("WK1 bad formula parse 0x"+H.toString(16)+":|"+W.join("|")+"|");return}var je=W.slice(-X);W.length-=X,W.push(E[H][0]+"("+je.join(",")+")")}else return H<=7?console.error("WK1 invalid opcode "+H.toString(16)):H<=24?console.error("WK1 unsupported op "+H.toString(16)):H<=30?console.error("WK1 invalid opcode "+H.toString(16)):H<=115?console.error("WK1 unsupported function opcode "+H.toString(16)):console.error("WK1 unrecognized opcode "+H.toString(16))}}W.length==1?K[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function T(O){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=O.read_shift(2),K[3]=O[O.l++],K[0].c=O[O.l++],K}function k(O,K){var W=T(O);return W[1].t="s",W[1].v=O.read_shift(K-4,"cstr"),W}function P(O,K,W,X){var V=_e(6+X.length);V.write_shift(2,O),V.write_shift(1,W),V.write_shift(1,K),V.write_shift(1,39);for(var ne=0;ne<X.length;++ne){var L=X.charCodeAt(ne);V.write_shift(1,L>=128?95:L)}return V.write_shift(1,0),V}function D(O,K){var W=T(O);W[1].v=O.read_shift(2);var X=W[1].v>>1;if(W[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return W[1].v=X,W}function R(O,K){var W=T(O),X=O.read_shift(4),V=O.read_shift(4),ne=O.read_shift(2);if(ne==65535)return X===0&&V===3221225472?(W[1].t="e",W[1].v=15):X===0&&V===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var L=ne&32768;return ne=(ne&32767)-16446,W[1].v=(1-L*2)*(V*Math.pow(2,ne+32)+X*Math.pow(2,ne)),W}function q(O,K,W,X){var V=_e(14);if(V.write_shift(2,O),V.write_shift(1,W),V.write_shift(1,K),X==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var ne=0,L=0,U=0,H=0;return X<0&&(ne=1,X=-X),L=Math.log2(X)|0,X/=Math.pow(2,L-31),H=X>>>0,(H&2147483648)==0&&(X/=2,++L,H=X>>>0),X-=H,H|=2147483648,H>>>=0,X*=Math.pow(2,32),U=X>>>0,V.write_shift(4,U),V.write_shift(4,H),L+=16383+(ne?32768:0),V.write_shift(2,L),V}function M(O,K){var W=R(O);return O.l+=K-14,W}function z(O,K){var W=T(O),X=O.read_shift(4);return W[1].v=X>>6,W}function ie(O,K){var W=T(O),X=O.read_shift(8,"f");return W[1].v=X,W}function ce(O,K){var W=ie(O);return O.l+=K-10,W}function ae(O,K){return O[O.l+K-1]==0?O.read_shift(K,"cstr"):""}function me(O,K){var W=O[O.l++];W>K-1&&(W=K-1);for(var X="";X.length<W;)X+=String.fromCharCode(O[O.l++]);return X}function de(O,K,W){if(!(!W.qpro||K<21)){var X=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var V=O.read_shift(K-21,"cstr");return[X,V]}}function he(O,K){for(var W={},X=O.l+K;O.l<X;){var V=O.read_shift(2);if(V==14e3){for(W[V]=[0,""],W[V][0]=O.read_shift(2);O[O.l];)W[V][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return W}function J(O,K){var W=_e(5+O.length);W.write_shift(2,14e3),W.write_shift(2,K);for(var X=0;X<O.length;++X){var V=O.charCodeAt(X);W[W.l++]=V>127?95:V}return W[W.l++]=0,W}var xe={0:{n:"BOF",f:_r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:me},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:ie},40:{n:"FORMULA28",f:ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function lZ(e){var t={},r=e.match(jn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=lt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=vw[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var cZ=(function(){var e=uf("t"),t=uf("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var c={t:"s",v:yt(s[1])},f=i.match(t);return f&&(c.s=lZ(f[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(c){return c.v})}})(),uZ=(function(){var t=/(\r\n|\n)/g;function r(a,i,s){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),s.push("</"+f+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),fZ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,dZ=/<(?:\w+:)?r>/,hZ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function zw(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=yt(Rt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Rt(e),r&&(n.h=Cw(n.t))):e.match(dZ)&&(n.r=Rt(e),n.t=yt(Rt((e.replace(hZ,"").match(fZ)||[]).join("").replace(jn,""))),r&&(n.h=uZ(cZ(n.r)))),n):{t:""}}var mZ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,pZ=/<(?:\w+:)?(?:si|sstItem)>/g,xZ=/<\/(?:\w+:)?(?:si|sstItem)>/;function gZ(e,t){var r=[],n="";if(!e)return r;var a=e.match(mZ);if(a){n=a[2].replace(pZ,"").split(xZ);for(var i=0;i!=n.length;++i){var s=zw(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=lt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var vZ=/^\s|\s$|[\t\n\r]/;function NO(e,t){if(!t.bookSST)return"";var r=[wr];r[r.length]=Be("sst",null,{xmlns:cl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(vZ)&&(i+=' xml:space="preserve"'),i+=">"+It(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function yZ(e){return[e.read_shift(4),e.read_shift(4)]}function wZ(e,t){var r=[],n=!1;return ls(e,function(i,s,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function bZ(e,t){return t||(t=_e(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var SZ=OY;function NZ(e){var t=qn();Ce(t,159,bZ(e));for(var r=0;r<e.length;++r)Ce(t,19,SZ(e[r]));return Ce(t,160),t.end()}function _O(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Xi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function _Z(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Xi(e,4),t.U=Xi(e,4),t.W=Xi(e,4),t}function EZ(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function kZ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(EZ(e));return t}function jZ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function CZ(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Xi(e,4),t.U=Xi(e,4),t.W=Xi(e,4),t}function AZ(e){var t=CZ(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function EO(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function kO(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function TZ(e){var t=Xi(e);switch(t.Minor){case 2:return[t.Minor,PZ(e)];case 3:return[t.Minor,OZ()];case 4:return[t.Minor,FZ(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function PZ(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=EO(e,r),a=kO(e,e.length-e.l);return{t:"Std",h:n,v:a}}function OZ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function FZ(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(jn,function(i){var s=lt(i);switch(_i(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){n[c]=s[c]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function DZ(e,t){var r={},n=r.EncryptionVersionInfo=Xi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=EO(e,a),t-=a,r.EncryptionVerifier=kO(e,t),r}function IZ(e){var t={},r=t.EncryptionVersionInfo=Xi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Ww(e){var t=0,r,n=_O(e),a=n.length+1,i,s,c,f,d;for(r=Gs(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],c=(t&16384)===0?0:1,f=t<<1&32767,d=c|f,t=d^s;return t^52811}var jO=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,c){return n(s^c)},i=function(s){for(var c=t[s.length-1],f=104,d=s.length-1;d>=0;--d)for(var h=s[d],m=0;m!=7;++m)h&64&&(c^=r[f]),h*=2,--f;return c};return function(s){for(var c=_O(s),f=i(c),d=c.length,h=Gs(16),m=0;m!=16;++m)h[m]=0;var x,g,y;for((d&1)===1&&(x=f>>8,h[d]=a(e[0],x),--d,x=f&255,g=c[c.length-1],h[d]=a(g,x));d>0;)--d,x=f>>8,h[d]=a(c[d],x),--d,x=f&255,h[d]=a(c[d],x);for(d=15,y=15-c.length;y>0;)x=f>>8,h[d]=a(e[y],x),--d,--y,x=f&255,h[d]=a(c[d],x),--d,--y;return h}})(),MZ=function(e,t,r,n,a){a||(a=t),n||(n=jO(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},RZ=function(e){var t=0,r=jO(e);return function(n){var a=MZ("",n,t,r);return t=a[1],a[0]}};function LZ(e,t,r,n){var a={key:_r(e),verificationBytes:_r(e)};return r.password&&(a.verifier=Ww(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=RZ(r.password)),a}function BZ(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=IZ(e):n.Data=DZ(e,t),n}function $Z(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?BZ(e,t-2,n):LZ(e,r.biff>=8?t:t-2,r,n),n}var CO=(function(){function e(a,i){switch(i.type){case"base64":return t(pa(a),i);case"binary":return t(a,i);case"buffer":return t(pt&&Buffer.isBuffer(a)?a.toString("binary"):no(a),i);case"array":return t(Qo(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},c=s.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(h,m){Array.isArray(c)&&(c[m]=[]);for(var x=/\\\w+\b/g,g=0,y,v=-1;y=x.exec(h);){switch(y[0]){case"\\cell":var b=h.slice(g,x.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++v,b.length){var N={v:b,t:"s"};Array.isArray(c)?c[m][v]=N:c[st({r:m,c:v})]=N}break}g=x.lastIndex}v>d.e.c&&(d.e.c=v)}),c["!ref"]=ht(d),c}function r(a,i){return ao(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=bt(a["!ref"]),c,f=Array.isArray(a),d=s.s.r;d<=s.e.r;++d){i.push("\\trowd\\trautofit1");for(var h=s.s.c;h<=s.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=s.s.c;h<=s.e.c;++h){var m=st({r:d,c:h});c=f?(a[d]||[])[h]:a[m],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(es(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function UZ(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function mf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function zZ(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var c=0,f=0,d=a+i;switch(f=s/(d>1?2-d:d),a){case t:c=((r-n)/s+6)%6;break;case r:c=(n-t)/s+2;break;case n:c=(t-r)/s+4;break}return[c/6,f,d/2]}function WZ(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],c=6*t,f;if(r!==0)switch(c|0){case 0:case 6:f=a*c,s[0]+=a,s[1]+=f;break;case 1:f=a*(2-c),s[0]+=f,s[1]+=a;break;case 2:f=a*(c-2),s[1]+=a,s[2]+=f;break;case 3:f=a*(4-c),s[1]+=f,s[2]+=a;break;case 4:f=a*(c-4),s[2]+=a,s[0]+=f;break;case 5:f=a*(6-c),s[2]+=f,s[0]+=a;break}for(var d=0;d!=3;++d)s[d]=Math.round(s[d]*255);return s}function Ph(e,t){if(t===0)return e;var r=zZ(UZ(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),mf(WZ(r))}var AO=6,HZ=15,VZ=1,Sn=AO;function pf(e){return Math.floor((e+Math.round(128/Sn)/256)*Sn)}function xf(e){return Math.floor((e-5)/Sn*100+.5)/100}function Oh(e){return Math.round((e*Sn+5)/Sn*256)/256}function Jg(e){return Oh(xf(pf(e)))}function Hw(e){var t=Math.abs(e-Jg(e)),r=Sn;if(t>.005)for(Sn=VZ;Sn<HZ;++Sn)Math.abs(e-Jg(e))<=t&&(t=Math.abs(e-Jg(e)),r=Sn);Sn=r}function Xs(e){e.width?(e.wpx=pf(e.width),e.wch=xf(e.wpx),e.MDW=Sn):e.wpx?(e.wch=xf(e.wpx),e.width=Oh(e.wch),e.MDW=Sn):typeof e.wch=="number"&&(e.width=Oh(e.wch),e.wpx=pf(e.width),e.MDW=Sn),e.customWidth&&delete e.customWidth}var KZ=96,TO=KZ;function gf(e){return e*96/TO}function vc(e){return e*TO/96}var GZ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function XZ(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(jn)||[]).forEach(function(s){var c=lt(s);switch(_i(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=Gt(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=Gt(c.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function qZ(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(jn)||[]).forEach(function(s){var c=lt(s);switch(_i(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function YZ(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(jn)||[]).forEach(function(s){var c=lt(s);switch(_i(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Rt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?Gt(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?Gt(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?Gt(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?Gt(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?Gt(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?Gt(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?Gt(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=vw[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=Gt(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=Lo[a.color.index];a.color.index==81&&(f=Lo[1]),f||(f=Lo[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Ph(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function JZ(e,t,r){t.NumberFmt=[];for(var n=dr(it),a=0;a<n.length;++a)t.NumberFmt[n[a]]=it[n[a]];var i=e[0].match(jn);if(i)for(a=0;a<i.length;++a){var s=lt(i[a]);switch(_i(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=yt(Rt(s.formatCode)),f=parseInt(s.numFmtId,10);if(t.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&t.NumberFmt[f]!=null;--f);t.NumberFmt[f]=c}Gi(c,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function QZ(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:n,formatCode:It(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var N0=["numFmtId","fillId","fontId","borderId","xfId"],_0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ZZ(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(jn)||[]).forEach(function(i){var s=lt(i),c=0;switch(_i(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],c=0;c<N0.length;++c)n[N0[c]]&&(n[N0[c]]=parseInt(n[N0[c]],10));for(c=0;c<_0.length;++c)n[_0[c]]&&(n[_0[c]]=Gt(n[_0[c]]));if(t.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[c]){n.numFmtId=c;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};s.vertical&&(f.vertical=s.vertical),s.horizontal&&(f.horizontal=s.horizontal),s.textRotation!=null&&(f.textRotation=s.textRotation),s.indent&&(f.indent=s.indent),s.wrapText&&(f.wrapText=Gt(s.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function eee(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var tee=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,d){var h={};if(!c)return h;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(t))&&JZ(m,h,d),(m=c.match(a))&&YZ(m,h,f,d),(m=c.match(n))&&qZ(m,h,f,d),(m=c.match(i))&&XZ(m,h,f,d),(m=c.match(r))&&ZZ(m,h,d),h}})();function PO(e,t){var r=[wr,Be("styleSheet",null,{xmlns:cl[0],"xmlns:vt":Fr.vt})],n;return e.SSF&&(n=QZ(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=eee(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ree(e,t){var r=e.read_shift(2),n=En(e);return[r,n]}function nee(e,t,r){r||(r=_e(6+4*t.length)),r.write_shift(2,e),qr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function aee(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=BY(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var c=e.read_shift(1);c>0&&(n.family=c);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=LY(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=En(e),n}function iee(e,t){t||(t=_e(153)),t.write_shift(2,e.sz*20),$Y(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ch(e.color,t);var n=0;return n=2,t.write_shift(1,n),qr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var see=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Qg,oee=kn;function $j(e,t){t||(t=_e(84)),Qg||(Qg=bm(see));var r=Qg[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Ch({auto:1},t),Ch({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function lee(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function OO(e,t,r){r||(r=_e(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ju(e,t){return t||(t=_e(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var cee=kn;function uee(e,t){return t||(t=_e(51)),t.write_shift(1,0),ju(null,t),ju(null,t),ju(null,t),ju(null,t),ju(null,t),t.length>t.l?t.slice(0,t.l):t}function fee(e,t){return t||(t=_e(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),jh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function dee(e,t,r){var n=_e(2052);return n.write_shift(4,e),jh(t,n),jh(r,n),n.length>n.l?n.slice(0,n.l):n}function hee(e,t,r){var n={};n.NumberFmt=[];for(var a in it)n.NumberFmt[a]=it[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return ls(e,function(f,d,h){switch(h){case 44:n.NumberFmt[f[0]]=f[1],Gi(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(f.color.rgb=Ph(t.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(h),s=!0;break;case 38:i.pop(),s=!1;break;default:if(d.T>0)i.push(h);else if(d.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function mee(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Ce(e,615,ri(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ce(e,44,nee(a,t[a]))}),Ce(e,616))}}function pee(e){var t=1;Ce(e,611,ri(t)),Ce(e,43,iee({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(e,612)}function xee(e){var t=2;Ce(e,603,ri(t)),Ce(e,45,$j({patternType:"none"})),Ce(e,45,$j({patternType:"gray125"})),Ce(e,604)}function gee(e){var t=1;Ce(e,613,ri(t)),Ce(e,46,uee()),Ce(e,614)}function vee(e){var t=1;Ce(e,626,ri(t)),Ce(e,47,OO({numFmtId:0},65535)),Ce(e,627)}function yee(e,t){Ce(e,617,ri(t.length)),t.forEach(function(r){Ce(e,47,OO(r,0))}),Ce(e,618)}function wee(e){var t=1;Ce(e,619,ri(t)),Ce(e,48,fee({xfId:0,name:"Normal"})),Ce(e,620)}function bee(e){var t=0;Ce(e,505,ri(t)),Ce(e,506)}function See(e){var t=0;Ce(e,508,dee(t,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}function Nee(e,t){var r=qn();return Ce(r,278),mee(r,e.SSF),pee(r),xee(r),gee(r),vee(r),yee(r,t.cellXfs),wee(r),bee(r),See(r),Ce(r,279),r.end()}var _ee=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Eee(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(jn)||[]).forEach(function(a){var i=lt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[_ee.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function kee(){}function jee(){}var Cee=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Aee=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Tee=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Pee(e,t,r){t.themeElements={};var n;[["clrScheme",Cee,Eee],["fontScheme",Aee,kee],["fmtScheme",Tee,jee]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Oee=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function FO(e,t){(!e||e.length===0)&&(e=Vw());var r,n={};if(!(r=e.match(Oee)))throw new Error("themeElements not found in theme");return Pee(r[0],n,t),n.raw=e,n}function Vw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[wr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Fee(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=EP(i,{type:"array"})}catch{return}var c=ca(s,"theme/theme/theme1.xml",!0);if(c)return FO(c,r)}}function Dee(e){return e.read_shift(4)}function Iee(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Mee(e,4);break;case 2:t.xclrValue=dO(e);break;case 3:t.xclrValue=Dee(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Mee(e,t){return kn(e,t)}function Ree(e,t){return kn(e,t)}function Lee(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Iee(e);break;case 6:n[1]=Ree(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Bee(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(Lee(e,r-e.l));return{ixfe:n,ext:i}}function $ee(e,t){t.forEach(function(r){r[0]})}function Uee(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:En(e)}}function zee(e){var t=_e(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),qr(e.name,t),t.slice(0,t.l)}function Wee(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Hee(e){var t=_e(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Vee(e,t){var r=_e(8+2*t.length);return r.write_shift(4,e),qr(t,r),r.slice(0,r.l)}function Kee(e){return e.l+=4,e.read_shift(4)!=0}function Gee(e,t){var r=_e(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Xee(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,c=2;return ls(e,function(f,d,h){switch(h){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(m){c==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):c==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:i.push(h),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!d.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function qee(){var e=qn();return Ce(e,332),Ce(e,334,ri(1)),Ce(e,335,zee({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,Vee(1,"XLDAPR")),Ce(e,52),Ce(e,35,ri(514)),Ce(e,4096,ri(0)),Ce(e,4097,Oa(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,Gee(1)),Ce(e,51,Hee([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function Yee(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(jn,function(c){var f=lt(c);switch(_i(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(s=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),n}function DO(){var e=[wr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Jee(e){var t=[];if(!e)return t;var r=1;return(e.match(jn)||[]).forEach(function(n){var a=lt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Qee(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=st(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Zee(e,t,r){var n=[];return ls(e,function(i,s,c){switch(c){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function ete(e,t,r,n){if(!e)return e;var a=n||{},i=!1;ls(e,function(c,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function tte(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Yl=1024;function IO(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Be("xml",null,{"xmlns:v":ia.v,"xmlns:o":ia.o,"xmlns:x":ia.x,"xmlns:mv":ia.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Yl<e*1e3;)Yl+=1e3;return t.forEach(function(i){var s=or(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Be("v:fill",f,c),h={on:"t",obscured:"t"};++Yl,a=a.concat(["<v:shape"+ff({id:"_x0000_s"+Yl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Be("v:shadow",null,h),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),fn("x:AutoFill","False"),fn("x:Row",String(s.r)),fn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Uj(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var c=or(s.ref);if(a?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[s.ref],!i){i={t:"z"},a?e[c.r][c.c]=i:e[s.ref]=i;var f=bt(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var d=ht(f);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var h={a:s.author,t:s.t,r:s.r,T:r};s.h&&(h.h=s.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(h.a==n[m].id){h.a=n[m].name||h.a;break}}i.c.push(h)})}function rte(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=lt(c[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},h=or(f.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var m=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!m&&!!m[1]&&zw(m[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=x.h),n.push(d)}}}}),n}function MO(e){var t=[wr,Be("comments",null,{xmlns:cl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=It(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(It(f.a))),i.push(f.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(fn("t",It(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)s+=`Reply:
    `+i[c]+`
`;t.push(fn("t",It(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function nte(e,t){var r=[],n=!1,a={},i=0;return e.replace(jn,function(c,f){var d=lt(c);switch(_i(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+c.length;break;case"</text>":a.t=e.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),r}function ate(e,t,r){var n=[wr,Be("ThreadedComments",null,{xmlns:Fr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,c){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=f.id:f.parentId=i,s.ID=f.id,s.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Be("threadedComment",fn("text",s.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function ite(e,t){var r=[],n=!1;return e.replace(jn,function(i){var s=lt(i);switch(_i(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function ste(e){var t=[wr,Be("personList",null,{xmlns:Fr.TCMNT,"xmlns:x":cl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function ote(e){var t={};t.iauthor=e.read_shift(4);var r=hl(e);return t.rfx=r.s,t.ref=st(r.s),e.l+=16,t}function lte(e,t){return t==null&&(t=_e(36)),t.write_shift(4,e[1].iauthor),Dc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var cte=En;function ute(e){return qr(e.slice(0,54))}function fte(e,t){var r=[],n=[],a={},i=!1;return ls(e,function(c,f,d){switch(d){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function dte(e){var t=qn(),r=[];return Ce(t,628),Ce(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Ce(t,632,ute(a.a)))})}),Ce(t,631),Ce(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:or(n[0]),e:or(n[0])};Ce(t,635,lte([i,a])),a.t&&a.t.length>0&&Ce(t,637,DY(a)),Ce(t,636),delete a.iauthor})}),Ce(t,634),Ce(t,629),t.end()}var hte="application/vnd.ms-office.vbaProject";function mte(e){var t=tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),tt.write(t)}function pte(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&tt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var RO=["xlsb","xlsm","xlam","biff8","xla"];function xte(){return{"!type":"dialog"}}function gte(){return{"!type":"dialog"}}function vte(){return{"!type":"macro"}}function yte(){return{"!type":"macro"}}var rc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var c=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,h=s.length>0?parseInt(s,10)|0:0;return c?h+=t.c:--h,f?d+=t.r:--d,a+(c?"":"$")+sr(h)+(f?"":"$")+vr(d)}return function(a,i){return t=i,a.replace(e,r)}})(),Kw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Gw=(function(){return function(t,r){return t.replace(Kw,function(n,a,i,s,c,f){var d=Fw(s)-(i?0:r.c),h=Ow(f)-(c?0:r.r),m=h==0?"":c?h+1:"["+h+"]",x=d==0?"":i?d+1:"["+d+"]";return a+"R"+m+"C"+x})}})();function LO(e,t){return e.replace(Kw,function(r,n,a,i,s,c){return n+(a=="$"?a+i:sr(Fw(i)+t.c))+(s=="$"?s+c:vr(Ow(c)+t.r))})}function wte(e,t,r){var n=Jn(t),a=n.s,i=or(r),s={r:i.r-a.r,c:i.c-a.c};return LO(e,s)}function bte(e){return e.length!=1}function zj(e){return e.replace(/_xlfn\./g,"")}function Sr(e){e.l+=1}function qs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function BO(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return $O(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=qs(e),c=qs(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function $O(e){var t=qs(e),r=qs(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Ste(e,t,r){if(r.biff<8)return $O(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=qs(e),s=qs(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function UO(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Nte(e);var n=e.read_shift(r&&r.biff==12?4:2),a=qs(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Nte(e){var t=qs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function _te(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Ete(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return kte(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:c}}function kte(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function jte(e,t,r){var n=(e[e.l++]&96)>>5,a=BO(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Cte(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=BO(e,i,r);return[n,a,s]}function Ate(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Tte(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Pte(e,t,r){var n=(e[e.l++]&96)>>5,a=Ste(e,t-1,r);return[n,a]}function Ote(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Wj(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Fte(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Dte(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ite(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Mte(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Rte(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function zO(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Lte(e){return e.read_shift(2),zO(e)}function Bte(e){return e.read_shift(2),zO(e)}function $te(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=UO(e,0,r);return[n,a]}function Ute(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Ete(e,0,r);return[n,a]}function zte(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=UO(e,0,r);return[n,a,i]}function Wte(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Kre[a],VO[a],n]}function Hte(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Vte(e);return[a,(i[0]===0?VO:Vre)[i[1]]]}function Vte(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Kte(e,t,r){e.l+=r&&r.biff==2?3:4}function Gte(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Xte(e){return e.l++,cs[e.read_shift(1)]}function qte(e){return e.l++,e.read_shift(2)}function Yte(e){return e.l++,e.read_shift(1)!==0}function Jte(e){return e.l++,Nn(e)}function Qte(e,t,r){return e.l++,zf(e,t-1,r)}function Zte(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=xr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=cs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Nn(e);break;case 2:r[1]=ml(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ere(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?hl:_m)(e));return a}function tre(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var c=0;c!=a;++c)s[i][c]=Zte(e,r.biff);return s}function rre(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function nre(e,t,r){if(r.biff==5)return are(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function are(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function ire(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function sre(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function ore(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function lre(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var cre=kn,ure=kn,fre=kn;function Hf(e,t,r){return e.l+=2,[_te(e)]}function Xw(e){return e.l+=6,[]}var dre=Hf,hre=Xw,mre=Xw,pre=Hf;function WO(e){return e.l+=2,[_r(e),e.read_shift(2)&1]}var xre=Hf,gre=WO,vre=Xw,yre=Hf,wre=Hf,bre=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Sre(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=bre[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Nre(e){return e.l+=2,[e.read_shift(4)]}function _re(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Ere(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function kre(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jre(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Cre(e){return e.l+=4,[0,0]}var Hj={1:{n:"PtgExp",f:Gte},2:{n:"PtgTbl",f:fre},3:{n:"PtgAdd",f:Sr},4:{n:"PtgSub",f:Sr},5:{n:"PtgMul",f:Sr},6:{n:"PtgDiv",f:Sr},7:{n:"PtgPower",f:Sr},8:{n:"PtgConcat",f:Sr},9:{n:"PtgLt",f:Sr},10:{n:"PtgLe",f:Sr},11:{n:"PtgEq",f:Sr},12:{n:"PtgGe",f:Sr},13:{n:"PtgGt",f:Sr},14:{n:"PtgNe",f:Sr},15:{n:"PtgIsect",f:Sr},16:{n:"PtgUnion",f:Sr},17:{n:"PtgRange",f:Sr},18:{n:"PtgUplus",f:Sr},19:{n:"PtgUminus",f:Sr},20:{n:"PtgPercent",f:Sr},21:{n:"PtgParen",f:Sr},22:{n:"PtgMissArg",f:Sr},23:{n:"PtgStr",f:Qte},26:{n:"PtgSheet",f:_re},27:{n:"PtgEndSheet",f:Ere},28:{n:"PtgErr",f:Xte},29:{n:"PtgBool",f:Yte},30:{n:"PtgInt",f:qte},31:{n:"PtgNum",f:Jte},32:{n:"PtgArray",f:Ote},33:{n:"PtgFunc",f:Wte},34:{n:"PtgFuncVar",f:Hte},35:{n:"PtgName",f:rre},36:{n:"PtgRef",f:$te},37:{n:"PtgArea",f:jte},38:{n:"PtgMemArea",f:ire},39:{n:"PtgMemErr",f:cre},40:{n:"PtgMemNoMem",f:ure},41:{n:"PtgMemFunc",f:sre},42:{n:"PtgRefErr",f:ore},43:{n:"PtgAreaErr",f:Ate},44:{n:"PtgRefN",f:Ute},45:{n:"PtgAreaN",f:Pte},46:{n:"PtgMemAreaN",f:kre},47:{n:"PtgMemNoMemN",f:jre},57:{n:"PtgNameX",f:nre},58:{n:"PtgRef3d",f:zte},59:{n:"PtgArea3d",f:Cte},60:{n:"PtgRefErr3d",f:lre},61:{n:"PtgAreaErr3d",f:Tte},255:{}},Are={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Tre={1:{n:"PtgElfLel",f:WO},2:{n:"PtgElfRw",f:yre},3:{n:"PtgElfCol",f:dre},6:{n:"PtgElfRwV",f:wre},7:{n:"PtgElfColV",f:pre},10:{n:"PtgElfRadical",f:xre},11:{n:"PtgElfRadicalS",f:vre},13:{n:"PtgElfColS",f:hre},15:{n:"PtgElfColSV",f:mre},16:{n:"PtgElfRadicalLel",f:gre},25:{n:"PtgList",f:Sre},29:{n:"PtgSxName",f:Nre},255:{}},Pre={0:{n:"PtgAttrNoop",f:Cre},1:{n:"PtgAttrSemi",f:Rte},2:{n:"PtgAttrIf",f:Ite},4:{n:"PtgAttrChoose",f:Fte},8:{n:"PtgAttrGoto",f:Dte},16:{n:"PtgAttrSum",f:Kte},32:{n:"PtgAttrBaxcel",f:Wj},33:{n:"PtgAttrBaxcel",f:Wj},64:{n:"PtgAttrSpace",f:Lte},65:{n:"PtgAttrSpaceSemi",f:Bte},128:{n:"PtgAttrIfError",f:Mte},255:{}};function Vf(e,t,r,n){if(n.biff<8)return kn(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=tre(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=ere(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(kn(e,t)),i}function Kf(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Hj[i]||Hj[Are[i]],(i===24||i===25)&&(a=(i===24?Tre:Pre)[e[e.l+1]]),!a||!a.f?kn(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Ore(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Fre={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Dre(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function HO(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Vj(e,t,r){var n=HO(e,t,r);return n=="#REF"?n:Dre(n,r)}function wn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},c=[],f,d,h,m=0,x=0,g,y="";if(!e[0]||!e[0][0])return"";for(var v=-1,b="",N=0,E=e[0].length;N<E;++N){var S=e[0][N];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),d=c.pop(),v>=0){switch(e[0][v][1][0]){case 0:b=ur(" ",e[0][v][1][1]);break;case 1:b=ur("\r",e[0][v][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}d=d+b,v=-1}c.push(d+Fre[S[0]]+f);break;case"PtgIsect":f=c.pop(),d=c.pop(),c.push(d+" "+f);break;case"PtgUnion":f=c.pop(),d=c.pop(),c.push(d+","+f);break;case"PtgRange":f=c.pop(),d=c.pop(),c.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=$u(S[1][1],s,a),c.push(Uu(h,i));break;case"PtgRefN":h=r?$u(S[1][1],r,a):S[1][1],c.push(Uu(h,i));break;case"PtgRef3d":m=S[1][1],h=$u(S[1][2],s,a),y=Vj(n,m,a),c.push(y+"!"+Uu(h,i));break;case"PtgFunc":case"PtgFuncVar":var C=S[1][0],T=S[1][1];C||(C=0),C&=127;var k=C==0?[]:c.slice(-C);c.length-=C,T==="User"&&(T=k.shift()),c.push(T+"("+k.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":g=wj(S[1][1],r?{s:r}:s,a),c.push(Xg(g,a));break;case"PtgArea":g=wj(S[1][1],s,a),c.push(Xg(g,a));break;case"PtgArea3d":m=S[1][1],g=S[1][2],y=Vj(n,m,a),c.push(y+"!"+Xg(g,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=S[1][2];var P=(n.names||[])[x-1]||(n[0]||[])[x],D=P?P.Name:"SH33TJSNAME"+String(x);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),c.push(D);break;case"PtgNameX":var R=S[1][1];x=S[1][2];var q;if(a.biff<=5)R<0&&(R=-R),n[R]&&(q=n[R][x]);else{var M="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][x]&&n[R][x].itab>0&&(M=n.SheetNames[n[R][x].itab-1]+"!"):M=n.SheetNames[x-1]+"!"),n[R]&&n[R][x])M+=n[R][x].Name;else if(n[0]&&n[0][x])M+=n[0][x].Name;else{var z=(HO(n,R,a)||"").split(";;");z[x-1]?M=z[x-1]:M+="SH33TJSERRX"}c.push(M);break}q||(q={Name:"SH33TJSERRY"}),c.push(q.Name);break;case"PtgParen":var ie="(",ce=")";if(v>=0){switch(b="",e[0][v][1][0]){case 2:ie=ur(" ",e[0][v][1][1])+ie;break;case 3:ie=ur("\r",e[0][v][1][1])+ie;break;case 4:ce=ur(" ",e[0][v][1][1])+ce;break;case 5:ce=ur("\r",e[0][v][1][1])+ce;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}c.push(ie+c.pop()+ce);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":h={c:S[1][1],r:S[1][0]};var ae={c:r.c,r:r.r};if(n.sharedf[st(h)]){var me=n.sharedf[st(h)];c.push(wn(me,s,ae,n,a))}else{var de=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){c.push(wn(d[1],s,ae,n,a)),de=!0;break}de||c.push(S[1])}break;case"PtgArray":c.push("{"+Ore(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&v>=0&&he.indexOf(e[0][N][0])==-1){S=e[0][v];var J=!0;switch(S[1][0]){case 4:J=!1;case 0:b=ur(" ",S[1][1]);break;case 5:J=!1;case 1:b=ur("\r",S[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((J?b:"")+c.pop()+(J?"":b)),v=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function Ire(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],kn(e,t-2)];var c=Kf(e,s,r);return t!==s+a&&(i=Vf(e,t-s-a,c,r)),e.l=n,[c,i]}function Mre(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],kn(e,t-2)];var c=Kf(e,s,r);return t!==s+a&&(i=Vf(e,t-s-a,c,r)),e.l=n,[c,i]}function Rre(e,t,r,n){var a=e.l+t,i=Kf(e,n,r),s;return a!==e.l&&(s=Vf(e,a-e.l,i,r)),[i,s]}function Lre(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=Kf(e,i,r);return i==65535?[[],kn(e,t-2)]:(t!==i+2&&(a=Vf(e,n-i-2,s,r)),[s,a])}function Bre(e){var t;if(Wi(e,e.l+6)!==65535)return[Nn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function $re(e){if(e==null){var t=_e(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Zo(e);return Zo(0)}function Zg(e,t,r){var n=e.l+t,a=Ei(e);r.biff==2&&++e.l;var i=Bre(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=Mre(e,n-e.l,r);return{cell:a,val:i[0],formula:c,shared:s>>3&1,tt:i[1]}}function Ure(e,t,r,n,a){var i=tl(t,r,a),s=$re(e.v),c=_e(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var d=_e(e.bf.length),h=0;h<e.bf.length;++h)d[h]=e.bf[h];var m=Gr([i,s,c,d]);return m}function Em(e,t,r){var n=e.read_shift(4),a=Kf(e,n,r),i=e.read_shift(4),s=i>0?Vf(e,i,a,r):null;return[a,s]}var zre=Em,km=Em,Wre=Em,Hre=Em,Vre={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},VO={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Kre={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Kj(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Gre(e){var t="of:="+e.replace(Kw,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ev(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Xre(e){return e.replace(/\./,"!")}var Wu={},nc={},Hu=typeof Map<"u";function qw(e,t,r){var n=0,a=e.length;if(r){if(Hu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Hu?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Hu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function jm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Sn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=xf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Oh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Uo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function io(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Gi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function KO(e,t,r,n,a,i){try{n.cellNF&&(e.z=it[t])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Xt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(it[t]==null&&Gi(Vq[t]||"General",t),e.t==="e")e.w=e.w||cs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cf(e.v);else if(e.t==="d"){var s=Ir(e.v);(s|0)===s?e.w=s.toString(10):e.w=cf(s)}else{if(e.v===void 0)return"";e.w=Jo(e.v,nc)}else e.t==="d"?e.w=La(t,Ir(e.v),nc):e.w=La(t,e.v,nc)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ph(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ph(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function qre(e,t,r){if(e&&e["!ref"]){var n=bt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Yre(e,t){var r=bt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ht(r))}var Jre=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Qre=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Zre=/<(?:\w:)?hyperlink [^>]*>/mg,ene=/"(\w*:\w*)"/,tne=/<(?:\w:)?col\b[^>]*[\/]?>/g,rne=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,nne=/<(?:\w:)?pageMargins[^>]*\/>/g,GO=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ane=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ine=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function sne(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var c=t.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",m=e.match(Qre);m?(d=e.slice(0,m.index),h=e.slice(m.index+m[0].length)):d=h=e;var x=d.match(GO);x?Yw(x[0],c,a,r):(x=d.match(ane))&&lne(x[0],x[1]||"",c,a,r);var g=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var y=d.slice(g,g+50).match(ene);y&&Yre(c,y[1])}var v=d.match(ine);v&&v[1]&&bne(v[1],a);var b=[];if(t.cellStyles){var N=d.match(tne);N&&xne(b,N)}m&&_ne(m[1],c,t,f,i,s);var E=h.match(rne);E&&(c["!autofilter"]=vne(E[0]));var S=[],C=h.match(Jre);if(C)for(g=0;g!=C.length;++g)S[g]=bt(C[g].slice(C[g].indexOf('"')+1));var T=h.match(Zre);T&&hne(c,T,n);var k=h.match(nne);if(k&&(c["!margins"]=mne(lt(k[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=ht(f)),t.sheetRows>0&&c["!ref"]){var P=bt(c["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>f.e.r&&(P.e.r=f.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>f.e.c&&(P.e.c=f.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ht(P))}return b.length>0&&(c["!cols"]=b),S.length>0&&(c["!merges"]=S),c}function one(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ht(e[r])+'"/>';return t+"</mergeCells>"}function Yw(e,t,r,n){var a=lt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=yt(Rt(a.codeName)))}function lne(e,t,r,n,a){Yw(e.slice(0,e.indexOf(">")),r,n,a)}function cne(e,t,r,n,a){var i=!1,s={},c=null;if(n.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[r];try{t.Workbook&&(f=t.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,s.codeName=gi(It(f))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),c=(c||"")+Be("outlinePr",null,d)}!i&&!c||(a[a.length]=Be("sheetPr",c,s))}var une=["objects","scenarios","selectLockedCells","selectUnlockedCells"],fne=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function dne(e){var t={sheet:1};return une.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),fne.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Ww(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function hne(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=lt(Rt(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+yt(i.location))):(i.Target="#"+yt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=bt(i.ref),f=c.s.r;f<=c.e.r;++f)for(var d=c.s.c;d<=c.e.c;++d){var h=st({c:d,r:f});n?(e[f]||(e[f]=[]),e[f][d]||(e[f][d]={t:"z",v:void 0}),e[f][d].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function mne(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function pne(e){return Uo(e),Be("pageMargins",null,e)}function xne(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=lt(t[n],!0);a.hidden&&(a.hidden=Gt(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Hw(a.width)),Xs(a);i<=s;)e[i++]=qt(a)}}function gne(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Be("col",null,jm(a,n)));return r[r.length]="</cols>",r.join("")}function vne(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function yne(e,t,r,n){var a=typeof e.ref=="string"?e.ref:ht(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Jn(a);s.s.r==s.e.r&&(s.e.r=Jn(t["!ref"]).e.r,a=ht(s));for(var c=0;c<i.length;++c){var f=i[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Be("autoFilter",null,{ref:a})}var wne=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function bne(e,t){t.Views||(t.Views=[{}]),(e.match(wne)||[]).forEach(function(r,n){var a=lt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Gt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function Sne(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,a),{})}function Nne(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=cs[e.v];break;case"d":n&&n.cellDates?a=Xt(e.v,-1).toISOString():(e=qt(e),e.t="n",a=""+(e.v=Ir(Xt(e.v)))),typeof e.z>"u"&&(e.z=it[14]);break;default:a=e.v;break}var c=fn("v",It(a)),f={r:t},d=io(n.cellXfs,e,n);switch(d!==0&&(f.s=d),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=fn("v",""+qw(n.Strings,e.v,n.revStrings)),f.t="s";break}f.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Be("f",It(e.f),h)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(f.cm=1),Be("c",c,f)}var _ne=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=uf("v"),s=uf("f");return function(f,d,h,m,x,g){for(var y=0,v="",b=[],N=[],E=0,S=0,C=0,T="",k,P,D=0,R=0,q,M,z=0,ie=0,ce=Array.isArray(g.CellXf),ae,me=[],de=[],he=Array.isArray(d),J=[],xe={},te=!1,O=!!h.sheetStubs,K=f.split(t),W=0,X=K.length;W!=X;++W){v=K[W].trim();var V=v.length;if(V!==0){var ne=0;e:for(y=0;y<V;++y)switch(v[y]){case">":if(v[y-1]!="/"){++y;break e}if(h&&h.cellStyles){if(P=lt(v.slice(ne,y),!0),D=P.r!=null?parseInt(P.r,10):D+1,R=-1,h.sheetRows&&h.sheetRows<D)continue;xe={},te=!1,P.ht&&(te=!0,xe.hpt=parseFloat(P.ht),xe.hpx=vc(xe.hpt)),P.hidden=="1"&&(te=!0,xe.hidden=!0),P.outlineLevel!=null&&(te=!0,xe.level=+P.outlineLevel),te&&(J[D-1]=xe)}break;case"<":ne=y;break}if(ne>=y)break;if(P=lt(v.slice(ne,y),!0),D=P.r!=null?parseInt(P.r,10):D+1,R=-1,!(h.sheetRows&&h.sheetRows<D)){m.s.r>D-1&&(m.s.r=D-1),m.e.r<D-1&&(m.e.r=D-1),h&&h.cellStyles&&(xe={},te=!1,P.ht&&(te=!0,xe.hpt=parseFloat(P.ht),xe.hpx=vc(xe.hpt)),P.hidden=="1"&&(te=!0,xe.hidden=!0),P.outlineLevel!=null&&(te=!0,xe.level=+P.outlineLevel),te&&(J[D-1]=xe)),b=v.slice(y).split(e);for(var L=0;L!=b.length&&b[L].trim().charAt(0)=="<";++L);for(b=b.slice(L),y=0;y!=b.length;++y)if(v=b[y].trim(),v.length!==0){if(N=v.match(r),E=y,S=0,C=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,N!=null&&N.length===2){for(E=0,T=N[1],S=0;S!=T.length&&!((C=T.charCodeAt(S)-64)<1||C>26);++S)E=26*E+C;--E,R=E}else++R;for(S=0;S!=v.length&&v.charCodeAt(S)!==62;++S);if(++S,P=lt(v.slice(0,S),!0),P.r||(P.r=st({r:D-1,c:R})),T=v.slice(S),k={t:""},(N=T.match(i))!=null&&N[1]!==""&&(k.v=yt(N[1])),h.cellFormula){if((N=T.match(s))!=null&&N[1]!==""){if(k.f=yt(Rt(N[1])).replace(/\r\n/g,`
`),h.xlfn||(k.f=zj(k.f)),N[0].indexOf('t="array"')>-1)k.F=(T.match(a)||[])[1],k.F.indexOf(":")>-1&&me.push([bt(k.F),k.F]);else if(N[0].indexOf('t="shared"')>-1){M=lt(N[0]);var U=yt(Rt(N[1]));h.xlfn||(U=zj(U)),de[parseInt(M.si,10)]=[M,U,P.r]}}else(N=T.match(/<f[^>]*\/>/))&&(M=lt(N[0]),de[M.si]&&(k.f=wte(de[M.si][1],de[M.si][2],P.r)));var H=or(P.r);for(S=0;S<me.length;++S)H.r>=me[S][0].s.r&&H.r<=me[S][0].e.r&&H.c>=me[S][0].s.c&&H.c<=me[S][0].e.c&&(k.F=me[S][1])}if(P.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(O)k.t="z";else continue;else k.t=P.t||"n";switch(m.s.c>R&&(m.s.c=R),m.e.c<R&&(m.e.c=R),k.t){case"n":if(k.v==""||k.v==null){if(!O)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!O)continue;k.t="z"}else q=Wu[parseInt(k.v,10)],k.v=q.t,k.r=q.r,h.cellHTML&&(k.h=q.h);break;case"str":k.t="s",k.v=k.v!=null?Rt(k.v):"",h.cellHTML&&(k.h=Cw(k.v));break;case"inlineStr":N=T.match(n),k.t="s",N!=null&&(q=zw(N[1]))?(k.v=q.t,h.cellHTML&&(k.h=q.h)):k.v="";break;case"b":k.v=Gt(k.v);break;case"d":h.cellDates?k.v=Xt(k.v,1):(k.v=Ir(Xt(k.v,1)),k.t="n");break;case"e":(!h||h.cellText!==!1)&&(k.w=k.v),k.v=qP[k.v];break}if(z=ie=0,ae=null,ce&&P.s!==void 0&&(ae=g.CellXf[P.s],ae!=null&&(ae.numFmtId!=null&&(z=ae.numFmtId),h.cellStyles&&ae.fillId!=null&&(ie=ae.fillId))),KO(k,z,ie,h,x,g),h.cellDates&&ce&&k.t=="n"&&Pc(it[z])&&(k.t="d",k.v=Nm(k.v)),P.cm&&h.xlmeta){var oe=(h.xlmeta.Cell||[])[+P.cm-1];oe&&oe.type=="XLDAPR"&&(k.D=!0)}if(he){var F=or(P.r);d[F.r]||(d[F.r]=[]),d[F.r][F.c]=k}else d[P.r]=k}}}}J.length>0&&(d["!rows"]=J)}})();function Ene(e,t,r,n){var a=[],i=[],s=bt(e["!ref"]),c="",f,d="",h=[],m=0,x=0,g=e["!rows"],y=Array.isArray(e),v={r:d},b,N=-1;for(x=s.s.c;x<=s.e.c;++x)h[x]=sr(x);for(m=s.s.r;m<=s.e.r;++m){for(i=[],d=vr(m),x=s.s.c;x<=s.e.c;++x){f=h[x]+d;var E=y?(e[m]||[])[x]:e[f];E!==void 0&&(c=Nne(E,f,e,t))!=null&&i.push(c)}(i.length>0||g&&g[m])&&(v={r:d},g&&g[m]&&(b=g[m],b.hidden&&(v.hidden=1),N=-1,b.hpx?N=gf(b.hpx):b.hpt&&(N=b.hpt),N>-1&&(v.ht=N,v.customHeight=1),b.level&&(v.outlineLevel=b.level)),a[a.length]=Be("row",i.join(""),v))}if(g)for(;m<g.length;++m)g&&g[m]&&(v={r:m+1},b=g[m],b.hidden&&(v.hidden=1),N=-1,b.hpx?N=gf(b.hpx):b.hpt&&(N=b.hpt),N>-1&&(v.ht=N,v.customHeight=1),b.level&&(v.outlineLevel=b.level),a[a.length]=Be("row","",v));return a.join("")}function XO(e,t,r,n){var a=[wr,Be("worksheet",null,{xmlns:cl[0],"xmlns:r":Fr.r})],i=r.SheetNames[e],s=0,c="",f=r.Sheets[i];f==null&&(f={});var d=f["!ref"]||"A1",h=bt(d);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),d=ht(h)}n||(n={}),f["!comments"]=[];var m=[];cne(f,r,e,t,a),a[a.length]=Be("dimension",null,{ref:d}),a[a.length]=Sne(f,t,e,r),t.sheetFormat&&(a[a.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=gne(f,f["!cols"])),a[s=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=Ene(f,t),c.length>0&&(a[a.length]=c)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),f["!protect"]&&(a[a.length]=dne(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=yne(f["!autofilter"],f,r,e)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=one(f["!merges"]));var x=-1,g,y=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(v){v[1].Target&&(g={ref:v[0]},v[1].Target.charAt(0)!="#"&&(y=Ot(n,-1,It(v[1].Target).replace(/#.*$/,""),gt.HLINK),g["r:id"]="rId"+y),(x=v[1].Target.indexOf("#"))>-1&&(g.location=It(v[1].Target.slice(x+1))),v[1].Tooltip&&(g.tooltip=It(v[1].Tooltip)),a[a.length]=Be("hyperlink",null,g))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=pne(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=fn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:d}))),m.length>0&&(y=Ot(n,-1,"../drawings/drawing"+(e+1)+".xml",gt.DRAW),a[a.length]=Be("drawing",null,{"r:id":"rId"+y}),f["!drawing"]=m),f["!comments"].length>0&&(y=Ot(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",gt.VML),a[a.length]=Be("legacyDrawing",null,{"r:id":"rId"+y}),f["!legacy"]=y),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function kne(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function jne(e,t,r){var n=_e(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=gf(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var c=0,f=n.l;n.l+=4;for(var d={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var m=-1,x=-1,g=h<<10;g<h+1<<10;++g){d.c=g;var y=Array.isArray(r)?(r[d.r]||[])[d.c]:r[st(d)];y&&(m<0&&(m=g),x=g)}m<0||(++c,n.write_shift(4,m),n.write_shift(4,x))}var v=n.l;return n.l=f,n.write_shift(4,c),n.l=v,n.length>n.l?n.slice(0,n.l):n}function Cne(e,t,r,n){var a=jne(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Ce(e,0,a)}var Ane=hl,Tne=Dc;function Pne(){}function One(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=IY(e),r}function Fne(e,t,r){r==null&&(r=_e(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Ch({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),HP(e,r),r.slice(0,r.l)}function Dne(e){var t=Ua(e);return[t]}function Ine(e,t,r){return r==null&&(r=_e(8)),ul(t,r)}function Mne(e){var t=fl(e);return[t]}function Rne(e,t,r){return r==null&&(r=_e(4)),dl(t,r)}function Lne(e){var t=Ua(e),r=e.read_shift(1);return[t,r,"b"]}function Bne(e,t,r){return r==null&&(r=_e(9)),ul(t,r),r.write_shift(1,e.v?1:0),r}function $ne(e){var t=fl(e),r=e.read_shift(1);return[t,r,"b"]}function Une(e,t,r){return r==null&&(r=_e(5)),dl(t,r),r.write_shift(1,e.v?1:0),r}function zne(e){var t=Ua(e),r=e.read_shift(1);return[t,r,"e"]}function Wne(e,t,r){return r==null&&(r=_e(9)),ul(t,r),r.write_shift(1,e.v),r}function Hne(e){var t=fl(e),r=e.read_shift(1);return[t,r,"e"]}function Vne(e,t,r){return r==null&&(r=_e(8)),dl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Kne(e){var t=Ua(e),r=e.read_shift(4);return[t,r,"s"]}function Gne(e,t,r){return r==null&&(r=_e(12)),ul(t,r),r.write_shift(4,t.v),r}function Xne(e){var t=fl(e),r=e.read_shift(4);return[t,r,"s"]}function qne(e,t,r){return r==null&&(r=_e(8)),dl(t,r),r.write_shift(4,t.v),r}function Yne(e){var t=Ua(e),r=Nn(e);return[t,r,"n"]}function Jne(e,t,r){return r==null&&(r=_e(16)),ul(t,r),Zo(e.v,r),r}function qO(e){var t=fl(e),r=Nn(e);return[t,r,"n"]}function Qne(e,t,r){return r==null&&(r=_e(12)),dl(t,r),Zo(e.v,r),r}function Zne(e){var t=Ua(e),r=Rw(e);return[t,r,"n"]}function eae(e,t,r){return r==null&&(r=_e(12)),ul(t,r),VP(e.v,r),r}function tae(e){var t=fl(e),r=Rw(e);return[t,r,"n"]}function rae(e,t,r){return r==null&&(r=_e(8)),dl(t,r),VP(e.v,r),r}function nae(e){var t=Ua(e),r=Dw(e);return[t,r,"is"]}function aae(e){var t=Ua(e),r=En(e);return[t,r,"str"]}function iae(e,t,r){return r==null&&(r=_e(12+4*e.v.length)),ul(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function sae(e){var t=fl(e),r=En(e);return[t,r,"str"]}function oae(e,t,r){return r==null&&(r=_e(8+4*e.v.length)),dl(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function lae(e,t,r){var n=e.l+t,a=Ua(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var c=km(e,n-e.l,r);s[3]=wn(c,null,a,r.supbooks,r)}else e.l=n;return s}function cae(e,t,r){var n=e.l+t,a=Ua(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var c=km(e,n-e.l,r);s[3]=wn(c,null,a,r.supbooks,r)}else e.l=n;return s}function uae(e,t,r){var n=e.l+t,a=Ua(e);a.r=r["!row"];var i=Nn(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var c=km(e,n-e.l,r);s[3]=wn(c,null,a,r.supbooks,r)}else e.l=n;return s}function fae(e,t,r){var n=e.l+t,a=Ua(e);a.r=r["!row"];var i=En(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var c=km(e,n-e.l,r);s[3]=wn(c,null,a,r.supbooks,r)}else e.l=n;return s}var dae=hl,hae=Dc;function mae(e,t){return t==null&&(t=_e(4)),t.write_shift(4,e),t}function pae(e,t){var r=e.l+t,n=hl(e),a=Iw(e),i=En(e),s=En(e),c=En(e);e.l=r;var f={rfx:n,relId:a,loc:i,display:c};return s&&(f.Tooltip=s),f}function xae(e,t){var r=_e(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Dc({s:or(e[0]),e:or(e[0])},r),Mw("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return qr(a||"",r),qr(e[1].Tooltip||"",r),qr("",r),r.slice(0,r.l)}function gae(){}function vae(e,t,r){var n=e.l+t,a=KP(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var c=zre(e,n-e.l,r);s[1]=c}else e.l=n;return s}function yae(e,t,r){var n=e.l+t,a=hl(e),i=[a];if(r.cellFormula){var s=Hre(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function wae(e,t,r){r==null&&(r=_e(18));var n=jm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var YO=["left","right","top","bottom","header","footer"];function bae(e){var t={};return YO.forEach(function(r){t[r]=Nn(e)}),t}function Sae(e,t){return t==null&&(t=_e(48)),Uo(e),YO.forEach(function(r){Zo(e[r],t)}),t}function Nae(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function _ae(e,t,r){r==null&&(r=_e(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Eae(e){var t=_e(24);return t.write_shift(4,4),t.write_shift(4,1),Dc(e,t),t}function kae(e,t){return t==null&&(t=_e(66)),t.write_shift(2,e.password?Ww(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function jae(){}function Cae(){}function Aae(e,t,r,n,a,i,s){if(!e)return e;var c=t||{};n||(n={"!id":{}});var f=c.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,x=!1,g,y,v,b,N,E,S,C,T,k=[];c.biff=12,c["!row"]=0;var P=0,D=!1,R=[],q={},M=c.supbooks||a.supbooks||[[]];if(M.sharedf=q,M.arrayf=R,M.SheetNames=a.SheetNames||a.Sheets.map(function(he){return he.name}),!c.supbooks&&(c.supbooks=M,a.Names))for(var z=0;z<a.Names.length;++z)M[0][z+1]=a.Names[z];var ie=[],ce=[],ae=!1;vf[16]={n:"BrtShortReal",f:qO};var me;if(ls(e,function(J,xe,te){if(!x)switch(te){case 148:d=J;break;case 0:g=J,c.sheetRows&&c.sheetRows<=g.r&&(x=!0),C=vr(b=g.r),c["!row"]=g.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=vc(J.hpt)),ce[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:J[2]},J[2]){case"n":y.v=J[1];break;case"s":S=Wu[J[1]],y.v=S.t,y.r=S.r;break;case"b":y.v=!!J[1];break;case"e":y.v=J[1],c.cellText!==!1&&(y.w=cs[y.v]);break;case"str":y.t="s",y.v=J[1];break;case"is":y.t="s",y.v=J[1].t;break}if((v=s.CellXf[J[0].iStyleRef])&&KO(y,v.numFmtId,null,c,i,s),N=J[0].c==-1?N+1:J[0].c,c.dense?(f[b]||(f[b]=[]),f[b][N]=y):f[sr(N)+C]=y,c.cellFormula){for(D=!1,P=0;P<R.length;++P){var O=R[P];g.r>=O[0].s.r&&g.r<=O[0].e.r&&N>=O[0].s.c&&N<=O[0].e.c&&(y.F=ht(O[0]),D=!0)}!D&&J.length>3&&(y.f=J[3])}if(h.s.r>g.r&&(h.s.r=g.r),h.s.c>N&&(h.s.c=N),h.e.r<g.r&&(h.e.r=g.r),h.e.c<N&&(h.e.c=N),c.cellDates&&v&&y.t=="n"&&Pc(it[v.numFmtId])){var K=Fo(y.v);K&&(y.t="d",y.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}me&&(me.type=="XLDAPR"&&(y.D=!0),me=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;y={t:"z",v:void 0},N=J[0].c==-1?N+1:J[0].c,c.dense?(f[b]||(f[b]=[]),f[b][N]=y):f[sr(N)+C]=y,h.s.r>g.r&&(h.s.r=g.r),h.s.c>N&&(h.s.c=N),h.e.r<g.r&&(h.e.r=g.r),h.e.c<N&&(h.e.c=N),me&&(me.type=="XLDAPR"&&(y.D=!0),me=void 0);break;case 176:k.push(J);break;case 49:me=((c.xlmeta||{}).Cell||[])[J-1];break;case 494:var W=n["!id"][J.relId];for(W?(J.Target=W.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=W):J.relId==""&&(J.Target="#"+J.loc),b=J.rfx.s.r;b<=J.rfx.e.r;++b)for(N=J.rfx.s.c;N<=J.rfx.e.c;++N)c.dense?(f[b]||(f[b]=[]),f[b][N]||(f[b][N]={t:"z",v:void 0}),f[b][N].l=J):(E=st({c:N,r:b}),f[E]||(f[E]={t:"z",v:void 0}),f[E].l=J);break;case 426:if(!c.cellFormula)break;R.push(J),T=c.dense?f[b][N]:f[sr(N)+C],T.f=wn(J[1],h,{r:g.r,c:N},M,c),T.F=ht(J[0]);break;case 427:if(!c.cellFormula)break;q[st(J[0].s)]=J[1],T=c.dense?f[b][N]:f[sr(N)+C],T.f=wn(J[1],h,{r:g.r,c:N},M,c);break;case 60:if(!c.cellStyles)break;for(;J.e>=J.s;)ie[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},ae||(ae=!0,Hw(J.w/256)),Xs(ie[J.e+1]);break;case 161:f["!autofilter"]={ref:ht(J)};break;case 476:f["!margins"]=J;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),J.name&&(a.Sheets[r].CodeName=J.name),(J.above||J.left)&&(f["!outline"]={above:J.above,left:J.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),J.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!xe.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=ht(d||h)),c.sheetRows&&f["!ref"]){var de=bt(f["!ref"]);c.sheetRows<=+de.e.r&&(de.e.r=c.sheetRows-1,de.e.r>h.e.r&&(de.e.r=h.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>h.e.c&&(de.e.c=h.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),f["!fullref"]=f["!ref"],f["!ref"]=ht(de))}return k.length>0&&(f["!merges"]=k),ie.length>0&&(f["!cols"]=ie),ce.length>0&&(f["!rows"]=ce),f}function Tae(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=qt(t),t.z=t.z||it[14],t.v=Ir(Xt(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var f={r,c:n};switch(f.s=io(a.cellXfs,t,a),t.l&&i["!links"].push([st(f),t.l]),t.c&&i["!comments"].push([st(f),t.c]),t.t){case"s":case"str":return a.bookSST?(c=qw(a.Strings,t.v,a.revStrings),f.t="s",f.v=c,s?Ce(e,18,qne(t,f)):Ce(e,7,Gne(t,f))):(f.t="str",s?Ce(e,17,oae(t,f)):Ce(e,6,iae(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Ce(e,13,rae(t,f)):Ce(e,2,eae(t,f)):s?Ce(e,16,Qne(t,f)):Ce(e,5,Jne(t,f)),!0;case"b":return f.t="b",s?Ce(e,15,Une(t,f)):Ce(e,4,Bne(t,f)),!0;case"e":return f.t="e",s?Ce(e,14,Vne(t,f)):Ce(e,3,Wne(t,f)),!0}return s?Ce(e,12,Rne(t,f)):Ce(e,1,Ine(t,f)),!0}function Pae(e,t,r,n){var a=bt(t["!ref"]||"A1"),i,s="",c=[];Ce(e,145);var f=Array.isArray(t),d=a.e.r;t["!rows"]&&(d=Math.max(a.e.r,t["!rows"].length-1));for(var h=a.s.r;h<=d;++h){s=vr(h),Cne(e,t,a,h);var m=!1;if(h<=a.e.r)for(var x=a.s.c;x<=a.e.c;++x){h===a.s.r&&(c[x]=sr(x)),i=c[x]+s;var g=f?(t[h]||[])[x]:t[i];if(!g){m=!1;continue}m=Tae(e,g,h,x,n,t,m)}}Ce(e,146)}function Oae(e,t){!t||!t["!merges"]||(Ce(e,177,mae(t["!merges"].length)),t["!merges"].forEach(function(r){Ce(e,176,hae(r))}),Ce(e,178))}function Fae(e,t){!t||!t["!cols"]||(Ce(e,390),t["!cols"].forEach(function(r,n){r&&Ce(e,60,wae(n,r))}),Ce(e,391))}function Dae(e,t){!t||!t["!ref"]||(Ce(e,648),Ce(e,649,Eae(bt(t["!ref"]))),Ce(e,650))}function Iae(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Ot(r,-1,n[1].Target.replace(/#.*$/,""),gt.HLINK);Ce(e,494,xae(n,a))}}),delete t["!links"]}function Mae(e,t,r,n){if(t["!comments"].length>0){var a=Ot(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",gt.VML);Ce(e,551,Mw("rId"+a)),t["!legacy"]=a}}function Rae(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:ht(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,c=Jn(i);c.s.r==c.e.r&&(c.e.r=Jn(t["!ref"]).e.r,i=ht(c));for(var f=0;f<s.length;++f){var d=s[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ce(e,161,Dc(bt(i))),Ce(e,162)}}function Lae(e,t,r){Ce(e,133),Ce(e,137,_ae(t,r)),Ce(e,138),Ce(e,134)}function Bae(e,t){t["!protect"]&&Ce(e,535,kae(t["!protect"]))}function $ae(e,t,r,n){var a=qn(),i=r.SheetNames[e],s=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var f=bt(s["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Ce(a,129),(r.vbaraw||s["!outline"])&&Ce(a,147,Fne(c,s["!outline"])),Ce(a,148,Tne(f)),Lae(a,s,r.Workbook),Fae(a,s),Pae(a,s,e,t),Bae(a,s),Rae(a,s,r,e),Oae(a,s),Iae(a,s,n),s["!margins"]&&Ce(a,476,Sae(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Dae(a,s),Mae(a,s,e,n),Ce(a,130),a.end()}function Uae(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=yt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function zae(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var c=0,f=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var x=Uae(m);h.s.r=h.s.c=0,h.e.c=c,d=sr(c),x[0].forEach(function(g,y){s[d+vr(y)]={t:"n",v:g,z:x[1]},f=y}),h.e.r<f&&(h.e.r=f),++c}),c>0&&(s["!ref"]=ht(h)),s}function Wae(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,c=e.match(GO);return c&&Yw(c[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Hae(e,t){e.l+=10;var r=En(e);return{name:r}}function Vae(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ls(e,function(f,d,h){switch(h){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Jw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Kae=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Gae=[],Xae=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Gj(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Gt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Xj(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Gt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function JO(e){Xj(e.WBProps,Jw),Xj(e.CalcPr,Xae),Gj(e.WBView,Kae),Gj(e.Sheets,Gae),nc.date1904=Gt(e.WBProps.date1904)}function qae(e){return!e.Workbook||!e.Workbook.WBProps?"false":Gt(e.Workbook.WBProps.date1904)?"true":"false"}var Yae="][*?/\\".split("");function QO(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Yae.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Jae(e,t,r){e.forEach(function(n,a){QO(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Qae(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Jae(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)qre(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Zae=/<\w+:workbook/;function eie(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(jn,function(f,d){var h=lt(f);switch(_i(h[0])){case"<?xml":break;case"<workbook":f.match(Zae)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Jw.forEach(function(m){if(h[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=Gt(h[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(h[m[0]],10);break;default:r.WBProps[m[0]]=h[m[0]]}}),h.codeName&&(r.WBProps.CodeName=Rt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=yt(Rt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Rt(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Gt(h.hidden||"0")&&(i.Hidden=!0),s=d+f.length;break;case"</definedName>":i.Ref=yt(Rt(e.slice(s,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return f}),cl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return JO(r),r}function ZO(e){var t=[wr];t[t.length]=Be("workbook",null,{xmlns:cl[0],"xmlns:r":Fr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Jw.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Be("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:It(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Be("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(t[t.length]=Be("definedName",It(c.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function tie(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=i1(e),r.name=En(e),r}function rie(e,t){return t||(t=_e(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Mw(e.strRelID,t),qr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function nie(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?En(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function aie(e,t){t||(t=_e(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),HP(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function iie(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function sie(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=MY(e),s=Wre(e,0,r),c=Iw(e);e.l=n;var f={Name:i,Ptg:s};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function oie(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],vf[16]={n:"BrtFRTArchID$",f:iie},ls(e,function(f,d,h){switch(h){case 156:s.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(t.SID=f.Sheet),f.Ref=wn(f.Ptg,null,null,s,t),delete t.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([h,f]):s[0]=[h,f],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(f),s.XTI=s.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),JO(r),r.Names=i,r.supbooks=s,r}function lie(e,t){Ce(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ce(e,156,rie(a))}Ce(e,144)}function cie(e,t){t||(t=_e(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return qr("SheetJS",t),qr(bh.version,t),qr(bh.version,t),qr("7262",t),t.length>t.l?t.slice(0,t.l):t}function uie(e,t){t||(t=_e(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function fie(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Ce(e,135),Ce(e,158,uie(a)),Ce(e,136))}}function die(e,t){var r=qn();return Ce(r,131),Ce(r,128,cie()),Ce(r,153,aie(e.Workbook&&e.Workbook.WBProps||null)),fie(r,e),lie(r,e),Ce(r,132),r.end()}function hie(e,t,r){return t.slice(-4)===".bin"?oie(e,r):eie(e,r)}function mie(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?Aae(e,n,r,a,i,s,c):sne(e,n,r,a,i,s,c)}function pie(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?Vae(e,n,r,a,i):Wae(e,n,r,a,i)}function xie(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?vte():yte()}function gie(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?xte():gte()}function vie(e,t,r,n){return t.slice(-4)===".bin"?hee(e,r,n):tee(e,r,n)}function yie(e,t,r){return FO(e,r)}function wie(e,t,r){return t.slice(-4)===".bin"?wZ(e,r):gZ(e,r)}function bie(e,t,r){return t.slice(-4)===".bin"?fte(e,r):rte(e,r)}function Sie(e,t,r){return t.slice(-4)===".bin"?Zee(e):Jee(e)}function Nie(e,t,r,n){return r.slice(-4)===".bin"?ete(e,t,r,n):void 0}function _ie(e,t,r){return t.slice(-4)===".bin"?Xee(e,t,r):Yee(e,t,r)}function Eie(e,t,r){return(t.slice(-4)===".bin"?die:ZO)(e)}function kie(e,t,r,n,a){return(t.slice(-4)===".bin"?$ae:XO)(e,r,n,a)}function jie(e,t,r){return(t.slice(-4)===".bin"?Nee:PO)(e,r)}function Cie(e,t,r){return(t.slice(-4)===".bin"?NZ:NO)(e,r)}function Aie(e,t,r){return(t.slice(-4)===".bin"?dte:MO)(e)}function Tie(e){return(e.slice(-4)===".bin"?qee:DO)()}var e6=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,t6=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qa(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(e6),i,s,c,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(t6),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(s+1),n[c]=i[2].slice(1,i[2].length-1));return n}function Pie(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(e6),a,i,s,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(t6),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Vu;function Oie(e,t){var r=Vu[e]||yt(e);return r==="General"?Jo(t):La(r,t)}function Fie(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Gt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Xt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[yt(t)]=a}function Die(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||cs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cf(e.v):e.w=Jo(e.v):e.w=Oie(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Vu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Pc(n)){var a=Fo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function Iie(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=GZ[n.Pattern]||n.Pattern)}e[t.ID]=t}function Mie(e,t,r,n,a,i,s,c,f,d){var h="General",m=n.StyleID,x={};d=d||{};var g=[],y=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&s&&(m=s.StyleID);i[m]!==void 0&&(i[m].nf&&(h=i[m].nf),i[m].Interior&&g.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Gt(e);break;case"String":n.t="s",n.r=fj(yt(e)),n.v=e.indexOf("<")>-1?yt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Xt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=yt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qP[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=fj(t||e));break}if(Die(n,h,d),d.cellFormula!==!1)if(n.Formula){var v=yt(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=rc(v,a),delete n.Formula,n.ArrayRange=="RC"?n.F=rc("RC:RC",a):n.ArrayRange&&(n.F=rc(n.ArrayRange,a),f.push([bt(n.F),n.F]))}else for(y=0;y<f.length;++y)a.r>=f[y][0].s.r&&a.r<=f[y][0].e.r&&a.c>=f[y][0].s.c&&a.c<=f[y][0].e.c&&(n.F=f[y][1]);d.cellStyles&&(g.forEach(function(b){!x.patternType&&b.patternType&&(x.patternType=b.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Rie(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function tv(e,t){var r=t||{};Oc();var n=Pu(Aw(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Rt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=qt(r);return s.type="string",gc.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ot){a.indexOf("<"+ot)>=0&&(i=!0)}),i)return Sse(n,r);Vu={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],d,h={},m=[],x=r.dense?[]:{},g="",y={},v={},b=qa('<Data ss:Type="String">'),N=0,E=0,S=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},k={},P="",D=0,R=[],q={},M={},z=0,ie=[],ce=[],ae={},me=[],de,he=!1,J=[],xe=[],te={},O=0,K=0,W={Sheets:[],WBProps:{date1904:!1}},X={};df.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var V="";c=df.exec(n);)switch(c[3]=(V=c[3]).toLowerCase()){case"data":if(V=="data"){if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?Mie(n.slice(N,c.index),P,b,f[f.length-1][0]=="comment"?ae:y,{c:E,r:S},T,me[E],v,J,r):(P="",b=qa(c[0]),N=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ce.length>0&&(y.c=ce),(!r.sheetRows||r.sheetRows>S)&&y.v!==void 0&&(r.dense?(x[S]||(x[S]=[]),x[S][E]=y):x[sr(E)+vr(S)]=y),y.HRef&&(y.l={Target:yt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(O=E+(parseInt(y.MergeAcross,10)|0),K=S+(parseInt(y.MergeDown,10)|0),R.push({s:{c:E,r:S},e:{c:O,r:K}})),!r.sheetStubs)y.MergeAcross?E=O+1:++E;else if(y.MergeAcross||y.MergeDown){for(var ne=E;ne<=O;++ne)for(var L=S;L<=K;++L)(ne>E||L>S)&&(r.dense?(x[L]||(x[L]=[]),x[L][ne]={t:"z"}):x[sr(ne)+vr(L)]={t:"z"});E=O+1}else++E;else y=Pie(c[0]),y.Index&&(E=+y.Index-1),E<C.s.c&&(C.s.c=E),E>C.e.c&&(C.e.c=E),c[0].slice(-2)==="/>"&&++E,ce=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(S<C.s.r&&(C.s.r=S),S>C.e.r&&(C.e.r=S),c[0].slice(-2)==="/>"&&(v=qa(c[0]),v.Index&&(S=+v.Index-1)),E=0,++S):(v=qa(c[0]),v.Index&&(S=+v.Index-1),te={},(v.AutoFitHeight=="0"||v.Height)&&(te.hpx=parseInt(v.Height,10),te.hpt=gf(te.hpx),xe[S]=te),v.Hidden=="1"&&(te.hidden=!0,xe[S]=te));break;case"worksheet":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));m.push(g),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(x["!ref"]=ht(C),r.sheetRows&&r.sheetRows<=C.e.r&&(x["!fullref"]=x["!ref"],C.e.r=r.sheetRows-1,x["!ref"]=ht(C))),R.length&&(x["!merges"]=R),me.length>0&&(x["!cols"]=me),xe.length>0&&(x["!rows"]=xe),h[g]=x}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=E=0,f.push([c[3],!1]),d=qa(c[0]),g=yt(d.Name),x=r.dense?[]:{},R=[],J=[],xe=[],X={name:g,Hidden:0},W.Sheets.push(X);break;case"table":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),me=[],he=!1}break;case"style":c[1]==="/"?Iie(T,k,r):k=qa(c[0]);break;case"numberformat":k.nf=yt(qa(c[0]).Format||"General"),Vu[k.nf]&&(k.nf=Vu[k.nf]);for(var U=0;U!=392&&it[U]!=k.nf;++U);if(U==392){for(U=57;U!=392;++U)if(it[U]==null){Gi(k.nf,U);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(de=qa(c[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!he&&de.wpx>10){he=!0,Sn=AO;for(var H=0;H<me.length;++H)me[H]&&Xs(me[H])}he&&Xs(de),me[de.Index-1||me.length]=de;for(var oe=0;oe<+de.Span;++oe)me[me.length]=qt(de);break;case"namedrange":if(c[1]==="/")break;W.Names||(W.Names=[]);var F=lt(c[0]),Ae={Name:F.Name,Ref:rc(F.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(Ae.Sheet=W.Sheets.length-1),W.Names.push(Ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?P+=n.slice(D,c.index):D=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=qa(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?oJ(q,V,n.slice(z,c.index)):z=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));Rie(ae),ce.push(ae)}else f.push([c[3],!1]),d=qa(c[0]),ae={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var je=qa(c[0]);x["!autofilter"]={ref:rc(je.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return Zj(n,r);var Le=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Le=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Le=!1}break;case"excelworkbook":switch(c[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Le=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Le=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(z,c.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else z=c.index+c[0].length;break;case"header":x["!margins"]||Uo(x["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(x["!margins"].header=+lt(c[0]).Margin);break;case"footer":x["!margins"]||Uo(x["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(x["!margins"].footer=+lt(c[0]).Margin);break;case"pagemargins":var Ue=lt(c[0]);x["!margins"]||Uo(x["!margins"]={},"xlml"),isNaN(+Ue.Top)||(x["!margins"].top=+Ue.Top),isNaN(+Ue.Left)||(x["!margins"].left=+Ue.Left),isNaN(+Ue.Right)||(x["!margins"].right=+Ue.Right),isNaN(+Ue.Bottom)||(x["!margins"].bottom=+Ue.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Le=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Le=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Le=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Le=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Le=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Le=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Le=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Le=!1}break;case"smarttags":break;default:Le=!1;break}if(Le||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?Fie(M,V,ie,n.slice(z,c.index)):(ie=c,z=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var Pe={};return!r.bookSheets&&!r.bookProps&&(Pe.Sheets=h),Pe.SheetNames=m,Pe.Workbook=W,Pe.SSF=qt(it),Pe.Props=q,Pe.Custprops=M,Pe}function d1(e,t){switch(Zw(t=t||{}),t.type||"base64"){case"base64":return tv(pa(e),t);case"binary":case"buffer":case"file":return tv(e,t);case"array":return tv(no(e),t)}}function Lie(e,t){var r=[];return e.Props&&r.push(lJ(e.Props,t)),e.Custprops&&r.push(cJ(e.Props,e.Custprops)),r.join("")}function Bie(){return""}function $ie(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Be("NumberFormat",null,{"ss:Format":It(it[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Be("Style",i.join(""),s))}),Be("Styles",r.join(""))}function r6(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Gw(e.Ref,{r:0,c:0})})}function Uie(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(r6(a)))}return Be("Names",r.join(""))}function zie(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var c=a[s];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(r6(c)))}return i.join("")}function Wie(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(fn("ProtectContents","True")),e["!protect"].objects&&a.push(fn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(fn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(fn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(fn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Be("WorksheetOptions",a.join(""),{xmlns:ia.x})}function Hie(e){return e.map(function(t){var r=fY(t.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":t.a})}).join("")}function Vie(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+It(Gw(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var f=or(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==s.r?"":"["+(f.r-s.r)+"]")+"C"+(f.c==s.c?"":"["+(f.c-s.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=It(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=It(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],h=0;h!=d.length;++h)d[h].s.c!=s.c||d[h].s.r!=s.r||(d[h].e.c>d[h].s.c&&(c["ss:MergeAcross"]=d[h].e.c-d[h].s.c),d[h].e.r>d[h].s.r&&(c["ss:MergeDown"]=d[h].e.r-d[h].s.r));var m="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",x=String(e.v);break;case"b":m="Boolean",x=e.v?"1":"0";break;case"e":m="Error",x=cs[e.v];break;case"d":m="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||it[14]);break;case"s":m="String",x=uY(e.v||"");break}var g=io(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+g),c["ss:Index"]=s.c+1;var y=e.v!=null?x:"",v=e.t=="z"?"":'<Data ss:Type="'+m+'">'+y+"</Data>";return(e.c||[]).length>0&&(v+=Hie(e.c)),Be("Cell",v,c)}function Kie(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=vc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Gie(e,t,r,n){if(!e["!ref"])return"";var a=bt(e["!ref"]),i=e["!merges"]||[],s=0,c=[];e["!cols"]&&e["!cols"].forEach(function(b,N){Xs(b);var E=!!b.width,S=jm(N,b),C={"ss:Index":N+1};E&&(C["ss:Width"]=pf(S.width)),b.hidden&&(C["ss:Hidden"]="1"),c.push(Be("Column",null,C))});for(var f=Array.isArray(e),d=a.s.r;d<=a.e.r;++d){for(var h=[Kie(d,(e["!rows"]||[])[d])],m=a.s.c;m<=a.e.c;++m){var x=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>m)&&!(i[s].s.r>d)&&!(i[s].e.c<m)&&!(i[s].e.r<d)){(i[s].s.c!=m||i[s].s.r!=d)&&(x=!0);break}if(!x){var g={r:d,c:m},y=st(g),v=f?(e[d]||[])[m]:e[y];h.push(Vie(v,y,e,t,r,n,g))}}h.push("</Row>"),h.length>2&&c.push(h.join(""))}return c.join("")}function Xie(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?zie(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Gie(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Wie(i,t,e,r)),n.join("")}function qie(e,t){t||(t={}),e.SSF||(e.SSF=qt(it)),e.SSF&&(Oc(),wm(e.SSF),t.revssf=Sm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],io(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Lie(e,t)),r.push(Bie()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Be("Worksheet",Xie(n,t,e),{"ss:Name":It(e.SheetNames[n])}));return r[2]=$ie(e,t),r[3]=Uie(e),wr+Be("Workbook",r.join(""),{xmlns:ia.ss,"xmlns:o":ia.o,"xmlns:x":ia.x,"xmlns:ss":ia.ss,"xmlns:dt":ia.dt,"xmlns:html":ia.html})}function Yie(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=UY(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=zY(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Jie=[60,1084,2066,2165,2175];function Qie(e,t,r,n,a){var i=n,s=[],c=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}s.push(c),r.l+=i;for(var f=Wi(r,r.l),d=h1[f],h=0;d!=null&&Jie.indexOf(f)>-1;)i=Wi(r,r.l+2),h=r.l+4,f==2066?h+=4:(f==2165||f==2175)&&(h+=12),c=r.slice(h,r.l+4+i),s.push(c),r.l+=4+i,d=h1[f=Wi(r,r.l)];var m=Gr(s);cn(m,0);var x=0;m.lens=[];for(var g=0;g<s.length;++g)m.lens.push(x),x+=s[g].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,a)}function ui(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=it[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||cs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cf(e.v):e.w=Jo(e.v):e.w=La(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Pc(it[n]||String(n))){var a=Fo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function E0(e,t,r){return{v:e,ixfe:t,t:r}}function Zie(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},c=null,f=[],d="",h={},m,x="",g,y,v,b,N={},E=[],S,C,T=[],k=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},R=function(ut){return ut<8?Lo[ut]:ut<64&&k[ut-8]||Lo[ut]},q=function(ut,Ct,se){var ke=Ct.XF.data;if(!(!ke||!ke.patternType||!se||!se.cellStyles)){Ct.s={},Ct.s.patternType=ke.patternType;var Ke;(Ke=mf(R(ke.icvFore)))&&(Ct.s.fgColor={rgb:Ke}),(Ke=mf(R(ke.icvBack)))&&(Ct.s.bgColor={rgb:Ke})}},M=function(ut,Ct,se){if(!(te>1)&&!(se.sheetRows&&ut.r>=se.sheetRows)){if(se.cellStyles&&Ct.XF&&Ct.XF.data&&q(ut,Ct,se),delete Ct.ixfe,delete Ct.XF,m=ut,x=st(ut),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<s.s.r&&(s.s.r=ut.r),ut.c<s.s.c&&(s.s.c=ut.c),ut.r+1>s.e.r&&(s.e.r=ut.r+1),ut.c+1>s.e.c&&(s.e.c=ut.c+1),se.cellFormula&&Ct.f){for(var ke=0;ke<E.length;++ke)if(!(E[ke][0].s.c>ut.c||E[ke][0].s.r>ut.r)&&!(E[ke][0].e.c<ut.c||E[ke][0].e.r<ut.r)){Ct.F=ht(E[ke][0]),(E[ke][0].s.c!=ut.c||E[ke][0].s.r!=ut.r)&&delete Ct.f,Ct.f&&(Ct.f=""+wn(E[ke][1],s,ut,J,z));break}}se.dense?(a[ut.r]||(a[ut.r]=[]),a[ut.r][ut.c]=Ct):a[x]=Ct}},z={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(z.password=t.password);var ie,ce=[],ae=[],me=[],de=[],he=!1,J=[];J.SheetNames=z.snames,J.sharedf=z.sharedf,J.arrayf=z.arrayf,J.names=[],J.XTI=[];var xe=0,te=0,O=0,K=[],W=[],X;z.codepage=1200,Za(1200);for(var V=!1;e.l<e.length-1;){var ne=e.l,L=e.read_shift(2);if(L===0&&xe===10)break;var U=e.l===e.length?0:e.read_shift(2),H=h1[L];if(H&&H.f){if(t.bookSheets&&xe===133&&L!==133)break;if(xe=L,H.r===2||H.r==12){var oe=e.read_shift(2);if(U-=2,!z.enc&&oe!==L&&((oe&255)<<8|oe>>8)!==L)throw new Error("rt mismatch: "+oe+"!="+L);H.r==12&&(e.l+=10,U-=10)}var F={};if(L===10?F=H.f(e,U,z):F=Qie(L,H,e,U,z),te==0&&[9,521,1033,2057].indexOf(xe)===-1)continue;switch(L){case 34:r.opts.Date1904=P.WBProps.date1904=F;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(z.enc||(e.l=0),z.enc=F,!t.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:z.lastuser=F;break;case 66:var Ae=Number(F);switch(Ae){case 21010:Ae=1200;break;case 32768:Ae=1e4;break;case 32769:Ae=1252;break}Za(z.codepage=Ae),V=!0;break;case 317:z.rrtabid=F;break;case 25:z.winlocked=F;break;case 439:r.opts.RefreshAll=F;break;case 12:r.opts.CalcCount=F;break;case 16:r.opts.CalcDelta=F;break;case 17:r.opts.CalcIter=F;break;case 13:r.opts.CalcMode=F;break;case 14:r.opts.CalcPrecision=F;break;case 95:r.opts.CalcSaveRecalc=F;break;case 15:z.CalcRefMode=F;break;case 2211:r.opts.FullCalc=F;break;case 129:F.fDialog&&(a["!type"]="dialog"),F.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),F.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:T.push(F);break;case 430:J.push([F]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(F);break;case 24:case 536:X={Name:F.Name,Ref:wn(F.rgce,s,null,J,z)},F.itab>0&&(X.Sheet=F.itab-1),J.names.push(X),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(W[F.itab-1]={ref:ht(F.rgce[0][0][1][2])});break;case 22:z.ExternCount=F;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(F),J.XTI=J.XTI.concat(F);break;case 2196:if(z.biff<8)break;X!=null&&(X.Comment=F[1]);break;case 18:a["!protect"]=F;break;case 19:F!==0&&z.WTF&&console.error("Password verifier: "+F);break;case 133:i[F.pos]=F,z.snames.push(F.name);break;case 10:{if(--te)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=ht(s),t.sheetRows&&t.sheetRows<=s.e.r){var je=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=ht(s),s.e.r=je}s.e.r++,s.e.c++}ce.length>0&&(a["!merges"]=ce),ae.length>0&&(a["!objects"]=ae),me.length>0&&(a["!cols"]=me),de.length>0&&(a["!rows"]=de),P.Sheets.push(D)}d===""?h=a:n[d]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(z.biff===8&&(z.biff={9:2,521:3,1033:4}[L]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),z.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(z.biff=5,V=!0,Za(z.codepage=28591)),z.biff==8&&F.BIFFVer==0&&F.dt==16&&(z.biff=2),te++)break;if(a=t.dense?[]:{},z.biff<8&&!V&&(V=!0,Za(z.codepage=t.codepage||1252)),z.biff<5||F.BIFFVer==0&&F.dt==4096){d===""&&(d="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Le={pos:e.l-U,name:d};i[Le.pos]=Le,z.snames.push(d)}else d=(i[ne]||{name:""}).name;F.dt==32&&(a["!type"]="chart"),F.dt==64&&(a["!type"]="macro"),ce=[],ae=[],z.arrayf=E=[],me=[],de=[],he=!1,D={Hidden:(i[ne]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[F.r]||[])[F.c]:a[st({c:F.c,r:F.r})])&&++F.c,S={ixfe:F.ixfe,XF:T[F.ixfe]||{},v:F.val,t:"n"},O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 5:case 517:S={ixfe:F.ixfe,XF:T[F.ixfe],v:F.val,t:F.t},O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 638:S={ixfe:F.ixfe,XF:T[F.ixfe],v:F.rknum,t:"n"},O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 189:for(var Ue=F.c;Ue<=F.C;++Ue){var Pe=F.rkrec[Ue-F.c][0];S={ixfe:Pe,XF:T[Pe],v:F.rkrec[Ue-F.c][1],t:"n"},O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M({c:Ue,r:F.r},S,t)}break;case 6:case 518:case 1030:{if(F.val=="String"){c=F;break}if(S=E0(F.val,F.cell.ixfe,F.tt),S.XF=T[S.ixfe],t.cellFormula){var ot=F.formula;if(ot&&ot[0]&&ot[0][0]&&ot[0][0][0]=="PtgExp"){var kt=ot[0][0][1][0],Yt=ot[0][0][1][1],jt=st({r:kt,c:Yt});N[jt]?S.f=""+wn(F.formula,s,F.cell,J,z):S.F=((t.dense?(a[kt]||[])[Yt]:a[jt])||{}).F}else S.f=""+wn(F.formula,s,F.cell,J,z)}O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M(F.cell,S,t),c=F}break;case 7:case 519:if(c)c.val=F,S=E0(F,c.cell.ixfe,"s"),S.XF=T[S.ixfe],t.cellFormula&&(S.f=""+wn(c.formula,s,c.cell,J,z)),O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M(c.cell,S,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(F);var za=st(F[0].s);if(g=t.dense?(a[F[0].s.r]||[])[F[0].s.c]:a[za],t.cellFormula&&g){if(!c||!za||!g)break;g.f=""+wn(F[1],s,F[0],J,z),g.F=ht(F[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!c)break;N[st(c.cell)]=F[0],g=t.dense?(a[c.cell.r]||[])[c.cell.c]:a[st(c.cell)],(g||{}).f=""+wn(F[0],s,m,J,z)}}break;case 253:S=E0(f[F.isst].t,F.ixfe,"s"),f[F.isst].h&&(S.h=f[F.isst].h),S.XF=T[S.ixfe],O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:F.ixfe,XF:T[F.ixfe],t:"z"},O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t));break;case 190:if(t.sheetStubs)for(var Rn=F.c;Rn<=F.C;++Rn){var Br=F.ixfe[Rn-F.c];S={ixfe:Br,XF:T[Br],t:"z"},O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M({c:Rn,r:F.r},S,t)}break;case 214:case 516:case 4:S=E0(F.val,F.ixfe,"s"),S.XF=T[S.ixfe],O>0&&(S.z=K[S.ixfe>>8&63]),ui(S,t,r.opts.Date1904),M({c:F.c,r:F.r},S,t);break;case 0:case 512:te===1&&(s=F);break;case 252:f=F;break;case 1054:if(z.biff==4){K[O++]=F[1];for(var tr=0;tr<O+163&&it[tr]!=F[1];++tr);tr>=163&&Gi(F[1],O+163)}else Gi(F[1],F[0]);break;case 30:{K[O++]=F;for(var Ln=0;Ln<O+163&&it[Ln]!=F;++Ln);Ln>=163&&Gi(F,O+163)}break;case 229:ce=ce.concat(F);break;case 93:ae[F.cmo[0]]=z.lastobj=F;break;case 438:z.lastobj.TxO=F;break;case 127:z.lastobj.ImData=F;break;case 440:for(b=F[0].s.r;b<=F[0].e.r;++b)for(v=F[0].s.c;v<=F[0].e.c;++v)g=t.dense?(a[b]||[])[v]:a[st({c:v,r:b})],g&&(g.l=F[1]);break;case 2048:for(b=F[0].s.r;b<=F[0].e.r;++b)for(v=F[0].s.c;v<=F[0].e.c;++v)g=t.dense?(a[b]||[])[v]:a[st({c:v,r:b})],g&&g.l&&(g.l.Tooltip=F[1]);break;case 28:{if(z.biff<=5&&z.biff>=2)break;g=t.dense?(a[F[0].r]||[])[F[0].c]:a[st(F[0])];var en=ae[F[2]];g||(t.dense?(a[F[0].r]||(a[F[0].r]=[]),g=a[F[0].r][F[0].c]={t:"z"}):g=a[st(F[0])]={t:"z"},s.e.r=Math.max(s.e.r,F[0].r),s.s.r=Math.min(s.s.r,F[0].r),s.e.c=Math.max(s.e.c,F[0].c),s.s.c=Math.min(s.s.c,F[0].c)),g.c||(g.c=[]),y={a:F[1],t:en.TxO.t},g.c.push(y)}break;case 2173:$ee(T[F.ixfe],F.ext);break;case 125:{if(!z.cellStyles)break;for(;F.e>=F.s;)me[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},he||(he=!0,Hw(F.w/256)),Xs(me[F.e+1])}break;case 520:{var rr={};F.level!=null&&(de[F.r]=rr,rr.level=F.level),F.hidden&&(de[F.r]=rr,rr.hidden=!0),F.hpt&&(de[F.r]=rr,rr.hpt=F.hpt,rr.hpx=vc(F.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Uo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[L]]=F;break;case 161:a["!margins"]||Uo(a["!margins"]={}),a["!margins"].header=F.header,a["!margins"].footer=F.footer;break;case 574:F.RTL&&(P.Views[0].RTL=!0);break;case 146:k=F;break;case 2198:ie=F;break;case 140:C=F;break;case 442:d?D.CodeName=F||D.name:P.WBProps.CodeName=F||"ThisWorkbook";break}}else H||console.error("Missing Info for XLS Record 0x"+L.toString(16)),e.l+=U}return r.SheetNames=dr(i).sort(function(Cn,ut){return Number(Cn)-Number(ut)}).map(function(Cn){return i[Cn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&W.forEach(function(Cn,ut){r.Sheets[r.SheetNames[ut]]["!autofilter"]=Cn}),r.Strings=f,r.SSF=qt(it),z.enc&&(r.Encryption=z.enc),ie&&(r.Themes=ie),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),J.names.length>0&&(P.Names=J.names),r.Workbook=P,r}var Ku={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ese(e,t,r){var n=tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Aj(n,s1,Ku.DSI);for(var i in a)t[i]=a[i]}catch(d){if(r.WTF)throw d}var s=tt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var c=Aj(s,o1,Ku.SI);for(var f in c)t[f]==null&&(t[f]=c[f])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(tO(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function tse(e,t){var r=[],n=[],a=[],i=0,s,c=ij(s1,"n"),f=ij(o1,"n");if(e.Props)for(s=dr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(c,s[i])?r:Object.prototype.hasOwnProperty.call(f,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=dr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(c,s[i])?r:Object.prototype.hasOwnProperty.call(f,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var d=[];for(i=0;i<a.length;++i)lO.indexOf(a[i][0])>-1||eO.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&tt.utils.cfb_add(t,"/SummaryInformation",Tj(n,Ku.SI,f,o1)),(r.length||d.length)&&tt.utils.cfb_add(t,"/DocumentSummaryInformation",Tj(r,Ku.DSI,c,s1,d.length?d:null,Ku.UDI))}function n6(e,t){t||(t={}),Zw(t),ww(),t.codepage&&yw(t.codepage);var r,n;if(e.FullPaths){if(tt.find(e,"/encryption"))throw new Error("File is password-protected");r=tt.find(e,"!CompObj"),n=tt.find(e,"/Workbook")||tt.find(e,"/Book")}else{switch(t.type){case"base64":e=la(pa(e));break;case"binary":e=la(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}cn(e,0),n={content:e}}var a,i;if(r&&Yie(r),t.bookProps&&!t.bookSheets)a={};else{var s=pt?"buffer":"array";if(n&&n.content)a=Zie(n.content,t);else if((i=tt.find(e,"PerfectOffice_MAIN"))&&i.content)a=$o.to_workbook(i.content,(t.type=s,t));else if((i=tt.find(e,"NativeContent_MAIN"))&&i.content)a=$o.to_workbook(i.content,(t.type=s,t));else throw(i=tt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=mte(e))}var c={};return e.FullPaths&&ese(e,c,t),a.Props=a.Custprops=c,t.bookFiles&&(a.cfb=e),a}function rse(e,t){var r=t||{},n=tt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,a,a6(e,r)),r.biff==8&&(e.Props||e.Custprops)&&tse(e,n),r.biff==8&&e.vbaraw&&pte(n,tt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var vf={0:{f:kne},1:{f:Dne},2:{f:Zne},3:{f:zne},4:{f:Lne},5:{f:Yne},6:{f:aae},7:{f:Kne},8:{f:fae},9:{f:uae},10:{f:lae},11:{f:cae},12:{f:Mne},13:{f:tae},14:{f:Hne},15:{f:$ne},16:{f:qO},17:{f:sae},18:{f:Xne},19:{f:Dw},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:sie},40:{},42:{},43:{f:aee},44:{f:ree},45:{f:oee},46:{f:cee},47:{f:lee},48:{},49:{f:AY},50:{},51:{f:Wee},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yO},62:{f:nae},63:{f:Qee},64:{f:jae},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:kn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Nae},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:One},148:{f:Ane,p:16},151:{f:gae},152:{},153:{f:nie},154:{},155:{},156:{f:tie},157:{},158:{},159:{T:1,f:yZ},160:{T:-1},161:{T:1,f:hl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dae},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Uee},336:{T:-1},337:{f:Kee,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:i1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:vae},427:{f:yae},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:bae},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Pne},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:pae},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:i1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cte},633:{T:1},634:{T:-1},635:{T:1,f:ote},636:{T:-1},637:{f:FY},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Hae},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Cae},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},h1={6:{f:Zg},10:{f:Ps},12:{f:_r},13:{f:_r},14:{f:xr},15:{f:xr},16:{f:Nn},17:{f:xr},18:{f:xr},19:{f:_r},20:{f:Mj},21:{f:Mj},23:{f:vO},24:{f:Lj},25:{f:xr},26:{},27:{},28:{f:CQ},29:{},34:{f:xr},35:{f:Rj},38:{f:Nn},39:{f:Nn},40:{f:Nn},41:{f:Nn},42:{f:xr},43:{f:xr},47:{f:$Z},49:{f:tQ},51:{f:_r},60:{},61:{f:YJ},64:{f:xr},65:{f:eQ},66:{f:_r},77:{},80:{},81:{},82:{},85:{f:_r},89:{},90:{},91:{},92:{f:BJ},93:{f:PQ},94:{},95:{f:xr},96:{},97:{},99:{f:xr},125:{f:yO},128:{f:xQ},129:{f:UJ},130:{f:_r},131:{f:xr},132:{f:xr},133:{f:zJ},134:{},140:{f:BQ},141:{f:_r},144:{},146:{f:zQ},151:{},152:{},153:{},154:{},155:{},156:{f:_r},157:{},158:{},160:{f:qQ},161:{f:VQ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:dQ},190:{f:hQ},193:{f:Ps},197:{},198:{},199:{},200:{},201:{},202:{f:xr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_r},220:{},221:{f:xr},222:{},224:{f:pQ},225:{f:LJ},226:{f:Ps},227:{},229:{f:AQ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:HJ},253:{f:nQ},255:{f:KJ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:cO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:xr},353:{f:Ps},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:bQ},431:{f:xr},432:{},433:{},434:{},437:{},438:{f:DQ},439:{f:xr},440:{f:IQ},441:{},442:{f:Wf},443:{},444:{f:_r},445:{},446:{},448:{f:Ps},449:{f:qJ,r:2},450:{f:Ps},512:{f:Fj},513:{f:XQ},515:{f:yQ},516:{f:iQ},517:{f:Ij},519:{f:YQ},520:{f:GJ},523:{},545:{f:Bj},549:{f:Oj},566:{},574:{f:QJ},638:{f:fQ},659:{},1048:{},1054:{f:oQ},1084:{},1212:{f:EQ},2048:{f:RQ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:S0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ps},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:WQ,r:12},2173:{f:Bee,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:xr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_Q,r:12},2197:{},2198:{f:Fee,r:12},2199:{},2200:{},2201:{},2202:{f:kQ,r:12},2203:{f:Ps},2204:{},2205:{},2206:{},2207:{},2211:{f:XJ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:KQ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:UQ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Fj},1:{},2:{f:tZ},3:{f:ZQ},4:{f:QQ},5:{f:Ij},7:{f:nZ},8:{},9:{f:S0},11:{},22:{f:_r},30:{f:cQ},31:{},32:{},33:{f:Bj},36:{},37:{f:Oj},50:{f:aZ},62:{},52:{},67:{},68:{f:_r},69:{},86:{},126:{},127:{f:JQ},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:iZ},223:{},234:{},354:{},421:{},518:{f:Zg},521:{f:S0},536:{f:Lj},547:{f:Rj},561:{},579:{},1030:{f:Zg},1033:{f:S0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function $e(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Pw(r)&&e.push(r)}}function nse(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return $e(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],c=0,f=0,d=0;d+(s[c]||8224)<=8224;)d+=s[c]||8224,c++;var h=e.next(4);for(h.write_shift(2,i),h.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d;f<a;){for(h=e.next(4),h.write_shift(2,60),d=0;d+(s[c]||8224)<=8224;)d+=s[c]||8224,c++;h.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d}}}function Gf(e,t,r){return e||(e=_e(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function ase(e,t,r,n){var a=_e(9);return Gf(a,e,t),uO(r,n||"b",a),a}function ise(e,t,r){var n=_e(8+2*r.length);return Gf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function sse(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Ir(Xt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?$e(e,2,rZ(r,n,a)):$e(e,3,eZ(r,n,a));return;case"b":case"e":$e(e,5,ase(r,n,t.v,t.t));return;case"s":case"str":$e(e,4,ise(r,n,(t.v||"").slice(0,255)));return}$e(e,1,Gf(null,r,n))}function ose(e,t,r,n){var a=Array.isArray(t),i=bt(t["!ref"]||"A1"),s,c="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=ht(i)}for(var d=i.s.r;d<=i.e.r;++d){c=vr(d);for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(f[h]=sr(h)),s=f[h]+c;var m=a?(t[d]||[])[h]:t[s];m&&sse(e,m,d,h)}}}function lse(e,t){for(var r=t||{},n=qn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return $e(n,r.biff==4?1033:r.biff==3?521:9,Uw(e,16,r)),ose(n,e.Sheets[e.SheetNames[a]],a,r),$e(n,10),n.end()}function cse(e,t,r){$e(e,49,rQ({sz:12,name:"Arial"},r))}function use(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&$e(e,1054,lQ(a,t[a],r))})}function fse(e,t){var r=_e(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),$e(e,2151,r),r=_e(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),pO(bt(t["!ref"]||"A1"),r),r.write_shift(4,4),$e(e,2152,r)}function dse(e,t){for(var r=0;r<16;++r)$e(e,224,Dj({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){$e(e,224,Dj(n,0,t))})}function hse(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];$e(e,440,MQ(n)),n[1].Tooltip&&$e(e,2048,LQ(n))}delete t["!links"]}function mse(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&$e(e,125,HQ(jm(a,n),a))})}}function pse(e,t,r,n,a){var i=16+io(a.cellXfs,t,a);if(t.v==null&&!t.bf){$e(e,513,tl(r,n,i));return}if(t.bf)$e(e,6,Ure(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Ir(Xt(t.v)):t.v;$e(e,515,wQ(r,n,s,i));break;case"b":case"e":$e(e,517,vQ(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var c=qw(a.Strings,t.v,a.revStrings);$e(e,253,aQ(r,n,c,i))}else $e(e,516,sQ(r,n,(t.v||"").slice(0,255),i,a));break;default:$e(e,513,tl(r,n,i))}}function xse(e,t,r){var n=qn(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},c=(s.Sheets||[])[e]||{},f=Array.isArray(i),d=t.biff==8,h,m="",x=[],g=bt(i["!ref"]||"A1"),y=d?65536:16384;if(g.e.c>255||g.e.r>=y){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,y-1)}$e(n,2057,Uw(r,16,t)),$e(n,13,Oa(1)),$e(n,12,Oa(100)),$e(n,15,On(!0)),$e(n,17,On(!1)),$e(n,16,Zo(.001)),$e(n,95,On(!0)),$e(n,42,On(!1)),$e(n,43,On(!1)),$e(n,130,Oa(1)),$e(n,128,gQ()),$e(n,131,On(!1)),$e(n,132,On(!1)),d&&mse(n,i["!cols"]),$e(n,512,uQ(g,t)),d&&(i["!links"]=[]);for(var v=g.s.r;v<=g.e.r;++v){m=vr(v);for(var b=g.s.c;b<=g.e.c;++b){v===g.s.r&&(x[b]=sr(b)),h=x[b]+m;var N=f?(i[v]||[])[b]:i[h];N&&(pse(n,N,v,b,t),d&&N.l&&i["!links"].push([h,N.l]))}}var E=c.CodeName||c.name||a;return d&&$e(n,574,ZJ((s.Views||[])[0])),d&&(i["!merges"]||[]).length&&$e(n,229,TQ(i["!merges"])),d&&hse(n,i),$e(n,442,fO(E)),d&&fse(n,i),$e(n,10),n.end()}function gse(e,t,r){var n=qn(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},c=r.biff==8,f=r.biff==5;if($e(n,2057,Uw(e,5,r)),r.bookType=="xla"&&$e(n,135),$e(n,225,c?Oa(1200):null),$e(n,193,vJ(2)),f&&$e(n,191),f&&$e(n,192),$e(n,226),$e(n,92,$J("SheetJS",r)),$e(n,66,Oa(c?1200:1252)),c&&$e(n,353,Oa(0)),c&&$e(n,448),$e(n,317,GQ(e.SheetNames.length)),c&&e.vbaraw&&$e(n,211),c&&e.vbaraw){var d=s.CodeName||"ThisWorkbook";$e(n,442,fO(d))}$e(n,156,Oa(17)),$e(n,25,On(!1)),$e(n,18,On(!1)),$e(n,19,Oa(0)),c&&$e(n,431,On(!1)),c&&$e(n,444,Oa(0)),$e(n,61,JJ()),$e(n,64,On(!1)),$e(n,141,Oa(0)),$e(n,34,On(qae(e)=="true")),$e(n,14,On(!0)),c&&$e(n,439,On(!1)),$e(n,218,Oa(0)),cse(n,e,r),use(n,e.SSF,r),dse(n,r),c&&$e(n,352,On(!1));var h=n.end(),m=qn();c&&$e(m,140,$Q()),c&&r.Strings&&nse(m,252,VJ(r.Strings)),$e(m,10);var x=m.end(),g=qn(),y=0,v=0;for(v=0;v<e.SheetNames.length;++v)y+=(c?12:11)+(c?2:1)*e.SheetNames[v].length;var b=h.length+y+x.length;for(v=0;v<e.SheetNames.length;++v){var N=i[v]||{};$e(g,133,WJ({pos:b,hs:N.Hidden||0,dt:0,name:e.SheetNames[v]},r)),b+=t[v].length}var E=g.end();if(y!=E.length)throw new Error("BS8 "+y+" != "+E.length);var S=[];return h.length&&S.push(h),E.length&&S.push(E),x.length&&S.push(x),Gr(S)}function vse(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=qt(it)),e&&e.SSF&&(Oc(),wm(e.SSF),r.revssf=Sm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,eb(r),r.cellXfs=[],io(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=xse(a,r,e);return n.unshift(gse(e,n,r)),Gr(n)}function a6(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Jn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return vse(e,t);case 4:case 3:case 2:return lse(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function qj(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,c=i&&i.index||e.length,f=rY(e.slice(s,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,m=0,x=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(s=0;s<f.length;++s){var v=f[s].trim(),b=v.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}h=0;continue}if(!(b!="<td"&&b!="<th")){var N=v.split(/<\/t[dh]>/i);for(c=0;c<N.length;++c){var E=N[c].trim();if(E.match(/<t[dh]/i)){for(var S=E,C=0;S.charAt(0)=="<"&&(C=S.indexOf(">"))>-1;)S=S.slice(C+1);for(var T=0;T<y.length;++T){var k=y[T];k.s.c==h&&k.s.r<d&&d<=k.e.r&&(h=k.e.c+1,T=-1)}var P=lt(E.slice(0,E.indexOf(">")));x=P.colspan?+P.colspan:1,((m=+P.rowspan)>1||x>1)&&y.push({s:{r:d,c:h},e:{r:d+(m||1)-1,c:h+x-1}});var D=P.t||P["data-t"]||"";if(!S.length){h+=x;continue}if(S=CP(S),g.s.r>d&&(g.s.r=d),g.e.r<d&&(g.e.r=d),g.s.c>h&&(g.s.c=h),g.e.c<h&&(g.e.c=h),!S.length){h+=x;continue}var R={t:"s",v:S};r.raw||!S.trim().length||D=="s"||(S==="TRUE"?R={t:"b",v:!0}:S==="FALSE"?R={t:"b",v:!1}:isNaN(ti(S))?isNaN(xc(S).getDate())||(R={t:"d",v:Xt(S)},r.cellDates||(R={t:"n",v:Ir(R.v)}),R.z=r.dateNF||it[14]):R={t:"n",v:ti(S)}),r.dense?(n[d]||(n[d]=[]),n[d][h]=R):n[st({r:d,c:h})]=R,h+=x}}}}return n["!ref"]=ht(g),y.length&&(n["!merges"]=y),n}function yse(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var c=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>s)&&!(a[d].e.r<r||a[d].e.c<s)){if(a[d].s.r<r||a[d].s.c<s){c=-1;break}c=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(c<0)){var h=st({r,c:s}),m=n.dense?(e[r]||[])[s]:e[h],x=m&&m.v!=null&&(m.h||Cw(m.w||(es(m),m.w)||""))||"",g={};c>1&&(g.rowspan=c),f>1&&(g.colspan=f),n.editable?x='<span contenteditable="true">'+x+"</span>":m&&(g["data-t"]=m&&m.t||"z",m.v!=null&&(g["data-v"]=m.v),m.z!=null&&(g["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+m.l.Target+'">'+x+"</a>")),g.id=(n.id||"sjs")+"-"+h,i.push(Be("td",x,g))}}var y="<tr>";return y+i.join("")+"</tr>"}var wse='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bse="</body></html>";function Sse(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ao(qj(r[0],t),t);var n=nb();return r.forEach(function(a,i){ab(n,qj(a,t),"Sheet"+(i+1))}),n}function Nse(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function i6(e,t){var r=t||{},n=r.header!=null?r.header:wse,a=r.footer!=null?r.footer:bse,i=[n],s=Jn(e["!ref"]);r.dense=Array.isArray(e),i.push(Nse(e,s,r));for(var c=s.s.r;c<=s.e.r;++c)i.push(yse(e,s,c,r));return i.push("</table>"+a),i.join("")}function s6(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?or(n.origin):n.origin;a=s.r,i=s.c}var c=t.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var h=Jn(e["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),a==-1&&(d.e.r=a=h.e.r+1)}var m=[],x=0,g=e["!rows"]||(e["!rows"]=[]),y=0,v=0,b=0,N=0,E=0,S=0;for(e["!cols"]||(e["!cols"]=[]);y<c.length&&v<f;++y){var C=c[y];if(Yj(C)){if(n.display)continue;g[v]={hidden:!0}}var T=C.children;for(b=N=0;b<T.length;++b){var k=T[b];if(!(n.display&&Yj(k))){var P=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):CP(k.innerHTML),D=k.getAttribute("data-z")||k.getAttribute("z");for(x=0;x<m.length;++x){var R=m[x];R.s.c==N+i&&R.s.r<v+a&&v+a<=R.e.r&&(N=R.e.c+1-i,x=-1)}S=+k.getAttribute("colspan")||1,((E=+k.getAttribute("rowspan")||1)>1||S>1)&&m.push({s:{r:v+a,c:N+i},e:{r:v+a+(E||1)-1,c:N+i+(S||1)-1}});var q={t:"s",v:P},M=k.getAttribute("data-t")||k.getAttribute("t")||"";P!=null&&(P.length==0?q.t=M||"z":n.raw||P.trim().length==0||M=="s"||(P==="TRUE"?q={t:"b",v:!0}:P==="FALSE"?q={t:"b",v:!1}:isNaN(ti(P))?isNaN(xc(P).getDate())||(q={t:"d",v:Xt(P)},n.cellDates||(q={t:"n",v:Ir(q.v)}),q.z=n.dateNF||it[14]):q={t:"n",v:ti(P)})),q.z===void 0&&D!=null&&(q.z=D);var z="",ie=k.getElementsByTagName("A");if(ie&&ie.length)for(var ce=0;ce<ie.length&&!(ie[ce].hasAttribute("href")&&(z=ie[ce].getAttribute("href"),z.charAt(0)!="#"));++ce);z&&z.charAt(0)!="#"&&(q.l={Target:z}),n.dense?(e[v+a]||(e[v+a]=[]),e[v+a][N+i]=q):e[st({c:N+i,r:v+a})]=q,d.e.c<N+i&&(d.e.c=N+i),N+=S}}++v}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,v-1+a),e["!ref"]=ht(d),v>=f&&(e["!fullref"]=ht((d.e.r=c.length-y+v-1+a,d))),e}function o6(e,t){var r=t||{},n=r.dense?[]:{};return s6(n,e,t)}function _se(e,t){return ao(o6(e,t),t)}function Yj(e){var t="",r=Ese(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Ese(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kse(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=yt(t.replace(/<[^>]*>/g,""));return[r]}var Jj={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function l6(e,t){var r=t||{},n=Aw(e),a=[],i,s,c={name:""},f="",d=0,h,m,x={},g=[],y=r.dense?[]:{},v,b,N={value:""},E="",S=0,C=[],T=-1,k=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,R={},q=[],M={},z=0,ie=0,ce=[],ae=1,me=1,de=[],he={Names:[]},J={},xe=["",""],te=[],O={},K="",W=0,X=!1,V=!1,ne=0;for(df.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=df.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?y["!ref"]=ht(P):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(y["!fullref"]=y["!ref"],P.e.r=r.sheetRows-1,y["!ref"]=ht(P)),q.length&&(y["!merges"]=q),ce.length&&(y["!rows"]=ce),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),g.push(h.name),x[h.name]=y,V=!1):v[0].charAt(v[0].length-2)!=="/"&&(h=lt(v[0],!1),T=k=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,y=r.dense?[]:{},q=[],ce=[],V=!0);break;case"table-row-group":v[1]==="/"?--D:++D;break;case"table-row":case"":if(v[1]==="/"){T+=ae,ae=1;break}if(m=lt(v[0],!1),m.?T=m.-1:T==-1&&(T=0),ae=+m["number-rows-repeated"]||1,ae<10)for(ne=0;ne<ae;++ne)D>0&&(ce[T+ne]={level:D});k=-1;break;case"covered-table-cell":v[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(y[T]||(y[T]=[]),y[T][k]={t:"z"}):y[st({r:T,c:k})]={t:"z"}),E="",C=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++k,N=lt(v[0],!1),me=parseInt(N["number-columns-repeated"]||"1",10),b={t:"z",v:null},N.formula&&r.cellFormula!=!1&&(b.f=Kj(yt(N.formula))),(N.||N["value-type"])=="string"&&(b.t="s",b.v=yt(N["string-value"]||""),r.dense?(y[T]||(y[T]=[]),y[T][k]=b):y[st({r:T,c:k})]=b),k+=me-1;else if(v[1]!=="/"){++k,E="",S=0,C=[],me=1;var L=ae?T+ae-1:T;if(k>P.e.c&&(P.e.c=k),k<P.s.c&&(P.s.c=k),T<P.s.r&&(P.s.r=T),L>P.e.r&&(P.e.r=L),N=lt(v[0],!1),te=[],O={},b={t:N.||N["value-type"],v:null},r.cellFormula)if(N.formula&&(N.formula=yt(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(z=parseInt(N["number-matrix-rows-spanned"],10)||0,ie=parseInt(N["number-matrix-columns-spanned"],10)||0,M={s:{r:T,c:k},e:{r:T+z-1,c:k+ie-1}},b.F=ht(M),de.push([M,b.F])),N.formula)b.f=Kj(N.formula);else for(ne=0;ne<de.length;++ne)T>=de[ne][0].s.r&&T<=de[ne][0].e.r&&k>=de[ne][0].s.c&&k<=de[ne][0].e.c&&(b.F=de[ne][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(z=parseInt(N["number-rows-spanned"],10)||0,ie=parseInt(N["number-columns-spanned"],10)||0,M={s:{r:T,c:k},e:{r:T+z-1,c:k+ie-1}},q.push(M)),N["number-columns-repeated"]&&(me=parseInt(N["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=Gt(N["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(N.value);break;case"percentage":b.t="n",b.v=parseFloat(N.value);break;case"currency":b.t="n",b.v=parseFloat(N.value);break;case"date":b.t="d",b.v=Xt(N["date-value"]),r.cellDates||(b.t="n",b.v=Ir(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=Zq(N["time-value"])/86400,r.cellDates&&(b.t="d",b.v=Nm(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(N.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",N["string-value"]!=null&&(E=yt(N["string-value"]),C=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(X=!1,b.t==="s"&&(b.v=E||"",C.length&&(b.R=C),X=S==0),J.Target&&(b.l=J),te.length>0&&(b.c=te,te=[]),E&&r.cellText!==!1&&(b.w=E),X&&(b.t="z",delete b.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var U=0;U<ae;++U){if(me=parseInt(N["number-columns-repeated"]||"1",10),r.dense)for(y[T+U]||(y[T+U]=[]),y[T+U][k]=U==0?b:qt(b);--me>0;)y[T+U][k+me]=qt(b);else for(y[st({r:T+U,c:k})]=b;--me>0;)y[st({r:T+U,c:k+me})]=qt(b);P.e.c<=k&&(P.e.c=k)}me=parseInt(N["number-columns-repeated"]||"1",10),k+=me-1,me=0,b={},E="",C=[]}J={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((i=a.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((i=a.pop())[0]!==v[3])throw"Bad state: "+i;O.t=E,C.length&&(O.R=C),O.a=K,te.push(O)}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!1]);K="",W=0,E="",S=0,C=[];break;case"creator":v[1]==="/"?K=n.slice(W,v.index):W=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((i=a.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!1]);E="",S=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(R[c.name]=f,(i=a.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&(f="",c=lt(v[0],!1),a.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=lt(v[0],!1),f+=Jj[v[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=lt(v[0],!1),f+=Jj[v[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,v.index);break}else d=v.index+v[0].length;break;case"named-range":s=lt(v[0],!1),xe=ev(s["cell-range-address"]);var H={Name:s.name,Ref:xe[0]+"!"+xe[1]};V&&(H.Sheet=g.length),he.Names.push(H);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(v[1]==="/"&&(!N||!N["string-value"])){var oe=kse(n.slice(S,v.index));E=(E.length>0?E+`
`:"")+oe[0]}else lt(v[0],!1),S=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{xe=ev(lt(v[0])["target-range-address"]),x[xe[0]]["!autofilter"]={ref:xe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(J=lt(v[0],!1),!J.href)break;J.Target=yt(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(xe=ev(J.Target.slice(1)),J.Target="#"+xe[0]+"!"+xe[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var F={Sheets:x,SheetNames:g,Workbook:he};return r.bookSheets&&delete F.Sheets,F}function Qj(e,t){t=t||{},Pa(e,"META-INF/manifest.xml")&&ZY(Nr(e,"META-INF/manifest.xml"),t);var r=ca(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=l6(Rt(r),t);return Pa(e,"meta.xml")&&(n.Props=QP(Nr(e,"meta.xml"))),n}function Zj(e,t){return l6(e,t)}var jse=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ff({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return wr+t}})(),e4=(function(){var e=function(i){return It(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,c){var f=[];f.push('      <table:table table:name="'+It(s.SheetNames[c])+`" table:style-name="ta1">
`);var d=0,h=0,m=Jn(i["!ref"]||"A1"),x=i["!merges"]||[],g=0,y=Array.isArray(i);if(i["!cols"])for(h=0;h<=m.e.c;++h)f.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var v="",b=i["!rows"]||[];for(d=0;d<m.s.r;++d)v=b[d]?' table:style-name="ro'+b[d].ods+'"':"",f.push("        <table:table-row"+v+`></table:table-row>
`);for(;d<=m.e.r;++d){for(v=b[d]?' table:style-name="ro'+b[d].ods+'"':"",f.push("        <table:table-row"+v+`>
`),h=0;h<m.s.c;++h)f.push(t);for(;h<=m.e.c;++h){var N=!1,E={},S="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>h)&&!(x[g].s.r>d)&&!(x[g].e.c<h)&&!(x[g].e.r<d)){(x[g].s.c!=h||x[g].s.r!=d)&&(N=!0),E["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,E["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(N){f.push(r);continue}var C=st({r:d,c:h}),T=y?(i[d]||[])[h]:i[C];if(T&&T.f&&(E["table:formula"]=It(Gre(T.f)),T.F&&T.F.slice(0,C.length)==C)){var k=Jn(T.F);E["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,E["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!T){f.push(t);continue}switch(T.t){case"b":S=T.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=T.v?"true":"false";break;case"n":S=T.w||String(T.v||0),E["office:value-type"]="float",E["office:value"]=T.v||0;break;case"s":case"str":S=T.v==null?"":T.v,E["office:value-type"]="string";break;case"d":S=T.w||Xt(T.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Xt(T.v).toISOString(),E["table:style-name"]="ce1";break;default:f.push(t);continue}var P=e(S);if(T.l&&T.l.Target){var D=T.l.Target;D=D.charAt(0)=="#"?"#"+Xre(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),P=Be("text:a",P,{"xlink:href":D.replace(/&/g,"&amp;")})}f.push("          "+Be("table:table-cell",Be("text:p",P,{}),E)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var h=0;h<d["!cols"].length;++h)if(d["!cols"][h]){var m=d["!cols"][h];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Xs(m),m.ods=c;var x=d["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++c}}});var f=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var h=0;h<d["!rows"].length;++h)if(d["!rows"][h]){d["!rows"][h].ods=f;var m=d["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,c){var f=[wr],d=ff({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=ff({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(f.push("<office:document"+d+h+`>
`),f.push(JP().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,s),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var m=0;m!=s.SheetNames.length;++m)f.push(n(s.Sheets[s.SheetNames[m]],s,m));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),c.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function c6(e,t){if(t.bookType=="fods")return e4(e,t);var r=Ew(),n="",a=[],i=[];return n="mimetype",mt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",mt(r,n,e4(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",mt(r,n,jse(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",mt(r,n,wr+JP()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",mt(r,n,rJ(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",mt(r,n,eJ(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function rl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function m1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Rt(no(e))}function Cse(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):la(gi(e))}function Ase(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ys(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function t4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Tse(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Pse(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function yf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Tt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function fr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Nt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=yf(e,r),i=a&7;a=Math.floor(a/8);var s=0,c;if(a==0)break;switch(i){case 0:{for(var f=r[0];e[r[0]++]>=128;);c=e.slice(f,r[0])}break;case 5:s=4,c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=yf(e,r),c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:c,type:i};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function an(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Tt(n*8+a.type)),a.type==2&&t.push(Tt(a.data.length)),t.push(a.data))})}),Ys(t)}function Qw(e,t){return e?.map(function(r){return t(r.data)})||[]}function Aa(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=yf(e,n),i=Nt(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:fr(i[1][0].data),messages:[]};i[2].forEach(function(c){var f=Nt(c.data),d=fr(f[3][0].data);s.messages.push({meta:f,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(s.merge=fr(i[3][0].data)>>>0>0),r.push(s)}return r}function zl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Tt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Tt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:Tt(s.data.length)}],n[2].push({data:an(s.meta),type:2})});var i=an(n);t.push(Tt(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Ys(t)}function Ose(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=yf(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var c=s-59;s=t[r[0]],c>1&&(s|=t[r[0]+1]<<8),c>2&&(s|=t[r[0]+2]<<16),c>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=c}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var f=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,f=(t[r[0]++]&224)<<3,f|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(f=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(f=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ys(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var h=Ys(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Ta(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Ose(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ys(t)}function Wl(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Tt(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Ys(t)}function Fse(e,t,r,n){var a=rl(e),i=a.getUint32(4,!0),s=(n>1?12:8)+t4(i&(n>1?3470:398))*4,c=-1,f=-1,d=NaN,h=new Date(2001,0,1);i&512&&(c=a.getUint32(s,!0),s+=4),s+=t4(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(s,!0),s+=4),i&32&&(d=a.getFloat64(s,!0),s+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[f]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:r[c]};else if(f>-1)m={t:"s",v:t[f]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function Dse(e,t,r){var n=rl(e),a=n.getUint32(8,!0),i=12,s=-1,c=-1,f=NaN,d=NaN,h=new Date(2001,0,1);a&1&&(f=Tse(e,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[c]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(s>-1)m={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function rv(e,t){var r=new Uint8Array(32),n=rl(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Pse(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function nv(e,t){var r=new Uint8Array(32),n=rl(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Ise(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Fse(e,t,r,e[0]);case 5:return Dse(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function vn(e){var t=Nt(e);return yf(t[1][0].data)}function r4(e,t){var r=Nt(t.data),n=fr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var c=Nt(s.data),f=fr(c[1][0].data)>>>0;switch(n){case 1:i[f]=m1(c[3][0].data);break;case 8:{var d=e[vn(c[9][0].data)][0],h=Nt(d.data),m=e[vn(h[1][0].data)][0],x=fr(m.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var g=Nt(m.data);i[f]=g[3].map(function(y){return m1(y.data)}).join("")}break}}),i}function Mse(e,t){var r,n,a,i,s,c,f,d,h,m,x,g,y,v,b=Nt(e),N=fr(b[1][0].data)>>>0,E=fr(b[2][0].data)>>>0,S=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&fr(b[8][0].data)>0||!1,C,T;if((i=(a=b[7])==null?void 0:a[0])!=null&&i.data&&t!=0)C=(c=(s=b[7])==null?void 0:s[0])==null?void 0:c.data,T=(d=(f=b[6])==null?void 0:f[0])==null?void 0:d.data;else if((m=(h=b[4])==null?void 0:h[0])!=null&&m.data&&t!=1)C=(g=(x=b[4])==null?void 0:x[0])==null?void 0:g.data,T=(v=(y=b[3])==null?void 0:y[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=S?4:1,P=rl(C),D=[],R=0;R<C.length/2;++R){var q=P.getUint16(R*2,!0);q<65535&&D.push([R,q])}if(D.length!=E)throw"Expected ".concat(E," cells, found ").concat(D.length);var M=[];for(R=0;R<D.length-1;++R)M[D[R][0]]=T.subarray(D[R][1]*k,D[R+1][1]*k);return D.length>=1&&(M[D[D.length-1][0]]=T.subarray(D[D.length-1][1]*k)),{R:N,cells:M}}function Rse(e,t){var r,n=Nt(t.data),a=(r=n?.[7])!=null&&r[0]?fr(n[7][0].data)>>>0>0?1:0:-1,i=Qw(n[5],function(s){return Mse(s,a)});return{nrows:fr(n[4][0].data)>>>0,data:i.reduce(function(s,c){return s[c.R]||(s[c.R]=[]),c.cells.forEach(function(f,d){if(s[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));s[c.R][d]=f}),s},[])}}function Lse(e,t,r){var n,a=Nt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(fr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(fr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=ht(i);var s=Nt(a[4][0].data),c=r4(e,e[vn(s[4][0].data)][0]),f=(n=s[17])!=null&&n[0]?r4(e,e[vn(s[17][0].data)][0]):[],d=Nt(s[3][0].data),h=0;d[1].forEach(function(m){var x=Nt(m.data),g=e[vn(x[2][0].data)][0],y=fr(g.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var v=Rse(e,g);v.data.forEach(function(b,N){b.forEach(function(E,S){var C=st({r:h+N,c:S}),T=Ise(E,c,f);T&&(r[C]=T)})}),h+=v.nrows})}function Bse(e,t){var r=Nt(t.data),n={"!ref":"A1"},a=e[vn(r[2][0].data)],i=fr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Lse(e,a[0],n),n}function $se(e,t){var r,n=Nt(t.data),a={name:(r=n[1])!=null&&r[0]?m1(n[1][0].data):"",sheets:[]},i=Qw(n[2],vn);return i.forEach(function(s){e[s].forEach(function(c){var f=fr(c.meta[1][0].data);f==6e3&&a.sheets.push(Bse(e,c))})}),a}function Use(e,t){var r=nb(),n=Nt(t.data),a=Qw(n[1],vn);if(a.forEach(function(i){e[i].forEach(function(s){var c=fr(s.meta[1][0].data);if(c==2){var f=$se(e,s);f.sheets.forEach(function(d,h){ab(r,d,h==0?f.name:f.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function av(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=Ta(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var h;try{h=Aa(d)}catch(m){return console.log("## "+(m.message||m))}h.forEach(function(m){i[m.id]=m.messages,s.push(m.id)})}}),!s.length)throw new Error("File has no messages");var c=((a=(n=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||s.forEach(function(f){i[f].forEach(function(d){var h=fr(d.meta[1][0].data)>>>0;if(h==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return Use(i,c)}function zse(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&fr(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var f=0,d=rl(e[7][0].data),h=0,m=[],x=rl(e[4][0].data),g=0,y=[],v=0;v<t.length;++v){if(t[v]==null){d.setUint16(v*2,65535,!0),x.setUint16(v*2,65535);continue}d.setUint16(v*2,h,!0),x.setUint16(v*2,g,!0);var b,N;switch(typeof t[v]){case"string":b=rv({t:"s",v:t[v]},r),N=nv({t:"s",v:t[v]},r);break;case"number":b=rv({t:"n",v:t[v]},r),N=nv({t:"n",v:t[v]},r);break;case"boolean":b=rv({t:"b",v:t[v]},r),N=nv({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}m.push(b),h+=b.length,y.push(N),g+=N.length,++f}for(e[2][0].data=Tt(f);v<e[7][0].data.length/2;++v)d.setUint16(v*2,65535,!0),x.setUint16(v*2,65535,!0);return e[6][0].data=Ys(m),e[3][0].data=Ys(y),f}function Wse(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Jn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(ht(n)));var i=Fh(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(K){return K.forEach(function(W){typeof W=="string"&&s.push(W)})});var c={},f=[],d=tt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(K,W){return[K,d.FullPaths[W]]}).forEach(function(K){var W=K[0],X=K[1];if(W.type==2&&W.name.match(/\.iwa/)){var V=W.content,ne=Ta(V),L=Aa(ne);L.forEach(function(U){f.push(U.id),c[U.id]={deps:[],location:X,type:fr(U.messages[0].meta[1][0].data)}})}}),f.sort(function(K,W){return K-W});var h=f.filter(function(K){return K>1}).map(function(K){return[K,Tt(K)]});d.FileIndex.map(function(K,W){return[K,d.FullPaths[W]]}).forEach(function(K){var W=K[0];if(K[1],!!W.name.match(/\.iwa/)){var X=Aa(Ta(W.content));X.forEach(function(V){V.messages.forEach(function(ne){h.forEach(function(L){V.messages.some(function(U){return fr(U.meta[1][0].data)!=11006&&Ase(U.data,L[1])})&&c[L[0]].deps.push(V.id)})})})}});for(var m=tt.find(d,c[1].location),x=Aa(Ta(m.content)),g,y=0;y<x.length;++y){var v=x[y];v.id==1&&(g=v)}var b=vn(Nt(g.messages[0].data)[1][0].data);for(m=tt.find(d,c[b].location),x=Aa(Ta(m.content)),y=0;y<x.length;++y)v=x[y],v.id==b&&(g=v);for(b=vn(Nt(g.messages[0].data)[2][0].data),m=tt.find(d,c[b].location),x=Aa(Ta(m.content)),y=0;y<x.length;++y)v=x[y],v.id==b&&(g=v);for(b=vn(Nt(g.messages[0].data)[2][0].data),m=tt.find(d,c[b].location),x=Aa(Ta(m.content)),y=0;y<x.length;++y)v=x[y],v.id==b&&(g=v);var N=Nt(g.messages[0].data);{N[6][0].data=Tt(n.e.r+1),N[7][0].data=Tt(n.e.c+1);var E=vn(N[46][0].data),S=tt.find(d,c[E].location),C=Aa(Ta(S.content));{for(var T=0;T<C.length&&C[T].id!=E;++T);if(C[T].id!=E)throw"Bad ColumnRowUIDMapArchive";var k=Nt(C[T].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var P=0;P<=n.e.c;++P){var D=[];D[1]=D[2]=[{type:0,data:Tt(P+420690)}],k[1].push({type:2,data:an(D)}),k[2].push({type:0,data:Tt(P)}),k[3].push({type:0,data:Tt(P)})}k[4]=[],k[5]=[],k[6]=[];for(var R=0;R<=n.e.r;++R)D=[],D[1]=D[2]=[{type:0,data:Tt(R+726270)}],k[4].push({type:2,data:an(D)}),k[5].push({type:0,data:Tt(R)}),k[6].push({type:0,data:Tt(R)});C[T].messages[0].data=an(k)}S.content=Wl(zl(C)),S.size=S.content.length,delete N[46];var q=Nt(N[4][0].data);{q[7][0].data=Tt(n.e.r+1);var M=Nt(q[1][0].data),z=vn(M[2][0].data);S=tt.find(d,c[z].location),C=Aa(Ta(S.content));{if(C[0].id!=z)throw"Bad HeaderStorageBucket";var ie=Nt(C[0].messages[0].data);for(R=0;R<i.length;++R){var ce=Nt(ie[2][0].data);ce[1][0].data=Tt(R),ce[4][0].data=Tt(i[R].length),ie[2][R]={type:ie[2][0].type,data:an(ce)}}C[0].messages[0].data=an(ie)}S.content=Wl(zl(C)),S.size=S.content.length;var ae=vn(q[2][0].data);S=tt.find(d,c[ae].location),C=Aa(Ta(S.content));{if(C[0].id!=ae)throw"Bad HeaderStorageBucket";for(ie=Nt(C[0].messages[0].data),P=0;P<=n.e.c;++P)ce=Nt(ie[2][0].data),ce[1][0].data=Tt(P),ce[4][0].data=Tt(n.e.r+1),ie[2][P]={type:ie[2][0].type,data:an(ce)};C[0].messages[0].data=an(ie)}S.content=Wl(zl(C)),S.size=S.content.length;var me=vn(q[4][0].data);(function(){for(var K=tt.find(d,c[me].location),W=Aa(Ta(K.content)),X,V=0;V<W.length;++V){var ne=W[V];ne.id==me&&(X=ne)}var L=Nt(X.messages[0].data);{L[3]=[];var U=[];s.forEach(function(F,Ae){U[1]=[{type:0,data:Tt(Ae)}],U[2]=[{type:0,data:Tt(1)}],U[3]=[{type:2,data:Cse(F)}],L[3].push({type:2,data:an(U)})})}X.messages[0].data=an(L);var H=zl(W),oe=Wl(H);K.content=oe,K.size=K.content.length})();var de=Nt(q[3][0].data);{var he=de[1][0];delete de[2];var J=Nt(he.data);{var xe=vn(J[2][0].data);(function(){for(var K=tt.find(d,c[xe].location),W=Aa(Ta(K.content)),X,V=0;V<W.length;++V){var ne=W[V];ne.id==xe&&(X=ne)}var L=Nt(X.messages[0].data);{delete L[6],delete de[7];var U=new Uint8Array(L[5][0].data);L[5]=[];for(var H=0,oe=0;oe<=n.e.r;++oe){var F=Nt(U);H+=zse(F,i[oe],s),F[1][0].data=Tt(oe),L[5].push({data:an(F),type:2})}L[1]=[{type:0,data:Tt(n.e.c+1)}],L[2]=[{type:0,data:Tt(n.e.r+1)}],L[3]=[{type:0,data:Tt(H)}],L[4]=[{type:0,data:Tt(n.e.r+1)}]}X.messages[0].data=an(L);var Ae=zl(W),je=Wl(Ae);K.content=je,K.size=K.content.length})()}he.data=an(J)}q[3][0].data=an(de)}N[4][0].data=an(q)}g.messages[0].data=an(N);var te=zl(x),O=Wl(te);return m.content=O,m.size=m.content.length,d}function u6(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Zw(e){u6([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function eb(e){u6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Hse(e){return gt.WS.indexOf(e)>-1?"sheet":e==gt.CS?"chart":e==gt.DS?"dialog":e==gt.MS?"macro":e&&e.length?e:"sheet"}function Vse(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Hse(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Kse(e,t,r,n,a,i,s,c,f,d,h,m){try{i[n]=zu(ca(e,r,!0),t);var x=Nr(e,t),g;switch(c){case"sheet":g=mie(x,t,a,f,i[n],d,h,m);break;case"chart":if(g=pie(x,t,a,f,i[n],d,h,m),!g||!g["!drawel"])break;var y=Fu(g["!drawel"].Target,t),v=hf(y),b=tte(ca(e,y,!0),zu(ca(e,v,!0),y)),N=Fu(b,y),E=hf(N);g=zae(ca(e,N,!0),N,f,zu(ca(e,E,!0),N),d,g);break;case"macro":g=xie(x,t,a,f,i[n],d,h,m);break;case"dialog":g=gie(x,t,a,f,i[n],d,h,m);break;default:throw new Error("Unrecognized sheet type "+c)}s[n]=g;var S=[];i&&i[n]&&dr(i[n]).forEach(function(C){var T="";if(i[n][C].Type==gt.CMNT){T=Fu(i[n][C].Target,t);var k=bie(Nr(e,T,!0),T,f);if(!k||!k.length)return;Uj(g,k,!1)}i[n][C].Type==gt.TCMNT&&(T=Fu(i[n][C].Target,t),S=S.concat(nte(Nr(e,T,!0),f)))}),S&&S.length&&Uj(g,S,!0,f.people||[])}catch(C){if(f.WTF)throw C}}function ka(e){return e.charAt(0)=="/"?e.slice(1):e}function Gse(e,t){if(Oc(),t=t||{},Zw(t),Pa(e,"META-INF/manifest.xml")||Pa(e,"objectdata.xml"))return Qj(e,t);if(Pa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof av<"u"){if(e.FileIndex)return av(e);var r=tt.utils.cfb_new();return lj(e).forEach(function(ce){mt(r,ce,aY(e,ce))}),av(r)}throw new Error("Unsupported NUMBERS file")}if(!Pa(e,"[Content_Types].xml"))throw Pa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Pa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=lj(e),a=JY(ca(e,"[Content_Types].xml")),i=!1,s,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Nr(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Nr(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},d={};if(!t.bookSheets&&!t.bookProps){if(Wu=[],a.sst)try{Wu=wie(Nr(e,ka(a.sst)),a.sst,t)}catch(ce){if(t.WTF)throw ce}t.cellStyles&&a.themes.length&&(f=yie(ca(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(d=vie(Nr(e,ka(a.style)),a.style,f,t))}a.links.map(function(ce){try{var ae=zu(ca(e,hf(ka(ce))),ce);return Nie(Nr(e,ka(ce)),ae,ce,t)}catch{}});var h=hie(Nr(e,ka(a.workbooks[0])),a.workbooks[0],t),m={},x="";a.coreprops.length&&(x=Nr(e,ka(a.coreprops[0]),!0),x&&(m=QP(x)),a.extprops.length!==0&&(x=Nr(e,ka(a.extprops[0]),!0),x&&aJ(x,m,t)));var g={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(x=ca(e,ka(a.custprops[0]),!0),x&&(g=sJ(x,t)));var y={};if((t.bookSheets||t.bookProps)&&(h.Sheets?s=h.Sheets.map(function(ae){return ae.name}):m.Worksheets&&m.SheetNames.length>0&&(s=m.SheetNames),t.bookProps&&(y.Props=m,y.Custprops=g),t.bookSheets&&typeof s<"u"&&(y.SheetNames=s),t.bookSheets?y.SheetNames:t.bookProps))return y;s={};var v={};t.bookDeps&&a.calcchain&&(v=Sie(Nr(e,ka(a.calcchain)),a.calcchain));var b=0,N={},E,S;{var C=h.Sheets;m.Worksheets=C.length,m.SheetNames=[];for(var T=0;T!=C.length;++T)m.SheetNames[T]=C[T].name}var k=i?"bin":"xml",P=a.workbooks[0].lastIndexOf("/"),D=(a.workbooks[0].slice(0,P+1)+"_rels/"+a.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");Pa(e,D)||(D="xl/_rels/workbook."+k+".rels");var R=zu(ca(e,D,!0),D.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=_ie(Nr(e,ka(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=ite(Nr(e,ka(a.people[0])),t)),R&&(R=Vse(R,h.Sheets));var q=Nr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=m.Worksheets;++b){var M="sheet";if(R&&R[b]?(E="xl/"+R[b][1].replace(/[\/]?xl\//,""),Pa(e,E)||(E=R[b][1]),Pa(e,E)||(E=D.replace(/_rels\/.*$/,"")+R[b][1]),M=R[b][2]):(E="xl/worksheets/sheet"+(b+1-q)+"."+k,E=E.replace(/sheet0\./,"sheet.")),S=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(m.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var z=!1,ie=0;ie!=t.sheets.length;++ie)typeof t.sheets[ie]=="number"&&t.sheets[ie]==b&&(z=1),typeof t.sheets[ie]=="string"&&t.sheets[ie].toLowerCase()==m.SheetNames[b].toLowerCase()&&(z=1);if(!z)continue e}}Kse(e,E,S,m.SheetNames[b],b,N,s,M,t,h,f,d)}return y={Directory:a,Workbook:h,Props:m,Custprops:g,Deps:v,Sheets:s,SheetNames:m.SheetNames,Strings:Wu,Styles:d,Themes:f,SSF:qt(it)},t&&t.bookFiles&&(e.files?(y.keys=n,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(ce,ae){ce=ce.replace(/^Root Entry[\/]/,""),y.keys.push(ce),y.files[ce]=e.FileIndex[ae]}))),t&&t.bookVBA&&(a.vba.length>0?y.vbaraw=Nr(e,ka(a.vba[0]),!0):a.defaults&&a.defaults.bin===hte&&(y.vbaraw=Nr(e,"xl/vbaProject.bin",!0))),y}function Xse(e,t){var r=t||{},n="Workbook",a=tt.find(e,n);try{if(n="/!DataSpaces/Version",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(_Z(a.content),n="/!DataSpaces/DataSpaceMap",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=kZ(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=jZ(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);AZ(a.content)}catch{}if(n="/EncryptionInfo",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=TZ(a.content);if(n="/EncryptedPackage",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function qse(e,t){return t.bookType=="ods"?c6(e,t):t.bookType=="numbers"?Wse(e,t):t.bookType=="xlsb"?Yse(e,t):Jse(e,t)}function Yse(e,t){Yl=1024,e&&!e.SSF&&(e.SSF=qt(it)),e&&e.SSF&&(Oc(),wm(e.SSF),t.revssf=Sm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=RO.indexOf(t.bookType)>-1,a=Bw();eb(t=t||{});var i=Ew(),s="",c=0;if(t.cellXfs=[],io(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",mt(i,s,ZP(e.Props,t)),a.coreprops.push(s),Ot(t.rels,2,s,gt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}for(e.Props.Worksheets=e.Props.SheetNames.length,mt(i,s,rO(e.Props)),a.extprops.push(s),Ot(t.rels,3,s,gt.EXT_PROPS),e.Custprops!==e.Props&&dr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",mt(i,s,nO(e.Custprops)),a.custprops.push(s),Ot(t.rels,4,s,gt.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var h={"!id":{}},m=e.Sheets[e.SheetNames[c-1]],x=(m||{})["!type"]||"sheet";switch(x){case"chart":default:s="xl/worksheets/sheet"+c+"."+r,mt(i,s,kie(c-1,s,t,e,h)),a.sheets.push(s),Ot(t.wbrels,-1,"worksheets/sheet"+c+"."+r,gt.WS[0])}if(m){var g=m["!comments"],y=!1,v="";g&&g.length>0&&(v="xl/comments"+c+"."+r,mt(i,v,Aie(g,v)),a.comments.push(v),Ot(h,-1,"../comments"+c+"."+r,gt.CMNT),y=!0),m["!legacy"]&&y&&mt(i,"xl/drawings/vmlDrawing"+c+".vml",IO(c,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&mt(i,hf(s),tc(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,mt(i,s,Cie(t.Strings,s,t)),a.strs.push(s),Ot(t.wbrels,-1,"sharedStrings."+r,gt.SST)),s="xl/workbook."+r,mt(i,s,Eie(e,s)),a.workbooks.push(s),Ot(t.rels,1,s,gt.WB),s="xl/theme/theme1.xml",mt(i,s,Vw(e.Themes,t)),a.themes.push(s),Ot(t.wbrels,-1,"theme/theme1.xml",gt.THEME),s="xl/styles."+r,mt(i,s,jie(e,s,t)),a.styles.push(s),Ot(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",mt(i,s,e.vbaraw),a.vba.push(s),Ot(t.wbrels,-1,"vbaProject.bin",gt.VBA)),s="xl/metadata."+r,mt(i,s,Tie(s)),a.metadata.push(s),Ot(t.wbrels,-1,"metadata."+r,gt.XLMETA),mt(i,"[Content_Types].xml",YP(a,t)),mt(i,"_rels/.rels",tc(t.rels)),mt(i,"xl/_rels/workbook."+r+".rels",tc(t.wbrels)),delete t.revssf,delete t.ssf,i}function Jse(e,t){Yl=1024,e&&!e.SSF&&(e.SSF=qt(it)),e&&e.SSF&&(Oc(),wm(e.SSF),t.revssf=Sm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=RO.indexOf(t.bookType)>-1,a=Bw();eb(t=t||{});var i=Ew(),s="",c=0;if(t.cellXfs=[],io(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",mt(i,s,ZP(e.Props,t)),a.coreprops.push(s),Ot(t.rels,2,s,gt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,mt(i,s,rO(e.Props)),a.extprops.push(s),Ot(t.rels,3,s,gt.EXT_PROPS),e.Custprops!==e.Props&&dr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",mt(i,s,nO(e.Custprops)),a.custprops.push(s),Ot(t.rels,4,s,gt.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var m={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+c+"."+r,mt(i,s,XO(c-1,t,e,m)),a.sheets.push(s),Ot(t.wbrels,-1,"worksheets/sheet"+c+"."+r,gt.WS[0])}if(x){var y=x["!comments"],v=!1,b="";if(y&&y.length>0){var N=!1;y.forEach(function(E){E[1].forEach(function(S){S.T==!0&&(N=!0)})}),N&&(b="xl/threadedComments/threadedComment"+c+"."+r,mt(i,b,ate(y,h,t)),a.threadedcomments.push(b),Ot(m,-1,"../threadedComments/threadedComment"+c+"."+r,gt.TCMNT)),b="xl/comments"+c+"."+r,mt(i,b,MO(y)),a.comments.push(b),Ot(m,-1,"../comments"+c+"."+r,gt.CMNT),v=!0}x["!legacy"]&&v&&mt(i,"xl/drawings/vmlDrawing"+c+".vml",IO(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&mt(i,hf(s),tc(m))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,mt(i,s,NO(t.Strings,t)),a.strs.push(s),Ot(t.wbrels,-1,"sharedStrings."+r,gt.SST)),s="xl/workbook."+r,mt(i,s,ZO(e)),a.workbooks.push(s),Ot(t.rels,1,s,gt.WB),s="xl/theme/theme1.xml",mt(i,s,Vw(e.Themes,t)),a.themes.push(s),Ot(t.wbrels,-1,"theme/theme1.xml",gt.THEME),s="xl/styles."+r,mt(i,s,PO(e,t)),a.styles.push(s),Ot(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",mt(i,s,e.vbaraw),a.vba.push(s),Ot(t.wbrels,-1,"vbaProject.bin",gt.VBA)),s="xl/metadata."+r,mt(i,s,DO()),a.metadata.push(s),Ot(t.wbrels,-1,"metadata."+r,gt.XLMETA),h.length>1&&(s="xl/persons/person.xml",mt(i,s,ste(h)),a.people.push(s),Ot(t.wbrels,-1,"persons/person.xml",gt.PEOPLE)),mt(i,"[Content_Types].xml",YP(a,t)),mt(i,"_rels/.rels",tc(t.rels)),mt(i,"xl/_rels/workbook."+r+".rels",tc(t.wbrels)),delete t.revssf,delete t.ssf,i}function tb(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=pa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Qse(e,t){return tt.find(e,"EncryptedPackage")?Xse(e,t):n6(e,t)}function Zse(e,t){var r,n=e,a=t||{};return a.type||(a.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),r=EP(n,a),Gse(r,a)}function f6(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return d1(e.slice(r),t);default:break e}return gc.to_workbook(e,t)}function eoe(e,t){var r="",n=tb(e,t);switch(t.type){case"base64":r=pa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Qo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Rt(r)),t.type="binary",f6(r,t)}function toe(e,t){var r=e;return t.type=="base64"&&(r=pa(r)),r=of.utils.decode(1200,r.slice(2),"str"),t.type="binary",f6(r,t)}function roe(e){return e.match(/[^\x00-\x7F]/)?gi(e):e}function iv(e,t,r,n){return n?(r.type="string",gc.to_workbook(e,r)):gc.to_workbook(t,r)}function nl(e,t){ww();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return nl(new Uint8Array(e),(r=qt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),nc={},r.dateNF&&(nc.dateNF=r.dateNF),r.type||(r.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=pt?"buffer":"binary",n=Yq(e),typeof Uint8Array<"u"&&!pt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=roe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),c=new Uint8Array(s);if(c.foo="bar",!c.foo)return r=qt(r),r.type="array",nl(bw(n),r)}switch((a=tb(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Qse(tt.read(n,r),r);break;case 9:if(a[1]<=8)return n6(n,r);break;case 60:return d1(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return oZ(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return bO.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Zse(n,r):iv(e,n,r,i);case 239:return a[3]===60?d1(n,r):iv(e,n,r,i);case 255:if(a[1]===254)return toe(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return $o.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return $o.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return f1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return CO.to_workbook(n,r);break;case 10:case 13:case 32:return eoe(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return sZ.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?f1.to_workbook(n,r):iv(e,n,r,i)}function d6(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return $f(t.file,tt.write(e,{type:pt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return tt.write(e,t)}function noe(e,t){var r=qt(t||{}),n=qse(e,r);return aoe(n,r)}function aoe(e,t){var r={},n=pt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?tt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(ym(a))}return t.password&&typeof encrypt_agile<"u"?d6(encrypt_agile(a,t.password),t):t.type==="file"?$f(t.file,a):t.type=="string"?Rt(a):a}function ioe(e,t){var r=t||{},n=rse(e,r);return d6(n,r)}function hi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return lf(gi(n));case"binary":return gi(n);case"string":return e;case"file":return $f(t.file,n,"utf8");case"buffer":return pt?os(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):hi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function soe(e,t){switch(t.type){case"base64":return lf(e);case"binary":return e;case"string":return e;case"file":return $f(t.file,e,"binary");case"buffer":return pt?os(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function k0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?lf(r):t.type=="string"?Rt(r):r;case"file":return $f(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function h6(e,t){ww(),Qae(e);var r=qt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=h6(e,r);return r.type="array",ym(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return hi(qie(e,r),r);case"slk":case"sylk":return hi(wO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return hi(i6(e.Sheets[e.SheetNames[a]],r),r);case"txt":return soe(m6(e.Sheets[e.SheetNames[a]],r),r);case"csv":return hi(rb(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return hi(bO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return k0(f1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return hi(gc.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return hi(CO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return hi(SO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return hi(c6(e,r),r);case"wk1":return k0($o.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return k0($o.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),k0(a6(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ioe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return noe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function ooe(e,t,r,n,a,i,s,c){var f=vr(r),d=c.defval,h=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!s||e[r])for(var g=t.s.c;g<=t.e.c;++g){var y=s?e[r][g]:e[n[g]+f];if(y===void 0||y.t===void 0){if(d===void 0)continue;i[g]!=null&&(x[i[g]]=d);continue}var v=y.v;switch(y.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[g]!=null){if(v==null)if(y.t=="e"&&v===null)x[i[g]]=null;else if(d!==void 0)x[i[g]]=d;else if(h&&v===null)x[i[g]]=null;else continue;else x[i[g]]=h&&(y.t!=="n"||y.t==="n"&&c.rawNumbers!==!1)?v:es(y,v,c);v!=null&&(m=!1)}}return{row:x,isempty:m}}function Fh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},h=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof h){case"string":f=bt(h);break;case"number":f=bt(e["!ref"]),f.s.r=h;break;default:f=h}n>0&&(a=0);var m=vr(f.s.r),x=[],g=[],y=0,v=0,b=Array.isArray(e),N=f.s.r,E=0,S={};b&&!e[N]&&(e[N]=[]);var C=d.skipHidden&&e["!cols"]||[],T=d.skipHidden&&e["!rows"]||[];for(E=f.s.c;E<=f.e.c;++E)if(!(C[E]||{}).hidden)switch(x[E]=sr(E),r=b?e[N][E]:e[x[E]+m],n){case 1:i[E]=E-f.s.c;break;case 2:i[E]=x[E];break;case 3:i[E]=d.header[E-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=s=es(r,null,d),v=S[s]||0,!v)S[s]=1;else{do c=s+"_"+v++;while(S[c]);S[s]=v,S[c]=1}i[E]=c}for(N=f.s.r+a;N<=f.e.r;++N)if(!(T[N]||{}).hidden){var k=ooe(e,f,N,x,n,i,b,d);(k.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(g[y++]=k.row)}return g.length=y,g}var n4=/"/g;function loe(e,t,r,n,a,i,s,c){for(var f=!0,d=[],h="",m=vr(r),x=t.s.c;x<=t.e.c;++x)if(n[x]){var g=c.dense?(e[r]||[])[x]:e[n[x]+m];if(g==null)h="";else if(g.v!=null){f=!1,h=""+(c.rawNumbers&&g.t=="n"?g.v:es(g,null,c));for(var y=0,v=0;y!==h.length;++y)if((v=h.charCodeAt(y))===a||v===i||v===34||c.forceQuotes){h='"'+h.replace(n4,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(f=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(n4,'""')+'"')):h="";d.push(h)}return c.blankrows===!1&&f?null:d.join(s)}function rb(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=bt(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),h="",m=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(x[y]||{}).hidden||(m[y]=sr(y));for(var v=0,b=a.s.r;b<=a.e.r;++b)(g[b]||{}).hidden||(h=loe(e,a,b,m,s,f,i,n),h!=null&&(n.strip&&(h=h.replace(d,"")),(h||n.blankrows!==!1)&&r.push((v++?c:"")+h)));return delete n.dense,r.join("")}function m6(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=rb(e,t);return r}function coe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=bt(e["!ref"]),i="",s=[],c,f=[],d=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)s[c]=sr(c);for(var h=a.s.r;h<=a.e.r;++h)for(i=vr(h),c=a.s.c;c<=a.e.c;++c)if(t=s[c]+i,r=d?(e[h]||[])[c]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=t+"="+n}return f}function p6(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?or(n.origin):n.origin;s=f.r,c=f.c}var d,h={s:{c:0,r:0},e:{c,r:s+t.length-1+a}};if(i["!ref"]){var m=bt(i["!ref"]);h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),s==-1&&(s=m.e.r+1,h.e.r=s+t.length-1+a)}else s==-1&&(s=0,h.e.r=t.length-1+a);var x=n.header||[],g=0;t.forEach(function(v,b){dr(v).forEach(function(N){(g=x.indexOf(N))==-1&&(x[g=x.length]=N);var E=v[N],S="z",C="",T=st({c:c+g,r:s+b+a});d=wf(i,T),E&&typeof E=="object"&&!(E instanceof Date)?i[T]=E:(typeof E=="number"?S="n":typeof E=="boolean"?S="b":typeof E=="string"?S="s":E instanceof Date?(S="d",n.cellDates||(S="n",E=Ir(E)),C=n.dateNF||it[14]):E===null&&n.nullError&&(S="e",E=0),d?(d.t=S,d.v=E,delete d.w,delete d.R,C&&(d.z=C)):i[T]=d={t:S,v:E},C&&(d.z=C))})}),h.e.c=Math.max(h.e.c,c+x.length-1);var y=vr(s);if(a)for(g=0;g<x.length;++g)i[sr(g+c)+y]={t:"s",v:x[g]};return i["!ref"]=ht(h),i}function uoe(e,t){return p6(null,e,t)}function wf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=or(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?wf(e,st(t)):wf(e,st({r:t,c:r||0}))}function foe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function nb(){return{SheetNames:[],Sheets:{}}}function ab(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(QO(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function doe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=foe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function hoe(e,t){return e.z=t,e}function x6(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function moe(e,t,r){return x6(e,"#"+t,r)}function poe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function xoe(e,t,r,n){for(var a=typeof t!="string"?t:bt(t),i=typeof t=="string"?t:ht(t),s=a.s.r;s<=a.e.r;++s)for(var c=a.s.c;c<=a.e.c;++c){var f=wf(e,s,c);f.t="n",f.F=i,delete f.v,s==a.s.r&&c==a.s.c&&(f.f=r,n&&(f.D=!0))}return e}var yi={encode_col:sr,encode_row:vr,encode_cell:st,encode_range:ht,decode_col:Fw,decode_row:Ow,split_cell:CY,decode_cell:or,decode_range:Jn,format_cell:es,sheet_add_aoa:WP,sheet_add_json:p6,sheet_add_dom:s6,aoa_to_sheet:Fc,json_to_sheet:uoe,table_to_sheet:o6,table_to_book:_se,sheet_to_csv:rb,sheet_to_txt:m6,sheet_to_json:Fh,sheet_to_html:i6,sheet_to_formulae:coe,sheet_to_row_object_array:Fh,sheet_get_cell:wf,book_new:nb,book_append_sheet:ab,book_set_sheet_visibility:doe,cell_set_number_format:hoe,cell_set_hyperlink:x6,cell_set_internal_link:moe,cell_add_comment:poe,sheet_set_array_formula:xoe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function ib(e){const t=fe.getById("eleves",e);if(!t)throw new Error("lve introuvable");const r=fe.getById("classes",t.classeId),n=fe.getAll("ecole")[0],a=r?.niveau,i=r?.anneeScolaire||t.anneeEntree||n?.anneeScolaireActive;if(!a||!i)return[];const s=fe.getAll("fraisScolaires").find(c=>c.niveau===a&&c.anneeScolaire===i);return!s||!(s.echeances&&s.echeances.length)?[]:(s.echeances||[]).map((c,f)=>({echeanceId:c.id||`${s.niveau}-${f+1}`,date:c.date,montant:Number(c.montant||0),paid:0,remaining:Number(c.montant||0),modalite:c.modalite,dueDate:c.date}))}function goe(e,t,r,n={}){let a=ib(e);const i=typeof(n&&n.modalite)<"u"?Number(n.modalite):null;if(i!==null){const h=[],m=[];for(const x of a)Number(x.modalite)===i?h.push(x):m.push(x);a=[...h,...m]}let s=Math.max(0,Number(t));const c=[];for(const h of a){if(s<=0)break;if(h.remaining<=0)continue;const m=Math.min(h.remaining,s);h.paid+=m,h.remaining-=m,s-=m,c.push({echeanceId:h.echeanceId,montant:m})}const f={eleveId:e,montant:t,datePaiement:r,createdAt:new Date().toISOString(),allocations:c,avance:s,...n},d=fe.create("paiements",f);if(s>0){const h={eleveId:e,montant:s,date:new Date().toISOString(),createdAt:new Date().toISOString()};fe.create("credits",h)}return{paiement:d,allocations:c,avance:s}}const sb={computeScheduleForEleve:ib,processPayment:goe};function fi(e){return e?e.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().replace(/[^a-z0-9 ]+/g,"").replace(/\s+/g," ").trim():""}function voe(e,t){if(e===t)return 0;const r=e.length,n=t.length;if(r===0)return n;if(n===0)return r;const a=new Array(n+1).fill(0),i=new Array(n+1).fill(0);for(let s=0;s<=n;s++)a[s]=s;for(let s=0;s<r;s++){i[0]=s+1;for(let c=0;c<n;c++){const f=e[s]===t[c]?0:1;i[c+1]=Math.min(i[c]+1,a[c+1]+1,a[c]+f)}for(let c=0;c<=n;c++)a[c]=i[c]}return i[n]}function g6(e,t,r,n){const a=fi(t||""),i=fi(r||"");if(!a)return null;const s=x=>{const g=fe.getById("classes",x.classeId)||{};return fi(`${g.niveau||""} ${g.section||""}`.trim())};let c=e.find(x=>{const g=fi(Bt(x)),y=fi(j0(x)),v=s(x);return(!i||v.includes(i)||i.includes(v))&&(g===a||y===a)});if(c)return c;let f=e.find(x=>{const g=fi(Bt(x)),y=fi(j0(x));return g===a||y===a});if(f)return f;const d=a.split(" ").filter(Boolean),h=[];for(const x of e){const g=fi(Bt(x)),y=fi(j0(x)),v=s(x),b=!!i&&(v.includes(i)||i.includes(v)),N=g.split(" ").filter(Boolean),E=d.filter(k=>N.includes(k)).length,S=g.includes(a)||a.includes(g)||y.includes(a)||a.includes(y);let C=0;try{const k=[String(x.telephone||""),String(x.pereTuteur||""),String(x.mereTutrice||"")].join(" "),P=(n||"").replace(/\D/g,"");P&&P.length>=6&&k.replace(/\D/g,"").includes(P)&&(C=5)}catch{}let T=E*2+(S?3:0)+C+(b?4:0);E>=Math.max(1,Math.floor(d.length*.6))&&(T+=2),h.push({e:x,score:T,classMatch:b})}if(h.sort((x,g)=>g.score-x.score),h.length>0&&h[0].score>3)return h[0].e;let m={};for(const x of e){const g=fi(Bt(x)),y=voe(a,g);(m.d===void 0||y<m.d)&&(m={e:x,d:y})}if(m.e&&m.d!==void 0){const x=Math.max(1,a.length);if(m.d<=Math.max(1,Math.floor(x*.3)))return m.e}return null}async function yoe(e,t){return new Promise((r,n)=>{const a=new FileReader;a.onload=i=>{try{const s=i.target?.result,c=nl(s,{type:typeof s=="string"?"binary":"array"}),f=c.SheetNames[0],d=c.Sheets[f],h=yi.sheet_to_json(d,{header:1});if(!h||h.length===0){n("Fichier Excel vide ou illisible");return}const m=h[0].map(E=>String(E||"").trim()),x=h.slice(1);if(!t){r({columns:m,preview:x.slice(0,5)});return}const g=t.matricule?m.findIndex(E=>E===t.matricule):-1,y=t.nom?m.findIndex(E=>E===t.nom):-1,v=t.prenoms?m.findIndex(E=>E===t.prenoms):-1,b=t.nomPrenoms?m.findIndex(E=>E===t.nomPrenoms):-1,N=x.map(E=>{let S="",C="";if(b!==-1){const k=String(E[b]||"").trim().split(" ");S=k[0]||"",C=k.slice(1).join(" ")}else S=y!==-1?String(E[y]||"").trim():"",C=v!==-1?String(E[v]||"").trim():"";return{id:"",matricule:g!==-1?String(E[g]||"").trim():"",nom:S,prenoms:C,sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:"",anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:"",adresse:"",photo:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}});r(N)}catch(s){n(s instanceof Error?s.message:String(s))}},a.onerror=()=>n("Erreur lecture du fichier"),a.readAsArrayBuffer(e)})}async function woe(e){const t=[["Matricule","Nom & Prnoms","Moyenne"],...e.map(i=>[i.matricule,`${i.nom} ${i.prenoms}`,""])],r=yi.aoa_to_sheet(t),n=yi.book_new();return yi.book_append_sheet(n,r,"lves"),h6(n,{bookType:"xlsx",type:"array"})}async function boe(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const i=a.target?.result,s=nl(i,{type:typeof i=="string"?"binary":"array"}),c=s.SheetNames[0],f=s.Sheets[c],d=yi.sheet_to_json(f,{header:1});if(!d||d.length===0){r("Fichier Excel vide ou illisible");return}const h=d[0].map(k=>String(k||"").trim()),m=d.slice(1),x=h.findIndex(k=>/nom/i.test(k)&&/pr/i.test(k)||/nom\s*&\s*pr/i.test(k)),g=h.findIndex(k=>/classe/i.test(k)),y=h.findIndex(k=>/contact|tel/i.test(k)),v=["inscription","octobre","novembre","dcembre","decembre","janvier","fvrier","fevrier","mars","avril","mai","juin","juillet","aot","aout","septembre"],b=[];let S=h.map(k=>String(k||"").toLowerCase()).some(k=>k.includes("inscription"))?2:1;h.forEach((k,P)=>{const D=String(k||"").toLowerCase();v.some(R=>D.includes(R))&&(D.includes("inscription")?b.push({idx:P,name:String(k),modalite:1}):(b.push({idx:P,name:String(k),modalite:S}),S++))});const C=[],T=[];for(let k=0;k<m.length;k++){const P=m[k],D=String(P[x]||"").trim(),R=String(P[g]||"").trim(),q=y>=0?String(P[y]||"").trim():"",M=fe.getAll("eleves");let z=g6(M,D,R,q);if(!z){T.push({row:k+2,name:D,classe:R,contact:q});continue}for(const ie of b){const ce=P[ie.idx];if(!ce&&ce!==0)continue;const ae=String(ce).replace(/[^0-9]/g,"");if(!ae)continue;const me=Number(ae);if(!me||isNaN(me)||me<=0)continue;let he=new Date().toISOString();const J=String(ie.name||"").toLowerCase(),xe={janvier:1,fevrier:2,fvrier:2,mars:3,avril:4,mai:5,juin:6,juillet:7,aot:8,aout:8,septembre:9,octobre:10,novembre:11,dcembre:12,decembre:12};for(const O in xe)if(J.includes(O)){const K=new Date().getFullYear(),W=xe[O];he=new Date(K,W-1,1).toISOString();break}const te=ie.modalite||null;try{sb.processPayment(z.id,me,he,{source:"import",note:`Import ${ie.name}`,modalite:te,pereTelephone:q}),C.push({row:k+2,eleveId:z.id,eleveName:Bt(z),month:ie.name,modalite:te,montant:me})}catch{T.push({row:k+2,name:D,classe:R,contact:q})}}}t({applied:C,unresolved:T})}catch(i){r(i instanceof Error?i.message:String(i))}},n.onerror=()=>r("Erreur lecture du fichier"),n.readAsArrayBuffer(e)})}async function Soe(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const i=a.target?.result,s=nl(i,{type:typeof i=="string"?"binary":"array"}),c=s.SheetNames[0],f=s.Sheets[c],d=yi.sheet_to_json(f,{header:1});if(!d||d.length===0)return t({proposals:[],unresolved:[]});const h=d[0].map(k=>String(k||"").trim()),m=d.slice(1),x=h.findIndex(k=>/nom/i.test(k)&&/pr/i.test(k)||/nom\s*&\s*pr/i.test(k)),g=h.findIndex(k=>/classe/i.test(k)),y=h.findIndex(k=>/contact|tel/i.test(k)),v=["inscription","octobre","novembre","dcembre","decembre","janvier","fvrier","fevrier","mars","avril","mai","juin","juillet","aot","aout","septembre"],b=[];let S=h.map(k=>String(k||"").toLowerCase()).some(k=>k.includes("inscription"))?2:1;h.forEach((k,P)=>{const D=String(k||"").toLowerCase();v.some(R=>D.includes(R))&&(D.includes("inscription")?b.push({idx:P,name:String(k),modalite:1}):(b.push({idx:P,name:String(k),modalite:S}),S++))});const C=[],T=[];for(let k=0;k<m.length;k++){const P=m[k],D=String(P[x]||"").trim(),R=String(P[g]||"").trim(),q=y>=0?String(P[y]||"").trim():"",M=fe.getAll("eleves"),z=g6(M,D,R,q);for(const ie of b){const ce=P[ie.idx];if(!ce&&ce!==0)continue;const ae=String(ce).replace(/[^0-9]/g,"");if(!ae)continue;const me=Number(ae);!me||isNaN(me)||me<=0||C.push({row:k+2,name:D,classe:R,contact:q,month:ie.name,montant:me,modalite:ie.modalite,match:z?{id:z.id,name:Bt(z)}:null})}z||T.push({row:k+2,name:D,classe:R,contact:q})}t({proposals:C,unresolved:T})}catch(i){r(i instanceof Error?i.message:String(i))}},n.onerror=()=>r("Erreur lecture du fichier"),n.readAsArrayBuffer(e)})}async function Noe(e){const t=[],r=[];for(const n of e){if(!n.match||!n.match.id){r.push(n);continue}let i=new Date().toISOString();const s=String(n.month||"").toLowerCase(),c={janvier:1,fevrier:2,fvrier:2,mars:3,avril:4,mai:5,juin:6,juillet:7,aot:8,aout:8,septembre:9,octobre:10,novembre:11,dcembre:12,decembre:12};for(const f in c)if(s.includes(f)){const d=new Date().getFullYear(),h=c[f];i=new Date(d,h-1,1).toISOString();break}try{const f={source:"import",note:`Import ${n.month}`};typeof n.modalite<"u"&&(f.modalite=n.modalite),n.contact&&(f.pereTelephone=n.contact),sb.processPayment(n.match.id,n.montant,i,f),t.push({row:n.row,eleveId:n.match.id,month:n.month,montant:n.montant})}catch{r.push(n)}}return{applied:t,unresolved:r}}function _oe(e){const t=String(e||"").trim();if(!t)return{niveau:"",section:""};const r=t.match(/^([A-Z]+\s*\d*)\s*([A-Z]?)$/i);if(r){const a=r[1].replace(/\s+/g,"").toUpperCase(),i=r[2]||"A";return{niveau:a,section:i.toUpperCase()}}const n=t.split(/\s+/);if(n.length>=2){const a=n[n.length-1];return{niveau:n.slice(0,-1).join("").toUpperCase(),section:a.toUpperCase()}}return{niveau:t.toUpperCase(),section:"A"}}function Eoe(e,t,r){const a=fe.getAll("classes").find(s=>s.niveau===e&&s.section===t&&s.anneeScolaire===r);return a?a.id:fe.create("classes",{niveau:e,section:t,anneeScolaire:r,enseignantPrincipal:"",effectifMax:40,salle:"",matieres:[]}).id}function koe(e){return e?String(e).replace(/[^\d+]/g,"").trim():""}function joe(e,t,r,n){if(t<0)return!1;const a=String(e[t]||"").toLowerCase().trim();if((a.includes("sold")||a.includes("solde"))&&r>=0&&n>=0){const i=Number(String(e[r]||"0").replace(/[^0-9]/g,""))||0,s=Number(String(e[n]||"0").replace(/[^0-9]/g,""))||0;if(i>0&&s>0&&i<s*.5)return!0}return!1}function Mi(e,t){const r=e.map(n=>n.toLowerCase().trim().replace(/\s+/g," "));for(let n=0;n<r.length;n++)for(const a of t)if(r[n]===a.toLowerCase())return{index:n,confidence:100,matchedHeader:e[n]};for(let n=0;n<r.length;n++)for(const a of t){const i=a.toLowerCase();if(r[n].includes(i)||i.includes(r[n]))return{index:n,confidence:80,matchedHeader:e[n]}}for(let n=0;n<r.length;n++){const a=r[n].split(/[\s&]+/);for(const i of t){const s=i.toLowerCase().split(/[\s&]+/);if(s.filter(f=>a.some(d=>d.includes(f)||f.includes(d))).length>=Math.ceil(s.length*.6))return{index:n,confidence:60,matchedHeader:e[n]}}}return{index:-1,confidence:0,matchedHeader:""}}async function Dh(e,t){return new Promise((r,n)=>{const a=new FileReader;a.onload=i=>{try{const s=i.target?.result,c=nl(s,{type:typeof s=="string"?"binary":"array",cellDates:!0,cellNF:!1,cellText:!1}),f=c.SheetNames;console.log(" Feuilles disponibles:",f);const d=t||c.SheetNames[0];console.log(" Feuille slectionne:",d);const h=c.Sheets[d],m=yi.decode_range(h["!ref"]||"A1");console.log(" Plage du fichier:",h["!ref"],"Range:",m);const x=[];for(let te=m.s.c;te<=m.e.c;te++){const O=yi.encode_cell({r:m.s.r,c:te}),K=h[O];K&&K.v!==void 0&&K.v!==null?x.push(String(K.v).trim()):x.push(`Colonne ${te+1}`)}console.log(" En-ttes extraits (mthode directe):",x),console.log(" Nombre total de colonnes:",x.length);const g=yi.sheet_to_json(h,{header:1,defval:"",raw:!1,range:m.s.r});if(!g||g.length===0){n("Fichier Excel vide ou illisible");return}console.log(" Premire ligne via sheet_to_json:",g[0]),console.log(" Comparaison - Direct:",x.length,"vs JSON:",g[0]?.length);const y=g.slice(1,6),v=["nom & prnoms","nom & prenoms","nom et prnoms","nom et prenoms","nom&prnoms","nom&prenoms","noms & prnoms","nom prenom","nom prenoms","nom complet","full name","eleve","lve"],b=["nom","noms","name","lastname","surname"],N=["prnom","prenom","prnoms","prenoms","firstname","given name"],E=["classe","class","niveau","grade"],S=["contact","tel","tlphone","telephone","phone","portable","mobile"],C=["protg","protege","protg ?","protege ?","protected"],T=["statut","status","tat","etat"],k=["total pay","total paye","montant pay","montant paye","paid"],P=["montant d","montant du","montant  payer","scolarit","scolarite","amount due"],D=Mi(x,v),R=Mi(x,b),q=Mi(x,N),M=Mi(x,E),z=Mi(x,S),ie=Mi(x,C),ce=Mi(x,T),ae=Mi(x,k),me=Mi(x,P),de={classe:M.index};D.index>=0&&D.confidence>=60?de.nomPrenomsCombined=D.index:R.index>=0&&q.index>=0?(de.nom=R.index,de.prenoms=q.index):R.index>=0&&(de.nomPrenomsCombined=R.index),z.index>=0&&(de.contact=z.index),ie.index>=0&&(de.protege=ie.index),ce.index>=0&&(de.statut=ce.index),ae.index>=0&&(de.totalPaye=ae.index),me.index>=0&&(de.montantDu=me.index);const he=D.confidence>0?D.confidence:R.confidence>0&&q.confidence>0?Math.min(R.confidence,q.confidence):R.confidence,J=Math.round((he+M.confidence)/2),xe=[{column:"Nom & Prnoms (combin)",detectedIndex:D.index,detectedName:D.matchedHeader,confidence:D.confidence},{column:"Nom (spar)",detectedIndex:R.index,detectedName:R.matchedHeader,confidence:R.confidence},{column:"Prnoms (spar)",detectedIndex:q.index,detectedName:q.matchedHeader,confidence:q.confidence},{column:"Classe",detectedIndex:M.index,detectedName:M.matchedHeader,confidence:M.confidence},{column:"Contact",detectedIndex:z.index,detectedName:z.matchedHeader,confidence:z.confidence},{column:"Protg ?",detectedIndex:ie.index,detectedName:ie.matchedHeader,confidence:ie.confidence}].filter(te=>te.detectedIndex>=0);r({headers:x,detectedMapping:de,confidence:{nom:he,classe:M.confidence,overall:J},preview:y,suggestions:xe,sheets:f,selectedSheet:d})}catch(s){n(s instanceof Error?s.message:String(s))}},a.onerror=()=>n("Erreur lecture du fichier"),a.readAsArrayBuffer(e)})}async function v6(e,t){return new Promise(async(r,n)=>{if(!t)try{const i=await Dh(e);if(console.log(" Analyse du fichier Excel:",i),i.confidence.overall<80){r({needsValidation:!0,analysis:i});return}t=i.detectedMapping,console.log(" Mapping automatique utilis:",t)}catch(i){n(i instanceof Error?i.message:String(i));return}const a=new FileReader;a.onload=i=>{try{const s=i.target?.result,c=nl(s,{type:typeof s=="string"?"binary":"array"}),f=c.SheetNames[0],d=c.Sheets[f],h=yi.sheet_to_json(d,{header:1});if(!h||h.length===0){n("Fichier Excel vide ou illisible");return}const m=h[0].map(ce=>String(ce||"").trim()),x=h.slice(1);if(!t){n("Mapping des colonnes non disponible");return}const g=t.nomPrenomsCombined??-1,y=t.nom??-1,v=t.prenoms??-1,b=t.classe,N=t.contact??-1,E=t.protege??-1,S=t.statut??-1,C=t.totalPaye??-1,T=t.montantDu??-1;console.log(" Colonnes utilises:",{nameIdx:g,nomIdx:y,prenomsIdx:v,classeIdx:b,contactIdx:N,protegeIdx:E,statutIdx:S,totalPayeIdx:C,montantScolariteIdx:T});const k=["inscription","octobre","novembre","dcembre","decembre","janvier","fvrier","fevrier","mars","avril","mai","juin","juillet","aot","aout","septembre"],P=[];let q=m.map(ce=>ce.toLowerCase().trim()).some(ce=>ce.includes("inscription"))?2:1;if(m.forEach((ce,ae)=>{const me=String(ce||"").toLowerCase();k.some(de=>me.includes(de))&&(me.includes("inscription")?P.push({idx:ae,name:String(ce),modalite:1}):(P.push({idx:ae,name:String(ce),modalite:q}),q++))}),console.log(" Colonnes de paiements dtectes:",P),g<0&&y<0){n('Colonne "Nom" ou "Nom & Prnoms" non trouve dans le fichier. Colonnes disponibles: '+m.join(", "));return}if(b<0){n('Colonne "Classe" non trouve dans le fichier. Colonnes disponibles: '+m.join(", "));return}const z=fe.getAll("ecole")[0]?.anneeScolaireActive||`${new Date().getFullYear()}-${new Date().getFullYear()+1}`,ie={elevesCreated:[],classesCreated:[],paiementsApplied:[],errors:[]};for(let ce=0;ce<x.length;ce++){const ae=x[ce];try{let me="",de="",he="";if(g>=0){he=String(ae[g]||"").trim();const H=he.split(" ");me=H[0]||"",de=H.slice(1).join(" ")||""}else if(y>=0&&v>=0)me=String(ae[y]||"").trim(),de=String(ae[v]||"").trim(),he=`${me} ${de}`.trim();else if(y>=0){he=String(ae[y]||"").trim();const H=he.split(" ");me=H[0]||"",de=H.slice(1).join(" ")||""}const J=String(ae[b]||"").trim(),xe=N>=0?String(ae[N]||"").trim():"";if(!me||!J)continue;if(!me){ie.errors.push({row:ce+2,error:"Nom invalide",name:he});continue}console.log(` Traitement ligne ${ce+2}: ${me} ${de} - ${J}`);const{niveau:te,section:O}=_oe(J);if(!te){ie.errors.push({row:ce+2,error:"Classe invalide",name:he});continue}const K=Eoe(te,O,z);!fe.getAll("classes").some(H=>H.id===K&&H.createdAt!==H.updatedAt)&&ie.classesCreated.push({niveau:te,section:O});let X=!1;if(E>=0){const H=String(ae[E]||"").toLowerCase().trim();X=H==="oui"||H==="yes"||H==="o"}else X=joe(ae,S,C,T);const V=koe(xe),ne=fe.create("eleves",{nom:me.toUpperCase(),prenoms:de,matricule:fe.generateMatricule(),sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:K,anneeEntree:z.split("-")[0],statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:V,adresse:"",photo:"",protege:X});ie.elevesCreated.push({nom:ne.nom,prenoms:ne.prenoms,classe:`${te} ${O}`,matricule:ne.matricule,protege:X});let L=0;const U=[];for(const H of P){const oe=ae[H.idx];if(!oe&&oe!==0)continue;const F=String(oe).replace(/[^0-9]/g,"");if(!F)continue;const Ae=Number(F);if(!Ae||isNaN(Ae)||Ae<=0||X&&H.modalite!==1)continue;let Le=new Date().toISOString();const Ue=String(H.name||"").toLowerCase(),Pe={janvier:1,fevrier:2,fvrier:2,mars:3,avril:4,mai:5,juin:6,juillet:7,aot:8,aout:8,septembre:9,octobre:10,novembre:11,dcembre:12,decembre:12};for(const ot in Pe)if(Ue.includes(ot)){const kt=parseInt(z.split("-")[0]),Yt=Pe[ot],jt=Yt>=9?kt:kt+1;Le=new Date(jt,Yt-1,1).toISOString();break}try{const ot={source:"import",note:`Import ${H.name}`,modalite:H.modalite,pereTelephone:V,typeFrais:H.modalite===1?"inscription":"scolarite",modePaiement:"Espces",numeroRecu:`IMP-${ne.matricule}-${H.modalite}`,operateur:"Systme"};sb.processPayment(ne.id,Ae,Le,ot),L+=Ae,U.push(`${H.name}: ${Ae} FCFA`)}catch(ot){ie.errors.push({row:ce+2,error:`Erreur paiement ${H.name}: ${ot instanceof Error?ot.message:String(ot)}`,name:he})}}L>0&&ie.paiementsApplied.push({eleveName:`${ne.nom} ${ne.prenoms}`,totalAmount:L,details:U.join(", ")})}catch(me){ie.errors.push({row:ce+2,error:me instanceof Error?me.message:String(me),name:ae[g]?String(ae[g]):"Inconnu"})}}r(ie)}catch(s){n(s instanceof Error?s.message:String(s))}},a.onerror=()=>n("Erreur lecture du fichier"),a.readAsArrayBuffer(e)})}const Cu=Object.freeze(Object.defineProperty({__proto__:null,analyzeExcelStructure:Dh,applyPaiementsDepuisProposals:Noe,exporterElevesEnExcel:woe,importerElevesDepuisExcel:yoe,importerElevesEtPaiementsComplet:v6,importerPaiementsDepuisExcel:boe,previewImporterPaiementsDepuisExcel:Soe},Symbol.toStringTag,{value:"Module"}));function Coe(){const[e,t]=j.useState(null),[r,n]=j.useState(!1),[a,i]=j.useState(null),[s,c]=j.useState(""),[f,d]=j.useState(null),[h,m]=j.useState(!1),[x,g]=j.useState(null),[y,v]=j.useState(""),b=async T=>{const k=T.target.files?.[0];if(k){t(k),i(null),c(""),d(null),m(!1),g(null),v(""),n(!0);try{const P=await Dh(k);d(P),v(P.selectedSheet),console.log(" Analyse automatique:",P),P.confidence.overall<80&&(m(!0),g(P.detectedMapping))}catch(P){c(P instanceof Error?P.message:String(P))}finally{n(!1)}}},N=async T=>{if(e){v(T),n(!0),c("");try{const k=await Dh(e,T);d(k),g(k.detectedMapping),console.log(" Analyse de la feuille:",T,k),k.confidence.overall<80?m(!0):m(!1)}catch(k){c(k instanceof Error?k.message:String(k))}finally{n(!1)}}},E=async()=>{if(!e){c("Veuillez slectionner un fichier");return}n(!0),c(""),i(null);try{const T=await v6(e,x||void 0);if(T.needsValidation){d(T.analysis),m(!0),g(T.analysis.detectedMapping),n(!1);return}i(T),T.elevesCreated.length>0&&setTimeout(()=>{window.dispatchEvent(new CustomEvent("dataChanged"))},1e3)}catch(T){c(T instanceof Error?T.message:String(T))}finally{n(!1)}},S=(T,k)=>{g(P=>({...P,[T]:k>=0?k:void 0}))},C=()=>{m(!1)};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Importation Complte (lves + Paiements)"}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:" Format du fichier Excel requis:"}),o.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 ml-4",children:[o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Nom & Prnoms"}),": Nom complet de l'lve"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Classe"}),": Classe de l'lve (ex: CP1 A, CE2 B)"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Contact"}),": Numro de tlphone du parent (pre par dfaut)"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Colonnes de mois"}),": Inscription, Octobre, Novembre, Dcembre, etc."]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Statut"}),": Pour dtecter les lves protgs (optionnel)"]})]})]}),o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[o.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:" Fonctionnalits intelligentes:"}),o.jsxs("ul",{className:"text-sm text-green-800 space-y-1 ml-4",children:[o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Cration automatique des classes"}),' base sur la colonne "Classe"']}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Dtection des lves protgs"})," (ne paient que l'inscription)"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Allocation intelligente des paiements"})," sur les chances"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Gestion des paiements excdentaires"})," (report automatique)"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Importation des contacts parents"})," (insensible  la casse)"]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slectionner le fichier Excel"}),o.jsx("div",{className:"flex items-center space-x-4",children:o.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:b,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})}),e&&o.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Fichier slectionn: ",o.jsx("strong",{children:e.name})]})]}),f&&f.sheets.length>1&&o.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-purple-900 mb-2",children:" Slection de la feuille"}),o.jsx("p",{className:"text-sm text-purple-800 mb-3",children:"Votre fichier contient plusieurs feuilles. Slectionnez celle qui contient les donnes  importer :"}),o.jsx("select",{value:y,onChange:T=>N(T.target.value),className:"w-full border border-purple-300 rounded-md px-3 py-2 text-sm bg-white",children:f.sheets.map((T,k)=>o.jsx("option",{value:T,children:T},k))})]}),f&&!h&&o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:" Colonnes dtectes automatiquement"}),o.jsx("div",{className:"text-sm text-green-800 space-y-1",children:f.suggestions.map((T,k)=>o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("span",{children:[T.column,":"]}),o.jsxs("span",{className:"font-medium",children:[T.detectedName," (",T.confidence,"% confiance)"]})]},k))}),o.jsxs("button",{onClick:()=>m(!0),className:"mt-3 text-sm text-green-700 hover:text-green-900 underline flex items-center space-x-1",children:[o.jsx(F0,{className:"w-4 h-4"}),o.jsx("span",{children:"Modifier le mapping"})]})]}),h&&f&&x&&o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[o.jsxs("h4",{className:"font-semibold text-yellow-900 mb-3 flex items-center space-x-2",children:[o.jsx(F0,{className:"w-5 h-5"}),o.jsx("span",{children:"Configuration du mapping des colonnes"})]}),o.jsx("p",{className:"text-sm text-yellow-800 mb-4",children:"Slectionnez les colonnes correspondantes dans votre fichier Excel :"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom & Prnoms (combin) - Optionnel si colonnes spares"}),o.jsxs("select",{value:x.nomPrenomsCombined??-1,onChange:T=>S("nomPrenomsCombined",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom (spar) - Optionnel si colonne combine"}),o.jsxs("select",{value:x.nom??-1,onChange:T=>S("nom",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prnoms (spar) - Optionnel si colonne combine"}),o.jsxs("select",{value:x.prenoms??-1,onChange:T=>S("prenoms",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Classe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("select",{value:x.classe,onChange:T=>S("classe",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact / Tlphone - Optionnel"}),o.jsxs("select",{value:x.contact??-1,onChange:T=>S("contact",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Protg ? - Optionnel"}),o.jsxs("select",{value:x.protege??-1,onChange:T=>S("protege",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,k)=>o.jsx("option",{value:k,children:T},k))]})]})]}),o.jsx("button",{onClick:C,className:"mt-4 w-full bg-yellow-600 text-white py-2 px-4 rounded-lg hover:bg-yellow-700 transition-colors",children:"Confirmer le mapping"})]}),o.jsx("button",{onClick:E,disabled:!e||r||h,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2 transition-colors",children:r?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),o.jsx("span",{children:"Analyse en cours..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Us,{className:"w-5 h-5"}),o.jsx("span",{children:"Lancer l'importation"})]})})]}),s&&o.jsxs("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[o.jsx(y1,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-red-900",children:"Erreur d'importation"}),o.jsx("p",{className:"text-sm text-red-800 mt-1",children:s})]})]})]}),a&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center space-x-2",children:[o.jsx(ua,{className:"w-6 h-6 text-green-600"}),o.jsx("span",{children:"Rsum de l'importation"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(zs,{className:"w-8 h-8 text-blue-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-blue-900",children:a.elevesCreated.length}),o.jsx("p",{className:"text-sm text-blue-700",children:"lves imports"})]})]})}),o.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(qi,{className:"w-8 h-8 text-green-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-green-900",children:a.classesCreated.length}),o.jsx("p",{className:"text-sm text-green-700",children:"Classes cres"})]})]})}),o.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Bs,{className:"w-8 h-8 text-purple-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-purple-900",children:a.paiementsApplied.length}),o.jsx("p",{className:"text-sm text-purple-700",children:"Paiements traits"})]})]})})]})]}),a.classesCreated.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Classes cres automatiquement"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:a.classesCreated.map((T,k)=>o.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:[T.niveau," ",T.section]},k))})]}),a.elevesCreated.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"lves imports"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Matricule"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nom & Prnoms"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Classe"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.elevesCreated.map((T,k)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:T.matricule}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[T.nom," ",T.prenoms]}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:T.classe}),o.jsx("td",{className:"px-4 py-3 text-sm",children:T.protege?o.jsx("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs font-medium",children:"Protg"}):o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:"Normal"})})]},k))})]})})]}),a.paiementsApplied.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Paiements traits"}),o.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:a.paiementsApplied.map((T,k)=>o.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:T.eleveName}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:T.details})]}),o.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold",children:[T.totalAmount.toLocaleString()," FCFA"]})]})},k))})]}),a.errors.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsxs("h4",{className:"font-semibold text-red-800 mb-3 flex items-center space-x-2",children:[o.jsx(lv,{className:"w-5 h-5"}),o.jsxs("span",{children:["Erreurs rencontres (",a.errors.length,")"]})]}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.errors.map((T,k)=>o.jsx("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200",children:o.jsxs("p",{className:"text-sm text-red-900",children:[o.jsxs("strong",{children:["Ligne ",T.row]}),T.name&&o.jsxs("span",{children:[" - ",T.name]}),": ",T.error]})},k))})]})]})]})}function Aoe(){const{showToast:e}=Jr(),[t,r]=j.useState(null),[n,a]=j.useState(0),i=j.useMemo(()=>{const d=[],h=fe.getAll("classes");h.forEach(E=>{(!E.niveau||E.niveau.trim()==="")&&d.push({id:`classe_niveau_${E.id}`,type:"classe_sans_niveau",severity:"error",title:`Classe "${E.nom}" sans niveau`,description:`La classe ${E.nom} (${E.section}) n'a pas de niveau dfini. Cela empche la configuration des frais scolaires.`,affectedItem:E,fixable:!1})});const m=fe.getAll("eleves"),x=new Set(h.map(E=>E.id));m.forEach(E=>{(!E.classeId||!x.has(E.classeId))&&d.push({id:`eleve_classe_${E.id}`,type:"eleve_sans_classe",severity:"error",title:`lve "${E.nom} ${E.prenoms}" sans classe valide`,description:`L'lve n'est pas assign  une classe existante. Matricule: ${E.matricule}`,affectedItem:E,fixable:!1})});const g=fe.getAll("fraisScolaires"),y=new Set(g.map(E=>E.niveau));new Set(h.map(E=>E.niveau).filter(Boolean)).forEach(E=>{y.has(E)||d.push({id:`frais_niveau_${E}`,type:"montant_manquant",severity:"warning",title:`Aucun frais configur pour le niveau "${E}"`,description:`Le niveau ${E} n'a pas de configuration de frais scolaires. Les lves de ce niveau ne pourront pas effectuer de paiements.`,affectedItem:{niveau:E},fixable:!0})});const b=fe.getAll("matieres"),N=new Set;return h.forEach(E=>{E.matieres&&Array.isArray(E.matieres)&&E.matieres.forEach(S=>{const C=typeof S=="string"?S:S?.id;C&&N.add(C)})}),b.forEach(E=>{N.has(E.id)||d.push({id:`matiere_orpheline_${E.id}`,type:"matiere_non_liee",severity:"warning",title:`Matire "${E.nom}" non utilise`,description:`La matire "${E.nom}" n'est assigne  aucune classe.`,affectedItem:E,fixable:!1})}),d},[n]),s=async d=>{r(d.id);try{switch(d.type){case"montant_manquant":{const h=d.affectedItem.niveau,m={id:`frais_${Date.now()}`,niveau:h,anneeScolaire:new Date().getFullYear().toString(),inscription:35e3,scolarite:9e4,nombreVersements:9,montantParVersement:1e4};fe.create("fraisScolaires",m),e(`Configuration de frais cre pour le niveau ${h}`,"success");break}default:e("Cette correction ncessite une intervention manuelle","info")}a(h=>h+1)}catch(h){console.error("Erreur lors de la correction:",h),e("Erreur lors de la correction","error")}finally{r(null)}},c=i.filter(d=>d.severity==="error").length,f=i.filter(d=>d.severity==="warning").length;return o.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Intgrit des Donnes"}),o.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Vrification automatique des problmes de cohrence des donnes"})]}),o.jsxs("button",{onClick:()=>a(d=>d+1),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[o.jsx(v1,{className:"w-4 h-4 mr-2"}),"Actualiser"]})]}),o.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(ua,{className:"w-8 h-8 text-green-600 mr-3"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-green-900",children:i.length===0?"":`${i.length} problmes`}),o.jsx("div",{className:"text-sm text-green-700",children:i.length===0?"Aucun problme dtect":"Problmes trouvs"})]})]})}),o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(lv,{className:"w-8 h-8 text-red-600 mr-3"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-red-900",children:c}),o.jsx("div",{className:"text-sm text-red-700",children:"Erreurs critiques"})]})]})}),o.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(wi,{className:"w-8 h-8 text-orange-600 mr-3"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-orange-900",children:f}),o.jsx("div",{className:"text-sm text-orange-700",children:"Avertissements"})]})]})})]})]}),i.length===0?o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[o.jsx(ua,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Aucun problme dtect"}),o.jsx("p",{className:"text-gray-600",children:"Toutes les donnes sont cohrentes et correctement configures."})]}):o.jsx("div",{className:"space-y-4",children:i.map(d=>o.jsx("div",{className:wt("bg-white rounded-lg shadow-sm p-6 border-l-4",d.severity==="error"?"border-red-500":"border-orange-500"),children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-start flex-1",children:[d.severity==="error"?o.jsx(lv,{className:"w-6 h-6 text-red-600 mr-3 flex-shrink-0 mt-0.5"}):o.jsx(wi,{className:"w-6 h-6 text-orange-600 mr-3 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d.title}),o.jsx("p",{className:"mt-1 text-sm text-gray-600",children:d.description}),d.fixable&&o.jsxs("div",{className:"mt-2 text-sm text-gray-500 flex items-center",children:[o.jsx(C5,{className:"w-4 h-4 mr-1"}),"Correction automatique disponible"]})]})]}),o.jsx("div",{className:"ml-4 flex-shrink-0",children:d.fixable?o.jsx("button",{onClick:()=>s(d),disabled:t===d.id,className:wt("px-4 py-2 rounded-md text-sm font-medium",t===d.id?"bg-gray-300 text-gray-600 cursor-wait":"bg-blue-600 text-white hover:bg-blue-700"),children:t===d.id?"Correction...":"Corriger"}):o.jsx("span",{className:"px-4 py-2 text-sm text-gray-500 italic",children:"Correction manuelle requise"})})]})},d.id))})]})}const Toe={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},Poe=(e,t,r)=>{let n;const a=Toe[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",String(t)),r?.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},Ooe={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},Foe={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Doe={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ioe={date:Zl({formats:Ooe,defaultWidth:"full"}),time:Zl({formats:Foe,defaultWidth:"full"}),dateTime:Zl({formats:Doe,defaultWidth:"full"})},Moe={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},Roe=(e,t,r,n)=>Moe[e],Loe={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},Boe={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},$oe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},Uoe={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},zoe={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},Woe=(e,t)=>{const r=Number(e),n=t?.unit;if(r===0)return"0";const a=["year","week","hour","minute","second"];let i;return r===1?i=n&&a.includes(n)?"re":"er":i="me",r+i},Hoe=["MMM","MMMM"],Voe={preprocessor:(e,t)=>e.getDate()===1||!t.some(n=>n.isToken&&Hoe.includes(n.value))?t:t.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:Woe,era:mi({values:Loe,defaultWidth:"wide"}),quarter:mi({values:Boe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:mi({values:$oe,defaultWidth:"wide"}),day:mi({values:Uoe,defaultWidth:"wide"}),dayPeriod:mi({values:zoe,defaultWidth:"wide"})},Koe=/^(\d+)(ime|re|me|er|e)?/i,Goe=/\d+/i,Xoe={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},qoe={any:[/^av/i,/^ap/i]},Yoe={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},Joe={any:[/1/i,/2/i,/3/i,/4/i]},Qoe={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},Zoe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},ele={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},tle={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},rle={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},nle={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},ale={ordinalNumber:nP({matchPattern:Koe,parsePattern:Goe,valueCallback:e=>parseInt(e)}),era:pi({matchPatterns:Xoe,defaultMatchWidth:"wide",parsePatterns:qoe,defaultParseWidth:"any"}),quarter:pi({matchPatterns:Yoe,defaultMatchWidth:"wide",parsePatterns:Joe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:pi({matchPatterns:Qoe,defaultMatchWidth:"wide",parsePatterns:Zoe,defaultParseWidth:"any"}),day:pi({matchPatterns:ele,defaultMatchWidth:"wide",parsePatterns:tle,defaultParseWidth:"any"}),dayPeriod:pi({matchPatterns:rle,defaultMatchWidth:"any",parsePatterns:nle,defaultParseWidth:"any"})},ile={code:"fr",formatDistance:Poe,formatLong:Ioe,formatRelative:Roe,localize:Voe,match:ale,options:{weekStartsOn:1,firstWeekContainsDate:4}},sv="klasnet_audit_logs",sle=1e3;class ac{static log(t){const r=this.getLogs(),n={...t,id:`log_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now()};r.unshift(n);const a=r.slice(0,sle);localStorage.setItem(sv,JSON.stringify(a)),window.dispatchEvent(new CustomEvent("audit-log-updated"))}static getLogs(){try{const t=localStorage.getItem(sv);return t?JSON.parse(t):[]}catch(t){return console.error("Erreur lecture logs audit:",t),[]}}static clearLogs(){localStorage.removeItem(sv),window.dispatchEvent(new CustomEvent("audit-log-updated"))}static exportLogs(){const t=this.getLogs();return JSON.stringify(t,null,2)}}function ole(){const[e,t]=j.useState(""),[r,n]=j.useState("all"),[a,i]=j.useState("all"),[s,c]=j.useState(()=>ac.getLogs());on.useEffect(()=>{const g=()=>{c(ac.getLogs())};return window.addEventListener("audit-log-updated",g),()=>window.removeEventListener("audit-log-updated",g)},[]);const f=j.useMemo(()=>s.filter(g=>{if(r!=="all"&&g.type!==r||a!=="all"&&g.status!==a)return!1;if(e){const y=e.toLowerCase();return g.action.toLowerCase().includes(y)||g.user.toLowerCase().includes(y)||JSON.stringify(g.details).toLowerCase().includes(y)}return!0}),[s,e,r,a]),d=()=>{const g=ac.exportLogs(),y=new Blob([g],{type:"application/json"}),v=URL.createObjectURL(y),b=document.createElement("a");b.href=v,b.download=`audit-logs-${P0(new Date,"yyyy-MM-dd-HHmm")}.json`,b.click(),URL.revokeObjectURL(v)},h=g=>({import:"Import",export:"Export",payment:"Paiement",note:"Note",delete:"Suppression",update:"Modification",create:"Cration"})[g]||g,m=g=>({import:"bg-blue-100 text-blue-800",export:"bg-green-100 text-green-800",payment:"bg-purple-100 text-purple-800",note:"bg-indigo-100 text-indigo-800",delete:"bg-red-100 text-red-800",update:"bg-orange-100 text-orange-800",create:"bg-teal-100 text-teal-800"})[g]||"bg-gray-100 text-gray-800",x=g=>({success:"text-green-600",error:"text-red-600",warning:"text-orange-600"})[g]||"text-gray-600";return o.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Journal d'Audit"}),o.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Historique de toutes les oprations effectues dans l'application"})]}),o.jsxs("button",{onClick:d,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[o.jsx(c4,{className:"w-4 h-4 mr-2"}),"Exporter"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(wc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher...",value:e,onChange:g=>t(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(cv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsxs("select",{value:r,onChange:g=>n(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 appearance-none",children:[o.jsx("option",{value:"all",children:"Tous les types"}),o.jsx("option",{value:"import",children:"Import"}),o.jsx("option",{value:"export",children:"Export"}),o.jsx("option",{value:"payment",children:"Paiement"}),o.jsx("option",{value:"note",children:"Note"}),o.jsx("option",{value:"create",children:"Cration"}),o.jsx("option",{value:"update",children:"Modification"}),o.jsx("option",{value:"delete",children:"Suppression"})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(cv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsxs("select",{value:a,onChange:g=>i(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 appearance-none",children:[o.jsx("option",{value:"all",children:"Tous les statuts"}),o.jsx("option",{value:"success",children:"Succs"}),o.jsx("option",{value:"error",children:"Erreur"}),o.jsx("option",{value:"warning",children:"Avertissement"})]})]})]}),o.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[f.length," entre(s) sur ",s.length," au total"]})]}),f.length===0?o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[o.jsx(f4,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Aucune entre trouve"}),o.jsx("p",{className:"text-gray-600",children:e||r!=="all"||a!=="all"?"Essayez de modifier vos filtres":"Les oprations seront enregistres ici"})]}):o.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:o.jsx("div",{className:"divide-y divide-gray-200",children:f.map(g=>o.jsx("div",{className:"p-4 hover:bg-gray-50",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("span",{className:wt("px-2 py-1 text-xs font-medium rounded-full",m(g.type)),children:h(g.type)}),o.jsxs("span",{className:wt("text-sm font-medium",x(g.status)),children:[g.status==="success"&&" Succs",g.status==="error"&&" Erreur",g.status==="warning"&&" Avertissement"]})]}),o.jsx("p",{className:"text-sm text-gray-900 font-medium",children:g.action}),Object.keys(g.details).length>0&&o.jsxs("details",{className:"mt-2",children:[o.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer hover:text-gray-700",children:"Voir les dtails"}),o.jsx("pre",{className:"mt-2 p-2 bg-gray-50 rounded text-xs overflow-x-auto",children:JSON.stringify(g.details,null,2)})]})]}),o.jsxs("div",{className:"ml-4 text-right flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-1",children:[o.jsx(Ih,{className:"w-3 h-3 mr-1"}),P0(new Date(g.timestamp),"dd MMM yyyy",{locale:ile})]}),o.jsx("div",{className:"text-xs text-gray-500",children:P0(new Date(g.timestamp),"HH:mm:ss")}),o.jsx("div",{className:"text-xs text-gray-600 mt-1",children:g.user})]})]})},g.id))})})]})}const lle=[{id:"ecole",title:"Configuration cole",description:"Nom, logo, coordonnes de l'tablissement",icon:o4},{id:"frais",title:"Configuration Frais",description:"Modalits et chances de paiement par niveau",icon:Bs},{id:"compositions",title:"Configuration Compositions",description:"Priodes d'valuation et coefficients",icon:qi},{id:"impression",title:"Configuration Impression",description:"Enttes, logos et mise en page des documents",icon:f4},{id:"import",title:"Importation Complte",description:"Importer lves, classes et paiements depuis Excel",icon:Us},{id:"integrity",title:"Intgrit des Donnes",description:"Vrifier et corriger les problmes de donnes",icon:ua},{id:"audit",title:"Journal d'Audit",description:"Historique des oprations et traabilit",icon:v5},{id:"backup",title:"Sauvegarde & Restauration",description:"Export, import et gestion des donnes",icon:x5},{id:"historique",title:"Historique des Actions",description:"Journal des modifications et oprations",icon:y5},{id:"licence",title:"Gestion des Licences",description:"Activation et statut de la licence logicielle",icon:m4},{id:"passage",title:"Passage d'anne scolaire",description:"Clturer l'anne en cours et prparer la nouvelle",icon:x1}];function cle(){const[e,t]=j.useState("menu"),r=()=>{switch(e){case"ecole":return o.jsx(v4,{});case"frais":return o.jsx(uq,{});case"compositions":return o.jsx(fq,{});case"impression":return o.jsx(dq,{});case"import":return o.jsx(Coe,{});case"integrity":return o.jsx(Aoe,{});case"audit":return o.jsx(ole,{});case"backup":return o.jsx(hq,{});case"historique":return o.jsx(mq,{});case"licence":return o.jsx(pq,{});case"passage":return o.jsx(gq,{});default:return o.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-8",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Configuration Systme"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Paramtres gnraux de votre cole"})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:lle.map(n=>{const a=n.icon;return o.jsxs("button",{onClick:()=>t(n.id),className:"group bg-white rounded-lg border border-gray-200 p-6 hover:border-gray-300 hover:shadow-sm transition-all text-left",children:[o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mb-4 group-hover:bg-gray-200 transition-colors",children:o.jsx(a,{className:"h-6 w-6 text-gray-600"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n.title}),o.jsx("p",{className:"text-gray-600 text-sm mb-4",children:n.description}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500 group-hover:text-gray-700 transition-colors",children:[o.jsx("span",{children:"Configurer"}),o.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},n.id)})}),o.jsxs("div",{className:"mt-8 bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Informations Systme"}),o.jsx("p",{className:"text-gray-600",children:"tat actuel de votre configuration"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"text-center p-6 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:fe.getAll("eleves").length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"lves"})]}),o.jsxs("div",{className:"text-center p-6 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:fe.getAll("classes").length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Classes"})]}),o.jsxs("div",{className:"text-center p-6 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:fe.getAll("matieres").length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Matires"})]})]})]})]})})}};return e!=="menu"?o.jsx("div",{className:"bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("button",{onClick:()=>t("menu"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[o.jsx(s4,{className:"h-4 w-4"}),o.jsx("span",{children:"Retour  la configuration"})]})}),r()]})}):o.jsx("div",{children:r()})}function ule({onCancel:e,onSubmit:t}){const r=fe.getAll("classes"),[n,a]=j.useState(""),[i,s]=j.useState(""),[c,f]=j.useState(!1),[d,h]=j.useState(""),[m,x]=j.useState("scolarite"),[g,y]=j.useState("auto"),[v,b]=j.useState("espece"),[N,E]=j.useState(""),{showToast:S}=Jr(),[C,T]=j.useState(!1),k=j.useRef({selectedClasse:n,eleveId:i,montant:d,type:m,modalite:g,mode:v,note:N}),P=j.useMemo(()=>{try{return JSON.stringify({selectedClasse:n,eleveId:i,montant:d,type:m,modalite:g,mode:v,note:N})!==JSON.stringify(k.current||{})}catch{return!1}},[n,i,d,m,g,v,N]),D=gm(P),R="payment:draft",{load:q,clear:M}=vm(R,{selectedClasse:n,eleveId:i,montant:d,type:m,modalite:g,mode:v,note:N});useEffect(()=>{try{const ae=q();ae&&(a(ae.selectedClasse||""),s(ae.eleveId||""),h(ae.montant||""),x(ae.type||"scolarite"),y(ae.modalite||"auto"),b(ae.mode||"espece"),E(ae.note||""),k.current=ae)}catch{}},[]);const z=()=>"REC"+Date.now().toString().slice(-8),ie=ae=>{s(ae);const me=fe.getById("eleves",ae);f(!!me?.protege);try{const he=ib(ae).find(J=>J.remaining>0);if(he){const J=String(he.echeanceId).split("-"),xe=J[J.length-1],te=Number(xe);Number.isFinite(te)&&te>=1&&te<=7&&y(te)}}catch(de){console.debug("compute schedule failed",de)}},ce=ae=>{a(ae);const me=fe.getAll("eleves").filter(de=>!ae||de.classeId===ae);me.length?ie(me[0].id):s("")};return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 flex flex-col max-h-[90vh]",children:[o.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-100",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Nouveau Paiement"}),o.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",onClick:()=>P&&D?D.openPrompt():e(),"aria-label":"Fermer",children:""})]}),o.jsxs("div",{className:"overflow-y-auto px-4 py-3 space-y-3 flex-1",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Classe"}),o.jsxs("select",{value:n,onChange:ae=>ce(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"-- Toutes les classes --"}),r.map(ae=>o.jsxs("option",{value:ae.id,children:[ae.niveau," ",ae.section]},ae.id))]}),o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 mt-4",children:"lve"}),o.jsxs("select",{value:i,onChange:ae=>ie(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"-- Slectionner lve --"}),fe.getAll("eleves").filter(ae=>!n||ae.classeId===n).map(ae=>o.jsxs("option",{value:ae.id,children:[ae.nom," ",ae.prenoms," (",ae.matricule,")"]},ae.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant (FCFA)"}),o.jsx("input",{type:"number",value:d,onChange:ae=>h(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors text-lg font-bold",placeholder:"0"}),c&&o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"lve protg: montant libre, mais seule l'inscription sera prise en compte."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de frais"}),o.jsx("select",{value:m,onChange:ae=>x(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",disabled:c,children:c?o.jsx("option",{value:"inscription",children:"Inscription"}):o.jsxs(o.Fragment,{children:[o.jsx("option",{value:"scolarite",children:"Scolarit"}),o.jsx("option",{value:"inscription",children:"Inscription"}),o.jsx("option",{value:"cantine",children:"Cantine"}),o.jsx("option",{value:"transport",children:"Transport"}),o.jsx("option",{value:"fournitures",children:"Fournitures"})]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modalit de versement"}),o.jsx("select",{value:String(g),onChange:ae=>y(ae.target.value==="auto"?"auto":Number(ae.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",disabled:c,children:c?o.jsx("option",{value:1,children:"1 - Inscription"}):o.jsxs(o.Fragment,{children:[o.jsx("option",{value:"auto",children:"Auto"}),o.jsx("option",{value:1,children:"1 - Inscription"}),o.jsx("option",{value:2,children:"2 - Versement 1"}),o.jsx("option",{value:3,children:"3 - Versement 2"}),o.jsx("option",{value:4,children:"4 - Versement 3"}),o.jsx("option",{value:5,children:"5 - Versement 4"}),o.jsx("option",{value:6,children:"6 - Versement 5"}),o.jsx("option",{value:7,children:"7 - Versement 6"})]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mode de paiement"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{value:"espece",label:"Espces"},{value:"mobile",label:"Mobile Money"},{value:"cheque",label:"Chque"},{value:"virement",label:"Virement"}].map(ae=>o.jsxs("label",{className:`flex items-center justify-center p-2 border rounded-md cursor-pointer transition-all ${v===ae.value?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"mode",value:ae.value,checked:v===ae.value,onChange:me=>b(me.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium text-sm",children:ae.label})]},ae.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note ou commentaire (optionnel)"}),o.jsx("textarea",{value:N,onChange:ae=>E(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors resize-none",rows:3,placeholder:"Commentaire sur ce paiement..."})]})]}),o.jsxs("div",{className:"px-4 py-3 border-t bg-white flex flex-col sm:flex-row justify-end gap-2 lg:gap-4",children:[o.jsx(Ft,{variant:"secondary",className:"w-full sm:w-auto",onClick:()=>P&&D?D.openPrompt():e(),disabled:C,children:"Annuler"}),o.jsxs(Ft,{variant:"primary",className:"w-full sm:w-auto",onClick:async()=>{if(!i){S("Slectionnez un lve","error");return}const ae=Number(d||0);if(!ae||ae<=0){S("Montant invalide","error");return}T(!0);const me=z();try{const de={mode:v,note:N,numeroRecu:me,type:m,modalite:g};try{const{getCurrentUser:J}=await yn(async()=>{const{getCurrentUser:te}=await Promise.resolve().then(()=>US);return{getCurrentUser:te}},void 0,import.meta.url),xe=J();xe&&(de.utilisateur=Bt(xe))}catch(J){console.debug("getCurrentUser failed",J)}const he=sf.processPaymentIntelligent(i,ae,new Date().toISOString(),de);try{const J=(await yn(async()=>{const{getCurrentUser:te}=await Promise.resolve().then(()=>US);return{getCurrentUser:te}},void 0,import.meta.url)).getCurrentUser(),xe=he&&he.paiement&&he.paiement.id?String(he.paiement.id):void 0;fe.addHistorique({type:"paiement",cible:"Paiement",cibleId:xe,description:`Paiement de ${ae} FCFA pour lve ${i} (reu ${de.numeroRecu})`,utilisateur:J?`${J.prenoms} ${J.nom}`:"Inconnu"})}catch(J){console.debug("historique skip:",J)}try{const J=fe.getById("eleves",i),xe=J?Bt(J):"",te=`
                      <html><head><title>Reu ${de.numeroRecu}</title></head><body>
                        <h2>Reu de paiement</h2>
                        <div>Reu: ${de.numeroRecu}</div>
                        <div>lve: ${xe} (${J?.matricule||""})</div>
                        <div>Montant: ${ae} FCFA</div>
                        <div>Mode: ${de.mode}</div>
                        <div>Date: ${new Date().toLocaleString()}</div>
                      </body></html>`,O=window.open("","_blank","width=600,height=800");O&&(O.document.write(te),O.document.close(),setTimeout(()=>{try{O.print()}catch(K){console.debug("print failed",K)}},300))}catch(J){console.debug("preview failed",J)}try{t(i,ae,m,g,he.paiement)}catch(J){console.debug("onSubmit handler error",J)}S("Paiement enregistr","success");try{M()}catch{}e()}catch(de){console.error(de);const he=de&&de.message?de.message:"Erreur lors de l'enregistrement du paiement";S(he,"error")}finally{T(!1)}},disabled:C,children:[C?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 lg:h-5 lg:w-5 border-b-2 border-white"}):o.jsx("span",{children:"Enregistrer"}),o.jsx("span",{children:C?"Enregistrement...":"Paiement"})]})]})]}),D&&o.jsx(bf,{open:D.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardes. Voulez-vous quitter sans enregistrer ?",onConfirm:()=>{try{M()}catch{}const ae=window;try{ae.__preventReDispatch=!0}catch{}try{D.allowNavigation?D.allowNavigation():e()}finally{setTimeout(()=>{try{ae.__preventReDispatch=!1}catch{}},80)}},onCancel:()=>D.closePrompt&&D.closePrompt()})]})}function fle(e,t="Aperu convocations"){const r=document.getElementById(e);if(r)try{const n=r.innerHTML,i=new DOMParser().parseFromString(n,"text/html");i.querySelectorAll(".no-print, button").forEach(h=>h.remove());const s=i.body.innerHTML,f=`<!doctype html><html><head><meta charset="utf-8"/><title>${t}</title>
      <style>
        @page { size: A4 portrait; margin: 12mm; }
        :root { --page-height: 297mm; --print-margin: 12mm; }
        html,body { height: 100%; }
        body { font-family: 'Times New Roman', Times, serif; color: #111827; padding: 0; margin: 0; background: #ffffff; }
        .receipt-wrapper { width: 210mm; margin: 0 auto; padding: 0; box-sizing: border-box; }
        .convocations-wrapper { display: block; box-sizing: border-box; }
  .convocation { box-sizing: border-box; height: 65mm; padding: 6mm; overflow: visible; position: relative; }
        .convocation + .convocation { border-top: 1px dashed #444; margin-top: 4mm; padding-top: 4mm; }
        .convocation + .convocation::before { content: '\\2702'; position: absolute; top: -9mm; left: 50%; transform: translateX(-50%); background: white; padding: 0 3px; color: #444; font-size: 10px; }
  .convocation { break-inside: avoid; }
  /* ensure important / deadline markers render even when global CSS isn't loaded */
  .print-important { color: #b91c1c !important; font-weight: 800 !important; }
  .print-deadline { color: #7f1d1d !important; font-weight: 700 !important; font-size: 1.0rem !important; display: block; margin-top: 6px; }
        .convocation:nth-child(4n) { page-break-after: always; }
      </style>
    </head><body><div class="receipt-wrapper print-four-per-page">${s}</div></body></html>`,d=window.open("","_blank");if(!d)return;d.document.open(),d.document.write(f),d.document.close(),d.focus(),setTimeout(()=>{try{d.print()}catch{}},300)}catch{const a=document.getElementById(e);if(!a)return;const i=window.open("","_blank");if(!i)return;i.document.open(),i.document.write("<html><head><title>"+t+"</title></head><body>"+a.innerHTML+"</body></html>"),i.document.close(),i.print()}}function ov(e,t="Aperu"){const r=document.getElementById(e);if(!r)return;if(r.getAttribute("data-print-mode")==="convocations"||r.classList.contains("print-four-per-page"))return fle(e,t);const a=!!r.getAttribute&&!!r.getAttribute("data-print-two-up");return sP(e,t,a)}function dle(e,t=300){const[r,n]=j.useState(e);return j.useEffect(()=>{const a=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(a)}},[e,t]),r}function hle(){const[e,t]=on.useState(0),[r,n]=on.useState(!1),[a,i]=on.useState(""),[s,c]=on.useState("scolarite"),[f,d]=on.useState(!1),h=fe.getAll("eleves"),m=fe.getAll("paiements"),x=fe.getAll("fraisScolaires"),g=fe.getAll("classes"),[y,v]=j.useState(""),[b,N]=j.useState(""),E=dle(b,300),S=j.useMemo(()=>{let O=h;if(y&&(O=O.filter(K=>K.classeId===y)),E){const K=E.toLowerCase();O=O.filter(W=>W.nom.toLowerCase().includes(K)||W.prenoms.toLowerCase().includes(K)||W.matricule.toLowerCase().includes(K))}return O},[h,y,E]),[C,T]=j.useState(null),[k,P]=j.useState(1),[D,R]=j.useState(!1),[q,M]=j.useState([]),{showToast:z}=Jr();on.useEffect(()=>{const O=K=>{const W=K;W?.detail?.page==="finances"&&T(W.detail.eleveId||null)};return window.addEventListener("navigate",O),()=>window.removeEventListener("navigate",O)},[]);const ie=j.useMemo(()=>{const O=new Map;return m.forEach(K=>{const W=O.get(K.eleveId)||[];O.set(K.eleveId,[...W,K])}),O},[m]),ce=j.useMemo(()=>{const O=new Map;return x.forEach(K=>{O.set(`${K.niveau}_${K.anneeScolaire}`,K)}),O},[x]),ae=(O,K)=>(ie.get(O)??[]).reduce((X,V)=>X+(V.montant||0),0),me=O=>ae(O);function de(O){const K=g.find(X=>X.id===O.classeId);return K&&ce.get(`${K.niveau}_${K.anneeScolaire}`)||null}function he(O,K){const W=ie.get(O)??[];if(Number(K)===1){const ne=W.filter(U=>U.typeFrais==="inscription").reduce((U,H)=>U+(H.montant||0),0),L=W.filter(U=>U.typeFrais==="scolarite"&&Number(U.versementIndex)===1).reduce((U,H)=>U+(H.montant||0),0);return ne+L||0}return W.filter(ne=>ne.typeFrais==="scolarite").filter(ne=>Number(ne.versementIndex)===Number(K)).reduce((ne,L)=>ne+(L.montant||0),0)||0}function J(O,K){const W=h.find(H=>H.id===O);if(!W)return;const X=de(W);if(!X||!X.echeances||X.echeances.length===0){const H="REC"+Date.now().toString().slice(-8);fe.create("paiements",{eleveId:O,montant:K,typeFrais:"scolarite",datePaiement:new Date().toISOString(),numeroRecu:H,modePaiement:"Espces",createdAt:new Date().toISOString()});const oe=Ya();ac.log({type:"payment",action:`Paiement de ${K} FCFA enregistr pour ${W.nom} ${W.prenoms}`,user:oe?`${oe.prenoms} ${oe.nom}`:"Inconnu",details:{eleveId:O,montant:K,type:"scolarite",numeroRecu:H},status:"success"});return}let V=Number(K||0);const ne=(X.echeances||[]).slice().sort((H,oe)=>(H.modalite||0)-(oe.modalite||0)),L=[];for(const H of ne){if(V<=0)break;const oe=Number(H.modalite||0),F=Number(H.montant||0),Ae=he(O,oe)||0,je=Math.max(0,F-Ae);if(je<=0)continue;const Le=Math.min(V,je),Ue="REC"+Date.now().toString().slice(-8)+"-"+oe;oe===1?fe.create("paiements",{eleveId:O,montant:Le,typeFrais:"inscription",datePaiement:new Date().toISOString(),numeroRecu:Ue,modePaiement:"Espces",createdAt:new Date().toISOString()}):fe.create("paiements",{eleveId:O,montant:Le,typeFrais:"scolarite",versementIndex:oe,datePaiement:new Date().toISOString(),numeroRecu:Ue,modePaiement:"Espces",createdAt:new Date().toISOString()}),L.push({modalite:oe,montant:Le,numero:Ue}),V-=Le}if(V>0){const H="REC"+Date.now().toString().slice(-8)+"-SUR";fe.create("paiements",{eleveId:O,montant:V,typeFrais:"scolarite",datePaiement:new Date().toISOString(),numeroRecu:H,modePaiement:"Espces",createdAt:new Date().toISOString()}),L.push({type:"surplus",montant:V,numero:H})}const U=Ya();ac.log({type:"payment",action:`Paiement de ${K} FCFA allou automatiquement pour ${W.nom} ${W.prenoms}`,user:U?`${U.prenoms} ${U.nom}`:"Inconnu",details:{eleveId:O,montantTotal:K,allocations:L},status:"success"})}function xe(O){const W=(ie.get(O)??[]).filter(ne=>Number(ne.montant||0)===0);if(!W.length){z("Aucun paiement  0 FCFA trouv","info");return}W.forEach(ne=>{try{fe.delete("paiements",ne.id)}catch{}});const X=h.find(ne=>ne.id===O),V=Ya();ac.log({type:"delete",action:`${W.length} paiement(s)  0 FCFA supprim(s) pour ${X?.nom} ${X?.prenoms}`,user:V?`${V.prenoms} ${V.nom}`:"Inconnu",details:{eleveId:O,count:W.length},status:"success"}),z(`${W.length} paiement(s)  0 FCFA supprim(s)`,"success"),t(ne=>ne+1)}function te(O,K){P(O),i(String(K)),c("scolarite"),z(`Modalit ${O} slectionne (${K.toLocaleString("fr-FR")} FCFA)`,"info")}return o.jsxs("div",{children:[o.jsx("span",{className:"hidden",children:e}),o.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("button",{className:"px-3 py-1 bg-teal-600 text-white rounded",onClick:()=>{M([]),R(!0)},children:"Aperu reus"}),o.jsx("button",{className:"ml-3 px-3 py-1 bg-green-600 text-white rounded",onClick:()=>n(!0),children:"Nouveau paiement"}),o.jsx("button",{className:"ml-3 bg-yellow-600 text-white px-4 py-2 rounded",onClick:async()=>{try{const O=`convocations-print-${Date.now()}`,K=document.createElement("div");K.id=O,document.body.appendChild(K);const W=[];for(const ne of S){const L=de(ne);if(!L||!(L.echeances||[]).length)continue;const U=[];let H=0;for(const oe of L.echeances||[]){const F=Number(oe.modalite||0),Ae=Number(oe.montant||0),je=he(ne.id,F),Le=Math.max(0,Ae-je);Le>0&&(U.push({modalite:F,attendu:Ae,paye:je,reste:Le,date:oe.date}),H+=Le)}U.length&&W.push({ele:ne,echeances:U,totalDue:H})}if(!W.length){z("Aucune convocation  imprimer","info"),K.remove();return}const[{default:X}]=await Promise.all([yn(()=>import("./Convocation-B-KHCzua.js"),[],import.meta.url)]),{createRoot:V}=await yn(async()=>{const{createRoot:ne}=await Promise.resolve().then(()=>hx);return{createRoot:ne}},void 0,import.meta.url);W.forEach(ne=>{const L=document.createElement("div");K.appendChild(L);const U=V(L),H=g.find(oe=>oe.id===ne.ele.classeId);U.render(on.createElement(X,{eleve:ne.ele,echeances:ne.echeances,totalDue:ne.totalDue,classe:H,anneeScolaire:H?.anneeScolaire||""}))}),setTimeout(()=>{ov(O,"Convocations de paiement"),setTimeout(()=>{const ne=document.getElementById(O);ne&&ne.remove()},2e3)},200)}catch(O){z("Erreur lors de la gnration des convocations","error"),console.error(O)}},children:"Imprimer convocations"})]}),o.jsx("h2",{className:"text-xl font-bold mb-4",children:"Gestion des Finances"})]}),o.jsxs("div",{className:"flex space-x-4 mb-4",children:[o.jsxs("select",{value:y,onChange:O=>v(O.target.value),className:"border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"Toutes les classes"}),g.map(O=>o.jsxs("option",{value:O.id,children:[O.niveau," ",O.section]},O.id))]}),o.jsx("input",{type:"text",placeholder:"Recherche lve...",value:b,onChange:O=>N(O.target.value),className:"border rounded px-2 py-1"})]}),C&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 max-w-2xl w-full",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold",children:["Gestion financire - ",h.find(O=>O.id===C)?.nom]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{className:"text-sm px-2 py-1 bg-gray-100 rounded",onClick:()=>xe(C),children:"Nettoyer 0 FCFA"}),o.jsx("button",{className:"text-gray-500",onClick:()=>T(null),children:""})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm",children:"Statut"}),o.jsxs("select",{value:h.find(O=>O.id===C)?.statutInscription||"non-inscrit",onChange:O=>{const K=O.target.value,W=h.find(X=>X.id===C);if(W){if(fe.update("eleves",W.id,{...W,statutInscription:K}),K==="inscrit"){const X=g.find(L=>L.id===W.classeId),V=x.find(L=>L.niveau===X?.niveau&&L.anneeScolaire===X?.anneeScolaire),ne=V&&V.fraisInscription||0;if(ne>0){const L=m.find(U=>U.eleveId===W.id&&(U.typeFrais==="inscription"||U.typeFrais==="inscription"));L?L&&Number(L.montant||0)===0&&fe.update("paiements",L.id,{...L,montant:ne,updatedAt:new Date().toISOString()}):fe.create("paiements",{eleveId:W.id,montant:ne,typeFrais:"inscription",numeroRecu:"REC"+Date.now().toString().slice(-8),datePaiement:new Date().toISOString(),modePaiement:"Espces",createdAt:new Date().toISOString()})}t(L=>L+1)}z("Statut mis  jour","success"),t(X=>X+1)}},className:"border rounded px-2 py-1 w-full",children:[o.jsx("option",{value:"non-inscrit",children:"Non-inscrit"}),o.jsx("option",{value:"inscrit",children:"Inscrit"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm",children:"Enregistrer un versement"}),o.jsxs("div",{className:"mt-2 flex gap-2",children:[o.jsx("input",{placeholder:"Montant",type:"number",value:a,onChange:O=>i(O.target.value),className:"border px-2 py-1 rounded w-1/2"}),o.jsxs("select",{value:s,onChange:O=>c(O.target.value),className:"border px-2 py-1 rounded w-1/2",children:[o.jsx("option",{value:"scolarite",children:"Scolarit (V)"}),o.jsx("option",{value:"inscription",children:"Inscription"}),o.jsx("option",{value:"cantine",children:"Cantine"})]})]}),o.jsxs("div",{className:"mt-2 flex gap-2 items-center",children:[o.jsx("div",{className:"text-sm",children:"Modalit:"}),o.jsxs("select",{value:k,onChange:O=>P(O.target.value==="auto"?"auto":Number(O.target.value)),className:"border px-2 py-1 rounded w-40",children:[o.jsx("option",{value:"auto",children:"Auto"}),o.jsx("option",{value:1,children:"1 - V1"}),o.jsx("option",{value:2,children:"2 - V2"}),o.jsx("option",{value:3,children:"3 - V3"}),o.jsx("option",{value:4,children:"4 - V4"}),o.jsx("option",{value:5,children:"5 - V5"}),o.jsx("option",{value:6,children:"6 - V6"}),o.jsx("option",{value:7,children:"7 - V7"})]})]}),o.jsx("div",{className:"mt-2 flex gap-2",children:o.jsx("button",{className:"px-3 py-1 bg-teal-600 text-white rounded",onClick:()=>{const O=Number(a||0),K=s||"scolarite";if(!O||!C){z("Montant invalide","error");return}const W="REC"+Date.now().toString().slice(-8),X={eleveId:C,montant:O,typeFrais:K,datePaiement:new Date().toISOString(),numeroRecu:W,modePaiement:"Espces",createdAt:new Date().toISOString()};if(K==="scolarite")if(k==="auto")O>0?J(C,O):z("Montant invalide pour allocation automatique","error");else if(O>0){const V=Number(k);if(V===1){const ne={...X,typeFrais:"inscription"};fe.create("paiements",ne)}else X.versementIndex=V,fe.create("paiements",X)}else z("Montant invalide","error");else O>0?fe.create("paiements",X):z("Montant invalide","error");z("Versement enregistr","success"),i(""),c("scolarite"),t(V=>V+1)},children:"Enregistrer"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm",children:"Imprimer reus"}),o.jsx("div",{className:"mt-2",children:o.jsx("button",{className:"px-3 py-1 bg-teal-600 text-white rounded",onClick:async()=>{if(!C)return;const O=m.filter(L=>L.eleveId===C);if(!O.length){z("Aucun paiement pour cet lve","info");return}const K=`print-area-eleve-${C}-${Date.now()}`,W=document.createElement("div");W.id=K,document.body.appendChild(W);const[{createRoot:X},{default:V}]=await Promise.all([yn(()=>Promise.resolve().then(()=>hx),void 0,import.meta.url),yn(()=>import("./RecuPaiement-uhXbpdHO.js"),[],import.meta.url)]),ne=h.find(L=>L.id===C);O.forEach((L,U)=>{const H=document.createElement("div");H.id=`${K}-${U}`,W.appendChild(H),X(H).render(on.createElement(V,{eleve:{nom:ne.nom,prenoms:ne.prenoms,matricule:ne.matricule,classe:g.find(F=>F.id===ne.classeId)?.niveau||""},montantRegle:L.montant||0,date:L.datePaiement||new Date().toISOString(),mode:L.modePaiement||"Espces",cumulReglement:me(C),resteAPayer:0,anneeScolaire:g.find(F=>F.id===ne.classeId)?.anneeScolaire||"",operateur:Ya()?`${Ya().prenoms} ${Ya().nom}`:"Inconnu",numeroRecu:L.numeroRecu||"REC"+Date.now().toString().slice(-8),printMode:!0}))}),setTimeout(()=>{ov(K,`Reus ${C}`),setTimeout(()=>{const L=document.getElementById(K);L&&L.remove()},2e3)},150)},children:"Aperu reus"})})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"font-semibold",children:"Historique des paiements"}),o.jsx("div",{className:"max-h-48 overflow-auto mt-2",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"border px-2 py-1",children:"Date"}),o.jsx("th",{className:"border px-2 py-1",children:"Montant"}),o.jsx("th",{className:"border px-2 py-1",children:"Type"}),o.jsx("th",{className:"border px-2 py-1",children:"Reu"})]})}),o.jsx("tbody",{children:m.filter(O=>O.eleveId===C).map(O=>o.jsxs("tr",{children:[o.jsx("td",{className:"border px-2 py-1",children:new Date(O.datePaiement||O.date||"").toLocaleDateString("fr-FR")}),o.jsxs("td",{className:"border px-2 py-1",children:[O.montant," FCFA"]}),o.jsx("td",{className:"border px-2 py-1",children:O.typeFrais}),o.jsx("td",{className:"border px-2 py-1",children:O.numeroRecu||"-"})]},O.id))})]})})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"font-semibold",children:"chances & Statut"}),o.jsx("div",{className:"max-h-40 overflow-auto mt-2",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"border px-2 py-1",children:"Modalit"}),o.jsx("th",{className:"border px-2 py-1",children:"Date"}),o.jsx("th",{className:"border px-2 py-1",children:"Attendu"}),o.jsx("th",{className:"border px-2 py-1",children:"Pay"}),o.jsx("th",{className:"border px-2 py-1",children:"Reste"})]})}),o.jsx("tbody",{children:(()=>{const O=h.find(W=>W.id===C);if(!O)return null;const K=de(O);return!K||!(K.echeances||[]).length?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"text-gray-500 text-center py-2",children:"Aucune chance configure"})}):(K.echeances||[]).map(W=>{const X=Number(W.modalite||0),V=Number(W.montant||0),ne=he(C,X),L=Math.max(0,V-ne),U=L===0?"paid":ne>0?"partial":"unpaid",H=U==="paid"?"bg-green-100 text-green-800":U==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-700";return o.jsxs("tr",{children:[o.jsx("td",{className:"border px-2 py-1",children:X}),o.jsx("td",{className:"border px-2 py-1",children:W.date}),o.jsxs("td",{className:"border px-2 py-1",children:[V.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("td",{className:"border px-2 py-1",children:[ne.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("td",{className:"border px-2 py-1 flex items-center justify-between",children:[o.jsxs("span",{children:[L.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${H}`,children:U==="paid"?"Pay":U==="partial"?"Partiel":"Non pay"}),o.jsx("button",{className:"text-sm px-2 py-1 bg-blue-600 text-white rounded",onClick:()=>te(X,L),children:"Rgler"})]})]})]},X)})})()})]})})]})]})}),D&&C&&o.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full p-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Slectionner les reus  imprimer"}),o.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Choisissez une ou plusieurs oprations (cocher). Vous pouvez imprimer sparment ou combiner les paiements slectionns en un seul reu."}),o.jsx("div",{className:"max-h-64 overflow-auto border rounded p-2 mb-4",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsxs("th",{className:"px-2 py-1",children:[" ",o.jsx("input",{type:"checkbox",onChange:O=>{const K=m.filter(W=>W.eleveId===C).map(W=>W.id);M(O.target.checked?K:[])},checked:q.length>0&&q.length===m.filter(O=>O.eleveId===C).length})]}),o.jsx("th",{className:"px-2 py-1",children:"Date"}),o.jsx("th",{className:"px-2 py-1",children:"Montant"}),o.jsx("th",{className:"px-2 py-1",children:"Type"}),o.jsx("th",{className:"px-2 py-1",children:"Reu"})]})}),o.jsx("tbody",{children:m.filter(O=>O.eleveId===C).map(O=>{const K=O.id;return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-2 py-1 text-center",children:o.jsx("input",{type:"checkbox",checked:q.includes(K),onChange:W=>{M(X=>W.target.checked?[...X,K]:X.filter(V=>V!==K))}})}),o.jsx("td",{className:"px-2 py-1",children:new Date(O.datePaiement||O.date||"").toLocaleDateString("fr")}),o.jsxs("td",{className:"px-2 py-1",children:[O.montant," FCFA"]}),o.jsx("td",{className:"px-2 py-1",children:O.typeFrais}),o.jsx("td",{className:"px-2 py-1",children:O.numeroRecu||"-"})]},K)})})]})}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{className:"px-3 py-1 bg-gray-300 rounded",onClick:()=>{R(!1),M([])},children:"Annuler"}),o.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded",onClick:async()=>{if(!C)return;const O=m.filter(U=>q.includes(U.id));if(O.length===0){z("Slectionnez au moins une opration","error");return}const K=`print-area-eleve-${C}-${Date.now()}`,W=document.createElement("div");W.id=K,document.body.appendChild(W);const[{createRoot:X},{default:V},{default:ne}]=await Promise.all([yn(()=>Promise.resolve().then(()=>hx),void 0,import.meta.url),yn(()=>import("./RecuPaiement-uhXbpdHO.js"),[],import.meta.url),yn(()=>import("./CombinedRecu-DI1RiGba.js"),__vite__mapDeps([0,1]),import.meta.url)]),L=h.find(U=>U.id===C);if(q.length===1){const U=O[0],H=document.createElement("div");W.appendChild(H),X(H).render(on.createElement(V,{eleve:{nom:L.nom,prenoms:L.prenoms,matricule:L.matricule,classe:g.find(F=>F.id===L.classeId)?.niveau||""},montantRegle:U.montant||0,date:U.datePaiement||new Date().toISOString(),mode:U.modePaiement||"Espces",cumulReglement:me(C),resteAPayer:0,anneeScolaire:g.find(F=>F.id===L.classeId)?.anneeScolaire||"",operateur:Ya()?`${Ya().prenoms} ${Ya().nom}`:"Inconnu",numeroRecu:U.numeroRecu||"REC"+Date.now().toString().slice(-8),printMode:!0}))}else{const U=document.createElement("div");W.appendChild(U),X(U).render(on.createElement(ne,{eleve:L,paiements:O,classe:g.find(oe=>oe.id===L.classeId),anneeScolaire:g.find(oe=>oe.id===L.classeId)?.anneeScolaire||""}))}R(!1),setTimeout(()=>{ov(K,`Reus ${C}`),setTimeout(()=>{const U=document.getElementById(K);U&&U.remove()},2e3)},200)},children:"Imprimer slection"})]})]})}),r&&o.jsx(ule,{onCancel:()=>n(!1),onSubmit:(O,K,W,X)=>{if(W==="scolarite"&&X==="auto")J(O,K);else{const V="REC"+Date.now().toString().slice(-8),ne={eleveId:O,montant:K,typeFrais:W,datePaiement:new Date().toISOString(),numeroRecu:V,modePaiement:"Espces",createdAt:new Date().toISOString()};W==="scolarite"&&X!=="auto"&&(ne.versementIndex=X),W==="inscription"&&(ne.typeFrais="inscription"),fe.create("paiements",ne)}n(!1),t(V=>V+1)}}),o.jsx("div",{id:"print-area",className:"hidden print:block bg-white p-4 mb-4 print-compact",children:o.jsx(Bf,{type:"recu",libelle:"Relev des paiements"})})]})}function mle(){const[e,t]=j.useState([]),[r,n]=j.useState(!1),[a,i]=j.useState({date:new Date().toISOString().slice(0,10),type:"Entree",category:"",amount:0,note:""}),[s,c]=j.useState("all"),[f,d]=j.useState(""),[h,m]=j.useState(""),[x,g]=j.useState(""),[y,v]=j.useState("");j.useEffect(()=>{const L=new Date;if(s==="all")m(""),g("");else if(s==="today"){const U=L.toISOString().slice(0,10);m(U),g(U)}else if(s==="month"){const U=new Date(L.getFullYear(),L.getMonth(),1).toISOString().slice(0,10),H=new Date(L.getFullYear(),L.getMonth()+1,0).toISOString().slice(0,10);m(U),g(H)}else if(s==="year"){const U=new Date(L.getFullYear(),0,1).toISOString().slice(0,10),H=new Date(L.getFullYear(),11,31).toISOString().slice(0,10);m(U),g(H)}},[s]);const[b,N]=j.useState(1),[E,S]=j.useState(20),[C,T]=j.useState("date"),[k,P]=j.useState("desc"),[D,R]=j.useState(null),[q,M]=j.useState(!1),[z,ie]=j.useState([]),ce=()=>t(fe.getAll("compta")||[]);j.useEffect(()=>{ce();const L=()=>{ce(),n(U=>!U)};return window.addEventListener("dataChanged",L),()=>window.removeEventListener("dataChanged",L)},[]);const ae=()=>i({date:new Date().toISOString().slice(0,10),type:"Entree",category:"",amount:0,note:""}),me=()=>{try{const L={date:a.date||new Date().toISOString(),type:a.type||"Entree",category:a.category||"Gnral",amount:Number(a.amount)||0,note:a.note||"",createdAt:new Date().toISOString()};fe.create("compta",L),ae(),ce()}catch(L){console.error(L),alert("Erreur en crant l'criture")}},de=L=>{if(confirm("Supprimer cette criture ?"))try{fe.delete("compta",L),ce()}catch(U){console.error(U),alert("Erreur lors de la suppression")}},he=j.useMemo(()=>{const U=(fe.getAll("paiements")||[]).filter(H=>!H.canceled).reduce((H,oe)=>{const F=oe.datePaiement||oe.date||oe.createdAt||new Date().toISOString();let Ae="";try{Ae=new Date(F).toISOString().slice(0,10)}catch{Ae=""}const je=Number(oe.montant||0);return e.some(Ue=>{if(Ue.type!=="Entree")return!1;let Pe="";try{Pe=new Date(Ue.date).toISOString().slice(0,10)}catch{Pe=""}return Pe&&Ae&&Pe===Ae&&Number(Ue.amount||0)===je})||H.push({id:`pai_${oe.id}`,date:F,type:"Entree",category:oe.numeroRecu?`Paiement ${oe.numeroRecu}`:"Paiement",amount:je,note:oe.notes||""}),H},[]);return[...e,...U]},[e,r]),J=j.useMemo(()=>{const L=he.filter(oe=>!(f&&oe.category!==f||h&&oe.date<h||x&&oe.date>x)),U=L.filter(oe=>oe.type==="Entree").reduce((oe,F)=>oe+Number(F.amount||0),0),H=L.filter(oe=>oe.type==="Sortie").reduce((oe,F)=>oe+Number(F.amount||0),0);return{entrees:U,sorties:H,solde:U-H,count:L.length}},[he,f,h,x]),xe=j.useMemo(()=>{const L=new Date,U=L.toISOString().slice(0,10),H=L.toISOString().slice(0,7),oe=L.getFullYear(),F=Ue=>{try{return new Date(Ue.date).toISOString().slice(0,10)===U}catch{return!1}},Ae=Ue=>{try{return new Date(Ue.date).toISOString().slice(0,7)===H}catch{return!1}},je=Ue=>{try{return new Date(Ue.date).getFullYear()===oe}catch{return!1}},Le=(Ue,Pe)=>Ue.filter(ot=>ot.type===Pe).reduce((ot,kt)=>ot+Number(kt.amount||0),0);return{today:{entrees:Le(he.filter(F),"Entree"),sorties:Le(he.filter(F),"Sortie")},month:{entrees:Le(he.filter(Ae),"Entree"),sorties:Le(he.filter(Ae),"Sortie")},year:{entrees:Le(he.filter(je),"Entree"),sorties:Le(he.filter(je),"Sortie")},countMonth:he.filter(Ae).length}},[he]),te=j.useMemo(()=>{const L=he.filter(F=>F.type==="Entree").reduce((F,Ae)=>F+Number(Ae.amount||0),0),U=he.filter(F=>F.type==="Sortie").reduce((F,Ae)=>F+Number(Ae.amount||0),0);let H=0;try{const F=fe.getAll("eleves"),Ae=fe.getAll("paiements"),je=fe.getAll("classes");H=F.map(Ue=>{try{return sf.getSituationEcheances(Ue.id)}catch{return null}}).filter(Boolean).reduce((Ue,Pe)=>{const ot=Number(Pe.totalRestant||0);return Ue+(ot>0?ot:0)},0)}catch{H=0}const oe=L-U;return{totalRecettes:L,impayes:H,totalSorties:U,solde:oe}},[e,r]),O=j.useMemo(()=>{let L=he.filter(U=>!(f&&U.category!==f||h&&U.date<h||x&&U.date>x||y&&!U.category.toLowerCase().includes(y.toLowerCase())&&!U.note?.toLowerCase().includes(y.toLowerCase())));return L=L.sort((U,H)=>{let oe,F;switch(C){case"date":oe=new Date(U.date).getTime(),F=new Date(H.date).getTime();break;case"category":oe=U.category.toLowerCase(),F=H.category.toLowerCase();break;case"amount":oe=U.amount,F=H.amount;break;default:oe=U.date,F=H.date}return k==="asc"?oe<F?-1:oe>F?1:0:oe>F?-1:oe<F?1:0}),L},[he,f,h,x,y,C,k]),K=Math.max(1,Math.ceil(O.length/E)),W=O.slice((b-1)*E,(b-1)*E+E),X=L=>{const U=e.find(H=>H.id===L)||null;R(U),M(!0)},V=L=>{if(D)try{fe.update("compta",D.id,{...D,...L}),M(!1),R(null)}catch(U){console.error(U),alert("Erreur lors de la mise  jour")}},ne=()=>{if(O.length===0){alert("Aucune criture  imprimer avec les filtres actuels");return}const L=O.filter(je=>je.type==="Entree").reduce((je,Le)=>je+Number(Le.amount||0),0),U=O.filter(je=>je.type==="Sortie").reduce((je,Le)=>je+Number(Le.amount||0),0),H=O.map(je=>`
      <tr>
        <td style="border: 1px solid #333; padding: 8px; text-align: left; background-color: #f9f9f9;">${new Date(je.date).toLocaleDateString("fr-FR")}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: left; background-color: #f9f9f9;">${je.category}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; background-color: #e6ffe6;">${je.type==="Entree"?Number(je.amount).toLocaleString("fr-FR"):""}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; background-color: #ffe6e6;">${je.type==="Sortie"?Number(je.amount).toLocaleString("fr-FR"):""}</td>
      </tr>
    `).join(`
`),oe=`
      <tr style="font-weight: bold; background-color: #ddd;">
        <td colspan="2" style="border: 1px solid #333; padding: 8px; text-align: center; font-weight: bold;">TOTAUX</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; font-weight: bold; background-color: #e6ffe6;">${L.toLocaleString("fr-FR")}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; font-weight: bold; background-color: #ffe6e6;">${U.toLocaleString("fr-FR")}</td>
      </tr>
    `,F=`
      <html>
        <head>
          <title>Journal Comptable</title>
          <style>
            body {
              font-family: 'Times New Roman', Times, serif;
              font-size: 12px;
              color: #000;
              padding: 15mm;
              line-height: 1.4;
            }
            h2 {
              text-align: center;
              margin-bottom: 30px;
              font-size: 18px;
              font-weight: bold;
              text-decoration: underline;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              margin-bottom: 20px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            th {
              border: 2px solid #333;
              padding: 10px;
              text-align: center;
              background-color: #4a5568;
              color: white;
              font-weight: bold;
              font-size: 13px;
            }
            td {
              border: 1px solid #333;
              padding: 8px;
            }
            .signature {
              text-align: right;
              margin-top: 50px;
              font-weight: bold;
              font-size: 14px;
            }
            @media print {
              body { margin: 0; }
              .signature { page-break-inside: avoid; }
            }
          </style>
        </head>
        <body>
          <h2>Journal Comptable</h2>
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Libell</th>
                <th>Dbit</th>
                <th>Crdit</th>
              </tr>
            </thead>
            <tbody>
              ${H}
              ${oe}
            </tbody>
          </table>
          <div class="signature">Signature</div>
        </body>
      </html>
    `,Ae=window.open("","_blank","width=800,height=600");if(!Ae){alert("Impossible d'ouvrir la fentre d'impression");return}Ae.document.open(),Ae.document.write(F),Ae.document.close(),Ae.focus(),setTimeout(()=>{Ae.print(),Ae.onafterprint=()=>Ae.close()},500)};return o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-extrabold",children:"Comptabilit"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Journal des entres et sorties  aperu rapide"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Total Recettes"}),o.jsxs("div",{className:"text-2xl font-extrabold text-gray-900",children:[te.totalRecettes.toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Impays"}),o.jsxs("div",{className:"text-2xl font-extrabold text-red-600",children:[te.impayes.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-xs text-gray-400",children:"Reste  encaisser"})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Sorties"}),o.jsxs("div",{className:"text-2xl font-extrabold text-red-600",children:[te.totalSorties.toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Solde"}),o.jsxs("div",{className:"text-2xl font-extrabold text-indigo-700",children:[te.solde.toLocaleString("fr-FR")," FCFA"]})]})]})]}),o.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-green-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-green-100 rounded-md",children:o.jsx(D0,{className:"text-green-700",size:20})}),o.jsx("div",{children:o.jsx("div",{className:"text-xs text-gray-500",children:"Aujourd'hui"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm font-bold",children:[o.jsx("div",{className:"text-green-700",children:"Entres"}),o.jsxs("div",{className:"text-right text-green-700",children:[xe.today.entrees.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-red-600",children:"Sorties"}),o.jsxs("div",{className:"text-right text-red-600",children:[xe.today.sorties.toLocaleString("fr-FR")," FCFA"]})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-blue-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-blue-100 rounded-md",children:o.jsx(Ih,{className:"text-blue-600",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500",children:"Ce mois"}),o.jsxs("div",{className:"text-xs text-gray-400",children:[xe.countMonth," critures"]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm font-bold",children:[o.jsx("div",{className:"text-green-700",children:"Entres"}),o.jsxs("div",{className:"text-right text-green-700",children:[xe.month.entrees.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-red-600",children:"Sorties"}),o.jsxs("div",{className:"text-right text-red-600",children:[xe.month.sorties.toLocaleString("fr-FR")," FCFA"]})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-indigo-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-indigo-100 rounded-md",children:o.jsx(b5,{className:"text-indigo-700",size:20})}),o.jsx("div",{children:o.jsx("div",{className:"text-xs text-gray-500",children:"Cette anne"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm font-bold",children:[o.jsx("div",{className:"text-green-700",children:"Entres"}),o.jsxs("div",{className:"text-right text-green-700",children:[xe.year.entrees.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-red-600",children:"Sorties"}),o.jsxs("div",{className:"text-right text-red-600",children:[xe.year.sorties.toLocaleString("fr-FR")," FCFA"]})]})]})]}),o.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[o.jsx("div",{className:"text-sm text-gray-600",children:(()=>{let L="Filtre actif : Aucun";return s==="today"?L="Filtre actif : Aujourd'hui":s==="month"?L="Filtre actif : Ce mois":s==="year"?L="Filtre actif : Cette anne":s==="custom"&&(L=`Filtre actif : ${h||"..."}  ${x||"..."}`),o.jsx("span",{className:"text-sm text-gray-500",children:L})})()}),o.jsxs("div",{className:"flex items-center space-x-3 text-sm text-gray-600",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"inline-block w-3 h-3 bg-green-600 rounded-full"})," ",o.jsx("span",{children:"Entres"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"inline-block w-3 h-3 bg-red-600 rounded-full"})," ",o.jsx("span",{children:"Sorties"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Bs,{className:"text-gray-400",size:14}),o.jsx("span",{className:"text-xs",children:"Montants en FCFA"})]})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Priode"}),o.jsxs("select",{value:s,onChange:L=>c(L.target.value),className:"p-2 border rounded",children:[o.jsx("option",{value:"all",children:"Toutes"}),o.jsx("option",{value:"today",children:"Aujourd'hui"}),o.jsx("option",{value:"month",children:"Ce mois"}),o.jsx("option",{value:"year",children:"Cette anne"}),o.jsx("option",{value:"custom",children:"Personnalise"})]}),s==="custom"&&o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"date",value:h,onChange:L=>m(L.target.value),className:"p-2 border rounded"}),o.jsx("input",{type:"date",value:x,onChange:L=>g(L.target.value),className:"p-2 border rounded"})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Catgorie"}),o.jsx("input",{placeholder:"Catgorie",value:f,onChange:L=>d(L.target.value),className:"p-2 border rounded"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Rechercher"}),o.jsx("input",{placeholder:"Catgorie ou note",value:y,onChange:L=>v(L.target.value),className:"p-2 border rounded"})]}),o.jsx("button",{onClick:()=>{m(""),g(""),d(""),v(""),c("all"),N(1)},className:"ml-2 px-2 py-1 bg-gray-100 border rounded text-sm",children:"Effacer tous les filtres"})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs("button",{onClick:ne,className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm shadow hover:bg-indigo-700 flex items-center space-x-2",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"inline-block",children:[o.jsx("path",{d:"M6 9V2h12v7",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("rect",{x:"6",y:"13",width:"12",height:"9",rx:"1",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("span",{children:"Imprimer"})]})})]}),o.jsxs("div",{className:"bg-white p-4 rounded shadow mb-6",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("h3",{className:"text-sm font-semibold mb-4",children:"Analyse des Finances"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Rpartition Gnrale"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(Mu,{children:o.jsxs(T0,{children:[o.jsxs(Lu,{data:[{name:"Entres",value:J.entrees,color:"#10b981"},{name:"Sorties",value:J.sorties,color:"#ef4444"}],cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:5,dataKey:"value",children:[o.jsx(zi,{fill:"#10b981"}),o.jsx(zi,{fill:"#ef4444"})]}),o.jsx(Du,{formatter:L=>`${Number(L).toLocaleString("fr-FR")} FCFA`}),o.jsx(Jh,{})]})})})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Entres par Catgorie"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(Mu,{children:o.jsxs(T0,{children:[o.jsx(Lu,{data:(()=>{const L={};he.filter(H=>H.type==="Entree").forEach(H=>{const oe=H.category||"Autre";L[oe]=(L[oe]||0)+Number(H.amount||0)});const U=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16"];return Object.keys(L).map((H,oe)=>({name:H.length>15?H.substring(0,15)+"...":H,value:L[H],color:U[oe%U.length]}))})(),cx:"50%",cy:"50%",innerRadius:30,outerRadius:80,paddingAngle:2,dataKey:"value",children:(()=>{const L={};he.filter(H=>H.type==="Entree").forEach(H=>{const oe=H.category||"Autre";L[oe]=(L[oe]||0)+Number(H.amount||0)});const U=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16"];return Object.keys(L).map((H,oe)=>o.jsx(zi,{fill:U[oe%U.length]},`cell-${oe}`))})()}),o.jsx(Du,{formatter:L=>`${Number(L).toLocaleString("fr-FR")} FCFA`})]})})})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Sorties par Catgorie"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(Mu,{children:o.jsxs(T0,{children:[o.jsx(Lu,{data:(()=>{const L={};he.filter(H=>H.type==="Sortie").forEach(H=>{const oe=H.category||"Autre";L[oe]=(L[oe]||0)+Number(H.amount||0)});const U=["#ef4444","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#3b82f6","#10b981"];return Object.keys(L).map((H,oe)=>({name:H.length>15?H.substring(0,15)+"...":H,value:L[H],color:U[oe%U.length]}))})(),cx:"50%",cy:"50%",innerRadius:30,outerRadius:80,paddingAngle:2,dataKey:"value",children:(()=>{const L={};he.filter(H=>H.type==="Sortie").forEach(H=>{const oe=H.category||"Autre";L[oe]=(L[oe]||0)+Number(H.amount||0)});const U=["#ef4444","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#3b82f6","#10b981"];return Object.keys(L).map((H,oe)=>o.jsx(zi,{fill:U[oe%U.length]},`cell-${oe}`))})()}),o.jsx(Du,{formatter:L=>`${Number(L).toLocaleString("fr-FR")} FCFA`})]})})})]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:J.entrees.toLocaleString("fr-FR")}),o.jsx("div",{className:"text-xs text-gray-500",children:"Total Entres (FCFA)"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-red-600",children:J.sorties.toLocaleString("fr-FR")}),o.jsx("div",{className:"text-xs text-gray-500",children:"Total Sorties (FCFA)"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:`text-2xl font-bold ${J.solde>=0?"text-green-600":"text-red-600"}`,children:J.solde.toLocaleString("fr-FR")}),o.jsx("div",{className:"text-xs text-gray-500",children:"Solde (FCFA)"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:J.count}),o.jsx("div",{className:"text-xs text-gray-500",children:"Nombre d'critures"})]})]}),O.length===0&&o.jsx("div",{className:"p-6 text-center text-sm text-gray-500",children:"Aucune criture pour la priode slectionne  ajoutez une criture ou changez les filtres."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Date"}),o.jsx("input",{type:"date",value:a.date?.slice(0,10),onChange:L=>i(U=>({...U,date:L.target.value})),className:"mt-1 p-2 border rounded w-full"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Type"}),o.jsxs("select",{value:a.type,onChange:L=>i(U=>({...U,type:L.target.value})),className:"mt-1 p-2 border rounded w-full",children:[o.jsx("option",{value:"Entree",children:"Entre"}),o.jsx("option",{value:"Sortie",children:"Sortie"})]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Catgorie"}),o.jsx("input",{value:a.category,onChange:L=>i(U=>({...U,category:L.target.value})),className:"mt-1 p-2 border rounded w-full"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Montant"}),o.jsx("input",{type:"number",value:a.amount,onChange:L=>i(U=>({...U,amount:Number(L.target.value)})),className:"mt-1 p-2 border rounded w-full"})]}),o.jsxs("div",{className:"md:col-span-6 flex space-x-2",children:[o.jsx("input",{placeholder:"Note (optionnel)",value:a.note,onChange:L=>i(U=>({...U,note:L.target.value})),className:"mt-1 p-2 border rounded w-full"}),o.jsx("button",{onClick:me,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Ajouter"})]})]})]}),o.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[O.length===0?o.jsx("div",{className:"text-center p-8",children:o.jsx("p",{className:"text-gray-500",children:"Aucune criture"})}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>{T("date"),P(C==="date"&&k==="desc"?"asc":"desc")},children:["Date ",C==="date"&&(k==="desc"?"":"")]}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700",children:"Type"}),o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>{T("category"),P(C==="category"&&k==="desc"?"asc":"desc")},children:["Catgorie ",C==="category"&&(k==="desc"?"":"")]}),o.jsxs("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>{T("amount"),P(C==="amount"&&k==="desc"?"asc":"desc")},children:["Montant ",C==="amount"&&(k==="desc"?"":"")]}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700",children:"Note"}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W.map(L=>o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:new Date(L.date).toLocaleDateString("fr-FR")}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:L.type}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:L.category?o.jsx("span",{className:`inline-block px-2 py-0.5 text-xs font-medium rounded ${String(L.category).toLowerCase().includes("inscription")?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:L.category}):o.jsx("span",{className:"text-gray-400",children:""})}),o.jsx("td",{className:"px-4 py-3 text-sm text-right font-bold",children:o.jsxs("span",{className:L.type==="Entree"?"text-green-700":"text-red-600",children:[L.type==="Entree"?"+":"-",Number(L.amount).toLocaleString("fr-FR")," FCFA"]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:L.note||""}),o.jsx("td",{className:"px-4 py-3 text-sm text-center space-x-1",children:String(L.id||"").startsWith("pai_")?o.jsxs(o.Fragment,{children:[o.jsx("button",{disabled:!0,title:"Cette ligne provient d'un paiement; modifiez-le depuis l'cran Paiements",className:"px-2 py-1 bg-yellow-300 text-white rounded text-xs opacity-60 cursor-not-allowed",children:"diter"}),o.jsx("button",{disabled:!0,title:"Cette ligne provient d'un paiement; suppression non autorise depuis la comptabilit",className:"px-2 py-1 bg-red-300 text-white rounded text-xs opacity-60 cursor-not-allowed",children:"Supprimer"})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>X(L.id),className:"px-2 py-1 bg-yellow-500 text-white rounded text-xs hover:brightness-95",children:"diter"}),o.jsx("button",{onClick:()=>de(L.id),className:"px-2 py-1 bg-red-600 text-white rounded text-xs hover:brightness-95",children:"Supprimer"})]})})]},L.id))})]})}),o.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",b," / ",K,"  ",O.length," rsultats"]}),o.jsxs("div",{className:"space-x-2",children:[o.jsx("button",{disabled:b<=1,onClick:()=>N(L=>Math.max(1,L-1)),className:"px-2 py-1 border rounded",children:"Prc"}),o.jsx("button",{disabled:b>=K,onClick:()=>N(L=>Math.min(K,L+1)),className:"px-2 py-1 border rounded",children:"Suiv"}),o.jsxs("select",{value:E,onChange:L=>{S(Number(L.target.value)),N(1)},className:"border p-1 rounded",children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:20,children:"20"}),o.jsx("option",{value:50,children:"50"})]})]})]}),q&&D&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded shadow p-4 w-full max-w-md",children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"diter criture"}),o.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[o.jsx("label",{className:"text-xs",children:"Date"}),o.jsx("input",{type:"date",value:D.date?.slice(0,10),onChange:L=>R(U=>U&&{...U,date:L.target.value}),className:"p-2 border rounded"}),o.jsx("label",{className:"text-xs",children:"Type"}),o.jsxs("select",{value:D.type,onChange:L=>R(U=>U&&{...U,type:L.target.value}),className:"p-2 border rounded",children:[o.jsx("option",{value:"Entree",children:"Entre"}),o.jsx("option",{value:"Sortie",children:"Sortie"})]}),o.jsx("label",{className:"text-xs",children:"Catgorie"}),o.jsx("input",{value:D.category,onChange:L=>R(U=>U&&{...U,category:L.target.value}),className:"p-2 border rounded"}),o.jsx("label",{className:"text-xs",children:"Montant"}),o.jsx("input",{type:"number",value:String(D.amount||0),onChange:L=>R(U=>U&&{...U,amount:Number(L.target.value)}),className:"p-2 border rounded"}),o.jsx("label",{className:"text-xs",children:"Note"}),o.jsx("input",{value:D.note||"",onChange:L=>R(U=>U&&{...U,note:L.target.value}),className:"p-2 border rounded"})]}),o.jsxs("div",{className:"mt-3 flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>{M(!1),R(null)},className:"px-3 py-1 border rounded",children:"Annuler"}),o.jsx("button",{onClick:()=>V(D),className:"px-3 py-1 bg-green-600 text-white rounded",children:"Enregistrer"})]})]})}),o.jsx("div",{id:"print-area",style:{position:"absolute",left:"-9999px",top:"0",width:"0",height:"0",overflow:"hidden"}})]})]})}const Hl=[{title:"Bienvenue sur KlasNet !",description:`Bienvenue dans votre application de gestion scolaire KlasNet. Ce guide va vous accompagner pas  pas pour dcouvrir chaque fonctionnalit. Prenez le temps de lire chaque tape, puis cliquez sur 'Suivant'.

Note : Vous pouvez relancer ce guide  tout moment en cliquant sur le bouton 'Guide' en haut  droite.`,icon:o.jsx(w5,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Tableau de bord",description:`Le tableau de bord est la page d'accueil. Il affiche en temps rel :
- Le nombre total d'lves et d'lves actifs
- Les recettes totales et celles du mois
- Les paiements complts et en attente
- Des graphiques pour visualiser l'volution des finances

En bas, retrouvez les 'Actions Rapides' pour accder directement aux fonctions principales.

Exemple : Cliquez sur 'Nouvel lve' pour inscrire un nouvel lve en un seul clic.`,icon:o.jsx(D0,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Gestion des lves",description:`Dans le menu 'lves', vous pouvez :
- Voir la liste de tous les lves
- Ajouter un nouvel lve (bouton 'Nouvel lve')
- Modifier ou supprimer un lve existant

Note : Utilisez la barre de recherche pour retrouver rapidement un lve par nom, prnom ou matricule.

Exemple : Pour inscrire un nouvel lve, cliquez sur 'Nouvel lve', remplissez le formulaire puis validez.`,icon:o.jsx(zs,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Finances et paiements",description:`Dans la section 'Finances', vous pouvez :
- Enregistrer un paiement pour un lve
- Consulter l'historique des paiements
- Voir la situation financire de chaque lve (solde, montant d, etc.)

Exemple : Pour enregistrer un paiement, cliquez sur 'Nouveau Paiement', slectionnez l'lve concern et saisissez le montant.`,icon:o.jsx(Bs,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Saisie des notes",description:`Dans la section 'Notes', vous pouvez :
- Saisir les notes des lves pour chaque matire et priode
- Consulter les moyennes et les rsultats

Note : Saisissez rgulirement les notes pour suivre la progression des lves et gnrer les bulletins facilement.`,icon:o.jsx(qi,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Configuration",description:`Dans 'Configuration', personnalisez votre application :
- Dfinissez l'anne scolaire active
- Ajoutez ou modifiez les frais scolaires
- Grez les compositions et les paramtres de l'cole

Exemple : Pour changer d'anne scolaire, saisissez la nouvelle anne puis cliquez sur 'Changer'.

Note : Vrifiez toujours que l'anne scolaire active est correcte avant de saisir de nouvelles donnes.`,icon:o.jsx(F0,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Recherche rapide",description:`La barre de recherche (en haut de chaque page) vous permet de retrouver rapidement :
- Un lve
- Une classe
- Un enseignant
- Une opration financire

Tapez simplement un mot-cl (nom, prnom, etc.) et les rsultats s'affichent instantanment.`,icon:o.jsx(wc,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Historique et alertes",description:`KlasNet vous informe en temps rel :
- Alertes sur les paiements en retard
- Notifications pour les actions  effectuer (ex : lves sans notes)
- Historique des modifications (ajout, suppression, paiement, etc.)

Note : Consultez rgulirement l'historique pour suivre l'activit de l'cole et anticiper les besoins.`,icon:o.jsx(wi,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Import/Export Excel",description:`Gagnez du temps grce  l'importation et l'exportation des listes d'lves au format Excel.

- Importez facilement une liste d'lves depuis un fichier Excel.
- Prvisualisez les donnes avant de valider l'importation.
- Slectionnez la classe d'affectation et vrifiez les colonnes importantes (Matricule, Nom, Prnoms).
- Exportez la liste actuelle pour la partager ou l'archiver.

Note : Vrifiez toujours l'aperu avant de valider pour viter les erreurs de saisie.`,icon:o.jsx(Us,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Prt  commencer",description:`Vous tes prt  utiliser KlasNet.

N'hsitez pas  explorer chaque menu,  utiliser la recherche et  consulter ce guide en cas de besoin.

Bonne gestion avec KlasNet.`,icon:o.jsx(ua,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})}];function ple({onClose:e}){const[t,r]=j.useState(0);j.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]);const n=a=>{r(a)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 max-w-lg w-full mx-4 relative",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Guide d'utilisation"}),o.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-lg transition-colors",onClick:e,children:o.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{className:"flex items-center mt-4 space-x-1",children:Hl.map((a,i)=>o.jsx("button",{className:`flex-1 h-2 rounded-full transition-all duration-300 ${i<=t?"bg-gray-900":"bg-gray-200"}`,onClick:()=>n(i),"aria-label":`Aller  l'tape ${i+1}`},i))})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"text-center mb-6",children:[Hl[t].icon,o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:Hl[t].title})]}),o.jsx("div",{className:"text-gray-700 text-sm leading-relaxed whitespace-pre-line mb-8 min-h-[120px]",children:Hl[t].description})]}),o.jsx("div",{className:"p-6 border-t border-gray-200",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",onClick:()=>r(a=>Math.max(0,a-1)),disabled:t===0,children:[o.jsx(s4,{className:"h-4 w-4"}),o.jsx("span",{children:"Prcdent"})]}),o.jsxs("span",{className:"text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:[t+1," / ",Hl.length]}),t<Hl.length-1?o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",onClick:()=>r(a=>a+1),children:[o.jsx("span",{children:"Suivant"}),o.jsx(m5,{className:"h-4 w-4"})]}):o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",onClick:e,children:[o.jsx(ua,{className:"h-4 w-4"}),o.jsx("span",{children:"Terminer"})]})]})})]})})}function xle({user:e}){const[t,r]=j.useState(e?.avatar||null),[n,a]=j.useState(!1),[i,s]=j.useState(!1),[c,f]=j.useState(e?.prenoms||""),[d,h]=j.useState(e?.nom||""),[m,x]=j.useState(e?.role||""),{showToast:g}=Jr(),[y,v]=j.useState(null),[b,N]=j.useState({});if(!e)return o.jsx("div",{className:"p-6",children:"Aucun utilisateur connect."});const E=async T=>{const k=T.target.files?.[0];if(!k)return;const P=new FileReader;P.onload=()=>r(String(P.result)),P.readAsDataURL(k),v(k.name)},S=async()=>{if(!(!e?.id||!t)){a(!0);try{fe.update("utilisateurs",e.id,{avatar:t});try{g("Avatar enregistr","success")}catch{}}finally{a(!1)}}},C=async()=>{if(!e?.id)return;const T={};if((!c||c.trim().length===0)&&(T.prenom="Prnoms requis."),(!d||d.trim().length===0)&&(T.nom="Nom requis."),N(T),!(Object.keys(T).length>0)){a(!0);try{fe.update("utilisateurs",e.id,{prenoms:c,nom:d,role:m});try{g("Profil mis  jour","success")}catch{}}finally{a(!1),s(!1)}}};return o.jsxs("div",{className:"p-6 max-w-2xl mx-auto bg-white rounded-lg shadow",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Profil utilisateur"}),o.jsxs("div",{className:"flex items-start space-x-6",children:[o.jsxs("div",{className:"w-36",children:[o.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-100 overflow-hidden shadow",children:t?o.jsx("img",{src:t,alt:"avatar",className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:"A"})}),o.jsxs("div",{className:"mt-2 flex flex-col space-y-2",children:[o.jsxs("label",{className:"inline-flex items-center px-3 py-2 bg-white border rounded cursor-pointer text-sm",children:[o.jsx("input",{type:"file",accept:"image/*",onChange:E,className:"hidden"}),"Choisir un fichier"]}),y&&o.jsx("div",{className:"text-xs text-gray-500",children:y}),t&&o.jsx("div",{children:o.jsx("button",{onClick:S,disabled:n,className:"px-3 py-1 bg-teal-600 text-white rounded",children:n?"Enregistrement...":"Enregistrer avatar"})})]})]}),o.jsx("div",{className:"flex-1",children:o.jsx("div",{className:"space-y-2",children:i?o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Prnoms"}),o.jsx("input",{value:c,onChange:T=>f(T.target.value),className:"mt-1 block w-full border rounded px-2 py-1"}),b.prenom&&o.jsx("div",{className:"text-xs text-red-600 mt-1",children:b.prenom})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nom"}),o.jsx("input",{value:d,onChange:T=>h(T.target.value),className:"mt-1 block w-full border rounded px-2 py-1"}),b.nom&&o.jsx("div",{className:"text-xs text-red-600 mt-1",children:b.nom})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Rle"}),o.jsxs("select",{value:m,onChange:T=>x(T.target.value),className:"mt-1 block w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"Secrtaire",children:"Secrtaire"}),o.jsx("option",{value:"Enseignant",children:"Enseignant"}),o.jsx("option",{value:"Admin",children:"Admin"})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:C,disabled:n,className:"px-3 py-1 bg-teal-600 text-white rounded",children:n?"Enregistrement...":"Enregistrer"}),o.jsx("button",{onClick:()=>{s(!1),N({})},className:"px-3 py-1 border rounded",children:"Annuler"})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Nom"}),o.jsx("div",{className:"font-semibold",children:Bt(e)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Rle"}),o.jsx("div",{className:"text-sm",children:e.role})]}),o.jsx("div",{className:"mt-3",children:o.jsx("button",{onClick:()=>s(!0),className:"px-3 py-1 bg-slate-600 text-white rounded",children:"Modifier le profil"})})]})})})]})]})}function gle(){const e=Is.getCurrentUser(),[t,r]=j.useState(""),[n,a]=j.useState(""),[i,s]=j.useState(""),[c,f]=j.useState(null),[d,h]=j.useState(""),[m,x]=j.useState(""),[g,y]=j.useState(!1),[v,b]=j.useState(!1),N=E=>{if(E.preventDefault(),!e)return f("Aucun utilisateur connect.");if(!n||n!==i)return f("Les nouveaux mots de passe ne correspondent pas.");const S=Is.changePassword(e.nomUtilisateur,n,t||void 0);f(S?"Mot de passe mis  jour.":"chec : l'ancien mot de passe est incorrect ou une erreur est survenue."),S&&(r(""),a(""),s(""))};return o.jsxs("div",{className:"p-6 max-w-2xl mx-auto bg-white rounded-lg shadow",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Paramtres du compte"}),o.jsxs("form",{onSubmit:N,className:"space-y-4 text-sm text-gray-700",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nom d'utilisateur"}),o.jsx("div",{className:"font-semibold",children:e?.nomUtilisateur||""})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Ancien mot de passe"}),o.jsx("input",{type:"password",value:t,onChange:E=>r(E.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nouveau mot de passe"}),o.jsx("input",{type:"password",value:n,onChange:E=>a(E.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Confirmer nouveau mot de passe"}),o.jsx("input",{type:"password",value:i,onChange:E=>s(E.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsx("div",{children:o.jsx("button",{type:"submit",className:"px-3 py-1 bg-teal-600 text-white rounded",children:"Enregistrer"})}),c&&o.jsx("div",{className:"text-sm text-gray-600",children:c})]}),o.jsxs("div",{className:"mt-6 p-4 border-t pt-4",children:[o.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Changer le nom d'utilisateur"}),o.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nouveau nom d'utilisateur"}),o.jsx("input",{value:d,onChange:E=>h(E.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Mot de passe (vrification)"}),o.jsx("input",{type:"password",value:m,onChange:E=>x(E.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsx("div",{children:o.jsx("button",{onClick:()=>{if(f(null),!e)return f("Aucun utilisateur connect.");if(!d)return f("Entrez un nouveau nom d'utilisateur.");if(!/^[a-z0-9_.-]{3,30}$/i.test(d))return f("Nom utilisateur invalide  utilisez 3  30 caractres (lettres, chiffres, _, . ou -).");y(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded",children:"Renommer le compte"})})]})]}),g&&o.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center",children:o.jsxs("div",{className:"bg-white p-6 rounded shadow max-w-md w-full",children:[o.jsx("h4",{className:"font-semibold mb-3",children:"Confirmer le renommage"}),o.jsxs("p",{className:"text-sm text-gray-700 mb-4",children:["Vous allez changer le nom d'utilisateur de ",o.jsx("strong",{children:e?.nomUtilisateur})," en ",o.jsx("strong",{children:d}),". Continuer ?"]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>y(!1),className:"px-3 py-1 border rounded",children:"Annuler"}),o.jsx("button",{disabled:v,onClick:async()=>{if(f(null),!e)return f("Aucun utilisateur connect.");b(!0);try{if(Is.changeUsername(e.nomUtilisateur,d,m||void 0)){f("Nom d'utilisateur mis  jour. L'application va se recharger."),y(!1);try{Is.logout()}catch{}setTimeout(()=>{window.location.reload()},400)}else f("chec : nom existant ou mot de passe incorrect."),y(!1)}finally{b(!1)}},className:"px-3 py-1 bg-red-600 text-white rounded",children:"Confirmer"})]})]})})]})}function vle(){if(fe.getAll("matieres").length>0)return;const e=new Date().toISOString(),t=new Date().getFullYear()+"-"+(new Date().getFullYear()+1),r=[{nom:"Mathmatiques",abreviation:"MATH",coefficient:4,type:"Fondamentale",baremeParNiveau:{CE1:{min:0,max:50},CE2:{min:0,max:50},CM1:{min:0,max:50},CM2:{min:0,max:50},CP1:{min:0,max:20},CP2:{min:0,max:20}}},{nom:"veil au Milieu",abreviation:"AEM",coefficient:4,type:"veil",baremeParNiveau:{CE1:{min:0,max:50},CE2:{min:0,max:50},CM1:{min:0,max:50},CM2:{min:0,max:50},CP1:{min:0,max:20},CP2:{min:0,max:20}}},{nom:"Exploitation de Texte",abreviation:"EXP TEXTE",coefficient:4,type:"Fondamentale",baremeParNiveau:{CE1:{min:0,max:50},CE2:{min:0,max:50},CM1:{min:0,max:50},CM2:{min:0,max:50},CP1:{min:0,max:20},CP2:{min:0,max:20}}},{nom:"Orthographe",abreviation:"ORTH",coefficient:2,type:"Fondamentale",baremeParNiveau:{CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20},CP1:{min:0,max:20},CP2:{min:0,max:20}}}],n=[{nom:"veil Scientifique",abreviation:"SCIENCES",coefficient:2,type:"veil",baremeParNiveau:{CP1:{min:0,max:20},CP2:{min:0,max:20},CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20}}}],a=[{nom:"ducation Artistique",abreviation:"ARTS",coefficient:1,type:"Expression",baremeParNiveau:{CP1:{min:0,max:20},CP2:{min:0,max:20},CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20}}},{nom:"ducation Physique",abreviation:"EPS",coefficient:1,type:"Expression",baremeParNiveau:{CP1:{min:0,max:20},CP2:{min:0,max:20},CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20}}}],i=[...r,...n,...a],s=[];i.forEach(m=>{const x=fe.create("matieres",{...m,obligatoire:m.type==="Fondamentale",classeIds:[],createdAt:e,updatedAt:e});s.push(x)}),[{nom:"1re Composition",coefficient:1,ordre:1},{nom:"2me Composition",coefficient:1,ordre:2},{nom:"3me Composition",coefficient:1,ordre:3},{nom:"Composition de fin d'anne",coefficient:2,ordre:4}].forEach(m=>{fe.create("compositions",m)}),["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"].forEach(m=>{["A","B"].forEach(x=>{if(["Petite Section","Moyenne Section","Grande Section"].includes(m)&&x==="B")return;const g=fe.create("classes",{niveau:m,section:x,anneeScolaire:t,enseignantPrincipal:"",effectifMax:35,salle:`Salle ${m} ${x}`,matieres:s.filter(y=>m.includes("Section")?["Fondamentale","Expression"].includes(y.type):!0)});s.forEach(y=>{g.matieres.some(v=>v.id===y.id)&&fe.update("matieres",y.id,{classeIds:[...y.classeIds||[],g.id]})})})}),[{nom:"KOUASSI",prenoms:"Marie",sexe:"F",telephone:"+225 07 XX XX XX XX",adresse:"Abidjan, Cocody",specialite:"Institutrice",diplome:"CEAP",dateEmbauche:"2020-09-01",statut:"Actif",salaire:15e4,photo:"",classesPrincipales:[],matieresEnseignees:[]},{nom:"TRAORE",prenoms:"Amadou",sexe:"M",telephone:"+225 05 XX XX XX XX",adresse:"Abidjan, Yopougon",specialite:"Professeur des coles",diplome:"Licence Pdagogie",dateEmbauche:"2019-09-01",statut:"Actif",salaire:18e4,photo:"",classesPrincipales:[],matieresEnseignees:[]}].forEach(m=>{fe.create("enseignants",m)});const h=fe.getAll("ecole")[0];if(h){const m=fe.getAll("compositions");fe.update("ecole",h.id,{compositions:m})}console.log("Donnes par dfaut initialises avec succs")}function yle(){const[e,t]=j.useState(()=>Is.getCurrentUser()),[r,n]=j.useState("dashboard"),[a,i]=j.useState(null),[s,c]=j.useState(!1),[f,d]=j.useState(!1);on.useEffect(()=>{if(e)try{vle(),oP()}catch(D){console.error("Erreur lors de l'initialisation des donnes par dfaut:",D)}},[e]),on.useEffect(()=>{const D=()=>{try{b1()}catch{}};return window.addEventListener("beforeunload",D),()=>window.removeEventListener("beforeunload",D)},[]),on.useEffect(()=>{const D=R=>{try{const q=window;if(q&&q.__discardModalOpen){try{console.debug("[App] navigate ignored because discard modal open")}catch{}return}let M=!1;if(q.__unsavedGuards&&typeof q.__unsavedGuards.forEach=="function"&&q.__unsavedGuards.forEach(ce=>{try{ce()&&(M=!0)}catch{}}),M){if(R&&typeof R.stopImmediatePropagation=="function")try{R.stopImmediatePropagation()}catch{}q.__autosaveHandlers&&typeof q.__autosaveHandlers.forEach=="function"&&q.__autosaveHandlers.forEach(ce=>{try{ce()}catch{}}),q.__pendingNavigation=R.detail,E(R.detail),b(!0);return}const{page:z,action:ie}=R.detail||{};z&&(n(z),ie==="new"?(i(null),c(!0)):(c(!1),i(null)))}catch(q){console.debug("navigate guard check failed",q)}};return window.addEventListener("navigate",D),()=>window.removeEventListener("navigate",D)},[]);const h=D=>{n(D),i(null),c(!1)},m=D=>{i(D),c(!0)},x=()=>{i(null),c(!0)},g=()=>{c(!1),i(null)},y=()=>{c(!1),i(null)},[v,b]=on.useState(!1),[N,E]=on.useState(null),S=async()=>{const D=window;try{D.__preventReDispatch=!0}catch{}try{D.__forceNavigationInProgress=!0}catch{}try{const R=Array.from(D.__unsavedAllowHandlers||[]);for(const M of R)try{await M()}catch(z){console.debug("allow handler failed",z)}try{window.dispatchEvent(new CustomEvent("unsaved:allow"))}catch{}b(!1);const q=N||D.__pendingNavigation||null;E(null);try{typeof window<"u"&&(D.__pendingNavigation=null)}catch{}if(q&&q.page){const{page:M,action:z}=q;n(M),z==="new"&&(i(null),c(!0))}}catch(R){console.error("confirmGlobalDiscard failed",R),b(!1),E(null)}finally{setTimeout(()=>{try{D.__forceNavigationInProgress=!1}catch{}try{D.__preventReDispatch=!1}catch{}try{D.__unsavedGuards=new Set}catch{}},60)}},C=()=>{b(!1),E(null);try{const D=window;D.__pendingNavigation=null}catch{}},T=D=>{t(D)},k=()=>{try{Is.logout()}catch{}t(null),n("dashboard")},P=()=>{if(s)switch(r){case"eleves":return o.jsx(QX,{eleve:a,onSave:g,onCancel:y});case"enseignants":return o.jsx(eq,{enseignant:a,onSave:g,onCancel:y});case"classes":return o.jsx(rq,{classe:a,onSave:g,onCancel:y});case"matieres":return o.jsx(aq,{matiere:a,onSave:g,onCancel:y});default:return o.jsx(Vg,{})}switch(r){case"dashboard":return o.jsx(Vg,{});case"profil":return o.jsx(xle,{user:e});case"parametres":return o.jsx(gle,{});case"finances":return o.jsx(hle,{});case"comptabilite":return o.jsx(mle,{});case"eleves":return o.jsx(JX,{onEleveSelect:m,onNewEleve:x});case"enseignants":return o.jsx(ZX,{onEnseignantSelect:m,onNewEnseignant:x});case"classes":return o.jsx(tq,{onClasseSelect:m,onNewClasse:x});case"matieres":return o.jsx(nq,{onMatiereSelect:m,onNewMatiere:x});case"notes":return o.jsx(iq,{});case"config":return o.jsx(cle,{});default:return o.jsx(Vg,{})}};return o.jsx(P5,{children:e?o.jsx(O5,{children:o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx(D5,{currentUser:e,onLogout:k,onNavigate:h,currentPage:r,onShowGuide:()=>d(!0)}),o.jsx("main",{children:P()}),v&&o.jsx(bf,{open:v,title:"Quitter sans sauvegarder ?",description:"Certaines pages ont des modifications non sauvegardes. Voulez-vous quitter et perdre ces modifications ?",onConfirm:S,onCancel:C}),f&&o.jsx(ple,{onClose:()=>d(!1)})]})}):o.jsx(F5,{onLogin:T})})}p1.createRoot(document.getElementById("root")).render(o.jsx(j.StrictMode,{children:o.jsx(yle,{})}));export{Ft as B,c4 as D,E5 as P,Ya as a,sP as b,wle as c,fe as d,sf as e,Bt as f,x4 as g,Ni as h,o as j,fle as o};
