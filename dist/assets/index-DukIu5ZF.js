const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CombinedRecu-BRmbxc1_.js","./RecuPaiement-BvNnKqp-.js"])))=>i.map(i=>d[i]);
function u4(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var _le=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ei(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var mx={exports:{}},Nu={},px={exports:{}},xt={};var DS;function l5(){if(DS)return xt;DS=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function x(re){return re===null||typeof re!="object"?null:(re=m&&re[m]||re["@@iterator"],typeof re=="function"?re:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,v={};function b(re,O,V){this.props=re,this.context=O,this.refs=v,this.updater=V||g}b.prototype.isReactComponent={},b.prototype.setState=function(re,O){if(typeof re!="object"&&typeof re!="function"&&re!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,re,O,"setState")},b.prototype.forceUpdate=function(re){this.updater.enqueueForceUpdate(this,re,"forceUpdate")};function E(){}E.prototype=b.prototype;function N(re,O,V){this.props=re,this.context=O,this.refs=v,this.updater=V||g}var S=N.prototype=new E;S.constructor=N,y(S,b.prototype),S.isPureReactComponent=!0;var j=Array.isArray,T=Object.prototype.hasOwnProperty,C={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function M(re,O,V){var H,q={},K=null,ie=null;if(O!=null)for(H in O.ref!==void 0&&(ie=O.ref),O.key!==void 0&&(K=""+O.key),O)T.call(O,H)&&!P.hasOwnProperty(H)&&(q[H]=O[H]);var B=arguments.length-2;if(B===1)q.children=V;else if(1<B){for(var z=Array(B),G=0;G<B;G++)z[G]=arguments[G+2];q.children=z}if(re&&re.defaultProps)for(H in B=re.defaultProps,B)q[H]===void 0&&(q[H]=B[H]);return{$$typeof:e,type:re,key:K,ref:ie,props:q,_owner:C.current}}function D(re,O){return{$$typeof:e,type:re.type,key:O,ref:re.ref,props:re.props,_owner:re._owner}}function W(re){return typeof re=="object"&&re!==null&&re.$$typeof===e}function F(re){var O={"=":"=0",":":"=2"};return"$"+re.replace(/[=:]/g,function(V){return O[V]})}var L=/\/+/g;function J(re,O){return typeof re=="object"&&re!==null&&re.key!=null?F(""+re.key):O.toString(36)}function se(re,O,V,H,q){var K=typeof re;(K==="undefined"||K==="boolean")&&(re=null);var ie=!1;if(re===null)ie=!0;else switch(K){case"string":case"number":ie=!0;break;case"object":switch(re.$$typeof){case e:case t:ie=!0}}if(ie)return ie=re,q=q(ie),re=H===""?"."+J(ie,0):H,j(q)?(V="",re!=null&&(V=re.replace(L,"$&/")+"/"),se(q,O,V,"",function(G){return G})):q!=null&&(W(q)&&(q=D(q,V+(!q.key||ie&&ie.key===q.key?"":(""+q.key).replace(L,"$&/")+"/")+re)),O.push(q)),1;if(ie=0,H=H===""?".":H+":",j(re))for(var B=0;B<re.length;B++){K=re[B];var z=H+J(K,B);ie+=se(K,O,V,z,q)}else if(z=x(re),typeof z=="function")for(re=z.call(re),B=0;!(K=re.next()).done;)K=K.value,z=H+J(K,B++),ie+=se(K,O,V,z,q);else if(K==="object")throw O=String(re),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(re).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.");return ie}function Z(re,O,V){if(re==null)return re;var H=[],q=0;return se(re,H,"","",function(K){return O.call(V,K,q++)}),H}function he(re){if(re._status===-1){var O=re._result;O=O(),O.then(function(V){(re._status===0||re._status===-1)&&(re._status=1,re._result=V)},function(V){(re._status===0||re._status===-1)&&(re._status=2,re._result=V)}),re._status===-1&&(re._status=0,re._result=O)}if(re._status===1)return re._result.default;throw re._result}var le={current:null},de={transition:null},Q={ReactCurrentDispatcher:le,ReactCurrentBatchConfig:de,ReactCurrentOwner:C};function pe(){throw Error("act(...) is not supported in production builds of React.")}return xt.Children={map:Z,forEach:function(re,O,V){Z(re,function(){O.apply(this,arguments)},V)},count:function(re){var O=0;return Z(re,function(){O++}),O},toArray:function(re){return Z(re,function(O){return O})||[]},only:function(re){if(!W(re))throw Error("React.Children.only expected to receive a single React element child.");return re}},xt.Component=b,xt.Fragment=r,xt.Profiler=a,xt.PureComponent=N,xt.StrictMode=n,xt.Suspense=f,xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,xt.act=pe,xt.cloneElement=function(re,O,V){if(re==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+re+".");var H=y({},re.props),q=re.key,K=re.ref,ie=re._owner;if(O!=null){if(O.ref!==void 0&&(K=O.ref,ie=C.current),O.key!==void 0&&(q=""+O.key),re.type&&re.type.defaultProps)var B=re.type.defaultProps;for(z in O)T.call(O,z)&&!P.hasOwnProperty(z)&&(H[z]=O[z]===void 0&&B!==void 0?B[z]:O[z])}var z=arguments.length-2;if(z===1)H.children=V;else if(1<z){B=Array(z);for(var G=0;G<z;G++)B[G]=arguments[G+2];H.children=B}return{$$typeof:e,type:re.type,key:q,ref:K,props:H,_owner:ie}},xt.createContext=function(re){return re={$$typeof:s,_currentValue:re,_currentValue2:re,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},re.Provider={$$typeof:i,_context:re},re.Consumer=re},xt.createElement=M,xt.createFactory=function(re){var O=M.bind(null,re);return O.type=re,O},xt.createRef=function(){return{current:null}},xt.forwardRef=function(re){return{$$typeof:l,render:re}},xt.isValidElement=W,xt.lazy=function(re){return{$$typeof:h,_payload:{_status:-1,_result:re},_init:he}},xt.memo=function(re,O){return{$$typeof:d,type:re,compare:O===void 0?null:O}},xt.startTransition=function(re){var O=de.transition;de.transition={};try{re()}finally{de.transition=O}},xt.unstable_act=pe,xt.useCallback=function(re,O){return le.current.useCallback(re,O)},xt.useContext=function(re){return le.current.useContext(re)},xt.useDebugValue=function(){},xt.useDeferredValue=function(re){return le.current.useDeferredValue(re)},xt.useEffect=function(re,O){return le.current.useEffect(re,O)},xt.useId=function(){return le.current.useId()},xt.useImperativeHandle=function(re,O,V){return le.current.useImperativeHandle(re,O,V)},xt.useInsertionEffect=function(re,O){return le.current.useInsertionEffect(re,O)},xt.useLayoutEffect=function(re,O){return le.current.useLayoutEffect(re,O)},xt.useMemo=function(re,O){return le.current.useMemo(re,O)},xt.useReducer=function(re,O,V){return le.current.useReducer(re,O,V)},xt.useRef=function(re){return le.current.useRef(re)},xt.useState=function(re){return le.current.useState(re)},xt.useSyncExternalStore=function(re,O,V){return le.current.useSyncExternalStore(re,O,V)},xt.useTransition=function(){return le.current.useTransition()},xt.version="18.3.1",xt}var IS;function kc(){return IS||(IS=1,px.exports=l5()),px.exports}var MS;function c5(){if(MS)return Nu;MS=1;var e=kc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(l,f,d){var h,m={},x=null,g=null;d!==void 0&&(x=""+d),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(g=f.ref);for(h in f)n.call(f,h)&&!i.hasOwnProperty(h)&&(m[h]=f[h]);if(l&&l.defaultProps)for(h in f=l.defaultProps,f)m[h]===void 0&&(m[h]=f[h]);return{$$typeof:t,type:l,key:x,ref:g,props:m,_owner:a.current}}return Nu.Fragment=r,Nu.jsx=s,Nu.jsxs=s,Nu}var RS;function u5(){return RS||(RS=1,mx.exports=c5()),mx.exports}var o=u5(),k=kc();const on=Ei(k),f5=u4({__proto__:null,default:on},[k]);var a0={},xx={exports:{}},Gn={},gx={exports:{}},vx={};var LS;function d5(){return LS||(LS=1,(function(e){function t(de,Q){var pe=de.length;de.push(Q);e:for(;0<pe;){var re=pe-1>>>1,O=de[re];if(0<a(O,Q))de[re]=Q,de[pe]=O,pe=re;else break e}}function r(de){return de.length===0?null:de[0]}function n(de){if(de.length===0)return null;var Q=de[0],pe=de.pop();if(pe!==Q){de[0]=pe;e:for(var re=0,O=de.length,V=O>>>1;re<V;){var H=2*(re+1)-1,q=de[H],K=H+1,ie=de[K];if(0>a(q,pe))K<O&&0>a(ie,q)?(de[re]=ie,de[K]=pe,re=K):(de[re]=q,de[H]=pe,re=H);else if(K<O&&0>a(ie,pe))de[re]=ie,de[K]=pe,re=K;else break e}}return Q}function a(de,Q){var pe=de.sortIndex-Q.sortIndex;return pe!==0?pe:de.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var f=[],d=[],h=1,m=null,x=3,g=!1,y=!1,v=!1,b=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(de){for(var Q=r(d);Q!==null;){if(Q.callback===null)n(d);else if(Q.startTime<=de)n(d),Q.sortIndex=Q.expirationTime,t(f,Q);else break;Q=r(d)}}function j(de){if(v=!1,S(de),!y)if(r(f)!==null)y=!0,he(T);else{var Q=r(d);Q!==null&&le(j,Q.startTime-de)}}function T(de,Q){y=!1,v&&(v=!1,E(M),M=-1),g=!0;var pe=x;try{for(S(Q),m=r(f);m!==null&&(!(m.expirationTime>Q)||de&&!F());){var re=m.callback;if(typeof re=="function"){m.callback=null,x=m.priorityLevel;var O=re(m.expirationTime<=Q);Q=e.unstable_now(),typeof O=="function"?m.callback=O:m===r(f)&&n(f),S(Q)}else n(f);m=r(f)}if(m!==null)var V=!0;else{var H=r(d);H!==null&&le(j,H.startTime-Q),V=!1}return V}finally{m=null,x=pe,g=!1}}var C=!1,P=null,M=-1,D=5,W=-1;function F(){return!(e.unstable_now()-W<D)}function L(){if(P!==null){var de=e.unstable_now();W=de;var Q=!0;try{Q=P(!0,de)}finally{Q?J():(C=!1,P=null)}}else C=!1}var J;if(typeof N=="function")J=function(){N(L)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,Z=se.port2;se.port1.onmessage=L,J=function(){Z.postMessage(null)}}else J=function(){b(L,0)};function he(de){P=de,C||(C=!0,J())}function le(de,Q){M=b(function(){de(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(de){de.callback=null},e.unstable_continueExecution=function(){y||g||(y=!0,he(T))},e.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<de?Math.floor(1e3/de):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(de){switch(x){case 1:case 2:case 3:var Q=3;break;default:Q=x}var pe=x;x=Q;try{return de()}finally{x=pe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(de,Q){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var pe=x;x=de;try{return Q()}finally{x=pe}},e.unstable_scheduleCallback=function(de,Q,pe){var re=e.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?re+pe:re):pe=re,de){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=pe+O,de={id:h++,callback:Q,priorityLevel:de,startTime:pe,expirationTime:O,sortIndex:-1},pe>re?(de.sortIndex=pe,t(d,de),r(f)===null&&de===r(d)&&(v?(E(M),M=-1):v=!0,le(j,pe-re))):(de.sortIndex=O,t(f,de),y||g||(y=!0,he(T))),de},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(de){var Q=x;return function(){var pe=x;x=Q;try{return de.apply(this,arguments)}finally{x=pe}}}})(vx)),vx}var BS;function h5(){return BS||(BS=1,gx.exports=d5()),gx.exports}var $S;function m5(){if($S)return Gn;$S=1;var e=kc(),t=h5();function r(c){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+c,p=1;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(c,u){s(c,u),s(c+"Capture",u)}function s(c,u){for(a[c]=u,c=0;c<u.length;c++)n.add(u[c])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function x(c){return f.call(m,c)?!0:f.call(h,c)?!1:d.test(c)?m[c]=!0:(h[c]=!0,!1)}function g(c,u,p,w){if(p!==null&&p.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return w?!1:p!==null?!p.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function y(c,u,p,w){if(u===null||typeof u>"u"||g(c,u,p,w))return!0;if(w)return!1;if(p!==null)switch(p.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function v(c,u,p,w,_,A,R){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=w,this.attributeNamespace=_,this.mustUseProperty=p,this.propertyName=c,this.type=u,this.sanitizeURL=A,this.removeEmptyString=R}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){b[c]=new v(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var u=c[0];b[u]=new v(u,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){b[c]=new v(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){b[c]=new v(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){b[c]=new v(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){b[c]=new v(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){b[c]=new v(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){b[c]=new v(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){b[c]=new v(c,5,!1,c.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function N(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var u=c.replace(E,N);b[u]=new v(u,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var u=c.replace(E,N);b[u]=new v(u,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var u=c.replace(E,N);b[u]=new v(u,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){b[c]=new v(c,1,!1,c.toLowerCase(),null,!1,!1)}),b.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){b[c]=new v(c,1,!1,c.toLowerCase(),null,!0,!0)});function S(c,u,p,w){var _=b.hasOwnProperty(u)?b[u]:null;(_!==null?_.type!==0:w||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(y(u,p,_,w)&&(p=null),w||_===null?x(u)&&(p===null?c.removeAttribute(u):c.setAttribute(u,""+p)):_.mustUseProperty?c[_.propertyName]=p===null?_.type===3?!1:"":p:(u=_.attributeName,w=_.attributeNamespace,p===null?c.removeAttribute(u):(_=_.type,p=_===3||_===4&&p===!0?"":""+p,w?c.setAttributeNS(w,u,p):c.setAttribute(u,p))))}var j=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),C=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),F=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),le=Symbol.for("react.offscreen"),de=Symbol.iterator;function Q(c){return c===null||typeof c!="object"?null:(c=de&&c[de]||c["@@iterator"],typeof c=="function"?c:null)}var pe=Object.assign,re;function O(c){if(re===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);re=u&&u[1]||""}return`
`+re+c}var V=!1;function H(c,u){if(!c||V)return"";V=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Ne){var w=Ne}Reflect.construct(c,[],u)}else{try{u.call()}catch(Ne){w=Ne}c.call(u.prototype)}else{try{throw Error()}catch(Ne){w=Ne}c()}}catch(Ne){if(Ne&&w&&typeof Ne.stack=="string"){for(var _=Ne.stack.split(`
`),A=w.stack.split(`
`),R=_.length-1,ae=A.length-1;1<=R&&0<=ae&&_[R]!==A[ae];)ae--;for(;1<=R&&0<=ae;R--,ae--)if(_[R]!==A[ae]){if(R!==1||ae!==1)do if(R--,ae--,0>ae||_[R]!==A[ae]){var ue=`
`+_[R].replace(" at new "," at ");return c.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",c.displayName)),ue}while(1<=R&&0<=ae);break}}}finally{V=!1,Error.prepareStackTrace=p}return(c=c?c.displayName||c.name:"")?O(c):""}function q(c){switch(c.tag){case 5:return O(c.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return c=H(c.type,!1),c;case 11:return c=H(c.type.render,!1),c;case 1:return c=H(c.type,!0),c;default:return""}}function K(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case P:return"Fragment";case C:return"Portal";case D:return"Profiler";case M:return"StrictMode";case J:return"Suspense";case se:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case F:return(c.displayName||"Context")+".Consumer";case W:return(c._context.displayName||"Context")+".Provider";case L:var u=c.render;return c=c.displayName,c||(c=u.displayName||u.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case Z:return u=c.displayName||null,u!==null?u:K(c.type)||"Memo";case he:u=c._payload,c=c._init;try{return K(c(u))}catch{}}return null}function ie(c){var u=c.type;switch(c.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=u.render,c=c.displayName||c.name||"",u.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(u);case 8:return u===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function B(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function z(c){var u=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function G(c){var u=z(c)?"checked":"value",p=Object.getOwnPropertyDescriptor(c.constructor.prototype,u),w=""+c[u];if(!c.hasOwnProperty(u)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var _=p.get,A=p.set;return Object.defineProperty(c,u,{configurable:!0,get:function(){return _.call(this)},set:function(R){w=""+R,A.call(this,R)}}),Object.defineProperty(c,u,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(R){w=""+R},stopTracking:function(){c._valueTracker=null,delete c[u]}}}}function ce(c){c._valueTracker||(c._valueTracker=G(c))}function I(c){if(!c)return!1;var u=c._valueTracker;if(!u)return!0;var p=u.getValue(),w="";return c&&(w=z(c)?c.checked?"true":"false":c.value),c=w,c!==p?(u.setValue(c),!0):!1}function Ae(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function je(c,u){var p=u.checked;return pe({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??c._wrapperState.initialChecked})}function Le(c,u){var p=u.defaultValue==null?"":u.defaultValue,w=u.checked!=null?u.checked:u.defaultChecked;p=B(u.value!=null?u.value:p),c._wrapperState={initialChecked:w,initialValue:p,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function Ue(c,u){u=u.checked,u!=null&&S(c,"checked",u,!1)}function Pe(c,u){Ue(c,u);var p=B(u.value),w=u.type;if(p!=null)w==="number"?(p===0&&c.value===""||c.value!=p)&&(c.value=""+p):c.value!==""+p&&(c.value=""+p);else if(w==="submit"||w==="reset"){c.removeAttribute("value");return}u.hasOwnProperty("value")?kt(c,u.type,p):u.hasOwnProperty("defaultValue")&&kt(c,u.type,B(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(c.defaultChecked=!!u.defaultChecked)}function lt(c,u,p){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var w=u.type;if(!(w!=="submit"&&w!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+c._wrapperState.initialValue,p||u===c.value||(c.value=u),c.defaultValue=u}p=c.name,p!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,p!==""&&(c.name=p)}function kt(c,u,p){(u!=="number"||Ae(c.ownerDocument)!==c)&&(p==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+p&&(c.defaultValue=""+p))}var Yt=Array.isArray;function jt(c,u,p,w){if(c=c.options,u){u={};for(var _=0;_<p.length;_++)u["$"+p[_]]=!0;for(p=0;p<c.length;p++)_=u.hasOwnProperty("$"+c[p].value),c[p].selected!==_&&(c[p].selected=_),_&&w&&(c[p].defaultSelected=!0)}else{for(p=""+B(p),u=null,_=0;_<c.length;_++){if(c[_].value===p){c[_].selected=!0,w&&(c[_].defaultSelected=!0);return}u!==null||c[_].disabled||(u=c[_])}u!==null&&(u.selected=!0)}}function Wa(c,u){if(u.dangerouslySetInnerHTML!=null)throw Error(r(91));return pe({},u,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function Ln(c,u){var p=u.value;if(p==null){if(p=u.children,u=u.defaultValue,p!=null){if(u!=null)throw Error(r(92));if(Yt(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),p=u}c._wrapperState={initialValue:B(p)}}function Br(c,u){var p=B(u.value),w=B(u.defaultValue);p!=null&&(p=""+p,p!==c.value&&(c.value=p),u.defaultValue==null&&c.defaultValue!==p&&(c.defaultValue=p)),w!=null&&(c.defaultValue=""+w)}function tr(c){var u=c.textContent;u===c._wrapperState.initialValue&&u!==""&&u!==null&&(c.value=u)}function Bn(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function en(c,u){return c==null||c==="http://www.w3.org/1999/xhtml"?Bn(u):c==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var rr,Cn=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,p,w,_){MSApp.execUnsafeLocalFunction(function(){return c(u,p,w,_)})}:c})(function(c,u){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=u;else{for(rr=rr||document.createElement("div"),rr.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=rr.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;u.firstChild;)c.appendChild(u.firstChild)}});function ut(c,u){if(u){var p=c.firstChild;if(p&&p===c.lastChild&&p.nodeType===3){p.nodeValue=u;return}}c.textContent=u}var Ct={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oe=["Webkit","ms","Moz","O"];Object.keys(Ct).forEach(function(c){oe.forEach(function(u){u=u+c.charAt(0).toUpperCase()+c.substring(1),Ct[u]=Ct[c]})});function ke(c,u,p){return u==null||typeof u=="boolean"||u===""?"":p||typeof u!="number"||u===0||Ct.hasOwnProperty(c)&&Ct[c]?(""+u).trim():u+"px"}function Ge(c,u){c=c.style;for(var p in u)if(u.hasOwnProperty(p)){var w=p.indexOf("--")===0,_=ke(p,u[p],w);p==="float"&&(p="cssFloat"),w?c.setProperty(p,_):c[p]=_}}var Je=pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function We(c,u){if(u){if(Je[c]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(r(137,c));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(r(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(r(61))}if(u.style!=null&&typeof u.style!="object")throw Error(r(62))}}function at(c,u){if(c.indexOf("-")===-1)return typeof u.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jr=null;function Cr(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var tn=null,Ar=null,$r=null;function $n(c){if(c=lu(c)){if(typeof tn!="function")throw Error(r(280));var u=c.stateNode;u&&(u=yd(u),tn(c.stateNode,c.type,u))}}function lo(c){Ar?$r?$r.push(c):$r=[c]:Ar=c}function $c(){if(Ar){var c=Ar,u=$r;if($r=Ar=null,$n(c),u)for(c=0;c<u.length;c++)$n(u[c])}}function ji(c,u){return c(u)}function Zf(){}var Uc=!1;function ed(c,u,p){if(Uc)return c(u,p);Uc=!0;try{return ji(c,u,p)}finally{Uc=!1,(Ar!==null||$r!==null)&&(Zf(),$c())}}function co(c,u){var p=c.stateNode;if(p===null)return null;var w=yd(p);if(w===null)return null;p=w[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(c=c.type,w=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!w;break e;default:c=!1}if(c)return null;if(p&&typeof p!="function")throw Error(r(231,u,typeof p));return p}var zc=!1;if(l)try{var Ci={};Object.defineProperty(Ci,"passive",{get:function(){zc=!0}}),window.addEventListener("test",Ci,Ci),window.removeEventListener("test",Ci,Ci)}catch{zc=!1}function Dm(c,u,p,w,_,A,R,ae,ue){var Ne=Array.prototype.slice.call(arguments,3);try{u.apply(p,Ne)}catch(Oe){this.onError(Oe)}}var uo=!1,yl=null,U=!1,ee=null,X={onError:function(c){uo=!0,yl=c}};function Y(c,u,p,w,_,A,R,ae,ue){uo=!1,yl=null,Dm.apply(X,arguments)}function te(c,u,p,w,_,A,R,ae,ue){if(Y.apply(this,arguments),uo){if(uo){var Ne=yl;uo=!1,yl=null}else throw Error(r(198));U||(U=!0,ee=Ne)}}function ne(c){var u=c,p=c;if(c.alternate)for(;u.return;)u=u.return;else{c=u;do u=c,(u.flags&4098)!==0&&(p=u.return),c=u.return;while(c)}return u.tag===3?p:null}function ye(c){if(c.tag===13){var u=c.memoizedState;if(u===null&&(c=c.alternate,c!==null&&(u=c.memoizedState)),u!==null)return u.dehydrated}return null}function _e(c){if(ne(c)!==c)throw Error(r(188))}function ve(c){var u=c.alternate;if(!u){if(u=ne(c),u===null)throw Error(r(188));return u!==c?null:c}for(var p=c,w=u;;){var _=p.return;if(_===null)break;var A=_.alternate;if(A===null){if(w=_.return,w!==null){p=w;continue}break}if(_.child===A.child){for(A=_.child;A;){if(A===p)return _e(_),c;if(A===w)return _e(_),u;A=A.sibling}throw Error(r(188))}if(p.return!==w.return)p=_,w=A;else{for(var R=!1,ae=_.child;ae;){if(ae===p){R=!0,p=_,w=A;break}if(ae===w){R=!0,w=_,p=A;break}ae=ae.sibling}if(!R){for(ae=A.child;ae;){if(ae===p){R=!0,p=A,w=_;break}if(ae===w){R=!0,w=A,p=_;break}ae=ae.sibling}if(!R)throw Error(r(189))}}if(p.alternate!==w)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?c:u}function be(c){return c=ve(c),c!==null?we(c):null}function we(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var u=we(c);if(u!==null)return u;c=c.sibling}return null}var Fe=t.unstable_scheduleCallback,ze=t.unstable_cancelCallback,Ve=t.unstable_shouldYield,Me=t.unstable_requestPaint,Ie=t.unstable_now,dt=t.unstable_getCurrentPriorityLevel,Lt=t.unstable_ImmediatePriority,Ut=t.unstable_UserBlockingPriority,hr=t.unstable_NormalPriority,fo=t.unstable_LowPriority,hs=t.unstable_IdlePriority,si=null,Ur=null;function Wc(c){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(si,c,void 0,(c.current.flags&128)===128)}catch{}}var mr=Math.clz32?Math.clz32:k6,E6=Math.log,_6=Math.LN2;function k6(c){return c>>>=0,c===0?32:31-(E6(c)/_6|0)|0}var td=64,rd=4194304;function Hc(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function nd(c,u){var p=c.pendingLanes;if(p===0)return 0;var w=0,_=c.suspendedLanes,A=c.pingedLanes,R=p&268435455;if(R!==0){var ae=R&~_;ae!==0?w=Hc(ae):(A&=R,A!==0&&(w=Hc(A)))}else R=p&~_,R!==0?w=Hc(R):A!==0&&(w=Hc(A));if(w===0)return 0;if(u!==0&&u!==w&&(u&_)===0&&(_=w&-w,A=u&-u,_>=A||_===16&&(A&4194240)!==0))return u;if((w&4)!==0&&(w|=p&16),u=c.entangledLanes,u!==0)for(c=c.entanglements,u&=w;0<u;)p=31-mr(u),_=1<<p,w|=c[p],u&=~_;return w}function j6(c,u){switch(c){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function C6(c,u){for(var p=c.suspendedLanes,w=c.pingedLanes,_=c.expirationTimes,A=c.pendingLanes;0<A;){var R=31-mr(A),ae=1<<R,ue=_[R];ue===-1?((ae&p)===0||(ae&w)!==0)&&(_[R]=j6(ae,u)):ue<=u&&(c.expiredLanes|=ae),A&=~ae}}function Im(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function fw(){var c=td;return td<<=1,(td&4194240)===0&&(td=64),c}function Mm(c){for(var u=[],p=0;31>p;p++)u.push(c);return u}function Vc(c,u,p){c.pendingLanes|=u,u!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,u=31-mr(u),c[u]=p}function A6(c,u){var p=c.pendingLanes&~u;c.pendingLanes=u,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=u,c.mutableReadLanes&=u,c.entangledLanes&=u,u=c.entanglements;var w=c.eventTimes;for(c=c.expirationTimes;0<p;){var _=31-mr(p),A=1<<_;u[_]=0,w[_]=-1,c[_]=-1,p&=~A}}function Rm(c,u){var p=c.entangledLanes|=u;for(c=c.entanglements;p;){var w=31-mr(p),_=1<<w;_&u|c[w]&u&&(c[w]|=u),p&=~_}}var At=0;function dw(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var hw,Lm,mw,pw,xw,Bm=!1,ad=[],ms=null,ps=null,xs=null,Gc=new Map,Kc=new Map,gs=[],T6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gw(c,u){switch(c){case"focusin":case"focusout":ms=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":xs=null;break;case"pointerover":case"pointerout":Gc.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kc.delete(u.pointerId)}}function qc(c,u,p,w,_,A){return c===null||c.nativeEvent!==A?(c={blockedOn:u,domEventName:p,eventSystemFlags:w,nativeEvent:A,targetContainers:[_]},u!==null&&(u=lu(u),u!==null&&Lm(u)),c):(c.eventSystemFlags|=w,u=c.targetContainers,_!==null&&u.indexOf(_)===-1&&u.push(_),c)}function P6(c,u,p,w,_){switch(u){case"focusin":return ms=qc(ms,c,u,p,w,_),!0;case"dragenter":return ps=qc(ps,c,u,p,w,_),!0;case"mouseover":return xs=qc(xs,c,u,p,w,_),!0;case"pointerover":var A=_.pointerId;return Gc.set(A,qc(Gc.get(A)||null,c,u,p,w,_)),!0;case"gotpointercapture":return A=_.pointerId,Kc.set(A,qc(Kc.get(A)||null,c,u,p,w,_)),!0}return!1}function vw(c){var u=ho(c.target);if(u!==null){var p=ne(u);if(p!==null){if(u=p.tag,u===13){if(u=ye(p),u!==null){c.blockedOn=u,xw(c.priority,function(){mw(p)});return}}else if(u===3&&p.stateNode.current.memoizedState.isDehydrated){c.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}c.blockedOn=null}function id(c){if(c.blockedOn!==null)return!1;for(var u=c.targetContainers;0<u.length;){var p=Um(c.domEventName,c.eventSystemFlags,u[0],c.nativeEvent);if(p===null){p=c.nativeEvent;var w=new p.constructor(p.type,p);jr=w,p.target.dispatchEvent(w),jr=null}else return u=lu(p),u!==null&&Lm(u),c.blockedOn=p,!1;u.shift()}return!0}function yw(c,u,p){id(c)&&p.delete(u)}function O6(){Bm=!1,ms!==null&&id(ms)&&(ms=null),ps!==null&&id(ps)&&(ps=null),xs!==null&&id(xs)&&(xs=null),Gc.forEach(yw),Kc.forEach(yw)}function Xc(c,u){c.blockedOn===u&&(c.blockedOn=null,Bm||(Bm=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,O6)))}function Yc(c){function u(_){return Xc(_,c)}if(0<ad.length){Xc(ad[0],c);for(var p=1;p<ad.length;p++){var w=ad[p];w.blockedOn===c&&(w.blockedOn=null)}}for(ms!==null&&Xc(ms,c),ps!==null&&Xc(ps,c),xs!==null&&Xc(xs,c),Gc.forEach(u),Kc.forEach(u),p=0;p<gs.length;p++)w=gs[p],w.blockedOn===c&&(w.blockedOn=null);for(;0<gs.length&&(p=gs[0],p.blockedOn===null);)vw(p),p.blockedOn===null&&gs.shift()}var bl=j.ReactCurrentBatchConfig,sd=!0;function F6(c,u,p,w){var _=At,A=bl.transition;bl.transition=null;try{At=1,$m(c,u,p,w)}finally{At=_,bl.transition=A}}function D6(c,u,p,w){var _=At,A=bl.transition;bl.transition=null;try{At=4,$m(c,u,p,w)}finally{At=_,bl.transition=A}}function $m(c,u,p,w){if(sd){var _=Um(c,u,p,w);if(_===null)ap(c,u,w,od,p),gw(c,w);else if(P6(_,c,u,p,w))w.stopPropagation();else if(gw(c,w),u&4&&-1<T6.indexOf(c)){for(;_!==null;){var A=lu(_);if(A!==null&&hw(A),A=Um(c,u,p,w),A===null&&ap(c,u,w,od,p),A===_)break;_=A}_!==null&&w.stopPropagation()}else ap(c,u,w,null,p)}}var od=null;function Um(c,u,p,w){if(od=null,c=Cr(w),c=ho(c),c!==null)if(u=ne(c),u===null)c=null;else if(p=u.tag,p===13){if(c=ye(u),c!==null)return c;c=null}else if(p===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;c=null}else u!==c&&(c=null);return od=c,null}function bw(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dt()){case Lt:return 1;case Ut:return 4;case hr:case fo:return 16;case hs:return 536870912;default:return 16}default:return 16}}var vs=null,zm=null,ld=null;function ww(){if(ld)return ld;var c,u=zm,p=u.length,w,_="value"in vs?vs.value:vs.textContent,A=_.length;for(c=0;c<p&&u[c]===_[c];c++);var R=p-c;for(w=1;w<=R&&u[p-w]===_[A-w];w++);return ld=_.slice(c,1<w?1-w:void 0)}function cd(c){var u=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&u===13&&(c=13)):c=u,c===10&&(c=13),32<=c||c===13?c:0}function ud(){return!0}function Sw(){return!1}function ea(c){function u(p,w,_,A,R){this._reactName=p,this._targetInst=_,this.type=w,this.nativeEvent=A,this.target=R,this.currentTarget=null;for(var ae in c)c.hasOwnProperty(ae)&&(p=c[ae],this[ae]=p?p(A):A[ae]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?ud:Sw,this.isPropagationStopped=Sw,this}return pe(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=ud)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=ud)},persist:function(){},isPersistent:ud}),u}var wl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wm=ea(wl),Jc=pe({},wl,{view:0,detail:0}),I6=ea(Jc),Hm,Vm,Qc,fd=pe({},Jc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Km,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Qc&&(Qc&&c.type==="mousemove"?(Hm=c.screenX-Qc.screenX,Vm=c.screenY-Qc.screenY):Vm=Hm=0,Qc=c),Hm)},movementY:function(c){return"movementY"in c?c.movementY:Vm}}),Nw=ea(fd),M6=pe({},fd,{dataTransfer:0}),R6=ea(M6),L6=pe({},Jc,{relatedTarget:0}),Gm=ea(L6),B6=pe({},wl,{animationName:0,elapsedTime:0,pseudoElement:0}),$6=ea(B6),U6=pe({},wl,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),z6=ea(U6),W6=pe({},wl,{data:0}),Ew=ea(W6),H6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},V6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},G6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function K6(c){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(c):(c=G6[c])?!!u[c]:!1}function Km(){return K6}var q6=pe({},Jc,{key:function(c){if(c.key){var u=H6[c.key]||c.key;if(u!=="Unidentified")return u}return c.type==="keypress"?(c=cd(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?V6[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Km,charCode:function(c){return c.type==="keypress"?cd(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?cd(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),X6=ea(q6),Y6=pe({},fd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_w=ea(Y6),J6=pe({},Jc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Km}),Q6=ea(J6),Z6=pe({},wl,{propertyName:0,elapsedTime:0,pseudoElement:0}),eF=ea(Z6),tF=pe({},fd,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),rF=ea(tF),nF=[9,13,27,32],qm=l&&"CompositionEvent"in window,Zc=null;l&&"documentMode"in document&&(Zc=document.documentMode);var aF=l&&"TextEvent"in window&&!Zc,kw=l&&(!qm||Zc&&8<Zc&&11>=Zc),jw=" ",Cw=!1;function Aw(c,u){switch(c){case"keyup":return nF.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tw(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Sl=!1;function iF(c,u){switch(c){case"compositionend":return Tw(u);case"keypress":return u.which!==32?null:(Cw=!0,jw);case"textInput":return c=u.data,c===jw&&Cw?null:c;default:return null}}function sF(c,u){if(Sl)return c==="compositionend"||!qm&&Aw(c,u)?(c=ww(),ld=zm=vs=null,Sl=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return kw&&u.locale!=="ko"?null:u.data;default:return null}}var oF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pw(c){var u=c&&c.nodeName&&c.nodeName.toLowerCase();return u==="input"?!!oF[c.type]:u==="textarea"}function Ow(c,u,p,w){lo(w),u=xd(u,"onChange"),0<u.length&&(p=new Wm("onChange","change",null,p,w),c.push({event:p,listeners:u}))}var eu=null,tu=null;function lF(c){Yw(c,0)}function dd(c){var u=jl(c);if(I(u))return c}function cF(c,u){if(c==="change")return u}var Fw=!1;if(l){var Xm;if(l){var Ym="oninput"in document;if(!Ym){var Dw=document.createElement("div");Dw.setAttribute("oninput","return;"),Ym=typeof Dw.oninput=="function"}Xm=Ym}else Xm=!1;Fw=Xm&&(!document.documentMode||9<document.documentMode)}function Iw(){eu&&(eu.detachEvent("onpropertychange",Mw),tu=eu=null)}function Mw(c){if(c.propertyName==="value"&&dd(tu)){var u=[];Ow(u,tu,c,Cr(c)),ed(lF,u)}}function uF(c,u,p){c==="focusin"?(Iw(),eu=u,tu=p,eu.attachEvent("onpropertychange",Mw)):c==="focusout"&&Iw()}function fF(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return dd(tu)}function dF(c,u){if(c==="click")return dd(u)}function hF(c,u){if(c==="input"||c==="change")return dd(u)}function mF(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var Ha=typeof Object.is=="function"?Object.is:mF;function ru(c,u){if(Ha(c,u))return!0;if(typeof c!="object"||c===null||typeof u!="object"||u===null)return!1;var p=Object.keys(c),w=Object.keys(u);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var _=p[w];if(!f.call(u,_)||!Ha(c[_],u[_]))return!1}return!0}function Rw(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function Lw(c,u){var p=Rw(c);c=0;for(var w;p;){if(p.nodeType===3){if(w=c+p.textContent.length,c<=u&&w>=u)return{node:p,offset:u-c};c=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Rw(p)}}function Bw(c,u){return c&&u?c===u?!0:c&&c.nodeType===3?!1:u&&u.nodeType===3?Bw(c,u.parentNode):"contains"in c?c.contains(u):c.compareDocumentPosition?!!(c.compareDocumentPosition(u)&16):!1:!1}function $w(){for(var c=window,u=Ae();u instanceof c.HTMLIFrameElement;){try{var p=typeof u.contentWindow.location.href=="string"}catch{p=!1}if(p)c=u.contentWindow;else break;u=Ae(c.document)}return u}function Jm(c){var u=c&&c.nodeName&&c.nodeName.toLowerCase();return u&&(u==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||u==="textarea"||c.contentEditable==="true")}function pF(c){var u=$w(),p=c.focusedElem,w=c.selectionRange;if(u!==p&&p&&p.ownerDocument&&Bw(p.ownerDocument.documentElement,p)){if(w!==null&&Jm(p)){if(u=w.start,c=w.end,c===void 0&&(c=u),"selectionStart"in p)p.selectionStart=u,p.selectionEnd=Math.min(c,p.value.length);else if(c=(u=p.ownerDocument||document)&&u.defaultView||window,c.getSelection){c=c.getSelection();var _=p.textContent.length,A=Math.min(w.start,_);w=w.end===void 0?A:Math.min(w.end,_),!c.extend&&A>w&&(_=w,w=A,A=_),_=Lw(p,A);var R=Lw(p,w);_&&R&&(c.rangeCount!==1||c.anchorNode!==_.node||c.anchorOffset!==_.offset||c.focusNode!==R.node||c.focusOffset!==R.offset)&&(u=u.createRange(),u.setStart(_.node,_.offset),c.removeAllRanges(),A>w?(c.addRange(u),c.extend(R.node,R.offset)):(u.setEnd(R.node,R.offset),c.addRange(u)))}}for(u=[],c=p;c=c.parentNode;)c.nodeType===1&&u.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<u.length;p++)c=u[p],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var xF=l&&"documentMode"in document&&11>=document.documentMode,Nl=null,Qm=null,nu=null,Zm=!1;function Uw(c,u,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Zm||Nl==null||Nl!==Ae(w)||(w=Nl,"selectionStart"in w&&Jm(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),nu&&ru(nu,w)||(nu=w,w=xd(Qm,"onSelect"),0<w.length&&(u=new Wm("onSelect","select",null,u,p),c.push({event:u,listeners:w}),u.target=Nl)))}function hd(c,u){var p={};return p[c.toLowerCase()]=u.toLowerCase(),p["Webkit"+c]="webkit"+u,p["Moz"+c]="moz"+u,p}var El={animationend:hd("Animation","AnimationEnd"),animationiteration:hd("Animation","AnimationIteration"),animationstart:hd("Animation","AnimationStart"),transitionend:hd("Transition","TransitionEnd")},ep={},zw={};l&&(zw=document.createElement("div").style,"AnimationEvent"in window||(delete El.animationend.animation,delete El.animationiteration.animation,delete El.animationstart.animation),"TransitionEvent"in window||delete El.transitionend.transition);function md(c){if(ep[c])return ep[c];if(!El[c])return c;var u=El[c],p;for(p in u)if(u.hasOwnProperty(p)&&p in zw)return ep[c]=u[p];return c}var Ww=md("animationend"),Hw=md("animationiteration"),Vw=md("animationstart"),Gw=md("transitionend"),Kw=new Map,qw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ys(c,u){Kw.set(c,u),i(u,[c])}for(var tp=0;tp<qw.length;tp++){var rp=qw[tp],gF=rp.toLowerCase(),vF=rp[0].toUpperCase()+rp.slice(1);ys(gF,"on"+vF)}ys(Ww,"onAnimationEnd"),ys(Hw,"onAnimationIteration"),ys(Vw,"onAnimationStart"),ys("dblclick","onDoubleClick"),ys("focusin","onFocus"),ys("focusout","onBlur"),ys(Gw,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yF=new Set("cancel close invalid load scroll toggle".split(" ").concat(au));function Xw(c,u,p){var w=c.type||"unknown-event";c.currentTarget=p,te(w,u,void 0,c),c.currentTarget=null}function Yw(c,u){u=(u&4)!==0;for(var p=0;p<c.length;p++){var w=c[p],_=w.event;w=w.listeners;e:{var A=void 0;if(u)for(var R=w.length-1;0<=R;R--){var ae=w[R],ue=ae.instance,Ne=ae.currentTarget;if(ae=ae.listener,ue!==A&&_.isPropagationStopped())break e;Xw(_,ae,Ne),A=ue}else for(R=0;R<w.length;R++){if(ae=w[R],ue=ae.instance,Ne=ae.currentTarget,ae=ae.listener,ue!==A&&_.isPropagationStopped())break e;Xw(_,ae,Ne),A=ue}}}if(U)throw c=ee,U=!1,ee=null,c}function Ht(c,u){var p=u[up];p===void 0&&(p=u[up]=new Set);var w=c+"__bubble";p.has(w)||(Jw(u,c,2,!1),p.add(w))}function np(c,u,p){var w=0;u&&(w|=4),Jw(p,c,w,u)}var pd="_reactListening"+Math.random().toString(36).slice(2);function iu(c){if(!c[pd]){c[pd]=!0,n.forEach(function(p){p!=="selectionchange"&&(yF.has(p)||np(p,!1,c),np(p,!0,c))});var u=c.nodeType===9?c:c.ownerDocument;u===null||u[pd]||(u[pd]=!0,np("selectionchange",!1,u))}}function Jw(c,u,p,w){switch(bw(u)){case 1:var _=F6;break;case 4:_=D6;break;default:_=$m}p=_.bind(null,u,p,c),_=void 0,!zc||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(_=!0),w?_!==void 0?c.addEventListener(u,p,{capture:!0,passive:_}):c.addEventListener(u,p,!0):_!==void 0?c.addEventListener(u,p,{passive:_}):c.addEventListener(u,p,!1)}function ap(c,u,p,w,_){var A=w;if((u&1)===0&&(u&2)===0&&w!==null)e:for(;;){if(w===null)return;var R=w.tag;if(R===3||R===4){var ae=w.stateNode.containerInfo;if(ae===_||ae.nodeType===8&&ae.parentNode===_)break;if(R===4)for(R=w.return;R!==null;){var ue=R.tag;if((ue===3||ue===4)&&(ue=R.stateNode.containerInfo,ue===_||ue.nodeType===8&&ue.parentNode===_))return;R=R.return}for(;ae!==null;){if(R=ho(ae),R===null)return;if(ue=R.tag,ue===5||ue===6){w=A=R;continue e}ae=ae.parentNode}}w=w.return}ed(function(){var Ne=A,Oe=Cr(p),De=[];e:{var Te=Kw.get(c);if(Te!==void 0){var He=Wm,Xe=c;switch(c){case"keypress":if(cd(p)===0)break e;case"keydown":case"keyup":He=X6;break;case"focusin":Xe="focus",He=Gm;break;case"focusout":Xe="blur",He=Gm;break;case"beforeblur":case"afterblur":He=Gm;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":He=Nw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":He=R6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":He=Q6;break;case Ww:case Hw:case Vw:He=$6;break;case Gw:He=eF;break;case"scroll":He=I6;break;case"wheel":He=rF;break;case"copy":case"cut":case"paste":He=z6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":He=_w}var Ye=(u&4)!==0,pr=!Ye&&c==="scroll",xe=Ye?Te!==null?Te+"Capture":null:Te;Ye=[];for(var me=Ne,ge;me!==null;){ge=me;var Re=ge.stateNode;if(ge.tag===5&&Re!==null&&(ge=Re,xe!==null&&(Re=co(me,xe),Re!=null&&Ye.push(su(me,Re,ge)))),pr)break;me=me.return}0<Ye.length&&(Te=new He(Te,Xe,null,p,Oe),De.push({event:Te,listeners:Ye}))}}if((u&7)===0){e:{if(Te=c==="mouseover"||c==="pointerover",He=c==="mouseout"||c==="pointerout",Te&&p!==jr&&(Xe=p.relatedTarget||p.fromElement)&&(ho(Xe)||Xe[Ai]))break e;if((He||Te)&&(Te=Oe.window===Oe?Oe:(Te=Oe.ownerDocument)?Te.defaultView||Te.parentWindow:window,He?(Xe=p.relatedTarget||p.toElement,He=Ne,Xe=Xe?ho(Xe):null,Xe!==null&&(pr=ne(Xe),Xe!==pr||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):(He=null,Xe=Ne),He!==Xe)){if(Ye=Nw,Re="onMouseLeave",xe="onMouseEnter",me="mouse",(c==="pointerout"||c==="pointerover")&&(Ye=_w,Re="onPointerLeave",xe="onPointerEnter",me="pointer"),pr=He==null?Te:jl(He),ge=Xe==null?Te:jl(Xe),Te=new Ye(Re,me+"leave",He,p,Oe),Te.target=pr,Te.relatedTarget=ge,Re=null,ho(Oe)===Ne&&(Ye=new Ye(xe,me+"enter",Xe,p,Oe),Ye.target=ge,Ye.relatedTarget=pr,Re=Ye),pr=Re,He&&Xe)t:{for(Ye=He,xe=Xe,me=0,ge=Ye;ge;ge=_l(ge))me++;for(ge=0,Re=xe;Re;Re=_l(Re))ge++;for(;0<me-ge;)Ye=_l(Ye),me--;for(;0<ge-me;)xe=_l(xe),ge--;for(;me--;){if(Ye===xe||xe!==null&&Ye===xe.alternate)break t;Ye=_l(Ye),xe=_l(xe)}Ye=null}else Ye=null;He!==null&&Qw(De,Te,He,Ye,!1),Xe!==null&&pr!==null&&Qw(De,pr,Xe,Ye,!0)}}e:{if(Te=Ne?jl(Ne):window,He=Te.nodeName&&Te.nodeName.toLowerCase(),He==="select"||He==="input"&&Te.type==="file")var Qe=cF;else if(Pw(Te))if(Fw)Qe=hF;else{Qe=fF;var rt=uF}else(He=Te.nodeName)&&He.toLowerCase()==="input"&&(Te.type==="checkbox"||Te.type==="radio")&&(Qe=dF);if(Qe&&(Qe=Qe(c,Ne))){Ow(De,Qe,p,Oe);break e}rt&&rt(c,Te,Ne),c==="focusout"&&(rt=Te._wrapperState)&&rt.controlled&&Te.type==="number"&&kt(Te,"number",Te.value)}switch(rt=Ne?jl(Ne):window,c){case"focusin":(Pw(rt)||rt.contentEditable==="true")&&(Nl=rt,Qm=Ne,nu=null);break;case"focusout":nu=Qm=Nl=null;break;case"mousedown":Zm=!0;break;case"contextmenu":case"mouseup":case"dragend":Zm=!1,Uw(De,p,Oe);break;case"selectionchange":if(xF)break;case"keydown":case"keyup":Uw(De,p,Oe)}var nt;if(qm)e:{switch(c){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else Sl?Aw(c,p)&&(ft="onCompositionEnd"):c==="keydown"&&p.keyCode===229&&(ft="onCompositionStart");ft&&(kw&&p.locale!=="ko"&&(Sl||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&Sl&&(nt=ww()):(vs=Oe,zm="value"in vs?vs.value:vs.textContent,Sl=!0)),rt=xd(Ne,ft),0<rt.length&&(ft=new Ew(ft,c,null,p,Oe),De.push({event:ft,listeners:rt}),nt?ft.data=nt:(nt=Tw(p),nt!==null&&(ft.data=nt)))),(nt=aF?iF(c,p):sF(c,p))&&(Ne=xd(Ne,"onBeforeInput"),0<Ne.length&&(Oe=new Ew("onBeforeInput","beforeinput",null,p,Oe),De.push({event:Oe,listeners:Ne}),Oe.data=nt))}Yw(De,u)})}function su(c,u,p){return{instance:c,listener:u,currentTarget:p}}function xd(c,u){for(var p=u+"Capture",w=[];c!==null;){var _=c,A=_.stateNode;_.tag===5&&A!==null&&(_=A,A=co(c,p),A!=null&&w.unshift(su(c,A,_)),A=co(c,u),A!=null&&w.push(su(c,A,_))),c=c.return}return w}function _l(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function Qw(c,u,p,w,_){for(var A=u._reactName,R=[];p!==null&&p!==w;){var ae=p,ue=ae.alternate,Ne=ae.stateNode;if(ue!==null&&ue===w)break;ae.tag===5&&Ne!==null&&(ae=Ne,_?(ue=co(p,A),ue!=null&&R.unshift(su(p,ue,ae))):_||(ue=co(p,A),ue!=null&&R.push(su(p,ue,ae)))),p=p.return}R.length!==0&&c.push({event:u,listeners:R})}var bF=/\r\n?/g,wF=/\u0000|\uFFFD/g;function Zw(c){return(typeof c=="string"?c:""+c).replace(bF,`
`).replace(wF,"")}function gd(c,u,p){if(u=Zw(u),Zw(c)!==u&&p)throw Error(r(425))}function vd(){}var ip=null,sp=null;function op(c,u){return c==="textarea"||c==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var lp=typeof setTimeout=="function"?setTimeout:void 0,SF=typeof clearTimeout=="function"?clearTimeout:void 0,e2=typeof Promise=="function"?Promise:void 0,NF=typeof queueMicrotask=="function"?queueMicrotask:typeof e2<"u"?function(c){return e2.resolve(null).then(c).catch(EF)}:lp;function EF(c){setTimeout(function(){throw c})}function cp(c,u){var p=u,w=0;do{var _=p.nextSibling;if(c.removeChild(p),_&&_.nodeType===8)if(p=_.data,p==="/$"){if(w===0){c.removeChild(_),Yc(u);return}w--}else p!=="$"&&p!=="$?"&&p!=="$!"||w++;p=_}while(p);Yc(u)}function bs(c){for(;c!=null;c=c.nextSibling){var u=c.nodeType;if(u===1||u===3)break;if(u===8){if(u=c.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return c}function t2(c){c=c.previousSibling;for(var u=0;c;){if(c.nodeType===8){var p=c.data;if(p==="$"||p==="$!"||p==="$?"){if(u===0)return c;u--}else p==="/$"&&u++}c=c.previousSibling}return null}var kl=Math.random().toString(36).slice(2),oi="__reactFiber$"+kl,ou="__reactProps$"+kl,Ai="__reactContainer$"+kl,up="__reactEvents$"+kl,_F="__reactListeners$"+kl,kF="__reactHandles$"+kl;function ho(c){var u=c[oi];if(u)return u;for(var p=c.parentNode;p;){if(u=p[Ai]||p[oi]){if(p=u.alternate,u.child!==null||p!==null&&p.child!==null)for(c=t2(c);c!==null;){if(p=c[oi])return p;c=t2(c)}return u}c=p,p=c.parentNode}return null}function lu(c){return c=c[oi]||c[Ai],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function jl(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(r(33))}function yd(c){return c[ou]||null}var fp=[],Cl=-1;function ws(c){return{current:c}}function Vt(c){0>Cl||(c.current=fp[Cl],fp[Cl]=null,Cl--)}function zt(c,u){Cl++,fp[Cl]=c.current,c.current=u}var Ss={},dn=ws(Ss),Un=ws(!1),mo=Ss;function Al(c,u){var p=c.type.contextTypes;if(!p)return Ss;var w=c.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===u)return w.__reactInternalMemoizedMaskedChildContext;var _={},A;for(A in p)_[A]=u[A];return w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=u,c.__reactInternalMemoizedMaskedChildContext=_),_}function zn(c){return c=c.childContextTypes,c!=null}function bd(){Vt(Un),Vt(dn)}function r2(c,u,p){if(dn.current!==Ss)throw Error(r(168));zt(dn,u),zt(Un,p)}function n2(c,u,p){var w=c.stateNode;if(u=u.childContextTypes,typeof w.getChildContext!="function")return p;w=w.getChildContext();for(var _ in w)if(!(_ in u))throw Error(r(108,ie(c)||"Unknown",_));return pe({},p,w)}function wd(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||Ss,mo=dn.current,zt(dn,c),zt(Un,Un.current),!0}function a2(c,u,p){var w=c.stateNode;if(!w)throw Error(r(169));p?(c=n2(c,u,mo),w.__reactInternalMemoizedMergedChildContext=c,Vt(Un),Vt(dn),zt(dn,c)):Vt(Un),zt(Un,p)}var Ti=null,Sd=!1,dp=!1;function i2(c){Ti===null?Ti=[c]:Ti.push(c)}function jF(c){Sd=!0,i2(c)}function Ns(){if(!dp&&Ti!==null){dp=!0;var c=0,u=At;try{var p=Ti;for(At=1;c<p.length;c++){var w=p[c];do w=w(!0);while(w!==null)}Ti=null,Sd=!1}catch(_){throw Ti!==null&&(Ti=Ti.slice(c+1)),Fe(Lt,Ns),_}finally{At=u,dp=!1}}return null}var Tl=[],Pl=0,Nd=null,Ed=0,va=[],ya=0,po=null,Pi=1,Oi="";function xo(c,u){Tl[Pl++]=Ed,Tl[Pl++]=Nd,Nd=c,Ed=u}function s2(c,u,p){va[ya++]=Pi,va[ya++]=Oi,va[ya++]=po,po=c;var w=Pi;c=Oi;var _=32-mr(w)-1;w&=~(1<<_),p+=1;var A=32-mr(u)+_;if(30<A){var R=_-_%5;A=(w&(1<<R)-1).toString(32),w>>=R,_-=R,Pi=1<<32-mr(u)+_|p<<_|w,Oi=A+c}else Pi=1<<A|p<<_|w,Oi=c}function hp(c){c.return!==null&&(xo(c,1),s2(c,1,0))}function mp(c){for(;c===Nd;)Nd=Tl[--Pl],Tl[Pl]=null,Ed=Tl[--Pl],Tl[Pl]=null;for(;c===po;)po=va[--ya],va[ya]=null,Oi=va[--ya],va[ya]=null,Pi=va[--ya],va[ya]=null}var ta=null,ra=null,Jt=!1,Va=null;function o2(c,u){var p=Na(5,null,null,0);p.elementType="DELETED",p.stateNode=u,p.return=c,u=c.deletions,u===null?(c.deletions=[p],c.flags|=16):u.push(p)}function l2(c,u){switch(c.tag){case 5:var p=c.type;return u=u.nodeType!==1||p.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(c.stateNode=u,ta=c,ra=bs(u.firstChild),!0):!1;case 6:return u=c.pendingProps===""||u.nodeType!==3?null:u,u!==null?(c.stateNode=u,ta=c,ra=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(p=po!==null?{id:Pi,overflow:Oi}:null,c.memoizedState={dehydrated:u,treeContext:p,retryLane:1073741824},p=Na(18,null,null,0),p.stateNode=u,p.return=c,c.child=p,ta=c,ra=null,!0):!1;default:return!1}}function pp(c){return(c.mode&1)!==0&&(c.flags&128)===0}function xp(c){if(Jt){var u=ra;if(u){var p=u;if(!l2(c,u)){if(pp(c))throw Error(r(418));u=bs(p.nextSibling);var w=ta;u&&l2(c,u)?o2(w,p):(c.flags=c.flags&-4097|2,Jt=!1,ta=c)}}else{if(pp(c))throw Error(r(418));c.flags=c.flags&-4097|2,Jt=!1,ta=c}}}function c2(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;ta=c}function _d(c){if(c!==ta)return!1;if(!Jt)return c2(c),Jt=!0,!1;var u;if((u=c.tag!==3)&&!(u=c.tag!==5)&&(u=c.type,u=u!=="head"&&u!=="body"&&!op(c.type,c.memoizedProps)),u&&(u=ra)){if(pp(c))throw u2(),Error(r(418));for(;u;)o2(c,u),u=bs(u.nextSibling)}if(c2(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(317));e:{for(c=c.nextSibling,u=0;c;){if(c.nodeType===8){var p=c.data;if(p==="/$"){if(u===0){ra=bs(c.nextSibling);break e}u--}else p!=="$"&&p!=="$!"&&p!=="$?"||u++}c=c.nextSibling}ra=null}}else ra=ta?bs(c.stateNode.nextSibling):null;return!0}function u2(){for(var c=ra;c;)c=bs(c.nextSibling)}function Ol(){ra=ta=null,Jt=!1}function gp(c){Va===null?Va=[c]:Va.push(c)}var CF=j.ReactCurrentBatchConfig;function cu(c,u,p){if(c=p.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(r(309));var w=p.stateNode}if(!w)throw Error(r(147,c));var _=w,A=""+c;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===A?u.ref:(u=function(R){var ae=_.refs;R===null?delete ae[A]:ae[A]=R},u._stringRef=A,u)}if(typeof c!="string")throw Error(r(284));if(!p._owner)throw Error(r(290,c))}return c}function kd(c,u){throw c=Object.prototype.toString.call(u),Error(r(31,c==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":c))}function f2(c){var u=c._init;return u(c._payload)}function d2(c){function u(xe,me){if(c){var ge=xe.deletions;ge===null?(xe.deletions=[me],xe.flags|=16):ge.push(me)}}function p(xe,me){if(!c)return null;for(;me!==null;)u(xe,me),me=me.sibling;return null}function w(xe,me){for(xe=new Map;me!==null;)me.key!==null?xe.set(me.key,me):xe.set(me.index,me),me=me.sibling;return xe}function _(xe,me){return xe=Ps(xe,me),xe.index=0,xe.sibling=null,xe}function A(xe,me,ge){return xe.index=ge,c?(ge=xe.alternate,ge!==null?(ge=ge.index,ge<me?(xe.flags|=2,me):ge):(xe.flags|=2,me)):(xe.flags|=1048576,me)}function R(xe){return c&&xe.alternate===null&&(xe.flags|=2),xe}function ae(xe,me,ge,Re){return me===null||me.tag!==6?(me=lx(ge,xe.mode,Re),me.return=xe,me):(me=_(me,ge),me.return=xe,me)}function ue(xe,me,ge,Re){var Qe=ge.type;return Qe===P?Oe(xe,me,ge.props.children,Re,ge.key):me!==null&&(me.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===he&&f2(Qe)===me.type)?(Re=_(me,ge.props),Re.ref=cu(xe,me,ge),Re.return=xe,Re):(Re=Yd(ge.type,ge.key,ge.props,null,xe.mode,Re),Re.ref=cu(xe,me,ge),Re.return=xe,Re)}function Ne(xe,me,ge,Re){return me===null||me.tag!==4||me.stateNode.containerInfo!==ge.containerInfo||me.stateNode.implementation!==ge.implementation?(me=cx(ge,xe.mode,Re),me.return=xe,me):(me=_(me,ge.children||[]),me.return=xe,me)}function Oe(xe,me,ge,Re,Qe){return me===null||me.tag!==7?(me=Eo(ge,xe.mode,Re,Qe),me.return=xe,me):(me=_(me,ge),me.return=xe,me)}function De(xe,me,ge){if(typeof me=="string"&&me!==""||typeof me=="number")return me=lx(""+me,xe.mode,ge),me.return=xe,me;if(typeof me=="object"&&me!==null){switch(me.$$typeof){case T:return ge=Yd(me.type,me.key,me.props,null,xe.mode,ge),ge.ref=cu(xe,null,me),ge.return=xe,ge;case C:return me=cx(me,xe.mode,ge),me.return=xe,me;case he:var Re=me._init;return De(xe,Re(me._payload),ge)}if(Yt(me)||Q(me))return me=Eo(me,xe.mode,ge,null),me.return=xe,me;kd(xe,me)}return null}function Te(xe,me,ge,Re){var Qe=me!==null?me.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return Qe!==null?null:ae(xe,me,""+ge,Re);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case T:return ge.key===Qe?ue(xe,me,ge,Re):null;case C:return ge.key===Qe?Ne(xe,me,ge,Re):null;case he:return Qe=ge._init,Te(xe,me,Qe(ge._payload),Re)}if(Yt(ge)||Q(ge))return Qe!==null?null:Oe(xe,me,ge,Re,null);kd(xe,ge)}return null}function He(xe,me,ge,Re,Qe){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return xe=xe.get(ge)||null,ae(me,xe,""+Re,Qe);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case T:return xe=xe.get(Re.key===null?ge:Re.key)||null,ue(me,xe,Re,Qe);case C:return xe=xe.get(Re.key===null?ge:Re.key)||null,Ne(me,xe,Re,Qe);case he:var rt=Re._init;return He(xe,me,ge,rt(Re._payload),Qe)}if(Yt(Re)||Q(Re))return xe=xe.get(ge)||null,Oe(me,xe,Re,Qe,null);kd(me,Re)}return null}function Xe(xe,me,ge,Re){for(var Qe=null,rt=null,nt=me,ft=me=0,Hr=null;nt!==null&&ft<ge.length;ft++){nt.index>ft?(Hr=nt,nt=null):Hr=nt.sibling;var St=Te(xe,nt,ge[ft],Re);if(St===null){nt===null&&(nt=Hr);break}c&&nt&&St.alternate===null&&u(xe,nt),me=A(St,me,ft),rt===null?Qe=St:rt.sibling=St,rt=St,nt=Hr}if(ft===ge.length)return p(xe,nt),Jt&&xo(xe,ft),Qe;if(nt===null){for(;ft<ge.length;ft++)nt=De(xe,ge[ft],Re),nt!==null&&(me=A(nt,me,ft),rt===null?Qe=nt:rt.sibling=nt,rt=nt);return Jt&&xo(xe,ft),Qe}for(nt=w(xe,nt);ft<ge.length;ft++)Hr=He(nt,xe,ft,ge[ft],Re),Hr!==null&&(c&&Hr.alternate!==null&&nt.delete(Hr.key===null?ft:Hr.key),me=A(Hr,me,ft),rt===null?Qe=Hr:rt.sibling=Hr,rt=Hr);return c&&nt.forEach(function(Os){return u(xe,Os)}),Jt&&xo(xe,ft),Qe}function Ye(xe,me,ge,Re){var Qe=Q(ge);if(typeof Qe!="function")throw Error(r(150));if(ge=Qe.call(ge),ge==null)throw Error(r(151));for(var rt=Qe=null,nt=me,ft=me=0,Hr=null,St=ge.next();nt!==null&&!St.done;ft++,St=ge.next()){nt.index>ft?(Hr=nt,nt=null):Hr=nt.sibling;var Os=Te(xe,nt,St.value,Re);if(Os===null){nt===null&&(nt=Hr);break}c&&nt&&Os.alternate===null&&u(xe,nt),me=A(Os,me,ft),rt===null?Qe=Os:rt.sibling=Os,rt=Os,nt=Hr}if(St.done)return p(xe,nt),Jt&&xo(xe,ft),Qe;if(nt===null){for(;!St.done;ft++,St=ge.next())St=De(xe,St.value,Re),St!==null&&(me=A(St,me,ft),rt===null?Qe=St:rt.sibling=St,rt=St);return Jt&&xo(xe,ft),Qe}for(nt=w(xe,nt);!St.done;ft++,St=ge.next())St=He(nt,xe,ft,St.value,Re),St!==null&&(c&&St.alternate!==null&&nt.delete(St.key===null?ft:St.key),me=A(St,me,ft),rt===null?Qe=St:rt.sibling=St,rt=St);return c&&nt.forEach(function(o5){return u(xe,o5)}),Jt&&xo(xe,ft),Qe}function pr(xe,me,ge,Re){if(typeof ge=="object"&&ge!==null&&ge.type===P&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case T:e:{for(var Qe=ge.key,rt=me;rt!==null;){if(rt.key===Qe){if(Qe=ge.type,Qe===P){if(rt.tag===7){p(xe,rt.sibling),me=_(rt,ge.props.children),me.return=xe,xe=me;break e}}else if(rt.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===he&&f2(Qe)===rt.type){p(xe,rt.sibling),me=_(rt,ge.props),me.ref=cu(xe,rt,ge),me.return=xe,xe=me;break e}p(xe,rt);break}else u(xe,rt);rt=rt.sibling}ge.type===P?(me=Eo(ge.props.children,xe.mode,Re,ge.key),me.return=xe,xe=me):(Re=Yd(ge.type,ge.key,ge.props,null,xe.mode,Re),Re.ref=cu(xe,me,ge),Re.return=xe,xe=Re)}return R(xe);case C:e:{for(rt=ge.key;me!==null;){if(me.key===rt)if(me.tag===4&&me.stateNode.containerInfo===ge.containerInfo&&me.stateNode.implementation===ge.implementation){p(xe,me.sibling),me=_(me,ge.children||[]),me.return=xe,xe=me;break e}else{p(xe,me);break}else u(xe,me);me=me.sibling}me=cx(ge,xe.mode,Re),me.return=xe,xe=me}return R(xe);case he:return rt=ge._init,pr(xe,me,rt(ge._payload),Re)}if(Yt(ge))return Xe(xe,me,ge,Re);if(Q(ge))return Ye(xe,me,ge,Re);kd(xe,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,me!==null&&me.tag===6?(p(xe,me.sibling),me=_(me,ge),me.return=xe,xe=me):(p(xe,me),me=lx(ge,xe.mode,Re),me.return=xe,xe=me),R(xe)):p(xe,me)}return pr}var Fl=d2(!0),h2=d2(!1),jd=ws(null),Cd=null,Dl=null,vp=null;function yp(){vp=Dl=Cd=null}function bp(c){var u=jd.current;Vt(jd),c._currentValue=u}function wp(c,u,p){for(;c!==null;){var w=c.alternate;if((c.childLanes&u)!==u?(c.childLanes|=u,w!==null&&(w.childLanes|=u)):w!==null&&(w.childLanes&u)!==u&&(w.childLanes|=u),c===p)break;c=c.return}}function Il(c,u){Cd=c,vp=Dl=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&u)!==0&&(Wn=!0),c.firstContext=null)}function ba(c){var u=c._currentValue;if(vp!==c)if(c={context:c,memoizedValue:u,next:null},Dl===null){if(Cd===null)throw Error(r(308));Dl=c,Cd.dependencies={lanes:0,firstContext:c}}else Dl=Dl.next=c;return u}var go=null;function Sp(c){go===null?go=[c]:go.push(c)}function m2(c,u,p,w){var _=u.interleaved;return _===null?(p.next=p,Sp(u)):(p.next=_.next,_.next=p),u.interleaved=p,Fi(c,w)}function Fi(c,u){c.lanes|=u;var p=c.alternate;for(p!==null&&(p.lanes|=u),p=c,c=c.return;c!==null;)c.childLanes|=u,p=c.alternate,p!==null&&(p.childLanes|=u),p=c,c=c.return;return p.tag===3?p.stateNode:null}var Es=!1;function Np(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function p2(c,u){c=c.updateQueue,u.updateQueue===c&&(u.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function Di(c,u){return{eventTime:c,lane:u,tag:0,payload:null,callback:null,next:null}}function _s(c,u,p){var w=c.updateQueue;if(w===null)return null;if(w=w.shared,(vt&2)!==0){var _=w.pending;return _===null?u.next=u:(u.next=_.next,_.next=u),w.pending=u,Fi(c,p)}return _=w.interleaved,_===null?(u.next=u,Sp(w)):(u.next=_.next,_.next=u),w.interleaved=u,Fi(c,p)}function Ad(c,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194240)!==0)){var w=u.lanes;w&=c.pendingLanes,p|=w,u.lanes=p,Rm(c,p)}}function x2(c,u){var p=c.updateQueue,w=c.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var _=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var R={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};A===null?_=A=R:A=A.next=R,p=p.next}while(p!==null);A===null?_=A=u:A=A.next=u}else _=A=u;p={baseState:w.baseState,firstBaseUpdate:_,lastBaseUpdate:A,shared:w.shared,effects:w.effects},c.updateQueue=p;return}c=p.lastBaseUpdate,c===null?p.firstBaseUpdate=u:c.next=u,p.lastBaseUpdate=u}function Td(c,u,p,w){var _=c.updateQueue;Es=!1;var A=_.firstBaseUpdate,R=_.lastBaseUpdate,ae=_.shared.pending;if(ae!==null){_.shared.pending=null;var ue=ae,Ne=ue.next;ue.next=null,R===null?A=Ne:R.next=Ne,R=ue;var Oe=c.alternate;Oe!==null&&(Oe=Oe.updateQueue,ae=Oe.lastBaseUpdate,ae!==R&&(ae===null?Oe.firstBaseUpdate=Ne:ae.next=Ne,Oe.lastBaseUpdate=ue))}if(A!==null){var De=_.baseState;R=0,Oe=Ne=ue=null,ae=A;do{var Te=ae.lane,He=ae.eventTime;if((w&Te)===Te){Oe!==null&&(Oe=Oe.next={eventTime:He,lane:0,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null});e:{var Xe=c,Ye=ae;switch(Te=u,He=p,Ye.tag){case 1:if(Xe=Ye.payload,typeof Xe=="function"){De=Xe.call(He,De,Te);break e}De=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=Ye.payload,Te=typeof Xe=="function"?Xe.call(He,De,Te):Xe,Te==null)break e;De=pe({},De,Te);break e;case 2:Es=!0}}ae.callback!==null&&ae.lane!==0&&(c.flags|=64,Te=_.effects,Te===null?_.effects=[ae]:Te.push(ae))}else He={eventTime:He,lane:Te,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},Oe===null?(Ne=Oe=He,ue=De):Oe=Oe.next=He,R|=Te;if(ae=ae.next,ae===null){if(ae=_.shared.pending,ae===null)break;Te=ae,ae=Te.next,Te.next=null,_.lastBaseUpdate=Te,_.shared.pending=null}}while(!0);if(Oe===null&&(ue=De),_.baseState=ue,_.firstBaseUpdate=Ne,_.lastBaseUpdate=Oe,u=_.shared.interleaved,u!==null){_=u;do R|=_.lane,_=_.next;while(_!==u)}else A===null&&(_.shared.lanes=0);bo|=R,c.lanes=R,c.memoizedState=De}}function g2(c,u,p){if(c=u.effects,u.effects=null,c!==null)for(u=0;u<c.length;u++){var w=c[u],_=w.callback;if(_!==null){if(w.callback=null,w=p,typeof _!="function")throw Error(r(191,_));_.call(w)}}}var uu={},li=ws(uu),fu=ws(uu),du=ws(uu);function vo(c){if(c===uu)throw Error(r(174));return c}function Ep(c,u){switch(zt(du,u),zt(fu,c),zt(li,uu),c=u.nodeType,c){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:en(null,"");break;default:c=c===8?u.parentNode:u,u=c.namespaceURI||null,c=c.tagName,u=en(u,c)}Vt(li),zt(li,u)}function Ml(){Vt(li),Vt(fu),Vt(du)}function v2(c){vo(du.current);var u=vo(li.current),p=en(u,c.type);u!==p&&(zt(fu,c),zt(li,p))}function _p(c){fu.current===c&&(Vt(li),Vt(fu))}var nr=ws(0);function Pd(c){for(var u=c;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===c)break;for(;u.sibling===null;){if(u.return===null||u.return===c)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var kp=[];function jp(){for(var c=0;c<kp.length;c++)kp[c]._workInProgressVersionPrimary=null;kp.length=0}var Od=j.ReactCurrentDispatcher,Cp=j.ReactCurrentBatchConfig,yo=0,ar=null,Tr=null,zr=null,Fd=!1,hu=!1,mu=0,AF=0;function hn(){throw Error(r(321))}function Ap(c,u){if(u===null)return!1;for(var p=0;p<u.length&&p<c.length;p++)if(!Ha(c[p],u[p]))return!1;return!0}function Tp(c,u,p,w,_,A){if(yo=A,ar=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Od.current=c===null||c.memoizedState===null?FF:DF,c=p(w,_),hu){A=0;do{if(hu=!1,mu=0,25<=A)throw Error(r(301));A+=1,zr=Tr=null,u.updateQueue=null,Od.current=IF,c=p(w,_)}while(hu)}if(Od.current=Md,u=Tr!==null&&Tr.next!==null,yo=0,zr=Tr=ar=null,Fd=!1,u)throw Error(r(300));return c}function Pp(){var c=mu!==0;return mu=0,c}function ci(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zr===null?ar.memoizedState=zr=c:zr=zr.next=c,zr}function wa(){if(Tr===null){var c=ar.alternate;c=c!==null?c.memoizedState:null}else c=Tr.next;var u=zr===null?ar.memoizedState:zr.next;if(u!==null)zr=u,Tr=c;else{if(c===null)throw Error(r(310));Tr=c,c={memoizedState:Tr.memoizedState,baseState:Tr.baseState,baseQueue:Tr.baseQueue,queue:Tr.queue,next:null},zr===null?ar.memoizedState=zr=c:zr=zr.next=c}return zr}function pu(c,u){return typeof u=="function"?u(c):u}function Op(c){var u=wa(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=c;var w=Tr,_=w.baseQueue,A=p.pending;if(A!==null){if(_!==null){var R=_.next;_.next=A.next,A.next=R}w.baseQueue=_=A,p.pending=null}if(_!==null){A=_.next,w=w.baseState;var ae=R=null,ue=null,Ne=A;do{var Oe=Ne.lane;if((yo&Oe)===Oe)ue!==null&&(ue=ue.next={lane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),w=Ne.hasEagerState?Ne.eagerState:c(w,Ne.action);else{var De={lane:Oe,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null};ue===null?(ae=ue=De,R=w):ue=ue.next=De,ar.lanes|=Oe,bo|=Oe}Ne=Ne.next}while(Ne!==null&&Ne!==A);ue===null?R=w:ue.next=ae,Ha(w,u.memoizedState)||(Wn=!0),u.memoizedState=w,u.baseState=R,u.baseQueue=ue,p.lastRenderedState=w}if(c=p.interleaved,c!==null){_=c;do A=_.lane,ar.lanes|=A,bo|=A,_=_.next;while(_!==c)}else _===null&&(p.lanes=0);return[u.memoizedState,p.dispatch]}function Fp(c){var u=wa(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=c;var w=p.dispatch,_=p.pending,A=u.memoizedState;if(_!==null){p.pending=null;var R=_=_.next;do A=c(A,R.action),R=R.next;while(R!==_);Ha(A,u.memoizedState)||(Wn=!0),u.memoizedState=A,u.baseQueue===null&&(u.baseState=A),p.lastRenderedState=A}return[A,w]}function y2(){}function b2(c,u){var p=ar,w=wa(),_=u(),A=!Ha(w.memoizedState,_);if(A&&(w.memoizedState=_,Wn=!0),w=w.queue,Dp(N2.bind(null,p,w,c),[c]),w.getSnapshot!==u||A||zr!==null&&zr.memoizedState.tag&1){if(p.flags|=2048,xu(9,S2.bind(null,p,w,_,u),void 0,null),Wr===null)throw Error(r(349));(yo&30)!==0||w2(p,u,_)}return _}function w2(c,u,p){c.flags|=16384,c={getSnapshot:u,value:p},u=ar.updateQueue,u===null?(u={lastEffect:null,stores:null},ar.updateQueue=u,u.stores=[c]):(p=u.stores,p===null?u.stores=[c]:p.push(c))}function S2(c,u,p,w){u.value=p,u.getSnapshot=w,E2(u)&&_2(c)}function N2(c,u,p){return p(function(){E2(u)&&_2(c)})}function E2(c){var u=c.getSnapshot;c=c.value;try{var p=u();return!Ha(c,p)}catch{return!0}}function _2(c){var u=Fi(c,1);u!==null&&Xa(u,c,1,-1)}function k2(c){var u=ci();return typeof c=="function"&&(c=c()),u.memoizedState=u.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pu,lastRenderedState:c},u.queue=c,c=c.dispatch=OF.bind(null,ar,c),[u.memoizedState,c]}function xu(c,u,p,w){return c={tag:c,create:u,destroy:p,deps:w,next:null},u=ar.updateQueue,u===null?(u={lastEffect:null,stores:null},ar.updateQueue=u,u.lastEffect=c.next=c):(p=u.lastEffect,p===null?u.lastEffect=c.next=c:(w=p.next,p.next=c,c.next=w,u.lastEffect=c)),c}function j2(){return wa().memoizedState}function Dd(c,u,p,w){var _=ci();ar.flags|=c,_.memoizedState=xu(1|u,p,void 0,w===void 0?null:w)}function Id(c,u,p,w){var _=wa();w=w===void 0?null:w;var A=void 0;if(Tr!==null){var R=Tr.memoizedState;if(A=R.destroy,w!==null&&Ap(w,R.deps)){_.memoizedState=xu(u,p,A,w);return}}ar.flags|=c,_.memoizedState=xu(1|u,p,A,w)}function C2(c,u){return Dd(8390656,8,c,u)}function Dp(c,u){return Id(2048,8,c,u)}function A2(c,u){return Id(4,2,c,u)}function T2(c,u){return Id(4,4,c,u)}function P2(c,u){if(typeof u=="function")return c=c(),u(c),function(){u(null)};if(u!=null)return c=c(),u.current=c,function(){u.current=null}}function O2(c,u,p){return p=p!=null?p.concat([c]):null,Id(4,4,P2.bind(null,u,c),p)}function Ip(){}function F2(c,u){var p=wa();u=u===void 0?null:u;var w=p.memoizedState;return w!==null&&u!==null&&Ap(u,w[1])?w[0]:(p.memoizedState=[c,u],c)}function D2(c,u){var p=wa();u=u===void 0?null:u;var w=p.memoizedState;return w!==null&&u!==null&&Ap(u,w[1])?w[0]:(c=c(),p.memoizedState=[c,u],c)}function I2(c,u,p){return(yo&21)===0?(c.baseState&&(c.baseState=!1,Wn=!0),c.memoizedState=p):(Ha(p,u)||(p=fw(),ar.lanes|=p,bo|=p,c.baseState=!0),u)}function TF(c,u){var p=At;At=p!==0&&4>p?p:4,c(!0);var w=Cp.transition;Cp.transition={};try{c(!1),u()}finally{At=p,Cp.transition=w}}function M2(){return wa().memoizedState}function PF(c,u,p){var w=As(c);if(p={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null},R2(c))L2(u,p);else if(p=m2(c,u,p,w),p!==null){var _=Tn();Xa(p,c,w,_),B2(p,u,w)}}function OF(c,u,p){var w=As(c),_={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null};if(R2(c))L2(u,_);else{var A=c.alternate;if(c.lanes===0&&(A===null||A.lanes===0)&&(A=u.lastRenderedReducer,A!==null))try{var R=u.lastRenderedState,ae=A(R,p);if(_.hasEagerState=!0,_.eagerState=ae,Ha(ae,R)){var ue=u.interleaved;ue===null?(_.next=_,Sp(u)):(_.next=ue.next,ue.next=_),u.interleaved=_;return}}catch{}p=m2(c,u,_,w),p!==null&&(_=Tn(),Xa(p,c,w,_),B2(p,u,w))}}function R2(c){var u=c.alternate;return c===ar||u!==null&&u===ar}function L2(c,u){hu=Fd=!0;var p=c.pending;p===null?u.next=u:(u.next=p.next,p.next=u),c.pending=u}function B2(c,u,p){if((p&4194240)!==0){var w=u.lanes;w&=c.pendingLanes,p|=w,u.lanes=p,Rm(c,p)}}var Md={readContext:ba,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useInsertionEffect:hn,useLayoutEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useMutableSource:hn,useSyncExternalStore:hn,useId:hn,unstable_isNewReconciler:!1},FF={readContext:ba,useCallback:function(c,u){return ci().memoizedState=[c,u===void 0?null:u],c},useContext:ba,useEffect:C2,useImperativeHandle:function(c,u,p){return p=p!=null?p.concat([c]):null,Dd(4194308,4,P2.bind(null,u,c),p)},useLayoutEffect:function(c,u){return Dd(4194308,4,c,u)},useInsertionEffect:function(c,u){return Dd(4,2,c,u)},useMemo:function(c,u){var p=ci();return u=u===void 0?null:u,c=c(),p.memoizedState=[c,u],c},useReducer:function(c,u,p){var w=ci();return u=p!==void 0?p(u):u,w.memoizedState=w.baseState=u,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:u},w.queue=c,c=c.dispatch=PF.bind(null,ar,c),[w.memoizedState,c]},useRef:function(c){var u=ci();return c={current:c},u.memoizedState=c},useState:k2,useDebugValue:Ip,useDeferredValue:function(c){return ci().memoizedState=c},useTransition:function(){var c=k2(!1),u=c[0];return c=TF.bind(null,c[1]),ci().memoizedState=c,[u,c]},useMutableSource:function(){},useSyncExternalStore:function(c,u,p){var w=ar,_=ci();if(Jt){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),Wr===null)throw Error(r(349));(yo&30)!==0||w2(w,u,p)}_.memoizedState=p;var A={value:p,getSnapshot:u};return _.queue=A,C2(N2.bind(null,w,A,c),[c]),w.flags|=2048,xu(9,S2.bind(null,w,A,p,u),void 0,null),p},useId:function(){var c=ci(),u=Wr.identifierPrefix;if(Jt){var p=Oi,w=Pi;p=(w&~(1<<32-mr(w)-1)).toString(32)+p,u=":"+u+"R"+p,p=mu++,0<p&&(u+="H"+p.toString(32)),u+=":"}else p=AF++,u=":"+u+"r"+p.toString(32)+":";return c.memoizedState=u},unstable_isNewReconciler:!1},DF={readContext:ba,useCallback:F2,useContext:ba,useEffect:Dp,useImperativeHandle:O2,useInsertionEffect:A2,useLayoutEffect:T2,useMemo:D2,useReducer:Op,useRef:j2,useState:function(){return Op(pu)},useDebugValue:Ip,useDeferredValue:function(c){var u=wa();return I2(u,Tr.memoizedState,c)},useTransition:function(){var c=Op(pu)[0],u=wa().memoizedState;return[c,u]},useMutableSource:y2,useSyncExternalStore:b2,useId:M2,unstable_isNewReconciler:!1},IF={readContext:ba,useCallback:F2,useContext:ba,useEffect:Dp,useImperativeHandle:O2,useInsertionEffect:A2,useLayoutEffect:T2,useMemo:D2,useReducer:Fp,useRef:j2,useState:function(){return Fp(pu)},useDebugValue:Ip,useDeferredValue:function(c){var u=wa();return Tr===null?u.memoizedState=c:I2(u,Tr.memoizedState,c)},useTransition:function(){var c=Fp(pu)[0],u=wa().memoizedState;return[c,u]},useMutableSource:y2,useSyncExternalStore:b2,useId:M2,unstable_isNewReconciler:!1};function Ga(c,u){if(c&&c.defaultProps){u=pe({},u),c=c.defaultProps;for(var p in c)u[p]===void 0&&(u[p]=c[p]);return u}return u}function Mp(c,u,p,w){u=c.memoizedState,p=p(w,u),p=p==null?u:pe({},u,p),c.memoizedState=p,c.lanes===0&&(c.updateQueue.baseState=p)}var Rd={isMounted:function(c){return(c=c._reactInternals)?ne(c)===c:!1},enqueueSetState:function(c,u,p){c=c._reactInternals;var w=Tn(),_=As(c),A=Di(w,_);A.payload=u,p!=null&&(A.callback=p),u=_s(c,A,_),u!==null&&(Xa(u,c,_,w),Ad(u,c,_))},enqueueReplaceState:function(c,u,p){c=c._reactInternals;var w=Tn(),_=As(c),A=Di(w,_);A.tag=1,A.payload=u,p!=null&&(A.callback=p),u=_s(c,A,_),u!==null&&(Xa(u,c,_,w),Ad(u,c,_))},enqueueForceUpdate:function(c,u){c=c._reactInternals;var p=Tn(),w=As(c),_=Di(p,w);_.tag=2,u!=null&&(_.callback=u),u=_s(c,_,w),u!==null&&(Xa(u,c,w,p),Ad(u,c,w))}};function $2(c,u,p,w,_,A,R){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(w,A,R):u.prototype&&u.prototype.isPureReactComponent?!ru(p,w)||!ru(_,A):!0}function U2(c,u,p){var w=!1,_=Ss,A=u.contextType;return typeof A=="object"&&A!==null?A=ba(A):(_=zn(u)?mo:dn.current,w=u.contextTypes,A=(w=w!=null)?Al(c,_):Ss),u=new u(p,A),c.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=Rd,c.stateNode=u,u._reactInternals=c,w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=_,c.__reactInternalMemoizedMaskedChildContext=A),u}function z2(c,u,p,w){c=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,w),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,w),u.state!==c&&Rd.enqueueReplaceState(u,u.state,null)}function Rp(c,u,p,w){var _=c.stateNode;_.props=p,_.state=c.memoizedState,_.refs={},Np(c);var A=u.contextType;typeof A=="object"&&A!==null?_.context=ba(A):(A=zn(u)?mo:dn.current,_.context=Al(c,A)),_.state=c.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(Mp(c,u,A,p),_.state=c.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(u=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),u!==_.state&&Rd.enqueueReplaceState(_,_.state,null),Td(c,p,_,w),_.state=c.memoizedState),typeof _.componentDidMount=="function"&&(c.flags|=4194308)}function Rl(c,u){try{var p="",w=u;do p+=q(w),w=w.return;while(w);var _=p}catch(A){_=`
Error generating stack: `+A.message+`
`+A.stack}return{value:c,source:u,stack:_,digest:null}}function Lp(c,u,p){return{value:c,source:null,stack:p??null,digest:u??null}}function Bp(c,u){try{console.error(u.value)}catch(p){setTimeout(function(){throw p})}}var MF=typeof WeakMap=="function"?WeakMap:Map;function W2(c,u,p){p=Di(-1,p),p.tag=3,p.payload={element:null};var w=u.value;return p.callback=function(){Hd||(Hd=!0,ex=w),Bp(c,u)},p}function H2(c,u,p){p=Di(-1,p),p.tag=3;var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var _=u.value;p.payload=function(){return w(_)},p.callback=function(){Bp(c,u)}}var A=c.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(p.callback=function(){Bp(c,u),typeof w!="function"&&(js===null?js=new Set([this]):js.add(this));var R=u.stack;this.componentDidCatch(u.value,{componentStack:R!==null?R:""})}),p}function V2(c,u,p){var w=c.pingCache;if(w===null){w=c.pingCache=new MF;var _=new Set;w.set(u,_)}else _=w.get(u),_===void 0&&(_=new Set,w.set(u,_));_.has(p)||(_.add(p),c=YF.bind(null,c,u,p),u.then(c,c))}function G2(c){do{var u;if((u=c.tag===13)&&(u=c.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return c;c=c.return}while(c!==null);return null}function K2(c,u,p,w,_){return(c.mode&1)===0?(c===u?c.flags|=65536:(c.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(u=Di(-1,1),u.tag=2,_s(p,u,1))),p.lanes|=1),c):(c.flags|=65536,c.lanes=_,c)}var RF=j.ReactCurrentOwner,Wn=!1;function An(c,u,p,w){u.child=c===null?h2(u,null,p,w):Fl(u,c.child,p,w)}function q2(c,u,p,w,_){p=p.render;var A=u.ref;return Il(u,_),w=Tp(c,u,p,w,A,_),p=Pp(),c!==null&&!Wn?(u.updateQueue=c.updateQueue,u.flags&=-2053,c.lanes&=~_,Ii(c,u,_)):(Jt&&p&&hp(u),u.flags|=1,An(c,u,w,_),u.child)}function X2(c,u,p,w,_){if(c===null){var A=p.type;return typeof A=="function"&&!ox(A)&&A.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(u.tag=15,u.type=A,Y2(c,u,A,w,_)):(c=Yd(p.type,null,w,u,u.mode,_),c.ref=u.ref,c.return=u,u.child=c)}if(A=c.child,(c.lanes&_)===0){var R=A.memoizedProps;if(p=p.compare,p=p!==null?p:ru,p(R,w)&&c.ref===u.ref)return Ii(c,u,_)}return u.flags|=1,c=Ps(A,w),c.ref=u.ref,c.return=u,u.child=c}function Y2(c,u,p,w,_){if(c!==null){var A=c.memoizedProps;if(ru(A,w)&&c.ref===u.ref)if(Wn=!1,u.pendingProps=w=A,(c.lanes&_)!==0)(c.flags&131072)!==0&&(Wn=!0);else return u.lanes=c.lanes,Ii(c,u,_)}return $p(c,u,p,w,_)}function J2(c,u,p){var w=u.pendingProps,_=w.children,A=c!==null?c.memoizedState:null;if(w.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},zt(Bl,na),na|=p;else{if((p&1073741824)===0)return c=A!==null?A.baseLanes|p:p,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:c,cachePool:null,transitions:null},u.updateQueue=null,zt(Bl,na),na|=c,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=A!==null?A.baseLanes:p,zt(Bl,na),na|=w}else A!==null?(w=A.baseLanes|p,u.memoizedState=null):w=p,zt(Bl,na),na|=w;return An(c,u,_,p),u.child}function Q2(c,u){var p=u.ref;(c===null&&p!==null||c!==null&&c.ref!==p)&&(u.flags|=512,u.flags|=2097152)}function $p(c,u,p,w,_){var A=zn(p)?mo:dn.current;return A=Al(u,A),Il(u,_),p=Tp(c,u,p,w,A,_),w=Pp(),c!==null&&!Wn?(u.updateQueue=c.updateQueue,u.flags&=-2053,c.lanes&=~_,Ii(c,u,_)):(Jt&&w&&hp(u),u.flags|=1,An(c,u,p,_),u.child)}function Z2(c,u,p,w,_){if(zn(p)){var A=!0;wd(u)}else A=!1;if(Il(u,_),u.stateNode===null)Bd(c,u),U2(u,p,w),Rp(u,p,w,_),w=!0;else if(c===null){var R=u.stateNode,ae=u.memoizedProps;R.props=ae;var ue=R.context,Ne=p.contextType;typeof Ne=="object"&&Ne!==null?Ne=ba(Ne):(Ne=zn(p)?mo:dn.current,Ne=Al(u,Ne));var Oe=p.getDerivedStateFromProps,De=typeof Oe=="function"||typeof R.getSnapshotBeforeUpdate=="function";De||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(ae!==w||ue!==Ne)&&z2(u,R,w,Ne),Es=!1;var Te=u.memoizedState;R.state=Te,Td(u,w,R,_),ue=u.memoizedState,ae!==w||Te!==ue||Un.current||Es?(typeof Oe=="function"&&(Mp(u,p,Oe,w),ue=u.memoizedState),(ae=Es||$2(u,p,ae,w,Te,ue,Ne))?(De||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(u.flags|=4194308)):(typeof R.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=w,u.memoizedState=ue),R.props=w,R.state=ue,R.context=Ne,w=ae):(typeof R.componentDidMount=="function"&&(u.flags|=4194308),w=!1)}else{R=u.stateNode,p2(c,u),ae=u.memoizedProps,Ne=u.type===u.elementType?ae:Ga(u.type,ae),R.props=Ne,De=u.pendingProps,Te=R.context,ue=p.contextType,typeof ue=="object"&&ue!==null?ue=ba(ue):(ue=zn(p)?mo:dn.current,ue=Al(u,ue));var He=p.getDerivedStateFromProps;(Oe=typeof He=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(ae!==De||Te!==ue)&&z2(u,R,w,ue),Es=!1,Te=u.memoizedState,R.state=Te,Td(u,w,R,_);var Xe=u.memoizedState;ae!==De||Te!==Xe||Un.current||Es?(typeof He=="function"&&(Mp(u,p,He,w),Xe=u.memoizedState),(Ne=Es||$2(u,p,Ne,w,Te,Xe,ue)||!1)?(Oe||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(w,Xe,ue),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(w,Xe,ue)),typeof R.componentDidUpdate=="function"&&(u.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof R.componentDidUpdate!="function"||ae===c.memoizedProps&&Te===c.memoizedState||(u.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||ae===c.memoizedProps&&Te===c.memoizedState||(u.flags|=1024),u.memoizedProps=w,u.memoizedState=Xe),R.props=w,R.state=Xe,R.context=ue,w=Ne):(typeof R.componentDidUpdate!="function"||ae===c.memoizedProps&&Te===c.memoizedState||(u.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||ae===c.memoizedProps&&Te===c.memoizedState||(u.flags|=1024),w=!1)}return Up(c,u,p,w,A,_)}function Up(c,u,p,w,_,A){Q2(c,u);var R=(u.flags&128)!==0;if(!w&&!R)return _&&a2(u,p,!1),Ii(c,u,A);w=u.stateNode,RF.current=u;var ae=R&&typeof p.getDerivedStateFromError!="function"?null:w.render();return u.flags|=1,c!==null&&R?(u.child=Fl(u,c.child,null,A),u.child=Fl(u,null,ae,A)):An(c,u,ae,A),u.memoizedState=w.state,_&&a2(u,p,!0),u.child}function eS(c){var u=c.stateNode;u.pendingContext?r2(c,u.pendingContext,u.pendingContext!==u.context):u.context&&r2(c,u.context,!1),Ep(c,u.containerInfo)}function tS(c,u,p,w,_){return Ol(),gp(_),u.flags|=256,An(c,u,p,w),u.child}var zp={dehydrated:null,treeContext:null,retryLane:0};function Wp(c){return{baseLanes:c,cachePool:null,transitions:null}}function rS(c,u,p){var w=u.pendingProps,_=nr.current,A=!1,R=(u.flags&128)!==0,ae;if((ae=R)||(ae=c!==null&&c.memoizedState===null?!1:(_&2)!==0),ae?(A=!0,u.flags&=-129):(c===null||c.memoizedState!==null)&&(_|=1),zt(nr,_&1),c===null)return xp(u),c=u.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((u.mode&1)===0?u.lanes=1:c.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(R=w.children,c=w.fallback,A?(w=u.mode,A=u.child,R={mode:"hidden",children:R},(w&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=R):A=Jd(R,w,0,null),c=Eo(c,w,p,null),A.return=u,c.return=u,A.sibling=c,u.child=A,u.child.memoizedState=Wp(p),u.memoizedState=zp,c):Hp(u,R));if(_=c.memoizedState,_!==null&&(ae=_.dehydrated,ae!==null))return LF(c,u,R,w,ae,_,p);if(A){A=w.fallback,R=u.mode,_=c.child,ae=_.sibling;var ue={mode:"hidden",children:w.children};return(R&1)===0&&u.child!==_?(w=u.child,w.childLanes=0,w.pendingProps=ue,u.deletions=null):(w=Ps(_,ue),w.subtreeFlags=_.subtreeFlags&14680064),ae!==null?A=Ps(ae,A):(A=Eo(A,R,p,null),A.flags|=2),A.return=u,w.return=u,w.sibling=A,u.child=w,w=A,A=u.child,R=c.child.memoizedState,R=R===null?Wp(p):{baseLanes:R.baseLanes|p,cachePool:null,transitions:R.transitions},A.memoizedState=R,A.childLanes=c.childLanes&~p,u.memoizedState=zp,w}return A=c.child,c=A.sibling,w=Ps(A,{mode:"visible",children:w.children}),(u.mode&1)===0&&(w.lanes=p),w.return=u,w.sibling=null,c!==null&&(p=u.deletions,p===null?(u.deletions=[c],u.flags|=16):p.push(c)),u.child=w,u.memoizedState=null,w}function Hp(c,u){return u=Jd({mode:"visible",children:u},c.mode,0,null),u.return=c,c.child=u}function Ld(c,u,p,w){return w!==null&&gp(w),Fl(u,c.child,null,p),c=Hp(u,u.pendingProps.children),c.flags|=2,u.memoizedState=null,c}function LF(c,u,p,w,_,A,R){if(p)return u.flags&256?(u.flags&=-257,w=Lp(Error(r(422))),Ld(c,u,R,w)):u.memoizedState!==null?(u.child=c.child,u.flags|=128,null):(A=w.fallback,_=u.mode,w=Jd({mode:"visible",children:w.children},_,0,null),A=Eo(A,_,R,null),A.flags|=2,w.return=u,A.return=u,w.sibling=A,u.child=w,(u.mode&1)!==0&&Fl(u,c.child,null,R),u.child.memoizedState=Wp(R),u.memoizedState=zp,A);if((u.mode&1)===0)return Ld(c,u,R,null);if(_.data==="$!"){if(w=_.nextSibling&&_.nextSibling.dataset,w)var ae=w.dgst;return w=ae,A=Error(r(419)),w=Lp(A,w,void 0),Ld(c,u,R,w)}if(ae=(R&c.childLanes)!==0,Wn||ae){if(w=Wr,w!==null){switch(R&-R){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(w.suspendedLanes|R))!==0?0:_,_!==0&&_!==A.retryLane&&(A.retryLane=_,Fi(c,_),Xa(w,c,_,-1))}return sx(),w=Lp(Error(r(421))),Ld(c,u,R,w)}return _.data==="$?"?(u.flags|=128,u.child=c.child,u=JF.bind(null,c),_._reactRetry=u,null):(c=A.treeContext,ra=bs(_.nextSibling),ta=u,Jt=!0,Va=null,c!==null&&(va[ya++]=Pi,va[ya++]=Oi,va[ya++]=po,Pi=c.id,Oi=c.overflow,po=u),u=Hp(u,w.children),u.flags|=4096,u)}function nS(c,u,p){c.lanes|=u;var w=c.alternate;w!==null&&(w.lanes|=u),wp(c.return,u,p)}function Vp(c,u,p,w,_){var A=c.memoizedState;A===null?c.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:_}:(A.isBackwards=u,A.rendering=null,A.renderingStartTime=0,A.last=w,A.tail=p,A.tailMode=_)}function aS(c,u,p){var w=u.pendingProps,_=w.revealOrder,A=w.tail;if(An(c,u,w.children,p),w=nr.current,(w&2)!==0)w=w&1|2,u.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=u.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&nS(c,p,u);else if(c.tag===19)nS(c,p,u);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===u)break e;for(;c.sibling===null;){if(c.return===null||c.return===u)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}w&=1}if(zt(nr,w),(u.mode&1)===0)u.memoizedState=null;else switch(_){case"forwards":for(p=u.child,_=null;p!==null;)c=p.alternate,c!==null&&Pd(c)===null&&(_=p),p=p.sibling;p=_,p===null?(_=u.child,u.child=null):(_=p.sibling,p.sibling=null),Vp(u,!1,_,p,A);break;case"backwards":for(p=null,_=u.child,u.child=null;_!==null;){if(c=_.alternate,c!==null&&Pd(c)===null){u.child=_;break}c=_.sibling,_.sibling=p,p=_,_=c}Vp(u,!0,p,null,A);break;case"together":Vp(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Bd(c,u){(u.mode&1)===0&&c!==null&&(c.alternate=null,u.alternate=null,u.flags|=2)}function Ii(c,u,p){if(c!==null&&(u.dependencies=c.dependencies),bo|=u.lanes,(p&u.childLanes)===0)return null;if(c!==null&&u.child!==c.child)throw Error(r(153));if(u.child!==null){for(c=u.child,p=Ps(c,c.pendingProps),u.child=p,p.return=u;c.sibling!==null;)c=c.sibling,p=p.sibling=Ps(c,c.pendingProps),p.return=u;p.sibling=null}return u.child}function BF(c,u,p){switch(u.tag){case 3:eS(u),Ol();break;case 5:v2(u);break;case 1:zn(u.type)&&wd(u);break;case 4:Ep(u,u.stateNode.containerInfo);break;case 10:var w=u.type._context,_=u.memoizedProps.value;zt(jd,w._currentValue),w._currentValue=_;break;case 13:if(w=u.memoizedState,w!==null)return w.dehydrated!==null?(zt(nr,nr.current&1),u.flags|=128,null):(p&u.child.childLanes)!==0?rS(c,u,p):(zt(nr,nr.current&1),c=Ii(c,u,p),c!==null?c.sibling:null);zt(nr,nr.current&1);break;case 19:if(w=(p&u.childLanes)!==0,(c.flags&128)!==0){if(w)return aS(c,u,p);u.flags|=128}if(_=u.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),zt(nr,nr.current),w)break;return null;case 22:case 23:return u.lanes=0,J2(c,u,p)}return Ii(c,u,p)}var iS,Gp,sS,oS;iS=function(c,u){for(var p=u.child;p!==null;){if(p.tag===5||p.tag===6)c.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Gp=function(){},sS=function(c,u,p,w){var _=c.memoizedProps;if(_!==w){c=u.stateNode,vo(li.current);var A=null;switch(p){case"input":_=je(c,_),w=je(c,w),A=[];break;case"select":_=pe({},_,{value:void 0}),w=pe({},w,{value:void 0}),A=[];break;case"textarea":_=Wa(c,_),w=Wa(c,w),A=[];break;default:typeof _.onClick!="function"&&typeof w.onClick=="function"&&(c.onclick=vd)}We(p,w);var R;p=null;for(Ne in _)if(!w.hasOwnProperty(Ne)&&_.hasOwnProperty(Ne)&&_[Ne]!=null)if(Ne==="style"){var ae=_[Ne];for(R in ae)ae.hasOwnProperty(R)&&(p||(p={}),p[R]="")}else Ne!=="dangerouslySetInnerHTML"&&Ne!=="children"&&Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&Ne!=="autoFocus"&&(a.hasOwnProperty(Ne)?A||(A=[]):(A=A||[]).push(Ne,null));for(Ne in w){var ue=w[Ne];if(ae=_?.[Ne],w.hasOwnProperty(Ne)&&ue!==ae&&(ue!=null||ae!=null))if(Ne==="style")if(ae){for(R in ae)!ae.hasOwnProperty(R)||ue&&ue.hasOwnProperty(R)||(p||(p={}),p[R]="");for(R in ue)ue.hasOwnProperty(R)&&ae[R]!==ue[R]&&(p||(p={}),p[R]=ue[R])}else p||(A||(A=[]),A.push(Ne,p)),p=ue;else Ne==="dangerouslySetInnerHTML"?(ue=ue?ue.__html:void 0,ae=ae?ae.__html:void 0,ue!=null&&ae!==ue&&(A=A||[]).push(Ne,ue)):Ne==="children"?typeof ue!="string"&&typeof ue!="number"||(A=A||[]).push(Ne,""+ue):Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ne)?(ue!=null&&Ne==="onScroll"&&Ht("scroll",c),A||ae===ue||(A=[])):(A=A||[]).push(Ne,ue))}p&&(A=A||[]).push("style",p);var Ne=A;(u.updateQueue=Ne)&&(u.flags|=4)}},oS=function(c,u,p,w){p!==w&&(u.flags|=4)};function gu(c,u){if(!Jt)switch(c.tailMode){case"hidden":u=c.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?c.tail=null:p.sibling=null;break;case"collapsed":p=c.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?u||c.tail===null?c.tail=null:c.tail.sibling=null:w.sibling=null}}function mn(c){var u=c.alternate!==null&&c.alternate.child===c.child,p=0,w=0;if(u)for(var _=c.child;_!==null;)p|=_.lanes|_.childLanes,w|=_.subtreeFlags&14680064,w|=_.flags&14680064,_.return=c,_=_.sibling;else for(_=c.child;_!==null;)p|=_.lanes|_.childLanes,w|=_.subtreeFlags,w|=_.flags,_.return=c,_=_.sibling;return c.subtreeFlags|=w,c.childLanes=p,u}function $F(c,u,p){var w=u.pendingProps;switch(mp(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mn(u),null;case 1:return zn(u.type)&&bd(),mn(u),null;case 3:return w=u.stateNode,Ml(),Vt(Un),Vt(dn),jp(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(c===null||c.child===null)&&(_d(u)?u.flags|=4:c===null||c.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Va!==null&&(nx(Va),Va=null))),Gp(c,u),mn(u),null;case 5:_p(u);var _=vo(du.current);if(p=u.type,c!==null&&u.stateNode!=null)sS(c,u,p,w,_),c.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!w){if(u.stateNode===null)throw Error(r(166));return mn(u),null}if(c=vo(li.current),_d(u)){w=u.stateNode,p=u.type;var A=u.memoizedProps;switch(w[oi]=u,w[ou]=A,c=(u.mode&1)!==0,p){case"dialog":Ht("cancel",w),Ht("close",w);break;case"iframe":case"object":case"embed":Ht("load",w);break;case"video":case"audio":for(_=0;_<au.length;_++)Ht(au[_],w);break;case"source":Ht("error",w);break;case"img":case"image":case"link":Ht("error",w),Ht("load",w);break;case"details":Ht("toggle",w);break;case"input":Le(w,A),Ht("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!A.multiple},Ht("invalid",w);break;case"textarea":Ln(w,A),Ht("invalid",w)}We(p,A),_=null;for(var R in A)if(A.hasOwnProperty(R)){var ae=A[R];R==="children"?typeof ae=="string"?w.textContent!==ae&&(A.suppressHydrationWarning!==!0&&gd(w.textContent,ae,c),_=["children",ae]):typeof ae=="number"&&w.textContent!==""+ae&&(A.suppressHydrationWarning!==!0&&gd(w.textContent,ae,c),_=["children",""+ae]):a.hasOwnProperty(R)&&ae!=null&&R==="onScroll"&&Ht("scroll",w)}switch(p){case"input":ce(w),lt(w,A,!0);break;case"textarea":ce(w),tr(w);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(w.onclick=vd)}w=_,u.updateQueue=w,w!==null&&(u.flags|=4)}else{R=_.nodeType===9?_:_.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Bn(p)),c==="http://www.w3.org/1999/xhtml"?p==="script"?(c=R.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof w.is=="string"?c=R.createElement(p,{is:w.is}):(c=R.createElement(p),p==="select"&&(R=c,w.multiple?R.multiple=!0:w.size&&(R.size=w.size))):c=R.createElementNS(c,p),c[oi]=u,c[ou]=w,iS(c,u,!1,!1),u.stateNode=c;e:{switch(R=at(p,w),p){case"dialog":Ht("cancel",c),Ht("close",c),_=w;break;case"iframe":case"object":case"embed":Ht("load",c),_=w;break;case"video":case"audio":for(_=0;_<au.length;_++)Ht(au[_],c);_=w;break;case"source":Ht("error",c),_=w;break;case"img":case"image":case"link":Ht("error",c),Ht("load",c),_=w;break;case"details":Ht("toggle",c),_=w;break;case"input":Le(c,w),_=je(c,w),Ht("invalid",c);break;case"option":_=w;break;case"select":c._wrapperState={wasMultiple:!!w.multiple},_=pe({},w,{value:void 0}),Ht("invalid",c);break;case"textarea":Ln(c,w),_=Wa(c,w),Ht("invalid",c);break;default:_=w}We(p,_),ae=_;for(A in ae)if(ae.hasOwnProperty(A)){var ue=ae[A];A==="style"?Ge(c,ue):A==="dangerouslySetInnerHTML"?(ue=ue?ue.__html:void 0,ue!=null&&Cn(c,ue)):A==="children"?typeof ue=="string"?(p!=="textarea"||ue!=="")&&ut(c,ue):typeof ue=="number"&&ut(c,""+ue):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(a.hasOwnProperty(A)?ue!=null&&A==="onScroll"&&Ht("scroll",c):ue!=null&&S(c,A,ue,R))}switch(p){case"input":ce(c),lt(c,w,!1);break;case"textarea":ce(c),tr(c);break;case"option":w.value!=null&&c.setAttribute("value",""+B(w.value));break;case"select":c.multiple=!!w.multiple,A=w.value,A!=null?jt(c,!!w.multiple,A,!1):w.defaultValue!=null&&jt(c,!!w.multiple,w.defaultValue,!0);break;default:typeof _.onClick=="function"&&(c.onclick=vd)}switch(p){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return mn(u),null;case 6:if(c&&u.stateNode!=null)oS(c,u,c.memoizedProps,w);else{if(typeof w!="string"&&u.stateNode===null)throw Error(r(166));if(p=vo(du.current),vo(li.current),_d(u)){if(w=u.stateNode,p=u.memoizedProps,w[oi]=u,(A=w.nodeValue!==p)&&(c=ta,c!==null))switch(c.tag){case 3:gd(w.nodeValue,p,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&gd(w.nodeValue,p,(c.mode&1)!==0)}A&&(u.flags|=4)}else w=(p.nodeType===9?p:p.ownerDocument).createTextNode(w),w[oi]=u,u.stateNode=w}return mn(u),null;case 13:if(Vt(nr),w=u.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Jt&&ra!==null&&(u.mode&1)!==0&&(u.flags&128)===0)u2(),Ol(),u.flags|=98560,A=!1;else if(A=_d(u),w!==null&&w.dehydrated!==null){if(c===null){if(!A)throw Error(r(318));if(A=u.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(r(317));A[oi]=u}else Ol(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;mn(u),A=!1}else Va!==null&&(nx(Va),Va=null),A=!0;if(!A)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=p,u):(w=w!==null,w!==(c!==null&&c.memoizedState!==null)&&w&&(u.child.flags|=8192,(u.mode&1)!==0&&(c===null||(nr.current&1)!==0?Pr===0&&(Pr=3):sx())),u.updateQueue!==null&&(u.flags|=4),mn(u),null);case 4:return Ml(),Gp(c,u),c===null&&iu(u.stateNode.containerInfo),mn(u),null;case 10:return bp(u.type._context),mn(u),null;case 17:return zn(u.type)&&bd(),mn(u),null;case 19:if(Vt(nr),A=u.memoizedState,A===null)return mn(u),null;if(w=(u.flags&128)!==0,R=A.rendering,R===null)if(w)gu(A,!1);else{if(Pr!==0||c!==null&&(c.flags&128)!==0)for(c=u.child;c!==null;){if(R=Pd(c),R!==null){for(u.flags|=128,gu(A,!1),w=R.updateQueue,w!==null&&(u.updateQueue=w,u.flags|=4),u.subtreeFlags=0,w=p,p=u.child;p!==null;)A=p,c=w,A.flags&=14680066,R=A.alternate,R===null?(A.childLanes=0,A.lanes=c,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=R.childLanes,A.lanes=R.lanes,A.child=R.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=R.memoizedProps,A.memoizedState=R.memoizedState,A.updateQueue=R.updateQueue,A.type=R.type,c=R.dependencies,A.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),p=p.sibling;return zt(nr,nr.current&1|2),u.child}c=c.sibling}A.tail!==null&&Ie()>$l&&(u.flags|=128,w=!0,gu(A,!1),u.lanes=4194304)}else{if(!w)if(c=Pd(R),c!==null){if(u.flags|=128,w=!0,p=c.updateQueue,p!==null&&(u.updateQueue=p,u.flags|=4),gu(A,!0),A.tail===null&&A.tailMode==="hidden"&&!R.alternate&&!Jt)return mn(u),null}else 2*Ie()-A.renderingStartTime>$l&&p!==1073741824&&(u.flags|=128,w=!0,gu(A,!1),u.lanes=4194304);A.isBackwards?(R.sibling=u.child,u.child=R):(p=A.last,p!==null?p.sibling=R:u.child=R,A.last=R)}return A.tail!==null?(u=A.tail,A.rendering=u,A.tail=u.sibling,A.renderingStartTime=Ie(),u.sibling=null,p=nr.current,zt(nr,w?p&1|2:p&1),u):(mn(u),null);case 22:case 23:return ix(),w=u.memoizedState!==null,c!==null&&c.memoizedState!==null!==w&&(u.flags|=8192),w&&(u.mode&1)!==0?(na&1073741824)!==0&&(mn(u),u.subtreeFlags&6&&(u.flags|=8192)):mn(u),null;case 24:return null;case 25:return null}throw Error(r(156,u.tag))}function UF(c,u){switch(mp(u),u.tag){case 1:return zn(u.type)&&bd(),c=u.flags,c&65536?(u.flags=c&-65537|128,u):null;case 3:return Ml(),Vt(Un),Vt(dn),jp(),c=u.flags,(c&65536)!==0&&(c&128)===0?(u.flags=c&-65537|128,u):null;case 5:return _p(u),null;case 13:if(Vt(nr),c=u.memoizedState,c!==null&&c.dehydrated!==null){if(u.alternate===null)throw Error(r(340));Ol()}return c=u.flags,c&65536?(u.flags=c&-65537|128,u):null;case 19:return Vt(nr),null;case 4:return Ml(),null;case 10:return bp(u.type._context),null;case 22:case 23:return ix(),null;case 24:return null;default:return null}}var $d=!1,pn=!1,zF=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function Ll(c,u){var p=c.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(w){cr(c,u,w)}else p.current=null}function Kp(c,u,p){try{p()}catch(w){cr(c,u,w)}}var lS=!1;function WF(c,u){if(ip=sd,c=$w(),Jm(c)){if("selectionStart"in c)var p={start:c.selectionStart,end:c.selectionEnd};else e:{p=(p=c.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var _=w.anchorOffset,A=w.focusNode;w=w.focusOffset;try{p.nodeType,A.nodeType}catch{p=null;break e}var R=0,ae=-1,ue=-1,Ne=0,Oe=0,De=c,Te=null;t:for(;;){for(var He;De!==p||_!==0&&De.nodeType!==3||(ae=R+_),De!==A||w!==0&&De.nodeType!==3||(ue=R+w),De.nodeType===3&&(R+=De.nodeValue.length),(He=De.firstChild)!==null;)Te=De,De=He;for(;;){if(De===c)break t;if(Te===p&&++Ne===_&&(ae=R),Te===A&&++Oe===w&&(ue=R),(He=De.nextSibling)!==null)break;De=Te,Te=De.parentNode}De=He}p=ae===-1||ue===-1?null:{start:ae,end:ue}}else p=null}p=p||{start:0,end:0}}else p=null;for(sp={focusedElem:c,selectionRange:p},sd=!1,Ke=u;Ke!==null;)if(u=Ke,c=u.child,(u.subtreeFlags&1028)!==0&&c!==null)c.return=u,Ke=c;else for(;Ke!==null;){u=Ke;try{var Xe=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var Ye=Xe.memoizedProps,pr=Xe.memoizedState,xe=u.stateNode,me=xe.getSnapshotBeforeUpdate(u.elementType===u.type?Ye:Ga(u.type,Ye),pr);xe.__reactInternalSnapshotBeforeUpdate=me}break;case 3:var ge=u.stateNode.containerInfo;ge.nodeType===1?ge.textContent="":ge.nodeType===9&&ge.documentElement&&ge.removeChild(ge.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Re){cr(u,u.return,Re)}if(c=u.sibling,c!==null){c.return=u.return,Ke=c;break}Ke=u.return}return Xe=lS,lS=!1,Xe}function vu(c,u,p){var w=u.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var _=w=w.next;do{if((_.tag&c)===c){var A=_.destroy;_.destroy=void 0,A!==void 0&&Kp(u,p,A)}_=_.next}while(_!==w)}}function Ud(c,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var p=u=u.next;do{if((p.tag&c)===c){var w=p.create;p.destroy=w()}p=p.next}while(p!==u)}}function qp(c){var u=c.ref;if(u!==null){var p=c.stateNode;c.tag,c=p,typeof u=="function"?u(c):u.current=c}}function cS(c){var u=c.alternate;u!==null&&(c.alternate=null,cS(u)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(u=c.stateNode,u!==null&&(delete u[oi],delete u[ou],delete u[up],delete u[_F],delete u[kF])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function uS(c){return c.tag===5||c.tag===3||c.tag===4}function fS(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||uS(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function Xp(c,u,p){var w=c.tag;if(w===5||w===6)c=c.stateNode,u?p.nodeType===8?p.parentNode.insertBefore(c,u):p.insertBefore(c,u):(p.nodeType===8?(u=p.parentNode,u.insertBefore(c,p)):(u=p,u.appendChild(c)),p=p._reactRootContainer,p!=null||u.onclick!==null||(u.onclick=vd));else if(w!==4&&(c=c.child,c!==null))for(Xp(c,u,p),c=c.sibling;c!==null;)Xp(c,u,p),c=c.sibling}function Yp(c,u,p){var w=c.tag;if(w===5||w===6)c=c.stateNode,u?p.insertBefore(c,u):p.appendChild(c);else if(w!==4&&(c=c.child,c!==null))for(Yp(c,u,p),c=c.sibling;c!==null;)Yp(c,u,p),c=c.sibling}var rn=null,Ka=!1;function ks(c,u,p){for(p=p.child;p!==null;)dS(c,u,p),p=p.sibling}function dS(c,u,p){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(si,p)}catch{}switch(p.tag){case 5:pn||Ll(p,u);case 6:var w=rn,_=Ka;rn=null,ks(c,u,p),rn=w,Ka=_,rn!==null&&(Ka?(c=rn,p=p.stateNode,c.nodeType===8?c.parentNode.removeChild(p):c.removeChild(p)):rn.removeChild(p.stateNode));break;case 18:rn!==null&&(Ka?(c=rn,p=p.stateNode,c.nodeType===8?cp(c.parentNode,p):c.nodeType===1&&cp(c,p),Yc(c)):cp(rn,p.stateNode));break;case 4:w=rn,_=Ka,rn=p.stateNode.containerInfo,Ka=!0,ks(c,u,p),rn=w,Ka=_;break;case 0:case 11:case 14:case 15:if(!pn&&(w=p.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){_=w=w.next;do{var A=_,R=A.destroy;A=A.tag,R!==void 0&&((A&2)!==0||(A&4)!==0)&&Kp(p,u,R),_=_.next}while(_!==w)}ks(c,u,p);break;case 1:if(!pn&&(Ll(p,u),w=p.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=p.memoizedProps,w.state=p.memoizedState,w.componentWillUnmount()}catch(ae){cr(p,u,ae)}ks(c,u,p);break;case 21:ks(c,u,p);break;case 22:p.mode&1?(pn=(w=pn)||p.memoizedState!==null,ks(c,u,p),pn=w):ks(c,u,p);break;default:ks(c,u,p)}}function hS(c){var u=c.updateQueue;if(u!==null){c.updateQueue=null;var p=c.stateNode;p===null&&(p=c.stateNode=new zF),u.forEach(function(w){var _=QF.bind(null,c,w);p.has(w)||(p.add(w),w.then(_,_))})}}function qa(c,u){var p=u.deletions;if(p!==null)for(var w=0;w<p.length;w++){var _=p[w];try{var A=c,R=u,ae=R;e:for(;ae!==null;){switch(ae.tag){case 5:rn=ae.stateNode,Ka=!1;break e;case 3:rn=ae.stateNode.containerInfo,Ka=!0;break e;case 4:rn=ae.stateNode.containerInfo,Ka=!0;break e}ae=ae.return}if(rn===null)throw Error(r(160));dS(A,R,_),rn=null,Ka=!1;var ue=_.alternate;ue!==null&&(ue.return=null),_.return=null}catch(Ne){cr(_,u,Ne)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)mS(u,c),u=u.sibling}function mS(c,u){var p=c.alternate,w=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(qa(u,c),ui(c),w&4){try{vu(3,c,c.return),Ud(3,c)}catch(Ye){cr(c,c.return,Ye)}try{vu(5,c,c.return)}catch(Ye){cr(c,c.return,Ye)}}break;case 1:qa(u,c),ui(c),w&512&&p!==null&&Ll(p,p.return);break;case 5:if(qa(u,c),ui(c),w&512&&p!==null&&Ll(p,p.return),c.flags&32){var _=c.stateNode;try{ut(_,"")}catch(Ye){cr(c,c.return,Ye)}}if(w&4&&(_=c.stateNode,_!=null)){var A=c.memoizedProps,R=p!==null?p.memoizedProps:A,ae=c.type,ue=c.updateQueue;if(c.updateQueue=null,ue!==null)try{ae==="input"&&A.type==="radio"&&A.name!=null&&Ue(_,A),at(ae,R);var Ne=at(ae,A);for(R=0;R<ue.length;R+=2){var Oe=ue[R],De=ue[R+1];Oe==="style"?Ge(_,De):Oe==="dangerouslySetInnerHTML"?Cn(_,De):Oe==="children"?ut(_,De):S(_,Oe,De,Ne)}switch(ae){case"input":Pe(_,A);break;case"textarea":Br(_,A);break;case"select":var Te=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!A.multiple;var He=A.value;He!=null?jt(_,!!A.multiple,He,!1):Te!==!!A.multiple&&(A.defaultValue!=null?jt(_,!!A.multiple,A.defaultValue,!0):jt(_,!!A.multiple,A.multiple?[]:"",!1))}_[ou]=A}catch(Ye){cr(c,c.return,Ye)}}break;case 6:if(qa(u,c),ui(c),w&4){if(c.stateNode===null)throw Error(r(162));_=c.stateNode,A=c.memoizedProps;try{_.nodeValue=A}catch(Ye){cr(c,c.return,Ye)}}break;case 3:if(qa(u,c),ui(c),w&4&&p!==null&&p.memoizedState.isDehydrated)try{Yc(u.containerInfo)}catch(Ye){cr(c,c.return,Ye)}break;case 4:qa(u,c),ui(c);break;case 13:qa(u,c),ui(c),_=c.child,_.flags&8192&&(A=_.memoizedState!==null,_.stateNode.isHidden=A,!A||_.alternate!==null&&_.alternate.memoizedState!==null||(Zp=Ie())),w&4&&hS(c);break;case 22:if(Oe=p!==null&&p.memoizedState!==null,c.mode&1?(pn=(Ne=pn)||Oe,qa(u,c),pn=Ne):qa(u,c),ui(c),w&8192){if(Ne=c.memoizedState!==null,(c.stateNode.isHidden=Ne)&&!Oe&&(c.mode&1)!==0)for(Ke=c,Oe=c.child;Oe!==null;){for(De=Ke=Oe;Ke!==null;){switch(Te=Ke,He=Te.child,Te.tag){case 0:case 11:case 14:case 15:vu(4,Te,Te.return);break;case 1:Ll(Te,Te.return);var Xe=Te.stateNode;if(typeof Xe.componentWillUnmount=="function"){w=Te,p=Te.return;try{u=w,Xe.props=u.memoizedProps,Xe.state=u.memoizedState,Xe.componentWillUnmount()}catch(Ye){cr(w,p,Ye)}}break;case 5:Ll(Te,Te.return);break;case 22:if(Te.memoizedState!==null){gS(De);continue}}He!==null?(He.return=Te,Ke=He):gS(De)}Oe=Oe.sibling}e:for(Oe=null,De=c;;){if(De.tag===5){if(Oe===null){Oe=De;try{_=De.stateNode,Ne?(A=_.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(ae=De.stateNode,ue=De.memoizedProps.style,R=ue!=null&&ue.hasOwnProperty("display")?ue.display:null,ae.style.display=ke("display",R))}catch(Ye){cr(c,c.return,Ye)}}}else if(De.tag===6){if(Oe===null)try{De.stateNode.nodeValue=Ne?"":De.memoizedProps}catch(Ye){cr(c,c.return,Ye)}}else if((De.tag!==22&&De.tag!==23||De.memoizedState===null||De===c)&&De.child!==null){De.child.return=De,De=De.child;continue}if(De===c)break e;for(;De.sibling===null;){if(De.return===null||De.return===c)break e;Oe===De&&(Oe=null),De=De.return}Oe===De&&(Oe=null),De.sibling.return=De.return,De=De.sibling}}break;case 19:qa(u,c),ui(c),w&4&&hS(c);break;case 21:break;default:qa(u,c),ui(c)}}function ui(c){var u=c.flags;if(u&2){try{e:{for(var p=c.return;p!==null;){if(uS(p)){var w=p;break e}p=p.return}throw Error(r(160))}switch(w.tag){case 5:var _=w.stateNode;w.flags&32&&(ut(_,""),w.flags&=-33);var A=fS(c);Yp(c,A,_);break;case 3:case 4:var R=w.stateNode.containerInfo,ae=fS(c);Xp(c,ae,R);break;default:throw Error(r(161))}}catch(ue){cr(c,c.return,ue)}c.flags&=-3}u&4096&&(c.flags&=-4097)}function HF(c,u,p){Ke=c,pS(c)}function pS(c,u,p){for(var w=(c.mode&1)!==0;Ke!==null;){var _=Ke,A=_.child;if(_.tag===22&&w){var R=_.memoizedState!==null||$d;if(!R){var ae=_.alternate,ue=ae!==null&&ae.memoizedState!==null||pn;ae=$d;var Ne=pn;if($d=R,(pn=ue)&&!Ne)for(Ke=_;Ke!==null;)R=Ke,ue=R.child,R.tag===22&&R.memoizedState!==null?vS(_):ue!==null?(ue.return=R,Ke=ue):vS(_);for(;A!==null;)Ke=A,pS(A),A=A.sibling;Ke=_,$d=ae,pn=Ne}xS(c)}else(_.subtreeFlags&8772)!==0&&A!==null?(A.return=_,Ke=A):xS(c)}}function xS(c){for(;Ke!==null;){var u=Ke;if((u.flags&8772)!==0){var p=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:pn||Ud(5,u);break;case 1:var w=u.stateNode;if(u.flags&4&&!pn)if(p===null)w.componentDidMount();else{var _=u.elementType===u.type?p.memoizedProps:Ga(u.type,p.memoizedProps);w.componentDidUpdate(_,p.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var A=u.updateQueue;A!==null&&g2(u,A,w);break;case 3:var R=u.updateQueue;if(R!==null){if(p=null,u.child!==null)switch(u.child.tag){case 5:p=u.child.stateNode;break;case 1:p=u.child.stateNode}g2(u,R,p)}break;case 5:var ae=u.stateNode;if(p===null&&u.flags&4){p=ae;var ue=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":ue.autoFocus&&p.focus();break;case"img":ue.src&&(p.src=ue.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var Ne=u.alternate;if(Ne!==null){var Oe=Ne.memoizedState;if(Oe!==null){var De=Oe.dehydrated;De!==null&&Yc(De)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}pn||u.flags&512&&qp(u)}catch(Te){cr(u,u.return,Te)}}if(u===c){Ke=null;break}if(p=u.sibling,p!==null){p.return=u.return,Ke=p;break}Ke=u.return}}function gS(c){for(;Ke!==null;){var u=Ke;if(u===c){Ke=null;break}var p=u.sibling;if(p!==null){p.return=u.return,Ke=p;break}Ke=u.return}}function vS(c){for(;Ke!==null;){var u=Ke;try{switch(u.tag){case 0:case 11:case 15:var p=u.return;try{Ud(4,u)}catch(ue){cr(u,p,ue)}break;case 1:var w=u.stateNode;if(typeof w.componentDidMount=="function"){var _=u.return;try{w.componentDidMount()}catch(ue){cr(u,_,ue)}}var A=u.return;try{qp(u)}catch(ue){cr(u,A,ue)}break;case 5:var R=u.return;try{qp(u)}catch(ue){cr(u,R,ue)}}}catch(ue){cr(u,u.return,ue)}if(u===c){Ke=null;break}var ae=u.sibling;if(ae!==null){ae.return=u.return,Ke=ae;break}Ke=u.return}}var VF=Math.ceil,zd=j.ReactCurrentDispatcher,Jp=j.ReactCurrentOwner,Sa=j.ReactCurrentBatchConfig,vt=0,Wr=null,wr=null,nn=0,na=0,Bl=ws(0),Pr=0,yu=null,bo=0,Wd=0,Qp=0,bu=null,Hn=null,Zp=0,$l=1/0,Mi=null,Hd=!1,ex=null,js=null,Vd=!1,Cs=null,Gd=0,wu=0,tx=null,Kd=-1,qd=0;function Tn(){return(vt&6)!==0?Ie():Kd!==-1?Kd:Kd=Ie()}function As(c){return(c.mode&1)===0?1:(vt&2)!==0&&nn!==0?nn&-nn:CF.transition!==null?(qd===0&&(qd=fw()),qd):(c=At,c!==0||(c=window.event,c=c===void 0?16:bw(c.type)),c)}function Xa(c,u,p,w){if(50<wu)throw wu=0,tx=null,Error(r(185));Vc(c,p,w),((vt&2)===0||c!==Wr)&&(c===Wr&&((vt&2)===0&&(Wd|=p),Pr===4&&Ts(c,nn)),Vn(c,w),p===1&&vt===0&&(u.mode&1)===0&&($l=Ie()+500,Sd&&Ns()))}function Vn(c,u){var p=c.callbackNode;C6(c,u);var w=nd(c,c===Wr?nn:0);if(w===0)p!==null&&ze(p),c.callbackNode=null,c.callbackPriority=0;else if(u=w&-w,c.callbackPriority!==u){if(p!=null&&ze(p),u===1)c.tag===0?jF(bS.bind(null,c)):i2(bS.bind(null,c)),NF(function(){(vt&6)===0&&Ns()}),p=null;else{switch(dw(w)){case 1:p=Lt;break;case 4:p=Ut;break;case 16:p=hr;break;case 536870912:p=hs;break;default:p=hr}p=CS(p,yS.bind(null,c))}c.callbackPriority=u,c.callbackNode=p}}function yS(c,u){if(Kd=-1,qd=0,(vt&6)!==0)throw Error(r(327));var p=c.callbackNode;if(Ul()&&c.callbackNode!==p)return null;var w=nd(c,c===Wr?nn:0);if(w===0)return null;if((w&30)!==0||(w&c.expiredLanes)!==0||u)u=Xd(c,w);else{u=w;var _=vt;vt|=2;var A=SS();(Wr!==c||nn!==u)&&(Mi=null,$l=Ie()+500,So(c,u));do try{qF();break}catch(ae){wS(c,ae)}while(!0);yp(),zd.current=A,vt=_,wr!==null?u=0:(Wr=null,nn=0,u=Pr)}if(u!==0){if(u===2&&(_=Im(c),_!==0&&(w=_,u=rx(c,_))),u===1)throw p=yu,So(c,0),Ts(c,w),Vn(c,Ie()),p;if(u===6)Ts(c,w);else{if(_=c.current.alternate,(w&30)===0&&!GF(_)&&(u=Xd(c,w),u===2&&(A=Im(c),A!==0&&(w=A,u=rx(c,A))),u===1))throw p=yu,So(c,0),Ts(c,w),Vn(c,Ie()),p;switch(c.finishedWork=_,c.finishedLanes=w,u){case 0:case 1:throw Error(r(345));case 2:No(c,Hn,Mi);break;case 3:if(Ts(c,w),(w&130023424)===w&&(u=Zp+500-Ie(),10<u)){if(nd(c,0)!==0)break;if(_=c.suspendedLanes,(_&w)!==w){Tn(),c.pingedLanes|=c.suspendedLanes&_;break}c.timeoutHandle=lp(No.bind(null,c,Hn,Mi),u);break}No(c,Hn,Mi);break;case 4:if(Ts(c,w),(w&4194240)===w)break;for(u=c.eventTimes,_=-1;0<w;){var R=31-mr(w);A=1<<R,R=u[R],R>_&&(_=R),w&=~A}if(w=_,w=Ie()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*VF(w/1960))-w,10<w){c.timeoutHandle=lp(No.bind(null,c,Hn,Mi),w);break}No(c,Hn,Mi);break;case 5:No(c,Hn,Mi);break;default:throw Error(r(329))}}}return Vn(c,Ie()),c.callbackNode===p?yS.bind(null,c):null}function rx(c,u){var p=bu;return c.current.memoizedState.isDehydrated&&(So(c,u).flags|=256),c=Xd(c,u),c!==2&&(u=Hn,Hn=p,u!==null&&nx(u)),c}function nx(c){Hn===null?Hn=c:Hn.push.apply(Hn,c)}function GF(c){for(var u=c;;){if(u.flags&16384){var p=u.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var w=0;w<p.length;w++){var _=p[w],A=_.getSnapshot;_=_.value;try{if(!Ha(A(),_))return!1}catch{return!1}}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===c)break;for(;u.sibling===null;){if(u.return===null||u.return===c)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Ts(c,u){for(u&=~Qp,u&=~Wd,c.suspendedLanes|=u,c.pingedLanes&=~u,c=c.expirationTimes;0<u;){var p=31-mr(u),w=1<<p;c[p]=-1,u&=~w}}function bS(c){if((vt&6)!==0)throw Error(r(327));Ul();var u=nd(c,0);if((u&1)===0)return Vn(c,Ie()),null;var p=Xd(c,u);if(c.tag!==0&&p===2){var w=Im(c);w!==0&&(u=w,p=rx(c,w))}if(p===1)throw p=yu,So(c,0),Ts(c,u),Vn(c,Ie()),p;if(p===6)throw Error(r(345));return c.finishedWork=c.current.alternate,c.finishedLanes=u,No(c,Hn,Mi),Vn(c,Ie()),null}function ax(c,u){var p=vt;vt|=1;try{return c(u)}finally{vt=p,vt===0&&($l=Ie()+500,Sd&&Ns())}}function wo(c){Cs!==null&&Cs.tag===0&&(vt&6)===0&&Ul();var u=vt;vt|=1;var p=Sa.transition,w=At;try{if(Sa.transition=null,At=1,c)return c()}finally{At=w,Sa.transition=p,vt=u,(vt&6)===0&&Ns()}}function ix(){na=Bl.current,Vt(Bl)}function So(c,u){c.finishedWork=null,c.finishedLanes=0;var p=c.timeoutHandle;if(p!==-1&&(c.timeoutHandle=-1,SF(p)),wr!==null)for(p=wr.return;p!==null;){var w=p;switch(mp(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&bd();break;case 3:Ml(),Vt(Un),Vt(dn),jp();break;case 5:_p(w);break;case 4:Ml();break;case 13:Vt(nr);break;case 19:Vt(nr);break;case 10:bp(w.type._context);break;case 22:case 23:ix()}p=p.return}if(Wr=c,wr=c=Ps(c.current,null),nn=na=u,Pr=0,yu=null,Qp=Wd=bo=0,Hn=bu=null,go!==null){for(u=0;u<go.length;u++)if(p=go[u],w=p.interleaved,w!==null){p.interleaved=null;var _=w.next,A=p.pending;if(A!==null){var R=A.next;A.next=_,w.next=R}p.pending=w}go=null}return c}function wS(c,u){do{var p=wr;try{if(yp(),Od.current=Md,Fd){for(var w=ar.memoizedState;w!==null;){var _=w.queue;_!==null&&(_.pending=null),w=w.next}Fd=!1}if(yo=0,zr=Tr=ar=null,hu=!1,mu=0,Jp.current=null,p===null||p.return===null){Pr=1,yu=u,wr=null;break}e:{var A=c,R=p.return,ae=p,ue=u;if(u=nn,ae.flags|=32768,ue!==null&&typeof ue=="object"&&typeof ue.then=="function"){var Ne=ue,Oe=ae,De=Oe.tag;if((Oe.mode&1)===0&&(De===0||De===11||De===15)){var Te=Oe.alternate;Te?(Oe.updateQueue=Te.updateQueue,Oe.memoizedState=Te.memoizedState,Oe.lanes=Te.lanes):(Oe.updateQueue=null,Oe.memoizedState=null)}var He=G2(R);if(He!==null){He.flags&=-257,K2(He,R,ae,A,u),He.mode&1&&V2(A,Ne,u),u=He,ue=Ne;var Xe=u.updateQueue;if(Xe===null){var Ye=new Set;Ye.add(ue),u.updateQueue=Ye}else Xe.add(ue);break e}else{if((u&1)===0){V2(A,Ne,u),sx();break e}ue=Error(r(426))}}else if(Jt&&ae.mode&1){var pr=G2(R);if(pr!==null){(pr.flags&65536)===0&&(pr.flags|=256),K2(pr,R,ae,A,u),gp(Rl(ue,ae));break e}}A=ue=Rl(ue,ae),Pr!==4&&(Pr=2),bu===null?bu=[A]:bu.push(A),A=R;do{switch(A.tag){case 3:A.flags|=65536,u&=-u,A.lanes|=u;var xe=W2(A,ue,u);x2(A,xe);break e;case 1:ae=ue;var me=A.type,ge=A.stateNode;if((A.flags&128)===0&&(typeof me.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(js===null||!js.has(ge)))){A.flags|=65536,u&=-u,A.lanes|=u;var Re=H2(A,ae,u);x2(A,Re);break e}}A=A.return}while(A!==null)}ES(p)}catch(Qe){u=Qe,wr===p&&p!==null&&(wr=p=p.return);continue}break}while(!0)}function SS(){var c=zd.current;return zd.current=Md,c===null?Md:c}function sx(){(Pr===0||Pr===3||Pr===2)&&(Pr=4),Wr===null||(bo&268435455)===0&&(Wd&268435455)===0||Ts(Wr,nn)}function Xd(c,u){var p=vt;vt|=2;var w=SS();(Wr!==c||nn!==u)&&(Mi=null,So(c,u));do try{KF();break}catch(_){wS(c,_)}while(!0);if(yp(),vt=p,zd.current=w,wr!==null)throw Error(r(261));return Wr=null,nn=0,Pr}function KF(){for(;wr!==null;)NS(wr)}function qF(){for(;wr!==null&&!Ve();)NS(wr)}function NS(c){var u=jS(c.alternate,c,na);c.memoizedProps=c.pendingProps,u===null?ES(c):wr=u,Jp.current=null}function ES(c){var u=c;do{var p=u.alternate;if(c=u.return,(u.flags&32768)===0){if(p=$F(p,u,na),p!==null){wr=p;return}}else{if(p=UF(p,u),p!==null){p.flags&=32767,wr=p;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Pr=6,wr=null;return}}if(u=u.sibling,u!==null){wr=u;return}wr=u=c}while(u!==null);Pr===0&&(Pr=5)}function No(c,u,p){var w=At,_=Sa.transition;try{Sa.transition=null,At=1,XF(c,u,p,w)}finally{Sa.transition=_,At=w}return null}function XF(c,u,p,w){do Ul();while(Cs!==null);if((vt&6)!==0)throw Error(r(327));p=c.finishedWork;var _=c.finishedLanes;if(p===null)return null;if(c.finishedWork=null,c.finishedLanes=0,p===c.current)throw Error(r(177));c.callbackNode=null,c.callbackPriority=0;var A=p.lanes|p.childLanes;if(A6(c,A),c===Wr&&(wr=Wr=null,nn=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Vd||(Vd=!0,CS(hr,function(){return Ul(),null})),A=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||A){A=Sa.transition,Sa.transition=null;var R=At;At=1;var ae=vt;vt|=4,Jp.current=null,WF(c,p),mS(p,c),pF(sp),sd=!!ip,sp=ip=null,c.current=p,HF(p),Me(),vt=ae,At=R,Sa.transition=A}else c.current=p;if(Vd&&(Vd=!1,Cs=c,Gd=_),A=c.pendingLanes,A===0&&(js=null),Wc(p.stateNode),Vn(c,Ie()),u!==null)for(w=c.onRecoverableError,p=0;p<u.length;p++)_=u[p],w(_.value,{componentStack:_.stack,digest:_.digest});if(Hd)throw Hd=!1,c=ex,ex=null,c;return(Gd&1)!==0&&c.tag!==0&&Ul(),A=c.pendingLanes,(A&1)!==0?c===tx?wu++:(wu=0,tx=c):wu=0,Ns(),null}function Ul(){if(Cs!==null){var c=dw(Gd),u=Sa.transition,p=At;try{if(Sa.transition=null,At=16>c?16:c,Cs===null)var w=!1;else{if(c=Cs,Cs=null,Gd=0,(vt&6)!==0)throw Error(r(331));var _=vt;for(vt|=4,Ke=c.current;Ke!==null;){var A=Ke,R=A.child;if((Ke.flags&16)!==0){var ae=A.deletions;if(ae!==null){for(var ue=0;ue<ae.length;ue++){var Ne=ae[ue];for(Ke=Ne;Ke!==null;){var Oe=Ke;switch(Oe.tag){case 0:case 11:case 15:vu(8,Oe,A)}var De=Oe.child;if(De!==null)De.return=Oe,Ke=De;else for(;Ke!==null;){Oe=Ke;var Te=Oe.sibling,He=Oe.return;if(cS(Oe),Oe===Ne){Ke=null;break}if(Te!==null){Te.return=He,Ke=Te;break}Ke=He}}}var Xe=A.alternate;if(Xe!==null){var Ye=Xe.child;if(Ye!==null){Xe.child=null;do{var pr=Ye.sibling;Ye.sibling=null,Ye=pr}while(Ye!==null)}}Ke=A}}if((A.subtreeFlags&2064)!==0&&R!==null)R.return=A,Ke=R;else e:for(;Ke!==null;){if(A=Ke,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:vu(9,A,A.return)}var xe=A.sibling;if(xe!==null){xe.return=A.return,Ke=xe;break e}Ke=A.return}}var me=c.current;for(Ke=me;Ke!==null;){R=Ke;var ge=R.child;if((R.subtreeFlags&2064)!==0&&ge!==null)ge.return=R,Ke=ge;else e:for(R=me;Ke!==null;){if(ae=Ke,(ae.flags&2048)!==0)try{switch(ae.tag){case 0:case 11:case 15:Ud(9,ae)}}catch(Qe){cr(ae,ae.return,Qe)}if(ae===R){Ke=null;break e}var Re=ae.sibling;if(Re!==null){Re.return=ae.return,Ke=Re;break e}Ke=ae.return}}if(vt=_,Ns(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(si,c)}catch{}w=!0}return w}finally{At=p,Sa.transition=u}}return!1}function _S(c,u,p){u=Rl(p,u),u=W2(c,u,1),c=_s(c,u,1),u=Tn(),c!==null&&(Vc(c,1,u),Vn(c,u))}function cr(c,u,p){if(c.tag===3)_S(c,c,p);else for(;u!==null;){if(u.tag===3){_S(u,c,p);break}else if(u.tag===1){var w=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(js===null||!js.has(w))){c=Rl(p,c),c=H2(u,c,1),u=_s(u,c,1),c=Tn(),u!==null&&(Vc(u,1,c),Vn(u,c));break}}u=u.return}}function YF(c,u,p){var w=c.pingCache;w!==null&&w.delete(u),u=Tn(),c.pingedLanes|=c.suspendedLanes&p,Wr===c&&(nn&p)===p&&(Pr===4||Pr===3&&(nn&130023424)===nn&&500>Ie()-Zp?So(c,0):Qp|=p),Vn(c,u)}function kS(c,u){u===0&&((c.mode&1)===0?u=1:(u=rd,rd<<=1,(rd&130023424)===0&&(rd=4194304)));var p=Tn();c=Fi(c,u),c!==null&&(Vc(c,u,p),Vn(c,p))}function JF(c){var u=c.memoizedState,p=0;u!==null&&(p=u.retryLane),kS(c,p)}function QF(c,u){var p=0;switch(c.tag){case 13:var w=c.stateNode,_=c.memoizedState;_!==null&&(p=_.retryLane);break;case 19:w=c.stateNode;break;default:throw Error(r(314))}w!==null&&w.delete(u),kS(c,p)}var jS;jS=function(c,u,p){if(c!==null)if(c.memoizedProps!==u.pendingProps||Un.current)Wn=!0;else{if((c.lanes&p)===0&&(u.flags&128)===0)return Wn=!1,BF(c,u,p);Wn=(c.flags&131072)!==0}else Wn=!1,Jt&&(u.flags&1048576)!==0&&s2(u,Ed,u.index);switch(u.lanes=0,u.tag){case 2:var w=u.type;Bd(c,u),c=u.pendingProps;var _=Al(u,dn.current);Il(u,p),_=Tp(null,u,w,c,_,p);var A=Pp();return u.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,zn(w)?(A=!0,wd(u)):A=!1,u.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Np(u),_.updater=Rd,u.stateNode=_,_._reactInternals=u,Rp(u,w,c,p),u=Up(null,u,w,!0,A,p)):(u.tag=0,Jt&&A&&hp(u),An(null,u,_,p),u=u.child),u;case 16:w=u.elementType;e:{switch(Bd(c,u),c=u.pendingProps,_=w._init,w=_(w._payload),u.type=w,_=u.tag=e5(w),c=Ga(w,c),_){case 0:u=$p(null,u,w,c,p);break e;case 1:u=Z2(null,u,w,c,p);break e;case 11:u=q2(null,u,w,c,p);break e;case 14:u=X2(null,u,w,Ga(w.type,c),p);break e}throw Error(r(306,w,""))}return u;case 0:return w=u.type,_=u.pendingProps,_=u.elementType===w?_:Ga(w,_),$p(c,u,w,_,p);case 1:return w=u.type,_=u.pendingProps,_=u.elementType===w?_:Ga(w,_),Z2(c,u,w,_,p);case 3:e:{if(eS(u),c===null)throw Error(r(387));w=u.pendingProps,A=u.memoizedState,_=A.element,p2(c,u),Td(u,w,null,p);var R=u.memoizedState;if(w=R.element,A.isDehydrated)if(A={element:w,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},u.updateQueue.baseState=A,u.memoizedState=A,u.flags&256){_=Rl(Error(r(423)),u),u=tS(c,u,w,p,_);break e}else if(w!==_){_=Rl(Error(r(424)),u),u=tS(c,u,w,p,_);break e}else for(ra=bs(u.stateNode.containerInfo.firstChild),ta=u,Jt=!0,Va=null,p=h2(u,null,w,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Ol(),w===_){u=Ii(c,u,p);break e}An(c,u,w,p)}u=u.child}return u;case 5:return v2(u),c===null&&xp(u),w=u.type,_=u.pendingProps,A=c!==null?c.memoizedProps:null,R=_.children,op(w,_)?R=null:A!==null&&op(w,A)&&(u.flags|=32),Q2(c,u),An(c,u,R,p),u.child;case 6:return c===null&&xp(u),null;case 13:return rS(c,u,p);case 4:return Ep(u,u.stateNode.containerInfo),w=u.pendingProps,c===null?u.child=Fl(u,null,w,p):An(c,u,w,p),u.child;case 11:return w=u.type,_=u.pendingProps,_=u.elementType===w?_:Ga(w,_),q2(c,u,w,_,p);case 7:return An(c,u,u.pendingProps,p),u.child;case 8:return An(c,u,u.pendingProps.children,p),u.child;case 12:return An(c,u,u.pendingProps.children,p),u.child;case 10:e:{if(w=u.type._context,_=u.pendingProps,A=u.memoizedProps,R=_.value,zt(jd,w._currentValue),w._currentValue=R,A!==null)if(Ha(A.value,R)){if(A.children===_.children&&!Un.current){u=Ii(c,u,p);break e}}else for(A=u.child,A!==null&&(A.return=u);A!==null;){var ae=A.dependencies;if(ae!==null){R=A.child;for(var ue=ae.firstContext;ue!==null;){if(ue.context===w){if(A.tag===1){ue=Di(-1,p&-p),ue.tag=2;var Ne=A.updateQueue;if(Ne!==null){Ne=Ne.shared;var Oe=Ne.pending;Oe===null?ue.next=ue:(ue.next=Oe.next,Oe.next=ue),Ne.pending=ue}}A.lanes|=p,ue=A.alternate,ue!==null&&(ue.lanes|=p),wp(A.return,p,u),ae.lanes|=p;break}ue=ue.next}}else if(A.tag===10)R=A.type===u.type?null:A.child;else if(A.tag===18){if(R=A.return,R===null)throw Error(r(341));R.lanes|=p,ae=R.alternate,ae!==null&&(ae.lanes|=p),wp(R,p,u),R=A.sibling}else R=A.child;if(R!==null)R.return=A;else for(R=A;R!==null;){if(R===u){R=null;break}if(A=R.sibling,A!==null){A.return=R.return,R=A;break}R=R.return}A=R}An(c,u,_.children,p),u=u.child}return u;case 9:return _=u.type,w=u.pendingProps.children,Il(u,p),_=ba(_),w=w(_),u.flags|=1,An(c,u,w,p),u.child;case 14:return w=u.type,_=Ga(w,u.pendingProps),_=Ga(w.type,_),X2(c,u,w,_,p);case 15:return Y2(c,u,u.type,u.pendingProps,p);case 17:return w=u.type,_=u.pendingProps,_=u.elementType===w?_:Ga(w,_),Bd(c,u),u.tag=1,zn(w)?(c=!0,wd(u)):c=!1,Il(u,p),U2(u,w,_),Rp(u,w,_,p),Up(null,u,w,!0,c,p);case 19:return aS(c,u,p);case 22:return J2(c,u,p)}throw Error(r(156,u.tag))};function CS(c,u){return Fe(c,u)}function ZF(c,u,p,w){this.tag=c,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Na(c,u,p,w){return new ZF(c,u,p,w)}function ox(c){return c=c.prototype,!(!c||!c.isReactComponent)}function e5(c){if(typeof c=="function")return ox(c)?1:0;if(c!=null){if(c=c.$$typeof,c===L)return 11;if(c===Z)return 14}return 2}function Ps(c,u){var p=c.alternate;return p===null?(p=Na(c.tag,u,c.key,c.mode),p.elementType=c.elementType,p.type=c.type,p.stateNode=c.stateNode,p.alternate=c,c.alternate=p):(p.pendingProps=u,p.type=c.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=c.flags&14680064,p.childLanes=c.childLanes,p.lanes=c.lanes,p.child=c.child,p.memoizedProps=c.memoizedProps,p.memoizedState=c.memoizedState,p.updateQueue=c.updateQueue,u=c.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=c.sibling,p.index=c.index,p.ref=c.ref,p}function Yd(c,u,p,w,_,A){var R=2;if(w=c,typeof c=="function")ox(c)&&(R=1);else if(typeof c=="string")R=5;else e:switch(c){case P:return Eo(p.children,_,A,u);case M:R=8,_|=8;break;case D:return c=Na(12,p,u,_|2),c.elementType=D,c.lanes=A,c;case J:return c=Na(13,p,u,_),c.elementType=J,c.lanes=A,c;case se:return c=Na(19,p,u,_),c.elementType=se,c.lanes=A,c;case le:return Jd(p,_,A,u);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case W:R=10;break e;case F:R=9;break e;case L:R=11;break e;case Z:R=14;break e;case he:R=16,w=null;break e}throw Error(r(130,c==null?c:typeof c,""))}return u=Na(R,p,u,_),u.elementType=c,u.type=w,u.lanes=A,u}function Eo(c,u,p,w){return c=Na(7,c,w,u),c.lanes=p,c}function Jd(c,u,p,w){return c=Na(22,c,w,u),c.elementType=le,c.lanes=p,c.stateNode={isHidden:!1},c}function lx(c,u,p){return c=Na(6,c,null,u),c.lanes=p,c}function cx(c,u,p){return u=Na(4,c.children!==null?c.children:[],c.key,u),u.lanes=p,u.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},u}function t5(c,u,p,w,_){this.tag=u,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mm(0),this.expirationTimes=Mm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mm(0),this.identifierPrefix=w,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function ux(c,u,p,w,_,A,R,ae,ue){return c=new t5(c,u,p,ae,ue),u===1?(u=1,A===!0&&(u|=8)):u=0,A=Na(3,null,null,u),c.current=A,A.stateNode=c,A.memoizedState={element:w,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},Np(A),c}function r5(c,u,p){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:C,key:w==null?null:""+w,children:c,containerInfo:u,implementation:p}}function AS(c){if(!c)return Ss;c=c._reactInternals;e:{if(ne(c)!==c||c.tag!==1)throw Error(r(170));var u=c;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(zn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(r(171))}if(c.tag===1){var p=c.type;if(zn(p))return n2(c,p,u)}return u}function TS(c,u,p,w,_,A,R,ae,ue){return c=ux(p,w,!0,c,_,A,R,ae,ue),c.context=AS(null),p=c.current,w=Tn(),_=As(p),A=Di(w,_),A.callback=u??null,_s(p,A,_),c.current.lanes=_,Vc(c,_,w),Vn(c,w),c}function Qd(c,u,p,w){var _=u.current,A=Tn(),R=As(_);return p=AS(p),u.context===null?u.context=p:u.pendingContext=p,u=Di(A,R),u.payload={element:c},w=w===void 0?null:w,w!==null&&(u.callback=w),c=_s(_,u,R),c!==null&&(Xa(c,_,R,A),Ad(c,_,R)),R}function Zd(c){return c=c.current,c.child?(c.child.tag===5,c.child.stateNode):null}function PS(c,u){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var p=c.retryLane;c.retryLane=p!==0&&p<u?p:u}}function fx(c,u){PS(c,u),(c=c.alternate)&&PS(c,u)}function n5(){return null}var OS=typeof reportError=="function"?reportError:function(c){console.error(c)};function dx(c){this._internalRoot=c}e0.prototype.render=dx.prototype.render=function(c){var u=this._internalRoot;if(u===null)throw Error(r(409));Qd(c,u,null,null)},e0.prototype.unmount=dx.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var u=c.containerInfo;wo(function(){Qd(null,c,null,null)}),u[Ai]=null}};function e0(c){this._internalRoot=c}e0.prototype.unstable_scheduleHydration=function(c){if(c){var u=pw();c={blockedOn:null,target:c,priority:u};for(var p=0;p<gs.length&&u!==0&&u<gs[p].priority;p++);gs.splice(p,0,c),p===0&&vw(c)}};function hx(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function t0(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function FS(){}function a5(c,u,p,w,_){if(_){if(typeof w=="function"){var A=w;w=function(){var Ne=Zd(R);A.call(Ne)}}var R=TS(u,w,c,0,null,!1,!1,"",FS);return c._reactRootContainer=R,c[Ai]=R.current,iu(c.nodeType===8?c.parentNode:c),wo(),R}for(;_=c.lastChild;)c.removeChild(_);if(typeof w=="function"){var ae=w;w=function(){var Ne=Zd(ue);ae.call(Ne)}}var ue=ux(c,0,!1,null,null,!1,!1,"",FS);return c._reactRootContainer=ue,c[Ai]=ue.current,iu(c.nodeType===8?c.parentNode:c),wo(function(){Qd(u,ue,p,w)}),ue}function r0(c,u,p,w,_){var A=p._reactRootContainer;if(A){var R=A;if(typeof _=="function"){var ae=_;_=function(){var ue=Zd(R);ae.call(ue)}}Qd(u,R,c,_)}else R=a5(p,u,c,_,w);return Zd(R)}hw=function(c){switch(c.tag){case 3:var u=c.stateNode;if(u.current.memoizedState.isDehydrated){var p=Hc(u.pendingLanes);p!==0&&(Rm(u,p|1),Vn(u,Ie()),(vt&6)===0&&($l=Ie()+500,Ns()))}break;case 13:wo(function(){var w=Fi(c,1);if(w!==null){var _=Tn();Xa(w,c,1,_)}}),fx(c,1)}},Lm=function(c){if(c.tag===13){var u=Fi(c,134217728);if(u!==null){var p=Tn();Xa(u,c,134217728,p)}fx(c,134217728)}},mw=function(c){if(c.tag===13){var u=As(c),p=Fi(c,u);if(p!==null){var w=Tn();Xa(p,c,u,w)}fx(c,u)}},pw=function(){return At},xw=function(c,u){var p=At;try{return At=c,u()}finally{At=p}},tn=function(c,u,p){switch(u){case"input":if(Pe(c,p),u=p.name,p.type==="radio"&&u!=null){for(p=c;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<p.length;u++){var w=p[u];if(w!==c&&w.form===c.form){var _=yd(w);if(!_)throw Error(r(90));I(w),Pe(w,_)}}}break;case"textarea":Br(c,p);break;case"select":u=p.value,u!=null&&jt(c,!!p.multiple,u,!1)}},ji=ax,Zf=wo;var i5={usingClientEntryPoint:!1,Events:[lu,jl,yd,lo,$c,ax]},Su={findFiberByHostInstance:ho,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},s5={bundleType:Su.bundleType,version:Su.version,rendererPackageName:Su.rendererPackageName,rendererConfig:Su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=be(c),c===null?null:c.stateNode},findFiberByHostInstance:Su.findFiberByHostInstance||n5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var n0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!n0.isDisabled&&n0.supportsFiber)try{si=n0.inject(s5),Ur=n0}catch{}}return Gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=i5,Gn.createPortal=function(c,u){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hx(u))throw Error(r(200));return r5(c,u,null,p)},Gn.createRoot=function(c,u){if(!hx(c))throw Error(r(299));var p=!1,w="",_=OS;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(_=u.onRecoverableError)),u=ux(c,1,!1,null,null,p,!1,w,_),c[Ai]=u.current,iu(c.nodeType===8?c.parentNode:c),new dx(u)},Gn.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var u=c._reactInternals;if(u===void 0)throw typeof c.render=="function"?Error(r(188)):(c=Object.keys(c).join(","),Error(r(268,c)));return c=be(u),c=c===null?null:c.stateNode,c},Gn.flushSync=function(c){return wo(c)},Gn.hydrate=function(c,u,p){if(!t0(u))throw Error(r(200));return r0(null,c,u,!0,p)},Gn.hydrateRoot=function(c,u,p){if(!hx(c))throw Error(r(405));var w=p!=null&&p.hydratedSources||null,_=!1,A="",R=OS;if(p!=null&&(p.unstable_strictMode===!0&&(_=!0),p.identifierPrefix!==void 0&&(A=p.identifierPrefix),p.onRecoverableError!==void 0&&(R=p.onRecoverableError)),u=TS(u,null,c,1,p??null,_,!1,A,R),c[Ai]=u.current,iu(c),w)for(c=0;c<w.length;c++)p=w[c],_=p._getVersion,_=_(p._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[p,_]:u.mutableSourceEagerHydrationData.push(p,_);return new e0(u)},Gn.render=function(c,u,p){if(!t0(u))throw Error(r(200));return r0(null,c,u,!1,p)},Gn.unmountComponentAtNode=function(c){if(!t0(c))throw Error(r(40));return c._reactRootContainer?(wo(function(){r0(null,null,c,!1,function(){c._reactRootContainer=null,c[Ai]=null})}),!0):!1},Gn.unstable_batchedUpdates=ax,Gn.unstable_renderSubtreeIntoContainer=function(c,u,p,w){if(!t0(p))throw Error(r(200));if(c==null||c._reactInternals===void 0)throw Error(r(38));return r0(c,u,p,!1,w)},Gn.version="18.3.1-next-f1338f8080-20240426",Gn}var US;function f4(){if(US)return xx.exports;US=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),xx.exports=m5(),xx.exports}var zS;function p5(){if(zS)return a0;zS=1;var e=f4();return a0.createRoot=e.createRoot,a0.hydrateRoot=e.hydrateRoot,a0}var b1=p5();const x5=Ei(b1),yx=u4({__proto__:null,default:x5},[b1]);var g5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const v5=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),st=(e,t)=>{const r=k.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:l="",children:f,...d},h)=>k.createElement("svg",{ref:h,...g5,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:["lucide",`lucide-${v5(e)}`,l].join(" "),...d},[...t.map(([m,x])=>k.createElement(m,x)),...Array.isArray(f)?f:[f]]));return r.displayName=`${e}`,r};const uc=st("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const wi=st("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const M0=st("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const y5=st("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const b5=st("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);const Yi=st("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);const d4=st("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const w5=st("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);const zs=st("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const In=st("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const h4=st("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const S5=st("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);const Ji=st("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const w1=st("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const N5=st("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);const m4=st("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const R0=st("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const E5=st("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const L0=st("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);const tc=st("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const _5=st("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);const k5=st("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);const p4=st("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const B0=st("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);const j5=st("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);const C5=st("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const A5=st("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const mv=st("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const T5=st("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);const Ho=st("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);const S1=st("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const Vo=st("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const x4=st("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);const N1=st("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const Zs=st("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);const g4=st("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);const sl=st("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const $0=st("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const v4=st("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const P5=st("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);const Ws=st("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const WS=st("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);const fc=st("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const O5=st("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);const Hs=st("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const Go=st("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const Qi=st("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const F5=st("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);const Uh=st("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const eo=st("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),y4="entetesConfig",D5={eleves:{header:"Liste des lves",footer:"Signature du Directeur",logo:"",logoMinistere:"",pays:"Rpublique de Cte d'Ivoire",ministere:"Ministre de l'ducation Nationale et de l'Alphabtisation",etablissement:"Nom de l'tablissement",columns:["Matricule","Nom & Prnom","Date de naissance"],mention:!1},recu:{header:"Reu de paiement",footer:"Aucun remboursement n'est possible aprs encaissement.",logo:"",columns:["Nom","Montant","Date","Classe"]},transport:{header:"Fiche de renseignement transport",footer:"",logo:"",columns:["Nom","Classe","Montant","Versement"]}};function Vs(){try{const e=localStorage.getItem(y4);if(e)return JSON.parse(e)}catch{}return D5}function b4(e){return Vs()[e]}function Qu(e){localStorage.setItem(y4,JSON.stringify(e))}class Yl{static instance;constructor(){this.initializeDefaultData()}addHistorique(t){const r=this.getAll("historiques"),n=new Date().toISOString(),a=Object.assign({},t,{id:Date.now().toString()+Math.random().toString(36).substr(2,6),date:n,createdAt:n,updatedAt:n});return r.push(a),localStorage.setItem("historiques",JSON.stringify(r)),a}addParcoursAcademique(t){return this.create("parcoursAcademiques",t)}getParcoursAcademique(t){return this.getAll("parcoursAcademiques").filter(n=>n.eleveId===t).sort((n,a)=>new Date(n.dateDebut).getTime()-new Date(a.dateDebut).getTime())}updateParcoursEnCours(t,r,n){const i=this.getAll("parcoursAcademiques").find(s=>s.eleveId===t&&s.anneeScolaire===r&&s.statut==="En cours");return i?this.update("parcoursAcademiques",i.id,n):null}static getInstance(){return Yl.instance||(Yl.instance=new Yl),Yl.instance}initializeDefaultData(){if(["ecole","matieres","classes","enseignants","fraisScolaires","eleves","paiements","notes","moyennesGenerales","utilisateurs","compositions","historiques","compta","parcoursAcademiques"].forEach(r=>{localStorage.getItem(r)||localStorage.setItem(r,JSON.stringify([]))}),!localStorage.getItem("utilisateurs")){const r={id:"1",nom:"ADMIN",prenoms:"Systme",nomUtilisateur:"admin",role:"Admin",actif:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};localStorage.setItem("utilisateurs",JSON.stringify([r]))}if(!localStorage.getItem("ecole")||JSON.parse(localStorage.getItem("ecole")||"[]").length===0){const r=new Date().toISOString(),n={nom:"cole Primaire Excellence",codeEtablissement:"EPE2025",adresse:"Abidjan, Cte d'Ivoire",telephone:"+225 XX XX XX XX XX",email:"contact@ecole.ci",logo:"",devise:"FCFA",anneeScolaireActive:new Date().getFullYear()+"-"+(new Date().getFullYear()+1),compositions:[],createdAt:r,updatedAt:r};this.create("ecole",n)}try{const r=Vs(),n=this.getAll("ecole")?.[0];if(n){const a=r.eleves&&typeof r.eleves.etablissement=="string"?r.eleves.etablissement:"",i=r.recu&&typeof r.recu.etablissement=="string"?r.recu.etablissement:"",s=f=>!f||f.toLowerCase().includes("nom de")||f.toLowerCase().includes("tablissement");let l=!1;s(a)&&(r.eleves.etablissement=n.nom||r.eleves.etablissement,r.eleves.logo=n.logo||r.eleves.logo,l=!0),s(i)&&(r.recu.etablissement=n.nom||r.recu.etablissement||"",r.recu.logo=n.logo||r.recu.logo||"",l=!0),l&&Qu(r)}}catch{}}getAll(t){try{const r=localStorage.getItem(t);return r?JSON.parse(r):[]}catch(r){return console.error(`Erreur lors du chargement de ${t}:`,r),[]}}getById(t,r){return this.getAll(t).find(a=>a.id===r)||null}create(t,r){const n=this.getAll(t),a=new Date().toISOString(),i=Object.assign({},r,{id:this.generateId(),createdAt:a,updatedAt:a});n.push(i),localStorage.setItem(t,JSON.stringify(n));try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return i}update(t,r,n){const a=this.getAll(t),i=a.findIndex(s=>s.id===r);if(i!==-1){a[i]={...a[i],...n,updatedAt:new Date().toISOString()},localStorage.setItem(t,JSON.stringify(a));try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return a[i]}return null}delete(t,r){const n=this.getAll(t),a=n.filter(i=>i.id!==r);if(a.length!==n.length){localStorage.setItem(t,JSON.stringify(a));try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return!0}return!1}generateId(){return Date.now().toString()+Math.random().toString(36).substr(2,9)}generateMatricule(){const t=this.getAll("eleves"),r=new Date().getFullYear().toString().substr(2,2),n=(t.length+1).toString().padStart(4,"0");return`${r}${n}`}search(t,r,n){const a=this.getAll(t);if(!r)return a;const i=r.toLowerCase();return a.filter(s=>n.some(l=>{const f=s[l];return f&&f.toString().toLowerCase().includes(i)}))}exportData(){const t=["ecole","matieres","classes","enseignants","eleves","fraisScolaires","paiements","notes","moyennesGenerales","utilisateurs","compositions","historiques","compta","parcoursAcademiques"],r={};return t.forEach(n=>{r[n]=this.getAll(n)}),JSON.stringify(r,null,2)}importData(t){try{const r=JSON.parse(t);Object.entries(r).forEach(([n,a])=>{localStorage.setItem(n,JSON.stringify(a))});try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}return!0}catch(r){return console.error("Erreur lors de l'importation des donnes:",r),!1}}resetData(){localStorage.clear(),this.initializeDefaultData();try{window.dispatchEvent(new CustomEvent("dataChanged"))}catch{}}}const fe=Yl.getInstance(),I5=Object.freeze(Object.defineProperty({__proto__:null,db:fe},Symbol.toStringTag,{value:"Module"})),zl="klasnet_licence",HS="klasnet_last_check",bx="klasnet_time_check",VS=`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoI1o4BX9ixXBWDH+KRGv
L8YdNrzhmTUiy1fJKAqyiA+JT9NCh0fL1xhnLundf0sGbTN6Cd91OkKbxbzpa99S
uWNzd9ISVYZXFFgVfQfBAyUDcjCQxPiypQT9K4aLTJQqf0H4gh985VzvwiwCM0C9
b2NwlCN304JU949CLJhIaExhIuuP0uvYC0heNwp6HjHYClppEmLoEgM3xE6hj/jW
nTraasw8aUSuDqn0dnrxnhRT1pD0ADDVHxfzaUKA0jKmuv2uvBhNvUrWCl9FoyDd
A7nMXmDJG5pnTkKmnNA3eU4ArY1uZsRVYss7iOR6gUa4f/XV8FUhtz00irZC54fW
PwIDAQAB
-----END PUBLIC KEY-----`;class Jl{static instance;publicKeyPem;static getInstance(){return Jl.instance||(Jl.instance=new Jl(VS)),Jl.instance}constructor(t){this.publicKeyPem=t||VS}async verifyJwtAndGetPayload(t){const[r,n,a]=t.split(".");if(!r||!n||!a)throw new Error("Invalid JWT format");const s=new TextEncoder().encode(`${r}.${n}`),l=this.base64UrlToUint8Array(a),f=await this.importPublicKey(this.publicKeyPem);if(!await crypto.subtle.verify("RSASSA-PKCS1-v1_5",f,l,s))throw new Error("Invalid signature");const h=atob(n.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(h)}checkTimeManipulation(){try{const t=localStorage.getItem(bx),r=Date.now();if(t){const n=parseInt(t);if(r<n-3600*1e3)return console.warn("Manipulation de date dtecte"),!1}return localStorage.setItem(bx,r.toString()),!0}catch(t){return console.error("Erreur vrification anti-triche:",t),!1}}async checkLicenceStatus(){if(!this.checkTimeManipulation())return{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()};try{const t=localStorage.getItem(zl);if(!t)return this.createTrialLicence();if((t.match(/\./g)||[]).length===2)try{const r=await this.verifyJwtAndGetPayload(t),n=r.exp&&Number(r.exp)?new Date(Number(r.exp)*1e3):null,a=new Date,i=n?Math.ceil((n.getTime()-a.getTime())/(1e3*60*60*24)):0,s=this.getCurrentEcoleId(),l=r.sub||"";if(l&&!this.isEcoleMatch(l,s))return console.warn(`Licence sub mismatch: token for ${l} but this installation is ${s}`),{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()};const f={isValid:!!n&&i>0,isExpired:!n||i<=0,daysRemaining:Math.max(0,i),type:r.type||"inconnue",dateExpiration:n?n.toISOString():"",lastCheck:new Date().toISOString()};return localStorage.setItem(HS,f.lastCheck),f}catch(r){return console.warn("Licence JWT invalide ou signature incorrecte",r),{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()}}else try{const r=JSON.parse(atob(t));let n=null;r.exp&&(typeof r.exp=="number"?n=new Date(r.exp>1e12?r.exp:r.exp*1e3):n=new Date(r.exp));const a=new Date,i=n?Math.ceil((n.getTime()-a.getTime())/(1e3*60*60*24)):0;return{isValid:!!n&&i>0,isExpired:!n||i<=0,daysRemaining:Math.max(0,i),type:r.type||"essai",dateExpiration:n?n.toISOString():"",lastCheck:new Date().toISOString()}}catch{return{isValid:!1,isExpired:!0,daysRemaining:0,type:"invalide",dateExpiration:"",lastCheck:new Date().toISOString()}}}catch(t){return console.error("Erreur vrification licence:",t),{isValid:!1,isExpired:!0,daysRemaining:0,type:"erreur",dateExpiration:"",lastCheck:new Date().toISOString()}}}createTrialLicence(){const t=new Date,r=new Date(t.getTime()+10080*60*1e3),a={sub:"ECOLE_ESSAI_"+Date.now(),type:"essai",iat:Math.floor(t.getTime()/1e3),exp:r.toISOString()},i=btoa(JSON.stringify(a));return localStorage.setItem(zl,i),{isValid:!0,isExpired:!1,daysRemaining:7,type:"essai",dateExpiration:r.toISOString(),lastCheck:new Date().toISOString()}}activateLicence(t){return localStorage.setItem(zl,t),{success:!0,message:"Licence enregistre. Actualisez le statut pour vrifier la validit."}}async updateLicenceFromServer(){try{const t=await fetch("/api/licence/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentKey:localStorage.getItem(zl),ecoleId:this.getCurrentEcoleId()})});if(t.ok){const r=await t.json();if(r.newKey)return localStorage.setItem(zl,r.newKey),!0}}catch{console.log("Mise  jour licence impossible (hors ligne)")}return!1}getCurrentEcoleId(){return fe.getAll("ecole")[0]?.codeEtablissement||"ECOLE_DEFAULT"}normalizeId(t){return t?t.toString().toUpperCase().replace(/[^A-Z0-9]/g,""):""}hasCommonNumericSeq(t,r,n=4){const a=t.match(/\d+/g)||[],i=r.match(/\d+/g)||[];for(const s of a)for(const l of i){if(s===l&&s.length>=n)return!0;if(s.length>=n&&l.length>=n){const f=s.slice(-n),d=l.slice(-n);if(f===d)return!0}}return!1}isEcoleMatch(t,r){const n=this.normalizeId(t),a=this.normalizeId(r);if(!n||!a)return!1;if(n===a||n.includes(a)||a.includes(n)||this.hasCommonNumericSeq(n,a,4))return!0;const i=n.slice(-6),s=a.slice(-6);return!!(i&&s&&i===s)}resetLicence(){localStorage.removeItem(zl),localStorage.removeItem(HS),localStorage.removeItem(bx)}async importPublicKey(t){const r=t.replace(/-----BEGIN PUBLIC KEY-----|-----END PUBLIC KEY-----|\n/g,""),n=Uint8Array.from(atob(r),a=>a.charCodeAt(0));return await crypto.subtle.importKey("spki",n.buffer,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!1,["verify"])}base64UrlToUint8Array(t){let r=t.replace(/-/g,"+").replace(/_/g,"/");const n=r.length%4;n&&(r+="=".repeat(4-n));const a=atob(r),i=new Uint8Array(a.length);for(let s=0;s<a.length;++s)i[s]=a.charCodeAt(s);return i}}const $i=Jl.getInstance(),w4=k.createContext({showToast:()=>{}});function Jr(){return k.useContext(w4)}function M5({children:e}){const[t,r]=k.useState([]),n=(l,f="info")=>{const d=Date.now();r(h=>[...h,{id:d,type:f,message:l}]),setTimeout(()=>{r(h=>h.filter(m=>m.id!==d))},4e3)},a=l=>{r(f=>f.filter(d=>d.id!==l))},i=l=>{switch(l){case"success":return o.jsx(In,{className:"h-5 w-5 text-green-600"});case"error":return o.jsx(wi,{className:"h-5 w-5 text-red-600"});default:return o.jsx(p4,{className:"h-5 w-5 text-blue-600"})}},s=l=>{switch(l){case"success":return"bg-white border-green-200 text-green-800";case"error":return"bg-white border-red-200 text-red-800";default:return"bg-white border-blue-200 text-blue-800"}};return o.jsxs(w4.Provider,{value:{showToast:n},children:[e,o.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(l=>o.jsxs("div",{className:`flex items-center space-x-3 px-4 py-3 rounded-lg border shadow-lg max-w-sm ${s(l.type)}`,children:[i(l.type),o.jsx("span",{className:"flex-1 text-sm font-medium",children:l.message}),o.jsx("button",{onClick:()=>a(l.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(eo,{className:"h-4 w-4"})})]},l.id))})]})}function S4({onBack:e}={}){const{showToast:t}=Jr(),[r,n]=k.useState(null),[a,i]=k.useState({nom:"",codeEtablissement:"",adresse:"",telephone:"",email:"",logo:"",devise:"FCFA",anneeScolaireActive:new Date().getFullYear()+"-"+(new Date().getFullYear()+1)}),[s,l]=k.useState(!1),[f,d]=k.useState(()=>({}));k.useEffect(()=>{const x=fe.getAll("ecole")[0];x&&(n(x),i({nom:x.nom||"",codeEtablissement:x.codeEtablissement||"",adresse:x.adresse||"",telephone:x.telephone||"",email:x.email||"",logo:x.logo||"",devise:x.devise||"FCFA",anneeScolaireActive:x.anneeScolaireActive||new Date().getFullYear()+"-"+(new Date().getFullYear()+1)}))},[]);const h=x=>{const g=x.target.files?.[0];if(g){const y=new FileReader;y.onload=v=>{i(b=>({...b,logo:v.target?.result}))},y.readAsDataURL(g)}},m=async()=>{const x={};if((!a.nom||a.nom.trim().length<3)&&(x.nom="Entrez le nom complet de l'tablissement (min. 3 caractres)."),(!a.codeEtablissement||a.codeEtablissement.trim().length<2)&&(x.codeEtablissement="Entrez un code tablissement valide."),d(x),Object.keys(x).length>0){try{t("Veuillez corriger les erreurs du formulaire","error")}catch{}return}l(!0);try{if(r){const g=fe.update("ecole",r.id,a);if(g){n(g),t("Configuration de l'cole mise  jour","success");try{const y=Vs();y.eleves&&(y.eleves.etablissement=a.nom||y.eleves.etablissement,y.eleves.logo=a.logo||y.eleves.logo),y.recu&&(y.recu.etablissement=a.nom||y.recu.etablissement||"",y.recu.logo=a.logo||y.recu.logo),Qu(y)}catch{}}}else{const g=fe.create("ecole",a);n(g),t("Configuration de l'cole cre","success");try{window.dispatchEvent(new CustomEvent("ecole:created",{detail:{ecole:g}}))}catch{}try{$i.createTrialLicence&&$i.createTrialLicence()}catch{}try{const y=Vs();y.eleves&&(y.eleves.etablissement=a.nom||y.eleves.etablissement,y.eleves.logo=a.logo||y.eleves.logo),y.recu&&(y.recu.etablissement=a.nom||y.recu.etablissement||"",y.recu.logo=a.logo||y.recu.logo),Qu(y)}catch{}}}catch{t("Erreur lors de la sauvegarde","error")}finally{l(!1)}};return o.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e&&o.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors group",children:[o.jsx(M0,{className:"h-5 w-5 group-hover:-translate-x-1 transition-transform"}),o.jsx("span",{className:"font-medium",children:"Retour"})]}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(d4,{className:"h-6 w-6 text-gray-600"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Configuration de l'cole"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Paramtres gnraux et informations de l'tablissement"})]})]}),e&&o.jsxs("button",{onClick:e,className:"flex items-center justify-center space-x-2 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors sm:hidden",children:[o.jsx(M0,{className:"h-4 w-4"}),o.jsx("span",{children:"Retour"})]})]})}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Informations de l'tablissement"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Ces informations apparatront sur tous les documents imprims"})]}),o.jsxs("div",{className:"p-6 space-y-8",children:[o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"lg:col-span-1",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Logo de l'cole"}),o.jsx("div",{className:"relative",children:o.jsxs("div",{className:"w-full h-48 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center relative overflow-hidden group hover:border-gray-400 transition-colors",children:[a.logo?o.jsxs(o.Fragment,{children:[o.jsx("img",{src:a.logo,alt:"Logo cole",className:"w-full h-full object-contain"}),o.jsx("button",{onClick:()=>i(x=>({...x,logo:""})),className:"absolute top-2 right-2 p-1 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors",children:o.jsx(eo,{className:"h-4 w-4 text-gray-600"})})]}):o.jsxs("div",{className:"text-center",children:[o.jsx(Hs,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-gray-500 text-sm",children:"Cliquez pour ajouter un logo"}),o.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"PNG, JPG jusqu' 5MB"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:h,className:"absolute inset-0 opacity-0 cursor-pointer"})]})})]}),o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom complet de l'tablissement ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:x=>i(g=>({...g,nom:x.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"Ex: cole Primaire Excellence"}),f.nom&&o.jsx("div",{className:"text-sm text-red-600 mt-1",children:f.nom})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Code tablissement ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.codeEtablissement,onChange:x=>i(g=>({...g,codeEtablissement:x.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"Ex: ECOLE001, EPE2025..."}),f.codeEtablissement&&o.jsx("div",{className:"text-sm text-red-600 mt-1",children:f.codeEtablissement}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Code unique d'identification de votre tablissement"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Devise"}),o.jsxs("select",{value:a.devise,onChange:x=>i(g=>({...g,devise:x.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",children:[o.jsx("option",{value:"FCFA",children:"FCFA"}),o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"USD",children:"USD"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anne scolaire active"}),o.jsx("input",{type:"text",value:a.anneeScolaireActive,onChange:x=>i(g=>({...g,anneeScolaireActive:x.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"2025-2026"})]})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Coordonnes de contact"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tlphone"}),o.jsx("input",{type:"tel",value:a.telephone,onChange:x=>i(g=>({...g,telephone:x.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"+225 XX XX XX XX XX"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email (optionnel)"}),o.jsx("input",{type:"email",value:a.email,onChange:x=>i(g=>({...g,email:x.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"contact@ecole.ci"})]})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse complte"}),o.jsx("textarea",{value:a.adresse,onChange:x=>i(g=>({...g,adresse:x.target.value})),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors resize-none",placeholder:"Adresse complte de l'tablissement"})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Aperu sur les documents"}),o.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[a.logo&&o.jsx("img",{src:a.logo,alt:"Logo",className:"h-16 mx-auto mb-4"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("h4",{className:"text-xl font-bold text-gray-900",children:a.nom||"Nom de l'cole"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Code: ",a.codeEtablissement||"CODE_ECOLE"]}),o.jsx("p",{className:"text-gray-600",children:a.adresse||"Adresse de l'cole"}),o.jsxs("p",{className:"text-gray-600",children:[a.telephone||"Tlphone",a.email&&`  ${a.email}`]})]})]})})]}),o.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:o.jsxs("button",{onClick:m,disabled:s||Object.keys(f).length>0,className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 focus:ring-2 focus:ring-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[s?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Zs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:s?"Sauvegarde...":"Enregistrer la configuration"})]})})]})]})]})}function R5({children:e}){const[t,r]=k.useState(null),[n,a]=k.useState(!1),[i,s]=k.useState(""),[l,f]=k.useState(!1),[d,h]=k.useState(""),[m,x]=k.useState(!1);k.useEffect(()=>{g();const v=setInterval(g,3600*1e3),b=()=>{x(!1),g()};return window.addEventListener("ecole:created",b),()=>{clearInterval(v),window.removeEventListener("ecole:created",b)}},[]);const g=async()=>{await $i.updateLicenceFromServer();const v=await $i.checkLicenceStatus();r(v)},y=()=>{if(!i.trim()){h("Veuillez entrer une cl de licence");return}f(!0);try{const v=$i.activateLicence(i.trim());v.success?(h(v.message),s(""),setTimeout(()=>{a(!1),g()},2e3)):h(v.message)}catch{h("Erreur lors de l'activation de la licence")}finally{f(!1)}};return t?t.isValid&&!t.isExpired?o.jsxs(o.Fragment,{children:[e,t.daysRemaining<=7&&o.jsx("div",{className:"fixed bottom-4 right-4 bg-white border border-gray-200 rounded-lg shadow-lg p-4 max-w-sm",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(h4,{className:"h-5 w-5 text-amber-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold text-gray-900",children:"Licence expire bientt"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Plus que ",t.daysRemaining," jour(s)"]})]})]})})]}):m?o.jsx(S4,{onBack:()=>x(!1)}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 max-w-lg w-full",children:[o.jsxs("div",{className:"p-8 text-center border-b border-gray-200",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:o.jsx(v4,{className:"h-8 w-8 text-gray-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Licence Expire"}),o.jsx("p",{className:"text-gray-600",children:"Votre licence KlasNet a expir"})]}),o.jsxs("div",{className:"p-8 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[o.jsx(wi,{className:"h-5 w-5 text-red-600"}),o.jsx("h3",{className:"font-semibold text-gray-900",children:"Statut de la licence"})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Type:"}),o.jsx("span",{className:"font-medium text-gray-900 capitalize",children:t.type})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Expiration:"}),o.jsx("span",{className:"font-medium text-gray-900",children:t.dateExpiration?new Date(t.dateExpiration).toLocaleDateString("fr-FR"):"Non dfinie"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Jours restants:"}),o.jsx("span",{className:"font-bold text-red-600",children:t.daysRemaining})]})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:()=>x(!0),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[o.jsx($0,{className:"h-5 w-5"}),o.jsx("span",{children:"Configurer l'application"})]}),o.jsxs("button",{onClick:()=>a(!n),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:[o.jsx(B0,{className:"h-5 w-5"}),o.jsx("span",{children:"Activer une nouvelle licence"})]})]}),n&&o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Activation manuelle"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cl de licence"}),o.jsx("textarea",{value:i,onChange:v=>s(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors resize-none font-mono text-sm",rows:4,placeholder:"Collez votre cl de licence ici..."})]}),d&&o.jsx("div",{className:`p-4 rounded-lg ${d.includes("succs")?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:o.jsxs("div",{className:"flex items-center space-x-2",children:[d.includes("succs")?o.jsx(In,{className:"h-5 w-5"}):o.jsx(wi,{className:"h-5 w-5"}),o.jsx("span",{className:"text-sm",children:d})]})}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:()=>{a(!1),s(""),h("")},className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:y,disabled:l||!i.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:[l?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(B0,{className:"h-4 w-4"}),o.jsx("span",{children:l?"Activation...":"Activer"})]})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Besoin d'une licence ?"}),o.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Tlphone:"})," +2250555863953"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Email:"})," Non disponible"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Site web:"})," Non disponible"]})]})]})]}),o.jsx("div",{className:"bg-gray-50 px-8 py-4 text-center border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-gray-500",children:" 2025 KlasNet - Logiciel de Gestion Scolaire"})})]})}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 max-w-md w-full mx-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Vrification de la licence"}),o.jsx("p",{className:"text-gray-600",children:"Veuillez patienter..."})]})})})}const E1="current_user_id";function zh(){const e=fe.getAll("utilisateurs"),t={"poupouya@ecole.local":"eyemon2024",directeur:"director2024",enseignant:"teacher2024",poupouya:"eyemon2024"};try{window.localStorage.setItem("__pw_map__",JSON.stringify(t)),console.log("Mots de passe forcs:",t)}catch(l){console.error("Erreur stockage mots de passe:",l)}const r=["poupouya@ecole.local","directeur","enseignant","poupouya"],n=e.map(l=>l.nomUtilisateur),a=r.filter(l=>!n.includes(l)),i=new Date().toISOString();[{nom:"POUPOUYA",prenoms:"Mme",nomUtilisateur:"poupouya@ecole.local",role:"Secrtaire",actif:!0},{nom:"POUPOUYA",prenoms:"Mme",nomUtilisateur:"poupouya",role:"Secrtaire",actif:!0},{nom:"DIRECTEUR",prenoms:"M.",nomUtilisateur:"directeur",role:"Admin",actif:!0},{nom:"ENSEIGNANT",prenoms:"M.",nomUtilisateur:"enseignant",role:"Enseignant",actif:!0},{nom:"TEACHER",prenoms:"Prof",nomUtilisateur:"teacher",role:"Enseignant",actif:!0}].forEach(l=>{a.includes(l.nomUtilisateur)&&(console.log("Cration utilisateur:",l.nomUtilisateur),fe.create("utilisateurs",{...l,createdAt:i}))})}function N4(e,t){zh();const r={"poupouya@ecole.local":"eyemon2024",directeur:"director2024",enseignant:"teacher2024",poupouya:"eyemon2024"};try{window.localStorage.setItem("__pw_map__",JSON.stringify(r))}catch(s){console.error("Erreur stockage mots de passe:",s)}const n=r;if(console.log("Tentative de connexion:",e),console.log("Mots de passe disponibles:",Object.keys(n)),console.log("Mot de passe fourni:",t),console.log("Mot de passe attendu:",n[e]),n[e]!==t)return null;const i=fe.getAll("utilisateurs").find(s=>s.nomUtilisateur===e&&s.actif)||null;if(console.log("Utilisateur trouv:",i),i){try{window.localStorage.setItem(E1,i.id)}catch{}return i}return null}function _1(){try{window.localStorage.removeItem(E1)}catch{}}function Ja(){zh();try{const e=window.localStorage.getItem(E1);return e?fe.getById("utilisateurs",e):null}catch{return null}}function E4(e,t,r){try{const n=JSON.parse(String(window.localStorage.getItem("__pw_map__")||"{}"));return typeof r<"u"&&n[e]!==r?!1:(n[e]=t,window.localStorage.setItem("__pw_map__",JSON.stringify(n)),!0)}catch{return!1}}function _4(e,t,r){try{const n=JSON.parse(String(window.localStorage.getItem("__pw_map__")||"{}"));if(n[t]||typeof r<"u"&&n[e]!==r)return!1;const i=fe.getAll("utilisateurs").find(s=>s.nomUtilisateur===e);return i?(fe.update("utilisateurs",i.id,{nomUtilisateur:t}),n[e]&&(n[t]=n[e],delete n[e],window.localStorage.setItem("__pw_map__",JSON.stringify(n))),!0):!1}catch{return!1}}const Ls={seedUsers:zh,login:N4,logout:_1,getCurrentUser:Ja,changePassword:E4,changeUsername:_4},GS=Object.freeze(Object.defineProperty({__proto__:null,changePassword:E4,changeUsername:_4,default:Ls,getCurrentUser:Ja,login:N4,logout:_1,seedUsers:zh},Symbol.toStringTag,{value:"Module"}));function Bt(e){if(!e)return"";const t=(e.nom||"").toString().trim(),r=(e.prenoms||"").toString().trim();return!t&&!r?"":t?r?`${t} ${r}`:t:r}function O0(e){if(!e)return"";const t=(e.nom||"").toString().trim(),r=(e.prenoms||"").toString().trim();return!t&&!r?"":r?`${r} ${t}`:t}function L5({onLogin:e}){const[t,r]=k.useState(""),[n,a]=k.useState(""),[i,s]=k.useState(!1),[l,f]=k.useState(!1),{showToast:d}=Jr(),h=async m=>{if(m.preventDefault(),!t||!n){d("Veuillez remplir tous les champs","error");return}f(!0);try{const x=Ls.login(t,n);x?(d(`Bienvenue ${Bt(x)}`,"success"),e(x)):d("Nom d'utilisateur ou mot de passe incorrect","error")}catch{d("Erreur de connexion","error")}finally{f(!1)}};return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 w-full max-w-md",children:[o.jsxs("div",{className:"p-8 text-center border-b border-gray-200",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-900 rounded-lg flex items-center justify-center mx-auto mb-4",children:o.jsx(g4,{className:"h-8 w-8 text-white"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"KlasNet"}),o.jsx("p",{className:"text-gray-600",children:"Gestion Scolaire"})]}),o.jsx("div",{className:"p-8",children:o.jsxs("form",{onSubmit:h,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom d'utilisateur"}),o.jsxs("div",{className:"relative",children:[o.jsx(Go,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:t,onChange:m=>r(m.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"votre_nom_utilisateur",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(C5,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:i?"text":"password",value:n,onChange:m=>a(m.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors",placeholder:"",required:!0}),o.jsx("button",{type:"button",onClick:()=>s(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?o.jsx(N5,{className:"h-5 w-5"}):o.jsx(m4,{className:"h-5 w-5"})})]})]}),o.jsx("button",{type:"submit",disabled:l,className:"w-full bg-gray-900 text-white py-3 px-4 rounded-lg font-medium hover:bg-gray-800 focus:ring-2 focus:ring-gray-900 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Connexion..."]}):"Se connecter"})]})}),o.jsx("div",{className:"bg-gray-50 px-8 py-4 text-center border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-gray-500",children:" 2025 KlasNet - Gestion Scolaire Cte d'Ivoire"})})]})})}function B5({currentUser:e,onLogout:t,onNavigate:r,currentPage:n,onShowGuide:a}){const[i,s]=k.useState(new Date),[l,f]=k.useState(!1),[d,h]=k.useState(!1),m=k.useRef(null),x=v=>v?v.charAt(0).toUpperCase()+v.slice(1).toLowerCase():"";k.useEffect(()=>{const v=setInterval(()=>s(new Date),1e3);return()=>clearInterval(v)},[]),k.useEffect(()=>{const v=E=>{const N=E.target;m.current&&!m.current.contains(N)&&f(!1)},b=E=>{E.key==="Escape"&&f(!1)};return document.addEventListener("mousedown",v),document.addEventListener("keydown",b),()=>{document.removeEventListener("mousedown",v),document.removeEventListener("keydown",b)}},[]);const g=[{id:"dashboard",label:"Tableau de bord"},{id:"eleves",label:"lves"},{id:"enseignants",label:"Enseignants"},{id:"classes",label:"Classes"},{id:"matieres",label:"Matires"},{id:"finances",label:"Finances"},{id:"recouvrement",label:"Recouvrement"},{id:"notes",label:"Notes"},{id:"config",label:"Configuration"},{id:"comptabilite",label:"Comptabilit"}],y=()=>f(v=>!v);return o.jsxs("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:[o.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-900 rounded-lg flex items-center justify-center",children:o.jsx(g4,{className:"h-5 w-5 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"KlasNet"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Gestion Scolaire"})]})]}),o.jsx("div",{className:"hidden lg:block bg-gray-50 px-3 py-1 rounded-md border border-gray-200",children:o.jsx("div",{className:"text-xs text-gray-500",children:i.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})})]}),o.jsx("nav",{className:"hidden md:flex space-x-1",children:g.map(v=>o.jsx("button",{onClick:()=>{try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:v.id}}))}catch{r(v.id)}},className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${n===v.id?"bg-gray-900 text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:v.label},v.id))}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{className:"hidden md:block px-3 py-1 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",onClick:()=>a&&a(),children:"Guide"}),o.jsxs("div",{className:"relative",ref:m,children:[o.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 px-3 py-2 rounded-md transition-colors",onClick:y,children:[e&&e.avatar?o.jsx("img",{src:e.avatar,alt:"avatar",className:"h-8 w-8 rounded-full object-cover border border-gray-200"}):o.jsx("div",{className:"h-8 w-8 bg-gray-100 rounded-full flex items-center justify-center border border-gray-200",children:o.jsx(Go,{className:"h-4 w-4 text-gray-500"})}),o.jsxs("div",{className:"hidden sm:block text-sm text-gray-700",children:[o.jsx("div",{className:"font-medium",children:Bt(e)}),o.jsx("div",{className:"text-xs text-gray-500",children:x(e?.role)})]})]}),l&&o.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-md shadow-lg z-50",children:[o.jsx("button",{onClick:()=>{f(!1);try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"profil"}}))}catch{r("profil")}},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Profil"}),o.jsx("button",{onClick:()=>{f(!1);try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"parametres"}}))}catch{r("parametres")}},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Paramtres"}),o.jsx("div",{className:"border-t border-gray-200"}),o.jsx("button",{onClick:t,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Dconnexion"})]})]}),o.jsx("button",{className:"md:hidden p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors",onClick:()=>h(!d),children:d?o.jsx(eo,{className:"h-5 w-5"}):o.jsx(T5,{className:"h-5 w-5"})})]})]})}),d&&o.jsx("div",{className:"md:hidden border-t border-gray-200 bg-white",children:o.jsxs("div",{className:"px-4 py-2 space-y-1",children:[g.map(v=>o.jsx("button",{onClick:()=>{try{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:v.id}}))}catch{r(v.id)}h(!1)},className:`w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors ${n===v.id?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-50"}`,children:v.label},v.id)),o.jsx("button",{className:"w-full text-left px-3 py-2 text-sm text-gray-600 hover:bg-gray-50 rounded-md transition-colors",onClick:()=>{a&&a(),h(!1)},children:"Guide"})]})})]})}function kf({open:e,title:t="Quitter sans sauvegarder ?",description:r="Vous avez des modifications non sauvegardes. Voulez-vous vraiment quitter et perdre vos changements ?",onConfirm:n,onCancel:a}){return e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),o.jsx("p",{className:"text-sm text-gray-600 mt-2",children:r}),o.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[o.jsx("button",{onClick:a,className:"px-4 py-2 rounded-md bg-gray-100 text-gray-700",children:"Retour"}),o.jsx("button",{onClick:n,className:"px-4 py-2 rounded-md bg-red-600 text-white",children:"Quitter sans sauvegarder"})]})]})}):null}function k4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=k4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function bt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=k4(e))&&(n&&(n+=" "),n+=t);return n}var wx={},Sx={},KS;function $5(){return KS||(KS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Sx)),Sx}var Nx={},qS;function j4(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Nx)),Nx}var Ex={},XS;function C4(){return XS||(XS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Ex)),Ex}var _x={},YS;function k1(){return YS||(YS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],a=r.length;if(a===0)return n;let i=0,s="",l="",f=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const d=r[i];l?d==="\\"&&i+1<a?(i++,s+=r[i]):d===l?l="":s+=d:f?d==='"'||d==="'"?l=d:d==="]"?(f=!1,n.push(s),s=""):s+=d:d==="["?(f=!0,s&&(n.push(s),s="")):d==="."?s&&(n.push(s),s=""):s+=d,i++}return s&&n.push(s),n}e.toPath=t})(_x)),_x}var JS;function j1(){return JS||(JS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$5(),r=j4(),n=C4(),a=k1();function i(l,f,d){if(l==null)return d;switch(typeof f){case"string":{if(t.isUnsafeProperty(f))return d;const h=l[f];return h===void 0?r.isDeepKey(f)?i(l,a.toPath(f),d):d:h}case"number":case"symbol":{typeof f=="number"&&(f=n.toKey(f));const h=l[f];return h===void 0?d:h}default:{if(Array.isArray(f))return s(l,f,d);if(Object.is(f?.valueOf(),-0)?f="-0":f=String(f),t.isUnsafeProperty(f))return d;const h=l[f];return h===void 0?d:h}}}function s(l,f,d){if(f.length===0)return d;let h=l;for(let m=0;m<f.length;m++){if(h==null||t.isUnsafeProperty(f[m]))return d;h=h[f[m]]}return h===void 0?d:h}e.get=i})(wx)),wx}var kx,QS;function U5(){return QS||(QS=1,kx=j1().get),kx}var z5=U5();const Ko=Ei(z5);var jx={exports:{}},Mt={};var ZS;function W5(){if(ZS)return Mt;ZS=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function y(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case r:case a:case n:case f:case d:case x:return v;default:switch(v=v&&v.$$typeof,v){case s:case l:case m:case h:return v;case i:return v;default:return b}}case t:return b}}}return Mt.ContextConsumer=i,Mt.ContextProvider=s,Mt.Element=e,Mt.ForwardRef=l,Mt.Fragment=r,Mt.Lazy=m,Mt.Memo=h,Mt.Portal=t,Mt.Profiler=a,Mt.StrictMode=n,Mt.Suspense=f,Mt.SuspenseList=d,Mt.isContextConsumer=function(v){return y(v)===i},Mt.isContextProvider=function(v){return y(v)===s},Mt.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},Mt.isForwardRef=function(v){return y(v)===l},Mt.isFragment=function(v){return y(v)===r},Mt.isLazy=function(v){return y(v)===m},Mt.isMemo=function(v){return y(v)===h},Mt.isPortal=function(v){return y(v)===t},Mt.isProfiler=function(v){return y(v)===a},Mt.isStrictMode=function(v){return y(v)===n},Mt.isSuspense=function(v){return y(v)===f},Mt.isSuspenseList=function(v){return y(v)===d},Mt.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===r||v===a||v===n||v===f||v===d||typeof v=="object"&&v!==null&&(v.$$typeof===m||v.$$typeof===h||v.$$typeof===s||v.$$typeof===i||v.$$typeof===l||v.$$typeof===g||v.getModuleId!==void 0)},Mt.typeOf=y,Mt}var eN;function H5(){return eN||(eN=1,jx.exports=W5()),jx.exports}var V5=H5(),qr=e=>e===0?0:e>0?1:-1,ha=e=>typeof e=="number"&&e!=+e,Po=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,et=e=>(typeof e=="number"||e instanceof Number)&&!ha(e),Si=e=>et(e)||typeof e=="string",G5=0,Zu=e=>{var t=++G5;return"".concat(e||"").concat(t)},En=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!et(t)&&typeof t!="string")return n;var i;if(Po(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return ha(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},A4=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function un(e,t,r){return et(e)&&et(t)?e+r*(t-e):t}function K5(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Ko(n,t))===r)}var Yr=e=>e===null||typeof e>"u",jf=e=>Yr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),q5=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function C1(e){if(typeof e!="string")return!1;var t=q5;return t.includes(e)}var X5=["viewBox","children"],tN=["points","pathLength"],Cx={svg:X5,polygon:tN,polyline:tN},Y5=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(k.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{C1(a)&&(n[a]=(i=>r[a](r,i)))}),n},J5=(e,t,r)=>n=>(e(t,r,n),null),Cf=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];C1(a)&&typeof i=="function"&&(n||(n={}),n[a]=J5(i,t,r))}),n},Q5=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function T4(e){if(typeof e!="string")return!1;var t=Q5;return t.includes(e)}function to(e){var t=Object.entries(e).filter(r=>{var[n]=r;return T4(n)});return Object.fromEntries(t)}var rN=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",nN=null,Ax=null,P4=e=>{if(e===nN&&Array.isArray(Ax))return Ax;var t=[];return k.Children.forEach(e,r=>{Yr(r)||(V5.isFragment(r)?t=t.concat(P4(r.props.children)):t.push(r))}),Ax=t,nN=e,t};function A1(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>rN(a)):n=[rN(t)],P4(e).forEach(a=>{var i=Ko(a,"type.displayName")||Ko(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var Z5=(e,t,r,n)=>{var a;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(a=n&&Cx?.[n])!==null&&a!==void 0?a:[],s=t.startsWith("data-"),l=typeof e!="function"&&(!!n&&i.includes(t)||T4(t)),f=!!r&&C1(t);return s||l||f},Dr=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(k.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var s;Z5((s=n)===null||s===void 0?void 0:s[i],i,t,r)&&(a[i]=n[i])}),a},eD=["children","width","height","viewBox","className","style","title","desc"];function pv(){return pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pv.apply(null,arguments)}function tD(e,t){if(e==null)return{};var r,n,a=rD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var T1=k.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:l,title:f,desc:d}=e,h=tD(e,eD),m=i||{width:n,height:a,x:0,y:0},x=bt("recharts-surface",s);return k.createElement("svg",pv({},Dr(h,!0,"svg"),{className:x,width:n,height:a,style:l,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),k.createElement("title",null,f),k.createElement("desc",null,d),r)}),nD=["children","className"];function xv(){return xv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xv.apply(null,arguments)}function aD(e,t){if(e==null)return{};var r,n,a=iD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function iD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Qn=k.forwardRef((e,t)=>{var{children:r,className:n}=e,a=aD(e,nD),i=bt("recharts-layer",n);return k.createElement("g",xv({className:i},Dr(a,!0),{ref:t}),r)}),O4=f4(),F4=k.createContext(null),sD=()=>k.useContext(F4);function Wt(e){return function(){return e}}const D4=Math.cos,U0=Math.sin,ai=Math.sqrt,z0=Math.PI,Wh=2*z0,gv=Math.PI,vv=2*gv,ko=1e-6,oD=vv-ko;function I4(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function lD(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return I4;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class cD{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?I4:lD(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,f=n-t,d=a-r,h=s-t,m=l-r,x=h*h+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(x>ko)if(!(Math.abs(m*f-d*h)>ko)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-s,y=a-l,v=f*f+d*d,b=g*g+y*y,E=Math.sqrt(v),N=Math.sqrt(x),S=i*Math.tan((gv-Math.acos((v+x-b)/(2*E*N)))/2),j=S/N,T=S/E;Math.abs(j-1)>ko&&this._append`L${t+j*h},${r+j*m}`,this._append`A${i},${i},0,0,${+(m*g>h*y)},${this._x1=t+T*f},${this._y1=r+T*d}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),f=n*Math.sin(a),d=t+l,h=r+f,m=1^s,x=s?a-i:i-a;this._x1===null?this._append`M${d},${h}`:(Math.abs(this._x1-d)>ko||Math.abs(this._y1-h)>ko)&&this._append`L${d},${h}`,n&&(x<0&&(x=x%vv+vv),x>oD?this._append`A${n},${n},0,1,${m},${t-l},${r-f}A${n},${n},0,1,${m},${this._x1=d},${this._y1=h}`:x>ko&&this._append`A${n},${n},0,${+(x>=gv)},${m},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function P1(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new cD(t)}function O1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function M4(e){this._context=e}M4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Hh(e){return new M4(e)}function R4(e){return e[0]}function L4(e){return e[1]}function B4(e,t){var r=Wt(!0),n=null,a=Hh,i=null,s=P1(l);e=typeof e=="function"?e:e===void 0?R4:Wt(e),t=typeof t=="function"?t:t===void 0?L4:Wt(t);function l(f){var d,h=(f=O1(f)).length,m,x=!1,g;for(n==null&&(i=a(g=s())),d=0;d<=h;++d)!(d<h&&r(m=f[d],d,f))===x&&((x=!x)?i.lineStart():i.lineEnd()),x&&i.point(+e(m,d,f),+t(m,d,f));if(g)return i=null,g+""||null}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Wt(+f),l):e},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Wt(+f),l):t},l.defined=function(f){return arguments.length?(r=typeof f=="function"?f:Wt(!!f),l):r},l.curve=function(f){return arguments.length?(a=f,n!=null&&(i=a(n)),l):a},l.context=function(f){return arguments.length?(f==null?n=i=null:i=a(n=f),l):n},l}function i0(e,t,r){var n=null,a=Wt(!0),i=null,s=Hh,l=null,f=P1(d);e=typeof e=="function"?e:e===void 0?R4:Wt(+e),t=typeof t=="function"?t:Wt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?L4:Wt(+r);function d(m){var x,g,y,v=(m=O1(m)).length,b,E=!1,N,S=new Array(v),j=new Array(v);for(i==null&&(l=s(N=f())),x=0;x<=v;++x){if(!(x<v&&a(b=m[x],x,m))===E)if(E=!E)g=x,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),y=x-1;y>=g;--y)l.point(S[y],j[y]);l.lineEnd(),l.areaEnd()}E&&(S[x]=+e(b,x,m),j[x]=+t(b,x,m),l.point(n?+n(b,x,m):S[x],r?+r(b,x,m):j[x]))}if(N)return l=null,N+""||null}function h(){return B4().defined(a).curve(s).context(i)}return d.x=function(m){return arguments.length?(e=typeof m=="function"?m:Wt(+m),n=null,d):e},d.x0=function(m){return arguments.length?(e=typeof m=="function"?m:Wt(+m),d):e},d.x1=function(m){return arguments.length?(n=m==null?null:typeof m=="function"?m:Wt(+m),d):n},d.y=function(m){return arguments.length?(t=typeof m=="function"?m:Wt(+m),r=null,d):t},d.y0=function(m){return arguments.length?(t=typeof m=="function"?m:Wt(+m),d):t},d.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:Wt(+m),d):r},d.lineX0=d.lineY0=function(){return h().x(e).y(t)},d.lineY1=function(){return h().x(e).y(r)},d.lineX1=function(){return h().x(n).y(t)},d.defined=function(m){return arguments.length?(a=typeof m=="function"?m:Wt(!!m),d):a},d.curve=function(m){return arguments.length?(s=m,i!=null&&(l=s(i)),d):s},d.context=function(m){return arguments.length?(m==null?i=l=null:l=s(i=m),d):i},d}class $4{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function uD(e){return new $4(e,!0)}function fD(e){return new $4(e,!1)}const F1={draw(e,t){const r=ai(t/z0);e.moveTo(r,0),e.arc(0,0,r,0,Wh)}},dD={draw(e,t){const r=ai(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},U4=ai(1/3),hD=U4*2,mD={draw(e,t){const r=ai(t/hD),n=r*U4;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},pD={draw(e,t){const r=ai(t),n=-r/2;e.rect(n,n,r,r)}},xD=.8908130915292852,z4=U0(z0/10)/U0(7*z0/10),gD=U0(Wh/10)*z4,vD=-D4(Wh/10)*z4,yD={draw(e,t){const r=ai(t*xD),n=gD*r,a=vD*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=Wh*i/5,l=D4(s),f=U0(s);e.lineTo(f*r,-l*r),e.lineTo(l*n-f*a,f*n+l*a)}e.closePath()}},Tx=ai(3),bD={draw(e,t){const r=-ai(t/(Tx*3));e.moveTo(0,r*2),e.lineTo(-Tx*r,-r),e.lineTo(Tx*r,-r),e.closePath()}},Ea=-.5,_a=ai(3)/2,yv=1/ai(12),wD=(yv/2+1)*3,SD={draw(e,t){const r=ai(t/wD),n=r/2,a=r*yv,i=n,s=r*yv+r,l=-i,f=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,f),e.lineTo(Ea*n-_a*a,_a*n+Ea*a),e.lineTo(Ea*i-_a*s,_a*i+Ea*s),e.lineTo(Ea*l-_a*f,_a*l+Ea*f),e.lineTo(Ea*n+_a*a,Ea*a-_a*n),e.lineTo(Ea*i+_a*s,Ea*s-_a*i),e.lineTo(Ea*l+_a*f,Ea*f-_a*l),e.closePath()}};function ND(e,t){let r=null,n=P1(a);e=typeof e=="function"?e:Wt(e||F1),t=typeof t=="function"?t:Wt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Wt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Wt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function W0(){}function H0(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function W4(e){this._context=e}W4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:H0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:H0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ED(e){return new W4(e)}function H4(e){this._context=e}H4.prototype={areaStart:W0,areaEnd:W0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:H0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function _D(e){return new H4(e)}function V4(e){this._context=e}V4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:H0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kD(e){return new V4(e)}function G4(e){this._context=e}G4.prototype={areaStart:W0,areaEnd:W0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function jD(e){return new G4(e)}function aN(e){return e<0?-1:1}function iN(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(aN(i)+aN(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function sN(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Px(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function V0(e){this._context=e}V0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Px(this,this._t0,sN(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Px(this,sN(this,r=iN(this,e,t)),r);break;default:Px(this,this._t0,r=iN(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function K4(e){this._context=new q4(e)}(K4.prototype=Object.create(V0.prototype)).point=function(e,t){V0.prototype.point.call(this,t,e)};function q4(e){this._context=e}q4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function CD(e){return new V0(e)}function AD(e){return new K4(e)}function X4(e){this._context=e}X4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=oN(e),a=oN(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function oN(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function TD(e){return new X4(e)}function Vh(e,t){this._context=e,this._t=t}Vh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function PD(e){return new Vh(e,.5)}function OD(e){return new Vh(e,0)}function FD(e){return new Vh(e,1)}function dc(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function bv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function DD(e,t){return e[t]}function ID(e){const t=[];return t.key=e,t}function MD(){var e=Wt([]),t=bv,r=dc,n=DD;function a(i){var s=Array.from(e.apply(this,arguments),ID),l,f=s.length,d=-1,h;for(const m of i)for(l=0,++d;l<f;++l)(s[l][d]=[0,+n(m,s[l].key,d,i)]).data=m;for(l=0,h=O1(t(s));l<f;++l)s[h[l]].index=l;return r(s,h),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Wt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Wt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?bv:typeof i=="function"?i:Wt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??dc,a):r},a}function RD(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}dc(e,t)}}function LD(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}dc(e,t)}}function BD(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,f=0,d=0;l<s;++l){for(var h=e[t[l]],m=h[n][1]||0,x=h[n-1][1]||0,g=(m-x)/2,y=0;y<l;++y){var v=e[t[y]],b=v[n][1]||0,E=v[n-1][1]||0;g+=b-E}f+=m,d+=g*m}a[n-1][1]+=a[n-1][0]=r,f&&(r-=d/f)}a[n-1][1]+=a[n-1][0]=r,dc(e,t)}}var $D=["type","size","sizeType"];function wv(){return wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wv.apply(null,arguments)}function lN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lN(Object(r),!0).forEach(function(n){UD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UD(e,t,r){return(t=zD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zD(e){var t=WD(e,"string");return typeof t=="symbol"?t:t+""}function WD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HD(e,t){if(e==null)return{};var r,n,a=VD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Y4={symbolCircle:F1,symbolCross:dD,symbolDiamond:mD,symbolSquare:pD,symbolStar:yD,symbolTriangle:bD,symbolWye:SD},GD=Math.PI/180,KD=e=>{var t="symbol".concat(jf(e));return Y4[t]||F1},qD=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*GD;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},XD=(e,t)=>{Y4["symbol".concat(jf(e))]=t},D1=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=HD(e,$D),i=cN(cN({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var l=()=>{var x=KD(s),g=ND().type(x).size(qD(r,n,s));return g()},{className:f,cx:d,cy:h}=i,m=Dr(i,!0);return d===+d&&h===+h&&r===+r?k.createElement("path",wv({},m,{className:bt("recharts-symbols",f),transform:"translate(".concat(d,", ").concat(h,")"),d:l()})):null};D1.registerSymbol=XD;function Sv(){return Sv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sv.apply(null,arguments)}function uN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uN(Object(r),!0).forEach(function(n){I1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I1(e,t,r){return(t=JD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JD(e){var t=QD(e,"string");return typeof t=="symbol"?t:t+""}function QD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ka=32;class M1 extends k.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=ka/2,i=ka/6,s=ka/3,l=t.inactive?n:t.color,f=r??t.type;if(f==="none")return null;if(f==="plainline")return k.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:ka,y2:a,className:"recharts-legend-icon"});if(f==="line")return k.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(ka,"M").concat(2*s,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(f==="rect")return k.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(ka/8,"h").concat(ka,"v").concat(ka*3/4,"h").concat(-ka,"z"),className:"recharts-legend-icon"});if(k.isValidElement(t.legendIcon)){var d=YD({},t);return delete d.legendIcon,k.cloneElement(t.legendIcon,d)}return k.createElement(D1,{fill:l,cx:a,cy:a,size:ka,sizeType:"diameter",type:f})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:s}=this.props,l={x:0,y:0,width:ka,height:ka},f={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((h,m)=>{var x=h.formatter||a,g=bt({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:h.inactive});if(h.type==="none")return null;var y=h.inactive?i:h.color,v=x?x(h.value,h,m):h.value;return k.createElement("li",Sv({className:g,style:f,key:"legend-item-".concat(m)},Cf(this.props,h,m)),k.createElement(T1,{width:r,height:r,viewBox:l,style:d,"aria-label":"".concat(v," legend icon")},this.renderIcon(h,s)),k.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},v))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return k.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}I1(M1,"displayName","Legend");I1(M1,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Ox={},Fx={},fN;function ZD(){return fN||(fN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],l=n(s);a.has(l)||a.set(l,s)}return Array.from(a.values())}e.uniqBy=t})(Fx)),Fx}var Dx={},dN;function J4(){return dN||(dN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Dx)),Dx}var Ix={},Mx={},Rx={},hN;function eI(){return hN||(hN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Rx)),Rx}var mN;function R1(){return mN||(mN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=eI();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Mx)),Mx}var Lx={},pN;function tI(){return pN||(pN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Lx)),Lx}var xN;function rI(){return xN||(xN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=R1(),r=tI();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(Ix)),Ix}var Bx={},$x={},gN;function nI(){return gN||(gN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=j1();function r(n){return function(a){return t.get(a,n)}}e.property=r})($x)),$x}var Ux={},zx={},Wx={},Hx={},vN;function Q4(){return vN||(vN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Hx)),Hx}var Vx={},yN;function Z4(){return yN||(yN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Vx)),Vx}var Gx={},bN;function eC(){return bN||(bN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(Gx)),Gx}var wN;function aI(){return wN||(wN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L1(),r=Q4(),n=Z4(),a=eC();function i(m,x,g){return typeof g!="function"?t.isMatch(m,x):s(m,x,function y(v,b,E,N,S,j){const T=g(v,b,E,N,S,j);return T!==void 0?!!T:s(v,b,y,j)},new Map)}function s(m,x,g,y){if(x===m)return!0;switch(typeof x){case"object":return l(m,x,g,y);case"function":return Object.keys(x).length>0?s(m,{...x},g,y):a.eq(m,x);default:return r.isObject(m)?typeof x=="string"?x==="":!0:a.eq(m,x)}}function l(m,x,g,y){if(x==null)return!0;if(Array.isArray(x))return d(m,x,g,y);if(x instanceof Map)return f(m,x,g,y);if(x instanceof Set)return h(m,x,g,y);const v=Object.keys(x);if(m==null)return v.length===0;if(v.length===0)return!0;if(y&&y.has(x))return y.get(x)===m;y&&y.set(x,m);try{for(let b=0;b<v.length;b++){const E=v[b];if(!n.isPrimitive(m)&&!(E in m)||x[E]===void 0&&m[E]!==void 0||x[E]===null&&m[E]!==null||!g(m[E],x[E],E,m,x,y))return!1}return!0}finally{y&&y.delete(x)}}function f(m,x,g,y){if(x.size===0)return!0;if(!(m instanceof Map))return!1;for(const[v,b]of x.entries()){const E=m.get(v);if(g(E,b,v,m,x,y)===!1)return!1}return!0}function d(m,x,g,y){if(x.length===0)return!0;if(!Array.isArray(m))return!1;const v=new Set;for(let b=0;b<x.length;b++){const E=x[b];let N=!1;for(let S=0;S<m.length;S++){if(v.has(S))continue;const j=m[S];let T=!1;if(g(j,E,b,m,x,y)&&(T=!0),T){v.add(S),N=!0;break}}if(!N)return!1}return!0}function h(m,x,g,y){return x.size===0?!0:m instanceof Set?d([...m],[...x],g,y):!1}e.isMatchWith=i,e.isSetMatch=h})(Wx)),Wx}var SN;function L1(){return SN||(SN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aI();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(zx)),zx}var Kx={},qx={},Xx={},NN;function iI(){return NN||(NN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(Xx)),Xx}var Yx={},EN;function tC(){return EN||(EN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Yx)),Yx}var Jx={},_N;function rC(){return _N||(_N=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",l="[object Date]",f="[object Map]",d="[object Set]",h="[object Array]",m="[object Function]",x="[object ArrayBuffer]",g="[object Object]",y="[object Error]",v="[object DataView]",b="[object Uint8Array]",E="[object Uint8ClampedArray]",N="[object Uint16Array]",S="[object Uint32Array]",j="[object BigUint64Array]",T="[object Int8Array]",C="[object Int16Array]",P="[object Int32Array]",M="[object BigInt64Array]",D="[object Float32Array]",W="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=x,e.arrayTag=h,e.bigInt64ArrayTag=M,e.bigUint64ArrayTag=j,e.booleanTag=a,e.dataViewTag=v,e.dateTag=l,e.errorTag=y,e.float32ArrayTag=D,e.float64ArrayTag=W,e.functionTag=m,e.int16ArrayTag=C,e.int32ArrayTag=P,e.int8ArrayTag=T,e.mapTag=f,e.numberTag=n,e.objectTag=g,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=N,e.uint32ArrayTag=S,e.uint8ArrayTag=b,e.uint8ClampedArrayTag=E})(Jx)),Jx}var Qx={},kN;function sI(){return kN||(kN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Qx)),Qx}var jN;function nC(){return jN||(jN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iI(),r=tC(),n=rC(),a=Z4(),i=sI();function s(h,m){return l(h,void 0,h,new Map,m)}function l(h,m,x,g=new Map,y=void 0){const v=y?.(h,m,x,g);if(v!==void 0)return v;if(a.isPrimitive(h))return h;if(g.has(h))return g.get(h);if(Array.isArray(h)){const b=new Array(h.length);g.set(h,b);for(let E=0;E<h.length;E++)b[E]=l(h[E],E,x,g,y);return Object.hasOwn(h,"index")&&(b.index=h.index),Object.hasOwn(h,"input")&&(b.input=h.input),b}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const b=new RegExp(h.source,h.flags);return b.lastIndex=h.lastIndex,b}if(h instanceof Map){const b=new Map;g.set(h,b);for(const[E,N]of h)b.set(E,l(N,E,x,g,y));return b}if(h instanceof Set){const b=new Set;g.set(h,b);for(const E of h)b.add(l(E,void 0,x,g,y));return b}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(i.isTypedArray(h)){const b=new(Object.getPrototypeOf(h)).constructor(h.length);g.set(h,b);for(let E=0;E<h.length;E++)b[E]=l(h[E],E,x,g,y);return b}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const b=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return g.set(h,b),f(b,h,x,g,y),b}if(typeof File<"u"&&h instanceof File){const b=new File([h],h.name,{type:h.type});return g.set(h,b),f(b,h,x,g,y),b}if(h instanceof Blob){const b=new Blob([h],{type:h.type});return g.set(h,b),f(b,h,x,g,y),b}if(h instanceof Error){const b=new h.constructor;return g.set(h,b),b.message=h.message,b.name=h.name,b.stack=h.stack,b.cause=h.cause,f(b,h,x,g,y),b}if(typeof h=="object"&&d(h)){const b=Object.create(Object.getPrototypeOf(h));return g.set(h,b),f(b,h,x,g,y),b}return h}function f(h,m,x=h,g,y){const v=[...Object.keys(m),...t.getSymbols(m)];for(let b=0;b<v.length;b++){const E=v[b],N=Object.getOwnPropertyDescriptor(h,E);(N==null||N.writable)&&(h[E]=l(m[E],E,x,g,y))}}function d(h){switch(r.getTag(h)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=l,e.copyProperties=f})(qx)),qx}var CN;function oI(){return CN||(CN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nC();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(Kx)),Kx}var AN;function lI(){return AN||(AN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L1(),r=oI();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(Ux)),Ux}var Zx={},eg={},tg={},TN;function cI(){return TN||(TN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nC(),r=rC();function n(a,i){return t.cloneDeepWith(a,(s,l,f,d)=>{const h=i?.(s,l,f,d);if(h!==void 0)return h;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new a.constructor(a?.valueOf());return t.copyProperties(m,a),m}case r.argumentsTag:{const m={};return t.copyProperties(m,a),m.length=a.length,m[Symbol.iterator]=a[Symbol.iterator],m}default:return}})}e.cloneDeepWith=n})(tg)),tg}var PN;function uI(){return PN||(PN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cI();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(eg)),eg}var rg={},ng={},ON;function aC(){return ON||(ON=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(ng)),ng}var ag={},FN;function fI(){return FN||(FN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tC();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(ag)),ag}var DN;function dI(){return DN||(DN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=j4(),r=aC(),n=fI(),a=k1();function i(s,l){let f;if(Array.isArray(l)?f=l:typeof l=="string"&&t.isDeepKey(l)&&s?.[l]==null?f=a.toPath(l):f=[l],f.length===0)return!1;let d=s;for(let h=0;h<f.length;h++){const m=f[h];if((d==null||!Object.hasOwn(d,m))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(m)&&m<d.length))return!1;d=d[m]}return!0}e.has=i})(rg)),rg}var IN;function hI(){return IN||(IN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L1(),r=C4(),n=uI(),a=j1(),i=dI();function s(l,f){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return f=n.cloneDeep(f),function(d){const h=a.get(d,l);return h===void 0?i.has(d,l):f===void 0?h===void 0:t.isMatch(h,f)}}e.matchesProperty=s})(Zx)),Zx}var MN;function mI(){return MN||(MN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=J4(),r=nI(),n=lI(),a=hI();function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(Bx)),Bx}var RN;function pI(){return RN||(RN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZD(),r=J4(),n=rI(),a=mI();function i(s,l=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(l)):[]}e.uniqBy=i})(Ox)),Ox}var ig,LN;function xI(){return LN||(LN=1,ig=pI().uniqBy),ig}var gI=xI();const BN=Ei(gI);function iC(e,t,r){return t===!0?BN(e,r):typeof t=="function"?BN(e,t):e}var sg={exports:{}},og={},lg={exports:{}},cg={};var $N;function vI(){if($N)return cg;$N=1;var e=kc();function t(m,x){return m===x&&(m!==0||1/m===1/x)||m!==m&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function l(m,x){var g=x(),y=n({inst:{value:g,getSnapshot:x}}),v=y[0].inst,b=y[1];return i(function(){v.value=g,v.getSnapshot=x,f(v)&&b({inst:v})},[m,g,x]),a(function(){return f(v)&&b({inst:v}),m(function(){f(v)&&b({inst:v})})},[m]),s(g),g}function f(m){var x=m.getSnapshot;m=m.value;try{var g=x();return!r(m,g)}catch{return!0}}function d(m,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return cg.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,cg}var UN;function yI(){return UN||(UN=1,lg.exports=vI()),lg.exports}var zN;function bI(){if(zN)return og;zN=1;var e=kc(),t=yI();function r(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,l=e.useMemo,f=e.useDebugValue;return og.useSyncExternalStoreWithSelector=function(d,h,m,x,g){var y=i(null);if(y.current===null){var v={hasValue:!1,value:null};y.current=v}else v=y.current;y=l(function(){function E(C){if(!N){if(N=!0,S=C,C=x(C),g!==void 0&&v.hasValue){var P=v.value;if(g(P,C))return j=P}return j=C}if(P=j,n(S,C))return P;var M=x(C);return g!==void 0&&g(P,M)?(S=C,P):(S=C,j=M)}var N=!1,S,j,T=m===void 0?null:m;return[function(){return E(h())},T===null?void 0:function(){return E(T())}]},[h,m,x,g]);var b=a(d,y[0],y[1]);return s(function(){v.hasValue=!0,v.value=b},[b]),f(b),b},og}var WN;function wI(){return WN||(WN=1,sg.exports=bI()),sg.exports}var SI=wI(),B1=k.createContext(null),NI=e=>e,lr=()=>{var e=k.useContext(B1);return e?e.store.dispatch:NI},F0=()=>{},EI=()=>F0,_I=(e,t)=>e===t;function Ze(e){var t=k.useContext(B1);return SI.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:EI,t?t.store.getState:F0,t?t.store.getState:F0,t?e:F0,_I)}function kI(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function jI(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function CI(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var HN=e=>Array.isArray(e)?e:[e];function AI(e){const t=Array.isArray(e[0])?e[0]:e;return CI(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function TI(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var PI=class{constructor(e){this.value=e}deref(){return this.value}},OI=typeof WeakRef<"u"?WeakRef:PI,FI=0,VN=1;function s0(){return{s:FI,v:void 0,o:null,p:null}}function sC(e,t={}){let r=s0();const{resultEqualityCheck:n}=t;let a,i=0;function s(){let l=r;const{length:f}=arguments;for(let m=0,x=f;m<x;m++){const g=arguments[m];if(typeof g=="function"||typeof g=="object"&&g!==null){let y=l.o;y===null&&(l.o=y=new WeakMap);const v=y.get(g);v===void 0?(l=s0(),y.set(g,l)):l=v}else{let y=l.p;y===null&&(l.p=y=new Map);const v=y.get(g);v===void 0?(l=s0(),y.set(g,l)):l=v}}const d=l;let h;if(l.s===VN)h=l.v;else if(h=e.apply(null,arguments),i++,n){const m=a?.deref?.()??a;m!=null&&n(m,h)&&(h=m,i!==0&&i--),a=typeof h=="object"&&h!==null||typeof h=="function"?new OI(h):h}return d.s=VN,d.v=h,h}return s.clearCache=()=>{r=s0(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function DI(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,l,f={},d=a.pop();typeof d=="object"&&(f=d,d=a.pop()),kI(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const h={...r,...f},{memoize:m,memoizeOptions:x=[],argsMemoize:g=sC,argsMemoizeOptions:y=[]}=h,v=HN(x),b=HN(y),E=AI(a),N=m(function(){return i++,d.apply(null,arguments)},...v),S=g(function(){s++;const T=TI(E,arguments);return l=N.apply(null,T),l},...b);return Object.assign(S,{resultFunc:d,memoizedResultFunc:N,dependencies:E,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var Se=DI(sC),II=Object.assign((e,t=Se)=>{jI(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,l,f)=>(s[r[f]]=l,s),{}))},{withTypes:()=>II}),ug={},fg={},dg={},GN;function MI(){return GN||(GN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),l=t(a);if(s===l&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?l-s:s-l}return 0};e.compareValues=r})(dg)),dg}var hg={},mg={},KN;function oC(){return KN||(KN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(mg)),mg}var qN;function RI(){return qN||(qN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oC(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(hg)),hg}var XN;function LI(){return XN||(XN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MI(),r=RI(),n=k1();function a(i,s,l,f){if(i==null)return[];l=f?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(g=>String(g));const d=(g,y)=>{let v=g;for(let b=0;b<y.length&&v!=null;++b)v=v[y[b]];return v},h=(g,y)=>y==null||g==null?y:typeof g=="object"&&"key"in g?Object.hasOwn(y,g.key)?y[g.key]:d(y,g.path):typeof g=="function"?g(y):Array.isArray(g)?d(y,g):typeof y=="object"?y[g]:y,m=s.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||r.isKey(g)?g:{key:g,path:n.toPath(g)}));return i.map(g=>({original:g,criteria:m.map(y=>h(y,g))})).slice().sort((g,y)=>{for(let v=0;v<m.length;v++){const b=t.compareValues(g.criteria[v],y.criteria[v],l[v]);if(b!==0)return b}return 0}).map(g=>g.original)}e.orderBy=a})(fg)),fg}var pg={},YN;function BI(){return YN||(YN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(l,f)=>{for(let d=0;d<l.length;d++){const h=l[d];Array.isArray(h)&&f<i?s(h,f+1):a.push(h)}};return s(r,0),a}e.flatten=t})(pg)),pg}var xg={},JN;function lC(){return JN||(JN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aC(),r=R1(),n=Q4(),a=eC();function i(s,l,f){return n.isObject(f)&&(typeof l=="number"&&r.isArrayLike(f)&&t.isIndex(l)&&l<f.length||typeof l=="string"&&l in f)?a.eq(f[l],s):!1}e.isIterateeCall=i})(xg)),xg}var QN;function $I(){return QN||(QN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LI(),r=BI(),n=lC();function a(i,...s){const l=s.length;return l>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:l>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(ug)),ug}var gg,ZN;function UI(){return ZN||(ZN=1,gg=$I().sortBy),gg}var zI=UI();const Gh=Ei(zI);var cC=e=>e.legend.settings,WI=e=>e.legend.size,HI=e=>e.legend.payload,VI=Se([HI,cC],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?Gh(n,r):n});function GI(){return Ze(VI)}var o0=1;function uC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=k.useState({height:0,left:0,top:0,width:0}),n=k.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>o0||Math.abs(s.left-t.left)>o0||Math.abs(s.top-t.top)>o0||Math.abs(s.width-t.width)>o0)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function sn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var KI=typeof Symbol=="function"&&Symbol.observable||"@@observable",eE=KI,vg=()=>Math.random().toString(36).substring(7).split("").join("."),qI={INIT:`@@redux/INIT${vg()}`,REPLACE:`@@redux/REPLACE${vg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${vg()}`},G0=qI;function $1(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function fC(e,t,r){if(typeof e!="function")throw new Error(sn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(sn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(sn(1));return r(fC)(e,t)}let n=e,a=t,i=new Map,s=i,l=0,f=!1;function d(){s===i&&(s=new Map,i.forEach((b,E)=>{s.set(E,b)}))}function h(){if(f)throw new Error(sn(3));return a}function m(b){if(typeof b!="function")throw new Error(sn(4));if(f)throw new Error(sn(5));let E=!0;d();const N=l++;return s.set(N,b),function(){if(E){if(f)throw new Error(sn(6));E=!1,d(),s.delete(N),i=null}}}function x(b){if(!$1(b))throw new Error(sn(7));if(typeof b.type>"u")throw new Error(sn(8));if(typeof b.type!="string")throw new Error(sn(17));if(f)throw new Error(sn(9));try{f=!0,a=n(a,b)}finally{f=!1}return(i=s).forEach(N=>{N()}),b}function g(b){if(typeof b!="function")throw new Error(sn(10));n=b,x({type:G0.REPLACE})}function y(){const b=m;return{subscribe(E){if(typeof E!="object"||E===null)throw new Error(sn(11));function N(){const j=E;j.next&&j.next(h())}return N(),{unsubscribe:b(N)}},[eE](){return this}}}return x({type:G0.INIT}),{dispatch:x,subscribe:m,getState:h,replaceReducer:g,[eE]:y}}function XI(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:G0.INIT})>"u")throw new Error(sn(12));if(typeof r(void 0,{type:G0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(sn(13))})}function dC(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{XI(r)}catch(i){a=i}return function(s={},l){if(a)throw a;let f=!1;const d={};for(let h=0;h<n.length;h++){const m=n[h],x=r[m],g=s[m],y=x(g,l);if(typeof y>"u")throw l&&l.type,new Error(sn(14));d[m]=y,f=f||y!==g}return f=f||n.length!==Object.keys(s).length,f?d:s}}function K0(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function YI(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(sn(15))};const s={getState:a.getState,dispatch:(f,...d)=>i(f,...d)},l=e.map(f=>f(s));return i=K0(...l)(a.dispatch),{...a,dispatch:i}}}function hC(e){return $1(e)&&"type"in e&&typeof e.type=="string"}var mC=Symbol.for("immer-nothing"),tE=Symbol.for("immer-draftable"),ma=Symbol.for("immer-state");function Qa(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var hc=Object.getPrototypeOf;function qo(e){return!!e&&!!e[ma]}function Zi(e){return e?pC(e)||Array.isArray(e)||!!e[tE]||!!e.constructor?.[tE]||Af(e)||qh(e):!1}var JI=Object.prototype.constructor.toString();function pC(e){if(!e||typeof e!="object")return!1;const t=hc(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===JI}function q0(e,t){Kh(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Kh(e){const t=e[ma];return t?t.type_:Array.isArray(e)?1:Af(e)?2:qh(e)?3:0}function Nv(e,t){return Kh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function xC(e,t,r){const n=Kh(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function QI(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Af(e){return e instanceof Map}function qh(e){return e instanceof Set}function jo(e){return e.copy_||e.base_}function Ev(e,t){if(Af(e))return new Map(e);if(qh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=pC(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[ma];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],l=n[s];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[s]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[s]})}return Object.create(hc(e),n)}else{const n=hc(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function U1(e,t=!1){return Xh(e)||qo(e)||!Zi(e)||(Kh(e)>1&&Object.defineProperties(e,{set:{value:l0},add:{value:l0},clear:{value:l0},delete:{value:l0}}),Object.freeze(e),t&&Object.values(e).forEach(r=>U1(r,!0))),e}function l0(){Qa(2)}function Xh(e){return Object.isFrozen(e)}var ZI={};function Xo(e){const t=ZI[e];return t||Qa(0,e),t}var ef;function gC(){return ef}function eM(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function rE(e,t){t&&(Xo("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function _v(e){kv(e),e.drafts_.forEach(tM),e.drafts_=null}function kv(e){e===ef&&(ef=e.parent_)}function nE(e){return ef=eM(ef,e)}function tM(e){const t=e[ma];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function aE(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ma].modified_&&(_v(t),Qa(4)),Zi(e)&&(e=X0(t,e),t.parent_||Y0(t,e)),t.patches_&&Xo("Patches").generateReplacementPatches_(r[ma].base_,e,t.patches_,t.inversePatches_)):e=X0(t,r,[]),_v(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==mC?e:void 0}function X0(e,t,r){if(Xh(t))return t;const n=t[ma];if(!n)return q0(t,(a,i)=>iE(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Y0(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),q0(i,(l,f)=>iE(e,n,a,l,f,r,s)),Y0(e,a,!1),r&&e.patches_&&Xo("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function iE(e,t,r,n,a,i,s){if(qo(a)){const l=i&&t&&t.type_!==3&&!Nv(t.assigned_,n)?i.concat(n):void 0,f=X0(e,a,l);if(xC(r,n,f),qo(f))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Zi(a)&&!Xh(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;X0(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Af(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&Y0(e,a)}}function Y0(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&U1(t,r)}function rM(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:gC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=z1;r&&(a=[n],i=tf);const{revoke:s,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=s,l}var z1={get(e,t){if(t===ma)return e;const r=jo(e);if(!Nv(r,t))return nM(e,r,t);const n=r[t];return e.finalized_||!Zi(n)?n:n===yg(e.base_,t)?(bg(e),e.copy_[t]=Cv(n,e)):n},has(e,t){return t in jo(e)},ownKeys(e){return Reflect.ownKeys(jo(e))},set(e,t,r){const n=vC(jo(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=yg(jo(e),t),i=a?.[ma];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(QI(r,a)&&(r!==void 0||Nv(e.base_,t)))return!0;bg(e),jv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return yg(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,bg(e),jv(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=jo(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Qa(11)},getPrototypeOf(e){return hc(e.base_)},setPrototypeOf(){Qa(12)}},tf={};q0(z1,(e,t)=>{tf[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});tf.deleteProperty=function(e,t){return tf.set.call(this,e,t,void 0)};tf.set=function(e,t,r){return z1.set.call(this,e[0],t,r,e[0])};function yg(e,t){const r=e[ma];return(r?jo(r):e)[t]}function nM(e,t,r){const n=vC(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function vC(e,t){if(!(t in e))return;let r=hc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=hc(r)}}function jv(e){e.modified_||(e.modified_=!0,e.parent_&&jv(e.parent_))}function bg(e){e.copy_||(e.copy_=Ev(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var aM=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(f=i,...d){return s.produce(f,h=>r.call(this,h,...d))}}typeof r!="function"&&Qa(6),n!==void 0&&typeof n!="function"&&Qa(7);let a;if(Zi(t)){const i=nE(this),s=Cv(t,void 0);let l=!0;try{a=r(s),l=!1}finally{l?_v(i):kv(i)}return rE(i,n),aE(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===mC&&(a=void 0),this.autoFreeze_&&U1(a,!0),n){const i=[],s=[];Xo("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Qa(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...l)=>this.produceWithPatches(s,f=>t(f,...l));let n,a;return[this.produce(t,r,(s,l)=>{n=s,a=l}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Zi(e)||Qa(8),qo(e)&&(e=Vi(e));const t=nE(this),r=Cv(e,void 0);return r[ma].isManual_=!0,kv(t),r}finishDraft(e,t){const r=e&&e[ma];(!r||!r.isManual_)&&Qa(9);const{scope_:n}=r;return rE(n,t),aE(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Xo("Patches").applyPatches_;return qo(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Cv(e,t){const r=Af(e)?Xo("MapSet").proxyMap_(e,t):qh(e)?Xo("MapSet").proxySet_(e,t):rM(e,t);return(t?t.scope_:gC()).drafts_.push(r),r}function Vi(e){return qo(e)||Qa(10,e),yC(e)}function yC(e){if(!Zi(e)||Xh(e))return e;const t=e[ma];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Ev(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Ev(e,!0);return q0(r,(n,a)=>{xC(r,n,yC(a))}),t&&(t.finalized_=!1),r}var iM=new aM,bC=iM.produce;function wC(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var sM=wC(),oM=wC,lM=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?K0:K0.apply(null,arguments)};function Ra(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(da(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>hC(n)&&n.type===e,r}var SC=class Du extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Du.prototype)}static get[Symbol.species](){return Du}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Du(...t[0].concat(this)):new Du(...t.concat(this))}};function sE(e){return Zi(e)?bC(e,()=>{}):e}function c0(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function cM(e){return typeof e=="boolean"}var uM=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new SC;return r&&(cM(r)?s.push(sM):s.push(oM(r.extraArgument))),s},fM="RTK_autoBatch",oE=e=>t=>{setTimeout(t,e)},dM=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const l=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:oE(10):e.type==="callback"?e.queueNotification:oE(e.timeout),d=()=>{s=!1,i&&(i=!1,l.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const m=()=>a&&h(),x=n.subscribe(m);return l.add(h),()=>{x(),l.delete(h)}},dispatch(h){try{return a=!h?.meta?.[fM],i=!a,i&&(s||(s=!0,f(d))),n.dispatch(h)}finally{a=!0}}})},hM=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new SC(e);return n&&a.push(dM(typeof n=="object"?n:void 0)),a};function mM(e){const t=uM(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let l;if(typeof r=="function")l=r;else if($1(r))l=dC(r);else throw new Error(da(1));let f;typeof n=="function"?f=n(t):f=t();let d=K0;a&&(d=lM({trace:!1,...typeof a=="object"&&a}));const h=YI(...f),m=hM(h);let x=typeof s=="function"?s(m):m();const g=d(...x);return fC(l,i,g)}function NC(e){const t={},r=[];let n;const a={addCase(i,s){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(da(28));if(l in t)throw new Error(da(29));return t[l]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function pM(e){return typeof e=="function"}function xM(e,t){let[r,n,a]=NC(t),i;if(pM(e))i=()=>sE(e());else{const l=sE(e);i=()=>l}function s(l=i(),f){let d=[r[f.type],...n.filter(({matcher:h})=>h(f)).map(({reducer:h})=>h)];return d.filter(h=>!!h).length===0&&(d=[a]),d.reduce((h,m)=>{if(m)if(qo(h)){const g=m(h,f);return g===void 0?h:g}else{if(Zi(h))return bC(h,x=>m(x,f));{const x=m(h,f);if(x===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return h},l)}return s.getInitialState=i,s}var gM="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",vM=(e=21)=>{let t="",r=e;for(;r--;)t+=gM[Math.random()*64|0];return t},yM=Symbol.for("rtk-slice-createasyncthunk");function bM(e,t){return`${e}/${t}`}function wM({creators:e}={}){const t=e?.asyncThunk?.[yM];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(da(11));const s=(typeof n.reducers=="function"?n.reducers(NM()):n.reducers)||{},l=Object.keys(s),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,j){const T=typeof S=="string"?S:S.type;if(!T)throw new Error(da(12));if(T in f.sliceCaseReducersByType)throw new Error(da(13));return f.sliceCaseReducersByType[T]=j,d},addMatcher(S,j){return f.sliceMatchers.push({matcher:S,reducer:j}),d},exposeAction(S,j){return f.actionCreators[S]=j,d},exposeCaseReducer(S,j){return f.sliceCaseReducersByName[S]=j,d}};l.forEach(S=>{const j=s[S],T={reducerName:S,type:bM(a,S),createNotation:typeof n.reducers=="function"};_M(j)?jM(T,j,d,t):EM(T,j,d)});function h(){const[S={},j=[],T=void 0]=typeof n.extraReducers=="function"?NC(n.extraReducers):[n.extraReducers],C={...S,...f.sliceCaseReducersByType};return xM(n.initialState,P=>{for(let M in C)P.addCase(M,C[M]);for(let M of f.sliceMatchers)P.addMatcher(M.matcher,M.reducer);for(let M of j)P.addMatcher(M.matcher,M.reducer);T&&P.addDefaultCase(T)})}const m=S=>S,x=new Map,g=new WeakMap;let y;function v(S,j){return y||(y=h()),y(S,j)}function b(){return y||(y=h()),y.getInitialState()}function E(S,j=!1){function T(P){let M=P[S];return typeof M>"u"&&j&&(M=c0(g,T,b)),M}function C(P=m){const M=c0(x,j,()=>new WeakMap);return c0(M,P,()=>{const D={};for(const[W,F]of Object.entries(n.selectors??{}))D[W]=SM(F,P,()=>c0(g,P,b),j);return D})}return{reducerPath:S,getSelectors:C,get selectors(){return C(T)},selectSlice:T}}const N={name:a,reducer:v,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:b,...E(i),injectInto(S,{reducerPath:j,...T}={}){const C=j??i;return S.inject({reducerPath:C,reducer:v},T),{...N,...E(C,!0)}}};return N}}function SM(e,t,r,n){function a(i,...s){let l=t(i);return typeof l>"u"&&n&&(l=r()),e(l,...s)}return a.unwrapped=e,a}var ga=wM();function NM(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function EM({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!kM(n))throw new Error(da(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?Ra(e,s):Ra(e))}function _M(e){return e._reducerDefinitionType==="asyncThunk"}function kM(e){return e._reducerDefinitionType==="reducerWithPrepare"}function jM({type:e,reducerName:t},r,n,a){if(!a)throw new Error(da(18));const{payloadCreator:i,fulfilled:s,pending:l,rejected:f,settled:d,options:h}=r,m=a(e,i,h);n.exposeAction(t,m),s&&n.addCase(m.fulfilled,s),l&&n.addCase(m.pending,l),f&&n.addCase(m.rejected,f),d&&n.addMatcher(m.settled,d),n.exposeCaseReducer(t,{fulfilled:s||u0,pending:l||u0,rejected:f||u0,settled:d||u0})}function u0(){}var CM="task",EC="listener",_C="completed",W1="cancelled",AM=`task-${W1}`,TM=`task-${_C}`,Av=`${EC}-${W1}`,PM=`${EC}-${_C}`,Yh=class{constructor(e){this.code=e,this.message=`${CM} ${W1} (reason: ${e})`}name="TaskAbortError";message},H1=(e,t)=>{if(typeof e!="function")throw new TypeError(da(32))},J0=()=>{},kC=(e,t=J0)=>(e.catch(t),e),jC=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Mo=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Ro=e=>{if(e.aborted){const{reason:t}=e;throw new Yh(t)}};function CC(e,t){let r=J0;return new Promise((n,a)=>{const i=()=>a(new Yh(e.reason));if(e.aborted){i();return}r=jC(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=J0})}var OM=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Yh?"cancelled":"rejected",error:r}}finally{t?.()}},Q0=e=>t=>kC(CC(e,t).then(r=>(Ro(e),r))),AC=e=>{const t=Q0(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:rc}=Object,lE={},Jh="listenerMiddleware",FM=(e,t)=>{const r=n=>jC(e,()=>Mo(n,e.reason));return(n,a)=>{H1(n);const i=new AbortController;r(i);const s=OM(async()=>{Ro(e),Ro(i.signal);const l=await n({pause:Q0(i.signal),delay:AC(i.signal),signal:i.signal});return Ro(i.signal),l},()=>Mo(i,TM));return a?.autoJoin&&t.push(s.catch(J0)),{result:Q0(e)(s),cancel(){Mo(i,AM)}}}},DM=(e,t)=>{const r=async(n,a)=>{Ro(t);let i=()=>{};const l=[new Promise((f,d)=>{let h=e({predicate:n,effect:(m,x)=>{x.unsubscribe(),f([m,x.getState(),x.getOriginalState()])}});i=()=>{h(),d()}})];a!=null&&l.push(new Promise(f=>setTimeout(f,a,null)));try{const f=await CC(t,Promise.race(l));return Ro(t),f}finally{i()}};return(n,a)=>kC(r(n,a))},TC=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=Ra(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(da(21));return H1(i),{predicate:a,type:t,effect:i}},PC=rc(e=>{const{type:t,predicate:r,effect:n}=TC(e);return{id:vM(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(da(22))}}},{withTypes:()=>PC}),cE=(e,t)=>{const{type:r,effect:n,predicate:a}=TC(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},Tv=e=>{e.pending.forEach(t=>{Mo(t,Av)})},IM=e=>()=>{e.forEach(Tv),e.clear()},uE=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},OC=rc(Ra(`${Jh}/add`),{withTypes:()=>OC}),MM=Ra(`${Jh}/removeAll`),FC=rc(Ra(`${Jh}/remove`),{withTypes:()=>FC}),RM=(...e)=>{console.error(`${Jh}/error`,...e)},Tf=(e={})=>{const t=new Map,{extra:r,onError:n=RM}=e;H1(n);const a=h=>(h.unsubscribe=()=>t.delete(h.id),t.set(h.id,h),m=>{h.unsubscribe(),m?.cancelActive&&Tv(h)}),i=h=>{const m=cE(t,h)??PC(h);return a(m)};rc(i,{withTypes:()=>i});const s=h=>{const m=cE(t,h);return m&&(m.unsubscribe(),h.cancelActive&&Tv(m)),!!m};rc(s,{withTypes:()=>s});const l=async(h,m,x,g)=>{const y=new AbortController,v=DM(i,y.signal),b=[];try{h.pending.add(y),await Promise.resolve(h.effect(m,rc({},x,{getOriginalState:g,condition:(E,N)=>v(E,N).then(Boolean),take:v,delay:AC(y.signal),pause:Q0(y.signal),extra:r,signal:y.signal,fork:FM(y.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{t.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((E,N,S)=>{E!==y&&(Mo(E,Av),S.delete(E))})},cancel:()=>{Mo(y,Av),h.pending.delete(y)},throwIfCancelled:()=>{Ro(y.signal)}})))}catch(E){E instanceof Yh||uE(n,E,{raisedBy:"effect"})}finally{await Promise.all(b),Mo(y,PM),h.pending.delete(y)}},f=IM(t);return{middleware:h=>m=>x=>{if(!hC(x))return m(x);if(OC.match(x))return i(x.payload);if(MM.match(x)){f();return}if(FC.match(x))return s(x.payload);let g=h.getState();const y=()=>{if(g===lE)throw new Error(da(23));return g};let v;try{if(v=m(x),t.size>0){const b=h.getState(),E=Array.from(t.values());for(const N of E){let S=!1;try{S=N.predicate(x,b,g)}catch(j){S=!1,uE(n,j,{raisedBy:"predicate"})}S&&l(N,x,h,y)}}}finally{g=lE}return v},startListening:i,stopListening:s,clearListeners:f}};function da(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var LM={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},DC=ga({name:"chartLayout",initialState:LM,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:BM,setLayout:$M,setChartSize:UM,setScale:zM}=DC.actions,WM=DC.reducer;function fE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fE(Object(r),!0).forEach(function(n){HM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HM(e,t,r){return(t=VM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VM(e){var t=GM(e,"string");return typeof t=="symbol"?t:t+""}function GM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z0=Math.PI/180,KM=e=>e*180/Math.PI,_r=(e,t,r,n)=>({x:e+Math.cos(-Z0*n)*r,y:t+Math.sin(-Z0*n)*r}),IC=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},qM=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},XM=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=qM({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var l=(r-a)/s,f=Math.acos(l);return n>i&&(f=2*Math.PI-f),{radius:s,angle:KM(f),angleInRadian:f}},YM=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},JM=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},QM=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=XM({x:r,y:n},t),{innerRadius:s,outerRadius:l}=t;if(a<s||a>l||a===0)return null;var{startAngle:f,endAngle:d}=YM(t),h=i,m;if(f<=d){for(;h>d;)h-=360;for(;h<f;)h+=360;m=h>=f&&h<=d}else{for(;h>f;)h-=360;for(;h<d;)h+=360;m=h>=d&&h<=f}return m?dE(dE({},t),{},{radius:a,angle:JM(h,t)}):null};function MC(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function hE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hE(Object(r),!0).forEach(function(n){ZM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZM(e,t,r){return(t=e8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e8(e){var t=t8(e,"string");return typeof t=="symbol"?t:t+""}function t8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ir(e,t,r){return Yr(e)||Yr(t)?r:Si(t)?Ko(e,t,r):typeof t=="function"?t(e):r}var r8=(e,t,r,n,a)=>{var i,s=-1,l=(i=t?.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var f=0;f<l;f++){var d=f>0?r[f-1].coordinate:r[l-1].coordinate,h=r[f].coordinate,m=f>=l-1?r[0].coordinate:r[f+1].coordinate,x=void 0;if(qr(h-d)!==qr(m-h)){var g=[];if(qr(m-h)===qr(a[1]-a[0])){x=m;var y=h+a[1]-a[0];g[0]=Math.min(y,(y+d)/2),g[1]=Math.max(y,(y+d)/2)}else{x=d;var v=m+a[1]-a[0];g[0]=Math.min(h,(v+h)/2),g[1]=Math.max(h,(v+h)/2)}var b=[Math.min(h,(x+h)/2),Math.max(h,(x+h)/2)];if(e>b[0]&&e<=b[1]||e>=g[0]&&e<=g[1]){({index:s}=r[f]);break}}else{var E=Math.min(d,m),N=Math.max(d,m);if(e>(E+h)/2&&e<=(N+h)/2){({index:s}=r[f]);break}}}else if(t){for(var S=0;S<l;S++)if(S===0&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S>0&&S<l-1&&e>(t[S].coordinate+t[S-1].coordinate)/2&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S===l-1&&e>(t[S].coordinate+t[S-1].coordinate)/2){({index:s}=t[S]);break}}return s},n8=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:l}=t;if((l==="vertical"||l==="horizontal"&&s==="middle")&&i!=="center"&&et(e[i]))return Da(Da({},e),{},{[i]:e[i]+(n||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&s!=="middle"&&et(e[s]))return Da(Da({},e),{},{[s]:e[s]+(a||0)})}return e},ol=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",RC=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,i,s=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(i=!0),l.coordinate));return a||s.push(t),i||s.push(r),s},LC=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:l,isCategorical:f,categoricalDomain:d,tickCount:h,ticks:m,niceTicks:x,axisType:g}=e;if(!s)return null;var y=l==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,v=a==="category"&&s.bandwidth?s.bandwidth()/y:0;if(v=g==="angleAxis"&&i&&i.length>=2?qr(i[0]-i[1])*2*v:v,m||x){var b=(m||x||[]).map((E,N)=>{var S=n?n.indexOf(E):E;return{coordinate:s(S)+v,value:E,offset:v,index:N}});return b.filter(E=>!ha(E.coordinate))}return f&&d?d.map((E,N)=>({coordinate:s(E)+v,value:E,index:N,offset:v})):s.ticks&&h!=null?s.ticks(h).map((E,N)=>({coordinate:s(E)+v,value:E,offset:v,index:N})):s.domain().map((E,N)=>({coordinate:s(E)+v,value:n?n[E]:E,index:N,offset:v}))},mE=1e-4,a8=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-mE,i=Math.max(n[0],n[1])+mE,s=e(t[0]),l=e(t[r-1]);(s<a||s>i||l<a||l>i)&&e.domain([t[0],t[r-1]])}},i8=(e,t)=>{if(!t||t.length!==2||!et(t[0])||!et(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!et(e[0])||e[0]<r)&&(a[0]=r),(!et(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},s8=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var l=ha(e[s][r][1])?e[s][r][0]:e[s][r][1];l>=0?(e[s][r][0]=a,e[s][r][1]=a+l,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+l,i=e[s][r][1])}},o8=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=ha(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},l8={sign:s8,expand:RD,none:dc,silhouette:LD,wiggle:BD,positive:o8},c8=(e,t,r)=>{var n=l8[r],a=MD().keys(t).value((i,s)=>+ir(i,s,0)).order(bv).offset(n);return a(e)};function u8(e){return e==null?void 0:String(e)}var pE=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var l=ir(i,t.dataKey,t.scale.domain()[s]);return Yr(l)?null:t.scale(l)-a/2+n},f8=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},d8=e=>{var t=e.flat(2).filter(et);return[Math.min(...t),Math.max(...t)]},h8=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],m8=(e,t,r)=>{if(e!=null)return h8(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,l=s.reduce((f,d)=>{var h=MC(d,t,r),m=d8(h);return[Math.min(f[0],m[0]),Math.max(f[1],m[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},xE=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,gE=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,V1=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=Gh(t,h=>h.coordinate),i=1/0,s=1,l=a.length;s<l;s++){var f=a[s],d=a[s-1];i=Math.min((f.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function vE(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Da(Da({},t),{},{dataKey:r,payload:n,value:a,name:i})}function Qh(e,t){if(e)return String(e);if(typeof t=="string")return t}function p8(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?QM({x:e,y:t},n):null}var x8=(e,t,r,n)=>{var a=t.find(d=>d&&d.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return Da(Da(Da({},n),_r(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var l=a.coordinate,{angle:f}=n;return Da(Da(Da({},n),_r(n.cx,n.cy,l,f)),{},{angle:f,radius:l})}return{x:0,y:0}},g8=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,as=e=>e.layout.width,is=e=>e.layout.height,v8=e=>e.layout.scale,BC=e=>e.layout.margin,Zh=Se(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),em=Se(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),$C="data-recharts-item-index",UC="data-recharts-item-data-key",Pf=60;function yE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function f0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yE(Object(r),!0).forEach(function(n){y8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y8(e,t,r){return(t=b8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b8(e){var t=w8(e,"string");return typeof t=="symbol"?t:t+""}function w8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S8=e=>e.brush.height;function N8(e){var t=em(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Pf;return r+a}return r},0)}function E8(e){var t=em(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Pf;return r+a}return r},0)}function _8(e){var t=Zh(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function k8(e){var t=Zh(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Mr=Se([as,is,BC,S8,N8,E8,_8,k8,cC,WI],(e,t,r,n,a,i,s,l,f,d)=>{var h={left:(r.left||0)+a,right:(r.right||0)+i},m={top:(r.top||0)+s,bottom:(r.bottom||0)+l},x=f0(f0({},m),h),g=x.bottom;x.bottom+=n,x=n8(x,f,d);var y=e-x.left-x.right,v=t-x.top-x.bottom;return f0(f0({brushBottom:g},x),{},{width:Math.max(y,0),height:Math.max(v,0)})}),j8=Se(Mr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),G1=Se(as,is,(e,t)=>({x:0,y:0,width:e,height:t})),C8=k.createContext(null),$a=()=>k.useContext(C8)!=null,tm=e=>e.brush,rm=Se([tm,Mr,BC],(e,t,r)=>({height:e.height,x:et(e.x)?e.x:t.left,y:et(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:et(e.width)?e.width:t.width})),K1=()=>{var e,t=$a(),r=Ze(j8),n=Ze(rm),a=(e=Ze(tm))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},A8={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},zC=()=>{var e;return(e=Ze(Mr))!==null&&e!==void 0?e:A8},q1=()=>Ze(as),X1=()=>Ze(is),T8=()=>Ze(e=>e.layout.margin),_t=e=>e.layout.layoutType,Y1=()=>Ze(_t),P8={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},WC=ga({name:"legend",initialState:P8,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Vi(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:bE,setLegendSettings:O8,addLegendPayload:HC,removeLegendPayload:VC}=WC.actions,F8=WC.reducer,D8=["contextPayload"];function Pv(){return Pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pv.apply(null,arguments)}function wE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wE(Object(r),!0).forEach(function(n){J1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J1(e,t,r){return(t=I8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I8(e){var t=M8(e,"string");return typeof t=="symbol"?t:t+""}function M8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R8(e,t){if(e==null)return{};var r,n,a=L8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function L8(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function B8(e){return e.value}function $8(e){var{contextPayload:t}=e,r=R8(e,D8),n=iC(t,e.payloadUniqBy,B8),a=mc(mc({},r),{},{payload:n});return k.isValidElement(e.content)?k.cloneElement(e.content,a):typeof e.content=="function"?k.createElement(e.content,a):k.createElement(M1,a)}function U8(e,t,r,n,a,i){var{layout:s,align:l,verticalAlign:f}=t,d,h;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&s==="vertical"?d={left:((n||0)-i.width)/2}:d=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(f==="middle"?h={top:((a||0)-i.height)/2}:h=f==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),mc(mc({},d),h)}function z8(e){var t=lr();return k.useEffect(()=>{t(O8(e))},[t,e]),null}function W8(e){var t=lr();return k.useEffect(()=>(t(bE(e)),()=>{t(bE({width:0,height:0}))}),[t,e]),null}function H8(e){var t=GI(),r=sD(),n=T8(),{width:a,height:i,wrapperStyle:s,portal:l}=e,[f,d]=uC([t]),h=q1(),m=X1();if(h==null||m==null)return null;var x=h-(n.left||0)-(n.right||0),g=nm.getWidthOrHeight(e.layout,i,a,x),y=l?s:mc(mc({position:"absolute",width:g?.width||a||"auto",height:g?.height||i||"auto"},U8(s,e,n,h,m,f)),s),v=l??r;if(v==null)return null;var b=k.createElement("div",{className:"recharts-legend-wrapper",style:y,ref:d},k.createElement(z8,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),k.createElement(W8,{width:f.width,height:f.height}),k.createElement($8,Pv({},e,g,{margin:n,chartWidth:h,chartHeight:m,contextPayload:t})));return O4.createPortal(b,v)}class nm extends k.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&et(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return k.createElement(H8,this.props)}}J1(nm,"displayName","Legend");J1(nm,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Ov(){return Ov=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ov.apply(null,arguments)}function SE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SE(Object(r),!0).forEach(function(n){V8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V8(e,t,r){return(t=G8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G8(e){var t=K8(e,"string");return typeof t=="symbol"?t:t+""}function K8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q8(e){return Array.isArray(e)&&Si(e[0])&&Si(e[1])?e.join(" ~ "):e}var X8=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:l,wrapperClassName:f,labelClassName:d,label:h,labelFormatter:m,accessibilityLayer:x=!1}=e,g=()=>{if(i&&i.length){var T={padding:0,margin:0},C=(l?Gh(i,l):i).map((P,M)=>{if(P.type==="none")return null;var D=P.formatter||s||q8,{value:W,name:F}=P,L=W,J=F;if(D){var se=D(W,F,P,M,i);if(Array.isArray(se))[L,J]=se;else if(se!=null)L=se;else return null}var Z=wg({display:"block",paddingTop:4,paddingBottom:4,color:P.color||"#000"},n);return k.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(M),style:Z},Si(J)?k.createElement("span",{className:"recharts-tooltip-item-name"},J):null,Si(J)?k.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,k.createElement("span",{className:"recharts-tooltip-item-value"},L),k.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return k.createElement("ul",{className:"recharts-tooltip-item-list",style:T},C)}return null},y=wg({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=wg({margin:0},a),b=!Yr(h),E=b?h:"",N=bt("recharts-default-tooltip",f),S=bt("recharts-tooltip-label",d);b&&m&&i!==void 0&&i!==null&&(E=m(h,i));var j=x?{role:"status","aria-live":"assertive"}:{};return k.createElement("div",Ov({className:N,style:y},j),k.createElement("p",{className:S,style:v},k.isValidElement(E)?E:"".concat(E)),g())},Eu="recharts-tooltip-wrapper",Y8={visibility:"hidden"};function J8(e){var{coordinate:t,translateX:r,translateY:n}=e;return bt(Eu,{["".concat(Eu,"-right")]:et(r)&&t&&et(t.x)&&r>=t.x,["".concat(Eu,"-left")]:et(r)&&t&&et(t.x)&&r<t.x,["".concat(Eu,"-bottom")]:et(n)&&t&&et(t.y)&&n>=t.y,["".concat(Eu,"-top")]:et(n)&&t&&et(t.y)&&n<t.y})}function NE(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:l,viewBox:f,viewBoxDimension:d}=e;if(i&&et(i[n]))return i[n];var h=r[n]-l-(a>0?a:0),m=r[n]+a;if(t[n])return s[n]?h:m;var x=f[n];if(x==null)return 0;if(s[n]){var g=h,y=x;return g<y?Math.max(m,x):Math.max(h,x)}if(d==null)return 0;var v=m+l,b=x+d;return v>b?Math.max(h,x):Math.max(m,x)}function Q8(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Z8(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:l,viewBox:f}=e,d,h,m;return s.height>0&&s.width>0&&r?(h=NE({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:f,viewBoxDimension:f.width}),m=NE({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:f,viewBoxDimension:f.height}),d=Q8({translateX:h,translateY:m,useTranslate3d:l})):d=Y8,{cssProperties:d,cssClasses:J8({translateX:h,translateY:m,coordinate:r})}}function EE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EE(Object(r),!0).forEach(function(n){Fv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fv(e,t,r){return(t=eR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eR(e){var t=tR(e,"string");return typeof t=="symbol"?t:t+""}function tR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class rR extends k.PureComponent{constructor(){super(...arguments),Fv(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Fv(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:l,isAnimationActive:f,offset:d,position:h,reverseDirection:m,useTranslate3d:x,viewBox:g,wrapperStyle:y,lastBoundingBox:v,innerRef:b,hasPortalFromProps:E}=this.props,{cssClasses:N,cssProperties:S}=Z8({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:d,position:h,reverseDirection:m,tooltipBox:{height:v.height,width:v.width},useTranslate3d:x,viewBox:g}),j=E?{}:d0(d0({transition:f&&t?"transform ".concat(n,"ms ").concat(a):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),T=d0(d0({},j),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},y);return k.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:N,style:T,ref:b},i)}}var nR=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),ll={devToolsEnabled:!1,isSsr:nR()},GC=()=>Ze(e=>e.rootProps.accessibilityLayer);function pa(e){return Number.isFinite(e)}function pc(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dv.apply(null,arguments)}function _E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_E(Object(r),!0).forEach(function(n){aR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_E(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aR(e,t,r){return(t=iR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iR(e){var t=sR(e,"string");return typeof t=="symbol"?t:t+""}function sR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jE={curveBasisClosed:_D,curveBasisOpen:kD,curveBasis:ED,curveBumpX:uD,curveBumpY:fD,curveLinearClosed:jD,curveLinear:Hh,curveMonotoneX:CD,curveMonotoneY:AD,curveNatural:TD,curveStep:PD,curveStepAfter:FD,curveStepBefore:OD},h0=e=>pa(e.x)&&pa(e.y),_u=e=>e.x,ku=e=>e.y,oR=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(jf(e));return(r==="curveMonotone"||r==="curveBump")&&t?jE["".concat(r).concat(t==="vertical"?"Y":"X")]:jE[r]||Hh},lR=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=oR(t,a),l=i?r.filter(h0):r,f;if(Array.isArray(n)){var d=i?n.filter(m=>h0(m)):n,h=l.map((m,x)=>kE(kE({},m),{},{base:d[x]}));return a==="vertical"?f=i0().y(ku).x1(_u).x0(m=>m.base.x):f=i0().x(_u).y1(ku).y0(m=>m.base.y),f.defined(h0).curve(s),f(h)}return a==="vertical"&&et(n)?f=i0().y(ku).x1(_u).x0(n):et(n)?f=i0().x(_u).y1(ku).y0(n):f=B4().x(_u).y(ku),f.defined(h0).curve(s),f(l)},KC=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?lR(e):n;return k.createElement("path",Dv({},to(e),Y5(e),{className:bt("recharts-curve",t),d:i===null?void 0:i,ref:a}))},cR=["x","y","top","left","width","height","className"];function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iv.apply(null,arguments)}function CE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CE(Object(r),!0).forEach(function(n){fR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fR(e,t,r){return(t=dR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dR(e){var t=hR(e,"string");return typeof t=="symbol"?t:t+""}function hR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mR(e,t){if(e==null)return{};var r,n,a=pR(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pR(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xR=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),gR=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:l}=e,f=mR(e,cR),d=uR({x:t,y:r,top:n,left:a,width:i,height:s},f);return!et(t)||!et(r)||!et(i)||!et(s)||!et(n)||!et(a)?null:k.createElement("path",Iv({},Dr(d,!0),{className:bt("recharts-cross",l),d:xR(t,r,i,s,n,a)}))};function vR(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function AE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AE(Object(r),!0).forEach(function(n){bR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bR(e,t,r){return(t=wR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wR(e){var t=SR(e,"string");return typeof t=="symbol"?t:t+""}function SR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rn(e,t){var r=yR({},e),n=t,a=Object.keys(t),i=a.reduce((s,l)=>(s[l]===void 0&&n[l]!==void 0&&(s[l]=n[l]),s),r);return i}function NR(){}function TE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function PE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TE(Object(r),!0).forEach(function(n){ER(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ER(e,t,r){return(t=_R(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _R(e){var t=kR(e,"string");return typeof t=="symbol"?t:t+""}function kR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jR=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),qC=(e,t,r)=>e.map(n=>"".concat(jR(n)," ").concat(t,"ms ").concat(r)).join(","),CR=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),rf=(e,t)=>Object.keys(t).reduce((r,n)=>PE(PE({},r),{},{[n]:e(n,t[n])}),{});function OE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ln(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OE(Object(r),!0).forEach(function(n){AR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AR(e,t,r){return(t=TR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TR(e){var t=PR(e,"string");return typeof t=="symbol"?t:t+""}function PR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eh=(e,t,r)=>e+(t-e)*r,Mv=e=>{var{from:t,to:r}=e;return t!==r},XC=(e,t,r)=>{var n=rf((a,i)=>{if(Mv(i)){var[s,l]=e(i.from,i.to,i.velocity);return ln(ln({},i),{},{from:s,velocity:l})}return i},t);return r<1?rf((a,i)=>Mv(i)?ln(ln({},i),{},{velocity:eh(i.velocity,n[a].velocity,r),from:eh(i.from,n[a].from,r)}):i,t):XC(e,n,r-1)};function OR(e,t,r,n,a,i){var s,l=n.reduce((x,g)=>ln(ln({},x),{},{[g]:{from:e[g],velocity:0,to:t[g]}}),{}),f=()=>rf((x,g)=>g.from,l),d=()=>!Object.values(l).filter(Mv).length,h=null,m=x=>{s||(s=x);var g=x-s,y=g/r.dt;l=XC(r,l,y),a(ln(ln(ln({},e),t),f())),s=x,d()||(h=i.setTimeout(m))};return()=>(h=i.setTimeout(m),()=>{h()})}function FR(e,t,r,n,a,i,s){var l=null,f=a.reduce((m,x)=>ln(ln({},m),{},{[x]:[e[x],t[x]]}),{}),d,h=m=>{d||(d=m);var x=(m-d)/n,g=rf((v,b)=>eh(...b,r(x)),f);if(i(ln(ln(ln({},e),t),g)),x<1)l=s.setTimeout(h);else{var y=rf((v,b)=>eh(...b,r(1)),f);i(ln(ln(ln({},e),t),y))}};return()=>(l=s.setTimeout(h),()=>{l()})}const DR=(e,t,r,n,a,i)=>{var s=CR(e,t);return r.isStepper===!0?OR(e,t,r,s,a,i):FR(e,t,r,n,s,a,i)};var th=1e-4,YC=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],JC=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),FE=(e,t)=>r=>{var n=YC(e,t);return JC(n,r)},IR=(e,t)=>r=>{var n=YC(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return JC(a,r)},DE=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var f=s[0].split("(");f[0]==="cubic-bezier"&&f[1].split(")")[0].split(",").length===4&&([t,n,r,a]=f[1].split(")")[0].split(",").map(y=>parseFloat(y)))}}else s.length===4&&([t,n,r,a]=s);var d=FE(t,r),h=FE(n,a),m=IR(t,r),x=y=>y>1?1:y<0?0:y,g=y=>{for(var v=y>1?1:y,b=v,E=0;E<8;++E){var N=d(b)-v,S=m(b);if(Math.abs(N-v)<th||S<th)return h(b);b=x(b-N/S)}return h(b)};return g.isStepper=!1,g},MR=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,l,f)=>{var d=-(s-l)*r,h=f*n,m=f+(d-h)*a/1e3,x=f*a/1e3+s;return Math.abs(x-l)<th&&Math.abs(m)<th?[l,0]:[x,m]};return i.isStepper=!0,i.dt=a,i},RR=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return DE(e);case"spring":return MR();default:if(e.split("(")[0]==="cubic-bezier")return DE(e)}return typeof e=="function"?e:null};function LR(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var l=s,[f,...d]=l;if(typeof f=="number"){a=e.setTimeout(i.bind(null,d),f);return}i(f),a=e.setTimeout(i.bind(null,d));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class BR{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function $R(){return LR(new BR)}var UR=k.createContext($R);function zR(e,t){var r=k.useContext(UR);return k.useMemo(()=>t??r(e),[e,t,r])}var WR={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},IE={t:0},Sg={t:1};function am(e){var t=Rn(e,WR),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:l,onAnimationStart:f,children:d}=t,h=zR(t.animationId,t.animationManager),[m,x]=k.useState(r?IE:Sg),g=k.useRef(null);return k.useEffect(()=>{r||x(Sg)},[r]),k.useEffect(()=>{if(!r||!n)return NR;var y=DR(IE,Sg,RR(i),a,x,h.getTimeoutController()),v=()=>{g.current=y()};return h.start([f,s,v,a,l]),()=>{h.stop(),g.current&&g.current(),l()}},[r,n,a,i,s,f,l,h]),d(m.t)}function im(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=k.useRef(Zu(t)),n=k.useRef(e);return n.current!==e&&(r.current=Zu(t),n.current=e),r.current}function ME(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ME(Object(r),!0).forEach(function(n){HR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ME(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HR(e,t,r){return(t=VR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VR(e){var t=GR(e,"string");return typeof t=="symbol"?t:t+""}function GR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rh(){return rh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rh.apply(null,arguments)}var LE=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,l=r>=0?1:-1,f=n>=0&&r>=0||n<0&&r<0?1:0,d;if(i>0&&a instanceof Array){for(var h=[0,0,0,0],m=0,x=4;m<x;m++)h[m]=a[m]>i?i:a[m];d="M".concat(e,",").concat(t+s*h[0]),h[0]>0&&(d+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(f,",").concat(e+l*h[0],",").concat(t)),d+="L ".concat(e+r-l*h[1],",").concat(t),h[1]>0&&(d+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(f,`,
        `).concat(e+r,",").concat(t+s*h[1])),d+="L ".concat(e+r,",").concat(t+n-s*h[2]),h[2]>0&&(d+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(f,`,
        `).concat(e+r-l*h[2],",").concat(t+n)),d+="L ".concat(e+l*h[3],",").concat(t+n),h[3]>0&&(d+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(f,`,
        `).concat(e,",").concat(t+n-s*h[3])),d+="Z"}else if(i>0&&a===+a&&a>0){var g=Math.min(i,a);d="M ".concat(e,",").concat(t+s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+l*g,",").concat(t,`
            L `).concat(e+r-l*g,",").concat(t,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+r,",").concat(t+s*g,`
            L `).concat(e+r,",").concat(t+n-s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+r-l*g,",").concat(t+n,`
            L `).concat(e+l*g,",").concat(t+n,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e,",").concat(t+n-s*g," Z")}else d="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return d},KR={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},QC=e=>{var t=Rn(e,KR),r=k.useRef(null),[n,a]=k.useState(-1);k.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var se=r.current.getTotalLength();se&&a(se)}catch{}},[]);var{x:i,y:s,width:l,height:f,radius:d,className:h}=t,{animationEasing:m,animationDuration:x,animationBegin:g,isAnimationActive:y,isUpdateAnimationActive:v}=t,b=k.useRef(l),E=k.useRef(f),N=k.useRef(i),S=k.useRef(s),j=k.useMemo(()=>({x:i,y:s,width:l,height:f,radius:d}),[i,s,l,f,d]),T=im(j,"rectangle-");if(i!==+i||s!==+s||l!==+l||f!==+f||l===0||f===0)return null;var C=bt("recharts-rectangle",h);if(!v)return k.createElement("path",rh({},Dr(t,!0),{className:C,d:LE(i,s,l,f,d)}));var P=b.current,M=E.current,D=N.current,W=S.current,F="0px ".concat(n===-1?1:n,"px"),L="".concat(n,"px 0px"),J=qC(["strokeDasharray"],x,typeof m=="string"?m:void 0);return k.createElement(am,{animationId:T,key:T,canBegin:n>0,duration:x,easing:m,isActive:v,begin:g},se=>{var Z=un(P,l,se),he=un(M,f,se),le=un(D,i,se),de=un(W,s,se);r.current&&(b.current=Z,E.current=he,N.current=le,S.current=de);var Q;return y?se>0?Q={transition:J,strokeDasharray:L}:Q={strokeDasharray:F}:Q={strokeDasharray:L},k.createElement("path",rh({},Dr(t,!0),{className:C,d:LE(le,de,Z,he,d),ref:r,style:RE(RE({},Q),t.style)}))})};function ZC(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=_r(t,r,n,a),l=_r(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Rv(){return Rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rv.apply(null,arguments)}var qR=(e,t)=>{var r=qr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},m0=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:l,cornerIsExternal:f}=e,d=l*(s?1:-1)+n,h=Math.asin(l/d)/Z0,m=f?a:a+i*h,x=_r(t,r,d,m),g=_r(t,r,n,m),y=f?a-i*h:a,v=_r(t,r,d*Math.cos(h*Z0),y);return{center:x,circleTangency:g,lineTangency:v,theta:h}},eA=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,l=qR(i,s),f=i+l,d=_r(t,r,a,i),h=_r(t,r,a,f),m="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(i>f),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(n>0){var x=_r(t,r,n,i),g=_r(t,r,n,f);m+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(i<=f),`,
            `).concat(x.x,",").concat(x.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},XR=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:l,startAngle:f,endAngle:d}=e,h=qr(d-f),{circleTangency:m,lineTangency:x,theta:g}=m0({cx:t,cy:r,radius:a,angle:f,sign:h,cornerRadius:i,cornerIsExternal:l}),{circleTangency:y,lineTangency:v,theta:b}=m0({cx:t,cy:r,radius:a,angle:d,sign:-h,cornerRadius:i,cornerIsExternal:l}),E=l?Math.abs(f-d):Math.abs(f-d)-g-b;if(E<0)return s?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):eA({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:f,endAngle:d});var N="M ".concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(E>180),",").concat(+(h<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(v.x,",").concat(v.y,`
  `);if(n>0){var{circleTangency:S,lineTangency:j,theta:T}=m0({cx:t,cy:r,radius:n,angle:f,sign:h,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:C,lineTangency:P,theta:M}=m0({cx:t,cy:r,radius:n,angle:d,sign:-h,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),D=l?Math.abs(f-d):Math.abs(f-d)-T-M;if(D<0&&i===0)return"".concat(N,"L").concat(t,",").concat(r,"Z");N+="L".concat(P.x,",").concat(P.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(C.x,",").concat(C.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(D>180),",").concat(+(h>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(j.x,",").concat(j.y,"Z")}else N+="L".concat(t,",").concat(r,"Z");return N},YR={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},tA=e=>{var t=Rn(e,YR),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:l,cornerIsExternal:f,startAngle:d,endAngle:h,className:m}=t;if(i<a||d===h)return null;var x=bt("recharts-sector",m),g=i-a,y=En(s,g,0,!0),v;return y>0&&Math.abs(d-h)<360?v=XR({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(y,g/2),forceCornerRadius:l,cornerIsExternal:f,startAngle:d,endAngle:h}):v=eA({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:h}),k.createElement("path",Rv({},Dr(t,!0),{className:x,d:v}))};function JR(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:f,innerRadius:d,outerRadius:h,angle:m}=t,x=_r(l,f,d,m),g=_r(l,f,h,m);n=x.x,a=x.y,i=g.x,s=g.y}else return ZC(t);return[{x:n,y:a},{x:i,y:s}]}var Ng={},Eg={},_g={},BE;function QR(){return BE||(BE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oC();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(_g)),_g}var $E;function ZR(){return $E||($E=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=QR();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(Eg)),Eg}var UE;function eL(){return UE||(UE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lC(),r=ZR();function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const l=Math.max(Math.ceil((i-a)/(s||1)),0),f=new Array(l);for(let d=0;d<l;d++)f[d]=a,a+=s;return f}e.range=n})(Ng)),Ng}var kg,zE;function tL(){return zE||(zE=1,kg=eL().range),kg}var rL=tL();const rA=Ei(rL);function Us(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function nL(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Q1(e){let t,r,n;e.length!==2?(t=Us,r=(l,f)=>Us(e(l),f),n=(l,f)=>e(l)-f):(t=e===Us||e===nL?e:aL,r=e,n=e);function a(l,f,d=0,h=l.length){if(d<h){if(t(f,f)!==0)return h;do{const m=d+h>>>1;r(l[m],f)<0?d=m+1:h=m}while(d<h)}return d}function i(l,f,d=0,h=l.length){if(d<h){if(t(f,f)!==0)return h;do{const m=d+h>>>1;r(l[m],f)<=0?d=m+1:h=m}while(d<h)}return d}function s(l,f,d=0,h=l.length){const m=a(l,f,d,h-1);return m>d&&n(l[m-1],f)>-n(l[m],f)?m-1:m}return{left:a,center:s,right:i}}function aL(){return 0}function nA(e){return e===null?NaN:+e}function*iL(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const sL=Q1(Us),Of=sL.right;Q1(nA).center;class WE extends Map{constructor(t,r=cL){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(HE(this,t))}has(t){return super.has(HE(this,t))}set(t,r){return super.set(oL(this,t),r)}delete(t){return super.delete(lL(this,t))}}function HE({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function oL({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function lL({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function cL(e){return e!==null&&typeof e=="object"?e.valueOf():e}function uL(e=Us){if(e===Us)return aA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function aA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const fL=Math.sqrt(50),dL=Math.sqrt(10),hL=Math.sqrt(2);function nh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=fL?10:i>=dL?5:i>=hL?2:1;let l,f,d;return a<0?(d=Math.pow(10,-a)/s,l=Math.round(e*d),f=Math.round(t*d),l/d<e&&++l,f/d>t&&--f,d=-d):(d=Math.pow(10,a)*s,l=Math.round(e/d),f=Math.round(t/d),l*d<e&&++l,f*d>t&&--f),f<l&&.5<=r&&r<2?nh(e,t,r*2):[l,f,d]}function Lv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?nh(t,e,r):nh(e,t,r);if(!(i>=a))return[];const l=i-a+1,f=new Array(l);if(n)if(s<0)for(let d=0;d<l;++d)f[d]=(i-d)/-s;else for(let d=0;d<l;++d)f[d]=(i-d)*s;else if(s<0)for(let d=0;d<l;++d)f[d]=(a+d)/-s;else for(let d=0;d<l;++d)f[d]=(a+d)*s;return f}function Bv(e,t,r){return t=+t,e=+e,r=+r,nh(e,t,r)[2]}function $v(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Bv(t,e,r):Bv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function VE(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function GE(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function iA(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?aA:uL(a);n>r;){if(n-r>600){const f=n-r+1,d=t-r+1,h=Math.log(f),m=.5*Math.exp(2*h/3),x=.5*Math.sqrt(h*m*(f-m)/f)*(d-f/2<0?-1:1),g=Math.max(r,Math.floor(t-d*m/f+x)),y=Math.min(n,Math.floor(t+(f-d)*m/f+x));iA(e,t,g,y,a)}const i=e[t];let s=r,l=n;for(ju(e,r,t),a(e[n],i)>0&&ju(e,r,n);s<l;){for(ju(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?ju(e,r,l):(++l,ju(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function ju(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function mL(e,t,r){if(e=Float64Array.from(iL(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return GE(e);if(t>=1)return VE(e);var n,a=(n-1)*t,i=Math.floor(a),s=VE(iA(e,i).subarray(0,i+1)),l=GE(e.subarray(i+1));return s+(l-s)*(a-i)}}function pL(e,t,r=nA){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function xL(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Ua(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ss(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Uv=Symbol("implicit");function Z1(){var e=new WE,t=[],r=[],n=Uv;function a(i){let s=e.get(i);if(s===void 0){if(n!==Uv)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new WE;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Z1(t,r).unknown(n)},Ua.apply(a,arguments),a}function ey(){var e=Z1().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,f=0,d=0,h=.5;delete e.unknown;function m(){var x=t().length,g=a<n,y=g?a:n,v=g?n:a;i=(v-y)/Math.max(1,x-f+d*2),l&&(i=Math.floor(i)),y+=(v-y-i*(x-f))*h,s=i*(1-f),l&&(y=Math.round(y),s=Math.round(s));var b=xL(x).map(function(E){return y+i*E});return r(g?b.reverse():b)}return e.domain=function(x){return arguments.length?(t(x),m()):t()},e.range=function(x){return arguments.length?([n,a]=x,n=+n,a=+a,m()):[n,a]},e.rangeRound=function(x){return[n,a]=x,n=+n,a=+a,l=!0,m()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(x){return arguments.length?(l=!!x,m()):l},e.padding=function(x){return arguments.length?(f=Math.min(1,d=+x),m()):f},e.paddingInner=function(x){return arguments.length?(f=Math.min(1,x),m()):f},e.paddingOuter=function(x){return arguments.length?(d=+x,m()):d},e.align=function(x){return arguments.length?(h=Math.max(0,Math.min(1,x)),m()):h},e.copy=function(){return ey(t(),[n,a]).round(l).paddingInner(f).paddingOuter(d).align(h)},Ua.apply(m(),arguments)}function sA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return sA(t())},e}function gL(){return sA(ey.apply(null,arguments).paddingInner(1))}function ty(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function oA(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Ff(){}var nf=.7,ah=1/nf,nc="\\s*([+-]?\\d+)\\s*",af="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",yi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vL=/^#([0-9a-f]{3,8})$/,yL=new RegExp(`^rgb\\(${nc},${nc},${nc}\\)$`),bL=new RegExp(`^rgb\\(${yi},${yi},${yi}\\)$`),wL=new RegExp(`^rgba\\(${nc},${nc},${nc},${af}\\)$`),SL=new RegExp(`^rgba\\(${yi},${yi},${yi},${af}\\)$`),NL=new RegExp(`^hsl\\(${af},${yi},${yi}\\)$`),EL=new RegExp(`^hsla\\(${af},${yi},${yi},${af}\\)$`),KE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ty(Ff,sf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:qE,formatHex:qE,formatHex8:_L,formatHsl:kL,formatRgb:XE,toString:XE});function qE(){return this.rgb().formatHex()}function _L(){return this.rgb().formatHex8()}function kL(){return lA(this).formatHsl()}function XE(){return this.rgb().formatRgb()}function sf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=vL.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?YE(t):r===3?new Yn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?p0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?p0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yL.exec(e))?new Yn(t[1],t[2],t[3],1):(t=bL.exec(e))?new Yn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=wL.exec(e))?p0(t[1],t[2],t[3],t[4]):(t=SL.exec(e))?p0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=NL.exec(e))?ZE(t[1],t[2]/100,t[3]/100,1):(t=EL.exec(e))?ZE(t[1],t[2]/100,t[3]/100,t[4]):KE.hasOwnProperty(e)?YE(KE[e]):e==="transparent"?new Yn(NaN,NaN,NaN,0):null}function YE(e){return new Yn(e>>16&255,e>>8&255,e&255,1)}function p0(e,t,r,n){return n<=0&&(e=t=r=NaN),new Yn(e,t,r,n)}function jL(e){return e instanceof Ff||(e=sf(e)),e?(e=e.rgb(),new Yn(e.r,e.g,e.b,e.opacity)):new Yn}function zv(e,t,r,n){return arguments.length===1?jL(e):new Yn(e,t,r,n??1)}function Yn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}ty(Yn,zv,oA(Ff,{brighter(e){return e=e==null?ah:Math.pow(ah,e),new Yn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?nf:Math.pow(nf,e),new Yn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Yn(Lo(this.r),Lo(this.g),Lo(this.b),ih(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:JE,formatHex:JE,formatHex8:CL,formatRgb:QE,toString:QE}));function JE(){return`#${Oo(this.r)}${Oo(this.g)}${Oo(this.b)}`}function CL(){return`#${Oo(this.r)}${Oo(this.g)}${Oo(this.b)}${Oo((isNaN(this.opacity)?1:this.opacity)*255)}`}function QE(){const e=ih(this.opacity);return`${e===1?"rgb(":"rgba("}${Lo(this.r)}, ${Lo(this.g)}, ${Lo(this.b)}${e===1?")":`, ${e})`}`}function ih(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Lo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Oo(e){return e=Lo(e),(e<16?"0":"")+e.toString(16)}function ZE(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Za(e,t,r,n)}function lA(e){if(e instanceof Za)return new Za(e.h,e.s,e.l,e.opacity);if(e instanceof Ff||(e=sf(e)),!e)return new Za;if(e instanceof Za)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,f=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=f<.5?i+a:2-i-a,s*=60):l=f>0&&f<1?0:s,new Za(s,l,f,e.opacity)}function AL(e,t,r,n){return arguments.length===1?lA(e):new Za(e,t,r,n??1)}function Za(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ty(Za,AL,oA(Ff,{brighter(e){return e=e==null?ah:Math.pow(ah,e),new Za(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?nf:Math.pow(nf,e),new Za(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Yn(jg(e>=240?e-240:e+120,a,n),jg(e,a,n),jg(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Za(e_(this.h),x0(this.s),x0(this.l),ih(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ih(this.opacity);return`${e===1?"hsl(":"hsla("}${e_(this.h)}, ${x0(this.s)*100}%, ${x0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function e_(e){return e=(e||0)%360,e<0?e+360:e}function x0(e){return Math.max(0,Math.min(1,e||0))}function jg(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const ry=e=>()=>e;function TL(e,t){return function(r){return e+r*t}}function PL(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function OL(e){return(e=+e)==1?cA:function(t,r){return r-t?PL(t,r,e):ry(isNaN(t)?r:t)}}function cA(e,t){var r=t-e;return r?TL(e,r):ry(isNaN(e)?t:e)}const t_=(function e(t){var r=OL(t);function n(a,i){var s=r((a=zv(a)).r,(i=zv(i)).r),l=r(a.g,i.g),f=r(a.b,i.b),d=cA(a.opacity,i.opacity);return function(h){return a.r=s(h),a.g=l(h),a.b=f(h),a.opacity=d(h),a+""}}return n.gamma=e,n})(1);function FL(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function DL(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function IL(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=jc(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function ML(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function sh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function RL(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=jc(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Wv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cg=new RegExp(Wv.source,"g");function LL(e){return function(){return e}}function BL(e){return function(t){return e(t)+""}}function $L(e,t){var r=Wv.lastIndex=Cg.lastIndex=0,n,a,i,s=-1,l=[],f=[];for(e=e+"",t=t+"";(n=Wv.exec(e))&&(a=Cg.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,f.push({i:s,x:sh(n,a)})),r=Cg.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?f[0]?BL(f[0].x):LL(t):(t=f.length,function(d){for(var h=0,m;h<t;++h)l[(m=f[h]).i]=m.x(d);return l.join("")})}function jc(e,t){var r=typeof t,n;return t==null||r==="boolean"?ry(t):(r==="number"?sh:r==="string"?(n=sf(t))?(t=n,t_):$L:t instanceof sf?t_:t instanceof Date?ML:DL(t)?FL:Array.isArray(t)?IL:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?RL:sh)(e,t)}function ny(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function UL(e,t){t===void 0&&(t=e,e=jc);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function zL(e){return function(){return e}}function oh(e){return+e}var r_=[0,1];function Dn(e){return e}function Hv(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:zL(isNaN(t)?NaN:.5)}function WL(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function HL(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=Hv(a,n),i=r(s,i)):(n=Hv(n,a),i=r(i,s)),function(l){return i(n(l))}}function VL(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=Hv(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var f=Of(e,l,1,n)-1;return i[f](a[f](l))}}function Df(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function sm(){var e=r_,t=r_,r=jc,n,a,i,s=Dn,l,f,d;function h(){var x=Math.min(e.length,t.length);return s!==Dn&&(s=WL(e[0],e[x-1])),l=x>2?VL:HL,f=d=null,m}function m(x){return x==null||isNaN(x=+x)?i:(f||(f=l(e.map(n),t,r)))(n(s(x)))}return m.invert=function(x){return s(a((d||(d=l(t,e.map(n),sh)))(x)))},m.domain=function(x){return arguments.length?(e=Array.from(x,oh),h()):e.slice()},m.range=function(x){return arguments.length?(t=Array.from(x),h()):t.slice()},m.rangeRound=function(x){return t=Array.from(x),r=ny,h()},m.clamp=function(x){return arguments.length?(s=x?!0:Dn,h()):s!==Dn},m.interpolate=function(x){return arguments.length?(r=x,h()):r},m.unknown=function(x){return arguments.length?(i=x,m):i},function(x,g){return n=x,a=g,h()}}function ay(){return sm()(Dn,Dn)}function GL(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function lh(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function xc(e){return e=lh(Math.abs(e)),e?e[1]:NaN}function KL(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],f=0;a>0&&l>0&&(f+l+1>n&&(l=Math.max(1,n-f)),i.push(r.substring(a-=l,a+l)),!((f+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function qL(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var XL=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function of(e){if(!(t=XL.exec(e)))throw new Error("invalid format: "+e);var t;return new iy({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}of.prototype=iy.prototype;function iy(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}iy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function YL(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var uA;function JL(e,t){var r=lh(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(uA=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+lh(e,Math.max(0,t+i-1))[0]}function n_(e,t){var r=lh(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const a_={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:GL,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>n_(e*100,t),r:n_,s:JL,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function i_(e){return e}var s_=Array.prototype.map,o_=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function QL(e){var t=e.grouping===void 0||e.thousands===void 0?i_:KL(s_.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?i_:qL(s_.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function d(m){m=of(m);var x=m.fill,g=m.align,y=m.sign,v=m.symbol,b=m.zero,E=m.width,N=m.comma,S=m.precision,j=m.trim,T=m.type;T==="n"?(N=!0,T="g"):a_[T]||(S===void 0&&(S=12),j=!0,T="g"),(b||x==="0"&&g==="=")&&(b=!0,x="0",g="=");var C=v==="$"?r:v==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",P=v==="$"?n:/[%p]/.test(T)?s:"",M=a_[T],D=/[defgprs%]/.test(T);S=S===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function W(F){var L=C,J=P,se,Z,he;if(T==="c")J=M(F)+J,F="";else{F=+F;var le=F<0||1/F<0;if(F=isNaN(F)?f:M(Math.abs(F),S),j&&(F=YL(F)),le&&+F==0&&y!=="+"&&(le=!1),L=(le?y==="("?y:l:y==="-"||y==="("?"":y)+L,J=(T==="s"?o_[8+uA/3]:"")+J+(le&&y==="("?")":""),D){for(se=-1,Z=F.length;++se<Z;)if(he=F.charCodeAt(se),48>he||he>57){J=(he===46?a+F.slice(se+1):F.slice(se))+J,F=F.slice(0,se);break}}}N&&!b&&(F=t(F,1/0));var de=L.length+F.length+J.length,Q=de<E?new Array(E-de+1).join(x):"";switch(N&&b&&(F=t(Q+F,Q.length?E-J.length:1/0),Q=""),g){case"<":F=L+F+J+Q;break;case"=":F=L+Q+F+J;break;case"^":F=Q.slice(0,de=Q.length>>1)+L+F+J+Q.slice(de);break;default:F=Q+L+F+J;break}return i(F)}return W.toString=function(){return m+""},W}function h(m,x){var g=d((m=of(m),m.type="f",m)),y=Math.max(-8,Math.min(8,Math.floor(xc(x)/3)))*3,v=Math.pow(10,-y),b=o_[8+y/3];return function(E){return g(v*E)+b}}return{format:d,formatPrefix:h}}var g0,sy,fA;ZL({thousands:",",grouping:[3],currency:["$",""]});function ZL(e){return g0=QL(e),sy=g0.format,fA=g0.formatPrefix,g0}function e7(e){return Math.max(0,-xc(Math.abs(e)))}function t7(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(xc(t)/3)))*3-xc(Math.abs(e)))}function r7(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,xc(t)-xc(e))+1}function dA(e,t,r,n){var a=$v(e,t,r),i;switch(n=of(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=t7(a,s))&&(n.precision=i),fA(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=r7(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=e7(a))&&(n.precision=i-(n.type==="%")*2);break}}return sy(n)}function ro(e){var t=e.domain;return e.ticks=function(r){var n=t();return Lv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return dA(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],f,d,h=10;for(l<s&&(d=s,s=l,l=d,d=a,a=i,i=d);h-- >0;){if(d=Bv(s,l,r),d===f)return n[a]=s,n[i]=l,t(n);if(d>0)s=Math.floor(s/d)*d,l=Math.ceil(l/d)*d;else if(d<0)s=Math.ceil(s*d)/d,l=Math.floor(l*d)/d;else break;f=d}return e},e}function hA(){var e=ay();return e.copy=function(){return Df(e,hA())},Ua.apply(e,arguments),ro(e)}function mA(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,oh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return mA(e).unknown(t)},e=arguments.length?Array.from(e,oh):[0,1],ro(r)}function pA(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function l_(e){return Math.log(e)}function c_(e){return Math.exp(e)}function n7(e){return-Math.log(-e)}function a7(e){return-Math.exp(-e)}function i7(e){return isFinite(e)?+("1e"+e):e<0?0:e}function s7(e){return e===10?i7:e===Math.E?Math.exp:t=>Math.pow(e,t)}function o7(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function u_(e){return(t,r)=>-e(-t,r)}function oy(e){const t=e(l_,c_),r=t.domain;let n=10,a,i;function s(){return a=o7(n),i=s7(n),r()[0]<0?(a=u_(a),i=u_(i),e(n7,a7)):e(l_,c_),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const f=r();let d=f[0],h=f[f.length-1];const m=h<d;m&&([d,h]=[h,d]);let x=a(d),g=a(h),y,v;const b=l==null?10:+l;let E=[];if(!(n%1)&&g-x<b){if(x=Math.floor(x),g=Math.ceil(g),d>0){for(;x<=g;++x)for(y=1;y<n;++y)if(v=x<0?y/i(-x):y*i(x),!(v<d)){if(v>h)break;E.push(v)}}else for(;x<=g;++x)for(y=n-1;y>=1;--y)if(v=x>0?y/i(-x):y*i(x),!(v<d)){if(v>h)break;E.push(v)}E.length*2<b&&(E=Lv(d,h,b))}else E=Lv(x,g,Math.min(g-x,b)).map(i);return m?E.reverse():E},t.tickFormat=(l,f)=>{if(l==null&&(l=10),f==null&&(f=n===10?"s":","),typeof f!="function"&&(!(n%1)&&(f=of(f)).precision==null&&(f.trim=!0),f=sy(f)),l===1/0)return f;const d=Math.max(1,n*l/t.ticks().length);return h=>{let m=h/i(Math.round(a(h)));return m*n<n-.5&&(m*=n),m<=d?f(h):""}},t.nice=()=>r(pA(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function xA(){const e=oy(sm()).domain([1,10]);return e.copy=()=>Df(e,xA()).base(e.base()),Ua.apply(e,arguments),e}function f_(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function d_(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ly(e){var t=1,r=e(f_(t),d_(t));return r.constant=function(n){return arguments.length?e(f_(t=+n),d_(t)):t},ro(r)}function gA(){var e=ly(sm());return e.copy=function(){return Df(e,gA()).constant(e.constant())},Ua.apply(e,arguments)}function h_(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function l7(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function c7(e){return e<0?-e*e:e*e}function cy(e){var t=e(Dn,Dn),r=1;function n(){return r===1?e(Dn,Dn):r===.5?e(l7,c7):e(h_(r),h_(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},ro(t)}function uy(){var e=cy(sm());return e.copy=function(){return Df(e,uy()).exponent(e.exponent())},Ua.apply(e,arguments),e}function u7(){return uy.apply(null,arguments).exponent(.5)}function m_(e){return Math.sign(e)*e*e}function f7(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function vA(){var e=ay(),t=[0,1],r=!1,n;function a(i){var s=f7(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(m_(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,oh)).map(m_)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return vA(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ua.apply(a,arguments),ro(a)}function yA(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=pL(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Of(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Us),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return yA().domain(e).range(t).unknown(n)},Ua.apply(i,arguments)}function bA(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(f){return f!=null&&f<=f?a[Of(n,f,0,r)]:i}function l(){var f=-1;for(n=new Array(r);++f<r;)n[f]=((f+1)*t-(f-r)*e)/(r+1);return s}return s.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,l()):[e,t]},s.range=function(f){return arguments.length?(r=(a=Array.from(f)).length-1,l()):a.slice()},s.invertExtent=function(f){var d=a.indexOf(f);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},s.unknown=function(f){return arguments.length&&(i=f),s},s.thresholds=function(){return n.slice()},s.copy=function(){return bA().domain([e,t]).range(a).unknown(i)},Ua.apply(ro(s),arguments)}function wA(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Of(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return wA().domain(e).range(t).unknown(r)},Ua.apply(a,arguments)}const Ag=new Date,Tg=new Date;function Rr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const f=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return f;let d;do f.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<s);return f},a.filter=i=>Rr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Ag.setTime(+i),Tg.setTime(+s),e(Ag),e(Tg),Math.floor(r(Ag,Tg))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const ch=Rr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ch.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Rr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):ch);ch.range;const Ui=1e3,Ia=Ui*60,zi=Ia*60,es=zi*24,fy=es*7,p_=es*30,Pg=es*365,Fo=Rr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ui)},(e,t)=>(t-e)/Ui,e=>e.getUTCSeconds());Fo.range;const dy=Rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ui)},(e,t)=>{e.setTime(+e+t*Ia)},(e,t)=>(t-e)/Ia,e=>e.getMinutes());dy.range;const hy=Rr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ia)},(e,t)=>(t-e)/Ia,e=>e.getUTCMinutes());hy.range;const my=Rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ui-e.getMinutes()*Ia)},(e,t)=>{e.setTime(+e+t*zi)},(e,t)=>(t-e)/zi,e=>e.getHours());my.range;const py=Rr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*zi)},(e,t)=>(t-e)/zi,e=>e.getUTCHours());py.range;const If=Rr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ia)/es,e=>e.getDate()-1);If.range;const om=Rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/es,e=>e.getUTCDate()-1);om.range;const SA=Rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/es,e=>Math.floor(e/es));SA.range;function cl(e){return Rr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ia)/fy)}const lm=cl(0),uh=cl(1),d7=cl(2),h7=cl(3),gc=cl(4),m7=cl(5),p7=cl(6);lm.range;uh.range;d7.range;h7.range;gc.range;m7.range;p7.range;function ul(e){return Rr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/fy)}const cm=ul(0),fh=ul(1),x7=ul(2),g7=ul(3),vc=ul(4),v7=ul(5),y7=ul(6);cm.range;fh.range;x7.range;g7.range;vc.range;v7.range;y7.range;const xy=Rr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());xy.range;const gy=Rr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());gy.range;const ts=Rr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ts.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Rr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ts.range;const rs=Rr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());rs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Rr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});rs.range;function NA(e,t,r,n,a,i){const s=[[Fo,1,Ui],[Fo,5,5*Ui],[Fo,15,15*Ui],[Fo,30,30*Ui],[i,1,Ia],[i,5,5*Ia],[i,15,15*Ia],[i,30,30*Ia],[a,1,zi],[a,3,3*zi],[a,6,6*zi],[a,12,12*zi],[n,1,es],[n,2,2*es],[r,1,fy],[t,1,p_],[t,3,3*p_],[e,1,Pg]];function l(d,h,m){const x=h<d;x&&([d,h]=[h,d]);const g=m&&typeof m.range=="function"?m:f(d,h,m),y=g?g.range(d,+h+1):[];return x?y.reverse():y}function f(d,h,m){const x=Math.abs(h-d)/m,g=Q1(([,,b])=>b).right(s,x);if(g===s.length)return e.every($v(d/Pg,h/Pg,m));if(g===0)return ch.every(Math.max($v(d,h,m),1));const[y,v]=s[x/s[g-1][2]<s[g][2]/x?g-1:g];return y.every(v)}return[l,f]}const[b7,w7]=NA(rs,gy,cm,SA,py,hy),[S7,N7]=NA(ts,xy,lm,If,my,dy);function Og(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Fg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Cu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function E7(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,f=e.shortMonths,d=Au(a),h=Tu(a),m=Au(i),x=Tu(i),g=Au(s),y=Tu(s),v=Au(l),b=Tu(l),E=Au(f),N=Tu(f),S={a:le,A:de,b:Q,B:pe,c:null,d:w_,e:w_,f:K7,g:n9,G:i9,H:H7,I:V7,j:G7,L:EA,m:q7,M:X7,p:re,q:O,Q:E_,s:__,S:Y7,u:J7,U:Q7,V:Z7,w:e9,W:t9,x:null,X:null,y:r9,Y:a9,Z:s9,"%":N_},j={a:V,A:H,b:q,B:K,c:null,d:S_,e:S_,f:u9,g:b9,G:S9,H:o9,I:l9,j:c9,L:kA,m:f9,M:d9,p:ie,q:B,Q:E_,s:__,S:h9,u:m9,U:p9,V:x9,w:g9,W:v9,x:null,X:null,y:y9,Y:w9,Z:N9,"%":N_},T={a:W,A:F,b:L,B:J,c:se,d:y_,e:y_,f:$7,g:v_,G:g_,H:b_,I:b_,j:M7,L:B7,m:I7,M:R7,p:D,q:D7,Q:z7,s:W7,S:L7,u:A7,U:T7,V:P7,w:C7,W:O7,x:Z,X:he,y:v_,Y:g_,Z:F7,"%":U7};S.x=C(r,S),S.X=C(n,S),S.c=C(t,S),j.x=C(r,j),j.X=C(n,j),j.c=C(t,j);function C(z,G){return function(ce){var I=[],Ae=-1,je=0,Le=z.length,Ue,Pe,lt;for(ce instanceof Date||(ce=new Date(+ce));++Ae<Le;)z.charCodeAt(Ae)===37&&(I.push(z.slice(je,Ae)),(Pe=x_[Ue=z.charAt(++Ae)])!=null?Ue=z.charAt(++Ae):Pe=Ue==="e"?" ":"0",(lt=G[Ue])&&(Ue=lt(ce,Pe)),I.push(Ue),je=Ae+1);return I.push(z.slice(je,Ae)),I.join("")}}function P(z,G){return function(ce){var I=Cu(1900,void 0,1),Ae=M(I,z,ce+="",0),je,Le;if(Ae!=ce.length)return null;if("Q"in I)return new Date(I.Q);if("s"in I)return new Date(I.s*1e3+("L"in I?I.L:0));if(G&&!("Z"in I)&&(I.Z=0),"p"in I&&(I.H=I.H%12+I.p*12),I.m===void 0&&(I.m="q"in I?I.q:0),"V"in I){if(I.V<1||I.V>53)return null;"w"in I||(I.w=1),"Z"in I?(je=Fg(Cu(I.y,0,1)),Le=je.getUTCDay(),je=Le>4||Le===0?fh.ceil(je):fh(je),je=om.offset(je,(I.V-1)*7),I.y=je.getUTCFullYear(),I.m=je.getUTCMonth(),I.d=je.getUTCDate()+(I.w+6)%7):(je=Og(Cu(I.y,0,1)),Le=je.getDay(),je=Le>4||Le===0?uh.ceil(je):uh(je),je=If.offset(je,(I.V-1)*7),I.y=je.getFullYear(),I.m=je.getMonth(),I.d=je.getDate()+(I.w+6)%7)}else("W"in I||"U"in I)&&("w"in I||(I.w="u"in I?I.u%7:"W"in I?1:0),Le="Z"in I?Fg(Cu(I.y,0,1)).getUTCDay():Og(Cu(I.y,0,1)).getDay(),I.m=0,I.d="W"in I?(I.w+6)%7+I.W*7-(Le+5)%7:I.w+I.U*7-(Le+6)%7);return"Z"in I?(I.H+=I.Z/100|0,I.M+=I.Z%100,Fg(I)):Og(I)}}function M(z,G,ce,I){for(var Ae=0,je=G.length,Le=ce.length,Ue,Pe;Ae<je;){if(I>=Le)return-1;if(Ue=G.charCodeAt(Ae++),Ue===37){if(Ue=G.charAt(Ae++),Pe=T[Ue in x_?G.charAt(Ae++):Ue],!Pe||(I=Pe(z,ce,I))<0)return-1}else if(Ue!=ce.charCodeAt(I++))return-1}return I}function D(z,G,ce){var I=d.exec(G.slice(ce));return I?(z.p=h.get(I[0].toLowerCase()),ce+I[0].length):-1}function W(z,G,ce){var I=g.exec(G.slice(ce));return I?(z.w=y.get(I[0].toLowerCase()),ce+I[0].length):-1}function F(z,G,ce){var I=m.exec(G.slice(ce));return I?(z.w=x.get(I[0].toLowerCase()),ce+I[0].length):-1}function L(z,G,ce){var I=E.exec(G.slice(ce));return I?(z.m=N.get(I[0].toLowerCase()),ce+I[0].length):-1}function J(z,G,ce){var I=v.exec(G.slice(ce));return I?(z.m=b.get(I[0].toLowerCase()),ce+I[0].length):-1}function se(z,G,ce){return M(z,t,G,ce)}function Z(z,G,ce){return M(z,r,G,ce)}function he(z,G,ce){return M(z,n,G,ce)}function le(z){return s[z.getDay()]}function de(z){return i[z.getDay()]}function Q(z){return f[z.getMonth()]}function pe(z){return l[z.getMonth()]}function re(z){return a[+(z.getHours()>=12)]}function O(z){return 1+~~(z.getMonth()/3)}function V(z){return s[z.getUTCDay()]}function H(z){return i[z.getUTCDay()]}function q(z){return f[z.getUTCMonth()]}function K(z){return l[z.getUTCMonth()]}function ie(z){return a[+(z.getUTCHours()>=12)]}function B(z){return 1+~~(z.getUTCMonth()/3)}return{format:function(z){var G=C(z+="",S);return G.toString=function(){return z},G},parse:function(z){var G=P(z+="",!1);return G.toString=function(){return z},G},utcFormat:function(z){var G=C(z+="",j);return G.toString=function(){return z},G},utcParse:function(z){var G=P(z+="",!0);return G.toString=function(){return z},G}}}var x_={"-":"",_:" ",0:"0"},Qr=/^\s*\d+/,_7=/^%/,k7=/[\\^$*+?|[\]().{}]/g;function Et(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function j7(e){return e.replace(k7,"\\$&")}function Au(e){return new RegExp("^(?:"+e.map(j7).join("|")+")","i")}function Tu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function C7(e,t,r){var n=Qr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function A7(e,t,r){var n=Qr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function T7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function P7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function O7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function g_(e,t,r){var n=Qr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function v_(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function F7(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function D7(e,t,r){var n=Qr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function I7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function y_(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function M7(e,t,r){var n=Qr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function b_(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function R7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function L7(e,t,r){var n=Qr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function B7(e,t,r){var n=Qr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function $7(e,t,r){var n=Qr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function U7(e,t,r){var n=_7.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function z7(e,t,r){var n=Qr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function W7(e,t,r){var n=Qr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function w_(e,t){return Et(e.getDate(),t,2)}function H7(e,t){return Et(e.getHours(),t,2)}function V7(e,t){return Et(e.getHours()%12||12,t,2)}function G7(e,t){return Et(1+If.count(ts(e),e),t,3)}function EA(e,t){return Et(e.getMilliseconds(),t,3)}function K7(e,t){return EA(e,t)+"000"}function q7(e,t){return Et(e.getMonth()+1,t,2)}function X7(e,t){return Et(e.getMinutes(),t,2)}function Y7(e,t){return Et(e.getSeconds(),t,2)}function J7(e){var t=e.getDay();return t===0?7:t}function Q7(e,t){return Et(lm.count(ts(e)-1,e),t,2)}function _A(e){var t=e.getDay();return t>=4||t===0?gc(e):gc.ceil(e)}function Z7(e,t){return e=_A(e),Et(gc.count(ts(e),e)+(ts(e).getDay()===4),t,2)}function e9(e){return e.getDay()}function t9(e,t){return Et(uh.count(ts(e)-1,e),t,2)}function r9(e,t){return Et(e.getFullYear()%100,t,2)}function n9(e,t){return e=_A(e),Et(e.getFullYear()%100,t,2)}function a9(e,t){return Et(e.getFullYear()%1e4,t,4)}function i9(e,t){var r=e.getDay();return e=r>=4||r===0?gc(e):gc.ceil(e),Et(e.getFullYear()%1e4,t,4)}function s9(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Et(t/60|0,"0",2)+Et(t%60,"0",2)}function S_(e,t){return Et(e.getUTCDate(),t,2)}function o9(e,t){return Et(e.getUTCHours(),t,2)}function l9(e,t){return Et(e.getUTCHours()%12||12,t,2)}function c9(e,t){return Et(1+om.count(rs(e),e),t,3)}function kA(e,t){return Et(e.getUTCMilliseconds(),t,3)}function u9(e,t){return kA(e,t)+"000"}function f9(e,t){return Et(e.getUTCMonth()+1,t,2)}function d9(e,t){return Et(e.getUTCMinutes(),t,2)}function h9(e,t){return Et(e.getUTCSeconds(),t,2)}function m9(e){var t=e.getUTCDay();return t===0?7:t}function p9(e,t){return Et(cm.count(rs(e)-1,e),t,2)}function jA(e){var t=e.getUTCDay();return t>=4||t===0?vc(e):vc.ceil(e)}function x9(e,t){return e=jA(e),Et(vc.count(rs(e),e)+(rs(e).getUTCDay()===4),t,2)}function g9(e){return e.getUTCDay()}function v9(e,t){return Et(fh.count(rs(e)-1,e),t,2)}function y9(e,t){return Et(e.getUTCFullYear()%100,t,2)}function b9(e,t){return e=jA(e),Et(e.getUTCFullYear()%100,t,2)}function w9(e,t){return Et(e.getUTCFullYear()%1e4,t,4)}function S9(e,t){var r=e.getUTCDay();return e=r>=4||r===0?vc(e):vc.ceil(e),Et(e.getUTCFullYear()%1e4,t,4)}function N9(){return"+0000"}function N_(){return"%"}function E_(e){return+e}function __(e){return Math.floor(+e/1e3)}var Wl,CA,AA;E9({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function E9(e){return Wl=E7(e),CA=Wl.format,Wl.parse,AA=Wl.utcFormat,Wl.utcParse,Wl}function _9(e){return new Date(e)}function k9(e){return e instanceof Date?+e:+new Date(+e)}function vy(e,t,r,n,a,i,s,l,f,d){var h=ay(),m=h.invert,x=h.domain,g=d(".%L"),y=d(":%S"),v=d("%I:%M"),b=d("%I %p"),E=d("%a %d"),N=d("%b %d"),S=d("%B"),j=d("%Y");function T(C){return(f(C)<C?g:l(C)<C?y:s(C)<C?v:i(C)<C?b:n(C)<C?a(C)<C?E:N:r(C)<C?S:j)(C)}return h.invert=function(C){return new Date(m(C))},h.domain=function(C){return arguments.length?x(Array.from(C,k9)):x().map(_9)},h.ticks=function(C){var P=x();return e(P[0],P[P.length-1],C??10)},h.tickFormat=function(C,P){return P==null?T:d(P)},h.nice=function(C){var P=x();return(!C||typeof C.range!="function")&&(C=t(P[0],P[P.length-1],C??10)),C?x(pA(P,C)):h},h.copy=function(){return Df(h,vy(e,t,r,n,a,i,s,l,f,d))},h}function j9(){return Ua.apply(vy(S7,N7,ts,xy,lm,If,my,dy,Fo,CA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function C9(){return Ua.apply(vy(b7,w7,rs,gy,cm,om,py,hy,Fo,AA).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function um(){var e=0,t=1,r,n,a,i,s=Dn,l=!1,f;function d(m){return m==null||isNaN(m=+m)?f:s(a===0?.5:(m=(i(m)-r)*a,l?Math.max(0,Math.min(1,m)):m))}d.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(m){return arguments.length?(l=!!m,d):l},d.interpolator=function(m){return arguments.length?(s=m,d):s};function h(m){return function(x){var g,y;return arguments.length?([g,y]=x,s=m(g,y),d):[s(0),s(1)]}}return d.range=h(jc),d.rangeRound=h(ny),d.unknown=function(m){return arguments.length?(f=m,d):f},function(m){return i=m,r=m(e),n=m(t),a=r===n?0:1/(n-r),d}}function no(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function TA(){var e=ro(um()(Dn));return e.copy=function(){return no(e,TA())},ss.apply(e,arguments)}function PA(){var e=oy(um()).domain([1,10]);return e.copy=function(){return no(e,PA()).base(e.base())},ss.apply(e,arguments)}function OA(){var e=ly(um());return e.copy=function(){return no(e,OA()).constant(e.constant())},ss.apply(e,arguments)}function yy(){var e=cy(um());return e.copy=function(){return no(e,yy()).exponent(e.exponent())},ss.apply(e,arguments)}function A9(){return yy.apply(null,arguments).exponent(.5)}function FA(){var e=[],t=Dn;function r(n){if(n!=null&&!isNaN(n=+n))return t((Of(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Us),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>mL(e,i/n))},r.copy=function(){return FA(t).domain(e)},ss.apply(r,arguments)}function fm(){var e=0,t=.5,r=1,n=1,a,i,s,l,f,d=Dn,h,m=!1,x;function g(v){return isNaN(v=+v)?x:(v=.5+((v=+h(v))-i)*(n*v<n*i?l:f),d(m?Math.max(0,Math.min(1,v)):v))}g.domain=function(v){return arguments.length?([e,t,r]=v,a=h(e=+e),i=h(t=+t),s=h(r=+r),l=a===i?0:.5/(i-a),f=i===s?0:.5/(s-i),n=i<a?-1:1,g):[e,t,r]},g.clamp=function(v){return arguments.length?(m=!!v,g):m},g.interpolator=function(v){return arguments.length?(d=v,g):d};function y(v){return function(b){var E,N,S;return arguments.length?([E,N,S]=b,d=UL(v,[E,N,S]),g):[d(0),d(.5),d(1)]}}return g.range=y(jc),g.rangeRound=y(ny),g.unknown=function(v){return arguments.length?(x=v,g):x},function(v){return h=v,a=v(e),i=v(t),s=v(r),l=a===i?0:.5/(i-a),f=i===s?0:.5/(s-i),n=i<a?-1:1,g}}function DA(){var e=ro(fm()(Dn));return e.copy=function(){return no(e,DA())},ss.apply(e,arguments)}function IA(){var e=oy(fm()).domain([.1,1,10]);return e.copy=function(){return no(e,IA()).base(e.base())},ss.apply(e,arguments)}function MA(){var e=ly(fm());return e.copy=function(){return no(e,MA()).constant(e.constant())},ss.apply(e,arguments)}function by(){var e=cy(fm());return e.copy=function(){return no(e,by()).exponent(e.exponent())},ss.apply(e,arguments)}function T9(){return by.apply(null,arguments).exponent(.5)}const Iu=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:ey,scaleDiverging:DA,scaleDivergingLog:IA,scaleDivergingPow:by,scaleDivergingSqrt:T9,scaleDivergingSymlog:MA,scaleIdentity:mA,scaleImplicit:Uv,scaleLinear:hA,scaleLog:xA,scaleOrdinal:Z1,scalePoint:gL,scalePow:uy,scaleQuantile:yA,scaleQuantize:bA,scaleRadial:vA,scaleSequential:TA,scaleSequentialLog:PA,scaleSequentialPow:yy,scaleSequentialQuantile:FA,scaleSequentialSqrt:A9,scaleSequentialSymlog:OA,scaleSqrt:u7,scaleSymlog:gA,scaleThreshold:wA,scaleTime:j9,scaleUtc:C9,tickFormat:dA},Symbol.toStringTag,{value:"Module"}));var ao=e=>e.chartData,wy=Se([ao],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Sy=(e,t,r,n)=>n?wy(e):ao(e);function yc(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(pa(t)&&pa(r))return!0}return!1}function k_(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function P9(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(pa(r))a=r;else if(typeof r=="function")return;if(pa(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(yc(s))return s}}function O9(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(yc(n))return k_(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,l;if(a==="auto")t!=null&&(s=Math.min(...t));else if(et(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t?.[0]))}catch{}else if(typeof a=="string"&&xE.test(a)){var f=xE.exec(a);if(f==null||t==null)s=void 0;else{var d=+f[1];s=t[0]-d}}else s=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(et(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&gE.test(i)){var h=gE.exec(i);if(h==null||t==null)l=void 0;else{var m=+h[1];l=t[1]+m}}else l=t?.[1];var x=[s,l];if(yc(x))return t==null?x:k_(x,t,r)}}}var Cc=1e9,F9={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Ey,Zt=!0,La="[DecimalError] ",Bo=La+"Invalid argument: ",Ny=La+"Exponent out of range: ",Ac=Math.floor,Co=Math.pow,D9=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ca,Vr=1e7,Gt=7,RA=9007199254740991,dh=Ac(RA/Gt),qe={};qe.absoluteValue=qe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};qe.comparedTo=qe.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};qe.decimalPlaces=qe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Gt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};qe.dividedBy=qe.div=function(e){return Gi(this,new this.constructor(e))};qe.dividedToIntegerBy=qe.idiv=function(e){var t=this,r=t.constructor;return $t(Gi(t,new r(e),0,1),r.precision)};qe.equals=qe.eq=function(e){return!this.cmp(e)};qe.exponent=function(){return kr(this)};qe.greaterThan=qe.gt=function(e){return this.cmp(e)>0};qe.greaterThanOrEqualTo=qe.gte=function(e){return this.cmp(e)>=0};qe.isInteger=qe.isint=function(){return this.e>this.d.length-2};qe.isNegative=qe.isneg=function(){return this.s<0};qe.isPositive=qe.ispos=function(){return this.s>0};qe.isZero=function(){return this.s===0};qe.lessThan=qe.lt=function(e){return this.cmp(e)<0};qe.lessThanOrEqualTo=qe.lte=function(e){return this.cmp(e)<1};qe.logarithm=qe.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(ca))throw Error(La+"NaN");if(r.s<1)throw Error(La+(r.s?"NaN":"-Infinity"));return r.eq(ca)?new n(0):(Zt=!1,t=Gi(lf(r,i),lf(e,i),i),Zt=!0,$t(t,a))};qe.minus=qe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?$A(t,e):LA(t,(e.s=-e.s,e))};qe.modulo=qe.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(La+"NaN");return r.s?(Zt=!1,t=Gi(r,e,0,1).times(e),Zt=!0,r.minus(t)):$t(new n(r),a)};qe.naturalExponential=qe.exp=function(){return BA(this)};qe.naturalLogarithm=qe.ln=function(){return lf(this)};qe.negated=qe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};qe.plus=qe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?LA(t,e):$A(t,(e.s=-e.s,e))};qe.precision=qe.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Bo+e);if(t=kr(a)+1,n=a.d.length-1,r=n*Gt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};qe.squareRoot=qe.sqrt=function(){var e,t,r,n,a,i,s,l=this,f=l.constructor;if(l.s<1){if(!l.s)return new f(0);throw Error(La+"NaN")}for(e=kr(l),Zt=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=gi(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Ac((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new f(t)):n=new f(a.toString()),r=f.precision,a=s=r+3;;)if(i=n,n=i.plus(Gi(l,i,s+2)).times(.5),gi(i.d).slice(0,s)===(t=gi(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if($t(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return Zt=!0,$t(n,r)};qe.times=qe.mul=function(e){var t,r,n,a,i,s,l,f,d,h=this,m=h.constructor,x=h.d,g=(e=new m(e)).d;if(!h.s||!e.s)return new m(0);for(e.s*=h.s,r=h.e+e.e,f=x.length,d=g.length,f<d&&(i=x,x=g,g=i,s=f,f=d,d=s),i=[],s=f+d,n=s;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=f+n;a>n;)l=i[a]+g[n]*x[a-n-1]+t,i[a--]=l%Vr|0,t=l/Vr|0;i[a]=(i[a]+t)%Vr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Zt?$t(e,m.precision):e};qe.toDecimalPlaces=qe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ni(e,0,Cc),t===void 0?t=n.rounding:Ni(t,0,8),$t(r,e+kr(r)+1,t))};qe.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Yo(n,!0):(Ni(e,0,Cc),t===void 0?t=a.rounding:Ni(t,0,8),n=$t(new a(n),e+1,t),r=Yo(n,!0,e+1)),r};qe.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Yo(a):(Ni(e,0,Cc),t===void 0?t=i.rounding:Ni(t,0,8),n=$t(new i(a),e+kr(a)+1,t),r=Yo(n.abs(),!1,e+kr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};qe.toInteger=qe.toint=function(){var e=this,t=e.constructor;return $t(new t(e),kr(e)+1,t.rounding)};qe.toNumber=function(){return+this};qe.toPower=qe.pow=function(e){var t,r,n,a,i,s,l=this,f=l.constructor,d=12,h=+(e=new f(e));if(!e.s)return new f(ca);if(l=new f(l),!l.s){if(e.s<1)throw Error(La+"Infinity");return l}if(l.eq(ca))return l;if(n=f.precision,e.eq(ca))return $t(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=h<0?-h:h)<=RA){for(a=new f(ca),t=Math.ceil(n/Gt+4),Zt=!1;r%2&&(a=a.times(l),C_(a.d,t)),r=Ac(r/2),r!==0;)l=l.times(l),C_(l.d,t);return Zt=!0,e.s<0?new f(ca).div(a):$t(a,n)}}else if(i<0)throw Error(La+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Zt=!1,a=e.times(lf(l,n+d)),Zt=!0,a=BA(a),a.s=i,a};qe.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=kr(a),n=Yo(a,r<=i.toExpNeg||r>=i.toExpPos)):(Ni(e,1,Cc),t===void 0?t=i.rounding:Ni(t,0,8),a=$t(new i(a),e,t),r=kr(a),n=Yo(a,e<=r||r<=i.toExpNeg,e)),n};qe.toSignificantDigits=qe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ni(e,1,Cc),t===void 0?t=n.rounding:Ni(t,0,8)),$t(new n(r),e,t)};qe.toString=qe.valueOf=qe.val=qe.toJSON=qe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=kr(e),r=e.constructor;return Yo(e,t<=r.toExpNeg||t>=r.toExpPos)};function LA(e,t){var r,n,a,i,s,l,f,d,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),Zt?$t(t,m):t;if(f=e.d,d=t.d,s=e.e,a=t.e,f=f.slice(),i=s-a,i){for(i<0?(n=f,i=-i,l=d.length):(n=d,a=s,l=f.length),s=Math.ceil(m/Gt),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=f.length,i=d.length,l-i<0&&(i=l,n=d,d=f,f=n),r=0;i;)r=(f[--i]=f[i]+d[i]+r)/Vr|0,f[i]%=Vr;for(r&&(f.unshift(r),++a),l=f.length;f[--l]==0;)f.pop();return t.d=f,t.e=a,Zt?$t(t,m):t}function Ni(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Bo+e)}function gi(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Gt-n.length,r&&(i+=Is(r)),i+=n;s=e[t],n=s+"",r=Gt-n.length,r&&(i+=Is(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Gi=(function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%Vr|0,s=i/Vr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,f;if(i!=s)f=i>s?1:-1;else for(l=f=0;l<i;l++)if(n[l]!=a[l]){f=n[l]>a[l]?1:-1;break}return f}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*Vr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,f,d,h,m,x,g,y,v,b,E,N,S,j,T,C,P,M,D=n.constructor,W=n.s==a.s?1:-1,F=n.d,L=a.d;if(!n.s)return new D(n);if(!a.s)throw Error(La+"Division by zero");for(f=n.e-a.e,P=L.length,T=F.length,g=new D(W),y=g.d=[],d=0;L[d]==(F[d]||0);)++d;if(L[d]>(F[d]||0)&&--f,i==null?N=i=D.precision:s?N=i+(kr(n)-kr(a))+1:N=i,N<0)return new D(0);if(N=N/Gt+2|0,d=0,P==1)for(h=0,L=L[0],N++;(d<T||h)&&N--;d++)S=h*Vr+(F[d]||0),y[d]=S/L|0,h=S%L|0;else{for(h=Vr/(L[0]+1)|0,h>1&&(L=e(L,h),F=e(F,h),P=L.length,T=F.length),j=P,v=F.slice(0,P),b=v.length;b<P;)v[b++]=0;M=L.slice(),M.unshift(0),C=L[0],L[1]>=Vr/2&&++C;do h=0,l=t(L,v,P,b),l<0?(E=v[0],P!=b&&(E=E*Vr+(v[1]||0)),h=E/C|0,h>1?(h>=Vr&&(h=Vr-1),m=e(L,h),x=m.length,b=v.length,l=t(m,v,x,b),l==1&&(h--,r(m,P<x?M:L,x))):(h==0&&(l=h=1),m=L.slice()),x=m.length,x<b&&m.unshift(0),r(v,m,b),l==-1&&(b=v.length,l=t(L,v,P,b),l<1&&(h++,r(v,P<b?M:L,b))),b=v.length):l===0&&(h++,v=[0]),y[d++]=h,l&&v[0]?v[b++]=F[j]||0:(v=[F[j]],b=1);while((j++<T||v[0]!==void 0)&&N--)}return y[0]||y.shift(),g.e=f,$t(g,s?i+kr(g)+1:i)}})();function BA(e,t){var r,n,a,i,s,l,f=0,d=0,h=e.constructor,m=h.precision;if(kr(e)>16)throw Error(Ny+kr(e));if(!e.s)return new h(ca);for(Zt=!1,l=m,s=new h(.03125);e.abs().gte(.1);)e=e.times(s),d+=5;for(n=Math.log(Co(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new h(ca),h.precision=l;;){if(a=$t(a.times(e),l),r=r.times(++f),s=i.plus(Gi(a,r,l)),gi(s.d).slice(0,l)===gi(i.d).slice(0,l)){for(;d--;)i=$t(i.times(i),l);return h.precision=m,t==null?(Zt=!0,$t(i,m)):i}i=s}}function kr(e){for(var t=e.e*Gt,r=e.d[0];r>=10;r/=10)t++;return t}function Dg(e,t,r){if(t>e.LN10.sd())throw Zt=!0,r&&(e.precision=r),Error(La+"LN10 precision limit exceeded");return $t(new e(e.LN10),t)}function Is(e){for(var t="";e--;)t+="0";return t}function lf(e,t){var r,n,a,i,s,l,f,d,h,m=1,x=10,g=e,y=g.d,v=g.constructor,b=v.precision;if(g.s<1)throw Error(La+(g.s?"NaN":"-Infinity"));if(g.eq(ca))return new v(0);if(t==null?(Zt=!1,d=b):d=t,g.eq(10))return t==null&&(Zt=!0),Dg(v,d);if(d+=x,v.precision=d,r=gi(y),n=r.charAt(0),i=kr(g),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(e),r=gi(g.d),n=r.charAt(0),m++;i=kr(g),n>1?(g=new v("0."+r),i++):g=new v(n+"."+r.slice(1))}else return f=Dg(v,d+2,b).times(i+""),g=lf(new v(n+"."+r.slice(1)),d-x).plus(f),v.precision=b,t==null?(Zt=!0,$t(g,b)):g;for(l=s=g=Gi(g.minus(ca),g.plus(ca),d),h=$t(g.times(g),d),a=3;;){if(s=$t(s.times(h),d),f=l.plus(Gi(s,new v(a),d)),gi(f.d).slice(0,d)===gi(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(Dg(v,d+2,b).times(i+""))),l=Gi(l,new v(m),d),v.precision=b,t==null?(Zt=!0,$t(l,b)):l;l=f,a+=2}}function j_(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Ac(r/Gt),e.d=[],n=(r+1)%Gt,r<0&&(n+=Gt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Gt;n<a;)e.d.push(+t.slice(n,n+=Gt));t=t.slice(n),n=Gt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Zt&&(e.e>dh||e.e<-dh))throw Error(Ny+r)}else e.s=0,e.e=0,e.d=[0];return e}function $t(e,t,r){var n,a,i,s,l,f,d,h,m=e.d;for(s=1,i=m[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Gt,a=t,d=m[h=0];else{if(h=Math.ceil((n+1)/Gt),i=m.length,h>=i)return e;for(d=i=m[h],s=1;i>=10;i/=10)s++;n%=Gt,a=n-Gt+s}if(r!==void 0&&(i=Co(10,s-a-1),l=d/i%10|0,f=t<0||m[h+1]!==void 0||d%i,f=r<4?(l||f)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||f||r==6&&(n>0?a>0?d/Co(10,s-a):0:m[h-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return f?(i=kr(e),m.length=1,t=t-i-1,m[0]=Co(10,(Gt-t%Gt)%Gt),e.e=Ac(-t/Gt)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(n==0?(m.length=h,i=1,h--):(m.length=h+1,i=Co(10,Gt-n),m[h]=a>0?(d/Co(10,s-a)%Co(10,a)|0)*i:0),f)for(;;)if(h==0){(m[0]+=i)==Vr&&(m[0]=1,++e.e);break}else{if(m[h]+=i,m[h]!=Vr)break;m[h--]=0,i=1}for(n=m.length;m[--n]===0;)m.pop();if(Zt&&(e.e>dh||e.e<-dh))throw Error(Ny+kr(e));return e}function $A(e,t){var r,n,a,i,s,l,f,d,h,m,x=e.constructor,g=x.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new x(e),Zt?$t(t,g):t;if(f=e.d,m=t.d,n=t.e,d=e.e,f=f.slice(),s=d-n,s){for(h=s<0,h?(r=f,s=-s,l=m.length):(r=m,n=d,l=f.length),a=Math.max(Math.ceil(g/Gt),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=f.length,l=m.length,h=a<l,h&&(l=a),a=0;a<l;a++)if(f[a]!=m[a]){h=f[a]<m[a];break}s=0}for(h&&(r=f,f=m,m=r,t.s=-t.s),l=f.length,a=m.length-l;a>0;--a)f[l++]=0;for(a=m.length;a>s;){if(f[--a]<m[a]){for(i=a;i&&f[--i]===0;)f[i]=Vr-1;--f[i],f[a]+=Vr}f[a]-=m[a]}for(;f[--l]===0;)f.pop();for(;f[0]===0;f.shift())--n;return f[0]?(t.d=f,t.e=n,Zt?$t(t,g):t):new x(0)}function Yo(e,t,r){var n,a=kr(e),i=gi(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Is(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Is(-a-1)+i,r&&(n=r-s)>0&&(i+=Is(n))):a>=s?(i+=Is(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Is(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Is(n))),e.s<0?"-"+i:i}function C_(e,t){if(e.length>t)return e.length=t,!0}function UA(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Bo+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return j_(s,i.toString())}else if(typeof i!="string")throw Error(Bo+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,D9.test(i))j_(s,i);else throw Error(Bo+i)}if(a.prototype=qe,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=UA,a.config=a.set=I9,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function I9(e){if(!e||typeof e!="object")throw Error(La+"Object expected");var t,r,n,a=["precision",1,Cc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Ac(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Bo+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Bo+r+": "+n);return this}var Ey=UA(F9);ca=new Ey(1);const Dt=Ey;var M9=e=>e,zA={},WA=e=>e===zA,A_=e=>function t(){return arguments.length===0||arguments.length===1&&WA(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},HA=(e,t)=>e===1?t:A_(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==zA).length;return i>=e?t(...n):HA(e-i,A_(function(){for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];var d=n.map(h=>WA(h)?l.shift():h);return t(...d,...l)}))}),dm=e=>HA(e.length,e),Vv=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},R9=dm((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),L9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return M9;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((l,f)=>f(l),i(...arguments))}},Gv=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),VA=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,l)=>{var f;return s===((f=t)===null||f===void 0?void 0:f[l])})||(t=a,r=e(...a)),r}};function GA(e){var t;return e===0?t=1:t=Math.floor(new Dt(e).abs().log(10).toNumber())+1,t}function KA(e,t,r){for(var n=new Dt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}dm((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});dm((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});dm((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var qA=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},XA=(e,t,r)=>{if(e.lte(0))return new Dt(0);var n=GA(e.toNumber()),a=new Dt(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new Dt(Math.ceil(i.div(s).toNumber())).add(r).mul(s),f=l.mul(a);return t?new Dt(f.toNumber()):new Dt(Math.ceil(f.toNumber()))},B9=(e,t,r)=>{var n=new Dt(1),a=new Dt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new Dt(10).pow(GA(e)-1),a=new Dt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Dt(Math.floor(e)))}else e===0?a=new Dt(Math.floor((t-1)/2)):r||(a=new Dt(Math.floor(e)));var s=Math.floor((t-1)/2),l=L9(R9(f=>a.add(new Dt(f-s).mul(n)).toNumber()),Vv);return l(0,t)},YA=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Dt(0),tickMin:new Dt(0),tickMax:new Dt(0)};var s=XA(new Dt(r).sub(t).div(n-1),a,i),l;t<=0&&r>=0?l=new Dt(0):(l=new Dt(t).add(r).div(2),l=l.sub(new Dt(l).mod(s)));var f=Math.ceil(l.sub(t).div(s).toNumber()),d=Math.ceil(new Dt(r).sub(l).div(s).toNumber()),h=f+d+1;return h>n?YA(t,r,n,a,i+1):(h<n&&(d=r>0?d+(n-h):d,f=r>0?f:f+(n-h)),{step:s,tickMin:l.sub(new Dt(f).mul(s)),tickMax:l.add(new Dt(d).mul(s))})};function $9(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,l]=qA([t,r]);if(s===-1/0||l===1/0){var f=l===1/0?[s,...Vv(0,n-1).map(()=>1/0)]:[...Vv(0,n-1).map(()=>-1/0),l];return t>r?Gv(f):f}if(s===l)return B9(s,n,a);var{step:d,tickMin:h,tickMax:m}=YA(s,l,i,a,0),x=KA(h,m.add(new Dt(.1).mul(d)),d);return t>r?Gv(x):x}function U9(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=qA([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var l=Math.max(t,2),f=XA(new Dt(s).sub(i).div(l-1),a,0),d=[...KA(new Dt(i),new Dt(s),f),s];return a===!1&&(d=d.map(h=>Math.round(h))),r>n?Gv(d):d}var z9=VA($9),W9=VA(U9),JA=e=>e.rootProps.maxBarSize,H9=e=>e.rootProps.barGap,QA=e=>e.rootProps.barCategoryGap,V9=e=>e.rootProps.barSize,Mf=e=>e.rootProps.stackOffset,_y=e=>e.options.chartName,ky=e=>e.rootProps.syncId,ZA=e=>e.rootProps.syncMethod,jy=e=>e.options.eventEmitter,Li={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},sa={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},hm=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},G9={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Li.angleAxisId,includeHidden:!1,name:void 0,reversed:Li.reversed,scale:Li.scale,tick:Li.tick,tickCount:void 0,ticks:void 0,type:Li.type,unit:void 0},K9={allowDataOverflow:sa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:sa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:sa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:sa.scale,tick:sa.tick,tickCount:sa.tickCount,ticks:void 0,type:sa.type,unit:void 0},q9={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Li.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Li.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Li.scale,tick:Li.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},X9={allowDataOverflow:sa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:sa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:sa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:sa.scale,tick:sa.tick,tickCount:sa.tickCount,ticks:void 0,type:"category",unit:void 0},Cy=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?q9:G9,Ay=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?X9:K9,mm=e=>e.polarOptions,Ty=Se([as,is,Mr],IC),eT=Se([mm,Ty],(e,t)=>{if(e!=null)return En(e.innerRadius,t,0)}),tT=Se([mm,Ty],(e,t)=>{if(e!=null)return En(e.outerRadius,t,t*.8)}),Y9=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},rT=Se([mm],Y9);Se([Cy,rT],hm);var nT=Se([Ty,eT,tT],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Se([Ay,nT],hm);var aT=Se([_t,mm,eT,tT,as,is],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:l,startAngle:f,endAngle:d}=t;return{cx:En(s,a,a/2),cy:En(l,i,i/2),innerRadius:r,outerRadius:n,startAngle:f,endAngle:d,clockWise:!1}}}),er=(e,t)=>t,Rf=(e,t,r)=>r;function Py(e){return e?.id}var Lr=e=>{var t=_t(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Tc=e=>e.tooltip.settings.axisId,Zr=e=>{var t=Lr(e),r=Tc(e);return Lf(e,t,r)},iT=Se([Zr],e=>e?.dataKey);function sT(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(l=>{var f,d=(f=l.data)!==null&&f!==void 0?f:n;if(!(d==null||d.length===0)){var h=Py(l);d.forEach((m,x)=>{var g=i==null||a?x:String(ir(m,i,null)),y=ir(m,l.dataKey,0),v;s.has(g)?v=s.get(g):v={},Object.assign(v,{[h]:y}),s.set(g,v)})}}),Array.from(s.values())}function pm(e){return e.stackId!=null&&e.dataKey!=null}function T_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T_(Object(r),!0).forEach(function(n){J9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J9(e,t,r){return(t=Q9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q9(e){var t=Z9(e,"string");return typeof t=="symbol"?t:t+""}function Z9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kv=[0,"auto"],aa={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},oT=(e,t)=>e.cartesianAxis.xAxis[t],os=(e,t)=>{var r=oT(e,t);return r??aa},ia={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Kv,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Pf},lT=(e,t)=>e.cartesianAxis.yAxis[t],ls=(e,t)=>{var r=lT(e,t);return r??ia},eB={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Oy=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??eB},yr=(e,t,r)=>{switch(t){case"xAxis":return os(e,r);case"yAxis":return ls(e,r);case"zAxis":return Oy(e,r);case"angleAxis":return Cy(e,r);case"radiusAxis":return Ay(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},tB=(e,t,r)=>{switch(t){case"xAxis":return os(e,r);case"yAxis":return ls(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Lf=(e,t,r)=>{switch(t){case"xAxis":return os(e,r);case"yAxis":return ls(e,r);case"angleAxis":return Cy(e,r);case"radiusAxis":return Ay(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},cT=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Fy(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Dy=e=>e.graphicalItems.cartesianItems,rB=Se([er,Rf],Fy),Iy=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),Bf=Se([Dy,yr,rB],Iy),uT=Se([Bf],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(pm)),fT=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),dT=Se([Bf],fT),My=e=>e.map(t=>t.data).filter(Boolean).flat(1),nB=Se([Bf],My),Ry=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Ly=Se([nB,Sy],Ry),By=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:ir(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:ir(a,n)}))):e.map(n=>({value:n})),xm=Se([Ly,yr,Bf],By);function hT(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function fl(e){return e.filter(t=>Si(t)||t instanceof Date).map(Number).filter(t=>ha(t)===!1)}function aB(e,t,r){return!r||typeof t!="number"||ha(t)?[]:r.length?fl(r.flatMap(n=>{var a=ir(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!pa(i)||!pa(s)))return[t-i,t+s]})):[]}var iB=Se([uT,Sy,Zr],sT),mT=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,l]=i,f=l.map(Py);return[s,{stackedData:c8(e,f,r),graphicalItems:l}]}))},qv=Se([iB,uT,Mf],mT),pT=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var i=m8(e,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},sB=Se([qv,ao,er],pT),xT=(e,t,r,n,a)=>r.length>0?e.flatMap(i=>r.flatMap(s=>{var l,f,d=(l=n[s.id])===null||l===void 0?void 0:l.filter(m=>hT(a,m)),h=ir(i,(f=t.dataKey)!==null&&f!==void 0?f:s.dataKey);return{value:h,errorDomain:aB(i,h,d)}})).filter(Boolean):t?.dataKey!=null?e.map(i=>({value:ir(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),gm=e=>e.errorBars,gT=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>hT(r,n));Se([dT,gm,er],gT);var oB=Se([Ly,yr,dT,gm,er],xT);function lB(e){var{value:t}=e;if(Si(t)||t instanceof Date)return t}var P_=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=fl(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},cB=(e,t,r)=>{var n=e.map(lB).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&A4(n))?rA(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},$y=e=>{var t;if(e==null||!("domain"in e))return Kv;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=fl(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:Kv},mh=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),l=Math.max(...i);return[s,l]}},vT=e=>e.referenceElements.dots,Pc=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),uB=Se([vT,er,Rf],Pc),yT=e=>e.referenceElements.areas,fB=Se([yT,er,Rf],Pc),bT=e=>e.referenceElements.lines,dB=Se([bT,er,Rf],Pc),wT=(e,t)=>{var r=fl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},hB=Se(uB,er,wT),ST=(e,t)=>{var r=fl(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},mB=Se([fB,er],ST),NT=(e,t)=>{var r=fl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},pB=Se(dB,er,NT),xB=Se(hB,pB,mB,(e,t,r)=>mh(e,r,t)),ET=Se([yr],$y),Uy=(e,t,r,n,a,i,s)=>{var l=P9(t,e.allowDataOverflow);if(l!=null)return l;var f=i==="vertical"&&s==="xAxis"||i==="horizontal"&&s==="yAxis",d=f?mh(r,a,P_(n)):mh(a,P_(n));return O9(t,d,e.allowDataOverflow)},gB=Se([yr,ET,sB,oB,xB,_t,er],Uy),vB=[0,1],zy=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:l,type:f}=e,d=ol(t,i);return d&&l==null?rA(0,r.length):f==="category"?cB(n,e,d):a==="expand"?vB:s}},Wy=Se([yr,_t,Ly,xm,Mf,er,gB],zy),_T=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(jf(i));return l in Iu?l:"point"}}},Oc=Se([yr,_t,cT,_y,er],_T);function yB(e){if(e!=null){if(e in Iu)return Iu[e]();var t="scale".concat(jf(e));if(t in Iu)return Iu[t]()}}function Hy(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=yB(t);if(a!=null){var i=a.domain(r).range(n);return a8(i),i}}}var Vy=(e,t,r)=>{var n=$y(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&yc(e))return z9(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&yc(e))return W9(e,t.tickCount,t.allowDecimals)}},Gy=Se([Wy,Lf,Oc],Vy),Ky=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&yc(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],l=r[r.length-1];return[Math.min(a,i),Math.max(s,l)]}return t},bB=Se([yr,Wy,Gy,er],Ky),wB=Se(xm,yr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(fl(e.map(l=>l.value))).sort((l,f)=>l-f);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),kT=Se(wB,_t,QA,Mr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!pa(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=En(r,e*i),l=e*i/2;return l-s-(l-s)/i*s}return 0}),SB=(e,t)=>{var r=os(e,t);return r==null||typeof r.padding!="string"?0:kT(e,"xAxis",t,r.padding)},NB=(e,t)=>{var r=ls(e,t);return r==null||typeof r.padding!="string"?0:kT(e,"yAxis",t,r.padding)},EB=Se(os,SB,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),_B=Se(ls,NB,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),kB=Se([Mr,EB,rm,tm,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),jB=Se([Mr,_t,_B,rm,tm,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),$f=(e,t,r,n)=>{var a;switch(t){case"xAxis":return kB(e,r,n);case"yAxis":return jB(e,r,n);case"zAxis":return(a=Oy(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return rT(e);case"radiusAxis":return nT(e,r);default:return}},jT=Se([yr,$f],hm),Fc=Se([yr,Oc,bB,jT],Hy);Se([Bf,gm,er],gT);function CT(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var vm=(e,t)=>t,ym=(e,t,r)=>r,CB=Se(Zh,vm,ym,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(CT)),AB=Se(em,vm,ym,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(CT)),AT=(e,t)=>({width:e.width,height:t.height}),TB=(e,t)=>{var r=typeof t.width=="number"?t.width:Pf;return{width:r,height:e.height}},TT=Se(Mr,os,AT),PB=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},OB=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},FB=Se(is,Mr,CB,vm,ym,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var f=AT(t,l);s==null&&(s=PB(t,n,e));var d=n==="top"&&!a||n==="bottom"&&a;i[l.id]=s-Number(d)*f.height,s+=(d?-1:1)*f.height}),i}),DB=Se(as,Mr,AB,vm,ym,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var f=TB(t,l);s==null&&(s=OB(t,n,e));var d=n==="left"&&!a||n==="right"&&a;i[l.id]=s-Number(d)*f.width,s+=(d?-1:1)*f.width}),i}),IB=(e,t)=>{var r=os(e,t);if(r!=null)return FB(e,r.orientation,r.mirror)},MB=Se([Mr,os,IB,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),RB=(e,t)=>{var r=ls(e,t);if(r!=null)return DB(e,r.orientation,r.mirror)},LB=Se([Mr,ls,RB,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),PT=Se(Mr,ls,(e,t)=>{var r=typeof t.width=="number"?t.width:Pf;return{width:r,height:e.height}}),O_=(e,t,r)=>{switch(t){case"xAxis":return TT(e,r).width;case"yAxis":return PT(e,r).height;default:return}},OT=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,l=ol(e,n),f=t.map(d=>d.value);if(s&&l&&i==="category"&&a&&A4(f))return f}},qy=Se([_t,xm,yr,er],OT),FT=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=ol(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(l=>l.value)}},Xy=Se([_t,xm,Lf,er],FT),F_=Se([_t,tB,Oc,Fc,qy,Xy,$f,Gy,er],(e,t,r,n,a,i,s,l,f)=>{if(t==null)return null;var d=ol(e,f);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:f,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:l,range:s,realScaleType:r,scale:n}}),BB=(e,t,r,n,a,i,s,l,f)=>{if(!(t==null||n==null)){var d=ol(e,f),{type:h,ticks:m,tickCount:x}=t,g=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,y=h==="category"&&n.bandwidth?n.bandwidth()/g:0;y=f==="angleAxis"&&i!=null&&i.length>=2?qr(i[0]-i[1])*2*y:y;var v=m||a;if(v){var b=v.map((E,N)=>{var S=s?s.indexOf(E):E;return{index:N,coordinate:n(S)+y,value:E,offset:y}});return b.filter(E=>!ha(E.coordinate))}return d&&l?l.map((E,N)=>({coordinate:n(E)+y,value:E,index:N,offset:y})):n.ticks?n.ticks(x).map(E=>({coordinate:n(E)+y,value:E,offset:y})):n.domain().map((E,N)=>({coordinate:n(E)+y,value:s?s[E]:E,index:N,offset:y}))}},DT=Se([_t,Lf,Oc,Fc,Gy,$f,qy,Xy,er],BB),$B=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=ol(e,s),{tickCount:f}=t,d=0;return d=s==="angleAxis"&&n?.length>=2?qr(n[0]-n[1])*2*d:d,l&&i?i.map((h,m)=>({coordinate:r(h)+d,value:h,index:m,offset:d})):r.ticks?r.ticks(f).map(h=>({coordinate:r(h)+d,value:h,offset:d})):r.domain().map((h,m)=>({coordinate:r(h)+d,value:a?a[h]:h,index:m,offset:d}))}},bc=Se([_t,Lf,Fc,$f,qy,Xy,er],$B),wc=Se(yr,Fc,(e,t)=>{if(!(e==null||t==null))return hh(hh({},e),{},{scale:t})}),UB=Se([yr,Oc,Wy,jT],Hy);Se((e,t,r)=>Oy(e,r),UB,(e,t)=>{if(!(e==null||t==null))return hh(hh({},e),{},{scale:t})});var zB=Se([_t,Zh,em],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),IT=e=>e.options.defaultTooltipEventType,MT=e=>e.options.validateTooltipEventTypes;function RT(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Yy(e,t){var r=IT(e),n=MT(e);return RT(t,r,n)}function WB(e){return Ze(t=>Yy(t,e))}var LT=(e,t)=>{var r,n=Number(t);if(!(ha(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},HB=e=>e.tooltip.settings,Rs={active:!1,index:null,dataKey:void 0,coordinate:void 0},VB={itemInteraction:{click:Rs,hover:Rs},axisInteraction:{click:Rs,hover:Rs},keyboardInteraction:Rs,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},BT=ga({name:"tooltip",initialState:VB,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Vi(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:GB,removeTooltipEntrySettings:KB,setTooltipSettingsState:qB,setActiveMouseOverItemIndex:$T,mouseLeaveItem:XB,mouseLeaveChart:UT,setActiveClickItemIndex:YB,setMouseOverAxisIndex:zT,setMouseClickAxisIndex:JB,setSyncInteraction:Xv,setKeyboardInteraction:Yv}=BT.actions,QB=BT.reducer;function D_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function v0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D_(Object(r),!0).forEach(function(n){ZB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZB(e,t,r){return(t=e$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e$(e){var t=t$(e,"string");return typeof t=="symbol"?t:t+""}function t$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r$(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function n$(e){return e.index!=null}var WT=(e,t,r,n)=>{if(t==null)return Rs;var a=r$(e,t,r);if(a==null)return Rs;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(n$(a)){if(i)return v0(v0({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return v0(v0({},Rs),{},{coordinate:a.coordinate})},Jy=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!pa(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},HT=(e,t,r,n,a,i,s,l)=>{if(!(i==null||l==null)){var f=s[0],d=f==null?void 0:l(f.positions,i);if(d!=null)return d;var h=a?.[Number(i)];if(h)return r==="horizontal"?{x:h.coordinate,y:(n.top+t)/2}:{x:(n.left+e)/2,y:h.coordinate}}},VT=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},Uf=e=>e.options.tooltipPayloadSearcher,Dc=e=>e.tooltip;function I_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function M_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I_(Object(r),!0).forEach(function(n){a$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a$(e,t,r){return(t=i$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i$(e){var t=s$(e,"string");return typeof t=="symbol"?t:t+""}function s$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o$(e,t){return e??t}var GT=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:l,computedData:f,dataStartIndex:d,dataEndIndex:h}=r,m=[];return e.reduce((x,g)=>{var y,{dataDefinedOnItem:v,settings:b}=g,E=o$(v,l),N=Array.isArray(E)?MC(E,d,h):E,S=(y=b?.dataKey)!==null&&y!==void 0?y:n,j=b?.nameKey,T;if(n&&Array.isArray(N)&&!Array.isArray(N[0])&&s==="axis"?T=K5(N,n,a):T=i(N,t,f,j),Array.isArray(T))T.forEach(P=>{var M=M_(M_({},b),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});x.push(vE({tooltipEntrySettings:M,dataKey:P.dataKey,payload:P.payload,value:ir(P.payload,P.dataKey),name:P.name}))});else{var C;x.push(vE({tooltipEntrySettings:b,dataKey:S,payload:T,value:ir(T,S),name:(C=ir(T,j))!==null&&C!==void 0?C:b?.name}))}return x},m)}},Qy=Se([Zr,_t,cT,_y,Lr],_T),l$=Se([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),c$=Se([Lr,Tc],Fy),zf=Se([l$,Zr,c$],Iy),u$=Se([zf],e=>e.filter(pm)),f$=Se([zf],My),Ic=Se([f$,ao],Ry),d$=Se([u$,ao,Zr],sT),Zy=Se([Ic,Zr,zf],By),h$=Se([Zr],$y),m$=Se([zf],e=>e.filter(pm)),p$=Se([d$,m$,Mf],mT),x$=Se([p$,ao,Lr],pT),g$=Se([zf],fT),v$=Se([Ic,Zr,g$,gm,Lr],xT),y$=Se([vT,Lr,Tc],Pc),b$=Se([y$,Lr],wT),w$=Se([yT,Lr,Tc],Pc),S$=Se([w$,Lr],ST),N$=Se([bT,Lr,Tc],Pc),E$=Se([N$,Lr],NT),_$=Se([b$,E$,S$],mh),k$=Se([Zr,h$,x$,v$,_$,_t,Lr],Uy),KT=Se([Zr,_t,Ic,Zy,Mf,Lr,k$],zy),j$=Se([KT,Zr,Qy],Vy),C$=Se([Zr,KT,j$,Lr],Ky),qT=e=>{var t=Lr(e),r=Tc(e),n=!1;return $f(e,t,r,n)},XT=Se([Zr,qT],hm),YT=Se([Zr,Qy,C$,XT],Hy),A$=Se([_t,Zy,Zr,Lr],OT),T$=Se([_t,Zy,Zr,Lr],FT),P$=(e,t,r,n,a,i,s,l)=>{if(t){var{type:f}=t,d=ol(e,l);if(n){var h=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,m=f==="category"&&n.bandwidth?n.bandwidth()/h:0;return m=l==="angleAxis"&&a!=null&&a?.length>=2?qr(a[0]-a[1])*2*m:m,d&&s?s.map((x,g)=>({coordinate:n(x)+m,value:x,index:g,offset:m})):n.domain().map((x,g)=>({coordinate:n(x)+m,value:i?i[x]:x,index:g,offset:m}))}}},cs=Se([_t,Zr,Qy,YT,qT,A$,T$,Lr],P$),eb=Se([IT,MT,HB],(e,t,r)=>RT(r.shared,e,t)),JT=e=>e.tooltip.settings.trigger,tb=e=>e.tooltip.settings.defaultIndex,bm=Se([Dc,eb,JT,tb],WT),Jo=Se([bm,Ic],Jy),QT=Se([cs,Jo],LT),ZT=Se([bm],e=>{if(e)return e.dataKey}),e3=Se([Dc,eb,JT,tb],VT),O$=Se([as,is,_t,Mr,cs,tb,e3,Uf],HT),F$=Se([bm,O$],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),D$=Se([bm],e=>e.active),I$=Se([e3,Jo,ao,iT,QT,Uf,eb],GT);Se([I$],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function R_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function L_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R_(Object(r),!0).forEach(function(n){M$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M$(e,t,r){return(t=R$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R$(e){var t=L$(e,"string");return typeof t=="symbol"?t:t+""}function L$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var B$=()=>Ze(Zr),$$=()=>{var e=B$(),t=Ze(cs),r=Ze(YT);return V1(L_(L_({},e),{},{scale:r}),t)},U$=()=>Ze(_y),rb=(e,t)=>t,t3=(e,t,r)=>r,nb=(e,t,r,n)=>n,z$=Se(cs,e=>Gh(e,t=>t.coordinate)),ab=Se([Dc,rb,t3,nb],WT),r3=Se([ab,Ic],Jy),W$=(e,t,r)=>{if(t!=null){var n=Dc(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},n3=Se([Dc,rb,t3,nb],VT),ph=Se([as,is,_t,Mr,cs,nb,n3,Uf],HT),H$=Se([ab,ph],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),a3=Se(cs,r3,LT),V$=Se([n3,r3,ao,iT,a3,Uf,rb],GT),G$=Se([ab],e=>({isActive:e.active,activeIndex:e.index})),K$=(e,t,r,n,a,i,s,l)=>{if(!(!e||!t||!n||!a||!i)){var f=p8(e.chartX,e.chartY,t,r,l);if(f){var d=g8(f,t),h=r8(d,s,i,n,a),m=x8(t,i,h,f);return{activeIndex:String(h),activeCoordinate:m}}}};function Jv(){return Jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jv.apply(null,arguments)}function B_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function y0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B_(Object(r),!0).forEach(function(n){q$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q$(e,t,r){return(t=X$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X$(e){var t=Y$(e,"string");return typeof t=="symbol"?t:t+""}function Y$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J$(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:l,tooltipEventType:f,chartName:d}=e,h=t,m=r,x=n;if(!l||!h||d!=="ScatterChart"&&f!=="axis")return null;var g,y;if(d==="ScatterChart")g=h,y=gR;else if(d==="BarChart")g=vR(s,h,a,i),y=QC;else if(s==="radial"){var{cx:v,cy:b,radius:E,startAngle:N,endAngle:S}=ZC(h);g={cx:v,cy:b,startAngle:N,endAngle:S,innerRadius:E,outerRadius:E},y=tA}else g={points:JR(s,h,a)},y=KC;var j=typeof l=="object"&&"className"in l?l.className:void 0,T=y0(y0(y0(y0({stroke:"#ccc",pointerEvents:"none"},a),g),Dr(l,!1)),{},{payload:m,payloadIndex:x,className:bt("recharts-tooltip-cursor",j)});return k.isValidElement(l)?k.cloneElement(l,T):k.createElement(y,T)}function Q$(e){var t=$$(),r=zC(),n=Y1(),a=U$();return k.createElement(J$,Jv({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var i3=k.createContext(null),Z$=()=>k.useContext(i3),Ig={exports:{}},$_;function eU(){return $_||($_=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(f,d,h){this.fn=f,this.context=d,this.once=h||!1}function i(f,d,h,m,x){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new a(h,m||f,x),y=r?r+d:d;return f._events[y]?f._events[y].fn?f._events[y]=[f._events[y],g]:f._events[y].push(g):(f._events[y]=g,f._eventsCount++),f}function s(f,d){--f._eventsCount===0?f._events=new n:delete f._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],h,m;if(this._eventsCount===0)return d;for(m in h=this._events)t.call(h,m)&&d.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},l.prototype.listeners=function(d){var h=r?r+d:d,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var x=0,g=m.length,y=new Array(g);x<g;x++)y[x]=m[x].fn;return y},l.prototype.listenerCount=function(d){var h=r?r+d:d,m=this._events[h];return m?m.fn?1:m.length:0},l.prototype.emit=function(d,h,m,x,g,y){var v=r?r+d:d;if(!this._events[v])return!1;var b=this._events[v],E=arguments.length,N,S;if(b.fn){switch(b.once&&this.removeListener(d,b.fn,void 0,!0),E){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,h),!0;case 3:return b.fn.call(b.context,h,m),!0;case 4:return b.fn.call(b.context,h,m,x),!0;case 5:return b.fn.call(b.context,h,m,x,g),!0;case 6:return b.fn.call(b.context,h,m,x,g,y),!0}for(S=1,N=new Array(E-1);S<E;S++)N[S-1]=arguments[S];b.fn.apply(b.context,N)}else{var j=b.length,T;for(S=0;S<j;S++)switch(b[S].once&&this.removeListener(d,b[S].fn,void 0,!0),E){case 1:b[S].fn.call(b[S].context);break;case 2:b[S].fn.call(b[S].context,h);break;case 3:b[S].fn.call(b[S].context,h,m);break;case 4:b[S].fn.call(b[S].context,h,m,x);break;default:if(!N)for(T=1,N=new Array(E-1);T<E;T++)N[T-1]=arguments[T];b[S].fn.apply(b[S].context,N)}}return!0},l.prototype.on=function(d,h,m){return i(this,d,h,m,!1)},l.prototype.once=function(d,h,m){return i(this,d,h,m,!0)},l.prototype.removeListener=function(d,h,m,x){var g=r?r+d:d;if(!this._events[g])return this;if(!h)return s(this,g),this;var y=this._events[g];if(y.fn)y.fn===h&&(!x||y.once)&&(!m||y.context===m)&&s(this,g);else{for(var v=0,b=[],E=y.length;v<E;v++)(y[v].fn!==h||x&&!y[v].once||m&&y[v].context!==m)&&b.push(y[v]);b.length?this._events[g]=b.length===1?b[0]:b:s(this,g)}return this},l.prototype.removeAllListeners=function(d){var h;return d?(h=r?r+d:d,this._events[h]&&s(this,h)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(Ig)),Ig.exports}var tU=eU();const rU=Ei(tU);var cf=new rU,Qv="recharts.syncEvent.tooltip",U_="recharts.syncEvent.brush";function s3(e,t){if(t){var r=Number.parseInt(t,10);if(!ha(r))return e?.[r]}}var nU={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},o3=ga({name:"options",initialState:nU,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),aU=o3.reducer,{createEventEmitter:iU}=o3.actions;function sU(e){return e.tooltip.syncInteraction}var oU={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},l3=ga({name:"chartData",initialState:oU,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:z_,setDataStartEndIndexes:lU,setComputedData:kle}=l3.actions,cU=l3.reducer,uU=["x","y"];function W_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _o(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W_(Object(r),!0).forEach(function(n){fU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fU(e,t,r){return(t=dU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dU(e){var t=hU(e,"string");return typeof t=="symbol"?t:t+""}function hU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mU(e,t){if(e==null)return{};var r,n,a=pU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var c3=()=>{};function xU(){var e=Ze(ky),t=Ze(jy),r=lr(),n=Ze(ZA),a=Ze(cs),i=Y1(),s=K1(),l=Ze(f=>f.rootProps.className);k.useEffect(()=>{if(e==null)return c3;var f=(d,h,m)=>{if(t!==m&&e===d){if(n==="index"){var x;if(s&&h!==null&&h!==void 0&&(x=h.payload)!==null&&x!==void 0&&x.coordinate){var g=h.payload.coordinate,{x:y,y:v}=g,b=mU(g,uU),E=_o(_o(_o({},b),typeof y=="number"&&{x:Math.max(s.x,Math.min(y,s.x+s.width))}),typeof v=="number"&&{y:Math.max(s.y,Math.min(v,s.y+s.height))}),N=_o(_o({},h),{},{payload:_o(_o({},h.payload),{},{coordinate:E})});r(N)}else r(h);return}if(a!=null){var S;if(typeof n=="function"){var j={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},T=n(a,j);S=a[T]}else n==="value"&&(S=a.find(J=>String(J.value)===h.payload.label));var{coordinate:C}=h.payload;if(S==null||h.payload.active===!1||C==null||s==null){r(Xv({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:P,y:M}=C,D=Math.min(P,s.x+s.width),W=Math.min(M,s.y+s.height),F={x:i==="horizontal"?S.coordinate:D,y:i==="horizontal"?W:S.coordinate},L=Xv({active:h.payload.active,coordinate:F,dataKey:h.payload.dataKey,index:String(S.index),label:h.payload.label});r(L)}}};return cf.on(Qv,f),()=>{cf.off(Qv,f)}},[l,r,t,e,n,a,i,s])}function gU(){var e=Ze(ky),t=Ze(jy),r=lr();k.useEffect(()=>{if(e==null)return c3;var n=(a,i,s)=>{t!==s&&e===a&&r(lU(i))};return cf.on(U_,n),()=>{cf.off(U_,n)}},[r,t,e])}function vU(){var e=lr();k.useEffect(()=>{e(iU())},[e]),xU(),gU()}function yU(e,t,r,n,a,i){var s=Ze(x=>W$(x,e,t)),l=Ze(jy),f=Ze(ky),d=Ze(ZA),h=Ze(sU),m=h?.active;k.useEffect(()=>{if(!m&&f!=null&&l!=null){var x=Xv({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n});cf.emit(Qv,f,x,l)}},[m,r,s,a,n,l,f,d,i])}function H_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function V_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H_(Object(r),!0).forEach(function(n){bU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bU(e,t,r){return(t=wU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wU(e){var t=SU(e,"string");return typeof t=="symbol"?t:t+""}function SU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NU(e){return e.dataKey}function EU(e,t){return k.isValidElement(e)?k.cloneElement(e,t):typeof e=="function"?k.createElement(e,t):k.createElement(X8,t)}var G_=[],_U={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!ll.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Bu(e){var t=Rn(e,_U),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:l,isAnimationActive:f,offset:d,payloadUniqBy:h,position:m,reverseDirection:x,useTranslate3d:g,wrapperStyle:y,cursor:v,shared:b,trigger:E,defaultIndex:N,portal:S,axisId:j}=t,T=lr(),C=typeof N=="number"?String(N):N;k.useEffect(()=>{T(qB({shared:b,trigger:E,axisId:j,active:r,defaultIndex:C}))},[T,b,E,j,r,C]);var P=K1(),M=GC(),D=WB(b),{activeIndex:W,isActive:F}=Ze(q=>G$(q,D,E,C)),L=Ze(q=>V$(q,D,E,C)),J=Ze(q=>a3(q,D,E,C)),se=Ze(q=>H$(q,D,E,C)),Z=L,he=Z$(),le=r??F,[de,Q]=uC([Z,le]),pe=D==="axis"?J:void 0;yU(D,E,se,pe,W,le);var re=S??he;if(re==null)return null;var O=Z??G_;le||(O=G_),l&&O.length&&(O=iC(Z.filter(q=>q.value!=null&&(q.hide!==!0||t.includeHidden)),h,NU));var V=O.length>0,H=k.createElement(rR,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:f,active:le,coordinate:se,hasPayload:V,offset:d,position:m,reverseDirection:x,useTranslate3d:g,viewBox:P,wrapperStyle:y,lastBoundingBox:de,innerRef:Q,hasPortalFromProps:!!S},EU(s,V_(V_({},t),{},{payload:O,label:pe,active:le,coordinate:se,accessibilityLayer:M})));return k.createElement(k.Fragment,null,O4.createPortal(H,re),le&&k.createElement(Q$,{cursor:v,tooltipEventType:D,coordinate:se,payload:Z,index:W}))}var Mg={},Rg={},Lg={},K_;function kU(){return K_||(K_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,l=null;const f=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),h=()=>{l!==null&&(r.apply(s,l),s=void 0,l=null)},m=()=>{d&&h(),v()};let x=null;const g=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,m()},n)},y=()=>{x!==null&&(clearTimeout(x),x=null)},v=()=>{y(),s=void 0,l=null},b=()=>{h()},E=function(...N){if(a?.aborted)return;s=this,l=N;const S=x==null;g(),f&&S&&h()};return E.schedule=g,E.cancel=v,E.flush=b,a?.addEventListener("abort",v,{once:!0}),E}e.debounce=t})(Lg)),Lg}var q_;function jU(){return q_||(q_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kU();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:l=!0,maxWait:f}=i,d=Array(2);s&&(d[0]="leading"),l&&(d[1]="trailing");let h,m=null;const x=t.debounce(function(...v){h=n.apply(this,v),m=null},a,{edges:d}),g=function(...v){return f!=null&&(m===null&&(m=Date.now()),Date.now()-m>=f)?(h=n.apply(this,v),m=Date.now(),x.cancel(),x.schedule(),h):(x.apply(this,v),h)},y=()=>(x.flush(),h);return g.cancel=x.cancel,g.flush=y,g}e.debounce=r})(Rg)),Rg}var X_;function CU(){return X_||(X_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jU();function r(n,a=0,i={}){const{leading:s=!0,trailing:l=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:l})}e.throttle=r})(Mg)),Mg}var Bg,Y_;function AU(){return Y_||(Y_=1,Bg=CU().throttle),Bg}var TU=AU();const PU=Ei(TU);var $u=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function J_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $g(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J_(Object(r),!0).forEach(function(n){OU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OU(e,t,r){return(t=FU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FU(e){var t=DU(e,"string");return typeof t=="symbol"?t:t+""}function DU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uu=k.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:s=0,minHeight:l,maxHeight:f,children:d,debounce:h=0,id:m,className:x,onResize:g,style:y={}}=e,v=k.useRef(null),b=k.useRef();b.current=g,k.useImperativeHandle(t,()=>v.current);var[E,N]=k.useState({containerWidth:n.width,containerHeight:n.height}),S=k.useCallback((T,C)=>{N(P=>{var M=Math.round(T),D=Math.round(C);return P.containerWidth===M&&P.containerHeight===D?P:{containerWidth:M,containerHeight:D}})},[]);k.useEffect(()=>{var T=D=>{var W,{width:F,height:L}=D[0].contentRect;S(F,L),(W=b.current)===null||W===void 0||W.call(b,F,L)};h>0&&(T=PU(T,h,{trailing:!0,leading:!1}));var C=new ResizeObserver(T),{width:P,height:M}=v.current.getBoundingClientRect();return S(P,M),C.observe(v.current),()=>{C.disconnect()}},[S,h]);var j=k.useMemo(()=>{var{containerWidth:T,containerHeight:C}=E;if(T<0||C<0)return null;$u(Po(a)||Po(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),$u(!r||r>0,"The aspect(%s) must be greater than zero.",r);var P=Po(a)?T:a,M=Po(i)?C:i;return r&&r>0&&(P?M=P/r:M&&(P=M*r),f&&M>f&&(M=f)),$u(P>0||M>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,P,M,a,i,s,l,r),k.Children.map(d,D=>k.cloneElement(D,{width:P,height:M,style:$g({width:P,height:M},D.props.style)}))},[r,d,i,f,l,s,E,a]);return k.createElement("div",{id:m?"".concat(m):void 0,className:bt("recharts-responsive-container",x),style:$g($g({},y),{},{width:a,height:i,minWidth:s,minHeight:l,maxHeight:f}),ref:v},k.createElement("div",{style:{width:0,height:0,overflow:"visible"}},j))}),Wi=e=>null;Wi.displayName="Cell";function IU(e,t,r){return(t=MU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MU(e){var t=RU(e,"string");return typeof t=="symbol"?t:t+""}function RU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class LU{constructor(t){IU(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function Q_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function BU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q_(Object(r),!0).forEach(function(n){$U(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $U(e,t,r){return(t=UU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UU(e){var t=zU(e,"string");return typeof t=="symbol"?t:t+""}function zU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WU={cacheSize:2e3,enableCache:!0},u3=BU({},WU),Z_=new LU(u3.cacheSize),HU={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},ek="recharts_measurement_span";function VU(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(l)}var tk=(e,t)=>{try{var r=document.getElementById(ek);r||(r=document.createElement("span"),r.setAttribute("id",ek),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,HU,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},zu=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||ll.isSsr)return{width:0,height:0};if(!u3.enableCache)return tk(t,r);var n=VU(t,r),a=Z_.get(n);if(a)return a;var i=tk(t,r);return Z_.set(n,i),i},rk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,nk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,GU=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,KU=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,f3={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},qU=Object.keys(f3),Ql="NaN";function XU(e,t){return e*f3[t]}class qn{static parse(t){var r,[,n,a]=(r=KU.exec(t))!==null&&r!==void 0?r:[];return new qn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ha(t)&&(this.unit=""),r!==""&&!GU.test(r)&&(this.num=NaN,this.unit=""),qU.includes(r)&&(this.num=XU(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new qn(NaN,""):new qn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new qn(NaN,""):new qn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new qn(NaN,""):new qn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new qn(NaN,""):new qn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ha(this.num)}}function d3(e){if(e.includes(Ql))return Ql;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=rk.exec(t))!==null&&r!==void 0?r:[],s=qn.parse(n??""),l=qn.parse(i??""),f=a==="*"?s.multiply(l):s.divide(l);if(f.isNaN())return Ql;t=t.replace(rk,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,h,m,x]=(d=nk.exec(t))!==null&&d!==void 0?d:[],g=qn.parse(h??""),y=qn.parse(x??""),v=m==="+"?g.add(y):g.subtract(y);if(v.isNaN())return Ql;t=t.replace(nk,v.toString())}return t}var ak=/\(([^()]*)\)/;function YU(e){for(var t=e,r;(r=ak.exec(t))!=null;){var[,n]=r;t=t.replace(ak,d3(n))}return t}function JU(e){var t=e.replace(/\s+/g,"");return t=YU(t),t=d3(t),t}function QU(e){try{return JU(e)}catch{return Ql}}function Ug(e){var t=QU(e.slice(5,-1));return t===Ql?"":t}var ZU=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],ez=["dx","dy","angle","className","breakAll"];function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zv.apply(null,arguments)}function ik(e,t){if(e==null)return{};var r,n,a=tz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var h3=/[ \f\n\r\t\v\u2028\u2029]+/,m3=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Yr(t)||(r?a=t.toString().split(""):a=t.toString().split(h3));var i=a.map(l=>({word:l,width:zu(l,n).width})),s=r?0:zu("",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},rz=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:l,breakAll:f}=e,d=et(i),h=s,m=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return F.reduce((L,J)=>{var{word:se,width:Z}=J,he=L[L.length-1];if(he&&(n==null||a||he.width+Z+r<Number(n)))he.words.push(se),he.width+=Z+r;else{var le={words:[se],width:Z};L.push(le)}return L},[])},x=m(t),g=W=>W.reduce((F,L)=>F.width>L.width?F:L);if(!d||a)return x;var y=x.length>i||g(x).width>Number(n);if(!y)return x;for(var v="",b=W=>{var F=h.slice(0,W),L=m3({breakAll:f,style:l,children:F+v}).wordsWithComputedWidth,J=m(L),se=J.length>i||g(J).width>Number(n);return[se,J]},E=0,N=h.length-1,S=0,j;E<=N&&S<=h.length-1;){var T=Math.floor((E+N)/2),C=T-1,[P,M]=b(C),[D]=b(T);if(!P&&!D&&(E=T+1),P&&D&&(N=T-1),!P&&D){j=M;break}S++}return j||x},sk=e=>{var t=Yr(e)?[]:e.toString().split(h3);return[{words:t}]},nz=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!ll.isSsr){var l,f,d=m3({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:h,spaceWidth:m}=d;l=h,f=m}else return sk(n);return rz({breakAll:i,children:n,maxLines:s,style:a},l,f,t,r)}return sk(n)},ok="#808080",wm=k.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:l="start",verticalAnchor:f="end",fill:d=ok}=e,h=ik(e,ZU),m=k.useMemo(()=>nz({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:s,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,s,h.style,h.width]),{dx:x,dy:g,angle:y,className:v,breakAll:b}=h,E=ik(h,ez);if(!Si(r)||!Si(n)||m.length===0)return null;var N=r+(et(x)?x:0),S=n+(et(g)?g:0),j;switch(f){case"start":j=Ug("calc(".concat(i,")"));break;case"middle":j=Ug("calc(".concat((m.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:j=Ug("calc(".concat(m.length-1," * -").concat(a,")"));break}var T=[];if(s){var C=m[0].width,{width:P}=h;T.push("scale(".concat(et(P)?P/C:1,")"))}return y&&T.push("rotate(".concat(y,", ").concat(N,", ").concat(S,")")),T.length&&(E.transform=T.join(" ")),k.createElement("text",Zv({},Dr(E,!0),{ref:t,x:N,y:S,className:bt("recharts-text",v),textAnchor:l,fill:d.includes("url")?ok:d}),m.map((M,D)=>{var W=M.words.join(b?"":" ");return k.createElement("tspan",{x:N,dy:D===0?j:a,key:"".concat(W,"-").concat(D)},W)}))});wm.displayName="Text";var az=["labelRef"];function iz(e,t){if(e==null)return{};var r,n,a=sz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function lk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lk(Object(r),!0).forEach(function(n){oz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oz(e,t,r){return(t=lz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lz(e){var t=cz(e,"string");return typeof t=="symbol"?t:t+""}function cz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bi(){return Bi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bi.apply(null,arguments)}var p3=k.createContext(null),uz=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,s=k.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return k.createElement(p3.Provider,{value:s},i)},x3=()=>{var e=k.useContext(p3),t=K1();return e||t},fz=k.createContext(null),dz=()=>{var e=k.useContext(fz),t=Ze(aT);return e||t},hz=e=>{var{value:t,formatter:r}=e,n=Yr(e.children)?t:e.children;return typeof r=="function"?r(n):n},ib=e=>e!=null&&typeof e=="function",mz=(e,t)=>{var r=qr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},pz=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:l,cy:f,innerRadius:d,outerRadius:h,startAngle:m,endAngle:x,clockWise:g}=a,y=(d+h)/2,v=mz(m,x),b=v>=0?1:-1,E,N;switch(t){case"insideStart":E=m+b*i,N=g;break;case"insideEnd":E=x-b*i,N=!g;break;case"end":E=x+b*i,N=g;break;default:throw new Error("Unsupported position ".concat(t))}N=v<=0?N:!N;var S=_r(l,f,y,E),j=_r(l,f,y,E+(N?1:-1)*359),T="M".concat(S.x,",").concat(S.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(N?0:1,`,
    `).concat(j.x,",").concat(j.y),C=Yr(e.id)?Zu("recharts-radial-line-"):e.id;return k.createElement("text",Bi({},n,{dominantBaseline:"central",className:bt("recharts-radial-bar-label",s)}),k.createElement("defs",null,k.createElement("path",{id:C,d:T})),k.createElement("textPath",{xlinkHref:"#".concat(C)},r))},xz=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:l,endAngle:f}=e,d=(l+f)/2;if(r==="outside"){var{x:h,y:m}=_r(n,a,s+t,d);return{x:h,y:m,textAnchor:h>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var x=(i+s)/2,{x:g,y}=_r(n,a,x,d);return{x:g,y,textAnchor:"middle",verticalAnchor:"middle"}},g3=e=>"cx"in e&&et(e.cx),gz=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!g3(r)&&(i=r);var{x:s,y:l,width:f,height:d}=t,h=d>=0?1:-1,m=h*n,x=h>0?"end":"start",g=h>0?"start":"end",y=f>=0?1:-1,v=y*n,b=y>0?"end":"start",E=y>0?"start":"end";if(a==="top"){var N={x:s+f/2,y:l-h*n,textAnchor:"middle",verticalAnchor:x};return gr(gr({},N),i?{height:Math.max(l-i.y,0),width:f}:{})}if(a==="bottom"){var S={x:s+f/2,y:l+d+m,textAnchor:"middle",verticalAnchor:g};return gr(gr({},S),i?{height:Math.max(i.y+i.height-(l+d),0),width:f}:{})}if(a==="left"){var j={x:s-v,y:l+d/2,textAnchor:b,verticalAnchor:"middle"};return gr(gr({},j),i?{width:Math.max(j.x-i.x,0),height:d}:{})}if(a==="right"){var T={x:s+f+v,y:l+d/2,textAnchor:E,verticalAnchor:"middle"};return gr(gr({},T),i?{width:Math.max(i.x+i.width-T.x,0),height:d}:{})}var C=i?{width:f,height:d}:{};return a==="insideLeft"?gr({x:s+v,y:l+d/2,textAnchor:E,verticalAnchor:"middle"},C):a==="insideRight"?gr({x:s+f-v,y:l+d/2,textAnchor:b,verticalAnchor:"middle"},C):a==="insideTop"?gr({x:s+f/2,y:l+m,textAnchor:"middle",verticalAnchor:g},C):a==="insideBottom"?gr({x:s+f/2,y:l+d-m,textAnchor:"middle",verticalAnchor:x},C):a==="insideTopLeft"?gr({x:s+v,y:l+m,textAnchor:E,verticalAnchor:g},C):a==="insideTopRight"?gr({x:s+f-v,y:l+m,textAnchor:b,verticalAnchor:g},C):a==="insideBottomLeft"?gr({x:s+v,y:l+d-m,textAnchor:E,verticalAnchor:x},C):a==="insideBottomRight"?gr({x:s+f-v,y:l+d-m,textAnchor:b,verticalAnchor:x},C):a&&typeof a=="object"&&(et(a.x)||Po(a.x))&&(et(a.y)||Po(a.y))?gr({x:s+En(a.x,f),y:l+En(a.y,d),textAnchor:"end",verticalAnchor:"end"},C):gr({x:s+f/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},C)},vz={offset:5};function Ms(e){var t=Rn(e,vz),{viewBox:r,position:n,value:a,children:i,content:s,className:l="",textBreakAll:f,labelRef:d}=t,h=dz(),m=x3(),x=n==="center"?m:h??m,g=r||x;if(!g||Yr(a)&&Yr(i)&&!k.isValidElement(s)&&typeof s!="function")return null;var y=gr(gr({},t),{},{viewBox:g});if(k.isValidElement(s)){var{labelRef:v}=y,b=iz(y,az);return k.cloneElement(s,b)}var E;if(typeof s=="function"){if(E=k.createElement(s,y),k.isValidElement(E))return E}else E=hz(t);var N=g3(g),S=Dr(t,!0);if(N&&(n==="insideStart"||n==="insideEnd"||n==="end"))return pz(t,n,E,S,g);var j=N?xz(g,t.offset,t.position):gz(t,g);return k.createElement(wm,Bi({ref:d,className:bt("recharts-label",l)},S,j,{breakAll:f}),E)}Ms.displayName="Label";var yz=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?k.createElement(Ms,Bi({key:"label-implicit"},n)):Si(e)?k.createElement(Ms,Bi({key:"label-implicit",value:e},n)):k.isValidElement(e)?e.type===Ms?k.cloneElement(e,gr({key:"label-implicit"},n)):k.createElement(Ms,Bi({key:"label-implicit",content:e},n)):ib(e)?k.createElement(Ms,Bi({key:"label-implicit",content:e},n)):e&&typeof e=="object"?k.createElement(Ms,Bi({},e,{key:"label-implicit"},n)):null};function bz(e){var{label:t}=e,r=x3();return yz(t,r)||null}var zg={},Wg={},ck;function wz(){return ck||(ck=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Wg)),Wg}var Hg={},uk;function Sz(){return uk||(uk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Hg)),Hg}var fk;function Nz(){return fk||(fk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wz(),r=Sz(),n=R1();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(zg)),zg}var Vg,dk;function Ez(){return dk||(dk=1,Vg=Nz().last),Vg}var _z=Ez();const kz=Ei(_z);var jz=["valueAccessor"],Cz=["dataKey","clockWise","id","textBreakAll"];function xh(){return xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xh.apply(null,arguments)}function hk(e,t){if(e==null)return{};var r,n,a=Az(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Az(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Tz=e=>Array.isArray(e.value)?kz(e.value):e.value,v3=k.createContext(void 0),Pz=v3.Provider,y3=k.createContext(void 0),Oz=y3.Provider;function Fz(){return k.useContext(v3)}function Dz(){return k.useContext(y3)}function D0(e){var{valueAccessor:t=Tz}=e,r=hk(e,jz),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,l=hk(r,Cz),f=Fz(),d=Dz(),h=f||d;return!h||!h.length?null:k.createElement(Qn,{className:"recharts-label-list"},h.map((m,x)=>{var g,y=Yr(n)?t(m,x):ir(m&&m.payload,n),v=Yr(i)?{}:{id:"".concat(i,"-").concat(x)};return k.createElement(Ms,xh({},Dr(m,!0),l,v,{fill:(g=r.fill)!==null&&g!==void 0?g:m.fill,parentViewBox:m.parentViewBox,value:y,textBreakAll:s,viewBox:m.viewBox,key:"label-".concat(x),index:x}))}))}D0.displayName="LabelList";function b3(e){var{label:t}=e;return t?t===!0?k.createElement(D0,{key:"labelList-implicit"}):k.isValidElement(t)||ib(t)?k.createElement(D0,{key:"labelList-implicit",content:t}):typeof t=="object"?k.createElement(D0,xh({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var w3=e=>e.graphicalItems.polarItems,Iz=Se([er,Rf],Fy),sb=Se([w3,yr,Iz],Iy),Mz=Se([sb],My),ob=Se([Mz,wy],Ry),Rz=Se([ob,yr,sb],By),Lz=Se([ob,yr,sb],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=ir(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:ir(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),mk=()=>{},Bz=Se([yr,ET,mk,Lz,mk,_t,er],Uy),S3=Se([yr,_t,ob,Rz,Mf,er,Bz],zy),$z=Se([S3,yr,Oc],Vy);Se([yr,S3,$z,er],Ky);var Uz={radiusAxis:{},angleAxis:{}},N3=ga({name:"polarAxis",initialState:Uz,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:jle,removeRadiusAxis:Cle,addAngleAxis:Ale,removeAngleAxis:Tle}=N3.actions,zz=N3.reducer;function pk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pk(Object(r),!0).forEach(function(n){Wz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wz(e,t,r){return(t=Hz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hz(e){var t=Vz(e,"string");return typeof t=="symbol"?t:t+""}function Vz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gz=(e,t)=>t,lb=Se([w3,Gz],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),Kz=[],cb=(e,t,r)=>r?.length===0?Kz:r,E3=Se([wy,lb,cb],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>xk(xk({},t.presentationProps),i.props))),a!=null)return a}}),qz=Se([E3,lb,cb],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=ir(n,t.nameKey,t.name),l;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:Qh(s,t.dataKey),color:l,payload:n,type:t.legendType}})}),Xz=Se([E3,lb,cb,Mr],(e,t,r,n)=>{if(!(t==null||e==null))return qW({offset:n,pieSettings:t,displayedData:e,cells:r})}),Gg={},gk;function Yz(){return gk||(gk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(Gg)),Gg}var Kg,vk;function Jz(){return vk||(vk=1,Kg=Yz().isPlainObject),Kg}var Qz=Jz();const Zz=Ei(Qz);function yk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yk(Object(r),!0).forEach(function(n){eW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eW(e,t,r){return(t=tW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tW(e){var t=rW(e,"string");return typeof t=="symbol"?t:t+""}function rW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gh(){return gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gh.apply(null,arguments)}var wk=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},nW={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},aW=e=>{var t=Rn(e,nW),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:l}=t,{animationEasing:f,animationDuration:d,animationBegin:h,isUpdateAnimationActive:m}=t,x=k.useRef(),[g,y]=k.useState(-1),v=k.useRef(a),b=k.useRef(i),E=k.useRef(s),N=k.useRef(r),S=k.useRef(n),j=im(e,"trapezoid-");if(k.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var se=x.current.getTotalLength();se&&y(se)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var T=bt("recharts-trapezoid",l);if(!m)return k.createElement("g",null,k.createElement("path",gh({},Dr(t,!0),{className:T,d:wk(r,n,a,i,s)})));var C=v.current,P=b.current,M=E.current,D=N.current,W=S.current,F="0px ".concat(g===-1?1:g,"px"),L="".concat(g,"px 0px"),J=qC(["strokeDasharray"],d,f);return k.createElement(am,{animationId:j,key:j,canBegin:g>0,duration:d,easing:f,isActive:m,begin:h},se=>{var Z=un(C,a,se),he=un(P,i,se),le=un(M,s,se),de=un(D,r,se),Q=un(W,n,se);x.current&&(v.current=Z,b.current=he,E.current=le,N.current=de,S.current=Q);var pe=se>0?{transition:J,strokeDasharray:L}:{strokeDasharray:F};return k.createElement("path",gh({},Dr(t,!0),{className:T,d:wk(de,Q,Z,he,le),ref:x,style:bk(bk({},pe),t.style)}))})},iW=["option","shapeType","propTransformer","activeClassName","isActive"];function sW(e,t){if(e==null)return{};var r,n,a=oW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Sk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sk(Object(r),!0).forEach(function(n){lW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lW(e,t,r){return(t=cW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cW(e){var t=uW(e,"string");return typeof t=="symbol"?t:t+""}function uW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fW(e,t){return vh(vh({},t),e)}function dW(e,t){return e==="symbols"}function Nk(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return k.createElement(QC,r);case"trapezoid":return k.createElement(aW,r);case"sector":return k.createElement(tA,r);case"symbols":if(dW(t))return k.createElement(D1,r);break;default:return null}}function hW(e){return k.isValidElement(e)?e.props:e}function _3(e){var{option:t,shapeType:r,propTransformer:n=fW,activeClassName:a="recharts-active-shape",isActive:i}=e,s=sW(e,iW),l;if(k.isValidElement(t))l=k.cloneElement(t,vh(vh({},s),hW(t)));else if(typeof t=="function")l=t(s);else if(Zz(t)&&typeof t!="boolean"){var f=n(t,s);l=k.createElement(Nk,{shapeType:r,elementProps:f})}else{var d=s;l=k.createElement(Nk,{shapeType:r,elementProps:d})}return i?k.createElement(Qn,{className:a},l):l}var ub=(e,t)=>{var r=lr();return(n,a)=>i=>{e?.(n,a,i),r($T({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},fb=e=>{var t=lr();return(r,n)=>a=>{e?.(r,n,a),t(XB())}},db=(e,t)=>{var r=lr();return(n,a)=>i=>{e?.(n,a,i),r(YB({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function k3(e){var{fn:t,args:r}=e,n=lr(),a=$a();return k.useEffect(()=>{if(!a){var i=t(r);return n(GB(i)),()=>{n(KB(i))}}},[t,r,n,a]),null}var j3=()=>{};function mW(e){var{legendPayload:t}=e,r=lr(),n=$a();return k.useEffect(()=>n?j3:(r(HC(t)),()=>{r(VC(t))}),[r,n,t]),null}function pW(e){var{legendPayload:t}=e,r=lr(),n=Ze(_t);return k.useEffect(()=>n!=="centric"&&n!=="radial"?j3:(r(HC(t)),()=>{r(VC(t))}),[r,n,t]),null}var qg,xW=()=>{var[e]=k.useState(()=>Zu("uid-"));return e},gW=(qg=f5.useId)!==null&&qg!==void 0?qg:xW;function vW(e,t){var r=gW();return t||(e?"".concat(e,"-").concat(r):r)}var yW=k.createContext(void 0),C3=e=>{var{id:t,type:r,children:n}=e,a=vW("recharts-".concat(r),t);return k.createElement(yW.Provider,{value:a},n(a))},bW={cartesianItems:[],polarItems:[]},A3=ga({name:"graphicalItems",initialState:bW,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=Vi(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=Vi(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Vi(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:wW,replaceCartesianGraphicalItem:SW,removeCartesianGraphicalItem:NW,addPolarGraphicalItem:EW,removePolarGraphicalItem:_W}=A3.actions,kW=A3.reducer;function jW(e){var t=lr(),r=k.useRef(null);return k.useEffect(()=>{r.current===null?t(wW(e)):r.current!==e&&t(SW({prev:r.current,next:e})),r.current=e},[t,e]),k.useEffect(()=>()=>{r.current&&(t(NW(r.current)),r.current=null)},[t]),null}function CW(e){var t=lr();return k.useEffect(()=>(t(EW(e)),()=>{t(_W(e))}),[t,e]),null}var AW=["onMouseEnter","onClick","onMouseLeave"],TW=["id"],PW=["id"];function hb(e,t){if(e==null)return{};var r,n,a=OW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function OW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ek(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ek(Object(r),!0).forEach(function(n){FW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ek(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FW(e,t,r){return(t=DW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DW(e){var t=IW(e,"string");return typeof t=="symbol"?t:t+""}function IW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gs(){return Gs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gs.apply(null,arguments)}function MW(e){var t=k.useMemo(()=>A1(e.children,Wi),[e.children]),r=Ze(n=>qz(n,e.id,t));return r==null?null:k.createElement(pW,{legendPayload:r})}function RW(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:l,hide:f,tooltipType:d}=e;return{dataDefinedOnItem:n.map(h=>h.tooltipPayload),positions:n.map(h=>h.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:Qh(l,t),hide:f,type:d,color:s,unit:""}}}var LW=(e,t)=>e>t?"start":e<t?"end":"middle",BW=(e,t,r)=>En(typeof t=="function"?t(e):t,r,r*.8),$W=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,l=IC(i,s),f=a+En(e.cx,i,i/2),d=n+En(e.cy,s,s/2),h=En(e.innerRadius,l,0),m=BW(r,e.outerRadius,l),x=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:f,cy:d,innerRadius:h,outerRadius:m,maxRadius:x}},UW=(e,t)=>{var r=qr(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function zW(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var WW=(e,t)=>{if(k.isValidElement(e))return k.cloneElement(e,t);if(typeof e=="function")return e(t);var r=bt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return k.createElement(KC,Gs({},t,{type:"linear",className:r}))},HW=(e,t,r)=>{if(k.isValidElement(e))return k.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),k.isValidElement(n)))return n;var a=bt("recharts-pie-label-text",zW(e));return k.createElement(wm,Gs({},t,{alignmentBaseline:"middle",className:a}),n)};function VW(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var l=to(r),f=Dr(a,!1),d=Dr(i,!1),h=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,m=t.map((x,g)=>{var y=(x.startAngle+x.endAngle)/2,v=_r(x.cx,x.cy,x.outerRadius+h,y),b=Qt(Qt(Qt(Qt({},l),x),{},{stroke:"none"},f),{},{index:g,textAnchor:LW(v.x,x.cx)},v),E=Qt(Qt(Qt(Qt({},l),x),{},{fill:"none",stroke:x.fill},d),{},{index:g,points:[_r(x.cx,x.cy,x.outerRadius,y),v],key:"line"});return k.createElement(Qn,{key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(g)},i&&WW(i,E),HW(a,b,ir(x,s)))});return k.createElement(Qn,{className:"recharts-pie-labels"},m)}function GW(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?k.createElement(b3,{label:a}):k.createElement(VW,{sectors:t,props:r,showLabels:n})}function KW(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=Ze(Jo),{onMouseEnter:s,onClick:l,onMouseLeave:f}=a,d=hb(a,AW),h=ub(s,a.dataKey),m=fb(f),x=db(l,a.dataKey);return t==null||t.length===0?null:k.createElement(k.Fragment,null,t.map((g,y)=>{if(g?.startAngle===0&&g?.endAngle===0&&t.length!==1)return null;var v=r&&String(y)===i,b=i?n:null,E=v?r:b,N=Qt(Qt({},g),{},{stroke:g.stroke,tabIndex:-1,[$C]:y,[UC]:a.dataKey});return k.createElement(Qn,Gs({tabIndex:-1,className:"recharts-pie-sector"},Cf(d,g,y),{onMouseEnter:h(g,y),onMouseLeave:m(g,y),onClick:x(g,y),key:"sector-".concat(g?.startAngle,"-").concat(g?.endAngle,"-").concat(g.midAngle,"-").concat(y)}),k.createElement(_3,Gs({option:E,isActive:v,shapeType:"sector"},N)))}))}function qW(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:l,endAngle:f,dataKey:d,nameKey:h,tooltipType:m}=r,x=Math.abs(r.minAngle),g=UW(l,f),y=Math.abs(g),v=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,b=n.filter(C=>ir(C,d,0)!==0).length,E=(y>=360?b:b-1)*v,N=y-b*x-E,S=n.reduce((C,P)=>{var M=ir(P,d,0);return C+(et(M)?M:0)},0),j;if(S>0){var T;j=n.map((C,P)=>{var M=ir(C,d,0),D=ir(C,h,P),W=$W(r,i,C),F=(et(M)?M:0)/S,L,J=Qt(Qt({},C),a&&a[P]&&a[P].props);P?L=T.endAngle+qr(g)*v*(M!==0?1:0):L=l;var se=L+qr(g)*((M!==0?x:0)+F*N),Z=(L+se)/2,he=(W.innerRadius+W.outerRadius)/2,le=[{name:D,value:M,payload:J,dataKey:d,type:m}],de=_r(W.cx,W.cy,he,Z);return T=Qt(Qt(Qt(Qt({},r.presentationProps),{},{percent:F,cornerRadius:s,name:D,tooltipPayload:le,midAngle:Z,middleRadius:he,tooltipPosition:de},J),W),{},{value:M,startAngle:L,endAngle:se,payload:J,paddingAngle:qr(g)*v}),T})}return j}function XW(e){var{showLabels:t,sectors:r,children:n}=e,a=k.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return k.createElement(Oz,{value:t?a:void 0},n)}function YW(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:l,activeShape:f,inactiveShape:d,onAnimationStart:h,onAnimationEnd:m}=t,x=im(t,"recharts-pie-"),g=r.current,[y,v]=k.useState(!1),b=k.useCallback(()=>{typeof m=="function"&&m(),v(!1)},[m]),E=k.useCallback(()=>{typeof h=="function"&&h(),v(!0)},[h]);return k.createElement(XW,{showLabels:!y,sectors:n},k.createElement(am,{animationId:x,begin:i,duration:s,isActive:a,easing:l,onAnimationStart:E,onAnimationEnd:b,key:x},N=>{var S=[],j=n&&n[0],T=j?.startAngle;return n?.forEach((C,P)=>{var M=g&&g[P],D=P>0?Ko(C,"paddingAngle",0):0;if(M){var W=un(M.endAngle-M.startAngle,C.endAngle-C.startAngle,N),F=Qt(Qt({},C),{},{startAngle:T+D,endAngle:T+W+D});S.push(F),T=F.endAngle}else{var{endAngle:L,startAngle:J}=C,se=un(0,L-J,N),Z=Qt(Qt({},C),{},{startAngle:T+D,endAngle:T+se+D});S.push(Z),T=Z.endAngle}}),r.current=S,k.createElement(Qn,null,k.createElement(KW,{sectors:S,activeShape:f,inactiveShape:d,allOtherPieProps:t}))}),k.createElement(GW,{showLabels:!y,sectors:n,props:t}),t.children)}var JW={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!ll.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function QW(e){var{id:t}=e,r=hb(e,TW),{hide:n,className:a,rootTabIndex:i}=e,s=k.useMemo(()=>A1(e.children,Wi),[e.children]),l=Ze(h=>Xz(h,t,s)),f=k.useRef(null),d=bt("recharts-pie",a);return n||l==null?(f.current=null,k.createElement(Qn,{tabIndex:i,className:d})):k.createElement(k.Fragment,null,k.createElement(k3,{fn:RW,args:Qt(Qt({},e),{},{sectors:l})}),k.createElement(Qn,{tabIndex:i,className:d},k.createElement(YW,{props:Qt(Qt({},r),{},{sectors:l}),previousSectorsRef:f})))}function Wu(e){var t=Rn(e,JW),{id:r}=t,n=hb(t,PW),a=to(n);return k.createElement(C3,{id:r,type:"pie"},i=>k.createElement(k.Fragment,null,k.createElement(CW,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),k.createElement(MW,Gs({},n,{id:i})),k.createElement(QW,Gs({},n,{id:i}))))}Wu.displayName="Pie";function _k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_k(Object(r),!0).forEach(function(n){ZW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_k(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZW(e,t,r){return(t=eH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eH(e){var t=tH(e,"string");return typeof t=="symbol"?t:t+""}function tH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rH={xAxis:{},yAxis:{},zAxis:{}},T3=ga({name:"cartesianAxis",initialState:rH,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=kk(kk({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:nH,removeXAxis:aH,addYAxis:iH,removeYAxis:sH,addZAxis:Ple,removeZAxis:Ole,updateYAxisWidth:oH}=T3.actions,lH=T3.reducer,cH=Se([Mr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),uH=Se([cH,as,is],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),P3=()=>Ze(uH),fH="Invariant failed";function dH(e,t){throw new Error(fH)}var hH=["x","y"];function e1(){return e1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e1.apply(null,arguments)}function jk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jk(Object(r),!0).forEach(function(n){mH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mH(e,t,r){return(t=pH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pH(e){var t=xH(e,"string");return typeof t=="symbol"?t:t+""}function xH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gH(e,t){if(e==null)return{};var r,n,a=vH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yH(e,t){var{x:r,y:n}=e,a=gH(e,hH),i="".concat(r),s=parseInt(i,10),l="".concat(n),f=parseInt(l,10),d="".concat(t.height||a.height),h=parseInt(d,10),m="".concat(t.width||a.width),x=parseInt(m,10);return Pu(Pu(Pu(Pu(Pu({},t),a),s?{x:s}:{}),f?{y:f}:{}),{},{height:h,width:x,name:t.name,radius:t.radius})}function mb(e){return k.createElement(_3,e1({shapeType:"rectangle",propTransformer:yH,activeClassName:"recharts-active-bar"},e))}var bH=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(et(t))return t;var i=et(n)||Yr(n);return i?t(n,a):(i||dH(),r)}},wH={},O3=ga({name:"errorBars",initialState:wH,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:Fle,replaceErrorBar:Dle,removeErrorBar:Ile}=O3.actions,SH=O3.reducer,NH=["children"];function EH(e,t){if(e==null)return{};var r,n,a=_H(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _H(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var kH={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},jH=k.createContext(kH);function CH(e){var{children:t}=e,r=EH(e,NH);return k.createElement(jH.Provider,{value:r},t)}function F3(e,t){var r,n,a=Ze(d=>os(d,e)),i=Ze(d=>ls(d,t)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:aa.allowDataOverflow,l=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:ia.allowDataOverflow,f=s||l;return{needClip:f,needClipX:s,needClipY:l}}function AH(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=P3(),{needClipX:i,needClipY:s,needClip:l}=F3(t,r);if(!l)return null;var{x:f,y:d,width:h,height:m}=a;return k.createElement("clipPath",{id:"clipPath-".concat(n)},k.createElement("rect",{x:i?f:f-h/2,y:s?d:d-m/2,width:i?h:h*2,height:s?m:m*2}))}var TH=["onMouseEnter","onMouseLeave","onClick"],PH=["value","background","tooltipPosition"],OH=["id"],FH=["onMouseEnter","onClick","onMouseLeave"];function Ks(){return Ks=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ks.apply(null,arguments)}function Ck(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ck(Object(r),!0).forEach(function(n){DH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ck(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DH(e,t,r){return(t=IH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IH(e){var t=MH(e,"string");return typeof t=="symbol"?t:t+""}function MH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yh(e,t){if(e==null)return{};var r,n,a=RH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function RH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var LH=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Qh(r,t),payload:e}]};function BH(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:Qh(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:l}}}function $H(e){var t=Ze(Jo),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:l,onClick:f}=i,d=yh(i,TH),h=ub(s,n),m=fb(l),x=db(f,n);if(!a||r==null)return null;var g=Dr(a,!1);return k.createElement(k.Fragment,null,r.map((y,v)=>{var{value:b,background:E,tooltipPosition:N}=y,S=yh(y,PH);if(!E)return null;var j=h(y,v),T=m(y,v),C=x(y,v),P=Fn(Fn(Fn(Fn(Fn({option:a,isActive:String(v)===t},S),{},{fill:"#eee"},E),g),Cf(d,y,v)),{},{onMouseEnter:j,onMouseLeave:T,onClick:C,dataKey:n,index:v,className:"recharts-bar-background-rectangle"});return k.createElement(mb,Ks({key:"background-bar-".concat(P.index)},P))}))}function UH(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return Fn(Fn({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return k.createElement(Pz,{value:t?a:void 0},r)}function zH(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,l=Ze(Jo),f=Ze(ZT),d=r&&String(i)===l&&(f==null||s===f),h=d?r:t;return k.createElement(mb,Ks({},n,a,{isActive:d,option:h,index:i,dataKey:s}))}function WH(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return k.createElement(mb,Ks({},r,n,{isActive:!1,option:t,index:a,dataKey:i}))}function HH(e){var{data:t,props:r}=e,n=to(r),{id:a}=n,i=yh(n,OH),{shape:s,dataKey:l,activeBar:f}=r,{onMouseEnter:d,onClick:h,onMouseLeave:m}=r,x=yh(r,FH),g=ub(d,l),y=fb(m),v=db(h,l);return t?k.createElement(k.Fragment,null,t.map((b,E)=>k.createElement(Qn,Ks({className:"recharts-bar-rectangle"},Cf(x,b,E),{onMouseEnter:g(b,E),onMouseLeave:y(b,E),onClick:v(b,E),key:"rectangle-".concat(b?.x,"-").concat(b?.y,"-").concat(b?.value,"-").concat(E)}),f?k.createElement(zH,{shape:s,activeBar:f,baseProps:i,entry:b,index:E,dataKey:l}):k.createElement(WH,{shape:s,baseProps:i,entry:b,index:E,dataKey:l})))):null}function VH(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:f,onAnimationEnd:d,onAnimationStart:h}=t,m=r.current,x=im(t,"recharts-bar-"),[g,y]=k.useState(!1),v=!g,b=k.useCallback(()=>{typeof d=="function"&&d(),y(!1)},[d]),E=k.useCallback(()=>{typeof h=="function"&&h(),y(!0)},[h]);return k.createElement(UH,{showLabels:v,rects:n},k.createElement(am,{animationId:x,begin:s,duration:l,isActive:i,easing:f,onAnimationEnd:b,onAnimationStart:E,key:x},N=>{var S=N===1?n:n?.map((j,T)=>{var C=m&&m[T];if(C)return Fn(Fn({},j),{},{x:un(C.x,j.x,N),y:un(C.y,j.y,N),width:un(C.width,j.width,N),height:un(C.height,j.height,N)});if(a==="horizontal"){var P=un(0,j.height,N);return Fn(Fn({},j),{},{y:j.y+j.height-P,height:P})}var M=un(0,j.width,N);return Fn(Fn({},j),{},{width:M})});return N>0&&(r.current=S??null),S==null?null:k.createElement(Qn,null,k.createElement(HH,{props:t,data:S}))}),k.createElement(b3,{label:t.label}),t.children)}function GH(e){var t=k.useRef(null);return k.createElement(VH,{previousRectanglesRef:t,props:e})}var D3=0,KH=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:ir(e,t)}};class qH extends k.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:l,background:f,id:d}=this.props;if(t||r==null)return null;var h=bt("recharts-bar",a),m=d;return k.createElement(Qn,{className:h,id:d},l&&k.createElement("defs",null,k.createElement(AH,{clipPathId:m,xAxisId:i,yAxisId:s})),k.createElement(Qn,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(m,")"):void 0},k.createElement($H,{data:r,dataKey:n,background:f,allOtherBarProps:this.props}),k.createElement(GH,this.props)))}}var XH={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!ll.isSsr,legendType:"rect",minPointSize:D3,xAxisId:0,yAxisId:0};function YH(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:f,animationEasing:d,isAnimationActive:h}=e,{needClip:m}=F3(t,r),x=Y1(),g=$a(),y=A1(e.children,Wi),v=Ze(N=>EV(N,t,r,g,e.id,y));if(x!=="vertical"&&x!=="horizontal")return null;var b,E=v?.[0];return E==null||E.height==null||E.width==null?b=0:b=x==="vertical"?E.height/2:E.width/2,k.createElement(CH,{xAxisId:t,yAxisId:r,data:v,dataPointFormatter:KH,errorBarOffset:b},k.createElement(qH,Ks({},e,{layout:x,needClip:m,data:v,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:f,animationEasing:d,isAnimationActive:h})))}function JH(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:l,xAxisTicks:f,yAxisTicks:d,stackedData:h,displayedData:m,offset:x,cells:g,parentViewBox:y}=e,v=t==="horizontal"?l:s,b=h?v.scale.domain():null,E=f8({numericAxis:v});return m.map((N,S)=>{var j,T,C,P,M,D;h?j=i8(h[S],b):(j=ir(N,r),Array.isArray(j)||(j=[E,j]));var W=bH(n,D3)(j[1],S);if(t==="horizontal"){var F,[L,J]=[l.scale(j[0]),l.scale(j[1])];T=pE({axis:s,ticks:f,bandSize:i,offset:a.offset,entry:N,index:S}),C=(F=J??L)!==null&&F!==void 0?F:void 0,P=a.size;var se=L-J;if(M=ha(se)?0:se,D={x:T,y:x.top,width:P,height:x.height},Math.abs(W)>0&&Math.abs(M)<Math.abs(W)){var Z=qr(M||W)*(Math.abs(W)-Math.abs(M));C-=Z,M+=Z}}else{var[he,le]=[s.scale(j[0]),s.scale(j[1])];if(T=he,C=pE({axis:l,ticks:d,bandSize:i,offset:a.offset,entry:N,index:S}),P=le-he,M=a.size,D={x:x.left,y:C,width:x.width,height:M},Math.abs(W)>0&&Math.abs(P)<Math.abs(W)){var de=qr(P||W)*(Math.abs(W)-Math.abs(P));P+=de}}if(T==null||C==null||P==null||M==null)return null;var Q=Fn(Fn({},N),{},{x:T,y:C,width:P,height:M,value:h?j:j[1],payload:N,background:D,tooltipPosition:{x:T+P/2,y:C+M/2},parentViewBox:y},g&&g[S]&&g[S].props);return Q}).filter(Boolean)}function QH(e){var t=Rn(e,XH),r=$a();return k.createElement(C3,{id:t.id,type:"bar"},n=>k.createElement(k.Fragment,null,k.createElement(mW,{legendPayload:LH(t)}),k.createElement(k3,{fn:BH,args:t}),k.createElement(jW,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:u8(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),k.createElement(YH,Ks({},t,{id:n}))))}var I3=k.memo(QH);I3.displayName="Bar";function Ak(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function b0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ak(Object(r),!0).forEach(function(n){ZH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ak(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZH(e,t,r){return(t=eV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eV(e){var t=tV(e,"string");return typeof t=="symbol"?t:t+""}function tV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rV=(e,t)=>t,nV=(e,t,r)=>r,aV=(e,t,r,n)=>n,iV=(e,t,r,n,a)=>a,Wf=Se([Dy,iV],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),sV=Se([Wf],e=>e?.maxBarSize),oV=(e,t,r,n,a,i)=>i,Tk=(e,t,r)=>{var n=r??e;if(!Yr(n))return En(n,t,0)},lV=Se([_t,Dy,rV,nV,aV],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),cV=(e,t,r,n)=>{var a=_t(e);return a==="horizontal"?qv(e,"yAxis",r,n):qv(e,"xAxis",t,n)},uV=(e,t,r)=>{var n=_t(e);return n==="horizontal"?O_(e,"xAxis",t):O_(e,"yAxis",r)},fV=(e,t,r)=>{var n={},a=e.filter(pm),i=e.filter(d=>d.stackId==null),s=a.reduce((d,h)=>(d[h.stackId]||(d[h.stackId]=[]),d[h.stackId].push(h),d),n),l=Object.entries(s).map(d=>{var[h,m]=d,x=m.map(y=>y.dataKey),g=Tk(t,r,m[0].barSize);return{stackId:h,dataKeys:x,barSize:g}}),f=i.map(d=>{var h=[d.dataKey].filter(x=>x!=null),m=Tk(t,r,d.barSize);return{stackId:void 0,dataKeys:h,barSize:m}});return[...l,...f]},dV=Se([lV,V9,uV],fV),hV=(e,t,r,n,a)=>{var i,s,l=Wf(e,t,r,n,a);if(l!=null){var f=_t(e),d=JA(e),{maxBarSize:h}=l,m=Yr(h)?d:h,x,g;return f==="horizontal"?(x=wc(e,"xAxis",t,n),g=bc(e,"xAxis",t,n)):(x=wc(e,"yAxis",r,n),g=bc(e,"yAxis",r,n)),(i=(s=V1(x,g,!0))!==null&&s!==void 0?s:m)!==null&&i!==void 0?i:0}},M3=(e,t,r,n)=>{var a=_t(e),i,s;return a==="horizontal"?(i=wc(e,"xAxis",t,n),s=bc(e,"xAxis",t,n)):(i=wc(e,"yAxis",r,n),s=bc(e,"yAxis",r,n)),V1(i,s)};function mV(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=En(e,r,0,!0),l,f=[];if(pa(n[0].barSize)){var d=!1,h=r/i,m=n.reduce((E,N)=>E+(N.barSize||0),0);m+=(i-1)*s,m>=r&&(m-=(i-1)*s,s=0),m>=r&&h>0&&(d=!0,h*=.9,m=i*h);var x=(r-m)/2>>0,g={offset:x-s,size:0};l=n.reduce((E,N)=>{var S,j={stackId:N.stackId,dataKeys:N.dataKeys,position:{offset:g.offset+g.size+s,size:d?h:(S=N.barSize)!==null&&S!==void 0?S:0}},T=[...E,j];return g=T[T.length-1].position,T},f)}else{var y=En(t,r,0,!0);r-2*y-(i-1)*s<=0&&(s=0);var v=(r-2*y-(i-1)*s)/i;v>1&&(v>>=0);var b=pa(a)?Math.min(v,a):v;l=n.reduce((E,N,S)=>[...E,{stackId:N.stackId,dataKeys:N.dataKeys,position:{offset:y+(v+s)*S+(v-b)/2,size:b}}],f)}return l}}var pV=(e,t,r,n,a,i,s)=>{var l=Yr(s)?t:s,f=mV(r,n,a!==i?a:i,e,l);return a!==i&&f!=null&&(f=f.map(d=>b0(b0({},d),{},{position:b0(b0({},d.position),{},{offset:d.position.offset-a/2})}))),f},xV=Se([dV,JA,H9,QA,hV,M3,sV],pV),gV=(e,t,r,n)=>wc(e,"xAxis",t,n),vV=(e,t,r,n)=>wc(e,"yAxis",r,n),yV=(e,t,r,n)=>bc(e,"xAxis",t,n),bV=(e,t,r,n)=>bc(e,"yAxis",r,n),wV=Se([xV,Wf],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),SV=(e,t)=>{var r=Py(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},NV=Se([cV,Wf],SV),EV=Se([Mr,G1,gV,vV,yV,bV,wV,_t,Sy,M3,NV,Wf,oV],(e,t,r,n,a,i,s,l,f,d,h,m,x)=>{var{chartData:g,dataStartIndex:y,dataEndIndex:v}=f;if(!(m==null||s==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||i==null||d==null)){var{data:b}=m,E;if(b!=null&&b.length>0?E=b:E=g?.slice(y,v+1),E!=null)return JH({layout:l,barSettings:m,pos:s,parentViewBox:t,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:h,displayedData:E,offset:e,cells:x})}}),R3=e=>{var{chartData:t}=e,r=lr(),n=$a();return k.useEffect(()=>n?()=>{}:(r(z_(t)),()=>{r(z_(void 0))}),[t,r,n]),null},Pk={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},L3=ga({name:"brush",initialState:Pk,reducers:{setBrushSettings(e,t){return t.payload==null?Pk:t.payload}}}),{setBrushSettings:Mle}=L3.actions,_V=L3.reducer;function kV(e,t,r){return(t=jV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jV(e){var t=CV(e,"string");return typeof t=="symbol"?t:t+""}function CV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class pb{static create(t){return new pb(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}kV(pb,"EPS",1e-4);function AV(e){return(e%180+180)%180}var TV=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=AV(a),s=i*Math.PI/180,l=Math.atan(n/r),f=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(f)},PV={dots:[],areas:[],lines:[]},B3=ga({name:"referenceElements",initialState:PV,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Vi(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Vi(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Vi(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Rle,removeDot:Lle,addArea:Ble,removeArea:$le,addLine:Ule,removeLine:zle}=B3.actions,OV=B3.reducer,FV=k.createContext(void 0),DV=e=>{var{children:t}=e,[r]=k.useState("".concat(Zu("recharts"),"-clip")),n=P3();if(n==null)return null;var{x:a,y:i,width:s,height:l}=n;return k.createElement(FV.Provider,{value:r},k.createElement("defs",null,k.createElement("clipPath",{id:r},k.createElement("rect",{x:a,y:i,height:l,width:s}))),t)};function Sc(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function $3(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function IV(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return TV(n,r)}function MV(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:l}=e;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function bh(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function RV(e,t){return $3(e,t+1)}function LV(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:l}=t,f=0,d=1,h=s,m=function(){var y=n?.[f];if(y===void 0)return{v:$3(n,d)};var v=f,b,E=()=>(b===void 0&&(b=r(y,v)),b),N=y.coordinate,S=f===0||bh(e,N,E,h,l);S||(f=0,h=s,d+=1),S&&(h=N+e*(E()/2+a),f+=d)},x;d<=i.length;)if(x=m(),x)return x.v;return[]}function Ok(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ok(Object(r),!0).forEach(function(n){BV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ok(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BV(e,t,r){return(t=$V(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $V(e){var t=UV(e,"string");return typeof t=="symbol"?t:t+""}function UV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zV(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:l}=t,{end:f}=t,d=function(x){var g=i[x],y,v=()=>(y===void 0&&(y=r(g,x)),y);if(x===s-1){var b=e*(g.coordinate+e*v()/2-f);i[x]=g=gn(gn({},g),{},{tickCoord:b>0?g.coordinate-b*e:g.coordinate})}else i[x]=g=gn(gn({},g),{},{tickCoord:g.coordinate});var E=bh(e,g.tickCoord,v,l,f);E&&(f=g.tickCoord-e*(v()/2+a),i[x]=gn(gn({},g),{},{isShow:!0}))},h=s-1;h>=0;h--)d(h);return i}function WV(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,{start:f,end:d}=t;if(i){var h=n[l-1],m=r(h,l-1),x=e*(h.coordinate+e*m/2-d);s[l-1]=h=gn(gn({},h),{},{tickCoord:x>0?h.coordinate-x*e:h.coordinate});var g=bh(e,h.tickCoord,()=>m,f,d);g&&(d=h.tickCoord-e*(m/2+a),s[l-1]=gn(gn({},h),{},{isShow:!0}))}for(var y=i?l-1:l,v=function(N){var S=s[N],j,T=()=>(j===void 0&&(j=r(S,N)),j);if(N===0){var C=e*(S.coordinate-e*T()/2-f);s[N]=S=gn(gn({},S),{},{tickCoord:C<0?S.coordinate-C*e:S.coordinate})}else s[N]=S=gn(gn({},S),{},{tickCoord:S.coordinate});var P=bh(e,S.tickCoord,T,f,d);P&&(f=S.tickCoord+e*(T()/2+a),s[N]=gn(gn({},S),{},{isShow:!0}))},b=0;b<y;b++)v(b);return s}function xb(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:l,interval:f,tickFormatter:d,unit:h,angle:m}=e;if(!a||!a.length||!n)return[];if(et(f)||ll.isSsr){var x;return(x=RV(a,et(f)?f:0))!==null&&x!==void 0?x:[]}var g=[],y=l==="top"||l==="bottom"?"width":"height",v=h&&y==="width"?zu(h,{fontSize:t,letterSpacing:r}):{width:0,height:0},b=(S,j)=>{var T=typeof d=="function"?d(S.value,j):S.value;return y==="width"?IV(zu(T,{fontSize:t,letterSpacing:r}),v,m):zu(T,{fontSize:t,letterSpacing:r})[y]},E=a.length>=2?qr(a[1].coordinate-a[0].coordinate):1,N=MV(i,E,y);return f==="equidistantPreserveStart"?LV(E,N,b,a,s):(f==="preserveStart"||f==="preserveStartEnd"?g=WV(E,N,b,a,s,f==="preserveStartEnd"):g=zV(E,N,b,a,s),g.filter(S=>S.isShow))}var HV=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){t.forEach(h=>{if(h){var m=h.getBoundingClientRect();m.width>s&&(s=m.width)}});var l=r?r.getBoundingClientRect().width:0,f=a+i,d=s+f+l+(r?n:0);return Math.round(d)}return 0},VV=["axisLine","width","height","className","hide","ticks"],GV=["viewBox"],KV=["viewBox"];function t1(e,t){if(e==null)return{};var r,n,a=qV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Qo(){return Qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qo.apply(null,arguments)}function Fk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fk(Object(r),!0).forEach(function(n){XV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XV(e,t,r){return(t=YV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YV(e){var t=JV(e,"string");return typeof t=="symbol"?t:t+""}function JV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gb={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function QV(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:l,otherSvgProps:f}=e;if(!l)return null;var d=Or(Or(Or({},f),Dr(l,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var h=+(i==="top"&&!s||i==="bottom"&&s);d=Or(Or({},d),{},{x1:t,y1:r+h*a,x2:t+n,y2:r+h*a})}else{var m=+(i==="left"&&!s||i==="right"&&s);d=Or(Or({},d),{},{x1:t+m*n,y1:r,x2:t+m*n,y2:r+a})}return k.createElement("line",Qo({},d,{className:bt("recharts-cartesian-axis-line",Ko(l,"className"))}))}function ZV(e,t,r,n,a,i,s,l,f){var d,h,m,x,g,y,v=l?-1:1,b=e.tickSize||s,E=et(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":d=h=e.coordinate,x=r+ +!l*a,m=x-v*b,y=m-v*f,g=E;break;case"left":m=x=e.coordinate,h=t+ +!l*n,d=h-v*b,g=d-v*f,y=E;break;case"right":m=x=e.coordinate,h=t+ +l*n,d=h+v*b,g=d+v*f,y=E;break;default:d=h=e.coordinate,x=r+ +l*a,m=x+v*b,y=m+v*f,g=E;break}return{line:{x1:d,y1:m,x2:h,y2:x},tick:{x:g,y}}}function eG(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function tG(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function rG(e){var{option:t,tickProps:r,value:n}=e,a,i=bt(r.className,"recharts-cartesian-axis-tick-value");if(k.isValidElement(t))a=k.cloneElement(t,Or(Or({},r),{},{className:i}));else if(typeof t=="function")a=t(Or(Or({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=bt(s,t?.className)),a=k.createElement(wm,Qo({},r,{className:s}),n)}return a}function nG(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:s,padding:l,tickTextProps:f,orientation:d,mirror:h,x:m,y:x,width:g,height:y,tickSize:v,tickMargin:b,fontSize:E,letterSpacing:N,getTicksConfig:S,events:j}=e,T=xb(Or(Or({},S),{},{ticks:t}),E,N),C=eG(d,h),P=tG(d,h),M=to(S),D=Dr(r,!1),W=Or(Or({},M),{},{fill:"none"},Dr(n,!1)),F=T.map((L,J)=>{var{line:se,tick:Z}=ZV(L,m,x,g,y,d,v,h,b),he=Or(Or(Or(Or({textAnchor:C,verticalAnchor:P},M),{},{stroke:"none",fill:a},D),Z),{},{index:J,payload:L,visibleTicksCount:T.length,tickFormatter:i,padding:l},f);return k.createElement(Qn,Qo({className:"recharts-cartesian-axis-tick",key:"tick-".concat(L.value,"-").concat(L.coordinate,"-").concat(L.tickCoord)},Cf(j,L,J)),n&&k.createElement("line",Qo({},W,se,{className:bt("recharts-cartesian-axis-tick-line",Ko(n,"className"))})),r&&k.createElement(rG,{option:r,tickProps:he,value:"".concat(typeof i=="function"?i(L.value,J):L.value).concat(s||"")}))});return F.length>0?k.createElement("g",{className:"recharts-cartesian-axis-ticks"},F):null}var aG=k.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:l}=e,f=t1(e,VV),[d,h]=k.useState(""),[m,x]=k.useState(""),g=k.useRef([]);k.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return HV({ticks:g.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var y=k.useCallback(v=>{if(v){var b=v.getElementsByClassName("recharts-cartesian-axis-tick-value");g.current=Array.from(b);var E=b[0];if(E){var N=window.getComputedStyle(E),S=N.fontSize,j=N.letterSpacing;(S!==d||j!==m)&&(h(S),x(j))}}},[d,m]);return s||n!=null&&n<=0||a!=null&&a<=0?null:k.createElement(Qn,{className:bt("recharts-cartesian-axis",i),ref:y},k.createElement(QV,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:to(e)}),k.createElement(nG,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:d,letterSpacing:m,getTicksConfig:e,events:f}),k.createElement(uz,{x:e.x,y:e.y,width:e.width,height:e.height},k.createElement(bz,{label:e.label}),e.children))}),iG=k.memo(aG,(e,t)=>{var{viewBox:r}=e,n=t1(e,GV),{viewBox:a}=t,i=t1(t,KV);return Sc(r,a)&&Sc(n,i)}),vb=k.forwardRef((e,t)=>{var r=Rn(e,gb);return k.createElement(iG,Qo({},r,{ref:t}))});vb.displayName="CartesianAxis";var sG=["x1","y1","x2","y2","key"],oG=["offset"],lG=["xAxisId","yAxisId"],cG=["xAxisId","yAxisId"];function Dk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dk(Object(r),!0).forEach(function(n){uG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uG(e,t,r){return(t=fG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fG(e){var t=dG(e,"string");return typeof t=="symbol"?t:t+""}function dG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Do(){return Do=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Do.apply(null,arguments)}function wh(e,t){if(e==null)return{};var r,n,a=hG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mG=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:l}=e;return k.createElement("rect",{x:n,y:a,ry:l,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function U3(e,t){var r;if(k.isValidElement(e))r=k.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:s,key:l}=t,f=wh(t,sG),d=to(f),{offset:h}=d,m=wh(d,oG);r=k.createElement("line",Do({},m,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:l}))}return r}function pG(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=wh(e,lG),f=a.map((d,h)=>{var m=wn(wn({},l),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(h),index:h});return U3(n,m)});return k.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function xG(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=wh(e,cG),f=a.map((d,h)=>{var m=wn(wn({},l),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(h),index:h});return U3(n,m)});return k.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function gG(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:l,horizontal:f=!0}=e;if(!f||!t||!t.length)return null;var d=l.map(m=>Math.round(m+a-a)).sort((m,x)=>m-x);a!==d[0]&&d.unshift(0);var h=d.map((m,x)=>{var g=!d[x+1],y=g?a+s-m:d[x+1]-m;if(y<=0)return null;var v=x%t.length;return k.createElement("rect",{key:"react-".concat(x),y:m,x:n,height:y,width:i,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return k.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function vG(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:l,verticalPoints:f}=e;if(!t||!r||!r.length)return null;var d=f.map(m=>Math.round(m+a-a)).sort((m,x)=>m-x);a!==d[0]&&d.unshift(0);var h=d.map((m,x)=>{var g=!d[x+1],y=g?a+s-m:d[x+1]-m;if(y<=0)return null;var v=x%r.length;return k.createElement("rect",{key:"react-".concat(x),x:m,y:i,width:y,height:l,stroke:"none",fill:r[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return k.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var yG=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return RC(xb(wn(wn(wn({},gb),r),{},{ticks:LC(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},bG=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return RC(xb(wn(wn(wn({},gb),r),{},{ticks:LC(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},wG={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function z3(e){var t=q1(),r=X1(),n=zC(),a=wn(wn({},Rn(e,wG)),{},{x:et(e.x)?e.x:n.left,y:et(e.y)?e.y:n.top,width:et(e.width)?e.width:n.width,height:et(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:l,y:f,width:d,height:h,syncWithTicks:m,horizontalValues:x,verticalValues:g}=a,y=$a(),v=Ze(D=>F_(D,"xAxis",i,y)),b=Ze(D=>F_(D,"yAxis",s,y));if(!et(d)||d<=0||!et(h)||h<=0||!et(l)||l!==+l||!et(f)||f!==+f)return null;var E=a.verticalCoordinatesGenerator||yG,N=a.horizontalCoordinatesGenerator||bG,{horizontalPoints:S,verticalPoints:j}=a;if((!S||!S.length)&&typeof N=="function"){var T=x&&x.length,C=N({yAxis:b?wn(wn({},b),{},{ticks:T?x:b.ticks}):void 0,width:t,height:r,offset:n},T?!0:m);$u(Array.isArray(C),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof C,"]")),Array.isArray(C)&&(S=C)}if((!j||!j.length)&&typeof E=="function"){var P=g&&g.length,M=E({xAxis:v?wn(wn({},v),{},{ticks:P?g:v.ticks}):void 0,width:t,height:r,offset:n},P?!0:m);$u(Array.isArray(M),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof M,"]")),Array.isArray(M)&&(j=M)}return k.createElement("g",{className:"recharts-cartesian-grid"},k.createElement(mG,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),k.createElement(gG,Do({},a,{horizontalPoints:S})),k.createElement(vG,Do({},a,{verticalPoints:j})),k.createElement(pG,Do({},a,{offset:n,horizontalPoints:S,xAxis:v,yAxis:b})),k.createElement(xG,Do({},a,{offset:n,verticalPoints:j,xAxis:v,yAxis:b})))}z3.displayName="CartesianGrid";var SG=["dangerouslySetInnerHTML","ticks"],NG=["id"],EG=["domain"],_G=["domain"];function r1(){return r1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r1.apply(null,arguments)}function Sh(e,t){if(e==null)return{};var r,n,a=kG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function kG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function jG(e){var t=lr();return k.useEffect(()=>(t(nH(e)),()=>{t(aH(e))}),[e,t]),null}var CG=e=>{var{xAxisId:t,className:r}=e,n=Ze(G1),a=$a(),i="xAxis",s=Ze(b=>Fc(b,i,t,a)),l=Ze(b=>DT(b,i,t,a)),f=Ze(b=>TT(b,t)),d=Ze(b=>MB(b,t)),h=Ze(b=>oT(b,t));if(f==null||d==null||h==null)return null;var{dangerouslySetInnerHTML:m,ticks:x}=e,g=Sh(e,SG),{id:y}=h,v=Sh(h,NG);return k.createElement(vb,r1({},g,v,{scale:s,x:d.x,y:d.y,width:f.width,height:f.height,className:bt("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:l}))},AG={allowDataOverflow:aa.allowDataOverflow,allowDecimals:aa.allowDecimals,allowDuplicatedCategory:aa.allowDuplicatedCategory,height:aa.height,hide:!1,mirror:aa.mirror,orientation:aa.orientation,padding:aa.padding,reversed:aa.reversed,scale:aa.scale,tickCount:aa.tickCount,type:aa.type,xAxisId:0},TG=e=>{var t,r,n,a,i,s=Rn(e,AG);return k.createElement(k.Fragment,null,k.createElement(jG,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),k.createElement(CG,s))},PG=(e,t)=>{var{domain:r}=e,n=Sh(e,EG),{domain:a}=t,i=Sh(t,_G);return Sc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:Sc({domain:r},{domain:a}):!1},W3=k.memo(TG,PG);W3.displayName="XAxis";var OG=["dangerouslySetInnerHTML","ticks"],FG=["id"],DG=["domain"],IG=["domain"];function n1(){return n1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n1.apply(null,arguments)}function Nh(e,t){if(e==null)return{};var r,n,a=MG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function MG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function RG(e){var t=lr();return k.useEffect(()=>(t(iH(e)),()=>{t(sH(e))}),[e,t]),null}var LG=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=k.useRef(null),s=k.useRef(null),l=Ze(G1),f=$a(),d=lr(),h="yAxis",m=Ze(T=>Fc(T,h,t,f)),x=Ze(T=>PT(T,t)),g=Ze(T=>LB(T,t)),y=Ze(T=>DT(T,h,t,f)),v=Ze(T=>lT(T,t));if(k.useLayoutEffect(()=>{if(!(n!=="auto"||!x||ib(a)||k.isValidElement(a)||v==null)){var T=i.current;if(T){var C=T.getCalculatedWidth();Math.round(x.width)!==Math.round(C)&&d(oH({id:t,width:C}))}}},[y,x,d,a,t,n,v]),x==null||g==null||v==null)return null;var{dangerouslySetInnerHTML:b,ticks:E}=e,N=Nh(e,OG),{id:S}=v,j=Nh(v,FG);return k.createElement(vb,n1({},N,j,{ref:i,labelRef:s,scale:m,x:g.x,y:g.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:x.width,height:x.height,className:bt("recharts-".concat(h," ").concat(h),r),viewBox:l,ticks:y}))},BG={allowDataOverflow:ia.allowDataOverflow,allowDecimals:ia.allowDecimals,allowDuplicatedCategory:ia.allowDuplicatedCategory,hide:!1,mirror:ia.mirror,orientation:ia.orientation,padding:ia.padding,reversed:ia.reversed,scale:ia.scale,tickCount:ia.tickCount,type:ia.type,width:ia.width,yAxisId:0},$G=e=>{var t,r,n,a,i,s=Rn(e,BG);return k.createElement(k.Fragment,null,k.createElement(RG,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),k.createElement(LG,s))},UG=(e,t)=>{var{domain:r}=e,n=Nh(e,DG),{domain:a}=t,i=Nh(t,IG);return Sc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:Sc({domain:r},{domain:a}):!1},H3=k.memo($G,UG);H3.displayName="YAxis";var Xg={exports:{}},Yg={};var Ik;function zG(){if(Ik)return Yg;Ik=1;var e=kc();function t(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,l=e.useDebugValue;return Yg.useSyncExternalStoreWithSelector=function(f,d,h,m,x){var g=a(null);if(g.current===null){var y={hasValue:!1,value:null};g.current=y}else y=g.current;g=s(function(){function b(T){if(!E){if(E=!0,N=T,T=m(T),x!==void 0&&y.hasValue){var C=y.value;if(x(C,T))return S=C}return S=T}if(C=S,r(N,T))return C;var P=m(T);return x!==void 0&&x(C,P)?(N=T,C):(N=T,S=P)}var E=!1,N,S,j=h===void 0?null:h;return[function(){return b(d())},j===null?void 0:function(){return b(j())}]},[d,h,m,x]);var v=n(f,g[0],g[1]);return i(function(){y.hasValue=!0,y.value=v},[v]),l(v),v},Yg}var Mk;function WG(){return Mk||(Mk=1,Xg.exports=zG()),Xg.exports}WG();function HG(e){e()}function VG(){let e=null,t=null;return{clear(){e=null,t=null},notify(){HG(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var Rk={notify(){},get:()=>[]};function GG(e,t){let r,n=Rk,a=0,i=!1;function s(v){h();const b=n.subscribe(v);let E=!1;return()=>{E||(E=!0,b(),m())}}function l(){n.notify()}function f(){y.onStateChange&&y.onStateChange()}function d(){return i}function h(){a++,r||(r=e.subscribe(f),n=VG())}function m(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Rk)}function x(){i||(i=!0,h())}function g(){i&&(i=!1,m())}const y={addNestedSub:s,notifyNestedSubs:l,handleChangeWrapper:f,isSubscribed:d,trySubscribe:x,tryUnsubscribe:g,getListeners:()=>n};return y}var KG=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qG=KG(),XG=()=>typeof navigator<"u"&&navigator.product==="ReactNative",YG=XG(),JG=()=>qG||YG?k.useLayoutEffect:k.useEffect,QG=JG(),ZG=Symbol.for("react-redux-context"),eK=typeof globalThis<"u"?globalThis:{};function tK(){if(!k.createContext)return{};const e=eK[ZG]??=new Map;let t=e.get(k.createContext);return t||(t=k.createContext(null),e.set(k.createContext,t)),t}var rK=tK();function nK(e){const{children:t,context:r,serverState:n,store:a}=e,i=k.useMemo(()=>{const f=GG(a);return{store:a,subscription:f,getServerState:n?()=>n:void 0}},[a,n]),s=k.useMemo(()=>a.getState(),[a]);QG(()=>{const{subscription:f}=i;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),s!==a.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[i,s]);const l=r||rK;return k.createElement(l.Provider,{value:i},t)}var aK=nK,iK=(e,t)=>t,yb=Se([iK,_t,aT,Lr,XT,cs,z$,Mr],K$),bb=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},V3=Ra("mouseClick"),G3=Tf();G3.startListening({actionCreator:V3,effect:(e,t)=>{var r=e.payload,n=yb(t.getState(),bb(r));n?.activeIndex!=null&&t.dispatch(JB({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var a1=Ra("mouseMove"),K3=Tf();K3.startListening({actionCreator:a1,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Yy(n,n.tooltip.settings.shared),i=yb(n,bb(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(zT({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(UT()))}});var Lk={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},q3=ga({name:"rootProps",initialState:Lk,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:Lk.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),sK=q3.reducer,{updateOptions:oK}=q3.actions,X3=ga({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:lK}=X3.actions,cK=X3.reducer,Y3=Ra("keyDown"),J3=Ra("focus"),wb=Tf();wb.startListening({actionCreator:Y3,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(Jy(a,Ic(r))),l=cs(r);if(i==="Enter"){var f=ph(r,"axis","hover",String(a.index));t.dispatch(Yv({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:f}));return}var d=zB(r),h=d==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,x=s+m*h;if(!(l==null||x>=l.length||x<0)){var g=ph(r,"axis","hover",String(x));t.dispatch(Yv({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:g}))}}}}});wb.startListening({actionCreator:J3,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=ph(r,"axis","hover",String(i));t.dispatch(Yv({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var Ca=Ra("externalEvent"),Q3=Tf();Q3.startListening({actionCreator:Ca,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:F$(r),activeDataKey:ZT(r),activeIndex:Jo(r),activeLabel:QT(r),activeTooltipIndex:Jo(r),isTooltipActive:D$(r)};e.payload.handler(n,e.payload.reactEvent)}}});var uK=Se([Dc],e=>e.tooltipItemPayloads),fK=Se([uK,Uf,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(l=>l.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),Z3=Ra("touchMove"),eP=Tf();eP.startListening({actionCreator:Z3,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Yy(n,n.tooltip.settings.shared);if(a==="axis"){var i=yb(n,bb({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(zT({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,l=r.touches[0],f=document.elementFromPoint(l.clientX,l.clientY);if(!f||!f.getAttribute)return;var d=f.getAttribute($C),h=(s=f.getAttribute(UC))!==null&&s!==void 0?s:void 0,m=fK(t.getState(),d,h);t.dispatch($T({activeDataKey:h,activeIndex:d,activeCoordinate:m}))}}});var dK=dC({brush:_V,cartesianAxis:lH,chartData:cU,errorBars:SH,graphicalItems:kW,layout:WM,legend:F8,options:aU,polarAxis:zz,polarOptions:cK,referenceElements:OV,rootProps:sK,tooltip:QB}),hK=function(t){return mM({reducer:dK,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([G3.middleware,K3.middleware,wb.middleware,Q3.middleware,eP.middleware]),devTools:ll.devToolsEnabled})};function tP(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=$a(),i=k.useRef(null);if(a)return r;i.current==null&&(i.current=hK(t));var s=B1;return k.createElement(aK,{context:s,store:i.current},r)}function rP(e){var{layout:t,width:r,height:n,margin:a}=e,i=lr(),s=$a();return k.useEffect(()=>{s||(i($M(t)),i(UM({width:r,height:n})),i(BM(a)))},[i,s,t,r,n,a]),null}function nP(e){var t=lr();return k.useEffect(()=>{t(oK(e))},[t,e]),null}var mK=["children"];function pK(e,t){if(e==null)return{};var r,n,a=xK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function xK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Eh(){return Eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Eh.apply(null,arguments)}var gK={width:"100%",height:"100%"},vK=k.forwardRef((e,t)=>{var r=q1(),n=X1(),a=GC();if(!pc(r)||!pc(n))return null;var{children:i,otherAttributes:s,title:l,desc:f}=e,d,h;return typeof s.tabIndex=="number"?d=s.tabIndex:d=a?0:void 0,typeof s.role=="string"?h=s.role:h=a?"application":void 0,k.createElement(T1,Eh({},s,{title:l,desc:f,role:h,tabIndex:d,width:r,height:n,style:gK,ref:t}),i)}),yK=e=>{var{children:t}=e,r=Ze(rm);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return k.createElement(T1,{width:n,height:a,x:s,y:i},t)},Bk=k.forwardRef((e,t)=>{var{children:r}=e,n=pK(e,mK),a=$a();return a?k.createElement(yK,null,r):k.createElement(vK,Eh({ref:t},n),r)});function bK(){var e=lr(),[t,r]=k.useState(null),n=Ze(v8);return k.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;pa(i)&&i!==n&&e(zM(i))}},[t,e,n]),r}function $k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$k(Object(r),!0).forEach(function(n){SK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$k(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SK(e,t,r){return(t=NK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NK(e){var t=EK(e,"string");return typeof t=="symbol"?t:t+""}function EK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _K=k.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:l,onMouseDown:f,onMouseEnter:d,onMouseLeave:h,onMouseMove:m,onMouseUp:x,onTouchEnd:g,onTouchMove:y,onTouchStart:v,style:b,width:E}=e,N=lr(),[S,j]=k.useState(null),[T,C]=k.useState(null);vU();var P=bK(),M=k.useCallback(O=>{P(O),typeof t=="function"&&t(O),j(O),C(O)},[P,t,j,C]),D=k.useCallback(O=>{N(V3(O)),N(Ca({handler:i,reactEvent:O}))},[N,i]),W=k.useCallback(O=>{N(a1(O)),N(Ca({handler:d,reactEvent:O}))},[N,d]),F=k.useCallback(O=>{N(UT()),N(Ca({handler:h,reactEvent:O}))},[N,h]),L=k.useCallback(O=>{N(a1(O)),N(Ca({handler:m,reactEvent:O}))},[N,m]),J=k.useCallback(()=>{N(J3())},[N]),se=k.useCallback(O=>{N(Y3(O.key))},[N]),Z=k.useCallback(O=>{N(Ca({handler:s,reactEvent:O}))},[N,s]),he=k.useCallback(O=>{N(Ca({handler:l,reactEvent:O}))},[N,l]),le=k.useCallback(O=>{N(Ca({handler:f,reactEvent:O}))},[N,f]),de=k.useCallback(O=>{N(Ca({handler:x,reactEvent:O}))},[N,x]),Q=k.useCallback(O=>{N(Ca({handler:v,reactEvent:O}))},[N,v]),pe=k.useCallback(O=>{N(Z3(O)),N(Ca({handler:y,reactEvent:O}))},[N,y]),re=k.useCallback(O=>{N(Ca({handler:g,reactEvent:O}))},[N,g]);return k.createElement(i3.Provider,{value:S},k.createElement(F4.Provider,{value:T},k.createElement("div",{className:bt("recharts-wrapper",n),style:wK({position:"relative",cursor:"default",width:E,height:a},b),onClick:D,onContextMenu:Z,onDoubleClick:he,onFocus:J,onKeyDown:se,onMouseDown:le,onMouseEnter:W,onMouseLeave:F,onMouseMove:L,onMouseUp:de,onTouchEnd:re,onTouchMove:pe,onTouchStart:Q,ref:M},r)))}),kK=["children","className","width","height","style","compact","title","desc"];function jK(e,t){if(e==null)return{};var r,n,a=CK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var aP=k.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:i,style:s,compact:l,title:f,desc:d}=e,h=jK(e,kK),m=to(h);return l?k.createElement(Bk,{otherAttributes:m,title:f,desc:d},r):k.createElement(_K,{className:n,style:s,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},k.createElement(Bk,{otherAttributes:m,title:f,desc:d,ref:t},k.createElement(DV,null,r)))}),AK=["width","height"];function i1(){return i1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i1.apply(null,arguments)}function TK(e,t){if(e==null)return{};var r,n,a=PK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var OK={top:5,right:5,bottom:5,left:5},FK={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:OK,reverseStackOrder:!1,syncMethod:"index"},DK=k.forwardRef(function(t,r){var n,a=Rn(t.categoricalChartProps,FK),{width:i,height:s}=a,l=TK(a,AK);if(!pc(i)||!pc(s))return null;var{chartName:f,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:m,categoricalChartProps:x}=t,g={chartName:f,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:m,eventEmitter:void 0};return k.createElement(tP,{preloadedState:{options:g},reduxStoreName:(n=x.id)!==null&&n!==void 0?n:f},k.createElement(R3,{chartData:x.data}),k.createElement(rP,{width:i,height:s,layout:a.layout,margin:a.margin}),k.createElement(nP,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),k.createElement(aP,i1({},l,{width:i,height:s,ref:r})))}),IK=["axis","item"],MK=k.forwardRef((e,t)=>k.createElement(DK,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:IK,tooltipPayloadSearcher:s3,categoricalChartProps:e,ref:t}));function RK(e){var t=lr();return k.useEffect(()=>{t(lK(e))},[t,e]),null}var LK=["width","height","layout"];function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s1.apply(null,arguments)}function BK(e,t){if(e==null)return{};var r,n,a=$K(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $K(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UK={top:5,right:5,bottom:5,left:5},zK={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:UK,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},WK=k.forwardRef(function(t,r){var n,a=Rn(t.categoricalChartProps,zK),{width:i,height:s,layout:l}=a,f=BK(a,LK);if(!pc(i)||!pc(s))return null;var{chartName:d,defaultTooltipEventType:h,validateTooltipEventTypes:m,tooltipPayloadSearcher:x}=t,g={chartName:d,defaultTooltipEventType:h,validateTooltipEventTypes:m,tooltipPayloadSearcher:x,eventEmitter:void 0};return k.createElement(tP,{preloadedState:{options:g},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:d},k.createElement(R3,{chartData:a.data}),k.createElement(rP,{width:i,height:s,layout:l,margin:a.margin}),k.createElement(nP,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),k.createElement(RK,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),k.createElement(aP,s1({width:i,height:s},f,{ref:r})))}),HK=["item"],VK={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},I0=k.forwardRef((e,t)=>{var r=Rn(e,VK);return k.createElement(WK,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:HK,tooltipPayloadSearcher:s3,categoricalChartProps:r,ref:t})});const iP=6048e5,GK=864e5,Uk=Symbol.for("constructDateFrom");function qs(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Uk in e?e[Uk](t):e instanceof Date?new e.constructor(t):new Date(t)}function ii(e,t){return qs(t||e,e)}let KK={};function Sm(){return KK}function uf(e,t){const r=Sm(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=ii(e,t?.in),i=a.getDay(),s=(i<n?7:0)+i-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function _h(e,t){return uf(e,{...t,weekStartsOn:1})}function sP(e,t){const r=ii(e,t?.in),n=r.getFullYear(),a=qs(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=_h(a),s=qs(r,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const l=_h(s);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function zk(e){const t=ii(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function qK(e,...t){const r=qs.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function Wk(e,t){const r=ii(e,t?.in);return r.setHours(0,0,0,0),r}function XK(e,t,r){const[n,a]=qK(r?.in,e,t),i=Wk(n),s=Wk(a),l=+i-zk(i),f=+s-zk(s);return Math.round((l-f)/GK)}function YK(e,t){const r=sP(e,t),n=qs(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),_h(n)}function JK(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function QK(e){return!(!JK(e)&&typeof e!="number"||isNaN(+ii(e)))}function ZK(e,t){const r=ii(e,t?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const eq={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},tq=(e,t,r)=>{let n;const a=eq[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function ac(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const rq={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},nq={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},aq={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},iq={date:ac({formats:rq,defaultWidth:"full"}),time:ac({formats:nq,defaultWidth:"full"}),dateTime:ac({formats:aq,defaultWidth:"full"})},sq={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},oq=(e,t,r,n)=>sq[e];function pi(e){return(t,r)=>{const n=r?.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,l=r?.width?String(r.width):s;a=e.formattingValues[l]||e.formattingValues[s]}else{const s=e.defaultWidth,l=r?.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const lq={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},cq={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},uq={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},fq={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dq={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},hq={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},mq=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},pq={ordinalNumber:mq,era:pi({values:lq,defaultWidth:"wide"}),quarter:pi({values:cq,defaultWidth:"wide",argumentCallback:e=>e-1}),month:pi({values:uq,defaultWidth:"wide"}),day:pi({values:fq,defaultWidth:"wide"}),dayPeriod:pi({values:dq,defaultWidth:"wide",formattingValues:hq,defaultFormattingWidth:"wide"})};function xi(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(l)?gq(l,m=>m.test(s)):xq(l,m=>m.test(s));let d;d=e.valueCallback?e.valueCallback(f):f,d=r.valueCallback?r.valueCallback(d):d;const h=t.slice(s.length);return{value:d,rest:h}}}function xq(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function gq(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function oP(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;const l=t.slice(a.length);return{value:s,rest:l}}}const vq=/^(\d+)(th|st|nd|rd)?/i,yq=/\d+/i,bq={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},wq={any:[/^b/i,/^(a|c)/i]},Sq={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Nq={any:[/1/i,/2/i,/3/i,/4/i]},Eq={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},_q={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},kq={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},jq={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Cq={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Aq={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Tq={ordinalNumber:oP({matchPattern:vq,parsePattern:yq,valueCallback:e=>parseInt(e,10)}),era:xi({matchPatterns:bq,defaultMatchWidth:"wide",parsePatterns:wq,defaultParseWidth:"any"}),quarter:xi({matchPatterns:Sq,defaultMatchWidth:"wide",parsePatterns:Nq,defaultParseWidth:"any",valueCallback:e=>e+1}),month:xi({matchPatterns:Eq,defaultMatchWidth:"wide",parsePatterns:_q,defaultParseWidth:"any"}),day:xi({matchPatterns:kq,defaultMatchWidth:"wide",parsePatterns:jq,defaultParseWidth:"any"}),dayPeriod:xi({matchPatterns:Cq,defaultMatchWidth:"any",parsePatterns:Aq,defaultParseWidth:"any"})},Pq={code:"en-US",formatDistance:tq,formatLong:iq,formatRelative:oq,localize:pq,match:Tq,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Oq(e,t){const r=ii(e,t?.in);return XK(r,ZK(r))+1}function Fq(e,t){const r=ii(e,t?.in),n=+_h(r)-+YK(r);return Math.round(n/iP)+1}function lP(e,t){const r=ii(e,t?.in),n=r.getFullYear(),a=Sm(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=qs(t?.in||e,0);s.setFullYear(n+1,0,i),s.setHours(0,0,0,0);const l=uf(s,t),f=qs(t?.in||e,0);f.setFullYear(n,0,i),f.setHours(0,0,0,0);const d=uf(f,t);return+r>=+l?n+1:+r>=+d?n:n-1}function Dq(e,t){const r=Sm(),n=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,a=lP(e,t),i=qs(t?.in||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),uf(i,t)}function Iq(e,t){const r=ii(e,t?.in),n=+uf(r,t)-+Dq(r,t);return Math.round(n/iP)+1}function Pt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Fs={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Pt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Pt(r+1,2)},d(e,t){return Pt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Pt(e.getHours()%12||12,t.length)},H(e,t){return Pt(e.getHours(),t.length)},m(e,t){return Pt(e.getMinutes(),t.length)},s(e,t){return Pt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Pt(a,t.length)}},Hl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Hk={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Fs.y(e,t)},Y:function(e,t,r,n){const a=lP(e,n),i=a>0?a:1-a;if(t==="YY"){const s=i%100;return Pt(s,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Pt(i,t.length)},R:function(e,t){const r=sP(e);return Pt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Pt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Pt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Pt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Fs.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Pt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=Iq(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Pt(a,t.length)},I:function(e,t,r){const n=Fq(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Pt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Fs.d(e,t)},D:function(e,t,r){const n=Oq(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Pt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Pt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Pt(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Pt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Hl.noon:n===0?a=Hl.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Hl.evening:n>=12?a=Hl.afternoon:n>=4?a=Hl.morning:a=Hl.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Fs.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Fs.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Pt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Pt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Fs.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Fs.s(e,t)},S:function(e,t){return Fs.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Gk(n);case"XXXX":case"XX":return Ao(n);default:return Ao(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Gk(n);case"xxxx":case"xx":return Ao(n);default:return Ao(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Vk(n,":");default:return"GMT"+Ao(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Vk(n,":");default:return"GMT"+Ao(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Pt(n,t.length)},T:function(e,t,r){return Pt(+e,t.length)}};function Vk(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+Pt(i,2)}function Gk(e,t){return e%60===0?(e>0?"-":"+")+Pt(Math.abs(e)/60,2):Ao(e,t)}function Ao(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Pt(Math.trunc(n/60),2),i=Pt(n%60,2);return r+a+t+i}const Kk=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},cP=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Mq=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return Kk(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Kk(n,t)).replace("{{time}}",cP(a,t))},Rq={p:cP,P:Mq},Lq=/^D+$/,Bq=/^Y+$/,$q=["D","DD","YY","YYYY"];function Uq(e){return Lq.test(e)}function zq(e){return Bq.test(e)}function Wq(e,t,r){const n=Hq(e,t,r);if(console.warn(n),$q.includes(e))throw new RangeError(n)}function Hq(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Vq=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Gq=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Kq=/^'([^]*?)'?$/,qq=/''/g,Xq=/[a-zA-Z]/;function Kn(e,t,r){const n=Sm(),a=r?.locale??n.locale??Pq,i=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,s=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,l=ii(e,r?.in);if(!QK(l))throw new RangeError("Invalid time value");let f=t.match(Gq).map(h=>{const m=h[0];if(m==="p"||m==="P"){const x=Rq[m];return x(h,a.formatLong)}return h}).join("").match(Vq).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const m=h[0];if(m==="'")return{isToken:!1,value:Yq(h)};if(Hk[m])return{isToken:!0,value:h};if(m.match(Xq))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:h}});a.localize.preprocessor&&(f=a.localize.preprocessor(l,f));const d={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return f.map(h=>{if(!h.isToken)return h.value;const m=h.value;(!r?.useAdditionalWeekYearTokens&&zq(m)||!r?.useAdditionalDayOfYearTokens&&Uq(m))&&Wq(m,t,String(e));const x=Hk[m[0]];return x(l,m,a.localize,d)}).join("")}function Yq(e){const t=e.match(Kq);return t?t[1].replace(qq,"'"):e}function Hf({type:e,libelle:t,classe:r,enseignant:n,hideFooter:a=!1,rightMeta:i}){const s=b4(e),l=fe.getAll("ecole")?.[0],f=l&&l.logo?l.logo:s.logo||"",d=s.logoMinistere||"",h=d&&d!==f,m=l&&l.nom?l.nom:s.etablissement||s.header,x=i?"grid grid-cols-[80px_1fr_80px] items-start gap-3 mb-1 print:mb-0":"grid grid-cols-[80px_1fr_80px] items-center gap-3 mb-1 print:mb-0";return o.jsxs("div",{className:"w-full mb-1",children:[o.jsxs("div",{className:x,children:[o.jsx("div",{className:"flex flex-col items-start",children:f?o.jsx("img",{src:f,alt:"logo",style:{maxHeight:64,width:"auto"},className:"logo-left object-contain"}):o.jsx("div",{className:"h-12 w-12 bg-gray-200 rounded flex items-center justify-center text-xs text-gray-600",children:"Logo"})}),o.jsxs("div",{className:"text-center px-1",children:[o.jsx("div",{className:"text-sm text-gray-700",children:s.pays}),o.jsx("div",{className:"font-bold text-base tracking-wider text-blue-800",children:s.ministere}),o.jsx("div",{className:"font-extrabold text-lg mt-0",children:m}),o.jsx("div",{className:"text-sm text-teal-700 mt-0 entete-libelle font-semibold",children:t||s.header}),(r||n)&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[r&&o.jsxs("span",{className:"mr-2",children:["Classe: ",r]}),n&&o.jsxs("span",{children:["Enseignant: ",n]})]}),(l||s)&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l?.adresse&&o.jsx("div",{children:l.adresse}),o.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[l?.telephone&&o.jsxs("div",{children:["Tel: ",l.telephone]}),l?.email&&o.jsxs("div",{children:["Email: ",l.email]})]})]})]}),o.jsxs("div",{className:"flex flex-col items-end",children:[i?o.jsx("div",{className:"text-right text-xs text-gray-600",children:i}):null,h?o.jsx("img",{src:d,alt:"logo-ministere",style:{maxHeight:56,width:"auto"},className:"logo-right object-contain"}):o.jsx("div",{style:{height:56,width:56}})]})]}),!a&&o.jsx("div",{className:"text-xs text-right text-gray-600 print:text-xs",children:s.footer})]})}const qk=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(String(n.result)),n.onerror=r,n.readAsDataURL(e)});function Jq({onClose:e}){const[t,r]=k.useState(()=>Vs()),[n,a]=k.useState("eleves");function i(l){r(l),Qu(l)}function s(l,f){const d={...t,[n]:{...t[n],[l]:f}};i(d)}return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-3xl w-full",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-bold",children:"Paramtrage des enttes"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{className:"px-3 py-1 border rounded",onClick:()=>{r(Vs())},children:"Restaurer"}),o.jsx("button",{className:"px-3 py-1",onClick:e,children:"Fermer"})]})]}),o.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[o.jsx("div",{className:"col-span-3",children:o.jsxs("nav",{className:"flex flex-col gap-2",children:[o.jsx("button",{className:`text-left px-3 py-2 rounded ${n==="eleves"?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,onClick:()=>a("eleves"),children:"lves"}),o.jsx("button",{className:`text-left px-3 py-2 rounded ${n==="recu"?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,onClick:()=>a("recu"),children:"Reu"}),o.jsx("button",{className:`text-left px-3 py-2 rounded ${n==="transport"?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,onClick:()=>a("transport"),children:"Transport"})]})}),o.jsxs("div",{className:"col-span-6 bg-gray-50 p-3 rounded",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Entte"}),o.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:t[n].header,onChange:l=>s("header",l.target.value)}),o.jsx("label",{className:"block text-sm text-gray-700 mt-3",children:"Pied de page"}),o.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:t[n].footer||"",onChange:l=>s("footer",l.target.value)}),o.jsx("label",{className:"block text-sm text-gray-700 mt-3",children:"Colonnes (spares par une virgule)"}),o.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:t[n].columns.join(", "),onChange:l=>s("columns",l.target.value.split(",").map(f=>f.trim()))}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Logo principal"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async l=>{const f=l.target.files?.[0];if(f)try{const d=await qk(f);s("logo",d)}catch{}}}),t[n].logo?o.jsx("img",{src:t[n].logo,alt:"logo",className:"h-12 mt-2"}):null]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Logo Ministre"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async l=>{const f=l.target.files?.[0];if(f)try{const d=await qk(f);s("logoMinistere",d)}catch{}}}),t[n].logoMinistere?o.jsx("img",{src:t[n].logoMinistere,alt:"logo-min",className:"h-12 mt-2"}):null]})]}),o.jsxs("div",{className:"col-span-3",children:[o.jsx("h4",{className:"font-semibold mb-2",children:"Aperu"}),o.jsx("div",{className:"border p-3 bg-white rounded",children:o.jsx(Hf,{type:n,libelle:t[n].header})}),o.jsx("div",{className:"mt-3 flex justify-end",children:o.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded",onClick:()=>{i(t),e()},children:"Enregistrer"})})]})]})]})})}function dl({title:e,subtitle:t,actions:r,children:n}){return o.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-extrabold text-gray-900",children:e}),t&&o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t})]}),r&&o.jsx("div",{className:"mt-4 sm:mt-0 flex items-center gap-3",children:r})]}),o.jsx("div",{className:"space-y-6",children:n})]})})}class Zl{static instance;static getInstance(){return Zl.instance||(Zl.instance=new Zl),Zl.instance}cancelPayment(t,r){const n=fe.getById("paiements",t);if(!n)throw new Error("Paiement introuvable");try{const i=Number(n.avance||0);i>0&&fe.getAll("credits").filter(l=>l.eleveId===n.eleveId&&Math.abs(Number(l.montant||0)-i)<1).forEach(l=>fe.delete("credits",l.id))}catch{}const a={canceled:!0,updatedAt:new Date().toISOString()};return r&&(a.cancelNote=r),fe.update("paiements",t,a),fe.addHistorique({type:"autre",cible:"Paiement",cibleId:t,description:`Annulation du paiement ${t} de ${n.montant} FCFA${r?`  Motif: ${r}`:""}`,utilisateur:n&&n.operateur||"SYSTEM"}),!0}getSituationEcheances(t){const r=fe.getById("eleves",t);if(!r)return null;const n=fe.getById("classes",r.classeId);if(!n)return null;const a=fe.getAll("fraisScolaires").find(y=>y.niveau===n.niveau&&y.anneeScolaire===n.anneeScolaire);if(!a||!a.echeances)return null;const i=fe.getAll("paiements").filter(y=>y.eleveId===t&&!y.canceled),s=new Date,l={};i.forEach(y=>{if(y.allocations&&y.allocations.length>0)y.allocations.forEach(v=>{const b=a.echeances.find(E=>!!(E.id&&E.id===v.echeanceId||`${n.niveau}-${E.modalite}`===v.echeanceId));b&&b.modalite!=null&&(l[b.modalite]=(l[b.modalite]||0)+v.montant)});else{const v=y;let b=null;v.modalite?b=Number(v.modalite):v.typeFrais==="inscription"?b=1:v.typeFrais==="scolarite"&&v.versementIndex&&(b=Number(v.versementIndex)+1),b&&(l[b]=(l[b]||0)+y.montant)}});const f=a.echeances.map(y=>{const v=l[y.modalite||0]||0,b=Math.max(0,y.montant-v),E=new Date(y.date),N=E<s&&b>0,S=N?Math.floor((s.getTime()-E.getTime())/(1e3*60*60*24)):0;let j=`Versement ${y.modalite}`;return y.modalite===1?j="Inscription":y.modalite&&y.modalite>1&&(j=`Versement ${y.modalite-1}`),{echeanceId:y.id||`${n.niveau}-${y.modalite}`,modalite:y.modalite||0,label:y.label||j,date:y.date,montant:y.montant,montantPaye:v,montantRestant:b,isEchue:N,joursRetard:S}}),d=f.reduce((y,v)=>y+v.montant,0),h=f.reduce((y,v)=>y+v.montantPaye,0),m=f.reduce((y,v)=>y+v.montantRestant,0),x=f.filter(y=>y.isEchue),g=f.filter(y=>y.montantRestant>0&&!y.isEchue).sort((y,v)=>new Date(y.date).getTime()-new Date(v.date).getTime())[0]||null;return{eleveId:t,eleve:r,classe:n,echeances:f,totalDu:d,totalPaye:h,totalRestant:m,echeancesEchues:x,prochainEcheance:g}}getAlertesEcheances(t=12){const r=fe.getAll("eleves").filter(i=>i.statut==="Actif"),n=new Date,a=[];return r.forEach(i=>{const s=this.getSituationEcheances(i.id);if(!s)return;const l=s.echeances.filter(d=>d.montantRestant>0);if(l.length===0)return;if(l.some(d=>{const h=new Date(d.date);return Math.ceil((h.getTime()-n.getTime())/(1e3*60*60*24))<=t})){const d=l.filter(m=>{const x=new Date(m.date);return Math.ceil((x.getTime()-n.getTime())/(1e3*60*60*24))<=t}),h=d.reduce((m,x)=>m+x.montantRestant,0);a.push({eleve:i,echeances:d,totalDu:h})}}),{echeancesImpayees:a}}processPaymentIntelligent(t,r,n,a={}){const i=this.getSituationEcheances(t);if(!i)throw new Error("Impossible de calculer la situation des chances");let s=r;const l=[],f=Array.isArray(a.selectedEcheances)?a.selectedEcheances:void 0,d=i.echeances.filter(v=>v.montantRestant>0),h=f&&f.length>0?d.filter(v=>f.includes(v.echeanceId)):d,m=[...h.filter(v=>v.isEchue).sort((v,b)=>new Date(v.date).getTime()-new Date(b.date).getTime()),...h.filter(v=>!v.isEchue).sort((v,b)=>new Date(v.date).getTime()-new Date(b.date).getTime())],x=!!i.eleve?.protege;if(x&&f&&f.length>0){if(h.find(E=>E.modalite!==1))throw new Error("lve protg : seules les chances d'inscription (modalit 1) peuvent tre rgles");const b=h.reduce((E,N)=>E+(N.modalite===1?N.montantRestant:0),0);if(r<b)throw new Error("lve protg : l'inscription doit tre rgle en totalit")}else if(x&&(!f||f.length===0)){const v=i.echeances.filter(b=>b.modalite===1).reduce((b,E)=>b+E.montantRestant,0);if(r<v)throw new Error("lve protg : l'inscription doit tre rgle en totalit")}for(const v of m){if(s<=0)break;if(v.montantRestant<=0)continue;if(v.modalite===1){if(s<v.montantRestant)throw new Error("L'inscription doit tre rgle en totalit");l.push({echeanceId:v.echeanceId,montant:v.montantRestant}),s-=v.montantRestant;continue}const b=Math.min(s,v.montantRestant);l.push({echeanceId:v.echeanceId,montant:b}),s-=b}const g={eleveId:t,montant:r,datePaiement:n,typeFrais:a&&a.typeFrais||"scolarite",versementIndex:a&&a.versementIndex||void 0,modePaiement:a&&a.modePaiement||"Espces",numeroRecu:a&&a.numeroRecu||`REC-${Date.now()}`,operateur:a&&a.operateur||"SYSTEM",notes:a&&a.notes||"",allocations:l,avance:s,updatedAt:new Date().toISOString()};return{paiement:fe.create("paiements",g),allocations:l,avance:s,situation:this.getSituationEcheances(t)}}generateConvocations(t=12){return this.getAlertesEcheances(t).echeancesImpayees.map(n=>({eleve:n.eleve,classe:fe.getById("classes",n.eleve.classeId),echeancesEchues:n.echeances,totalDu:n.totalDu,anneeScolaire:fe.getById("classes",n.eleve.classeId)?.anneeScolaire||""}))}}const ff=Zl.getInstance();function Jg(){const[e,t]=k.useState(!1),[r,n]=k.useState(0),a=()=>{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"eleves",action:"new"}}))},i=()=>{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"finances"}})),window.dispatchEvent(new CustomEvent("open-payment-form"))},s=()=>{window.dispatchEvent(new CustomEvent("navigate",{detail:{page:"notes"}})),window.dispatchEvent(new CustomEvent("open-notes-entry"))},l=fe.getAll("eleves"),f=fe.getAll("paiements").filter(j=>!j.canceled),d=fe.getAll("fraisScolaires"),h=fe.getAll("classes"),m=fe.getAll("notes"),x=k.useMemo(()=>ff.getAlertesEcheances(),[r]),g=k.useMemo(()=>l.filter(j=>!m.some(T=>T.eleveId===j.id)),[l,m,r]),y=k.useMemo(()=>{const j=l.length,T=l.filter(W=>W.statut==="Actif").length,C=f.reduce((W,F)=>W+F.montant,0),P=f.filter(W=>{const F=new Date(W.datePaiement),L=new Date;return F.getMonth()===L.getMonth()&&F.getFullYear()===L.getFullYear()}).reduce((W,F)=>W+F.montant,0),M=l.map(W=>{const F=ff.getSituationEcheances(W.id);if(!F)return{eleveId:W.id,statut:"Non Pay",solde:0};if(F.eleve&&F.eleve.protege){const Z=(F.echeances||[]).filter(Q=>Q.modalite===1),he=Z.reduce((Q,pe)=>Q+(pe.montant||0),0),le=Z.reduce((Q,pe)=>Q+(pe.montantPaye||0),0);let de="Non Pay";return he>0&&le>=he?de="Pay":le>0&&(de="Partiellement Pay"),{eleveId:W.id,statut:de,solde:he-le}}const L=F.totalDu||0,J=F.totalPaye||0;let se="Non Pay";return L>0&&J>=L?se="Pay":J>0&&(se="Partiellement Pay"),{eleveId:W.id,statut:se,solde:L-J}}),D={soldes:M.filter(W=>W.statut==="Pay").length,partiels:M.filter(W=>W.statut==="Partiellement Pay").length,impayes:M.filter(W=>W.statut==="Non Pay").length};return{totalEleves:j,elevesActifs:T,totalRecettes:C,recettesMoisCourant:P,elevesParStatut:D}},[l,f,d,h,r]),v=k.useMemo(()=>{const j=Array.from({length:12},(T,C)=>({mois:Kn(new Date(2024,C,1),"MMM"),recettes:0}));return f.forEach(T=>{const C=new Date(T.datePaiement);if(!isNaN(C.getTime())){const P=C.getMonth();P>=0&&P<12&&(j[P].recettes+=T.montant)}}),j},[f,r]),b=[{name:"Pay",value:y.elevesParStatut.soldes,color:"#10b981"},{name:"Partiel",value:y.elevesParStatut.partiels,color:"#f59e0b"},{name:"Non Pay",value:y.elevesParStatut.impayes,color:"#ef4444"}],E=j=>new Intl.NumberFormat("fr-FR").format(j)+" FCFA",[N,S]=k.useState(null);return k.useEffect(()=>S(fe.getAll("ecole")[0]||null),[r]),k.useEffect(()=>{const j=()=>n(T=>T+1);return window.addEventListener("dataChanged",j),()=>window.removeEventListener("dataChanged",j)},[]),o.jsxs(dl,{title:"Tableau de bord",subtitle:`Anne scolaire ${N?.anneeScolaireActive||"Non configure"}`,actions:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:a,className:"px-3 py-2 bg-teal-600 text-white rounded-md",children:"Nouvel lve"}),o.jsx("button",{onClick:i,className:"px-3 py-2 bg-gray-900 text-white rounded-md",children:"Paiement"})]}),children:[(g.length>0||(x?.echeancesEchues?.length||0)>0||(x?.echeancesProches?.length||0)>0)&&o.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(p4,{className:"h-5 w-5 text-gray-600 mt-0.5 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Alertes"}),o.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[g.length>0&&o.jsxs("p",{children:[g.length," lve(s) n'ont aucune note enregistre."]}),x?.echeancesEchues?.length>0&&o.jsxs("p",{children:[x.echeancesEchues.length," lve(s) ont des chances chues."]}),x?.echeancesProches?.length>0&&o.jsxs("p",{children:[x.echeancesProches.length," chance(s) dans les 7 prochains jours."]})]})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"lves Actifs"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:y.elevesActifs}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Total: ",y.totalEleves]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(Qi,{className:"h-6 w-6 text-gray-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Recettes Totales"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:E(y.totalRecettes)}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center",children:[o.jsx(fc,{className:"inline h-3 w-3 mr-1"}),"Ce mois: ",E(y.recettesMoisCourant)]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(Ji,{className:"h-6 w-6 text-gray-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Paiements Complts"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:y.elevesParStatut.soldes}),o.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[o.jsx(In,{className:"h-4 w-4 text-green-600"}),o.jsx("span",{className:"text-sm text-gray-500",children:"Frais pays"})]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(In,{className:"h-6 w-6 text-gray-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Non Pay"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:y.elevesParStatut.impayes}),o.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[o.jsx(wi,{className:"h-4 w-4 text-red-600"}),o.jsx("span",{className:"text-sm text-gray-500",children:"En attente"})]})]}),o.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:o.jsx(Uh,{className:"h-6 w-6 text-gray-600"})})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[o.jsx(fc,{className:"h-5 w-5 text-gray-600"})," volution des Recettes"]}),o.jsx(Uu,{width:"100%",height:260,children:o.jsxs(MK,{data:v,children:[o.jsx(z3,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),o.jsx(W3,{dataKey:"mois",tick:{fontSize:12}}),o.jsx(H3,{tickFormatter:j=>new Intl.NumberFormat("fr-FR",{notation:"compact"}).format(j),tick:{fontSize:12}}),o.jsx(Bu,{formatter:j=>E(Number(j))}),o.jsx(I3,{dataKey:"recettes",fill:"#374151",radius:[2,2,0,0]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[o.jsx(In,{className:"h-5 w-5 text-gray-600"})," Situation des Paiements"]}),o.jsx(Uu,{width:"100%",height:260,children:o.jsxs(I0,{children:[o.jsx(Wu,{data:b,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",children:b.map((j,T)=>o.jsx(Wi,{fill:j.color},`cell-${T}`))}),o.jsx(Bu,{})]})}),o.jsx("div",{className:"flex justify-center space-x-6 mt-4",children:b.map(j=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:j.color}})," ",o.jsxs("span",{className:"text-sm text-gray-600",children:[j.name," (",j.value,")"]})]},j.name))})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Actions Rapides"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("button",{className:"group p-6 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-left",onClick:a,children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:o.jsx(Qi,{className:"h-5 w-5 text-gray-600"})})}),o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Nouvel lve"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Inscrire un nouvel lve"})]}),o.jsxs("button",{className:"group p-6 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-left",onClick:i,children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:o.jsx(Ji,{className:"h-5 w-5 text-gray-600"})})}),o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Nouveau Paiement"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Enregistrer un paiement"})]}),o.jsxs("button",{className:"group p-6 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-left",onClick:s,children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:o.jsx(Yi,{className:"h-5 w-5 text-gray-600"})})}),o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Saisir Notes"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Enregistrer les notes"})]})]})]}),e&&o.jsx(Jq,{onClose:()=>t(!1)})]})}const Qq="modulepreload",Zq=function(e,t){return new URL(e,t).href},Xk={},yn=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let d=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const s=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),f=l?.nonce||l?.getAttribute("nonce");a=d(r.map(h=>{if(h=Zq(h,n),h in Xk)return;Xk[h]=!0;const m=h.endsWith(".css"),x=m?'[rel="stylesheet"]':"";if(n)for(let y=s.length-1;y>=0;y--){const v=s[y];if(v.href===h&&(!m||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${x}`))return;const g=document.createElement("link");if(g.rel=m?"stylesheet":Qq,m||(g.as="script"),g.crossOrigin="",g.href=h,f&&g.setAttribute("nonce",f),document.head.appendChild(g),m)return new Promise((y,v)=>{g.addEventListener("load",y),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return a.then(s=>{for(const l of s||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},eX={primary:"bg-teal-600 text-white hover:bg-teal-700",secondary:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",ghost:"bg-transparent text-gray-700 hover:bg-gray-50",danger:"bg-red-600 text-white hover:bg-red-700"},Yk={sm:"px-2 py-1 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-base"};function Ft({variant:e="primary",className:t="",children:r,leftIcon:n,rightIcon:a,size:i="md",...s}){const l=`rounded-md font-medium inline-flex items-center space-x-2 ${Yk[i]||Yk.md}`;return o.jsxs("button",{className:`${l} ${eX[e]} ${t}`,...s,children:[n&&o.jsx("span",{className:"inline-flex mr-1",children:n}),o.jsx("span",{className:"inline-flex items-center",children:r}),a&&o.jsx("span",{className:"inline-flex ml-1",children:a})]})}class tX{cache=new Map;cacheTimeout=300*1e3;generateHash(t,r){return`${t}-${r}`}getSituationEcheances(t,r){const n=this.generateHash(t,r),a=this.cache.get(t);if(a&&a.dataHash===n&&Date.now()-a.timestamp<this.cacheTimeout)return a.data;try{const i=ff.getSituationEcheances(t);return this.cache.set(t,{data:i,timestamp:Date.now(),dataHash:n}),i}catch(i){return console.warn("Error calculating financial situation for",t,i),null}}invalidate(t){this.cache.delete(t)}invalidateAll(){this.cache.clear()}cleanup(){const t=Date.now();for(const[r,n]of this.cache.entries())t-n.timestamp>this.cacheTimeout&&this.cache.delete(r)}}const o1=new tX;typeof window<"u"&&setInterval(()=>o1.cleanup(),60*1e3);function rX({onEleveSelect:e,onNewEleve:t}){const{showToast:r}=Jr(),[n,a]=k.useState([]),[i,s]=k.useState(!1),[l,f]=k.useState(""),d=oe=>{a(oe?en.map(ke=>ke.id):[])},h=(oe,ke)=>{a(Ge=>ke?[...Ge,oe]:Ge.filter(Je=>Je!==oe))},m=()=>{n.length!==0&&window.confirm(`Supprimer ${n.length} lve(s) ?`)&&(n.forEach(oe=>fe.delete("eleves",oe)),setTimeout(()=>{},100))},x=()=>{l&&(n.forEach(oe=>fe.update("eleves",oe,{classeId:l})),s(!1),a([]),setTimeout(()=>{},100))},[g,y]=k.useState(null),[v,b]=k.useState([]),[E,N]=k.useState([]),[S,j]=k.useState({matricule:"",nom:"",prenoms:"",nomPrenoms:""}),[T,C]=k.useState(""),[P,M]=k.useState(!1),[D,W]=k.useState(!1),F=k.useRef(null),L=k.useRef(null),[J,se]=k.useState(null),[Z,he]=k.useState(!1),[le,de]=k.useState(null),[Q,pe]=k.useState(!1),re=async oe=>{const ke=oe.target.files?.[0];if(ke){console.log("handleImportExcel: file selected",ke?.name,ke?.size),y(ke);try{const Je=(await yn(()=>Promise.resolve().then(()=>Fu),void 0,import.meta.url)).importerElevesDepuisExcel;if(console.log("handleImportExcel: importer function loaded",!!Je),typeof Je!="function")throw new Error("Module d'import introuvable");const We=await Je(ke);if(console.log("handleImportExcel: importer result",We&&(Array.isArray(We)?We.length:Object.keys(We).length)),!We)throw new Error("Aucune donne retourne par l'importeur");Array.isArray(We)?(N(We),M(!0)):We.columns?(b(We.columns),N(We.preview||[]),W(!0)):(N(We.preview||[]),M(!0))}catch(Ge){const Je=Ge instanceof Error?Ge.message:String(Ge);r("Erreur lors de l'importation: "+Je,"error"),console.error("Import error:",Ge)}}},O=async()=>{if(!g)return;W(!1);const{importerElevesDepuisExcel:oe}=await yn(async()=>{const{importerElevesDepuisExcel:Ge}=await Promise.resolve().then(()=>Fu);return{importerElevesDepuisExcel:Ge}},void 0,import.meta.url),ke=await oe(g,S);N(ke),M(!0)},V=async()=>{if(!T){alert("Slectionnez une classe pour l'importation.");return}const{db:oe}=await yn(async()=>{const{db:ke}=await Promise.resolve().then(()=>I5);return{db:ke}},void 0,import.meta.url);E.forEach(ke=>{const Ge=oe.getAll("eleves").find(Je=>Je.matricule&&Je.matricule===(ke.matricule||"")||Je.nom===(ke.nom||"")&&Je.prenoms===(ke.prenoms||""));if(Ge)oe.update("eleves",Ge.id,{classeId:T});else{const Je=oe.generateMatricule();oe.create("eleves",{...ke,id:Je,classeId:T,anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:ke.pereTuteur||"",mereTutrice:ke.mereTutrice||"",telephone:ke.telephone||"",adresse:ke.adresse||"",photo:ke.photo||"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}}),M(!1),N([]),C(""),y(null),F.current&&(F.current.value="")},H=async()=>{const{exporterElevesEnExcel:oe}=await yn(async()=>{const{exporterElevesEnExcel:at}=await Promise.resolve().then(()=>Fu);return{exporterElevesEnExcel:at}},void 0,import.meta.url),ke=await oe(lt),Ge=new Blob([ke],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Je=window.URL.createObjectURL(Ge),We=document.createElement("a");We.href=Je,We.download=`eleves_klasnet_${new Date().toISOString().split("T")[0]}.xlsx`,We.click(),window.URL.revokeObjectURL(Je)},q=k.useMemo(()=>{const ke=fe.getAll("paiements").length;return Ge=>{try{const Je=o1.getSituationEcheances(Ge.id,ke);if(!Je)return"Non dfini";if(Je.eleve&&Je.eleve.protege){const jr=(Je.echeances||[]).filter(Ar=>Ar.modalite===1),Cr=jr.reduce((Ar,$r)=>Ar+($r.montant||0),0),tn=jr.reduce((Ar,$r)=>Ar+($r.montantPaye||0),0);return Cr>0&&tn>=Cr?"Pay":tn>0&&tn<Cr?"Partiel":"Impay"}const We=Je.totalDu||0,at=Je.totalPaye||0;return We===0?"Non dfini":at>=We?"Pay":at>0&&at<We?"Partiel":"Impay"}catch(Je){return console.warn("Unable to compute financial status for",Ge.id,Je),"Non dfini"}}},[]);function K(oe){switch(oe){case"Pay":return"bg-green-100 text-green-800";case"Partiel":return"bg-orange-100 text-orange-800";case"Impay":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}const[ie,B]=k.useState(""),[z,G]=k.useState(""),[ce,I]=k.useState(""),[Ae,je]=k.useState("nom"),[Le,Ue]=k.useState("asc"),[,Pe]=k.useState(0);k.useEffect(()=>{const oe=()=>{o1.invalidateAll(),Pe(ke=>ke+1)};return window.addEventListener("dataChanged",oe),()=>window.removeEventListener("dataChanged",oe)},[]);const lt=fe.getAll("eleves"),kt=fe.getAll("classes"),Yt=b4("eleves"),jt=kt.find(oe=>oe.id===z),Wa=jt?`${jt.niveau} ${jt.section||""}`.trim():"Toutes les classes",Ln=jt?jt.anneeScolaire:kt[0]?.anneeScolaire||"",Br=`${Wa}${Ln?"  "+Ln:""}  ${Yt.header}`,tr=(()=>{if(!jt)return["N","Matricule","Nom & Prnom","Date de naissance","Classe"];const ke=(Array.isArray(Yt.columns)?[...Yt.columns]:[]).filter(at=>!/classe/i.test(String(at))&&!/date\s*de\s*naiss/i.test(String(at))&&!/date.*naiss/i.test(String(at))),Ge=ke.some(at=>/matricul/i.test(String(at))),Je=ke.filter(at=>!(/nom/.test(String(at).toLowerCase())&&/pr/i.test(String(at).toLowerCase()))&&!/matricul/i.test(String(at))),We=["N"];return Ge&&We.push("Matricule"),We.push("Nom & Prnom"),We.push(...Je),We.filter((at,jr,Cr)=>Cr.indexOf(at)===jr)})(),Bn=(()=>{const oe=tr.length;if(oe===0)return[];if(!jt){if(oe===5)return["5%","10%","50%","14%","21%"];if(oe>1&&tr.findIndex(jr=>/nom/i.test(String(jr))&&/pr/i.test(String(jr)))>=0){const Cr=Math.floor(81/(oe-2));return["5%","14%",...Array(oe-2).fill(`${Cr}%`)]}const We=Math.floor(100/oe);return Array(oe).fill(`${We}%`)}const ke=tr.some(We=>/matricul/i.test(String(We))),Ge=tr.some(We=>/nom/i.test(String(We))&&/pr/i.test(String(We)));if(jt){const We=tr.length;if(We===1)return["100%"];if(We===2)return Ge?["10%","90%"]:["25%","75%"];if(We===3)return ke&&Ge?["5%","15%","80%"]:["20%","45%","35%"];if(We===4)return ke&&Ge?["5%","12%","45%","38%"]:["20%","45%","35%"];const at=ke?12:0,jr=Ge?45:60,Cr=5,tn=We-(ke&&Ge?3:2),Ar=tn>0?Math.max(4,Math.floor((100-Cr-at-jr)/tn)):0,$r=[];ke&&$r.push(`${at}%`),Ge&&$r.push(`${jr}%`);for(let ji=0;ji<tn;ji++)$r.push(`${Ar}%`);const $n={};$n["n"]=`${Cr}%`;let lo=0;return ke&&($n.matricule=$r[lo++]),Ge&&($n["nom & prnom"]=$r[lo++],$n["nom & prnoms"]=$n["nom & prnom"]),tr.map(ji=>$n[String(ji).toLowerCase()]||`${Ar}%`)}const Je=Math.floor(100/oe);return Array(oe).fill(`${Je}%`)})(),en=k.useMemo(()=>{let oe=[...lt];if(ie){const ke=ie.toLowerCase();oe=oe.filter(Ge=>Ge.nom.toLowerCase().includes(ke)||Ge.prenoms.toLowerCase().includes(ke)||Ge.matricule.toLowerCase().includes(ke)||Ge.pereTuteur.toLowerCase().includes(ke)||Ge.mereTutrice.toLowerCase().includes(ke))}return z&&(oe=oe.filter(ke=>ke.classeId===z)),ce&&(oe=oe.filter(ke=>q(ke)===ce)),oe.sort((ke,Ge)=>{let Je=ke[Ae],We=Ge[Ae];return(typeof Je>"u"||Je===null)&&(Je=""),(typeof We>"u"||We===null)&&(We=""),typeof Je=="string"&&(Je=Je.toLowerCase(),We=We.toLowerCase()),Le==="asc"?Je<We?-1:Je>We?1:0:Je>We?-1:Je<We?1:0}),oe},[lt,ie,z,ce,Ae,Le]),rr=oe=>{Ae===oe?Ue(Le==="asc"?"desc":"asc"):(je(oe),Ue("asc"))},Cn=oe=>{window.confirm(`tes-vous sr de vouloir supprimer l'lve ${oe.prenoms} ${oe.nom} ?`)&&(fe.delete("eleves",oe.id),fe.addHistorique({type:"suppression",cible:"lve",cibleId:oe.id,description:`Suppression de l'lve ${oe.prenoms} ${oe.nom}`,utilisateur:"ADMIN"}),setTimeout(()=>{},100))},ut=oe=>{const ke=kt.find(Ge=>Ge.id===oe);return ke?`${ke.niveau} ${ke.section}`:"Non assign"},Ct=oe=>{switch(oe){case"Actif":return"bg-green-100 text-green-800";case"Inactif":return"bg-gray-100 text-gray-800";case"Transfr":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return o.jsxs(dl,{title:"Gestion des lves",subtitle:`${en.length} lve(s) trouv(s)`,actions:o.jsxs(o.Fragment,{children:[o.jsx("input",{ref:F,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:re}),o.jsxs(Ft,{variant:"secondary",className:"px-3",onClick:()=>F.current?.click(),children:[o.jsx(Hs,{className:"h-4 w-4"}),o.jsx("span",{children:"Importer"})]}),o.jsxs(Ft,{variant:"secondary",className:"px-3",onClick:H,children:[o.jsx(w1,{className:"h-4 w-4"}),o.jsx("span",{children:"Exporter"})]}),o.jsx("input",{ref:L,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:async oe=>{const ke=oe.target.files?.[0];if(ke)try{const Ge=await yn(()=>Promise.resolve().then(()=>Fu),void 0,import.meta.url);if(typeof Ge.previewImporterPaiementsDepuisExcel!="function")throw new Error("Importeur de paiements introuvable");const Je=await Ge.previewImporterPaiementsDepuisExcel(ke);de(Je),pe(!0)}catch(Ge){const Je=Ge instanceof Error?Ge.message:String(Ge);r("Erreur import paiements: "+Je,"error"),console.error(Ge)}}}),o.jsxs(Ft,{variant:"secondary",className:"px-3",onClick:()=>L.current?.click(),children:[o.jsx(Hs,{className:"h-4 w-4"}),o.jsx("span",{children:"Importer paiements"})]}),o.jsxs(Ft,{variant:"primary",onClick:t,children:[o.jsx(Vo,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvel lve"})]}),o.jsxs(Ft,{variant:"secondary",onClick:()=>window.print(),className:"px-3",children:[o.jsx(x4,{className:"h-4 w-4"}),o.jsx("span",{children:"Imprimer / PDF"})]}),D&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-8 relative animate-fade-in flex flex-col items-center",children:[o.jsx("h2",{className:"text-xl font-bold mb-4",children:"Slectionnez les colonnes  importer"}),o.jsxs("div",{className:"space-y-3 w-full",children:[o.jsxs("div",{children:[o.jsx("label",{children:"Matricule :"}),o.jsxs("select",{value:S.matricule,onChange:oe=>j({...S,matricule:oe.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),v.map(oe=>o.jsx("option",{value:oe,children:oe},oe))]})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Nom :"}),o.jsxs("select",{value:S.nom,onChange:oe=>j({...S,nom:oe.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),v.map(oe=>o.jsx("option",{value:oe,children:oe},oe))]})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Prnoms :"}),o.jsxs("select",{value:S.prenoms,onChange:oe=>j({...S,prenoms:oe.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),v.map(oe=>o.jsx("option",{value:oe,children:oe},oe))]})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Noms et Prnoms (si tout est dans une seule colonne) :"}),o.jsxs("select",{value:S.nomPrenoms,onChange:oe=>j({...S,nomPrenoms:oe.target.value}),className:"w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"-- Choisir --"}),v.map(oe=>o.jsx("option",{value:oe,children:oe},oe))]}),o.jsx("div",{className:"text-xs text-gray-500",children:"Si cette colonne est slectionne, le nom sera le premier mot, le reste les prnoms."})]})]}),o.jsxs("div",{className:"mt-4 flex justify-end space-x-2 w-full",children:[o.jsx("button",{className:"px-4 py-2 bg-gray-200 rounded",onClick:()=>W(!1),children:"Annuler"}),o.jsx("button",{className:"px-4 py-2 bg-teal-600 text-white rounded",onClick:O,children:"Valider"})]}),o.jsxs("div",{className:"mt-4 w-full",children:[o.jsx("h3",{className:"font-semibold mb-2",children:"Aperu des donnes :"}),o.jsxs("table",{className:"w-full text-xs border",children:[o.jsx("thead",{children:o.jsx("tr",{children:v.map(oe=>o.jsx("th",{className:"border px-1",children:oe},oe))})}),o.jsx("tbody",{children:E.map((oe,ke)=>o.jsx("tr",{children:v.map((Ge,Je)=>o.jsx("td",{className:"border px-1",children:oe[Je]},Je))},ke))})]})]})]})}),P&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-[90vw] p-8 relative animate-fade-in flex flex-col items-center",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Aperu de l'importation"}),o.jsx("div",{className:"w-full max-h-[60vh] overflow-y-auto mb-6 border rounded-lg",children:o.jsxs("table",{className:"w-full text-sm border-collapse",children:[o.jsx("thead",{className:"bg-gray-100 sticky top-0",children:o.jsxs("tr",{className:"text-center",children:[o.jsx("th",{className:"py-2 px-3 border",children:"Matricule"}),o.jsx("th",{className:"py-2 px-3 border",children:"Nom"}),o.jsx("th",{className:"py-2 px-3 border",children:"Prnoms"})]})}),o.jsx("tbody",{children:E.map((oe,ke)=>o.jsxs("tr",{className:"text-center hover:bg-gray-50",children:[o.jsx("td",{className:"py-2 px-3 border",children:oe.matricule}),o.jsx("td",{className:"py-2 px-3 border",children:oe.nom}),o.jsx("td",{className:"py-2 px-3 border",children:oe.prenoms})]},ke))})]})}),o.jsxs("div",{className:"mb-6 w-full flex flex-col items-center",children:[o.jsx("label",{className:"font-semibold mb-2",children:"Classe d'affectation :"}),o.jsxs("select",{value:T,onChange:oe=>C(oe.target.value),className:"px-3 py-2 border rounded w-full max-w-xs",children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),kt.map(oe=>o.jsxs("option",{value:oe.id,children:[oe.niveau," ",oe.section]},oe.id))]})]}),o.jsxs("div",{className:"flex justify-end gap-4 w-full",children:[o.jsx("button",{className:"px-4 py-2 bg-gray-400 text-white rounded",onClick:()=>M(!1),children:"Annuler"}),o.jsx("button",{className:"px-4 py-2 bg-teal-600 text-white rounded font-bold",onClick:V,children:"Valider l'importation"})]})]})}),Z&&J&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-[90vw] p-6 relative animate-fade-in",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rsultat de l'import des paiements"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{className:"border rounded p-3",children:[o.jsxs("h3",{className:"font-semibold",children:["Paiements appliqus (",J.applied.length,")"]}),o.jsx("div",{className:"mt-2 max-h-60 overflow-auto text-sm",children:o.jsxs("table",{className:"w-full text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"py-1",children:"Ligne"}),o.jsx("th",{className:"py-1",children:"lve"}),o.jsx("th",{className:"py-1",children:"Mois"}),o.jsx("th",{className:"py-1",children:"Montant"})]})}),o.jsx("tbody",{children:J.applied.map((oe,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"py-1",children:oe.row}),o.jsx("td",{className:"py-1",children:oe.eleveId}),o.jsx("td",{className:"py-1",children:oe.month}),o.jsx("td",{className:"py-1",children:oe.montant})]},ke))})]})})]}),o.jsxs("div",{className:"border rounded p-3",children:[o.jsxs("h3",{className:"font-semibold",children:["Lignes non rsolues (",J.unresolved.length,")"]}),o.jsx("div",{className:"mt-2 max-h-60 overflow-auto text-sm",children:o.jsxs("table",{className:"w-full text-left text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"py-1",children:"Ligne"}),o.jsx("th",{className:"py-1",children:"Nom"}),o.jsx("th",{className:"py-1",children:"Classe"}),o.jsx("th",{className:"py-1",children:"Contact"})]})}),o.jsx("tbody",{children:J.unresolved.map((oe,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"py-1",children:oe.row}),o.jsx("td",{className:"py-1",children:oe.name}),o.jsx("td",{className:"py-1",children:oe.classe}),o.jsx("td",{className:"py-1",children:oe.contact||""})]},ke))})]})})]})]}),o.jsx("div",{className:"flex justify-end gap-2",children:o.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:()=>{he(!1),se(null)},children:"Fermer"})})]})}),Q&&le&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-[95vw] p-6 relative animate-fade-in",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Aperu des paiements dtects"}),o.jsxs("div",{className:"max-h-[55vh] overflow-auto mb-4",children:[o.jsxs("table",{className:"w-full text-sm border-collapse",children:[o.jsx("thead",{className:"bg-gray-100 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"p-2 border",children:"Ligne"}),o.jsx("th",{className:"p-2 border",children:"lve suggr"}),o.jsx("th",{className:"p-2 border",children:"Nom"}),o.jsx("th",{className:"p-2 border",children:"Classe"}),o.jsx("th",{className:"p-2 border",children:"Mois"}),o.jsx("th",{className:"p-2 border",children:"Montant"})]})}),o.jsx("tbody",{children:le.proposals.map((oe,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"p-2",children:oe.row}),o.jsx("td",{className:"p-2",children:oe.match?oe.match.name:""}),o.jsx("td",{className:"p-2",children:oe.name}),o.jsx("td",{className:"p-2",children:oe.classe}),o.jsx("td",{className:"p-2",children:oe.month}),o.jsx("td",{className:"p-2",children:oe.montant})]},ke))})]}),o.jsxs("div",{className:"mt-4",children:[o.jsxs("h3",{className:"font-semibold",children:["Lignes non rsolues (",le.unresolved.length,")"]}),o.jsx("div",{className:"max-h-40 overflow-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"p-2 border",children:"Ligne"}),o.jsx("th",{className:"p-2 border",children:"Nom"}),o.jsx("th",{className:"p-2 border",children:"Classe"})]})}),o.jsx("tbody",{children:le.unresolved.map((oe,ke)=>o.jsxs("tr",{className:"border-t",children:[o.jsx("td",{className:"p-2",children:oe.row}),o.jsx("td",{className:"p-2",children:oe.name}),o.jsx("td",{className:"p-2",children:oe.classe})]},ke))})]})})]})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:()=>{pe(!1),de(null)},children:"Annuler"}),o.jsx("button",{className:"px-4 py-2 bg-teal-600 text-white rounded",onClick:async()=>{try{const ke=await(await yn(()=>Promise.resolve().then(()=>Fu),void 0,import.meta.url)).applyPaiementsDepuisProposals(le.proposals);se(ke),he(!0),pe(!1),de(null)}catch(oe){const ke=oe instanceof Error?oe.message:String(oe);r("Erreur lors de l'application: "+ke,"error")}},children:"Appliquer les paiements"})]})]})})]}),children:[o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(sl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher un lve...",value:ie,onChange:oe=>B(oe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]}),o.jsxs("select",{value:z,onChange:oe=>G(oe.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Toutes les classes"}),kt.map(oe=>o.jsxs("option",{value:oe.id,children:[oe.niveau," ",oe.section]},oe.id))]}),o.jsxs("select",{value:ce,onChange:oe=>I(oe.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Tous les statuts financiers"}),o.jsx("option",{value:"Pay",children:"Pay"}),o.jsx("option",{value:"Partiel",children:"Partiel"}),o.jsx("option",{value:"Impay",children:"Impay"})]}),o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:[o.jsx(L0,{className:"h-4 w-4"}),o.jsx("span",{children:"Plus de filtres"})]})]})}),o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden",children:[o.jsxs("div",{id:"print-area",className:"hidden print:block bg-white p-4 mb-4",children:[o.jsx(Hf,{type:"eleves",libelle:Br}),o.jsx("div",{className:"mb-2 overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse",style:{tableLayout:"fixed"},children:[o.jsx("colgroup",{children:tr.map((oe,ke)=>o.jsx("col",{style:{width:Bn[ke]}},ke))}),o.jsx("thead",{children:o.jsx("tr",{children:tr.map((oe,ke)=>o.jsx("th",{className:"border px-2 py-1 text-left text-sm font-medium align-top",children:oe},ke))})})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"min-w-full border-collapse",style:{tableLayout:"fixed"},children:[o.jsx("colgroup",{children:tr.map((oe,ke)=>o.jsx("col",{style:{width:Bn[ke]}},ke))}),o.jsx("tbody",{children:en.map((oe,ke)=>o.jsx("tr",{className:ke%2===0?"bg-white":"bg-gray-50",children:tr.map((Ge,Je)=>{const We=Ge.toLowerCase();let at="";if(jt){if(We==="n")return at=ke+1,o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je);if(We.includes("matricul"))return at=oe.matricule||"",o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je);if(We.includes("nom")&&We.includes("pr"))return at=Bt(oe),o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je);if(We.includes("date")&&We.includes("naiss"))return at="",o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je)}if(!jt&&We==="n")return at=ke+1,o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je);if(We.includes("matricul"))at=oe.matricule||"";else if(We.includes("nom")&&We.includes("pr"))at=Bt(oe);else if(We.includes("nom")&&!We.includes("pr"))at=oe.nom||"";else if((We.includes("pr")||We.includes("prnom")||We.includes("prenoms"))&&!We.includes("nom"))at=oe.prenoms||"";else if(We.includes("date")&&We.includes("naiss"))at=oe.dateNaissance?new Date(oe.dateNaissance).toLocaleDateString("fr-FR"):"";else if(We.includes("classe"))at=ut(oe.classeId);else if(We.includes("sexe"))at=oe.sexe==="M"?"Masculin":"Fminin";else if(We.includes("parent"))at=`P: ${oe.pereTuteur||""}  M: ${oe.mereTutrice||""}`;else if(We.includes("statut financi")||We.includes("financier"))at=q(oe);else if(/\b(?:n|no\.?|#|num(?:ero|ro)?|numero)\b/.test(We))at=ke+1;else{const Cr=Ge.toLowerCase().replace(/\s+/g,"").replace(/&/g,"and"),tn=Object.keys(oe).find(Ar=>Ar.toLowerCase()===Cr);at=tn?oe[tn]:""}return o.jsx("td",{className:"border px-2 py-1 text-sm align-top",children:at},Je)})},oe.id))})]}),o.jsx("div",{className:"text-xs text-right text-gray-500 mt-2",children:Yt.footer})]})]}),n.length>0&&o.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[o.jsxs("span",{className:"font-medium text-gray-700",children:[n.length," slectionn(s)"]}),o.jsx(Ft,{variant:"danger",onClick:m,children:"Supprimer"}),o.jsx(Ft,{variant:"primary",onClick:()=>s(!0),children:"Changer de classe"}),o.jsx(Ft,{variant:"ghost",onClick:()=>a([]),children:"Tout dslectionner"})]}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-[90vw] mx-4",children:[o.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 text-center",children:"Changement de Classe"}),o.jsxs("p",{className:"text-gray-600 text-center mt-1",children:[n.length," lve(s) slectionn(s)"]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Nouvelle classe d'affectation"}),o.jsxs("select",{value:l,onChange:oe=>f(oe.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),kt.map(oe=>o.jsxs("option",{value:oe.id,children:[oe.niveau," ",oe.section," (",oe.anneeScolaire,")"]},oe.id))]})]}),o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsx("p",{className:"text-gray-700 text-sm",children:" Cette action modifiera la classe de tous les lves slectionns"})})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-4 mt-6 pt-6 border-t border-gray-200",children:[o.jsx(Ft,{variant:"secondary",className:"w-full sm:w-auto",onClick:()=>s(!1),children:"Annuler"}),o.jsx(Ft,{variant:"primary",className:"w-full sm:w-auto",onClick:x,disabled:!l,children:"Valider le Changement"})]}),o.jsxs(o.Fragment,{children:[o.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Changer la classe de ",n.length," lve(s)"]}),o.jsxs("select",{value:l,onChange:oe=>f(oe.target.value),className:"w-full mb-4 border rounded px-3 py-2",children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),kt.map(oe=>o.jsxs("option",{value:oe.id,children:[oe.niveau," ",oe.section]},oe.id))]}),o.jsxs("div",{className:"flex justify-end space-x-2 w-full",children:[o.jsx(Ft,{variant:"secondary",onClick:()=>s(!1),children:"Annuler"}),o.jsx(Ft,{variant:"primary",onClick:x,children:"Valider"})]})]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-2 py-3 text-center",children:o.jsx("input",{type:"checkbox",checked:n.length===en.length&&en.length>0,onChange:oe=>d(oe.target.checked)})}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"N"}),o.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-100",onClick:()=>rr("matricule"),children:["Matricule ",Ae==="matricule"&&(Le==="asc"?"":"")]}),o.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-100",onClick:()=>rr("nom"),children:["Nom et Prnoms ",Ae==="nom"&&(Le==="asc"?"":"")]}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Sexe"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Date Naissance"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Classe"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Parents"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Statut"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Statut Financier"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:en.map((oe,ke)=>o.jsxs("tr",{className:`hover:bg-gray-50 ${n.includes(oe.id)?"bg-teal-50":""}`,children:[o.jsx("td",{className:"px-2 py-3 text-center",children:o.jsx("input",{type:"checkbox",checked:n.includes(oe.id),onChange:Ge=>h(oe.id,Ge.target.checked)})}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:ke+1}),o.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:oe.matricule}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[oe.photo&&o.jsx("img",{src:oe.photo,alt:Bt(oe),className:"h-8 w-8 rounded-full object-cover"}),o.jsx("div",{children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:Bt(oe)})})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${oe.sexe==="M"?"bg-blue-100 text-blue-800":"bg-pink-100 text-pink-800"}`,children:oe.sexe==="M"?"Masculin":"Fminin"})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(oe.dateNaissance).toLocaleDateString("fr-FR")}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:ut(oe.classeId)}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:o.jsxs("div",{children:[o.jsxs("div",{className:"font-medium",children:["P: ",oe.pereTuteur]}),o.jsxs("div",{children:["M: ",oe.mereTutrice]}),oe.protege&&oe.garantId&&(()=>{const Ge=fe.getById("enseignants",oe.garantId);return Ge?o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Garant: ",Bt(Ge)]}):null})()]})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Ct(oe.statut)}`,children:oe.statut})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${K(q(oe))}`,children:q(oe)})}),o.jsx("td",{className:"px-4 py-3 text-sm",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>e(oe),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Voir dtails",children:o.jsx(m4,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>e(oe),className:"p-1 text-gray-600 hover:bg-gray-50 rounded",title:"Modifier",children:o.jsx(Ho,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>Cn(oe),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Supprimer",children:o.jsx(Ws,{className:"h-4 w-4"})})]})})]},oe.id))})]})})]}),en.length===0&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-gray-500",children:"Aucun lve trouv"})})]})}function Nm(e,t="Vous avez des modifications non sauvegardes. Vouliez-vous quitter sans enregistrer ?"){const[r,n]=k.useState(!1),a=k.useRef(!1);a.current=!!e;const i=k.useRef(null);return k.useEffect(()=>{let d=null,h=null;try{const v=window;v.__unsavedGuards||(v.__unsavedGuards=new Set),d=()=>{try{const b=window;if(b&&b.__skipUnsavedGuards||b&&b.__forceNavigationInProgress)return!1}catch{}return!!a.current},v.__unsavedGuards.add(d),v.__unsavedAllowHandlers||(v.__unsavedAllowHandlers=new Set),h=()=>{try{a.current=!1,n(!1)}catch{}},v.__unsavedAllowHandlers.add(h);try{console.debug("[useUnsavedWarning] registered guard",{id:h&&h.toString().slice(0,40)})}catch{}}catch{}const m=v=>{if(a.current)return v.preventDefault(),v.returnValue=t,t},x=()=>{a.current&&(history.pushState(null,document.title,window.location.href),n(!0))},g=v=>{try{console.debug("[useUnsavedWarning] handleAppNavigate called, dirty=",a.current)}catch{}try{const b=window;if(b&&b.__forceNavigationInProgress){console.debug("[useUnsavedWarning] skipping due to forceNavigation flag");return}}catch{}if(a.current){try{v&&typeof v.stopImmediatePropagation=="function"&&v.stopImmediatePropagation()}catch{}i.current=v?.detail||{page:null};try{const b=window;try{console.debug("[useUnsavedWarning] calling autosave handlers")}catch{}b.__autosaveHandlers&&typeof b.__autosaveHandlers.forEach=="function"&&b.__autosaveHandlers.forEach(E=>{try{E()}catch(N){console.debug("autosave handler failed",N)}})}catch{}n(!0);try{history.pushState(null,document.title,window.location.href)}catch{}}},y=()=>{try{console.debug("[useUnsavedWarning] unsaved:allow received, running allowHandler")}catch{}try{typeof h=="function"&&h()}catch{}};return window.addEventListener("unsaved:allow",y),window.addEventListener("beforeunload",m),window.addEventListener("popstate",x),window.addEventListener("navigate",g,!0),()=>{try{window.removeEventListener("beforeunload",m),window.removeEventListener("popstate",x),window.removeEventListener("navigate",g,!0),window.removeEventListener("unsaved:allow",y)}catch{}try{const v=window;d&&v&&v.__unsavedGuards&&v.__unsavedGuards.delete(d),h&&v&&v.__unsavedAllowHandlers&&v.__unsavedAllowHandlers.delete(h)}catch{}}},[t]),{showPrompt:r,openPrompt:()=>n(!0),closePrompt:()=>n(!1),allowNavigation:()=>{n(!1),a.current=!1;const d=i.current;i.current=null,setTimeout(()=>{try{const h=window;if(h&&(h.__preventReDispatch||h.__forceNavigationInProgress)){try{console.debug("[useUnsavedWarning] skipping re-dispatch because app will handle navigation")}catch{}return}d&&d.page?window.dispatchEvent(new CustomEvent("navigate",{detail:d})):history.back()}catch(h){console.debug("allowNavigation failed",h)}},0)}}}function Em(e,t){const r=`autosave:${e}`,n=k.useRef(t);return n.current=t,k.useEffect(()=>{if(t!==void 0)try{const l=JSON.stringify(t);localStorage.setItem(r,l)}catch(l){console.debug("autosave write failed",l)}},[r,t]),k.useEffect(()=>{const l=window,f=()=>{try{const d=n.current;if(d===void 0)return;localStorage.setItem(r,JSON.stringify(d));try{console.debug("[useAutoSave] saved",r)}catch{}}catch(d){console.debug("autosave immediate write failed",d)}};l.__autosaveHandlers||(l.__autosaveHandlers=new Set),l.__autosaveHandlers.add(f);try{console.debug("[useAutoSave] registered handler",r)}catch{}return()=>{try{l.__autosaveHandlers.delete(f)}catch{}}},[r]),{load:()=>{try{const l=localStorage.getItem(r);return l?JSON.parse(l):null}catch(l){return console.debug("autosave read failed",l),null}},clear:()=>{try{localStorage.removeItem(r)}catch{}},saveNow:()=>{try{const l=n.current;if(l===void 0)return;localStorage.setItem(r,JSON.stringify(l));try{console.debug("[useAutoSave] saveNow called",r)}catch{}}catch(l){console.debug("autosave saveNow failed",l)}}}}function nX({eleveId:e}){const[t,r]=k.useState([]),[n,a]=k.useState(!0);k.useEffect(()=>{i()},[e]);const i=()=>{a(!0);try{const x=fe.getParcoursAcademique(e);r(x)}catch(x){console.error("Erreur lors du chargement du parcours acadmique:",x)}finally{a(!1)}},s=x=>{switch(x){case"Admis":return o.jsx(fc,{className:"w-5 h-5 text-green-600"});case"Redoublant":return o.jsx(WS,{className:"w-5 h-5 text-orange-600"});case"Transfr":return o.jsx(uc,{className:"w-5 h-5 text-blue-600"});case"En cours":return o.jsx(tc,{className:"w-5 h-5 text-blue-600"});default:return o.jsx(uc,{className:"w-5 h-5 text-gray-600"})}},l=x=>{const g="px-3 py-1 rounded-full text-sm font-medium";switch(x){case"Admis":return`${g} bg-green-100 text-green-800`;case"Redoublant":return`${g} bg-orange-100 text-orange-800`;case"Transfr":return`${g} bg-blue-100 text-blue-800`;case"En cours":return`${g} bg-blue-100 text-blue-800`;case"Abandonn":return`${g} bg-red-100 text-red-800`;default:return`${g} bg-gray-100 text-gray-800`}};if(n)return o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(t.length===0)return o.jsxs("div",{className:"text-center py-12",children:[o.jsx(tc,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun historique acadmique"}),o.jsx("p",{className:"text-gray-500",children:"Le parcours acadmique de cet lve sera enregistr  partir du prochain passage d'anne."})]});const f=t.length,d=t.filter(x=>x.statut==="Admis").length,h=t.filter(x=>x.statut==="Redoublant").length,m=t.filter(x=>x.moyenneAnnuelle!==void 0&&x.moyenneAnnuelle!==null).reduce((x,g)=>x+(g.moyenneAnnuelle||0),0)/t.filter(x=>x.moyenneAnnuelle!==void 0&&x.moyenneAnnuelle!==null).length||0;return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Annes au total"}),o.jsx("p",{className:"text-2xl font-bold text-blue-900 mt-1",children:f})]}),o.jsx(zs,{className:"w-8 h-8 text-blue-600"})]})}),o.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border border-green-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Admissions"}),o.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:d})]}),o.jsx(b5,{className:"w-8 h-8 text-green-600"})]})}),o.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Redoublements"}),o.jsx("p",{className:"text-2xl font-bold text-orange-900 mt-1",children:h})]}),o.jsx(WS,{className:"w-8 h-8 text-orange-600"})]})}),o.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Moyenne globale"}),o.jsx("p",{className:"text-2xl font-bold text-purple-900 mt-1",children:m>0?m.toFixed(2):"N/A"})]}),o.jsx(tc,{className:"w-8 h-8 text-purple-600"})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Parcours Acadmique"}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Historique dtaill anne par anne"})]}),o.jsx("div",{className:"p-6",children:o.jsx("div",{className:"space-y-6",children:t.map((x,g)=>o.jsxs("div",{className:"relative",children:[g<t.length-1&&o.jsx("div",{className:"absolute left-6 top-12 bottom-0 w-0.5 bg-gray-200"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"w-12 h-12 rounded-full bg-white border-2 border-gray-200 flex items-center justify-center shadow-sm",children:s(x.statut)})}),o.jsxs("div",{className:"flex-1 bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-2",children:[o.jsxs("div",{children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:[x.niveau," ",x.section&&`- ${x.section}`]}),o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Anne scolaire: ",o.jsx("span",{className:"font-medium",children:x.anneeScolaire})]})]}),o.jsx("span",{className:l(x.statut),children:x.statut})]}),o.jsxs("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[x.moyenneAnnuelle!==void 0&&x.moyenneAnnuelle!==null&&o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500",children:"Moyenne annuelle"}),o.jsxs("p",{className:"font-semibold text-gray-900 mt-1",children:[x.moyenneAnnuelle.toFixed(2),"/20"]})]}),x.rang&&x.effectifClasse&&o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500",children:"Rang"}),o.jsxs("p",{className:"font-semibold text-gray-900 mt-1",children:[x.rang,"/",x.effectifClasse]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500",children:"Dbut"}),o.jsx("p",{className:"font-semibold text-gray-900 mt-1",children:new Date(x.dateDebut).toLocaleDateString("fr-FR")})]}),x.dateFin&&o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500",children:"Fin"}),o.jsx("p",{className:"font-semibold text-gray-900 mt-1",children:new Date(x.dateFin).toLocaleDateString("fr-FR")})]})]}),x.observations&&o.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium",children:"Observations:"})," ",x.observations]})})]})]})]},x.id))})})]})]})}function aX({eleve:e,onSave:t,onCancel:r}){const{showToast:n}=Jr(),[a,i]=k.useState({matricule:"",nom:"",prenoms:"",sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:"",anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:"",adresse:"",photo:"",protege:!1,garantId:""}),[s,l]=k.useState({}),[f,d]=k.useState(!1),h=fe.getAll("classes"),m=fe.getAll("enseignants");k.useEffect(()=>{if(e){const F={matricule:e.matricule,nom:e.nom,prenoms:e.prenoms,sexe:e.sexe,dateNaissance:e.dateNaissance,lieuNaissance:e.lieuNaissance,classeId:e.classeId,anneeEntree:e.anneeEntree,statut:e.statut,pereTuteur:e.pereTuteur,mereTutrice:e.mereTutrice,telephone:e.telephone,adresse:e.adresse,photo:e.photo||"",protege:e.protege||!1,garantId:e.garantId||""};i(F),x.current=F,fe.getAll("enseignants")}else{const F=fe.generateMatricule(),L={...a,matricule:F};i(L),x.current=L}},[e]);const x=k.useRef({}),g=k.useMemo(()=>{try{return JSON.stringify(x.current||{})!==JSON.stringify(a||{})}catch{return!1}},[a]),y=Nm(g),v=e?.id?`eleve:${e.id}`:"eleve:new",{load:b,clear:E}=Em(v,a),N=k.useRef(null),[S,j]=k.useState(!1);k.useEffect(()=>{try{const F=b();F&&i(L=>({...L,...F}))}catch{}},[]);const T=()=>{try{E()}catch{}const F=window;try{F.__preventReDispatch=!0}catch{}try{y&&y.allowNavigation?y.allowNavigation():r()}finally{setTimeout(()=>{try{F.__preventReDispatch=!1}catch{}},80)}},C=()=>{y&&y.closePrompt&&y.closePrompt()},P=()=>{const F={};a.nom.trim()||(F.nom="Le nom est obligatoire"),a.prenoms.trim()||(F.prenoms="Les prnoms sont obligatoires"),a.classeId||(F.classeId="La classe est obligatoire"),a.protege&&!a.garantId&&(F.garantId="Un garant (enseignant) est requis pour un lve protg");const L=fe.getAll("eleves");return a.matricule&&a.matricule.trim()&&L.find(se=>se.matricule===a.matricule&&se.id!==e?.id)&&(F.matricule="Ce matricule existe dj"),l(F),Object.keys(F).length===0},M=async F=>{if(F.preventDefault(),!!P()){d(!0);try{e?(fe.update("eleves",e.id,a),n("lve mis  jour avec succs","success")):(fe.create("eleves",a),n("lve ajout avec succs","success"));try{E()}catch{}t()}catch{n("Erreur lors de la sauvegarde de l'lve","error")}finally{d(!1)}}},D=(F,L)=>{i(J=>({...J,[F]:L})),s[F]&&l(J=>({...J,[F]:""}))},W=F=>{const L=F.target.files?.[0];if(L){const J=new FileReader;J.onload=se=>{i(Z=>({...Z,photo:se.target?.result}))},J.readAsDataURL(L)}};return o.jsxs("div",{className:"p-6 max-w-5xl mx-auto",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Modifier l'lve":"Nouvel lve"}),o.jsx("p",{className:"text-gray-600 mt-1",children:e?"Modifiez les informations de l'lve":"Ajoutez un nouvel lve"})]}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",children:o.jsx(eo,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:M,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations personnelles"}),o.jsxs("div",{className:"flex items-start space-x-8",children:[o.jsxs("div",{className:"flex-shrink-0",children:[o.jsxs("div",{className:"w-32 h-32 bg-white rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center relative overflow-hidden group hover:border-gray-400 transition-colors",children:[a.photo?o.jsx("img",{src:a.photo,alt:"Photo lve",className:"w-full h-full object-cover rounded-lg"}):o.jsxs("div",{className:"text-center",children:[o.jsx(Go,{className:"h-10 w-10 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Photo lve"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:W,className:"absolute inset-0 opacity-0 cursor-pointer"})]}),o.jsxs("button",{type:"button",className:"mt-3 w-full flex items-center justify-center px-3 py-2 text-sm bg-gray-700 text-white rounded-md hover:bg-gray-800 transition-colors",children:[o.jsx(Hs,{className:"h-4 w-4 mr-2"}),"Changer photo"]})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Matricule ",o.jsx("span",{className:"text-gray-400 text-sm",children:"(optionnel)"})]}),o.jsx("input",{type:"text",value:a.matricule,onChange:F=>D("matricule",F.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.matricule?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Gnr automatiquement"}),s.matricule&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.matricule]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:F=>D("nom",F.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.nom?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Nom de famille"}),s.nom&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.nom]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Prnoms ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.prenoms,onChange:F=>D("prenoms",F.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.prenoms?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Prnoms"}),s.prenoms&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.prenoms]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Sexe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:`flex items-center justify-center p-3 border rounded-md cursor-pointer transition-all ${a.sexe==="M"?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"M",checked:a.sexe==="M",onChange:F=>D("sexe",F.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:" Masculin"})]}),o.jsxs("label",{className:`flex items-center justify-center p-3 border rounded-md cursor-pointer transition-all ${a.sexe==="F"?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"F",checked:a.sexe==="F",onChange:F=>D("sexe",F.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:" Fminin"})]})]})]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations scolaires"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Date de naissance ",o.jsx("span",{className:"text-gray-400 text-sm",children:"(optionnel)"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:a.dateNaissance,onChange:F=>D("dateNaissance",F.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.dateNaissance?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`})]}),s.dateNaissance&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.dateNaissance]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Lieu de naissance"}),o.jsxs("div",{className:"relative",children:[o.jsx(mv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.lieuNaissance,onChange:F=>D("lieuNaissance",F.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"Ville de naissance"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Classe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:a.classeId,onChange:F=>D("classeId",F.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.classeId?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),h.map(F=>o.jsxs("option",{value:F.id,children:[F.niveau," ",F.section," (",F.anneeScolaire,")"]},F.id))]}),s.classeId&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.classeId]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Anne d'entre"}),o.jsx("input",{type:"text",value:a.anneeEntree,onChange:F=>D("anneeEntree",F.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"2025"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Statut"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"Actif",label:"Actif"},{value:"Inactif",label:"Inactif"},{value:"Transfr",label:"Transfr"}].map(F=>o.jsxs("label",{className:`flex items-center justify-center p-2 border rounded-md cursor-pointer transition-all ${a.statut===F.value?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"statut",value:F.value,checked:a.statut===F.value,onChange:L=>D("statut",L.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium text-sm",children:F.label})]},F.value))})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations familiales"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Pre / Tuteur"}),o.jsxs("div",{className:"relative",children:[o.jsx(Qi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.pereTuteur,onChange:F=>D("pereTuteur",F.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"Nom du pre ou tuteur"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Mre / Tutrice"}),o.jsxs("div",{className:"relative",children:[o.jsx(Qi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.mereTutrice,onChange:F=>D("mereTutrice",F.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"Nom de la mre ou tutrice"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Tlphone"}),o.jsxs("div",{className:"relative",children:[o.jsx(S1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"tel",value:a.telephone,onChange:F=>D("telephone",F.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",placeholder:"+225 XX XX XX XX XX"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Adresse"}),o.jsxs("div",{className:"relative",children:[o.jsx(mv,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),o.jsx("textarea",{value:a.adresse,onChange:F=>D("adresse",F.target.value),rows:3,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors resize-none",placeholder:"Adresse de rsidence"})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statut spcial"}),o.jsx("div",{className:"flex items-center space-x-4",children:o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:a.protege,onChange:F=>D("protege",F.target.checked),className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:"lve protg (ne paie que l'inscription)"})]})}),a.protege&&o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Garant (enseignant)"}),o.jsxs("select",{value:a.garantId,onChange:F=>D("garantId",F.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"-- Aucun --"}),m.map(F=>o.jsx("option",{value:F.id,children:Bt(F)},F.id))]})]})]})]}),e&&e.id&&o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[o.jsx(zs,{className:"h-5 w-5 mr-2"}),"Parcours Acadmique"]}),o.jsx(nX,{eleveId:e.id})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:()=>{if(!g)return r();try{N.current={type:"cancel"},y&&y.openPrompt&&y.openPrompt()}catch{if(window.confirm("Vous avez des modifications non sauvegardes. Quitter sans enregistrer ?")){try{E()}catch{}r()}}},className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors font-medium",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 focus:ring-2 focus:ring-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:[f?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Zs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:e?f?"Sauvegarde...":"Mettre  jour l'lve":f?"Sauvegarde...":"Enregistrer l'lve"})]})]})]})]}),y&&o.jsx(kf,{open:!!y.showPrompt,onConfirm:T,onCancel:C})]})}function iX({onEnseignantSelect:e,onNewEnseignant:t}){const[r,n]=k.useState(""),[a,i]=k.useState(""),s=fe.getAll("enseignants"),l=fe.getAll("classes"),f=k.useMemo(()=>{let x=[...s];if(r){const g=r.toLowerCase();x=x.filter(y=>y.nom.toLowerCase().includes(g)||y.prenoms.toLowerCase().includes(g)||(y.specialite||"").toLowerCase().includes(g)||(y.email||"").toLowerCase().includes(g)||Bt(y).toLowerCase().includes(g))}return a&&(x=x.filter(g=>g.statut===a)),x.sort((g,y)=>g.nom.localeCompare(y.nom))},[s,r,a]),d=x=>{const g=l.filter(y=>y.enseignantPrincipal===`${x.prenoms} ${x.nom}`);if(g.length>0){alert(`Impossible de supprimer cet enseignant car il est assign  ${g.length} classe(s).`);return}window.confirm(`tes-vous sr de vouloir supprimer l'enseignant ${x.prenoms} ${x.nom} ?`)&&fe.delete("enseignants",x.id)},h=x=>{switch(x){case"Actif":return"bg-green-100 text-green-800";case"Inactif":return"bg-gray-100 text-gray-800";case"Cong":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},m=x=>l.filter(g=>g.enseignantPrincipal===x);return o.jsxs(dl,{title:"Gestion des Enseignants",subtitle:`${f.length} enseignant(s) trouv(s)`,actions:o.jsx(o.Fragment,{children:o.jsxs(Ft,{variant:"primary",onClick:t,children:[o.jsx(Vo,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvel Enseignant"})]})}),children:[o.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(sl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher un enseignant...",value:r,onChange:x=>n(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),o.jsxs("select",{value:a,onChange:x=>i(x.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"Tous les statuts"}),o.jsx("option",{value:"Actif",children:"Actif"}),o.jsx("option",{value:"Inactif",children:"Inactif"}),o.jsx("option",{value:"Cong",children:"En cong"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(x=>{const g=m(Bt(x));return o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[x.photo?o.jsx("img",{src:x.photo,alt:Bt(x),className:"h-12 w-12 rounded-full object-cover"}):o.jsx("div",{className:"h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center",children:o.jsx(Go,{className:"h-6 w-6 text-gray-400"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Bt(x)}),o.jsx("p",{className:"text-sm text-gray-500",children:x.specialite})]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>e(x),className:"p-2 text-gray-600 hover:bg-gray-50 rounded",title:"Modifier",children:o.jsx(Ho,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>d(x),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Supprimer",children:o.jsx(Ws,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"mb-4",children:o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${h(x.statut)}`,children:x.statut})}),o.jsxs("div",{className:"space-y-2 mb-4",children:[x.telephone&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(S1,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm text-gray-600",children:x.telephone})]}),x.email&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(A5,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm text-gray-600",children:x.email})]})]}),o.jsx("div",{className:"mb-4",children:o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium",children:"Diplme:"})," ",x.diplome]})}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Classes assignes (",g.length,")"]}),g.length>0?o.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.slice(0,3).map(y=>o.jsxs("span",{className:"px-2 py-1 bg-teal-100 text-teal-800 text-xs rounded",children:[y.niveau," ",y.section]},y.id)),g.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",g.length-3]})]}):o.jsx("span",{className:"text-xs text-gray-500",children:"Aucune classe assigne"})]}),o.jsx("div",{className:"pt-4 border-t border-gray-100",children:o.jsxs("p",{className:"text-xs text-gray-500",children:["Embauch le ",new Date(x.dateEmbauche).toLocaleDateString("fr-FR")]})})]},x.id)})}),f.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Go,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucun enseignant trouv"}),o.jsx(Ft,{variant:"primary",onClick:t,className:"mt-4",children:"Ajouter votre premier enseignant"})]})]})}function sX({enseignant:e,onSave:t,onCancel:r}){const{showToast:n}=Jr(),[a,i]=k.useState({nom:"",prenoms:"",sexe:"M",telephone:"",adresse:"",specialite:"",diplome:"",dateEmbauche:"",statut:"Actif",salaire:0,photo:"",classesPrincipales:[],matieresEnseignees:[]}),[s,l]=k.useState({}),[f,d]=k.useState(!1);k.useEffect(()=>{e&&i({nom:e.nom,prenoms:e.prenoms,sexe:e.sexe,telephone:e.telephone,adresse:e.adresse,specialite:e.specialite,diplome:e.diplome,dateEmbauche:e.dateEmbauche,statut:e.statut,salaire:e.salaire,photo:e.photo||"",classesPrincipales:e.classesPrincipales||[],matieresEnseignees:e.matieresEnseignees||[]})},[e]);const h=()=>{const y={};return a.nom.trim()||(y.nom="Le nom est obligatoire"),a.prenoms.trim()||(y.prenoms="Les prnoms sont obligatoires"),a.specialite.trim()||(y.specialite="La spcialit est obligatoire"),a.diplome.trim()||(y.diplome="Le diplme est obligatoire"),a.dateEmbauche||(y.dateEmbauche="La date d'embauche est obligatoire"),a.salaire<0&&(y.salaire="Le salaire doit tre positif"),fe.getAll("enseignants").find(E=>E.nom.toLowerCase()===a.nom.toLowerCase()&&E.prenoms.toLowerCase()===a.prenoms.toLowerCase()&&E.id!==e?.id)&&(y.nom="Un enseignant avec ce nom et ces prnoms existe dj"),l(y),Object.keys(y).length===0},m=async y=>{if(y.preventDefault(),!!h()){d(!0);try{e?(fe.update("enseignants",e.id,a),n("Enseignant mis  jour avec succs","success")):(fe.create("enseignants",a),n("Enseignant ajout avec succs","success")),t()}catch{n("Erreur lors de la sauvegarde de l'enseignant","error")}finally{d(!1)}}},x=(y,v)=>{i(b=>({...b,[y]:v})),s[y]&&l(b=>({...b,[y]:""}))},g=y=>{const v=y.target.files?.[0];if(v){const b=new FileReader;b.onload=E=>{i(N=>({...N,photo:E.target?.result}))},b.readAsDataURL(v)}};return o.jsx("div",{className:"p-6 max-w-5xl mx-auto",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-8",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:o.jsx(Go,{className:"h-8 w-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:e?"Modifier l'enseignant":"Nouvel enseignant"}),o.jsx("p",{className:"text-blue-100 mt-1",children:e?"Modifiez les informations de l'enseignant":"Ajoutez un nouvel enseignant"})]})]}),o.jsx("button",{onClick:r,className:"text-white hover:bg-white hover:bg-opacity-20 p-3 rounded-xl transition-colors",children:o.jsx(eo,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:m,className:"p-8 space-y-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-6",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[o.jsx("span",{className:"bg-blue-100 p-2 rounded-lg mr-3",children:""}),"Informations personnelles"]}),o.jsxs("div",{className:"flex items-start space-x-8",children:[o.jsxs("div",{className:"flex-shrink-0",children:[o.jsxs("div",{className:"w-32 h-32 bg-white rounded-2xl border-4 border-dashed border-gray-300 flex items-center justify-center relative overflow-hidden group hover:border-blue-400 transition-colors",children:[a.photo?o.jsx("img",{src:a.photo,alt:"Photo enseignant",className:"w-full h-full object-cover rounded-xl"}):o.jsxs("div",{className:"text-center",children:[o.jsx(Go,{className:"h-10 w-10 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Photo enseignant"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"absolute inset-0 opacity-0 cursor-pointer"})]}),o.jsxs("button",{type:"button",className:"mt-3 w-full flex items-center justify-center px-3 py-2 text-sm bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:[o.jsx(Hs,{className:"h-4 w-4 mr-2"}),"Changer photo"]})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:y=>x("nom",y.target.value),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.nom?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Nom de famille"}),s.nom&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.nom]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Prnoms ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.prenoms,onChange:y=>x("prenoms",y.target.value),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.prenoms?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Prnoms"}),s.prenoms&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.prenoms]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Sexe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:`flex items-center justify-center p-3 border-2 rounded-xl cursor-pointer transition-all ${a.sexe==="M"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"M",checked:a.sexe==="M",onChange:y=>x("sexe",y.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:" Masculin"})]}),o.jsxs("label",{className:`flex items-center justify-center p-3 border-2 rounded-xl cursor-pointer transition-all ${a.sexe==="F"?"border-pink-500 bg-pink-50 text-pink-700":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"sexe",value:"F",checked:a.sexe==="F",onChange:y=>x("sexe",y.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium",children:" Fminin"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Tlphone"}),o.jsxs("div",{className:"relative",children:[o.jsx(S1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"tel",value:a.telephone,onChange:y=>x("telephone",y.target.value),className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all",placeholder:"+225 XX XX XX XX XX"})]})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[o.jsx("span",{className:"bg-green-100 p-2 rounded-lg mr-3",children:""}),"Informations professionnelles"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Spcialit ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(tc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:a.specialite,onChange:y=>x("specialite",y.target.value),className:`w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.specialite?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Ex: Instituteur, Professeur des coles..."})]}),s.specialite&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.specialite]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Diplme ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.diplome,onChange:y=>x("diplome",y.target.value),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.diplome?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,placeholder:"Ex: CEAP, Licence, Master..."}),s.diplome&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.diplome]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Date d'embauche ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:a.dateEmbauche,onChange:y=>x("dateEmbauche",y.target.value),className:`w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.dateEmbauche?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`})]}),s.dateEmbauche&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.dateEmbauche]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Salaire (FCFA)"}),o.jsx("input",{type:"number",value:a.salaire,onChange:y=>x("salaire",parseInt(y.target.value)),className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 transition-all ${s.salaire?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-200 focus:border-blue-500"}`,min:"0",placeholder:"150000"}),s.salaire&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.salaire]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Statut"}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"Actif",label:" Actif",color:"green"},{value:"Inactif",label:" Inactif",color:"gray"},{value:"Cong",label:" En cong",color:"orange"}].map(y=>o.jsxs("label",{className:`flex items-center justify-center p-3 border-2 rounded-xl cursor-pointer transition-all ${a.statut===y.value?`border-${y.color}-500 bg-${y.color}-50 text-${y.color}-700`:"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"statut",value:y.value,checked:a.statut===y.value,onChange:v=>x("statut",v.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium text-sm",children:y.label})]},y.value))})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[o.jsx("span",{className:"bg-yellow-100 p-2 rounded-lg mr-3",children:""}),"Informations de contact"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Adresse"}),o.jsxs("div",{className:"relative",children:[o.jsx(mv,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),o.jsx("textarea",{value:a.adresse,onChange:y=>x("adresse",y.target.value),rows:3,className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all resize-none",placeholder:"Adresse de rsidence"})]})]})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:r,className:"px-8 py-4 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors font-semibold",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-3 px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:ring-4 focus:ring-blue-100 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",disabled:f,children:[f?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Zs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:e?f?"Sauvegarde...":"Mettre  jour l'enseignant":f?"Sauvegarde...":"Enregistrer l'enseignant"})]})]})]})]})})}function uP(e,t="Aperu",r=!0){const n=document.getElementById(e);if(n)try{const a=n.innerHTML,s=new DOMParser().parseFromString(a,"text/html");s.querySelectorAll(".no-print, button").forEach(y=>y.remove());const l=s.body.innerHTML,f=`
      <style>
        @page { 
          size: A4 portrait; 
          margin: 8mm; 
          background: white;
        }
        
        :root { 
          --page-height: 297mm; 
          --print-margin: 8mm; 
          --cut-gap: 6mm;
          --primary-blue: #1e40af;
          --primary-green: #059669;
          --accent-gold: #d97706;
          --text-dark: #1f2937;
          --text-gray: #6b7280;
          --border-light: #e5e7eb;
          --bg-light: #f9fafb;
        }
        
        html, body { 
          height: 100%; 
          margin: 0; 
          padding: 0; 
          background: white;
          font-family: 'Times New Roman', Times, serif;
          color: var(--text-dark);
          line-height: 1.4;
        }

        /* Layout containers */
        .receipt-wrapper { 
          width: 210mm; 
          margin: 0 auto; 
          box-sizing: border-box; 
          height: var(--page-height); 
        }
        
        .print-content { 
          box-sizing: border-box; 
          padding: calc(var(--print-margin) - 2mm); 
          display: block; 
          height: calc(var(--page-height)); 
        }

        /* Two-up layout improvements */
        .print-content.two-up { 
          display: flex; 
          flex-direction: column; 
          justify-content: space-between; 
          gap: var(--cut-gap); 
          page-break-after: always; 
        }
        /* Visible cut indicator for two-up double receipts */
        .print-content.two-up::before {
          content: ' Dcouper ici';
          position: absolute;
          left: 50%;
          transform: translateX(-50%);
          top: calc(50% - 10px);
          background: white;
          padding: 4px 10px;
          border-radius: 999px;
          font-weight: 700;
          color: var(--primary-blue);
          border: 1px solid rgba(0,0,0,0.06);
          z-index: 10;
        }
        
        .print-content.two-up .receipt-compact {
          /* Force each receipt to occupy exactly 50% of the printable area (minus cut gap) */
          height: calc((var(--page-height) - (var(--print-margin) * 2) - var(--cut-gap)) / 2);
          box-sizing: border-box;
          padding: 8px 12px;
          background: white;
          border: 2px solid var(--primary-blue);
          border-radius: 8px;
          box-shadow: 0 2px 8px rgba(30, 64, 175, 0.1);
          position: relative;
          overflow: hidden;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
        }

        /* Main receipt card styling */
        .receipt-compact { 
          box-sizing: border-box; 
          width: 100%; 
          max-width: 780px; 
          margin: 0 auto; 
          background: white; 
          padding: 20px 24px; 
          border-radius: 12px; 
          border: 2px solid var(--primary-blue);
          box-shadow: 0 4px 12px rgba(30, 64, 175, 0.12);
          page-break-inside: avoid; 
          break-inside: avoid; 
          display: flex; 
          flex-direction: column;
          position: relative;
          overflow: hidden;
        }

        /* Decorative elements */
        .receipt-compact::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 4px;
          background: linear-gradient(90deg, var(--primary-blue) 0%, var(--primary-green) 50%, var(--accent-gold) 100%);
        }

        .receipt-compact::after {
          content: '';
          position: absolute;
          top: 12px;
          right: 12px;
          width: 60px;
          height: 60px;
          background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-green) 100%);
          border-radius: 50%;
          opacity: 0.05;
          z-index: 0;
        }

        .receipt-compact > * {
          position: relative;
          z-index: 1;
        }

        /* Page break styling for non two-up */
        .print-content:not(.two-up) .receipt-compact:not(:last-child) { 
          page-break-after: always; 
        }
        
        .receipt-compact + .receipt-compact { 
          margin-top: 10mm; 
          border-top: 2px dashed var(--primary-blue); 
          position: relative; 
        }
        
        .receipt-compact + .receipt-compact::before { 
          content: ' Dcouper ici'; 
          position: absolute; 
          top: -8mm; 
          left: 50%; 
          transform: translateX(-50%); 
          background: white; 
          padding: 4px 16px; 
          color: var(--primary-blue); 
          font-size: 11px; 
          font-weight: 600;
          border: 1px solid var(--primary-blue);
          border-radius: 20px;
          z-index: 10;
        }

        /* Header improvements */
        .receipt-compact .entete { 
          display: flex; 
          align-items: center; 
          justify-content: center; 
          gap: 16px; 
          padding-bottom: 12px; 
          border-bottom: 2px solid var(--bg-light);
          margin-bottom: 16px;
        }
        
        .receipt-compact .entete img { 
          width: 70px; 
          height: 70px; 
          object-fit: contain; 
          border-radius: 8px;
          border: 2px solid var(--border-light);
          padding: 4px;
          background: var(--bg-light);
        }
        
        .receipt-compact .entete .entete-text { 
          text-align: center; 
          flex: 1;
        }
        
        .receipt-compact .entete .entete-text .school-name { 
          font-weight: 800; 
          font-size: 22px; 
          letter-spacing: -0.025em; 
          color: var(--primary-blue);
          text-shadow: 0 1px 2px rgba(30, 64, 175, 0.1);
          margin-bottom: 4px;
        }
        
        .receipt-compact .entete .entete-text .libelle { 
          color: var(--primary-green); 
          font-weight: 600; 
          font-size: 14px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        .receipt-compact .meta { 
          display: flex; 
          justify-content: space-between; 
          font-size: 12px; 
          color: var(--text-gray); 
          margin-top: 8px;
          padding: 8px 12px;
          background: var(--bg-light);
          border-radius: 6px;
          border-left: 3px solid var(--accent-gold);
        }

        /* Student info styling */
        .receipt-compact .student-row { 
          display: flex; 
          justify-content: space-between; 
          align-items: flex-start; 
          gap: 16px; 
          margin: 16px 0;
          padding: 12px;
          background: linear-gradient(135deg, rgba(30, 64, 175, 0.02) 0%, rgba(5, 150, 105, 0.02) 100%);
          border-radius: 8px;
          border: 1px solid var(--border-light);
        }
        
        .receipt-compact .student-row .left { 
          flex: 1;
          max-width: 65%; 
        }
        
        .receipt-compact .student-row .right { 
          text-align: right; 
          color: var(--text-dark); 
          font-weight: 700;
          font-size: 18px; /* slightly larger for amounts */
        }

        /* Title styling */
        h4 { 
          text-align: center; 
          font-size: 20px; 
          margin: 16px 0 20px; 
          font-weight: 800;
          color: var(--primary-blue);
          text-transform: uppercase;
          letter-spacing: 1px;
          position: relative;
        }

        h4::after {
          content: '';
          position: absolute;
          bottom: -6px;
          left: 50%;
          transform: translateX(-50%);
          width: 80px;
          height: 3px;
          background: linear-gradient(90deg, var(--primary-blue), var(--primary-green));
          border-radius: 2px;
        }

        /* Table improvements */
        table { 
          width: 100%; 
          border-collapse: separate;
          border-spacing: 0;
          font-size: 15px;
          margin: 16px 0;
          border-radius: 8px;
          overflow: hidden;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        thead tr { 
          background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
          color: white; 
        }
        
        th, td { 
          padding: 12px 16px; 
          border-bottom: 1px solid var(--border-light);
          vertical-align: middle;
        }
        
        th { 
          text-align: left; 
          font-weight: 700;
          font-size: 13px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        tbody tr:nth-child(even) {
          background: rgba(249, 250, 251, 0.5);
        }
        
        tbody tr:hover {
          background: rgba(30, 64, 175, 0.03);
        }
        
        td.amount, .text-right { 
          text-align: right; 
          font-weight: 700; 
          color: var(--primary-green);
          font-size: 15px;
        }

        tfoot tr {
          background: var(--bg-light);
          border-top: 2px solid var(--primary-blue);
        }

        tfoot td {
          font-weight: 900;
          font-size: 18px;
          color: var(--primary-blue);
          border-bottom: none;
        }

        /* Summary box improvements */
        .summary-box { 
          margin-top: 20px; 
          padding: 20px; 
          border-radius: 12px; 
          background: linear-gradient(135deg, rgba(30, 64, 175, 0.02) 0%, rgba(5, 150, 105, 0.02) 100%);
          border: 2px solid var(--border-light);
          border-left: 4px solid var(--primary-blue);
          page-break-inside: avoid; 
        }
        
        .summary-grid { 
          display: grid; 
          grid-template-columns: 1fr auto; 
          gap: 12px 20px; 
          align-items: center; 
        }
        
        .summary-grid .label { 
          color: var(--text-gray);
          font-weight: 500;
          font-size: 13px;
        }
        
        .summary-grid .value { 
          text-align: right; 
          font-weight: 900;
          font-size: 16px; /* bigger for clarity */
        }
        
        .summary-grid .value.secondary { 
          font-weight: 700; 
          color: var(--text-dark); 
        }
        
        .summary-grid .value.alert { 
          color: #dc2626;
        }

        /* Footer styling */
        .muted { 
          color: var(--text-gray); 
          text-align: center; 
          margin-top: 20px; 
          font-size: 11px;
          font-style: italic;
          padding-top: 12px;
          border-top: 1px solid var(--border-light);
        }

        /* Compact mode adjustments */
        .print-content.two-up .receipt-compact .entete img { 
          width: 45px; 
          height: 45px; 
        }
        
        .print-content.two-up .receipt-compact .entete .entete-text .school-name { 
          font-size: 16px; 
        }
        
        .print-content.two-up h4 { 
          font-size: 14px; 
          margin: 12px 0 16px; 
        }
        
        .print-content.two-up table { 
          font-size: 11px; 
          margin: 12px 0;
        }
        
        .print-content.two-up th, .print-content.two-up td { 
          padding: 8px 12px; 
        }
        
        .print-content.two-up .summary-box { 
          padding: 12px 16px; 
          margin-top: 12px;
        }

        .print-content.two-up .summary-grid {
          gap: 8px 16px;
        }

        .print-content.two-up .summary-grid .value {
          font-size: 13px;
        }

        /* Force compact mode */
        .force-compact .receipt-compact { 
          padding: 12px 16px; 
          border-radius: 6px; 
        }
        
        .force-compact .receipt-compact .entete img { 
          width: 35px; 
          height: 35px; 
        }
        
        .force-compact .receipt-compact .entete .entete-text .school-name { 
          font-size: 14px; 
        }
        
        .force-compact h4 { 
          font-size: 12px;
          margin: 8px 0 12px;
        }
        
        .force-compact table { 
          font-size: 10px;
          margin: 10px 0;
        }
        
        .force-compact th, .force-compact td { 
          padding: 6px 10px; 
        }
        
        .force-compact .summary-box { 
          padding: 10px 12px; 
          margin-top: 10px;
        }
        
        .force-compact .muted { 
          font-size: 9px;
          margin-top: 12px;
        }

        /* Print-specific adjustments */
        @media print {
          body { 
            -webkit-print-color-adjust: exact; 
            color-adjust: exact; 
            print-color-adjust: exact;
          }
          
          .receipt-compact { 
            box-shadow: none !important; 
            border: 2px solid var(--primary-blue) !important;
          }
          
          .receipt-wrapper { 
            padding: 0; 
          }

          /* Ensure gradients print properly */
          .receipt-compact::before,
          thead tr,
          h4::after {
            -webkit-print-color-adjust: exact;
            color-adjust: exact;
            print-color-adjust: exact;
          }
        }
      </style>
    `;let d="";if(r)try{const y=s.querySelectorAll(".receipt-compact");if(y&&y.length>0){const v=[];for(let b=0;b<y.length;b+=2){const E=y[b].outerHTML,N=y[b+1]?y[b+1].outerHTML:"";v.push(`<div class="print-content two-up">${E}${N}</div>`)}d=v.join("")}else d=`<div class="print-content two-up"><div class="receipt-compact">${l}</div><div class="receipt-compact">${l}</div></div>`}catch{d=`<div class="print-content two-up"><div class="receipt-compact">${l}</div><div class="receipt-compact">${l}</div></div>`}else d=`<div class="print-content">${l}</div>`;const x=`<!doctype html><html><head><meta charset="utf-8"/><title>${t}</title>${f}</head><body><div class="receipt-wrapper">${d}</div>${`
      <script>
        (function(){
          const TWO_UP = ${r?"true":"false"};
          function sleep(ms){return new Promise(r=>setTimeout(r,ms));}

          function mmToPx(mm){
            const div = document.createElement('div');
            div.style.position = 'absolute';
            div.style.left = '-9999px';
            div.style.height = mm + 'mm';
            document.body.appendChild(div);
            const px = div.getBoundingClientRect().height;
            document.body.removeChild(div);
            return px;
          }

          async function adjustAndPrint(){
            await sleep(200); // Allow more time for styles to load

            const pageHeightPx = mmToPx(297);
            const marginPx = mmToPx(8); // Updated margin
            const printablePx = pageHeightPx - marginPx * 2;

            const wrapper = document.querySelector('.receipt-wrapper');
            if (!wrapper){ 
              await sleep(200); 
              try{ window.print(); } catch(e){} 
              return; 
            }

            const cutGapPx = mmToPx(6); // Updated gap
            const receipts = Array.from(wrapper.querySelectorAll('.receipt-compact'));
            if (receipts.length === 0){ 
              await sleep(200); 
              try{ window.print(); } catch(e){} 
              return; 
            }

            const combinedHeight = receipts.reduce((acc, r) => acc + r.getBoundingClientRect().height, 0) + (receipts.length - 1) * cutGapPx;

            if (!TWO_UP){
              if (combinedHeight <= printablePx){ 
                await sleep(150); 
                try{ window.print(); } catch(e){} 
                return; 
              }
            } else {
              const perReceiptLimit = (printablePx - cutGapPx) / 2;
              const worst = Math.max(...receipts.map(r => r.getBoundingClientRect().height));
              if (worst <= perReceiptLimit){ 
                await sleep(150); 
                try{ window.print(); } catch(e){} 
                return; 
              }
            }

            let targetScale = 1;
            if (!TWO_UP){
              targetScale = Math.min(1, printablePx / combinedHeight);
            } else {
              const worst = Math.max(...receipts.map(r => r.getBoundingClientRect().height));
              const perReceiptLimit = (printablePx - cutGapPx) / 2;
              targetScale = Math.min(1, perReceiptLimit / worst);
            }

            const MIN_SCALE = 0.35; // Slightly higher minimum for better readability
            targetScale = Math.max(MIN_SCALE, targetScale);

            if (targetScale < 0.8){
              try{
                const outer = document.querySelector('.receipt-wrapper');
                if (outer && !outer.classList.contains('force-compact')){
                  outer.classList.add('force-compact');
                  await sleep(100);
                  
                  const receiptsAfterCompact = Array.from(outer.querySelectorAll('.receipt-compact'));
                  const worstAfter = Math.max(...receiptsAfterCompact.map(r => r.getBoundingClientRect().height));
                  const newPerLimit = (printablePx - cutGapPx) / 2;
                  
                  if (!TWO_UP){
                    const combinedAfter = receiptsAfterCompact.reduce((acc, r) => acc + r.getBoundingClientRect().height, 0) + (receiptsAfterCompact.length - 1) * cutGapPx;
                    targetScale = Math.min(1, printablePx / combinedAfter);
                  } else {
                    targetScale = Math.min(1, newPerLimit / worstAfter);
                  }
                  targetScale = Math.max(MIN_SCALE, targetScale);
                }
              } catch(e) { /* ignore */ }
            }

            // Smooth scaling with better progression
            document.body.style.transformOrigin = 'top left';
            const steps = 8;
            for (let i = 0; i < steps; i++){
              const progress = (i + 1) / steps;
              const easeProgress = 1 - Math.pow(1 - progress, 3); // Ease out cubic
              const s = 1 - ((1 - targetScale) * easeProgress);
              document.body.style.transform = 'scale(' + s + ')';
              await sleep(30);
            }

            // Final adjustments for two-up fallback
            const afterWorst = Math.max(...receipts.map(r => r.getBoundingClientRect().height * targetScale));
            if (TWO_UP){
              const perReceiptLimit = (printablePx - cutGapPx) / 2;
              if (afterWorst > perReceiptLimit + 2){
                try{
                  const newWrapper = document.createElement('div');
                  newWrapper.className = 'receipt-wrapper';
                  const content = document.createElement('div');
                  content.className = 'print-content';
                  
                  receipts.forEach((r, idx) => {
                    const c = document.createElement('div');
                    c.className = 'receipt-compact';
                    c.innerHTML = r.innerHTML;
                    content.appendChild(c);
                    if (idx < receipts.length - 1){
                      const br = document.createElement('div');
                      br.style.pageBreakAfter = 'always';
                      content.appendChild(br);
                    }
                  });
                  
                  newWrapper.appendChild(content);
                  document.body.innerHTML = '';
                  document.body.appendChild(newWrapper);
                  document.body.style.transform = '';
                } catch (e) { /* ignore */ }
              }
            }

            await sleep(200);
            try{ window.print(); } catch(e){}
          }

          adjustAndPrint();
        })();
      <\/script>
    `}</body></html>`,g=window.open("","_blank");if(!g)return;g.document.open(),g.document.write(x),g.document.close(),g.focus(),setTimeout(()=>{try{g.print()}catch{}},400)}catch{const i=document.getElementById(e);if(!i)return;const s=window.open("","_blank");if(!s)return;s.document.open(),s.document.write("<html><head><title>"+t+"</title></head><body>"+i.innerHTML+"</body></html>"),s.document.close(),s.print()}}function oX({onClasseSelect:e,onNewClasse:t}){const r=()=>uP("classes-print-area","Liste des classes",!1),{showToast:n}=Jr(),a=fe.getAll("classes"),[i,s]=k.useState(!1),[l,f]=k.useState(a),[d,h]=k.useState(""),[m,x]=k.useState(""),g=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"],y=fe.getAll("enseignants"),v=fe.getAll("eleves"),b=k.useMemo(()=>{let j=[...l];if(d){const C=d.toLowerCase();j=j.filter(P=>P.niveau.toLowerCase().includes(C)||P.section.toLowerCase().includes(C)||P.enseignantPrincipal.toLowerCase().includes(C)||P.salle.toLowerCase().includes(C))}m&&(j=j.filter(C=>C.niveau===m));const T=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];return j.sort((C,P)=>{const M=T.indexOf(C.niveau),D=T.indexOf(P.niveau);return M!==D?M-D:C.section.localeCompare(P.section)})},[a,d,m]),E=j=>{s(!0);const T=v.filter(C=>C.classeId===j.id);if(T.length>0){n(`Impossible de supprimer cette classe car elle contient ${T.length} lve(s).`,"error"),s(!1);return}window.confirm(`tes-vous sr de vouloir supprimer la classe ${j.niveau} ${j.section} ?`)&&(fe.delete("classes",j.id),f(l.filter(C=>C.id!==j.id)),n("Classe supprime avec succs","success")),s(!1)},N=j=>v.filter(T=>T.classeId===j&&T.statut==="Actif").length,S=j=>{const T=y.find(C=>Bt(C)===j||O0(C)===j||`${C.prenoms} ${C.nom}`===j);return T?Bt(T):j};return o.jsxs(dl,{title:"Gestion des Classes",subtitle:`${b.length} classe(s) trouve(s)`,actions:o.jsxs(o.Fragment,{children:[o.jsx(Ft,{variant:"secondary",onClick:r,children:"Aperu & Impression"}),o.jsxs(Ft,{variant:"primary",onClick:t,children:[o.jsx(Vo,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvelle Classe"})]})]}),children:[i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsxs("svg",{className:"animate-spin h-10 w-10 text-teal-600 mb-4",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),o.jsx("span",{className:"text-white text-lg font-semibold",children:"Chargement..."})]})}),o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(sl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher une classe...",value:d,onChange:j=>h(j.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]}),o.jsxs("select",{value:m,onChange:j=>x(j.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Tous les niveaux"}),g.map(j=>o.jsx("option",{value:j,children:j},j))]})]})}),o.jsxs("div",{id:"print-area",className:"hidden print:block bg-white p-4 mb-4 print-compact",children:[o.jsx(Hf,{type:"eleves",libelle:"Liste des classes"}),o.jsx("div",{className:"mb-2 overflow-x-auto",children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px",tableLayout:"fixed"},children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"6%"}}),o.jsx("col",{style:{width:"18%"}}),o.jsx("col",{style:{width:"12%"}}),o.jsx("col",{style:{width:"14%"}}),o.jsx("col",{style:{width:"24%"}}),o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"16%"}})]}),o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"border px-2 py-1",children:"N"}),o.jsx("th",{className:"border px-2 py-1",children:"Niveau"}),o.jsx("th",{className:"border px-2 py-1",children:"Section"}),o.jsx("th",{className:"border px-2 py-1",children:"Anne scolaire"}),o.jsx("th",{className:"border px-2 py-1",children:"Enseignant principal"}),o.jsx("th",{className:"border px-2 py-1",children:"Effectif max"}),o.jsx("th",{className:"border px-2 py-1",children:"Effectif actuel"})]})})]})}),o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px",tableLayout:"fixed"},children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"6%"}}),o.jsx("col",{style:{width:"18%"}}),o.jsx("col",{style:{width:"12%"}}),o.jsx("col",{style:{width:"14%"}}),o.jsx("col",{style:{width:"24%"}}),o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"16%"}})]}),o.jsx("tbody",{children:b.map((j,T)=>o.jsxs("tr",{children:[o.jsx("td",{children:T+1}),o.jsx("td",{children:j.niveau}),o.jsx("td",{children:j.section}),o.jsx("td",{children:j.anneeScolaire}),o.jsx("td",{children:S(j.enseignantPrincipal)}),o.jsx("td",{children:j.effectifMax}),o.jsx("td",{children:N(j.id)})]},j.id))})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(j=>{const T=N(j.id),C=T/j.effectifMax*100;return o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:[j.niveau," ",j.section]}),o.jsx("p",{className:"text-sm text-gray-500",children:j.anneeScolaire})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(Ft,{variant:"ghost",className:"p-2",onClick:()=>e(j),title:"Modifier",children:o.jsx(Ho,{className:"h-4 w-4"})}),o.jsx(Ft,{variant:"danger",className:"p-2",onClick:()=>E(j),title:"Supprimer",children:o.jsx(Ws,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Qi,{className:"h-4 w-4 text-gray-400"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Enseignant: ",S(j.enseignantPrincipal)]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Yi,{className:"h-4 w-4 text-gray-400"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Salle: ",j.salle]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-1",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Effectif"}),o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[T,"/",j.effectifMax]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded h-2",children:o.jsx("div",{className:`h-2 rounded ${C>=90?"bg-red-500":C>=75?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.min(C,100)}%`}})}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[C.toFixed(0),"% de remplissage"]})]}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[j.matieres.length," matire(s)"]}),o.jsxs("div",{className:"flex flex-wrap gap-1",children:[j.matieres.slice(0,3).map(P=>o.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:P.nom},P.id)),j.matieres.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs rounded",children:["+",j.matieres.length-3]})]})]})]})]},j.id)})}),b.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("p",{className:"text-gray-500",children:"Aucune classe trouve"}),o.jsx(Ft,{variant:"primary",onClick:t,className:"mt-4",children:"Crer une classe"})]})]})}function lX({classe:e,onSave:t,onCancel:r}){const[n,a]=k.useState({niveau:"CP1",section:"A",anneeScolaire:new Date().getFullYear()+"-"+(new Date().getFullYear()+1),enseignantPrincipal:"",effectifMax:35,salle:""}),{showToast:i}=Jr(),[s,l]=k.useState([]),[f,d]=k.useState({}),[h,m]=k.useState(!1),x=fe.getAll("matieres"),g=fe.getAll("enseignants");k.useEffect(()=>{e&&(a({niveau:e.niveau,section:e.section,anneeScolaire:e.anneeScolaire,enseignantPrincipal:e.enseignantPrincipal,effectifMax:e.effectifMax,salle:e.salle}),l(e.matieres))},[e]);const y=()=>{const S={};return n.niveau||(S.niveau="Le niveau est obligatoire"),n.section.trim()||(S.section="La section est obligatoire"),n.anneeScolaire.trim()||(S.anneeScolaire="L'anne scolaire est obligatoire"),n.enseignantPrincipal.trim()||(S.enseignantPrincipal="L'enseignant principal est obligatoire"),(n.effectifMax<1||n.effectifMax>50)&&(S.effectifMax="L'effectif maximum doit tre entre 1 et 50"),n.salle.trim()||(S.salle="La salle est obligatoire"),s.length===0&&(S.matieres="Au moins une matire doit tre slectionne"),fe.getAll("classes").find(C=>C.niveau===n.niveau&&C.section===n.section&&C.anneeScolaire===n.anneeScolaire&&C.id!==e?.id)&&(S.section="Cette classe existe dj pour cette anne scolaire"),d(S),Object.keys(S).length===0},v=async S=>{if(S.preventDefault(),!!y()){m(!0);try{const j=new Date().toISOString(),T={...n,matieres:s,updatedAt:j,...e?{}:{createdAt:j}};if(e){const C=fe.update("classes",e.id,T);C&&(i("Classe mise  jour avec succs","success"),t(C))}else{const C=fe.create("classes",T);i("Classe ajoute avec succs","success"),t(C)}}catch{i("Erreur lors de la sauvegarde de la classe","error")}finally{m(!1)}}},b=(S,j)=>{a(T=>({...T,[S]:j})),f[S]&&d(T=>({...T,[S]:""}))},E=S=>{l(j=>j.find(C=>C.id===S.id)?j.filter(C=>C.id!==S.id):[...j,S]),f.matieres&&d(j=>({...j,matieres:""}))},N=S=>x.filter(j=>j.type===S);return o.jsx("div",{className:"p-6 max-w-5xl mx-auto",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Modifier la classe":"Nouvelle classe"}),o.jsx("p",{className:"text-gray-600 mt-1",children:e?"Modifiez les informations de la classe":"Crez une nouvelle classe"})]}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",children:o.jsx(eo,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de base"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Niveau ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:n.niveau,onChange:S=>b("niveau",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.niveau?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,children:[o.jsx("option",{value:"Petite Section",children:"Petite Section"}),o.jsx("option",{value:"Moyenne Section",children:"Moyenne Section"}),o.jsx("option",{value:"Grande Section",children:"Grande Section"}),o.jsx("option",{value:"CP1",children:"CP1"}),o.jsx("option",{value:"CP2",children:"CP2"}),o.jsx("option",{value:"CE1",children:"CE1"}),o.jsx("option",{value:"CE2",children:"CE2"}),o.jsx("option",{value:"CM1",children:"CM1"}),o.jsx("option",{value:"CM2",children:"CM2"})]}),f.niveau&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.niveau]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Section ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.section,onChange:S=>b("section",S.target.value.toUpperCase()),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.section?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"A, B, C...",maxLength:2}),f.section&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.section]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Anne scolaire ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.anneeScolaire,onChange:S=>b("anneeScolaire",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.anneeScolaire?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"2025-2026"}),f.anneeScolaire&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.anneeScolaire]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gestion et organisation"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Enseignant principal ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:n.enseignantPrincipal,onChange:S=>b("enseignantPrincipal",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.enseignantPrincipal?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,children:[o.jsx("option",{value:"",children:"Slectionner un enseignant"}),g.filter(S=>S.statut==="Actif").map(S=>o.jsx("option",{value:Bt(S),children:Bt(S)},S.id))]}),f.enseignantPrincipal&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.enseignantPrincipal]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Effectif maximum ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",value:n.effectifMax,onChange:S=>b("effectifMax",parseInt(S.target.value)),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.effectifMax?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,min:"1",max:"50"}),f.effectifMax&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.effectifMax]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Salle de classe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:n.salle,onChange:S=>b("salle",S.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${f.salle?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,placeholder:"Ex: Salle 1, Salle A..."}),f.salle&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),f.salle]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Matires enseignes ",o.jsx("span",{className:"text-red-500",children:"*"})]}),f.matieres&&o.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:o.jsxs("p",{className:"text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-2",children:""}),f.matieres]})}),o.jsx("div",{className:"space-y-8",children:["Fondamentale","veil","Expression"].map(S=>o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:S}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N(S).map(j=>{const T=s.find(C=>C.id===j.id);return o.jsxs("label",{className:`flex items-center p-3 border rounded-md cursor-pointer transition-all ${T?"border-gray-900 bg-gray-50":"border-gray-300 hover:border-gray-400 bg-white"}`,children:[o.jsx("input",{type:"checkbox",checked:!!T,onChange:()=>E(j),className:"sr-only"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-gray-900",children:j.nom}),o.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Coefficient: ",j.coefficient,j.obligatoire&&o.jsx("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 text-gray-700 text-xs rounded",children:"Obligatoire"})]})]}),T&&o.jsx("div",{className:"w-6 h-6 bg-gray-900 rounded-full flex items-center justify-center ml-3",children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},j.id)})})]},S))}),o.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-md border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[s.length," matire(s) slectionne(s)"]}),o.jsxs("p",{className:"text-gray-700 mt-1",children:["Coefficient total: ",s.reduce((S,j)=>S+j.coefficient,0)]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.length}),o.jsx("p",{className:"text-gray-600 text-sm",children:"matires"})]})]})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors font-medium",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 focus:ring-2 focus:ring-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:h,children:[h?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Zs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:e?h?"Sauvegarde...":"Mettre  jour la classe":h?"Sauvegarde...":"Crer la classe"})]})]})]})]})})}function cX({onMatiereSelect:e,onNewMatiere:t}){const{showToast:r}=Jr(),[n,a]=k.useState(!1),[i,s]=k.useState(""),[l,f]=k.useState(""),d=fe.getAll("matieres"),h=fe.getAll("classes"),[m,x]=k.useState(d),g=k.useMemo(()=>{let E=[...m];if(i){const N=i.toLowerCase();E=E.filter(S=>S.nom.toLowerCase().includes(N)||S.type.toLowerCase().includes(N))}return l&&(E=E.filter(N=>N.type===l)),E.sort((N,S)=>N.nom.localeCompare(S.nom))},[m,i,l]),y=E=>{a(!0);const N=h.filter(S=>S.matieres.some(j=>j.id===E.id));if(N.length>0){r(`Impossible de supprimer cette matire car elle est utilise dans ${N.length} classe(s).`,"error"),a(!1);return}window.confirm(`tes-vous sr de vouloir supprimer la matire "${E.nom}" ?`)&&(fe.delete("matieres",E.id),x(m.filter(S=>S.id!==E.id)),r("Matire supprime avec succs","success")),a(!1)},v=E=>{switch(E){case"Fondamentale":return"bg-blue-100 text-blue-800";case"veil":return"bg-green-100 text-green-800";case"Expression":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},b=E=>h.filter(N=>N.matieres.some(S=>S.id===E));return o.jsxs(dl,{title:"Gestion des Matires",subtitle:`${g.length} matire(s) trouve(s)`,actions:o.jsx(o.Fragment,{children:o.jsxs(Ft,{variant:"primary",onClick:t,children:[o.jsx(Vo,{className:"h-4 w-4"}),o.jsx("span",{children:"Nouvelle Matire"})]})}),children:[n&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsxs("svg",{className:"animate-spin h-10 w-10 text-teal-600 mb-4",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),o.jsx("span",{className:"text-white text-lg font-semibold",children:"Chargement..."})]})}),o.jsx("div",{className:"bg-white p-4 rounded-md border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(sl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher une matire...",value:i,onChange:E=>s(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]}),o.jsxs("select",{value:l,onChange:E=>f(E.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500",children:[o.jsx("option",{value:"",children:"Tous les types"}),o.jsx("option",{value:"Fondamentale",children:"Fondamentale"}),o.jsx("option",{value:"veil",children:"veil"}),o.jsx("option",{value:"Expression",children:"Expression"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(E=>{const N=b(E.id);return o.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Yi,{className:"h-4 w-4 text-gray-600"}),o.jsx("h3",{className:"text-base font-semibold text-gray-900",children:E.nom})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(Ft,{variant:"ghost",className:"p-2",onClick:()=>e(E),title:"Modifier",children:o.jsx(Ho,{className:"h-4 w-4"})}),o.jsx(Ft,{variant:"danger",className:"p-2",onClick:()=>y(E),title:"Supprimer",children:o.jsx(Ws,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${v(E.type)}`,children:E.type}),E.obligatoire&&o.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Obligatoire"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Coefficient:"}),o.jsx("span",{className:"text-lg font-bold text-gray-900",children:E.coefficient})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Abrviation:"}),o.jsx("span",{className:"text-sm font-bold text-gray-900 bg-gray-100 px-2 py-1 rounded",children:E.abreviation})]}),o.jsxs("div",{children:[o.jsxs("span",{className:"text-sm text-gray-600",children:["Utilise dans ",N.length," classe(s)"]}),N.length>0&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[N.slice(0,3).map(S=>o.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded",children:[S.niveau," ",S.section]},S.id)),N.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs rounded",children:["+",N.length-3]})]})]}),o.jsx("div",{className:"pt-2 border-t border-gray-100",children:o.jsxs("p",{className:"text-xs text-gray-500",children:["Cre le ",new Date(E.createdAt).toLocaleDateString("fr-FR")]})})]})]},E.id)})}),g.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Yi,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucune matire trouve"}),o.jsx(Ft,{variant:"primary",onClick:t,className:"mt-4",children:"Crer votre premire matire"})]})]})}function uX({matiere:e,onSave:t,onCancel:r}){const{showToast:n}=Jr(),[a,i]=k.useState({nom:"",abreviation:"",coefficient:1,type:"Fondamentale",obligatoire:!0,classeIds:[],baremeParNiveau:{}}),[s,l]=k.useState({}),[f,d]=k.useState(!1),[h,m]=k.useState("CP1"),[x,g]=k.useState(!0),y=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"],v=D=>{if(!D||D.trim()==="")return"";const W=D.trim(),F={mathmatiques:"MATH",franais:"FR",anglais:"ANG",lecture:"LECT",criture:"ECR",dicte:"DICT",calcul:"CALC",gomtrie:"GEO",sciences:"SCI",histoire:"HIST",gographie:"GEO",informatique:"INFO",dessin:"DESS",musique:"MUS",sport:"SPORT","ducation physique":"EPS","ducation physique et sportive":"EPS","arts plastiques":"ART","expression crite":"EE","expression orale":"EO",rcitation:"REC",posie:"POE",grammaire:"GRA",conjugaison:"CONJ",orthographe:"ORTH",vocabulaire:"VOC","sciences naturelles":"SN","sciences physiques":"SP","sciences et vie de la terre":"SVT",technologie:"TECH","ducation civique":"EC","ducation morale":"EM","ducation religieuse":"ER"},L=W.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");for(const[he,le]of Object.entries(F)){const de=he.normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(L===de)return le}if(W.includes(" et ")||W.includes(" & ")){const he=W.split(/\s+(?:et|&)\s+/).flatMap(le=>le.split(" ")).filter(le=>le.length>2);if(he.length>=2)return he.map(le=>le[0].toUpperCase()).join("").slice(0,4)}const J=W.split(" ").filter(he=>he.length>2);if(J.length>=2)return J.map(he=>he[0].toUpperCase()).join("").slice(0,4);const se=W.replace(/[^a-zA-Z-]/g,"");if(se.length<=4)return se.toUpperCase();const Z=se.match(/[bcdfghjklmnpqrstvwxyzBCDFGHJKLMNPQRSTVWXYZ]/g)||[];return se.match(/[aeiouyAEIOUY]/g),Z.length>=3?Z.slice(0,4).join("").toUpperCase():se.slice(0,4).toUpperCase()};k.useEffect(()=>{if(e){const D={nom:e.nom,abreviation:e.abreviation,coefficient:e.coefficient,type:e.type,obligatoire:e.obligatoire,classeIds:e.classeIds||[],baremeParNiveau:e.baremeParNiveau||{}};i(D),b.current=D,g(!1)}},[e]);const b=k.useRef({}),E=k.useMemo(()=>{try{return JSON.stringify(b.current||{})!==JSON.stringify(a||{})}catch{return!1}},[a]),N=Nm(E),S=`matiere:${e?.id||"new"}`,{load:j,clear:T}=Em(S,a);k.useEffect(()=>{try{const D=j();D&&(i(W=>({...W,...D})),b.current=JSON.parse(JSON.stringify(D||{})))}catch{}},[]);const C=()=>{const D={};a.nom.trim()||(D.nom="Le nom de la matire est obligatoire"),a.abreviation.trim()||(D.abreviation="L'abrviation est obligatoire"),(a.coefficient<1||a.coefficient>10)&&(D.coefficient="Le coefficient doit tre entre 1 et 10");const W=fe.getAll("matieres");return W.find(J=>{const se=(J.nom||"").toString().toLowerCase(),Z=(a.nom||"").toString().toLowerCase();return se===Z&&J.id!==e?.id})&&(D.nom="Une matire avec ce nom existe dj"),W.find(J=>{const se=(J.abreviation||"").toString().toLowerCase(),Z=(a.abreviation||"").toString().toLowerCase();return se===Z&&J.id!==e?.id})&&(D.abreviation="Une matire avec cette abrviation existe dj"),l(D),Object.keys(D).length===0},P=async D=>{if(D.preventDefault(),!!C()){d(!0);try{if(e){const W=fe.update("matieres",e.id,a);if(W){n("Matire mise  jour avec succs","success"),t(W);try{T()}catch{}b.current=JSON.parse(JSON.stringify(a||{}))}}else{const W=new Date().toISOString(),F={...a,updatedAt:W},L=fe.create("matieres",F);n("Matire ajoute avec succs","success"),t(L);try{T()}catch{}b.current=JSON.parse(JSON.stringify(a||{}))}}catch{n("Erreur lors de la sauvegarde de la matire","error")}finally{d(!1)}}},M=(D,W)=>{if(i(F=>({...F,[D]:W})),D==="nom"&&x&&typeof W=="string"){const F=v(W);i(L=>({...L,abreviation:F}))}s[D]&&l(F=>({...F,[D]:""}))};return o.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Modifier la matire":"Nouvelle matire"}),o.jsx("p",{className:"text-gray-600 mt-1",children:e?"Modifiez les informations de la matire":"Crez une nouvelle matire"})]}),o.jsx("button",{onClick:()=>E&&N?N.openPrompt():r(),className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",children:o.jsx(eo,{className:"h-6 w-6"})})]})}),o.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de base"}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom de la matire ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:a.nom,onChange:D=>M("nom",D.target.value),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-blue-500 transition-colors ${s.nom?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ex: Mathmatiques, Franais, Sciences..."}),s.nom&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.nom]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Abrviation ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("label",{className:"flex items-center text-sm text-gray-600 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:x,onChange:D=>{g(D.target.checked),D.target.checked&&a.nom&&M("abreviation",v(a.nom))},className:"mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Auto-gnrer"]})]}),o.jsx("input",{type:"text",value:a.abreviation,onChange:D=>{g(!1),M("abreviation",D.target.value.toUpperCase())},className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-blue-500 transition-colors ${s.abreviation?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ex: MATH, FR, SCI...",maxLength:10}),s.abreviation&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.abreviation]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:x?" Abrviation gnre automatiquement  partir du nom":"Abrviation utilise dans les bulletins (max 10 caractres)"})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configuration avance"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Type de matire ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("div",{className:"space-y-3",children:[{value:"Fondamentale",label:"Fondamentale",desc:"Matires principales (Franais, Maths...)"},{value:"veil",label:"veil",desc:"Matires d'veil (Sciences, Histoire...)"},{value:"Expression",label:"Expression",desc:"Matires d'expression (Arts, Sport...)"}].map(D=>o.jsxs("label",{className:`flex items-center p-4 border rounded-md cursor-pointer transition-all ${a.type===D.value?"border-gray-900 bg-gray-50":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"type",value:D.value,checked:a.type===D.value,onChange:W=>M("type",W.target.value),className:"sr-only"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-gray-900",children:D.label}),o.jsx("div",{className:"text-sm text-gray-600 mt-1",children:D.desc})]}),a.type===D.value&&o.jsx("div",{className:"w-6 h-6 bg-gray-900 rounded-full flex items-center justify-center ml-3",children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},D.value))})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Coefficient ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"number",value:a.coefficient,onChange:D=>M("coefficient",parseInt(D.target.value)),className:`w-full px-4 py-3 border rounded-md focus:ring-2 focus:ring-gray-500 transition-colors ${s.coefficient?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-300 focus:border-gray-500"}`,min:"1",max:"100"}),s.coefficient&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[o.jsx("span",{className:"mr-1",children:""}),s.coefficient]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Poids de la matire dans le calcul de la moyenne (1-100)"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:a.obligatoire,onChange:D=>M("obligatoire",D.target.checked),className:"w-4 h-4 text-gray-900 border border-gray-300 rounded focus:ring-gray-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Matire obligatoire"})]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500 ml-8",children:"Les matires obligatoires doivent tre enseignes dans toutes les classes du niveau correspondant"})]})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configuration des barmes par niveau"}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:y.map(D=>o.jsx("button",{type:"button",onClick:()=>m(D),className:`px-3 py-2 rounded-md text-sm font-medium transition-all ${h===D?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:D},D))}),o.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[o.jsxs("h4",{className:"font-semibold text-gray-900 mb-4",children:["Barme pour ",h]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Note minimale"}),o.jsx("input",{type:"number",min:"0",value:a.baremeParNiveau[h]?.min||0,onChange:D=>{const W={...a.baremeParNiveau,[h]:{...a.baremeParNiveau[h],min:Number(D.target.value)}};M("baremeParNiveau",W)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Note maximale"}),o.jsx("input",{type:"number",min:"1",value:a.baremeParNiveau[h]?.max||20,onChange:D=>{const W={...a.baremeParNiveau,[h]:{...a.baremeParNiveau[h],max:Number(D.target.value)}};M("baremeParNiveau",W)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors"})]})]}),o.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-md",children:[o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsxs("strong",{children:["Exemple pour ",h,":"]}),h==="CE2"?" Mathmatiques /50, Orthographe /20":" Notes gnralement /20"]}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Les notes seront automatiquement converties pour le calcul des moyennes"})]})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Aperu des barmes configurs"}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:y.map(D=>{const W=a.baremeParNiveau[D];return o.jsxs("div",{className:"bg-white rounded-md p-3 border border-gray-200",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:D}),o.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["/",W?.max||20]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["Min: ",W?.min||0]})]},D)})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:()=>E&&N?N.openPrompt():r(),className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors font-medium",children:"Annuler"}),o.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 focus:ring-2 focus:ring-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:[f?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsx(Zs,{className:"h-5 w-5"}),o.jsx("span",{className:"font-medium",children:e?f?"Sauvegarde...":"Mettre  jour la matire":f?"Sauvegarde...":"Crer la matire"})]})]})]})]}),N&&o.jsx(kf,{open:N.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardes. Voulez-vous quitter sans enregistrer ?",onConfirm:()=>{try{T()}catch{}N.allowNavigation?N.allowNavigation():r()},onCancel:()=>N.closePrompt&&N.closePrompt()})]})}function fX(){const{showToast:e}=Jr(),[t,r]=k.useState(""),[n,a]=k.useState(""),[i,s]=k.useState({}),[l,f]=k.useState(!1),[d,h]=k.useState(20),m=k.useMemo(()=>fe.getAll("classes"),[]),x=k.useMemo(()=>fe.getAll("compositions"),[]),g=k.useMemo(()=>fe.getAll("notes"),[]),y=m.find(K=>K.id===t),v=k.useMemo(()=>fe.getAll("eleves").filter(K=>K.classeId===t&&K.statut==="Actif").sort((K,ie)=>K.nom.localeCompare(ie.nom)),[t]),b=k.useMemo(()=>y?x.filter(K=>!K.niveau||K.niveau===y.niveau).sort((K,ie)=>K.ordre-ie.ordre):x,[y,x]),E=k.useMemo(()=>fe.getAll("matieres"),[]),N=k.useRef({}),S=k.useMemo(()=>y?(y.matieres||[]).map(B=>{if(typeof B=="string")return E.find(je=>je.id===B)||{id:B,nom:B,abreviation:B,coefficient:1,type:"Fondamentale",baremeParNiveau:{}};if(B&&typeof B=="object"&&B.abreviation)return B;const z=B&&B.id||null,G=B&&B.nom||null;let ce=null;if(z&&(ce=E.find(Ae=>Ae.id===z)||null),!ce&&G&&(ce=E.find(Ae=>Ae.nom===G)||null),ce)return ce;const I=B&&B.abreviation||(G?String(G).slice(0,3).toUpperCase():"");return{id:z||B&&B.id||Math.random().toString(36).slice(2,9),nom:G||B&&B.nom||"Matire",abreviation:I,coefficient:B&&B.coefficient||1,type:B&&B.type||"Fondamentale",baremeParNiveau:B&&B.baremeParNiveau||{}}}).sort((B,z)=>B.nom.localeCompare(z.nom)):[],[y,E]);k.useEffect(()=>{if(!n||!t)return;const K={};v.forEach(ie=>{K[ie.id]={},S.forEach(B=>{const z=g.find(G=>G.eleveId===ie.id&&G.matiereId===B.id&&G.compositionId===n&&G.classeId===t);z&&(K[ie.id][B.id]=z.valeur)})}),s(ie=>{try{const B=JSON.stringify(ie||{}),z=JSON.stringify(K||{});if(B===z)return ie}catch{}return K});try{N.current=JSON.parse(JSON.stringify(K||{}))}catch{N.current=K||{}}},[n,t,v,S,g]);const j=k.useMemo(()=>{try{return JSON.stringify(N.current||{})!==JSON.stringify(i||{})}catch{return!1}},[i]),T=Nm(j),C=`notes:${t}:${n}`,{load:P,clear:M}=Em(C,i);k.useEffect(()=>{if(!(!t||!n))try{const K=P();K&&s(ie=>({...ie,...K}))}catch{}},[t,n]),k.useEffect(()=>{},[i]),k.useEffect(()=>{const K=()=>{!t&&m.length>0&&r(m[0].id),!n&&b.length>0&&a(b[0].id)};return window.addEventListener("open-notes-entry",K),()=>window.removeEventListener("open-notes-entry",K)},[t,n,m,b]);const D=(K,ie,B)=>{const z=S.find(I=>I.id===ie),G=z&&y?W(z,y.niveau):20;let ce=Number.isFinite(Number(B))?Number(B):0;ce<0&&(ce=0),ce>G&&(ce=G),s(I=>({...I,[K]:{...I[K],[ie]:ce}}))},W=(K,ie)=>K.baremeParNiveau?.[ie]?.max||20,F=K=>i[K]?S.reduce((ie,B)=>{const z=i[K][B.id]||0;return ie+z},0):0,L=K=>{if(!i[K]||!y)return 0;let ie=0,B=0;return S.forEach(z=>{const G=i[K][z.id]||0,ce=W(z,y.niveau),I=d===20?G/ce*20:G/ce*10;ie+=I*z.coefficient,B+=d*z.coefficient}),B>0?ie/B*d:0},J=()=>{const K=v.map(I=>({eleveId:I.id,moyenne:L(I.id)})),ie={};K.forEach(I=>{ie[I.eleveId]=I.moyenne});const B=K.filter(I=>I.moyenne>0);B.sort((I,Ae)=>Ae.moyenne-I.moyenne);const z={};let G=Number.NaN,ce=0;for(let I=0;I<B.length;I++){const Ae=B[I];if(!Number.isNaN(G)&&Math.abs(Ae.moyenne-G)<1e-9)z[Ae.eleveId]=ce;else{const je=I+1;z[Ae.eleveId]=je,ce=je,G=Ae.moyenne}}return{moyennesMap:ie,ranksMap:z,sortedByRank:B}},{moyennesMap:se,ranksMap:Z,sortedByRank:he}=k.useMemo(()=>J(),[v,S,i,d,n,t]),[le,de]=k.useState("nom"),Q=k.useMemo(()=>{if(le==="nom")return[...v].sort((z,G)=>z.nom.localeCompare(G.nom));const K=he.map(z=>z.eleveId),ie=K.map(z=>v.find(G=>G.id===z)).filter(Boolean),B=v.filter(z=>!K.includes(z.id)).sort((z,G)=>z.nom.localeCompare(G.nom));return[...ie,...B]},[le,v,he]),pe=async()=>{if(!n||!t){e("Slectionnez une classe et une composition","error");return}f(!0);try{Object.entries(i).forEach(([K,ie])=>{Object.entries(ie).forEach(([B,z])=>{if(z>=0){const G=S.find(Le=>Le.id===B);if(!G||!y)return;let ce=W(G,y.niveau),I=Number(z)||0;I<0&&(I=0),I>ce&&(I=ce);const Ae=g.find(Le=>Le.eleveId===K&&Le.matiereId===B&&Le.compositionId===n&&Le.classeId===t),je={eleveId:K,matiereId:B,compositionId:n,classeId:t,valeur:I,bareme:ce,date:new Date().toISOString()};Ae?fe.update("notes",Ae.id,je):fe.create("notes",je)}})}),Object.keys(se).forEach(K=>{const ie=se[K],B=Z[K]||0;if(ie>0){const z=fe.getAll("moyennesGenerales").find(ce=>ce.eleveId===K&&ce.compositionId===n&&ce.classeId===t),G={eleveId:K,classeId:t,compositionId:n,moyenne:ie,rang:B,dateCalcul:new Date().toISOString()};z?fe.update("moyennesGenerales",z.id,G):fe.create("moyennesGenerales",G)}}),e("Notes enregistres avec succs","success");try{N.current=JSON.parse(JSON.stringify(i||{}))}catch{N.current=i||{}}try{M()}catch{}}catch(K){console.error(K),e("Erreur lors de l'enregistrement des notes","error")}finally{f(!1)}},re=()=>{try{M()}catch{}T&&T.allowNavigation&&T.allowNavigation()},O=()=>{T&&T.closePrompt&&T.closePrompt()},V=()=>y?S.reduce((K,ie)=>K+W(ie,y.niveau),0):0,H=()=>{if(!y)return 1;const K=V();return d===20?K/20:K/10},q=()=>{if(!y||!n||Q.length===0){e("Aucune donne  imprimer","error");return}const K=Q.map((ce,I)=>{const Ae=F(ce.id),je=se[ce.id]||0,Le=Z[ce.id]||0,Ue=S.map(Pe=>`<td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #f9f9f9;">${i[ce.id]?.[Pe.id]||""}</td>`).join(`
`);return`
        <tr>
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #f9f9f9;">${I+1}</td>
          <td style="border: 1px solid #333; padding: 8px; text-align: left; background-color: #f9f9f9;">${Bt(ce)}</td>
          ${Ue}
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #e6ffe6; font-weight: bold;">${Ae.toFixed(1)}</td>
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #ffe6e6; font-weight: bold;">${je.toFixed(2)}</td>
          <td style="border: 1px solid #333; padding: 8px; text-align: center; background-color: #f9f9f9; font-weight: bold;">${Le>0?Le:""}</td>
        </tr>
      `}).join(`
`),ie=S.map(ce=>`<th style="border: 2px solid #333; padding: 10px; text-align: center; background-color: #4a5568; color: white; font-weight: bold; font-size: 13px;">${ce.abreviation}</th>`).join(`
`),B=x.find(ce=>ce.id===n)?.nom||"Composition",z=`
      <html>
        <head>
          <title>Rsultats de Composition - ${y.niveau} ${y.section}</title>
          <style>
            body {
              font-family: 'Times New Roman', Times, serif;
              font-size: 12px;
              color: #000;
              padding: 15mm;
              line-height: 1.4;
            }
            h2 {
              text-align: center;
              margin-bottom: 20px;
              font-size: 18px;
              font-weight: bold;
            }
            .header-info {
              text-align: center;
              margin-bottom: 30px;
              font-size: 14px;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              margin-bottom: 20px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            th {
              border: 2px solid #333;
              padding: 10px;
              text-align: center;
              background-color: #4a5568;
              color: white;
              font-weight: bold;
              font-size: 13px;
            }
            td {
              border: 1px solid #333;
              padding: 8px;
            }
            .signature {
              text-align: right;
              margin-top: 50px;
              font-weight: bold;
              font-size: 14px;
            }
            @media print {
              body { margin: 0; }
              .signature { page-break-inside: avoid; }
            }
          </style>
        </head>
        <body>
          <h2>Rsultats de Composition</h2>
          <div class="header-info">
            <strong>Classe:</strong> ${y.niveau} ${y.section}<br>
            <strong>Composition:</strong> ${B}<br>
            <strong>Base de moyenne:</strong> /${d}
          </div>
          <table>
            <thead>
              <tr>
                <th>N</th>
                <th>Noms et Prnoms</th>
                ${ie}
                <th>Total</th>
                <th>Moyenne</th>
                <th>Rang</th>
              </tr>
            </thead>
            <tbody>
              ${K}
            </tbody>
          </table>
          <div class="signature">Signature</div>
        </body>
      </html>
    `,G=window.open("","_blank","width=800,height=600");if(!G){e("Impossible d'ouvrir la fentre d'impression","error");return}G.document.open(),G.document.write(z),G.document.close(),G.focus(),setTimeout(()=>{G.print(),G.onafterprint=()=>G.close()},500)};return o.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-white border border-gray-200 p-6 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Notes par Classe"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Saisie et calcul des moyennes selon le systme ivoirien"})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Base de calcul"}),o.jsxs("div",{className:"flex space-x-2 mt-2",children:[o.jsx("button",{onClick:()=>h(10),className:`px-3 py-2 rounded-md font-medium transition-all ${d===10?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"/10"}),o.jsx("button",{onClick:()=>h(20),className:`px-3 py-2 rounded-md font-medium transition-all ${d===20?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"/20"})]})]})]})}),o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Trier par :"}),o.jsx("button",{onClick:()=>de("nom"),className:`px-3 py-1 rounded ${le==="nom"?"bg-gray-900 text-white":"bg-gray-100"}`,children:"Nom"}),o.jsx("button",{onClick:()=>de("rang"),className:`px-3 py-1 rounded ${le==="rang"?"bg-gray-900 text-white":"bg-gray-100"}`,children:"Rang"})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Slection des paramtres"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Classe"}),o.jsxs("select",{value:t,onChange:K=>{r(K.target.value),a(""),s({})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"Slectionner une classe"}),m.map(K=>{const ie=fe.getAll("eleves").filter(B=>B.classeId===K.id&&B.statut==="Actif").length;return o.jsxs("option",{value:K.id,children:[K.niveau," ",K.section," (",ie," lves)"]},K.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Composition"}),o.jsxs("select",{value:n,onChange:K=>{a(K.target.value),s({})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",disabled:!t,children:[o.jsx("option",{value:"",children:"Slectionner une composition"}),b.map(K=>o.jsxs("option",{value:K.id,children:[K.nom," (coeff. ",K.coefficient,")"]},K.id))]})]}),o.jsx("div",{className:"flex items-end",children:o.jsxs("button",{onClick:pe,disabled:l||!n||!t,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition-colors disabled:opacity-50",children:[l?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(Zs,{className:"h-4 w-4"}),o.jsx("span",{children:l?"Sauvegarde...":"Enregistrer"})]})})]})]}),t&&n&&S.length>0&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Saisie des notes - ",y?.niveau," ",y?.section]}),o.jsxs("p",{className:"text-gray-600 text-sm",children:[x.find(K=>K.id===n)?.nom,"  Total /",V(),"  Moyenne /",d]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Notes compltes"}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[Object.keys(i).filter(K=>{const ie=i[K]||{};return S.every(B=>ie[B.id]!==void 0)}).length,"/",v.length]})]}),o.jsxs("button",{onClick:q,className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm shadow hover:bg-indigo-700 flex items-center space-x-2",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"inline-block",children:[o.jsx("path",{d:"M6 9V2h12v7",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("rect",{x:"6",y:"13",width:"12",height:"9",rx:"1",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("span",{children:"Imprimer"})]})]})]})}),o.jsx("div",{className:"p-6 overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-semibold text-gray-900 min-w-[60px]",children:"N"}),o.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-semibold text-gray-900 min-w-[200px]",children:"Noms et Prnoms"}),S.map(K=>o.jsx("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[80px]",children:o.jsx("div",{children:K.abreviation})},K.id)),o.jsxs("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[80px]",children:[o.jsx("div",{children:"Total"}),o.jsxs("div",{className:"text-xs text-gray-500 font-normal",children:["/",V()]})]}),o.jsxs("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[80px]",children:[o.jsx("div",{children:"Moy"}),o.jsxs("div",{className:"text-xs text-gray-500 font-normal",children:["/",d]})]}),o.jsx("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-900 min-w-[60px]",children:"Rang"})]})}),o.jsx("tbody",{children:Q.map((K,ie)=>{const B=F(K.id),z=se[K.id]||0,G=Z[K.id]||0;return o.jsxs("tr",{className:ie%2===0?"bg-white":"bg-gray-50",children:[o.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm font-medium text-gray-900",children:ie+1}),o.jsx("td",{className:"border border-gray-300 px-3 py-2",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[K.photo&&o.jsx("img",{src:K.photo,alt:`${K.prenoms} ${K.nom}`,className:"h-6 w-6 rounded-full object-cover"}),o.jsx("div",{className:"text-sm font-medium text-gray-900",children:Bt(K)})]})}),S.map(ce=>{const I=W(ce,y?.niveau||""),Ae=i[K.id]?.[ce.id]||"";return o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:o.jsx("input",{type:"number",min:"0",max:I,step:"0.5",value:Ae,onChange:je=>D(K.id,ce.id,Number(je.target.value)),className:"w-full px-2 py-1 border border-gray-300 rounded text-center font-bold focus:ring-2 focus:ring-gray-500 focus:border-gray-500",placeholder:"0"})},ce.id)}),o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:o.jsx("div",{className:"font-bold text-blue-600",children:B.toFixed(1)})}),o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:o.jsx("div",{className:`font-bold ${z>=d*.5?"text-green-600":"text-red-600"}`,children:z.toFixed(2)})}),o.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:G>0&&o.jsxs("div",{className:`font-bold ${G===1?"text-yellow-600":G<=3?"text-green-600":"text-gray-600"}`,children:[G,G===1&&o.jsx(O5,{className:"inline h-3 w-3 ml-1"})]})})]},K.id)})})]})}),v.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Qi,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucun lve dans cette classe"})]})]}),t&&y&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations sur le calcul des moyennes"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx(P5,{className:"h-6 w-6 text-gray-600 mx-auto mb-2"}),o.jsx("div",{className:"text-xl font-bold text-gray-900",children:V()}),o.jsx("p",{className:"text-gray-700 font-medium",children:"Total maximum"}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Somme des barmes de toutes les matires"})]})}),o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx(w5,{className:"h-6 w-6 text-gray-600 mx-auto mb-2"}),o.jsx("div",{className:"text-xl font-bold text-gray-900",children:H().toFixed(1)}),o.jsx("p",{className:"text-gray-700 font-medium",children:"Diviseur"}),o.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Pour obtenir la moyenne /",d]})]})}),o.jsx("div",{className:"bg-gray-50 rounded-md p-4 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Yi,{className:"h-6 w-6 text-gray-600 mx-auto mb-2"}),o.jsx("div",{className:"text-xl font-bold text-gray-900",children:S.length}),o.jsx("p",{className:"text-gray-700 font-medium",children:"Matires"}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Configures pour cette classe"})]})})]}),o.jsxs("div",{className:"mt-6 bg-gray-50 rounded-md p-4",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Dtail des matires"}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:S.map(K=>{const ie=W(K,y.niveau),B=d===20?ie/20:ie/10;return o.jsxs("div",{className:"bg-white rounded-md p-3 border border-gray-200",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:K.abreviation}),o.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["/",ie]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["Diviseur: ",B.toFixed(1)]})]},K.id)})})]})]}),t&&n&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statistiques de la classe"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-gray-900",children:v.length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"lves"})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-green-600",children:v.filter(K=>L(K.id)>=d*.5).length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Admis"}),o.jsxs("p",{className:"text-xs text-gray-500",children:[" ",d/2,"/",d]})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-red-600",children:v.filter(K=>{const ie=L(K.id);return ie>0&&ie<d*.5}).length}),o.jsx("p",{className:"text-gray-600 font-medium",children:"chec"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["< ",d/2,"/",d]})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-gray-900",children:(()=>{const K=v.map(ie=>L(ie.id)).filter(ie=>ie>0);return K.length>0?(K.reduce((ie,B)=>ie+B,0)/K.length).toFixed(2):"0"})()}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Moy. Classe"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["/",d]})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-md border border-gray-200",children:[o.jsx("div",{className:"text-xl font-bold text-gray-900",children:Object.keys(i).reduce((K,ie)=>{const B=i[ie]||{},z=Object.values(B).filter(G=>G!=null).length;return K+z},0)}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Notes saisies"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["/ ",v.length*S.length]})]})]})]}),T&&o.jsx(kf,{open:T.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardes. Voulez-vous quitter sans enregistrer ?",onConfirm:re,onCancel:O})]})}function dX(e){const t=e.split("-"),r=parseInt(t[0],10);return isNaN(r)?new Date().getFullYear():r}function hX(e,t){const r=dX(t),n=r+1,a=[`${r}-09-01`,`${r}-10-05`,`${r}-11-05`,`${r}-12-05`,`${n}-01-05`,`${n}-02-05`,`${n}-03-05`];let i=35e3,s=15e3,l=15e3;["Petite Section","Moyenne Section","Grande Section"].includes(e)&&(i=35e3,s=15e3,l=1e4),["CP1","CP2","CE1","CE2"].includes(e)&&(i=35e3,s=15e3,l=15e3),e==="CM1"&&(i=35e3,s=2e4,l=15e3),e==="CM2"&&(i=45e3,s=2e4,l=15e3);const f=[{modalite:1,label:"Inscription",date:a[0],montant:i,id:`${e}-1`},{modalite:2,label:"Versement 1",date:a[1],montant:s,id:`${e}-2`},{modalite:3,label:"Versement 2",date:a[2],montant:l,id:`${e}-3`},{modalite:4,label:"Versement 3",date:a[3],montant:1e4,id:`${e}-4`},{modalite:5,label:"Versement 4",date:a[4],montant:1e4,id:`${e}-5`},{modalite:6,label:"Versement 5",date:a[5],montant:1e4,id:`${e}-6`},{modalite:7,label:"Versement 6",date:a[6],montant:1e4,id:`${e}-7`}],d=f.reduce((h,m)=>h+m.montant,0);return{niveau:e,anneeScolaire:t,montant:d,fraisInscription:0,echeances:f.map(h=>({date:h.date,montant:h.montant,modalite:h.modalite,label:h.label,id:h.id}))}}const mX=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];function pX(e){(fe.getAll("fraisScolaires")||[]).forEach(n=>{if(n&&n.annee&&!n.anneeScolaire)try{fe.update("fraisScolaires",n.id,{...n,anneeScolaire:n.annee,updatedAt:new Date().toISOString()})}catch{}});let r=0;return mX.forEach(n=>{if(!(fe.getAll("fraisScolaires")||[]).find(i=>i.niveau===n&&i.anneeScolaire===e)){const i=hX(n,e);fe.create("fraisScolaires",i),r++}}),r}function fP(){const e="2025-2026",t=pX(e);return t>0&&console.log(`Frais scolaires initialiss: ${t} niveaux crs pour ${e}`),t}const Jk=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];function xX(){const{showToast:e}=Jr(),[t,r]=k.useState([]),[n,a]=k.useState(null),[i,s]=k.useState(!1),[l,f]=k.useState({niveau:"CP1",anneeScolaire:"2025-2026",echeances:[{date:"2025-09-01",montant:35e3,modalite:1,label:"Inscription"}]});k.useEffect(()=>{d(),fe.getAll("fraisScolaires").length===0&&(fP(),d())},[]);const d=()=>{const N=fe.getAll("fraisScolaires");r(N)},h=()=>{f({niveau:"CP1",anneeScolaire:"2025-2026",echeances:[{date:"2025-09-01",montant:35e3,modalite:1,label:"Inscription"}]}),a(null),s(!1)},m=N=>{f({niveau:N.niveau,anneeScolaire:N.anneeScolaire,echeances:(N.echeances||[]).map(S=>({date:S.date,montant:S.montant,modalite:S.modalite||1,label:S.label||""}))}),a(N.id),s(!0)},x=N=>{window.confirm(`Supprimer les frais pour ${N.niveau} (${N.anneeScolaire}) ?`)&&(fe.delete("fraisScolaires",N.id),d(),e("Frais supprims","success"))},g=()=>{const N=l.echeances.reduce((j,T)=>j+T.montant,0),S={niveau:l.niveau,anneeScolaire:l.anneeScolaire,fraisInscription:0,montant:N,echeances:l.echeances.map((j,T)=>({id:`${l.niveau}-${l.anneeScolaire}-${T+1}`,date:j.date,montant:j.montant,modalite:j.modalite,label:j.label}))};if(n)fe.update("fraisScolaires",n,S),e("Frais mis  jour","success");else{if(t.find(T=>T.niveau===l.niveau&&T.anneeScolaire===l.anneeScolaire)){e("Des frais existent dj pour ce niveau et cette anne","error");return}fe.create("fraisScolaires",S),e("Frais ajouts","success")}d(),h()},y=()=>{f(N=>({...N,echeances:[...N.echeances,{date:"",montant:1e4,modalite:N.echeances.length+1,label:`Versement ${N.echeances.length}`}]}))},v=(N,S,j)=>{f(T=>({...T,echeances:T.echeances.map((C,P)=>P===N?{...C,[S]:S==="montant"||S==="modalite"?Number(j):j}:C)}))},b=N=>{f(S=>({...S,echeances:S.echeances.filter((j,T)=>T!==N)}))},E=N=>(N.echeances||[]).reduce((S,j)=>S+(j.montant||0),0);return o.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 text-white p-8 rounded-2xl shadow-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:o.jsx(Ji,{className:"h-8 w-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Configuration des Frais Scolaires"}),o.jsx("p",{className:"text-green-100 mt-2",children:"Gestion des modalits de paiement par niveau"})]})]}),o.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-2 px-6 py-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-xl transition-all",children:[o.jsx(Vo,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:"Nouveau Frais"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 gap-6",children:Jk.map(N=>{const S=t.filter(j=>j.niveau===N);return o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:N}),o.jsxs("p",{className:"text-gray-600 text-sm",children:[S.length," configuration(s)"]})]}),o.jsx("div",{className:"p-6",children:S.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Ji,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-500",children:"Aucun frais configur pour ce niveau"}),o.jsx("button",{onClick:()=>{f(j=>({...j,niveau:N})),s(!0)},className:"mt-3 text-teal-600 hover:text-teal-700 font-medium",children:"Configurer les frais"})]}):o.jsx("div",{className:"space-y-4",children:S.map(j=>o.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:j.anneeScolaire}),o.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[E(j).toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>m(j),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:o.jsx(Ho,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>x(j),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:o.jsx(Ws,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:(j.echeances||[]).map((T,C)=>o.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsxs("span",{className:"text-xs font-medium text-gray-600",children:["Modalit ",T.modalite]}),o.jsx("span",{className:"text-xs text-gray-500",children:new Date(T.date).toLocaleDateString("fr-FR")})]}),o.jsx("p",{className:"text-xs text-gray-600 font-medium",children:T.label||`Modalit ${T.modalite}`}),o.jsxs("p",{className:"font-bold text-gray-900",children:[(T.montant||0).toLocaleString("fr-FR")," FCFA"]})]},C))})]},j.id))})})]},N)})}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 text-white p-6",children:o.jsx("h3",{className:"text-xl font-bold",children:n?"Modifier les frais":"Nouveau frais scolaire"})}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Niveau"}),o.jsx("select",{value:l.niveau,onChange:N=>f(S=>({...S,niveau:N.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-green-100 focus:border-green-500 transition-all",children:Jk.map(N=>o.jsx("option",{value:N,children:N},N))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Anne scolaire"}),o.jsx("input",{type:"text",value:l.anneeScolaire,onChange:N=>f(S=>({...S,anneeScolaire:N.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-green-100 focus:border-green-500 transition-all",placeholder:"2025-2026"})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"chances de paiement"}),o.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",l.echeances.reduce((N,S)=>N+S.montant,0).toLocaleString("fr-FR")," FCFA"]}),o.jsxs("button",{onClick:y,className:"flex items-center space-x-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:[o.jsx(Vo,{className:"h-4 w-4"}),o.jsx("span",{children:"Ajouter"})]})]}),o.jsx("div",{className:"space-y-4",children:l.echeances.map((N,S)=>o.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modalit"}),o.jsx("input",{type:"number",min:"1",value:N.modalite,onChange:j=>v(S,"modalite",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-center font-bold"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Label"}),o.jsx("input",{type:"text",value:N.label,onChange:j=>v(S,"label",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent font-medium",placeholder:"Ex: Inscription, Versement 1..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'chance"}),o.jsx("input",{type:"date",value:N.date,onChange:j=>v(S,"date",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent font-mono"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant (FCFA)"}),o.jsx("input",{type:"number",min:"0",value:N.montant,onChange:j=>v(S,"montant",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-right font-bold text-green-700"})]}),o.jsx("div",{children:o.jsx("button",{onClick:()=>b(S),className:"w-full p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",disabled:l.echeances.length===1,children:o.jsx(Ws,{className:"h-4 w-4 mx-auto"})})})]})},S))}),o.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-blue-900 font-semibold",children:"Total des frais:"}),o.jsxs("span",{className:"text-2xl font-bold text-blue-700",children:[l.echeances.reduce((N,S)=>N+S.montant,0).toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"mt-2 text-sm text-blue-600",children:[l.echeances.length," modalit(s) de paiement configure(s)"]})]})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{onClick:h,className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:g,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-600 to-teal-600 text-white rounded-xl hover:from-green-700 hover:to-teal-700 transition-all",children:[o.jsx(Zs,{className:"h-5 w-5"}),o.jsx("span",{children:n?"Mettre  jour":"Enregistrer"})]})]})]})]})})]})}const Qk=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];function gX(){const{showToast:e}=Jr(),[t,r]=k.useState([]),[n,a]=k.useState(null),[i,s]=k.useState(!1),[l,f]=k.useState({nom:"",coefficient:1,niveau:"",ordre:1});k.useEffect(()=>{d()},[]);const d=()=>{const v=fe.getAll("compositions");r(v.sort((b,E)=>b.ordre-E.ordre))},h=()=>{f({nom:"",coefficient:1,niveau:"",ordre:1}),a(null),s(!1)},m=v=>{f({nom:v.nom,coefficient:v.coefficient,niveau:v.niveau||"",ordre:v.ordre}),a(v),s(!0)},x=()=>{if(!l.nom.trim()){e("Le nom est obligatoire","error");return}if(t.some(b=>b.nom.toLowerCase()===l.nom.trim().toLowerCase()&&b.niveau===(l.niveau||void 0)&&b.id!==n?.id)){e("Cette composition existe dj pour ce niveau","error");return}const v={nom:l.nom.trim(),coefficient:l.coefficient,niveau:l.niveau||void 0,ordre:l.ordre};n?(fe.update("compositions",n.id,v),e("Composition mise  jour","success")):(fe.create("compositions",v),e("Composition ajoute","success")),d(),h()},g=v=>{window.confirm("Supprimer cette composition ? Toutes les notes associes seront perdues.")&&(fe.getAll("notes").filter(N=>N.compositionId===v).forEach(N=>fe.delete("notes",N.id)),fe.getAll("moyennesGenerales").filter(N=>N.compositionId===v).forEach(N=>fe.delete("moyennesGenerales",N.id)),fe.delete("compositions",v),d(),e("Composition supprime","success"))},y=v=>t.filter(b=>!b.niveau||b.niveau===v);return o.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[o.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-8 rounded-2xl shadow-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:o.jsx(Yi,{className:"h-8 w-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Configuration des Compositions"}),o.jsx("p",{className:"text-purple-100 mt-2",children:"Gestion des priodes d'valuation par niveau"})]})]}),o.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-2 px-6 py-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-xl transition-all",children:[o.jsx(Vo,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:"Nouvelle Composition"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:Qk.map(v=>o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:v}),o.jsxs("p",{className:"text-gray-600 text-sm",children:[y(v).length," composition(s)"]})]}),o.jsx("div",{className:"p-6",children:y(v).length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(tc,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-500 mb-3",children:"Aucune composition spcifique"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Les compositions gnrales s'appliquent  ce niveau"})]}):o.jsx("div",{className:"space-y-3",children:y(v).map(b=>o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:b.nom}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Coefficient: ",b.coefficient,"  Ordre: ",b.ordre]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>m(b),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:o.jsx(Ho,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>g(b.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:o.jsx(Ws,{className:"h-4 w-4"})})]})]},b.id))})})]},v))}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-blue-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Compositions Gnrales"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"S'appliquent  tous les niveaux sauf configuration spcifique"})]}),o.jsx("div",{className:"p-6",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.filter(v=>!v.niveau).map(v=>o.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl p-4 border border-gray-200 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h4",{className:"font-semibold text-gray-900",children:v.nom}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsx("button",{onClick:()=>m(v),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",children:o.jsx(Ho,{className:"h-3 w-3"})}),o.jsx("button",{onClick:()=>g(v.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",children:o.jsx(Ws,{className:"h-3 w-3"})})]})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:v.coefficient}),o.jsx("p",{className:"text-gray-600 text-xs",children:"Coefficient"}),o.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:["Ordre: ",v.ordre]})]})]},v.id))})})]}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4",children:[o.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 rounded-t-2xl",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-xl font-bold",children:n?"Modifier la composition":"Nouvelle composition"}),o.jsx("button",{onClick:h,className:"text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition-colors",children:o.jsx(eo,{className:"h-5 w-5"})})]})}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Nom de la composition ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:l.nom,onChange:v=>f(b=>({...b,nom:v.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all",placeholder:"Ex: 1re Composition, Devoir de Nol..."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Coefficient ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",min:"1",max:"10",value:l.coefficient,onChange:v=>f(b=>({...b,coefficient:Number(v.target.value)})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Ordre d'affichage"}),o.jsx("input",{type:"number",min:"1",value:l.ordre,onChange:v=>f(b=>({...b,ordre:Number(v.target.value)})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Niveau spcifique (optionnel)"}),o.jsxs("select",{value:l.niveau,onChange:v=>f(b=>({...b,niveau:v.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-100 focus:border-purple-500 transition-all",children:[o.jsx("option",{value:"",children:"Tous les niveaux"}),Qk.map(v=>o.jsx("option",{value:v,children:v},v))]}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Laissez vide pour appliquer  tous les niveaux"})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{onClick:h,className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:x,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl hover:from-purple-700 hover:to-indigo-700 transition-all",children:[o.jsx(Zs,{className:"h-5 w-5"}),o.jsx("span",{children:n?"Mettre  jour":"Enregistrer"})]})]})]})]})})]})}const Zk=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(String(n.result)),n.onerror=r,n.readAsDataURL(e)});function vX(){const[e,t]=k.useState(()=>Vs()),[r,n]=k.useState("eleves");function a(s,l,f){t(d=>{const h=d[s];return{...d,[s]:{...h,[l]:f}}})}const i=()=>{Qu(e),alert("Configurations d'impression sauvegardes")};return o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Configuration des impressions"}),o.jsx("p",{className:"mb-6 text-sm text-gray-600 max-w-3xl",children:"ditez l'en-tte, le pied de page, les logos et les colonnes pour chaque type de document. Chaque onglet dispose d'un aperu plac sous le formulaire."}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex items-center gap-3",children:["eleves","recu","transport"].map(s=>o.jsx("button",{onClick:()=>n(s),className:`px-4 py-2 rounded-md font-semibold shadow-sm ${r===s?"bg-teal-600 text-white":"bg-white border text-gray-700"}`,children:s==="eleves"?"LVES":s==="recu"?"REU":"TRANSPORT"},s))}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow space-y-6",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["Paramtres  ",r==="eleves"?"Liste lves":r==="recu"?"Reu de paiement":"Transport"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"En-tte"}),o.jsx("textarea",{rows:2,value:e[r].header,onChange:s=>a(r,"header",s.target.value),className:"w-full border rounded px-3 py-2 mt-1 resize-none",placeholder:r==="eleves"?"Ministre de l'ducation Nationale  Nom de l'tablissement":r==="recu"?"Reu de paiement":"Fiche de renseignement transport"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pied de page"}),o.jsx("textarea",{rows:2,value:e[r].footer||"",onChange:s=>a(r,"footer",s.target.value),className:"w-full border rounded px-3 py-2 mt-1 resize-none",placeholder:r==="recu"?"Aucun remboursement n'est possible aprs encaissement.":""})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Colonnes (spares par des virgules)"}),o.jsx("input",{value:e[r].columns.join(", "),onChange:s=>a(r,"columns",s.target.value.split(",").map(l=>l.trim())),className:"w-full border rounded px-3 py-2 mt-1",placeholder:r==="eleves"?"Matricule, Nom & Prnom":r==="recu"?"Nom, Montant, Date, Classe":"Nom, Classe, Montant, Versement"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Logo principal"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async s=>{const l=s.target.files?.[0];if(!l)return;const f=await Zk(l);a(r,"logo",f)},className:"mt-1"}),o.jsx("div",{className:"mt-2 text-sm text-gray-600",children:e[r].logo?o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:e[r].logo,alt:"logo",className:"h-14"}),o.jsx("button",{className:"px-3 py-1 border rounded text-sm",onClick:()=>a(r,"logo",""),children:"Supprimer"})]}):o.jsx("div",{children:"Aucun fichier slectionn"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Logo Ministre"}),o.jsx("input",{type:"file",accept:"image/*",onChange:async s=>{const l=s.target.files?.[0];if(!l)return;const f=await Zk(l);a(r,"logoMinistere",f)},className:"mt-1"}),o.jsx("div",{className:"mt-2 text-sm text-gray-600",children:e[r].logoMinistere?o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:e[r].logoMinistere,alt:"logo-min",className:"h-14"}),o.jsx("button",{className:"px-3 py-1 border rounded text-sm",onClick:()=>a(r,"logoMinistere",""),children:"Supprimer"})]}):o.jsx("div",{children:"Aucun fichier slectionn"})})]})]}),o.jsxs("div",{className:"flex items-center justify-between mt-4",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Options"}),o.jsxs("div",{className:"space-x-2",children:[o.jsx("button",{onClick:()=>t(Vs()),className:"px-3 py-1 border rounded",children:"Restaurer"}),o.jsx("button",{onClick:i,className:"px-3 py-1 bg-teal-600 text-white rounded",children:"Sauvegarder"})]})]})]}),o.jsx("div",{className:"border-t pt-4",children:o.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h4",{className:"font-semibold",children:["Aperu  ",r==="eleves"?"Liste lves":r==="recu"?"Reu":"Transport"]}),o.jsx("div",{className:"text-sm text-gray-500",children:r==="eleves"?"Liste des lves":r==="recu"?"Reu de paiement":"Fiche de renseignement transport"})]}),o.jsxs("div",{className:"border rounded bg-white p-4",children:[o.jsx(Hf,{type:r,libelle:e[r].header}),o.jsxs("div",{className:"mt-4 text-sm text-gray-700",children:[r==="eleves"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:"Ministre de l'ducation Nationale et de l'Alphabtisation"}),o.jsx("div",{className:"mt-1",children:"GROUPE SCOLAIRE BAPTISTE MISSIONNAIRE DE KOUMASSI"}),o.jsx("div",{className:"mt-3 font-medium",children:"Liste des lves"})]}),r==="recu"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:"Reu de paiement"}),o.jsx("div",{className:"mt-2 text-gray-600",children:"Aucun remboursement n'est possible aprs encaissement."})]}),r==="transport"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:"Fiche de renseignement transport"}),o.jsx("div",{className:"mt-2 text-gray-600",children:"Informations : nom, classe, montant, versement"})]})]})]})]})})]})]})]})}function yX(){const{showToast:e}=Jr(),t=k.useRef(null),r=async()=>{try{const i=await yn(()=>import("./jszip.min-CrZqInyW.js").then(v=>v.j),[],import.meta.url),s=i&&(i.default||i),l=new s,f=JSON.parse(fe.exportData()),d=new Date().toISOString().split("T")[0],h=l.folder(`backup_${d}/data`);Object.entries(f).forEach(([v,b])=>{h.file(`${v}.json`,JSON.stringify(b,null,2))}),l.folder(`backup_${d}/meta`).file("info.json",JSON.stringify({generatedAt:new Date().toISOString(),app:"KlasNet"},null,2));const x=await l.generateAsync({type:"blob"}),g=window.URL.createObjectURL(x),y=document.createElement("a");y.href=g,y.download=`klasnet_backup_${d}.zip`,y.click(),window.URL.revokeObjectURL(g),e("Sauvegarde ZIP exporte avec succs","success")}catch{const s=fe.exportData(),l=new Blob([s],{type:"application/json"}),f=window.URL.createObjectURL(l),d=document.createElement("a"),h=new Date().toISOString().split("T")[0];d.href=f,d.download=`klasnet_backup_${h}.json`,d.click(),window.URL.revokeObjectURL(f),e("Sauvegarde exporte (fallback JSON)","success")}},n=i=>{const s=i.target.files?.[0];if(!s)return;const l=new FileReader;l.onload=f=>{try{const d=f.target?.result;fe.importData(d)?e("Donnes importes avec succs","success"):e("Erreur lors de limportation des donnes","error")}catch{e("Erreur lors de la lecture du fichier","error")}},l.readAsText(s)},a=()=>{window.confirm("tes-vous sr de vouloir rinitialiser toutes les donnes ? Cette action est irrversible.")&&(fe.resetData(),e("Donnes rinitialises avec succs","success"))};return o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Sauvegarde et Restauration"}),o.jsx("div",{className:"text-sm text-gray-600",children:"Export / import / rinitialisation des donnes de l'application"})]}),o.jsxs("div",{className:"max-w-xl bg-white p-6 rounded shadow-sm border",children:[o.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"Utilisez ces commandes pour exporter une sauvegarde complte de l'application, importer une sauvegarde ou rinitialiser la base de donnes locale."}),o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsx("button",{onClick:r,className:"w-full px-4 py-2 bg-blue-600 text-white rounded",children:"Exporter les donnes"}),o.jsx("button",{onClick:()=>t.current?.click(),className:"w-full px-4 py-2 border rounded",children:"Importer des donnes"}),o.jsx("button",{onClick:a,className:"w-full px-4 py-2 bg-red-600 text-white rounded",children:"Rinitialiser toutes les donnes"})]}),o.jsx("input",{ref:t,type:"file",accept:".json",onChange:n,className:"hidden"})]})]})}function bX(){const[e,t]=k.useState([]);return k.useEffect(()=>{t(fe.getAll("historiques").sort((r,n)=>n.date.localeCompare(r.date)))},[]),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 max-w-2xl mx-auto",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Historique des actions"}),e.length===0?o.jsx("div",{className:"text-gray-500 text-center",children:"Aucune action enregistre."}):o.jsxs("table",{className:"w-full text-sm border",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-50",children:[o.jsx("th",{className:"border px-2 py-1",children:"Date"}),o.jsx("th",{className:"border px-2 py-1",children:"Type"}),o.jsx("th",{className:"border px-2 py-1",children:"Cible"}),o.jsx("th",{className:"border px-2 py-1",children:"Description"}),o.jsx("th",{className:"border px-2 py-1",children:"Utilisateur"})]})}),o.jsx("tbody",{children:e.map(r=>o.jsxs("tr",{children:[o.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:new Date(r.date).toLocaleString()}),o.jsx("td",{className:"border px-2 py-1 capitalize",children:r.type}),o.jsx("td",{className:"border px-2 py-1",children:r.cible}),o.jsx("td",{className:"border px-2 py-1",children:r.description}),o.jsx("td",{className:"border px-2 py-1",children:r.utilisateur||"-"})]},r.id))})]})]})}function wX(){const{showToast:e}=Jr(),[t,r]=k.useState(null),[n,a]=k.useState(""),[i,s]=k.useState(!1),[l,f]=k.useState(!1),[d,h]=k.useState(!1),[m,x]=k.useState(null);k.useEffect(()=>{g()},[]);const g=async()=>{f(!0);try{await $i.updateLicenceFromServer();const E=await $i.checkLicenceStatus();r(E)}catch(E){console.error("Erreur refresh licence:",E)}finally{f(!1)}},y=async()=>{if(!n.trim()){e("Veuillez entrer une cl de licence","error");return}s(!0);try{const E=$i.activateLicence(n.trim());E.success?(e(E.message,"success"),a(""),await g()):e(E.message,"error")}catch{e("Erreur lors de l'activation","error")}finally{s(!1)}},v=()=>t?t.isValid&&!t.isExpired?o.jsx(In,{className:"h-8 w-8 text-green-600"}):o.jsx(wi,{className:"h-8 w-8 text-red-600"}):o.jsx(h4,{className:"h-8 w-8 text-gray-400"}),b=()=>t?t.isValid&&!t.isExpired?t.daysRemaining<=7?"from-yellow-500 to-orange-500":"from-green-500 to-teal-500":"from-red-500 to-red-600":"from-gray-500 to-gray-600";return o.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[o.jsx("div",{className:`bg-gradient-to-r ${b()} text-white p-8 rounded-2xl shadow-lg`,children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"bg-white bg-opacity-20 p-4 rounded-xl",children:v()}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Gestion des Licences"}),o.jsx("p",{className:"text-white text-opacity-90 mt-2",children:t?.isValid?`Licence ${t.type} active - ${t.daysRemaining} jour(s) restant(s)`:"Licence expire ou invalide"})]})]})}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Statut de la Licence"}),o.jsxs("button",{onClick:g,disabled:l,className:"flex items-center space-x-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors disabled:opacity-50",children:[o.jsx(N1,{className:`h-4 w-4 ${l?"animate-spin":""}`}),o.jsx("span",{children:"Actualiser"})]})]})}),o.jsxs("div",{className:"p-6",children:[t?o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-xl",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600 capitalize",children:t.type}),o.jsx("p",{className:"text-blue-800 font-medium",children:"Type de licence"})]}),o.jsxs("div",{className:"text-center p-6 bg-purple-50 rounded-xl",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.daysRemaining}),o.jsx("p",{className:"text-purple-800 font-medium",children:"Jours restants"})]}),o.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-xl",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.isValid?"":""}),o.jsx("p",{className:"text-green-800 font-medium",children:t.isValid?"Valide":"Expire"})]})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Vrification en cours..."})]}),t&&o.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Dtails"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Date d'expiration:"}),o.jsx("div",{className:"font-medium text-gray-900",children:t.dateExpiration?new Date(t.dateExpiration).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Non dfinie"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Dernire vrification:"}),o.jsx("div",{className:"font-medium text-gray-900",children:new Date(t.lastCheck).toLocaleString("fr-FR")})]})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-blue-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Activation de Licence"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Entrez votre cl de licence pour activer ou renouveler"})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Cl de licence"}),o.jsx("textarea",{value:n,onChange:E=>a(E.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-teal-100 focus:border-teal-500 transition-all resize-none font-mono text-sm",rows:4,placeholder:"Collez votre cl de licence ici..."})]}),o.jsxs("div",{className:"flex justify-end space-x-4",children:[o.jsx("button",{onClick:()=>a(""),className:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors",children:"Effacer"}),o.jsxs("button",{onClick:y,disabled:i||!n.trim(),className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-xl hover:from-teal-700 hover:to-blue-700 transition-all disabled:opacity-50",children:[i?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(B0,{className:"h-4 w-4"}),o.jsx("span",{children:i?"Activation...":"Activer la licence"})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gnrateur de Cls (dsactiv)"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"La gnration de cls a t dsactive dans le client. Utilisez un service serveur scuris pour mettre des licences."})]}),o.jsx("div",{className:"p-6",children:o.jsxs("button",{disabled:!0,title:"Gnration de cls dsactive",className:"flex items-center space-x-2 px-6 py-3 bg-gray-200 text-gray-500 rounded-xl cursor-not-allowed",children:[o.jsx(B0,{className:"h-5 w-5"}),o.jsx("span",{children:"Gnration dsactive"})]})})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[o.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 px-6 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Actions Avances"}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Utilisez avec prcaution"})]}),o.jsx("div",{className:"p-6",children:o.jsx("div",{className:"flex space-x-4",children:o.jsx("button",{onClick:()=>{window.confirm("Rinitialiser la licence ? Cela supprimera la licence actuelle.")&&($i.resetLicence(),g(),e("Licence rinitialise","success"))},className:"px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors",children:"Rinitialiser la licence"})})})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations Systme"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:o.jsx("div",{className:"text-sm",children:o.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Tlphone:"})," +2250555863953"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Email:"})," Non disponible"]}),o.jsxs("p",{children:[" ",o.jsx("strong",{children:"Site web:"})," Non disponible"]})]})})})]})]})}let kh;try{kh=require("./defaultFraisScolaires").ensureDefaultFrais}catch{kh=void 0}function ej(e,t,r,n,a){const i=new Date().toISOString();fe.updateParcoursEnCours(e.id,r,{statut:a||"Admis",moyenneAnnuelle:n,dateFin:i}),fe.getAll("parcoursAcademiques").filter(l=>l.eleveId===e.id&&l.anneeScolaire===r).length===0&&fe.addParcoursAcademique({eleveId:e.id,anneeScolaire:r,classeId:t.id,niveau:t.niveau,section:t.section||"",statut:a||"Admis",moyenneAnnuelle:n,dateDebut:e.anneeEntree||r,dateFin:i})}function SX(e){const{useDFA:t=!1,dfa:r={},seuilAdmission:n=10,nouvelleAnnee:a,fallbackToReset:i=!0,preserveEleves:s=!0,resetFinances:l=!0}=e,f=fe.getAll("eleves"),d=fe.getAll("classes"),h=fe.getAll("notes"),m=fe.getAll("paiements"),x=fe.getAll("ecole")[0],g=x?.anneeScolaireActive||"",y={date:new Date().toISOString(),eleves:f,classes:d,notes:h,paiements:m,compositions:fe.getAll("compositions"),fraisScolaires:fe.getAll("fraisScolaires"),type:"archive_pre_passage_annee"};try{const N=new Blob([JSON.stringify(y,null,2)],{type:"application/json"}),S=window.URL.createObjectURL(N),j=document.createElement("a");j.href=S,j.download=`archive_pre_passage_${new Date().getFullYear()}.json`,j.click(),window.URL.revokeObjectURL(S)}catch{}fe.addHistorique({type:"autre",cible:"Systme",description:`Passage d'anne dclench (${t?"DFA":"Reset simple"}) vers ${a}`,utilisateur:"ADMIN"});let v=0,b=0;if(t){if(h.length===0&&!i)throw new Error("Aucune note disponible pour calculer la DFA");if(h.length===0&&i)return E();const N=Object.keys(r).length?r:(function(){const T={},C=fe.getAll("notes"),P={};return C.forEach(M=>{const D=M.eleveId,W=Number(M.valeur||0),F=Number(M.bareme||20)||20,L=W/F*20;P[D]=P[D]||[],P[D].push(L)}),Object.keys(P).forEach(M=>{const D=P[M],W=D.reduce((F,L)=>F+L,0)/D.length;T[M]=Math.round(W*100)/100}),T})(),S=["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"];f.forEach(j=>{const T=N[j.id]??0,C=d.find(M=>M.id===j.classeId);if(!C)return;const P=S.indexOf(C.niveau);if(T>=n)if(ej(j,C,g,T,"Admis"),P>=0&&P<S.length-1){const M=S[P+1],D=d.find(W=>W.niveau===M&&W.section===C.section&&W.anneeScolaire===a);D&&(fe.update("eleves",j.id,{classeId:D.id,anneeEntree:a}),fe.addParcoursAcademique({eleveId:j.id,anneeScolaire:a,classeId:D.id,niveau:D.niveau,section:D.section||"",statut:"En cours",dateDebut:new Date().toISOString()}),v++)}else fe.update("eleves",j.id,{statut:"Inactif"}),v++;else ej(j,C,g,T,"Redoublant"),fe.update("eleves",j.id,{anneeEntree:a}),fe.addParcoursAcademique({eleveId:j.id,anneeScolaire:a,classeId:C.id,niveau:C.niveau,section:C.section||"",statut:"En cours",dateDebut:new Date().toISOString()}),b++})}else return E();return d.forEach(N=>{fe.update("classes",N.id,{anneeScolaire:a})}),x&&fe.update("ecole",x.id,{anneeScolaireActive:a}),l&&fe.getAll("paiements").forEach(N=>fe.delete("paiements",N.id)),{promoted:v,heldBack:b};function E(){s?fe.getAll("eleves").forEach(j=>{fe.update("eleves",j.id,{classeId:"",anneeEntree:a})}):fe.getAll("eleves").forEach(j=>{fe.update("eleves",j.id,{statut:"Inactif"})});try{kh&&kh(a)}catch{}l&&fe.getAll("paiements").forEach(S=>fe.delete("paiements",S.id)),d.forEach(S=>{fe.update("classes",S.id,{anneeScolaire:a})});const N=fe.getAll("ecole")[0];return N&&fe.update("ecole",N.id,{anneeScolaireActive:a}),fe.addHistorique({type:"autre",cible:"Systme",description:`Reset simple appliqu pour anne ${a}`,utilisateur:"ADMIN"}),{promoted:0,heldBack:0}}}function NX(){const[e,t]=k.useState(!0),[r,n]=k.useState(10),[a,i]=k.useState(()=>{const P=new Date().getFullYear()+1;return`${P}-${P+1}`}),[s,l]=k.useState(!0),[f,d]=k.useState(!0),[h,m]=k.useState(null),[x,g]=k.useState(!1),[y,v]=k.useState(!1),[b,E]=k.useState(""),[N,S]=k.useState({promoted:0,heldBack:0,total:0}),j=()=>{v(!0),E("")},T=async()=>{if(b.trim()!==a.trim()){m("La confirmation ne correspond pas  la nouvelle anne. Tapez exactement la valeur affiche pour confirmer.");return}v(!1),g(!0),m(null);try{const P=SX({useDFA:e,seuilAdmission:r,nouvelleAnnee:a,preserveEleves:s,resetFinances:f});m(`Opration termine. Promus: ${P?.promoted??0}, Redoublants: ${P?.heldBack??0}`)}catch(P){m(`Erreur: ${P?.message||String(P)}`)}finally{g(!1)}},C=()=>{const P=fe.getAll("eleves"),M=fe.getAll("classes"),D=fe.getAll("notes"),W={};D.forEach(se=>{const Z=se.eleveId,he=Number(se.valeur||0),le=Number(se.bareme||20)||20,de=he/le*20;W[Z]=W[Z]||[],W[Z].push(de)});const F={};Object.keys(W).forEach(se=>{const Z=W[se],he=Z.reduce((le,de)=>le+de,0)/Z.length;F[se]=Math.round(he*100)/100});let L=0,J=0;P.forEach(se=>{const Z=F[se.id]??0;M.find(le=>le.id===se.classeId)&&(Z>=r?L++:J++)}),S({promoted:L,heldBack:J,total:P.length})};return k.useEffect(()=>{C()},[e,r,a,s]),o.jsxs(dl,{title:"Passage d'anne scolaire",subtitle:"Clturer l'anne actuelle et prparer la nouvelle",children:[o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white p-4 rounded border border-gray-200",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold",children:"Prparation du passage"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Les moyennes sont normalises sur une chelle sur 20 avant dcision. Par exemple, une moyenne 5/10 est convertie en 10/20  le seuil d'admission est donc compar sur /20."})]}),o.jsxs("div",{className:"text-sm text-gray-500 flex items-center space-x-3",children:[o.jsx(wi,{className:"w-5 h-5 text-yellow-600"}),o.jsx("span",{children:"Opration irrversible  une archive sera propose"})]})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:e,onChange:P=>t(P.target.checked)}),o.jsx("span",{children:"Utiliser DFA (moyennes) pour promouvoir les lves"})]}),o.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("label",{className:"text-sm text-gray-700",children:"Seuil admission (sur 20)"}),o.jsx("input",{type:"number",value:r,onChange:P=>n(Number(P.target.value)),className:"border rounded px-2 py-1 w-20"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Nouvelle anne scolaire"}),o.jsx("input",{value:a,onChange:P=>i(P.target.value),className:"border rounded px-2 py-1 w-48 mt-1"})]}),o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:e,onChange:P=>t(P.target.checked)}),o.jsx("span",{children:"Utiliser DFA (moyennes)"})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:s,onChange:P=>l(P.target.checked)}),o.jsx("span",{children:"Conserver les lves (dsaffecter si besoin)"})]})]})]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm text-gray-700",children:"Nouvelle anne scolaire"}),o.jsx("input",{value:a,onChange:P=>i(P.target.value),className:"border rounded px-2 py-1 w-48 mt-1"})]}),o.jsx("div",{className:"mt-3",children:o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",checked:f,onChange:P=>d(P.target.checked)}),o.jsx("span",{children:"Rinitialiser les paiements / finances"})]})}),o.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ft,{onClick:j,disabled:x,variant:"danger",children:x?"Excution...":"Lancer le passage"}),o.jsx(Ft,{onClick:()=>{m(null)},variant:"ghost",children:"Effacer"})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs("button",{className:"flex items-center text-sm text-gray-600 hover:text-gray-900",onClick:C,title:"Rafrachir l'aperu",children:[o.jsx(N1,{className:"w-4 h-4 mr-2"})," Rafrachir l'aperu"]})})]}),h&&o.jsx("div",{className:"mt-4 p-3 bg-gray-50 border rounded text-sm",children:h})]}),o.jsxs("div",{className:"bg-white p-4 rounded border border-gray-200",children:[o.jsx("h3",{className:"text-md font-semibold mb-2",children:"Aperu (non destructif)"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Estimation base sur les notes existantes (toutes normalises sur 20)."}),o.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"p-4 bg-green-50 rounded flex items-center space-x-3",children:[o.jsx(In,{className:"w-6 h-6 text-green-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-bold",children:N.promoted}),o.jsx("div",{className:"text-sm text-gray-600",children:"Promus estims"})]})]}),o.jsxs("div",{className:"p-4 bg-yellow-50 rounded flex items-center space-x-3",children:[o.jsx(wi,{className:"w-6 h-6 text-yellow-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-bold",children:N.heldBack}),o.jsx("div",{className:"text-sm text-gray-600",children:"Redoublants estims"})]})]}),o.jsxs("div",{className:"p-4 bg-gray-50 rounded flex items-center space-x-3",children:[o.jsx(Uh,{className:"w-6 h-6 text-gray-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-bold",children:N.total}),o.jsx("div",{className:"text-sm text-gray-600",children:"Total lves analyss"})]})]})]})]})]}),y&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-md",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Confirmer le passage d'anne"}),o.jsx("p",{className:"text-sm text-gray-700 mt-2",children:"Cette opration est irrversible. Pour confirmer, tapez exactement la nouvelle anne scolaire :"}),o.jsx("div",{className:"mt-3 font-mono text-sm bg-gray-100 p-2 rounded",children:a}),o.jsx("input",{value:b,onChange:P=>E(P.target.value),placeholder:"Tapez la nouvelle anne pour confirmer",className:"mt-3 w-full border rounded px-2 py-1"}),o.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[o.jsx(Ft,{variant:"ghost",onClick:()=>v(!1),children:"Annuler"}),o.jsx(Ft,{variant:"danger",onClick:T,children:"Confirmer et lancer"})]})]})})]})}var jh={};jh.version="0.18.5";var dP=1252,EX=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Nb=function(e){EX.indexOf(e)!=-1&&(dP=Sb[0]=e)};function _X(){Nb(1252)}var ei=function(e){Nb(e)};function Eb(){ei(1200),_X()}function tj(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function kX(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function hP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Mu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?kX(e.slice(2)):t==254&&r==255?hP(e.slice(2)):t==65279?e.slice(1):e},w0=function(t){return String.fromCharCode(t)},rj=function(t){return String.fromCharCode(t)},df,Bs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,f=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),s=(r&3)<<4|n>>4,a=e.charCodeAt(d++),l=(n&15)<<2|a>>6,f=a&63,isNaN(n)?l=f=64:isNaN(a)&&(f=64),t+=Bs.charAt(i)+Bs.charAt(s)+Bs.charAt(l)+Bs.charAt(f);return t}function xa(e){var t="",r=0,n=0,a=0,i=0,s=0,l=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Bs.indexOf(e.charAt(d++)),s=Bs.indexOf(e.charAt(d++)),r=i<<2|s>>4,t+=String.fromCharCode(r),l=Bs.indexOf(e.charAt(d++)),n=(s&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),f=Bs.indexOf(e.charAt(d++)),a=(l&3)<<6|f,f!==64&&(t+=String.fromCharCode(a));return t}var pt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),us=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Xs(e){return pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function nj(e){return pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ua=function(t){return pt?us(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function _m(e){if(typeof ArrayBuffer>"u")return ua(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function io(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function jX(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function _b(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return _b(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Kr=pt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:us(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function CX(e){for(var t=[],r=0,n=e.length+250,a=Xs(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|l>>6&15|(s&3)<<4,a[r++]=128|l&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Xs(65535),n=65530)}return t.push(a.slice(0,r)),Kr(t)}var Mn=/\u0000/g,Ru=/[\u0001-\u0006]/g;function ic(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ti(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}function kb(e,t){var r=""+e;return r.length>=t?r:ur(" ",t-r.length)+r}function Ch(e,t){var r=""+e;return r.length>=t?r:r+ur(" ",t-r.length)}function AX(e,t){var r=""+Math.round(e);return r.length>=t?r:ur("0",t-r.length)+r}function TX(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}var aj=Math.pow(2,32);function Vl(e,t){if(e>aj||e<-aj)return AX(e,t);var r=Math.round(e);return TX(r,t)}function Ah(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ij=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Qg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function PX(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},sj={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},OX={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Th(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,l=0,f=1,d=0,h=0,m=Math.floor(a);d<t&&(m=Math.floor(a),l=m*s+i,h=m*d+f,!(a-m<5e-8));)a=1/(a-m),i=s,s=l,f=d,d=h;if(h>t&&(d>t?(h=f,l=i):(h=d,l=s)),!r)return[0,n*l,h];var x=Math.floor(n*l/h);return[x,n*l-x*h,h]}function Io(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),s=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=LX(f,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var mP=new Date(1899,11,31,0,0,0),FX=mP.getTime(),DX=new Date(1900,2,1,0,0,0);function pP(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=DX&&(r+=1440*60*1e3),(r-(FX+(e.getTimezoneOffset()-mP.getTimezoneOffset())*6e4))/(1440*60*1e3)}function jb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function IX(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function MX(e){var t=e<0?12:11,r=jb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function RX(e){var t=jb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function mf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=MX(e):t===10?r=e.toFixed(10).substr(0,12):r=RX(e),jb(IX(r.toUpperCase()))}function Zo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):mf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ba(14,pP(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function LX(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function BX(e,t,r,n){var a="",i=0,s=0,l=r.y,f,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:f=l%100,d=2;break;default:f=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,d=t.length;break;case 3:return Qg[r.m-1][1];case 5:return Qg[r.m-1][0];default:return Qg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,d=t.length;break;case 3:return ij[r.q][0];default:return ij[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ti(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=ti(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:f=l,d=1;break}var h=d>0?ti(f,d):"";return h}function $s(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var xP=/%/g;function $X(e,t,r){var n=t.replace(xP,""),a=t.length-n.length;return Ki(e,n,r*Math.pow(10,2*a))+ur("%",a)}function UX(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ki(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function gP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+gP(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,f,d,h){return f+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vP=/# (\?+)( ?)\/( ?)(\d+)/;function zX(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(s===0?ur(" ",e[1].length+1+e[4].length):kb(s,e[1].length)+e[2]+"/"+e[3]+ti(l,e[4].length))}function WX(e,t,r){return r+(t===0?"":""+t)+ur(" ",e[1].length+2+e[4].length)}var yP=/^#*0*\.([0#]+)/,bP=/\).*[0#]/,wP=/\(###\) ###\\?-####/;function Pn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function oj(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function lj(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function HX(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function VX(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Aa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(bP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Aa("n",n,r):"("+Aa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return UX(e,t,r);if(t.indexOf("%")!==-1)return $X(e,t,r);if(t.indexOf("E")!==-1)return gP(t,r);if(t.charCodeAt(0)===36)return"$"+Aa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Vl(f,t.length);if(t.match(/^[#?]+$/))return a=Vl(r,0),a==="0"&&(a=""),a.length>t.length?a:Pn(t.substr(0,t.length-a.length))+a;if(i=t.match(vP))return zX(i,f,d);if(t.match(/^#+0+$/))return d+Vl(f,t.length-t.indexOf("0"));if(i=t.match(yP))return a=oj(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Pn(i[1])).replace(/\.$/,"."+Pn(i[1])).replace(/\.(\d*)$/,function(y,v){return"."+v+ur("0",Pn(i[1]).length-v.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+oj(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+$s(Vl(f,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Aa(e,t,-r):$s(""+(Math.floor(r)+HX(r,i[1].length)))+"."+ti(lj(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Aa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ic(Aa(e,t.replace(/[\\-]/g,""),r)),s=0,ic(ic(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(wP))return a=Aa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=Th(f,Math.pow(10,s)-1,!1),a=""+d,h=Ki("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=Ch(l[2],s),h.length<i[4].length&&(h=Pn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=Th(f,Math.pow(10,s)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?kb(l[1],s)+i[2]+"/"+i[3]+Ch(l[2],s):ur(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Vl(r,0),t.length<=a.length?a:Pn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,x=t.length-a.length-m;return Pn(t.substr(0,m)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=lj(r,i[1].length),r<0?"-"+Aa(e,t,-r):$s(VX(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ti(0,3-y.length):"")+y})+"."+ti(s,i[1].length);switch(t){case"###,##0.00":return Aa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=$s(Vl(f,0));return g!=="0"?d+g:"";case"###,###.00":return Aa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Aa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function GX(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ki(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function KX(e,t,r){var n=t.replace(xP,""),a=t.length-n.length;return Ki(e,n,r*Math.pow(10,2*a))+ur("%",a)}function SP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+SP(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,f,d,h){return f+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function hi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(bP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hi("n",n,r):"("+hi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return GX(e,t,r);if(t.indexOf("%")!==-1)return KX(e,t,r);if(t.indexOf("E")!==-1)return SP(t,r);if(t.charCodeAt(0)===36)return"$"+hi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ti(f,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Pn(t.substr(0,t.length-a.length))+a;if(i=t.match(vP))return WX(i,f,d);if(t.match(/^#+0+$/))return d+ti(f,t.length-t.indexOf("0"));if(i=t.match(yP))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Pn(i[1])).replace(/\.$/,"."+Pn(i[1])),a=a.replace(/\.(\d*)$/,function(y,v){return"."+v+ur("0",Pn(i[1]).length-v.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+$s(""+f);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hi(e,t,-r):$s(""+r)+"."+ur("0",i[1].length);if(i=t.match(/^#,#*,#0/))return hi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ic(hi(e,t.replace(/[\\-]/g,""),r)),s=0,ic(ic(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(wP))return a=hi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=Th(f,Math.pow(10,s)-1,!1),a=""+d,h=Ki("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=Ch(l[2],s),h.length<i[4].length&&(h=Pn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=Th(f,Math.pow(10,s)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?kb(l[1],s)+i[2]+"/"+i[3]+Ch(l[2],s):ur(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Pn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,x=t.length-a.length-m;return Pn(t.substr(0,m)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+hi(e,t,-r):$s(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ti(0,3-y.length):"")+y})+"."+ti(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=$s(""+f);return g!=="0"?d+g:"";default:if(t.match(/\.[0#?]*$/))return hi(e,t.slice(0,t.lastIndexOf(".")),r)+Pn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ki(e,t,r){return(r|0)===r?hi(e,t,r):Aa(e,t,r)}function qX(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var NP=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Ah(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(NP))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function XX(e,t,r,n){for(var a=[],i="",s=0,l="",f="t",d,h,m,x="H";s<e.length;)switch(l=e.charAt(s)){case"G":if(!Ah(e,s))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(m=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++s;break;case"\\":var g=e.charAt(++s),y=g==="("||g===")"?g:"t";a[a.length]={t:y,v:g},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(d==null&&(d=Io(t,r,e.charAt(s+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},f=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Io(t,r),d==null))return"";for(i=l;++s<e.length&&e.charAt(s).toLowerCase()===l;)i+=l;l==="m"&&f.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=x),a[a.length]={t:l,v:i},f=l;break;case"A":case"a":case"":var v={t:l,v:l};if(d==null&&(d=Io(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(d!=null&&(v.v=d.H>=12?"P":"A"),v.t="T",x="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(d!=null&&(v.v=d.H>=12?"PM":"AM"),v.t="T",s+=5,x="h"):e.substr(s,5).toUpperCase()==="/"?(d!=null&&(v.v=d.H>=12?"":""),v.t="T",s+=5,x="h"):(v.t="t",++s),d==null&&v.t==="T")return"";a[a.length]=v,f=l;break;case"[":for(i=l;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(NP)){if(d==null&&(d=Io(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mc(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++s<e.length&&(l=e.charAt(s))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++s<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(s))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++s)===l;)i+=l;a[a.length]={t:l,v:i},f=l;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++s;break}var b=0,E=0,N;for(s=a.length-1,f="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=x,f="h",b<1&&(b=1);break;case"s":(N=a[s].v.match(/\.0+$/))&&(E=Math.max(E,N[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":f=a[s].t;break;case"m":f==="s"&&(a[s].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[s].v.match(/[Hh]/)&&(b=1),b<2&&a[s].v.match(/[Mm]/)&&(b=2),b<3&&a[s].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var S="",j;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=BX(a[s].t.charCodeAt(0),a[s].v,d,E),a[s].t="t";break;case"n":case"?":for(j=s+1;a[j]!=null&&((l=a[j].t)==="?"||l==="D"||(l===" "||l==="t")&&a[j+1]!=null&&(a[j+1].t==="?"||a[j+1].t==="t"&&a[j+1].v==="/")||a[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[j].v==="/"||a[j].v===" "&&a[j+1]!=null&&a[j+1].t=="?"));)a[s].v+=a[j].v,a[j]={v:"",t:";"},++j;S+=a[s].v,s=j-1;break;case"G":a[s].t="t",a[s].v=Zo(t,r);break}var T="",C,P;if(S.length>0){S.charCodeAt(0)==40?(C=t<0&&S.charCodeAt(0)===45?-t:t,P=Ki("n",S,C)):(C=t<0&&n>1?-t:t,P=Ki("n",S,C),C<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),j=P.length-1;var M=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){M=s;break}var D=a.length;if(M===a.length&&P.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(j>=a[s].v.length-1?(j-=a[s].v.length,a[s].v=P.substr(j+1,a[s].v.length)):j<0?a[s].v="":(a[s].v=P.substr(0,j+1),j=-1),a[s].t="t",D=s);j>=0&&D<a.length&&(a[D].v=P.substr(0,j+1)+a[D].v)}else if(M!==a.length&&P.indexOf("E")===-1){for(j=P.indexOf(".")-1,s=M;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(h=a[s].v.indexOf(".")>-1&&s===M?a[s].v.indexOf(".")-1:a[s].v.length-1,T=a[s].v.substr(h+1);h>=0;--h)j>=0&&(a[s].v.charAt(h)==="0"||a[s].v.charAt(h)==="#")&&(T=P.charAt(j--)+T);a[s].v=T,a[s].t="t",D=s}for(j>=0&&D<a.length&&(a[D].v=P.substr(0,j+1)+a[D].v),j=P.indexOf(".")+1,s=M;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==M)){for(h=a[s].v.indexOf(".")>-1&&s===M?a[s].v.indexOf(".")+1:0,T=a[s].v.substr(0,h);h<a[s].v.length;++h)j<P.length&&(T+=P.charAt(j++));a[s].v=T,a[s].t="t",D=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(C=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Ki(a[s].t,a[s].v,C),a[s].t="t");var W="";for(s=0;s!==a.length;++s)a[s]!=null&&(W+=a[s].v);return W}var cj=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function uj(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function YX(e,t){var r=qX(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(cj),l=r[1].match(cj);return uj(t,s)?[n,r[0]]:uj(t,l)?[n,r[1]]:[n,r[s!=null&&l!=null?2:1]]}return[n,i]}function Ba(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[e],n==null&&(n=r.table&&r.table[sj[e]]||it[sj[e]]),n==null&&(n=OX[e]||"General");break}if(Ah(n,0))return Zo(t,r);t instanceof Date&&(t=pP(t,r.date1904));var a=YX(n,t);if(Ah(a[1]))return Zo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return XX(a[1],t,r,a[0])}function qi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(it[r]==null){t<0&&(t=r);continue}if(it[r]==e){t=r;break}}t<0&&(t=391)}return it[t]=e,t}function km(e){for(var t=0;t!=392;++t)e[t]!==void 0&&qi(e[t],t)}function Rc(){it=PX()}var JX={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},EP=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function QX(e){var t=typeof e=="number"?it[e]:e;return t=t.replace(EP,"(\\d+)"),new RegExp("^"+t+"$")}function ZX(e,t,r){var n=-1,a=-1,i=-1,s=-1,l=-1,f=-1;(t.match(EP)||[]).forEach(function(m,x){var g=parseInt(r[x+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":s=g;break;case"s":f=g;break;case"m":s>=0?l=g:a=g;break}}),f>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return s==-1&&l==-1&&f==-1?d:n==-1&&a==-1&&i==-1?h:d+"T"+h}var eY=(function(){var e={};e.version="1.2.0";function t(){for(var P=0,M=new Array(256),D=0;D!=256;++D)P=D,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,M[D]=P;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function n(P){var M=0,D=0,W=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)F[W]=P[W];for(W=0;W!=256;++W)for(D=P[W],M=256+W;M<4096;M+=256)D=F[M]=D>>>8^P[D&255];var L=[];for(W=1;W!=16;++W)L[W-1]=typeof Int32Array<"u"?F.subarray(W*256,W*256+256):F.slice(W*256,W*256+256);return L}var a=n(r),i=a[0],s=a[1],l=a[2],f=a[3],d=a[4],h=a[5],m=a[6],x=a[7],g=a[8],y=a[9],v=a[10],b=a[11],E=a[12],N=a[13],S=a[14];function j(P,M){for(var D=M^-1,W=0,F=P.length;W<F;)D=D>>>8^r[(D^P.charCodeAt(W++))&255];return~D}function T(P,M){for(var D=M^-1,W=P.length-15,F=0;F<W;)D=S[P[F++]^D&255]^N[P[F++]^D>>8&255]^E[P[F++]^D>>16&255]^b[P[F++]^D>>>24]^v[P[F++]]^y[P[F++]]^g[P[F++]]^x[P[F++]]^m[P[F++]]^h[P[F++]]^d[P[F++]]^f[P[F++]]^l[P[F++]]^s[P[F++]]^i[P[F++]]^r[P[F++]];for(W+=15;F<W;)D=D>>>8^r[(D^P[F++])&255];return~D}function C(P,M){for(var D=M^-1,W=0,F=P.length,L=0,J=0;W<F;)L=P.charCodeAt(W++),L<128?D=D>>>8^r[(D^L)&255]:L<2048?(D=D>>>8^r[(D^(192|L>>6&31))&255],D=D>>>8^r[(D^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,J=P.charCodeAt(W++)&1023,D=D>>>8^r[(D^(240|L>>8&7))&255],D=D>>>8^r[(D^(128|L>>2&63))&255],D=D>>>8^r[(D^(128|J>>6&15|(L&3)<<4))&255],D=D>>>8^r[(D^(128|J&63))&255]):(D=D>>>8^r[(D^(224|L>>12&15))&255],D=D>>>8^r[(D^(128|L>>6&63))&255],D=D>>>8^r[(D^(128|L&63))&255]);return~D}return e.table=r,e.bstr=j,e.buf=T,e.str=C,e})(),tt=(function(){var t={};t.version="1.2.1";function r(U,ee){for(var X=U.split("/"),Y=ee.split("/"),te=0,ne=0,ye=Math.min(X.length,Y.length);te<ye;++te){if(ne=X[te].length-Y[te].length)return ne;if(X[te]!=Y[te])return X[te]<Y[te]?-1:1}return X.length-Y.length}function n(U){if(U.charAt(U.length-1)=="/")return U.slice(0,-1).indexOf("/")===-1?U:n(U.slice(0,-1));var ee=U.lastIndexOf("/");return ee===-1?U:U.slice(0,ee+1)}function a(U){if(U.charAt(U.length-1)=="/")return a(U.slice(0,-1));var ee=U.lastIndexOf("/");return ee===-1?U:U.slice(ee+1)}function i(U,ee){typeof ee=="string"&&(ee=new Date(ee));var X=ee.getHours();X=X<<6|ee.getMinutes(),X=X<<5|ee.getSeconds()>>>1,U.write_shift(2,X);var Y=ee.getFullYear()-1980;Y=Y<<4|ee.getMonth()+1,Y=Y<<5|ee.getDate(),U.write_shift(2,Y)}function s(U){var ee=U.read_shift(2)&65535,X=U.read_shift(2)&65535,Y=new Date,te=X&31;X>>>=5;var ne=X&15;X>>>=4,Y.setMilliseconds(0),Y.setFullYear(X+1980),Y.setMonth(ne-1),Y.setDate(te);var ye=ee&31;ee>>>=5;var _e=ee&63;return ee>>>=6,Y.setHours(ee),Y.setMinutes(_e),Y.setSeconds(ye<<1),Y}function l(U){cn(U,0);for(var ee={},X=0;U.l<=U.length-4;){var Y=U.read_shift(2),te=U.read_shift(2),ne=U.l+te,ye={};Y===21589&&(X=U.read_shift(1),X&1&&(ye.mtime=U.read_shift(4)),te>5&&(X&2&&(ye.atime=U.read_shift(4)),X&4&&(ye.ctime=U.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3))),U.l=ne,ee[Y]=ye}return ee}var f;function d(){return f||(f={})}function h(U,ee){if(U[0]==80&&U[1]==75)return tn(U,ee);if((U[0]|32)==109&&(U[1]|32)==105)return ed(U,ee);if(U.length<512)throw new Error("CFB file size "+U.length+" < 512");var X=3,Y=512,te=0,ne=0,ye=0,_e=0,ve=0,be=[],we=U.slice(0,512);cn(we,0);var Fe=m(we);switch(X=Fe[0],X){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Fe[1]==0)return tn(U,ee);default:throw new Error("Major Version: Expected 3 or 4 saw "+X)}Y!==512&&(we=U.slice(0,Y),cn(we,28));var ze=U.slice(0,Y);x(we,X);var Ve=we.read_shift(4,"i");if(X===3&&Ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ve);we.l+=4,ye=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),_e=we.read_shift(4,"i"),te=we.read_shift(4,"i"),ve=we.read_shift(4,"i"),ne=we.read_shift(4,"i");for(var Me=-1,Ie=0;Ie<109&&(Me=we.read_shift(4,"i"),!(Me<0));++Ie)be[Ie]=Me;var dt=g(U,Y);b(ve,ne,dt,Y,be);var Lt=N(dt,ye,be,Y);Lt[ye].name="!Directory",te>0&&_e!==J&&(Lt[_e].name="!MiniFAT"),Lt[be[0]].name="!FAT",Lt.fat_addrs=be,Lt.ssz=Y;var Ut={},hr=[],fo=[],hs=[];S(ye,Lt,dt,hr,te,Ut,fo,_e),y(fo,hs,hr),hr.shift();var si={FileIndex:fo,FullPaths:hs};return ee&&ee.raw&&(si.raw={header:ze,sectors:dt}),si}function m(U){if(U[U.l]==80&&U[U.l+1]==75)return[0,0];U.chk(se,"Header Signature: "),U.l+=16;var ee=U.read_shift(2,"u");return[U.read_shift(2,"u"),ee]}function x(U,ee){var X=9;switch(U.l+=2,X=U.read_shift(2)){case 9:if(ee!=3)throw new Error("Sector Shift: Expected 9 saw "+X);break;case 12:if(ee!=4)throw new Error("Sector Shift: Expected 12 saw "+X);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+X)}U.chk("0600","Mini Sector Shift: "),U.chk("000000000000","Reserved: ")}function g(U,ee){for(var X=Math.ceil(U.length/ee)-1,Y=[],te=1;te<X;++te)Y[te-1]=U.slice(te*ee,(te+1)*ee);return Y[X-1]=U.slice(X*ee),Y}function y(U,ee,X){for(var Y=0,te=0,ne=0,ye=0,_e=0,ve=X.length,be=[],we=[];Y<ve;++Y)be[Y]=we[Y]=Y,ee[Y]=X[Y];for(;_e<we.length;++_e)Y=we[_e],te=U[Y].L,ne=U[Y].R,ye=U[Y].C,be[Y]===Y&&(te!==-1&&be[te]!==te&&(be[Y]=be[te]),ne!==-1&&be[ne]!==ne&&(be[Y]=be[ne])),ye!==-1&&(be[ye]=Y),te!==-1&&Y!=be[Y]&&(be[te]=be[Y],we.lastIndexOf(te)<_e&&we.push(te)),ne!==-1&&Y!=be[Y]&&(be[ne]=be[Y],we.lastIndexOf(ne)<_e&&we.push(ne));for(Y=1;Y<ve;++Y)be[Y]===Y&&(ne!==-1&&be[ne]!==ne?be[Y]=be[ne]:te!==-1&&be[te]!==te&&(be[Y]=be[te]));for(Y=1;Y<ve;++Y)if(U[Y].type!==0){if(_e=Y,_e!=be[_e])do _e=be[_e],ee[Y]=ee[_e]+"/"+ee[Y];while(_e!==0&&be[_e]!==-1&&_e!=be[_e]);be[Y]=-1}for(ee[0]+="/",Y=1;Y<ve;++Y)U[Y].type!==2&&(ee[Y]+="/")}function v(U,ee,X){for(var Y=U.start,te=U.size,ne=[],ye=Y;X&&te>0&&ye>=0;)ne.push(ee.slice(ye*L,ye*L+L)),te-=L,ye=To(X,ye*4);return ne.length===0?Ee(0):Kr(ne).slice(0,U.size)}function b(U,ee,X,Y,te){var ne=J;if(U===J){if(ee!==0)throw new Error("DIFAT chain shorter than expected")}else if(U!==-1){var ye=X[U],_e=(Y>>>2)-1;if(!ye)return;for(var ve=0;ve<_e&&(ne=To(ye,ve*4))!==J;++ve)te.push(ne);b(To(ye,Y-4),ee-1,X,Y,te)}}function E(U,ee,X,Y,te){var ne=[],ye=[];te||(te=[]);var _e=Y-1,ve=0,be=0;for(ve=ee;ve>=0;){te[ve]=!0,ne[ne.length]=ve,ye.push(U[ve]);var we=X[Math.floor(ve*4/Y)];if(be=ve*4&_e,Y<4+be)throw new Error("FAT boundary crossed: "+ve+" 4 "+Y);if(!U[we])break;ve=To(U[we],be)}return{nodes:ne,data:Sj([ye])}}function N(U,ee,X,Y){var te=U.length,ne=[],ye=[],_e=[],ve=[],be=Y-1,we=0,Fe=0,ze=0,Ve=0;for(we=0;we<te;++we)if(_e=[],ze=we+ee,ze>=te&&(ze-=te),!ye[ze]){ve=[];var Me=[];for(Fe=ze;Fe>=0;){Me[Fe]=!0,ye[Fe]=!0,_e[_e.length]=Fe,ve.push(U[Fe]);var Ie=X[Math.floor(Fe*4/Y)];if(Ve=Fe*4&be,Y<4+Ve)throw new Error("FAT boundary crossed: "+Fe+" 4 "+Y);if(!U[Ie]||(Fe=To(U[Ie],Ve),Me[Fe]))break}ne[ze]={nodes:_e,data:Sj([ve])}}return ne}function S(U,ee,X,Y,te,ne,ye,_e){for(var ve=0,be=Y.length?2:0,we=ee[U].data,Fe=0,ze=0,Ve;Fe<we.length;Fe+=128){var Me=we.slice(Fe,Fe+128);cn(Me,64),ze=Me.read_shift(2),Ve=Db(Me,0,ze-be),Y.push(Ve);var Ie={name:Ve,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},dt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);dt!==0&&(Ie.ct=j(Me,Me.l-8));var Lt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Lt!==0&&(Ie.mt=j(Me,Me.l-8)),Ie.start=Me.read_shift(4,"i"),Ie.size=Me.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=J,Ie.name=""),Ie.type===5?(ve=Ie.start,te>0&&ve!==J&&(ee[ve].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",ee[Ie.start]===void 0&&(ee[Ie.start]=E(X,Ie.start,ee.fat_addrs,ee.ssz)),ee[Ie.start].name=Ie.name,Ie.content=ee[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:ve!==J&&Ie.start!==J&&ee[ve]&&(Ie.content=v(Ie,ee[ve].data,(ee[_e]||{}).data))),Ie.content&&cn(Ie.content,0),ne[Ve]=Ie,ye.push(Ie)}}function j(U,ee){return new Date((la(U,ee+4)/1e7*Math.pow(2,32)+la(U,ee)/1e7-11644473600)*1e3)}function T(U,ee){return d(),h(f.readFileSync(U),ee)}function C(U,ee){var X=ee&&ee.type;switch(X||pt&&Buffer.isBuffer(U)&&(X="buffer"),X||"base64"){case"file":return T(U,ee);case"base64":return h(ua(xa(U)),ee);case"binary":return h(ua(U),ee)}return h(U,ee)}function P(U,ee){var X=ee||{},Y=X.root||"Root Entry";if(U.FullPaths||(U.FullPaths=[]),U.FileIndex||(U.FileIndex=[]),U.FullPaths.length!==U.FileIndex.length)throw new Error("inconsistent CFB structure");U.FullPaths.length===0&&(U.FullPaths[0]=Y+"/",U.FileIndex[0]={name:Y,type:5}),X.CLSID&&(U.FileIndex[0].clsid=X.CLSID),M(U)}function M(U){var ee="Sh33tJ5";if(!tt.find(U,"/"+ee)){var X=Ee(4);X[0]=55,X[1]=X[3]=50,X[2]=54,U.FileIndex.push({name:ee,type:2,content:X,size:4,L:69,R:69,C:69}),U.FullPaths.push(U.FullPaths[0]+ee),D(U)}}function D(U,ee){P(U);for(var X=!1,Y=!1,te=U.FullPaths.length-1;te>=0;--te){var ne=U.FileIndex[te];switch(ne.type){case 0:Y?X=!0:(U.FileIndex.pop(),U.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(ne.R*ne.L*ne.C)&&(X=!0),ne.R>-1&&ne.L>-1&&ne.R==ne.L&&(X=!0);break;default:X=!0;break}}if(!(!X&&!ee)){var ye=new Date(1987,1,19),_e=0,ve=Object.create?Object.create(null):{},be=[];for(te=0;te<U.FullPaths.length;++te)ve[U.FullPaths[te]]=!0,U.FileIndex[te].type!==0&&be.push([U.FullPaths[te],U.FileIndex[te]]);for(te=0;te<be.length;++te){var we=n(be[te][0]);Y=ve[we],Y||(be.push([we,{name:a(we).replace("/",""),type:1,clsid:he,ct:ye,mt:ye,content:null}]),ve[we]=!0)}for(be.sort(function(Ve,Me){return r(Ve[0],Me[0])}),U.FullPaths=[],U.FileIndex=[],te=0;te<be.length;++te)U.FullPaths[te]=be[te][0],U.FileIndex[te]=be[te][1];for(te=0;te<be.length;++te){var Fe=U.FileIndex[te],ze=U.FullPaths[te];if(Fe.name=a(ze).replace("/",""),Fe.L=Fe.R=Fe.C=-(Fe.color=1),Fe.size=Fe.content?Fe.content.length:0,Fe.start=0,Fe.clsid=Fe.clsid||he,te===0)Fe.C=be.length>1?1:-1,Fe.size=0,Fe.type=5;else if(ze.slice(-1)=="/"){for(_e=te+1;_e<be.length&&n(U.FullPaths[_e])!=ze;++_e);for(Fe.C=_e>=be.length?-1:_e,_e=te+1;_e<be.length&&n(U.FullPaths[_e])!=n(ze);++_e);Fe.R=_e>=be.length?-1:_e,Fe.type=1}else n(U.FullPaths[te+1]||"")==n(ze)&&(Fe.R=te+1),Fe.type=2}}}function W(U,ee){var X=ee||{};if(X.fileType=="mad")return co(U,X);if(D(U),X.fileType==="zip")return $r(U,X);var Y=(function(Ve){for(var Me=0,Ie=0,dt=0;dt<Ve.FileIndex.length;++dt){var Lt=Ve.FileIndex[dt];if(Lt.content){var Ut=Lt.content.length;Ut>0&&(Ut<4096?Me+=Ut+63>>6:Ie+=Ut+511>>9)}}for(var hr=Ve.FullPaths.length+3>>2,fo=Me+7>>3,hs=Me+127>>7,si=fo+Ie+hr+hs,Ur=si+127>>7,Wc=Ur<=109?0:Math.ceil((Ur-109)/127);si+Ur+Wc+127>>7>Ur;)Wc=++Ur<=109?0:Math.ceil((Ur-109)/127);var mr=[1,Wc,Ur,hs,hr,Ie,Me,0];return Ve.FileIndex[0].size=Me<<6,mr[7]=(Ve.FileIndex[0].start=mr[0]+mr[1]+mr[2]+mr[3]+mr[4]+mr[5])+(mr[6]+7>>3),mr})(U),te=Ee(Y[7]<<9),ne=0,ye=0;{for(ne=0;ne<8;++ne)te.write_shift(1,Z[ne]);for(ne=0;ne<8;++ne)te.write_shift(2,0);for(te.write_shift(2,62),te.write_shift(2,3),te.write_shift(2,65534),te.write_shift(2,9),te.write_shift(2,6),ne=0;ne<3;++ne)te.write_shift(2,0);for(te.write_shift(4,0),te.write_shift(4,Y[2]),te.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),te.write_shift(4,0),te.write_shift(4,4096),te.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:J),te.write_shift(4,Y[3]),te.write_shift(-4,Y[1]?Y[0]-1:J),te.write_shift(4,Y[1]),ne=0;ne<109;++ne)te.write_shift(-4,ne<Y[2]?Y[1]+ne:-1)}if(Y[1])for(ye=0;ye<Y[1];++ye){for(;ne<236+ye*127;++ne)te.write_shift(-4,ne<Y[2]?Y[1]+ne:-1);te.write_shift(-4,ye===Y[1]-1?J:ye+1)}var _e=function(Ve){for(ye+=Ve;ne<ye-1;++ne)te.write_shift(-4,ne+1);Ve&&(++ne,te.write_shift(-4,J))};for(ye=ne=0,ye+=Y[1];ne<ye;++ne)te.write_shift(-4,le.DIFSECT);for(ye+=Y[2];ne<ye;++ne)te.write_shift(-4,le.FATSECT);_e(Y[3]),_e(Y[4]);for(var ve=0,be=0,we=U.FileIndex[0];ve<U.FileIndex.length;++ve)we=U.FileIndex[ve],we.content&&(be=we.content.length,!(be<4096)&&(we.start=ye,_e(be+511>>9)));for(_e(Y[6]+7>>3);te.l&511;)te.write_shift(-4,le.ENDOFCHAIN);for(ye=ne=0,ve=0;ve<U.FileIndex.length;++ve)we=U.FileIndex[ve],we.content&&(be=we.content.length,!(!be||be>=4096)&&(we.start=ye,_e(be+63>>6)));for(;te.l&511;)te.write_shift(-4,le.ENDOFCHAIN);for(ne=0;ne<Y[4]<<2;++ne){var Fe=U.FullPaths[ne];if(!Fe||Fe.length===0){for(ve=0;ve<17;++ve)te.write_shift(4,0);for(ve=0;ve<3;++ve)te.write_shift(4,-1);for(ve=0;ve<12;++ve)te.write_shift(4,0);continue}we=U.FileIndex[ne],ne===0&&(we.start=we.size?we.start-1:J);var ze=ne===0&&X.root||we.name;if(be=2*(ze.length+1),te.write_shift(64,ze,"utf16le"),te.write_shift(2,be),te.write_shift(1,we.type),te.write_shift(1,we.color),te.write_shift(-4,we.L),te.write_shift(-4,we.R),te.write_shift(-4,we.C),we.clsid)te.write_shift(16,we.clsid,"hex");else for(ve=0;ve<4;++ve)te.write_shift(4,0);te.write_shift(4,we.state||0),te.write_shift(4,0),te.write_shift(4,0),te.write_shift(4,0),te.write_shift(4,0),te.write_shift(4,we.start),te.write_shift(4,we.size),te.write_shift(4,0)}for(ne=1;ne<U.FileIndex.length;++ne)if(we=U.FileIndex[ne],we.size>=4096)if(te.l=we.start+1<<9,pt&&Buffer.isBuffer(we.content))we.content.copy(te,te.l,0,we.size),te.l+=we.size+511&-512;else{for(ve=0;ve<we.size;++ve)te.write_shift(1,we.content[ve]);for(;ve&511;++ve)te.write_shift(1,0)}for(ne=1;ne<U.FileIndex.length;++ne)if(we=U.FileIndex[ne],we.size>0&&we.size<4096)if(pt&&Buffer.isBuffer(we.content))we.content.copy(te,te.l,0,we.size),te.l+=we.size+63&-64;else{for(ve=0;ve<we.size;++ve)te.write_shift(1,we.content[ve]);for(;ve&63;++ve)te.write_shift(1,0)}if(pt)te.l=te.length;else for(;te.l<te.length;)te.write_shift(1,0);return te}function F(U,ee){var X=U.FullPaths.map(function(ve){return ve.toUpperCase()}),Y=X.map(function(ve){var be=ve.split("/");return be[be.length-(ve.slice(-1)=="/"?2:1)]}),te=!1;ee.charCodeAt(0)===47?(te=!0,ee=X[0].slice(0,-1)+ee):te=ee.indexOf("/")!==-1;var ne=ee.toUpperCase(),ye=te===!0?X.indexOf(ne):Y.indexOf(ne);if(ye!==-1)return U.FileIndex[ye];var _e=!ne.match(Ru);for(ne=ne.replace(Mn,""),_e&&(ne=ne.replace(Ru,"!")),ye=0;ye<X.length;++ye)if((_e?X[ye].replace(Ru,"!"):X[ye]).replace(Mn,"")==ne||(_e?Y[ye].replace(Ru,"!"):Y[ye]).replace(Mn,"")==ne)return U.FileIndex[ye];return null}var L=64,J=-2,se="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function de(U,ee,X){d();var Y=W(U,X);f.writeFileSync(ee,Y)}function Q(U){for(var ee=new Array(U.length),X=0;X<U.length;++X)ee[X]=String.fromCharCode(U[X]);return ee.join("")}function pe(U,ee){var X=W(U,ee);switch(ee&&ee.type||"buffer"){case"file":return d(),f.writeFileSync(ee.filename,X),X;case"binary":return typeof X=="string"?X:Q(X);case"base64":return hf(typeof X=="string"?X:Q(X));case"buffer":if(pt)return Buffer.isBuffer(X)?X:us(X);case"array":return typeof X=="string"?ua(X):X}return X}var re;function O(U){try{var ee=U.InflateRaw,X=new ee;if(X._processChunk(new Uint8Array([3,0]),X._finishFlushFlag),X.bytesRead)re=U;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function V(U,ee){if(!re)return jr(U,ee);var X=re.InflateRaw,Y=new X,te=Y._processChunk(U.slice(U.l),Y._finishFlushFlag);return U.l+=Y.bytesRead,te}function H(U){return re?re.deflateRawSync(U):ut(U)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function B(U){var ee=(U<<1|U<<11)&139536|(U<<5|U<<15)&558144;return(ee>>16|ee>>8|ee)&255}for(var z=typeof Uint8Array<"u",G=z?new Uint8Array(256):[],ce=0;ce<256;++ce)G[ce]=B(ce);function I(U,ee){var X=G[U&255];return ee<=8?X>>>8-ee:(X=X<<8|G[U>>8&255],ee<=16?X>>>16-ee:(X=X<<8|G[U>>16&255],X>>>24-ee))}function Ae(U,ee){var X=ee&7,Y=ee>>>3;return(U[Y]|(X<=6?0:U[Y+1]<<8))>>>X&3}function je(U,ee){var X=ee&7,Y=ee>>>3;return(U[Y]|(X<=5?0:U[Y+1]<<8))>>>X&7}function Le(U,ee){var X=ee&7,Y=ee>>>3;return(U[Y]|(X<=4?0:U[Y+1]<<8))>>>X&15}function Ue(U,ee){var X=ee&7,Y=ee>>>3;return(U[Y]|(X<=3?0:U[Y+1]<<8))>>>X&31}function Pe(U,ee){var X=ee&7,Y=ee>>>3;return(U[Y]|(X<=1?0:U[Y+1]<<8))>>>X&127}function lt(U,ee,X){var Y=ee&7,te=ee>>>3,ne=(1<<X)-1,ye=U[te]>>>Y;return X<8-Y||(ye|=U[te+1]<<8-Y,X<16-Y)||(ye|=U[te+2]<<16-Y,X<24-Y)||(ye|=U[te+3]<<24-Y),ye&ne}function kt(U,ee,X){var Y=ee&7,te=ee>>>3;return Y<=5?U[te]|=(X&7)<<Y:(U[te]|=X<<Y&255,U[te+1]=(X&7)>>8-Y),ee+3}function Yt(U,ee,X){var Y=ee&7,te=ee>>>3;return X=(X&1)<<Y,U[te]|=X,ee+1}function jt(U,ee,X){var Y=ee&7,te=ee>>>3;return X<<=Y,U[te]|=X&255,X>>>=8,U[te+1]=X,ee+8}function Wa(U,ee,X){var Y=ee&7,te=ee>>>3;return X<<=Y,U[te]|=X&255,X>>>=8,U[te+1]=X&255,U[te+2]=X>>>8,ee+16}function Ln(U,ee){var X=U.length,Y=2*X>ee?2*X:ee+5,te=0;if(X>=ee)return U;if(pt){var ne=nj(Y);if(U.copy)U.copy(ne);else for(;te<U.length;++te)ne[te]=U[te];return ne}else if(z){var ye=new Uint8Array(Y);if(ye.set)ye.set(U);else for(;te<X;++te)ye[te]=U[te];return ye}return U.length=Y,U}function Br(U){for(var ee=new Array(U),X=0;X<U;++X)ee[X]=0;return ee}function tr(U,ee,X){var Y=1,te=0,ne=0,ye=0,_e=0,ve=U.length,be=z?new Uint16Array(32):Br(32);for(ne=0;ne<32;++ne)be[ne]=0;for(ne=ve;ne<X;++ne)U[ne]=0;ve=U.length;var we=z?new Uint16Array(ve):Br(ve);for(ne=0;ne<ve;++ne)be[te=U[ne]]++,Y<te&&(Y=te),we[ne]=0;for(be[0]=0,ne=1;ne<=Y;++ne)be[ne+16]=_e=_e+be[ne-1]<<1;for(ne=0;ne<ve;++ne)_e=U[ne],_e!=0&&(we[ne]=be[_e+16]++);var Fe=0;for(ne=0;ne<ve;++ne)if(Fe=U[ne],Fe!=0)for(_e=I(we[ne],Y)>>Y-Fe,ye=(1<<Y+4-Fe)-1;ye>=0;--ye)ee[_e|ye<<Fe]=Fe&15|ne<<4;return Y}var Bn=z?new Uint16Array(512):Br(512),en=z?new Uint16Array(32):Br(32);if(!z){for(var rr=0;rr<512;++rr)Bn[rr]=0;for(rr=0;rr<32;++rr)en[rr]=0}(function(){for(var U=[],ee=0;ee<32;ee++)U.push(5);tr(U,en,32);var X=[];for(ee=0;ee<=143;ee++)X.push(8);for(;ee<=255;ee++)X.push(9);for(;ee<=279;ee++)X.push(7);for(;ee<=287;ee++)X.push(8);tr(X,Bn,288)})();var Cn=(function(){for(var ee=z?new Uint8Array(32768):[],X=0,Y=0;X<ie.length-1;++X)for(;Y<ie[X+1];++Y)ee[Y]=X;for(;Y<32768;++Y)ee[Y]=29;var te=z?new Uint8Array(259):[];for(X=0,Y=0;X<K.length-1;++X)for(;Y<K[X+1];++Y)te[Y]=X;function ne(_e,ve){for(var be=0;be<_e.length;){var we=Math.min(65535,_e.length-be),Fe=be+we==_e.length;for(ve.write_shift(1,+Fe),ve.write_shift(2,we),ve.write_shift(2,~we&65535);we-- >0;)ve[ve.l++]=_e[be++]}return ve.l}function ye(_e,ve){for(var be=0,we=0,Fe=z?new Uint16Array(32768):[];we<_e.length;){var ze=Math.min(65535,_e.length-we);if(ze<10){for(be=kt(ve,be,+(we+ze==_e.length)),be&7&&(be+=8-(be&7)),ve.l=be/8|0,ve.write_shift(2,ze),ve.write_shift(2,~ze&65535);ze-- >0;)ve[ve.l++]=_e[we++];be=ve.l*8;continue}be=kt(ve,be,+(we+ze==_e.length)+2);for(var Ve=0;ze-- >0;){var Me=_e[we];Ve=(Ve<<5^Me)&32767;var Ie=-1,dt=0;if((Ie=Fe[Ve])&&(Ie|=we&-32768,Ie>we&&(Ie-=32768),Ie<we))for(;_e[Ie+dt]==_e[we+dt]&&dt<250;)++dt;if(dt>2){Me=te[dt],Me<=22?be=jt(ve,be,G[Me+1]>>1)-1:(jt(ve,be,3),be+=5,jt(ve,be,G[Me-23]>>5),be+=3);var Lt=Me<8?0:Me-4>>2;Lt>0&&(Wa(ve,be,dt-K[Me]),be+=Lt),Me=ee[we-Ie],be=jt(ve,be,G[Me]>>3),be-=3;var Ut=Me<4?0:Me-2>>1;Ut>0&&(Wa(ve,be,we-Ie-ie[Me]),be+=Ut);for(var hr=0;hr<dt;++hr)Fe[Ve]=we&32767,Ve=(Ve<<5^_e[we])&32767,++we;ze-=dt-1}else Me<=143?Me=Me+48:be=Yt(ve,be,1),be=jt(ve,be,G[Me]),Fe[Ve]=we&32767,++we}be=jt(ve,be,0)-1}return ve.l=(be+7)/8|0,ve.l}return function(ve,be){return ve.length<8?ne(ve,be):ye(ve,be)}})();function ut(U){var ee=Ee(50+Math.floor(U.length*1.1)),X=Cn(U,ee);return ee.slice(0,X)}var Ct=z?new Uint16Array(32768):Br(32768),oe=z?new Uint16Array(32768):Br(32768),ke=z?new Uint16Array(128):Br(128),Ge=1,Je=1;function We(U,ee){var X=Ue(U,ee)+257;ee+=5;var Y=Ue(U,ee)+1;ee+=5;var te=Le(U,ee)+4;ee+=4;for(var ne=0,ye=z?new Uint8Array(19):Br(19),_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,be=z?new Uint8Array(8):Br(8),we=z?new Uint8Array(8):Br(8),Fe=ye.length,ze=0;ze<te;++ze)ye[q[ze]]=ne=je(U,ee),ve<ne&&(ve=ne),be[ne]++,ee+=3;var Ve=0;for(be[0]=0,ze=1;ze<=ve;++ze)we[ze]=Ve=Ve+be[ze-1]<<1;for(ze=0;ze<Fe;++ze)(Ve=ye[ze])!=0&&(_e[ze]=we[Ve]++);var Me=0;for(ze=0;ze<Fe;++ze)if(Me=ye[ze],Me!=0){Ve=G[_e[ze]]>>8-Me;for(var Ie=(1<<7-Me)-1;Ie>=0;--Ie)ke[Ve|Ie<<Me]=Me&7|ze<<3}var dt=[];for(ve=1;dt.length<X+Y;)switch(Ve=ke[Pe(U,ee)],ee+=Ve&7,Ve>>>=3){case 16:for(ne=3+Ae(U,ee),ee+=2,Ve=dt[dt.length-1];ne-- >0;)dt.push(Ve);break;case 17:for(ne=3+je(U,ee),ee+=3;ne-- >0;)dt.push(0);break;case 18:for(ne=11+Pe(U,ee),ee+=7;ne-- >0;)dt.push(0);break;default:dt.push(Ve),ve<Ve&&(ve=Ve);break}var Lt=dt.slice(0,X),Ut=dt.slice(X);for(ze=X;ze<286;++ze)Lt[ze]=0;for(ze=Y;ze<30;++ze)Ut[ze]=0;return Ge=tr(Lt,Ct,286),Je=tr(Ut,oe,30),ee}function at(U,ee){if(U[0]==3&&!(U[1]&3))return[Xs(ee),2];for(var X=0,Y=0,te=nj(ee||1<<18),ne=0,ye=te.length>>>0,_e=0,ve=0;(Y&1)==0;){if(Y=je(U,X),X+=3,Y>>>1)Y>>1==1?(_e=9,ve=5):(X=We(U,X),_e=Ge,ve=Je);else{X&7&&(X+=8-(X&7));var be=U[X>>>3]|U[(X>>>3)+1]<<8;if(X+=32,be>0)for(!ee&&ye<ne+be&&(te=Ln(te,ne+be),ye=te.length);be-- >0;)te[ne++]=U[X>>>3],X+=8;continue}for(;;){!ee&&ye<ne+32767&&(te=Ln(te,ne+32767),ye=te.length);var we=lt(U,X,_e),Fe=Y>>>1==1?Bn[we]:Ct[we];if(X+=Fe&15,Fe>>>=4,(Fe>>>8&255)===0)te[ne++]=Fe;else{if(Fe==256)break;Fe-=257;var ze=Fe<8?0:Fe-4>>2;ze>5&&(ze=0);var Ve=ne+K[Fe];ze>0&&(Ve+=lt(U,X,ze),X+=ze),we=lt(U,X,ve),Fe=Y>>>1==1?en[we]:oe[we],X+=Fe&15,Fe>>>=4;var Me=Fe<4?0:Fe-2>>1,Ie=ie[Fe];for(Me>0&&(Ie+=lt(U,X,Me),X+=Me),!ee&&ye<Ve&&(te=Ln(te,Ve+100),ye=te.length);ne<Ve;)te[ne]=te[ne-Ie],++ne}}}return ee?[te,X+7>>>3]:[te.slice(0,ne),X+7>>>3]}function jr(U,ee){var X=U.slice(U.l||0),Y=at(X,ee);return U.l+=Y[1],Y[0]}function Cr(U,ee){if(U)typeof console<"u"&&console.error(ee);else throw new Error(ee)}function tn(U,ee){var X=U;cn(X,0);var Y=[],te=[],ne={FileIndex:Y,FullPaths:te};P(ne,{root:ee.root});for(var ye=X.length-4;(X[ye]!=80||X[ye+1]!=75||X[ye+2]!=5||X[ye+3]!=6)&&ye>=0;)--ye;X.l=ye+4,X.l+=4;var _e=X.read_shift(2);X.l+=6;var ve=X.read_shift(4);for(X.l=ve,ye=0;ye<_e;++ye){X.l+=20;var be=X.read_shift(4),we=X.read_shift(4),Fe=X.read_shift(2),ze=X.read_shift(2),Ve=X.read_shift(2);X.l+=8;var Me=X.read_shift(4),Ie=l(X.slice(X.l+Fe,X.l+Fe+ze));X.l+=Fe+ze+Ve;var dt=X.l;X.l=Me+4,Ar(X,be,we,ne,Ie),X.l=dt}return ne}function Ar(U,ee,X,Y,te){U.l+=2;var ne=U.read_shift(2),ye=U.read_shift(2),_e=s(U);if(ne&8257)throw new Error("Unsupported ZIP encryption");for(var ve=U.read_shift(4),be=U.read_shift(4),we=U.read_shift(4),Fe=U.read_shift(2),ze=U.read_shift(2),Ve="",Me=0;Me<Fe;++Me)Ve+=String.fromCharCode(U[U.l++]);if(ze){var Ie=l(U.slice(U.l,U.l+ze));(Ie[21589]||{}).mt&&(_e=Ie[21589].mt),((te||{})[21589]||{}).mt&&(_e=te[21589].mt)}U.l+=ze;var dt=U.slice(U.l,U.l+be);switch(ye){case 8:dt=V(U,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var Lt=!1;ne&8&&(ve=U.read_shift(4),ve==134695760&&(ve=U.read_shift(4),Lt=!0),be=U.read_shift(4),we=U.read_shift(4)),be!=ee&&Cr(Lt,"Bad compressed size: "+ee+" != "+be),we!=X&&Cr(Lt,"Bad uncompressed size: "+X+" != "+we),Ci(Y,Ve,dt,{unsafe:!0,mt:_e})}function $r(U,ee){var X=ee||{},Y=[],te=[],ne=Ee(1),ye=X.compression?8:0,_e=0,ve=0,be=0,we=0,Fe=0,ze=U.FullPaths[0],Ve=ze,Me=U.FileIndex[0],Ie=[],dt=0;for(ve=1;ve<U.FullPaths.length;++ve)if(Ve=U.FullPaths[ve].slice(ze.length),Me=U.FileIndex[ve],!(!Me.size||!Me.content||Ve=="Sh33tJ5")){var Lt=we,Ut=Ee(Ve.length);for(be=0;be<Ve.length;++be)Ut.write_shift(1,Ve.charCodeAt(be)&127);Ut=Ut.slice(0,Ut.l),Ie[Fe]=eY.buf(Me.content,0);var hr=Me.content;ye==8&&(hr=H(hr)),ne=Ee(30),ne.write_shift(4,67324752),ne.write_shift(2,20),ne.write_shift(2,_e),ne.write_shift(2,ye),Me.mt?i(ne,Me.mt):ne.write_shift(4,0),ne.write_shift(-4,Ie[Fe]),ne.write_shift(4,hr.length),ne.write_shift(4,Me.content.length),ne.write_shift(2,Ut.length),ne.write_shift(2,0),we+=ne.length,Y.push(ne),we+=Ut.length,Y.push(Ut),we+=hr.length,Y.push(hr),ne=Ee(46),ne.write_shift(4,33639248),ne.write_shift(2,0),ne.write_shift(2,20),ne.write_shift(2,_e),ne.write_shift(2,ye),ne.write_shift(4,0),ne.write_shift(-4,Ie[Fe]),ne.write_shift(4,hr.length),ne.write_shift(4,Me.content.length),ne.write_shift(2,Ut.length),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(4,0),ne.write_shift(4,Lt),dt+=ne.l,te.push(ne),dt+=Ut.length,te.push(Ut),++Fe}return ne=Ee(22),ne.write_shift(4,101010256),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,Fe),ne.write_shift(2,Fe),ne.write_shift(4,dt),ne.write_shift(4,we),ne.write_shift(2,0),Kr([Kr(Y),Kr(te),ne])}var $n={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function lo(U,ee){if(U.ctype)return U.ctype;var X=U.name||"",Y=X.match(/\.([^\.]+)$/);return Y&&$n[Y[1]]||ee&&(Y=(X=ee).match(/[\.\\]([^\.\\])+$/),Y&&$n[Y[1]])?$n[Y[1]]:"application/octet-stream"}function $c(U){for(var ee=hf(U),X=[],Y=0;Y<ee.length;Y+=76)X.push(ee.slice(Y,Y+76));return X.join(`\r
`)+`\r
`}function ji(U){var ee=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(be){var we=be.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});ee=ee.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ee.charAt(0)==`
`&&(ee="=0D"+ee.slice(1)),ee=ee.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var X=[],Y=ee.split(`\r
`),te=0;te<Y.length;++te){var ne=Y[te];if(ne.length==0){X.push("");continue}for(var ye=0;ye<ne.length;){var _e=76,ve=ne.slice(ye,ye+_e);ve.charAt(_e-1)=="="?_e--:ve.charAt(_e-2)=="="?_e-=2:ve.charAt(_e-3)=="="&&(_e-=3),ve=ne.slice(ye,ye+_e),ye+=_e,ye<ne.length&&(ve+="="),X.push(ve)}}return X.join(`\r
`)}function Zf(U){for(var ee=[],X=0;X<U.length;++X){for(var Y=U[X];X<=U.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+U[++X];ee.push(Y)}for(var te=0;te<ee.length;++te)ee[te]=ee[te].replace(/[=][0-9A-Fa-f]{2}/g,function(ne){return String.fromCharCode(parseInt(ne.slice(1),16))});return ua(ee.join(`\r
`))}function Uc(U,ee,X){for(var Y="",te="",ne="",ye,_e=0;_e<10;++_e){var ve=ee[_e];if(!ve||ve.match(/^\s*$/))break;var be=ve.match(/^(.*?):\s*([^\s].*)$/);if(be)switch(be[1].toLowerCase()){case"content-location":Y=be[2].trim();break;case"content-type":ne=be[2].trim();break;case"content-transfer-encoding":te=be[2].trim();break}}switch(++_e,te.toLowerCase()){case"base64":ye=ua(xa(ee.slice(_e).join("")));break;case"quoted-printable":ye=Zf(ee.slice(_e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+te)}var we=Ci(U,Y.slice(X.length),ye,{unsafe:!0});ne&&(we.ctype=ne)}function ed(U,ee){if(Q(U.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var X=ee&&ee.root||"",Y=(pt&&Buffer.isBuffer(U)?U.toString("binary"):Q(U)).split(`\r
`),te=0,ne="";for(te=0;te<Y.length;++te)if(ne=Y[te],!!/^Content-Location:/i.test(ne)&&(ne=ne.slice(ne.indexOf("file")),X||(X=ne.slice(0,ne.lastIndexOf("/")+1)),ne.slice(0,X.length)!=X))for(;X.length>0&&(X=X.slice(0,X.length-1),X=X.slice(0,X.lastIndexOf("/")+1),ne.slice(0,X.length)!=X););var ye=(Y[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var _e="--"+(ye[1]||""),ve=[],be=[],we={FileIndex:ve,FullPaths:be};P(we);var Fe,ze=0;for(te=0;te<Y.length;++te){var Ve=Y[te];Ve!==_e&&Ve!==_e+"--"||(ze++&&Uc(we,Y.slice(Fe,te),X),Fe=te)}return we}function co(U,ee){var X=ee||{},Y=X.boundary||"SheetJS";Y="------="+Y;for(var te=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],ne=U.FullPaths[0],ye=ne,_e=U.FileIndex[0],ve=1;ve<U.FullPaths.length;++ve)if(ye=U.FullPaths[ve].slice(ne.length),_e=U.FileIndex[ve],!(!_e.size||!_e.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dt){return"_x"+dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dt){return"_u"+dt.charCodeAt(0).toString(16)+"_"});for(var be=_e.content,we=pt&&Buffer.isBuffer(be)?be.toString("binary"):Q(be),Fe=0,ze=Math.min(1024,we.length),Ve=0,Me=0;Me<=ze;++Me)(Ve=we.charCodeAt(Me))>=32&&Ve<128&&++Fe;var Ie=Fe>=ze*4/5;te.push(Y),te.push("Content-Location: "+(X.root||"file:///C:/SheetJS/")+ye),te.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),te.push("Content-Type: "+lo(_e,ye)),te.push(""),te.push(Ie?ji(we):$c(we))}return te.push(Y+`--\r
`),te.join(`\r
`)}function zc(U){var ee={};return P(ee,U),ee}function Ci(U,ee,X,Y){var te=Y&&Y.unsafe;te||P(U);var ne=!te&&tt.find(U,ee);if(!ne){var ye=U.FullPaths[0];ee.slice(0,ye.length)==ye?ye=ee:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+ee).replace("//","/")),ne={name:a(ee),type:2},U.FileIndex.push(ne),U.FullPaths.push(ye),te||tt.utils.cfb_gc(U)}return ne.content=X,ne.size=X?X.length:0,Y&&(Y.CLSID&&(ne.clsid=Y.CLSID),Y.mt&&(ne.mt=Y.mt),Y.ct&&(ne.ct=Y.ct)),ne}function Dm(U,ee){P(U);var X=tt.find(U,ee);if(X){for(var Y=0;Y<U.FileIndex.length;++Y)if(U.FileIndex[Y]==X)return U.FileIndex.splice(Y,1),U.FullPaths.splice(Y,1),!0}return!1}function uo(U,ee,X){P(U);var Y=tt.find(U,ee);if(Y){for(var te=0;te<U.FileIndex.length;++te)if(U.FileIndex[te]==Y)return U.FileIndex[te].name=a(X),U.FullPaths[te]=X,!0}return!1}function yl(U){D(U,!0)}return t.find=F,t.read=C,t.parse=h,t.write=pe,t.writeFile=de,t.utils={cfb_new:zc,cfb_add:Ci,cfb_del:Dm,cfb_mov:uo,cfb_gc:yl,ReadShift:Hu,CheckField:GP,prep_blob:cn,bconcat:Kr,use_zlib:O,_deflateRaw:ut,_inflateRaw:jr,consts:le},t})();function tY(e){return typeof e=="string"?_m(e):Array.isArray(e)?jX(e):e}function Vf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=_m(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?vi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([tY(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=io(t)),l.write(t),l.close(),t}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+e)}function rY(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function dr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function fj(e,t){for(var r=[],n=dr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function jm(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Cm(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function nY(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Ph=new Date(1899,11,30,0,0,0);function Ir(e,t){var r=e.getTime(),n=Ph.getTime()+(e.getTimezoneOffset()-Ph.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var _P=new Date,aY=Ph.getTime()+(_P.getTimezoneOffset()-Ph.getTimezoneOffset())*6e4,dj=_P.getTimezoneOffset();function Am(e){var t=new Date;return t.setTime(e*24*60*60*1e3+aY),t.getTimezoneOffset()!==dj&&t.setTime(t.getTime()+(t.getTimezoneOffset()-dj)*6e4),t}function iY(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var hj=new Date("2017-02-19T19:06:09.000Z"),kP=isNaN(hj.getFullYear())?new Date("2/19/17"):hj,sY=kP.getFullYear()==2017;function qt(e,t){var r=new Date(e);if(sY)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(kP.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function el(e,t){if(pt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return vi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return vi(hP(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return vi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return vi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Xt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Xt(e[r]));return t}function ur(e,t){for(var r="";r.length<t;)r+=e;return r}function ri(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var oY=["january","february","march","april","may","june","july","august","september","october","november","december"];function Nc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&oY.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var lY=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],l=1;l<i.length;++l)s.push(a),s.push(i[l]);return s}})();function jP(e){return e?e.content&&e.type?el(e.content,!0):e.data?Mu(e.data):e.asNodeBuffer&&pt?Mu(e.asNodeBuffer().toString("binary")):e.asBinary?Mu(e.asBinary()):e._data&&e._data.getContent?Mu(el(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function CP(e){if(!e)return null;if(e.data)return tj(e.data);if(e.asNodeBuffer&&pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?tj(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function cY(e){return e&&e.name.slice(-4)===".bin"?CP(e):jP(e)}function Oa(e,t){for(var r=e.FullPaths||dr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Cb(e,t){var r=Oa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Nr(e,t,r){if(!r)return cY(Cb(e,t));if(!t)return null;try{return Nr(e,t)}catch{return null}}function fa(e,t,r){if(!r)return jP(Cb(e,t));if(!t)return null;try{return fa(e,t)}catch{return null}}function uY(e,t,r){return CP(Cb(e,t))}function mj(e){for(var t=e.FullPaths||dr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function mt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return pt?n=us(r):n=CX(r),tt.utils.cfb_add(e,t,n)}tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ab(){return tt.utils.cfb_new()}function AP(e,t){switch(t.type){case"base64":return tt.read(e,{type:"base64"});case"binary":return tt.read(e,{type:"binary"});case"buffer":case"array":return tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Lu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var br=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fY=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,pj=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,dY=/<[^>]*>/g,jn=br.match(pj)?pj:dY,hY=/<\w*:/,mY=/<(\/?)\w+:/;function ct(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(fY),l=0,f="",d=0,h="",m="",x=1;if(s)for(d=0;d!=s.length;++d){for(m=s[d],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(h=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(x=(a=m.charCodeAt(i+1))==34||a==39?1:0,f=m.slice(i+1+x,m.length-x),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=f,n[h.toLowerCase()]=f;else{var g=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[g]&&h.slice(l-3,l)=="ext")continue;n[g]=f,n[g.toLowerCase()]=f}}return n}function _i(e){return e.replace(mY,"<$1")}var TP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Tb=jm(TP),yt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(l,f){return TP[l]||String.fromCharCode(parseInt(f,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,f){return String.fromCharCode(parseInt(f,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}})(),Pb=/[&<>'"]/g,pY=/[\u0000-\u0008\u000b-\u001f]/g;function It(e){var t=e+"";return t.replace(Pb,function(r){return Tb[r]}).replace(pY,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function xj(e){return It(e).replace(/ /g,"_x0020_")}var PP=/[\u0000-\u001f]/g;function Ob(e){var t=e+"";return t.replace(Pb,function(r){return Tb[r]}).replace(/\n/g,"<br/>").replace(PP,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function xY(e){var t=e+"";return t.replace(Pb,function(r){return Tb[r]}).replace(PP,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var gj=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function gY(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Kt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Zg(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function vj(e){var t=Xs(2*e.length),r,n,a=1,i=0,s=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function yj(e){return us(e,"binary").toString("utf8")}var S0="foo bar baz",Rt=pt&&(yj(S0)==Zg(S0)&&yj||vj(S0)==Zg(S0)&&vj)||Zg,vi=pt?function(e){return us(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},pf=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),OP=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),vY=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),yY=/<\/?(?:vt:)?variant>/g,bY=/<(?:vt:)([^>]*)>([\s\S]*)</;function bj(e,t){var r=ct(e),n=e.match(vY(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(yY,"").match(bY);s&&a.push({v:Rt(s[2]),t:s[1]})}),a}var FP=/(^\s|\s$|\n)/;function fn(e,t){return"<"+e+(t.match(FP)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function xf(e){return dr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?xf(r):"")+(t!=null?(t.match(FP)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function l1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function wY(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",It(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",It(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",l1(e));throw new Error("Unable to serialize "+e)}function Fb(e){if(pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Rt(io(_b(e)));throw new Error("Bad input format: expected Buffer or string")}var gf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Fr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},hl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],oa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function SY(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function NY(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var wj=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Sj=pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:us(t)})):wj(e)}:wj,Nj=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Hi(e,a)));return n.join("").replace(Mn,"")},Db=pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Mn,""):Nj(e,t,r)}:Nj,Ej=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},DP=pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Ej(e,t,r)}:Ej,_j=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Xl(e,a)));return n.join("")},Gf=pt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):_j(t,r,n)}:_j,IP=function(e,t){var r=la(e,t);return r>0?Gf(e,t+4,t+4+r-1):""},MP=IP,RP=function(e,t){var r=la(e,t);return r>0?Gf(e,t+4,t+4+r-1):""},LP=RP,BP=function(e,t){var r=2*la(e,t);return r>0?Gf(e,t+4,t+4+r-1):""},$P=BP,UP=function(t,r){var n=la(t,r);return n>0?Db(t,r+4,r+4+n):""},zP=UP,WP=function(e,t){var r=la(e,t);return r>0?Gf(e,t+4,t+4+r):""},HP=WP,VP=function(e,t){return SY(e,t)},Oh=VP,Ib=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};pt&&(MP=function(t,r){if(!Buffer.isBuffer(t))return IP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},LP=function(t,r){if(!Buffer.isBuffer(t))return RP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},$P=function(t,r){if(!Buffer.isBuffer(t))return BP(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},zP=function(t,r){if(!Buffer.isBuffer(t))return UP(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},HP=function(t,r){if(!Buffer.isBuffer(t))return WP(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Oh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):VP(t,r)},Ib=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Xl=function(e,t){return e[t]},Hi=function(e,t){return e[t+1]*256+e[t]},EY=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},la=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},To=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},_Y=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Hu(e,t){var r="",n,a,i=[],s,l,f,d;switch(t){case"dbcs":if(d=this.l,pt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode(Hi(this,d)),d+=2;e*=2;break;case"utf8":r=Gf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Db(this,this.l,this.l+e);break;case"wstr":return Hu.call(this,e,"dbcs");case"lpstr-ansi":r=MP(this,this.l),e=4+la(this,this.l);break;case"lpstr-cp":r=LP(this,this.l),e=4+la(this,this.l);break;case"lpwstr":r=$P(this,this.l),e=4+2*la(this,this.l);break;case"lpp4":e=4+la(this,this.l),r=zP(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+la(this,this.l),r=HP(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Xl(this,this.l+e++))!==0;)i.push(w0(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Hi(this,this.l+e))!==0;)i.push(w0(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return s=Xl(this,d),this.l=d+1,l=Hu.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(w0(Hi(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return s=Xl(this,d),this.l=d+1,l=Hu.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(w0(Xl(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=Xl(this,this.l),this.l++,n;case 2:return n=(t==="i"?EY:Hi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?To:_Y)(this,this.l),this.l+=4,n):(a=la(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Oh(this,this.l):a=Oh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=DP(this,this.l,e);break}}return this.l+=e,r}var kY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},jY=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},CY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function AY(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)CY(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,kY(this,t,this.l);break;case 8:if(n=8,r==="f"){NY(this,t,this.l);break}case 16:break;case-4:n=4,jY(this,t,this.l);break}return this.l+=n,this}function GP(e,t){var r=DP(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function cn(e,t){e.l=t,e.read_shift=Hu,e.chk=GP,e.write_shift=AY}function kn(e,t){e.l+=t}function Ee(e){var t=Xs(e);return cn(t,0),t}function fs(e,t,r){if(e){var n,a,i;cn(e,e.l||0);for(var s=e.length,l=0,f=0;e.l<s;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=Nf[l]||Nf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;f=e.l+i;var h=d.f&&d.f(e,i,r);if(e.l=f,t(h,d,l))return}}}function Jn(){var e=[],t=pt?256:2048,r=function(d){var h=Ee(d);return cn(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},s=function(){return a(),Kr(e)},l=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:s,_bufs:e}}function Ce(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Nf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Ib(r)&&e.push(r)}}function Vu(e,t,r){var n=Xt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function kj(e,t,r){var n=Xt(e);return n.s=Vu(n.s,t.s,r),n.e=Vu(n.e,t.s,r),n}function Gu(e,t){if(e.cRel&&e.c<0)for(e=Xt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Xt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ot(e);return!e.cRel&&e.cRel!=null&&(r=OY(r)),!e.rRel&&e.rRel!=null&&(r=TY(r)),r}function ev(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sr(e.s.c)+":"+(e.e.cRel?"":"$")+sr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+vr(e.s.r)+":"+(e.e.rRel?"":"$")+vr(e.e.r):Gu(e.s,t.biff)+":"+Gu(e.e,t.biff)}function Mb(e){return parseInt(PY(e),10)-1}function vr(e){return""+(e+1)}function TY(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function PY(e){return e.replace(/\$(\d+)$/,"$1")}function Rb(e){for(var t=FY(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function OY(e){return e.replace(/^([A-Z])/,"$$$1")}function FY(e){return e.replace(/^\$([A-Z])/,"$1")}function DY(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function or(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function ot(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Zn(e){var t=e.indexOf(":");return t==-1?{s:or(e),e:or(e)}:{s:or(e.slice(0,t)),e:or(e.slice(t+1))}}function ht(e,t){return typeof t>"u"||typeof t=="number"?ht(e.s,e.e):(typeof e!="string"&&(e=ot(e)),typeof t!="string"&&(t=ot(t)),e==t?e:e+":"+t)}function wt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function jj(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ba(e.z,r?Ir(t):t)}catch{}try{return e.w=Ba((e.XF||{}).numFmtId||(r?14:0),r?Ir(t):t)}catch{return""+t}}function ns(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ds[e.v]||e.v:t==null?jj(e,e.v):jj(e,t))}function so(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function KP(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?or(n.origin):n.origin;s=f.r,l=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=wt(i["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),s==-1&&(d.e.r=s=h.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[m].length;++x)if(!(typeof t[m][x]>"u")){var g={v:t[m][x]},y=s+m,v=l+x;if(d.s.r>y&&(d.s.r=y),d.s.c>v&&(d.s.c=v),d.e.r<y&&(d.e.r=y),d.e.c<v&&(d.e.c=v),t[m][x]&&typeof t[m][x]=="object"&&!Array.isArray(t[m][x])&&!(t[m][x]instanceof Date))g=t[m][x];else if(Array.isArray(g.v)&&(g.f=t[m][x][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||it[14],n.cellDates?(g.t="d",g.w=Ba(g.z,Ir(g.v))):(g.t="n",g.v=Ir(g.v),g.w=Ba(g.z,g.v))):g.t="s";if(a)i[y]||(i[y]=[]),i[y][v]&&i[y][v].z&&(g.z=i[y][v].z),i[y][v]=g;else{var b=ot({c:v,r:y});i[b]&&i[b].z&&(g.z=i[b].z),i[b]=g}}}return d.s.c<1e7&&(i["!ref"]=ht(d)),i}function Lc(e,t){return KP(null,e,t)}function IY(e){return e.read_shift(4,"i")}function ni(e,t){return t||(t=Ee(4)),t.write_shift(4,e),t}function _n(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Xr(e,t){var r=!1;return t==null&&(r=!0,t=Ee(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function MY(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function RY(e,t){return t||(t=Ee(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Lb(e,t){var r=e.l,n=e.read_shift(1),a=_n(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),f=0;f!=l;++f)i.push(MY(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function LY(e,t){var r=!1;return t==null&&(r=!0,t=Ee(15+4*e.t.length)),t.write_shift(1,0),Xr(e.t,t),r?t.slice(0,t.l):t}var BY=Lb;function $Y(e,t){var r=!1;return t==null&&(r=!0,t=Ee(23+4*e.t.length)),t.write_shift(1,1),Xr(e.t,t),t.write_shift(4,1),RY({},t),r?t.slice(0,t.l):t}function za(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ml(e,t){return t==null&&(t=Ee(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function pl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function xl(e,t){return t==null&&(t=Ee(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var UY=_n,qP=Xr;function Bb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Fh(e,t){var r=!1;return t==null&&(r=!0,t=Ee(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var zY=_n,c1=Bb,$b=Fh;function Ub(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Oh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):To(t,0)>>2;return r?a/100:a}function XP(e,t){t==null&&(t=Ee(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function YP(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function WY(e,t){return t||(t=Ee(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var gl=YP,Bc=WY;function Nn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function tl(e,t){return(t||Ee(8)).write_shift(8,e,"f")}function HY(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),l=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=$o[a];d&&(t.rgb=yf(d));break;case 2:t.rgb=yf([s,l,f]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Dh(e,t){if(t||(t=Ee(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function VY(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function GY(e,t){t||(t=Ee(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function JP(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function KY(e){return JP(e,1)}function qY(e){return JP(e,2)}var zb=2,Xn=3,N0=11,Cj=12,Ih=19,E0=64,XY=65,YY=71,JY=4108,QY=4126,Gr=80,QP=81,ZY=[Gr,QP],u1={1:{n:"CodePage",t:zb},2:{n:"Category",t:Gr},3:{n:"PresentationFormat",t:Gr},4:{n:"ByteCount",t:Xn},5:{n:"LineCount",t:Xn},6:{n:"ParagraphCount",t:Xn},7:{n:"SlideCount",t:Xn},8:{n:"NoteCount",t:Xn},9:{n:"HiddenCount",t:Xn},10:{n:"MultimediaClipCount",t:Xn},11:{n:"ScaleCrop",t:N0},12:{n:"HeadingPairs",t:JY},13:{n:"TitlesOfParts",t:QY},14:{n:"Manager",t:Gr},15:{n:"Company",t:Gr},16:{n:"LinksUpToDate",t:N0},17:{n:"CharacterCount",t:Xn},19:{n:"SharedDoc",t:N0},22:{n:"HyperlinksChanged",t:N0},23:{n:"AppVersion",t:Xn,p:"version"},24:{n:"DigSig",t:XY},26:{n:"ContentType",t:Gr},27:{n:"ContentStatus",t:Gr},28:{n:"Language",t:Gr},29:{n:"Version",t:Gr},255:{},2147483648:{n:"Locale",t:Ih},2147483651:{n:"Behavior",t:Ih},1919054434:{}},f1={1:{n:"CodePage",t:zb},2:{n:"Title",t:Gr},3:{n:"Subject",t:Gr},4:{n:"Author",t:Gr},5:{n:"Keywords",t:Gr},6:{n:"Comments",t:Gr},7:{n:"Template",t:Gr},8:{n:"LastAuthor",t:Gr},9:{n:"RevNumber",t:Gr},10:{n:"EditTime",t:E0},11:{n:"LastPrinted",t:E0},12:{n:"CreatedDate",t:E0},13:{n:"ModifiedDate",t:E0},14:{n:"PageCount",t:Xn},15:{n:"WordCount",t:Xn},16:{n:"CharCount",t:Xn},17:{n:"Thumbnail",t:YY},18:{n:"Application",t:Gr},19:{n:"DocSecurity",t:Xn},255:{},2147483648:{n:"Locale",t:Ih},2147483651:{n:"Behavior",t:Ih},1919054434:{}},Aj={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},eJ=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function tJ(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var rJ=tJ([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$o=Xt(rJ),ds={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZP={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},d1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Wb(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function nJ(e){var t=Wb();if(!e||!e.match)return t;var r={};if((e.match(jn)||[]).forEach(function(n){var a=ct(n);switch(a[0].replace(hY,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[d1[a.ContentType]]!==void 0&&t[d1[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Fr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function eO(e,t){var r=nY(d1),n=[],a;n[n.length]=br,n[n.length]=Be("Types",null,{xmlns:Fr.CT,"xmlns:xsd":Fr.xsd,"xmlns:xsi":Fr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Be("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){e[f]&&e[f].length>0&&(a=e[f][0],n[n.length]=Be("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:_0[f][t.bookType]||_0[f].xlsx}))},s=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:_0[f][t.bookType]||_0[f].xlsx})})},l=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return i("workbooks"),s("sheets"),s("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),s("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var gt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ku(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(jn)||[]).forEach(function(a){var i=ct(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Lu(i.Target,t);r[l]=s,n[i.Id]=s}}),r["!id"]=n,r}function sc(e){var t=[br,Be("Relationships",null,{xmlns:Fr.RELS})];return dr(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ot(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[gt.HLINK,gt.XPATH,gt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var aJ="application/vnd.oasis.opendocument.spreadsheet";function iJ(e,t){for(var r=Fb(e),n,a;n=gf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ct(n[0],!1),a.path=="/"&&a.type!==aJ)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function sJ(e){var t=[br];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Tj(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function oJ(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function lJ(e){var t=[br];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Tj(e[r][0],e[r][1])),t.push(oJ("",e[r][0]));return t.push(Tj("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function tO(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+jh.version+"</meta:generator></office:meta></office:document-meta>"}var Ma=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],cJ=(function(){for(var e=new Array(Ma.length),t=0;t<Ma.length;++t){var r=Ma[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function rO(e){var t={};e=Rt(e);for(var r=0;r<Ma.length;++r){var n=Ma[r],a=e.match(cJ[r]);a!=null&&a.length>0&&(t[n[1]]=yt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=qt(t[n[1]]))}return t}function tv(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=It(t),n[n.length]=r?Be(e,t,r):fn(e,t))}function nO(e,t){var r=t||{},n=[br,Be("cp:coreProperties",null,{"xmlns:cp":Fr.CORE_PROPS,"xmlns:dc":Fr.dc,"xmlns:dcterms":Fr.dcterms,"xmlns:dcmitype":Fr.dcmitype,"xmlns:xsi":Fr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&tv("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:l1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&tv("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:l1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Ma.length;++i){var s=Ma[i],l=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&tv(s[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Uo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],aO=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function iO(e,t,r,n){var a=[];if(typeof e=="string")a=bj(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(h){return{v:h}}));var s=typeof t=="string"?bj(t,n).map(function(h){return h.v}):t,l=0,f=0;if(s.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=s.slice(l,l+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=s.slice(l,l+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=s.slice(l,l+f);break}l+=f}}function uJ(e,t,r){var n={};return t||(t={}),e=Rt(e),Uo.forEach(function(a){var i=(e.match(pf(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=yt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&iO(n.HeadingPairs,n.TitlesOfParts,t,r),t}function sO(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=br,t[t.length]=Be("Properties",null,{xmlns:Fr.EXT_PROPS,"xmlns:vt":Fr.vt}),Uo.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=It(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+It(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var fJ=/<[^>]+>[^<]*/g;function dJ(e,t){var r={},n="",a=e.match(fJ);if(a)for(var i=0;i!=a.length;++i){var s=a[i],l=ct(s);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=yt(l.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var f=s.split(">"),d=f[0].slice(4),h=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=yt(h);break;case"bool":r[n]=Kt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=qt(h);break;case"cy":case"error":r[n]=yt(h);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,d,f)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function oO(e){var t=[br,Be("Properties",null,{xmlns:Fr.CUST_PROPS,"xmlns:vt":Fr.vt})];if(!e)return t.join("");var r=1;return dr(e).forEach(function(a){++r,t[t.length]=Be("property",wY(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:It(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var h1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rv;function hJ(e,t,r){rv||(rv=jm(h1)),t=rv[t]||t,e[t]=r}function mJ(e,t){var r=[];return dr(h1).map(function(n){for(var a=0;a<Ma.length;++a)if(Ma[a][1]==n)return Ma[a];for(a=0;a<Uo.length;++a)if(Uo[a][1]==n)return Uo[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];n[2]==="date"&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(fn(h1[n[1]]||n[1],a))}}),Be("DocumentProperties",r.join(""),{xmlns:oa.o})}function pJ(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&dr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Ma.length;++s)if(i==Ma[s][1])return;for(s=0;s<Uo.length;++s)if(i==Uo[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var l=e[i],f="string";typeof l=="number"?(f="float",l=String(l)):l===!0||l===!1?(f="boolean",l=l?"1":"0"):l=String(l),a.push(Be(xj(i),l,{"dt:dt":f}))}}),t&&dr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Be(xj(i),s,{"dt:dt":l}))}}),"<"+n+' xmlns="'+oa.o+'">'+a.join("")+"</"+n+">"}function Hb(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function xJ(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=Ee(8);return s.write_shift(4,n),s.write_shift(4,a),s}function lO(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function cO(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function uO(e,t,r){return t===31?cO(e):lO(e,t,r)}function m1(e,t,r){return uO(e,t,r===!1?0:4)}function gJ(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return uO(e,t,0)}function vJ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Mn,""),e.l-a&2&&(e.l+=2)}return r}function yJ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Mn,"");return r}function bJ(e){var t=e.l,r=Mh(e,QP);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Mh(e,Xn);return[r,n]}function wJ(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(bJ(e));return r}function Pj(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Mn,"").replace(Ru,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function fO(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function SJ(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Mh(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==Cj&&n!==t&&ZY.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Cj?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return lO(e,n,4).replace(Mn,"");case 31:return cO(e);case 64:return Hb(e);case 65:return fO(e);case 71:return SJ(e);case 80:return m1(e,n,!i.raw).replace(Mn,"");case 81:return gJ(e,n).replace(Mn,"");case 4108:return wJ(e);case 4126:case 4127:return n==4127?vJ(e):yJ(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Oj(e,t){var r=Ee(4),n=Ee(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ee(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=xJ(t);break;case 31:case 80:for(n=Ee(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Kr([r,n])}function Fj(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,l=0,f=-1,d={};for(s=0;s!=a;++s){var h=e.read_shift(4),m=e.read_shift(4);i[s]=[h,m+r]}i.sort(function(N,S){return N[1]-S[1]});var x={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var g=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,g=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],g=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],g=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(g=!1,e.l=i[s][1]),g)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var y=t[i[s][0]];if(x[y.n]=Mh(e,y.t,{raw:!0}),y.p==="version"&&(x[y.n]=String(x[y.n]>>16)+"."+("0000"+String(x[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(x[y.n]){case 0:x[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ei(l=x[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[y.n])}}else if(i[s][0]===1){if(l=x.CodePage=Mh(e,zb),ei(l),f!==-1){var v=e.l;e.l=i[f][1],d=Pj(e,l),e.l=v}}else if(i[s][0]===0){if(l===0){f=s,e.l=i[s+1][1];continue}d=Pj(e,l)}else{var b=d[i[s][0]],E;switch(e[e.l]){case 65:e.l+=4,E=fO(e);break;case 30:e.l+=4,E=m1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=m1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=xr(e,4);break;case 64:e.l+=4,E=qt(Hb(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[b]=E}}return e.l=r+n,x}var dO=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function NJ(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Dj(e,t,r){var n=Ee(8),a=[],i=[],s=8,l=0,f=Ee(8),d=Ee(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),i.push(f),a.push(d),s+=8+f.length,!t){d=Ee(8),d.write_shift(4,0),a.unshift(d);var h=[Ee(4)];for(h[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(f=Ee(8+2*(m.length+1)+(m.length%2?0:2)),f.write_shift(4,l+2),f.write_shift(4,m.length+1),f.write_shift(0,m,"dbcs");f.l!=f.length;)f.write_shift(1,0);h.push(f)}f=Kr(h),i.unshift(f),s+=8+f.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(dO.indexOf(e[l][0])>-1||aO.indexOf(e[l][0])>-1)&&e[l][1]!=null){var x=e[l][1],g=0;if(t){g=+t[e[l][0]];var y=r[g];if(y.p=="version"&&typeof x=="string"){var v=x.split(".");x=(+v[0]<<16)+(+v[1]||0)}f=Oj(y.t,x)}else{var b=NJ(x);b==-1&&(b=31,x=String(x)),f=Oj(b,x)}i.push(f),d=Ee(8),d.write_shift(4,t?g:2+l),a.push(d),s+=8+f.length}var E=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,E),E+=i[l].length;return n.write_shift(4,s),n.write_shift(4,i.length),Kr([n].concat(a).concat(i))}function Ij(e,t,r){var n=e.content;if(!n)return{};cn(n,0);var a,i,s,l,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),h=n.read_shift(16);if(h!==tt.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(s=n.read_shift(16),f=n.read_shift(4));var m=Fj(n,t),x={SystemIdentifier:d};for(var g in m)x[g]=m[g];if(x.FMTID=i,a===1)return x;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var y;try{y=Fj(n,null)}catch{}for(g in y)x[g]=y[g];return x.FMTID=[i,s],x}function Mj(e,t,r,n,a,i){var s=Ee(a?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var f=Dj(e,r,n);if(l.push(f),a){var d=Dj(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+f.length),l.push(d)}return Kr(l)}function Ds(e,t){return e.read_shift(t),null}function EJ(e,t){t||(t=Ee(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function _J(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function xr(e,t){return e.read_shift(t)===1}function On(e,t){return t||(t=Ee(2)),t.write_shift(2,+!!e),t}function Er(e){return e.read_shift(2,"u")}function Fa(e,t){return t||(t=Ee(2)),t.write_shift(2,e),t}function hO(e,t){return _J(e,t,Er)}function kJ(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function mO(e,t,r){return r||(r=Ee(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Kf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function jJ(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,l,f={};a&&(s=e.read_shift(2)),n&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,d);return a&&(e.l+=4*s),n&&(e.l+=l),f.t=h,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function CJ(e){var t=e.t||"",r=Ee(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ee(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Kr(a)}function rl(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function qf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):rl(e,n,r)}function vl(e,t,r){if(r.biff>5)return qf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function pO(e,t,r){return r||(r=Ee(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function AJ(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function TJ(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Mn,"");return n&&(e.l+=24),a}function PJ(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Mn,"");return r+s}function OJ(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return TJ(e);case"0303000000000000c000000000000046":return PJ(e);default:throw new Error("Unsupported Moniker "+r)}}function k0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Mn,""):"";return r}function Rj(e,t){t||(t=Ee(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function FJ(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,l,f,d="",h,m;a&16&&(i=k0(e,r-e.l)),a&128&&(s=k0(e,r-e.l)),(a&257)===257&&(l=k0(e,r-e.l)),(a&257)===1&&(f=OJ(e,r-e.l)),a&8&&(d=k0(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(m=Hb(e)),e.l=r;var x=s||l||f||"";x&&d&&(x+="#"+d),x||(x="#"+d),a&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var g={Target:x};return h&&(g.guid=h),m&&(g.time=m),i&&(g.Tooltip=i),g}function DJ(e){var t=Ee(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),Rj(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&Rj(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)t.write_shift(1,n.charCodeAt(r+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function xO(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function gO(e,t){var r=xO(e);return r[3]=0,r}function ki(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function nl(e,t,r,n){return n||(n=Ee(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function IJ(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function MJ(e,t,r){return t===0?"":vl(e,t,r)}function RJ(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function vO(e){var t=e.read_shift(2),r=Ub(e);return[t,r]}function LJ(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Kf(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Tm(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function yO(e,t){return t||(t=Ee(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function bO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var BJ=bO;function wO(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function $J(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function UJ(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function xn(e){e.l+=2,e.l+=e.read_shift(2)}var zJ={0:xn,4:xn,5:xn,6:xn,7:UJ,8:xn,9:xn,10:xn,11:xn,12:xn,13:$J,14:xn,15:xn,16:xn,17:xn,18:xn,19:xn,20:xn,21:wO};function WJ(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(zJ[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function j0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Vb(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ee(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function HJ(e,t){return t===0||e.read_shift(2),1200}function VJ(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=vl(e,0,r);return e.read_shift(t+n-e.l),a}function GJ(e,t){var r=!t||t.biff==8,n=Ee(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function KJ(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function qJ(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Kf(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function XJ(e,t){var r=!t||t.biff>=8?2:1,n=Ee(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function YJ(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(jJ(e));return i.Count=n,i.Unique=a,i}function JJ(e,t){var r=Ee(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=CJ(e[a]);var i=Kr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function QJ(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function ZJ(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function eQ(e){var t=IJ(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function tQ(e){return e.read_shift(2),e.read_shift(4)}function Lj(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function rQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:l,Selected:f,TabRatio:d}}function nQ(){var e=Ee(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function aQ(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function iQ(e){var t=Ee(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function sQ(){}function oQ(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Kf(e,0,r),n}function lQ(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Ee(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function cQ(e){var t=ki(e);return t.isst=e.read_shift(4),t}function uQ(e,t,r,n){var a=Ee(10);return nl(e,t,n,a),a.write_shift(4,r),a}function fQ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=ki(e);r.biff==2&&e.l++;var i=qf(e,n-e.l,r);return a.val=i,a}function dQ(e,t,r,n,a){var i=!a||a.biff==8,s=Ee(8+ +i+(1+i)*r.length);return nl(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function hQ(e,t,r){var n=e.read_shift(2),a=vl(e,0,r);return[n,a]}function mQ(e,t,r,n){var a=r&&r.biff==5;n||(n=Ee(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var pQ=vl;function Bj(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),l=e.read_shift(2),f=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:s,c:f}}}function xQ(e,t){var r=t.biff==8||!t.biff?4:2,n=Ee(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function gQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=vO(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function vQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(vO(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function yQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function bQ(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(4),f=e.read_shift(2);return a.patternType=eJ[l>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function wQ(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=bQ(e,t,n.fStyle,r),n}function $j(e,t,r,n){var a=r&&r.biff==5;n||(n=Ee(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function SQ(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function NQ(e){var t=Ee(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Uj(e,t,r){var n=ki(e);(r.biff==2||t==9)&&++e.l;var a=kJ(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function EQ(e,t,r,n,a,i){var s=Ee(8);return nl(e,t,n,s),mO(r,i,s),s}function _Q(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ki(e),a=Nn(e);return n.val=a,n}function kQ(e,t,r,n){var a=Ee(14);return nl(e,t,n,a),tl(r,a),a}var zj=MJ;function jQ(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=rl(e,i),l=[];n>e.l;)l.push(qf(e));return[i,a,s,l]}function Wj(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=LJ(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var CQ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Hj(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),f=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=rl(e,s,r);a&32&&(d=CQ[d.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var m=n==e.l||l===0||!(h>0)?[]:Wre(e,h,r,l);return{chKey:i,Name:d,itab:f,rgce:m}}function SO(e,t,r){if(r.biff<8)return AQ(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(RJ(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function AQ(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Kf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function TQ(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=rl(e,n,r),s=rl(e,a,r);return[i,s]}function PQ(e,t,r){var n=bO(e);e.l++;var a=e.read_shift(1);return t-=8,[Hre(e,t,r),a,n]}function Vj(e,t,r){var n=BJ(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Ure(e,t,r)]}function OQ(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function FQ(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=vl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,s,i]}}function DQ(e,t,r){return FQ(e,t,r)}function IQ(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Tm(e));return r}function MQ(e){var t=Ee(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)yO(e[r],t);return t}function RQ(e,t,r){if(r&&r.biff<8)return BQ(e,t,r);var n=wO(e),a=WJ(e,t-22,n[1]);return{cmo:n,ft:a}}var LQ={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function BQ(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((LQ[n]||kn)(e,t,r)),{cmo:[a,n,i],ft:s}}function $Q(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=AJ(e,6,r);var l=e.read_shift(2);e.read_shift(2),Er(e,2);var f=e.read_shift(2);e.l+=f;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var h=e[e.l],m=rl(e,e.lens[d+1]-e.lens[d]-1);if(a+=m,a.length>=(h?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function UQ(e,t){var r=Tm(e);e.l+=16;var n=FJ(e,t-24);return[r,n]}function zQ(e){var t=Ee(24),r=or(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Kr([t,DJ(e[1])])}function WQ(e,t){e.read_shift(2);var r=Tm(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Mn,""),[r,n]}function HQ(e){var t=e[1].Tooltip,r=Ee(10+2*(t.length+1));r.write_shift(2,2048);var n=or(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function VQ(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Aj[r]||r,r=e.read_shift(2),t[1]=Aj[r]||r,t}function GQ(e){return e||(e=Ee(4)),e.write_shift(2,1),e.write_shift(2,1),e}function KQ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(gO(e));return r}function qQ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(gO(e));return r}function XQ(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function NO(e,t,r){if(!r.cellStyles)return kn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:s,ixfe:l,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function YQ(e,t){var r=Ee(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function JQ(e,t){var r={};return t<32||(e.l+=16,r.header=Nn(e),r.footer=Nn(e),e.l+=2),r}function QQ(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function ZQ(e){for(var t=Ee(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var eZ=ki,tZ=hO,rZ=qf;function nZ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function aZ(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ki(e);++e.l;var a=vl(e,t-7,r);return n.t="str",n.val=a,n}function iZ(e){var t=ki(e);++e.l;var r=Nn(e);return t.t="n",t.val=r,t}function sZ(e,t,r){var n=Ee(15);return Qf(n,e,t),n.write_shift(8,r,"f"),n}function oZ(e){var t=ki(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function lZ(e,t,r){var n=Ee(9);return Qf(n,e,t),n.write_shift(2,r),n}function cZ(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function uZ(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function fZ(e,t,r){var n=e.l+t,a=ki(e),i=e.read_shift(2),s=rl(e,i,r);return e.l=n,a.t="str",a.val=s,a}var dZ=[2,3,48,49,131,139,140,245],p1=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=jm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,f){var d=[],h=Xs(1);switch(f.type){case"base64":h=ua(xa(l));break;case"binary":h=ua(l);break;case"buffer":case"array":h=l;break}cn(h,0);var m=h.read_shift(1),x=!!(m&136),g=!1,y=!1;switch(m){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var v=0,b=521;m==2&&(v=h.read_shift(2)),h.l+=3,m!=2&&(v=h.read_shift(4)),v>1048576&&(v=1e6),m!=2&&(b=h.read_shift(2));var E=h.read_shift(2),N=f.codepage||1252;m!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(N=e[h[h.l]]),h.l+=1,h.l+=2),y&&(h.l+=36);for(var S=[],j={},T=Math.min(h.length,m==2?521:b-10-(g?264:0)),C=y?32:11;h.l<T&&h[h.l]!=13;)switch(j={},j.name=df.utils.decode(N,h.slice(h.l,h.l+C)).replace(/[\u0000\r\n].*$/g,""),h.l+=C,j.type=String.fromCharCode(h.read_shift(1)),m!=2&&!y&&(j.offset=h.read_shift(4)),j.len=h.read_shift(1),m==2&&(j.offset=h.read_shift(2)),j.dec=h.read_shift(1),j.name.length&&S.push(j),m!=2&&(h.l+=y?13:14),j.type){case"B":(!g||j.len!=8)&&f.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(h[h.l]!==13&&(h.l=b-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=b;var P=0,M=0;for(d[0]=[],M=0;M!=S.length;++M)d[0][M]=S[M].name;for(;v-- >0;){if(h[h.l]===42){h.l+=E;continue}for(++h.l,d[++P]=[],M=0,M=0;M!=S.length;++M){var D=h.slice(h.l,h.l+S[M].len);h.l+=S[M].len,cn(D,0);var W=df.utils.decode(N,D);switch(S[M].type){case"C":W.trim().length&&(d[P][M]=W.replace(/\s+$/,""));break;case"D":W.length===8?d[P][M]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):d[P][M]=W;break;case"F":d[P][M]=parseFloat(W.trim());break;case"+":case"I":d[P][M]=y?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":d[P][M]=!0;break;case"N":case"F":d[P][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[P][M]="##MEMO##"+(y?parseInt(W.trim(),10):D.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(d[P][M]=+W||0);break;case"@":d[P][M]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":d[P][M]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":d[P][M]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[P][M]=-D.read_shift(-8,"f");break;case"B":if(g&&S[M].len==8){d[P][M]=D.read_shift(8,"f");break}case"G":case"P":D.l+=S[M].len;break;case"0":if(S[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[M].type)}}}if(m!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=S,d}function n(l,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var h=Lc(r(l,d),d);return h["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,h}function a(l,f){try{return so(n(l,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,f){var d=f||{};if(+d.codepage>=0&&ei(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=Jn(),m=Bh(l,{header:1,raw:!0,cellDates:!0}),x=m[0],g=m.slice(1),y=l["!cols"]||[],v=0,b=0,E=0,N=1;for(v=0;v<x.length;++v){if(((y[v]||{}).DBF||{}).name){x[v]=y[v].DBF.name,++E;continue}if(x[v]!=null){if(++E,typeof x[v]=="number"&&(x[v]=x[v].toString(10)),typeof x[v]!="string")throw new Error("DBF Invalid column name "+x[v]+" |"+typeof x[v]+"|");if(x.indexOf(x[v])!==v){for(b=0;b<1024;++b)if(x.indexOf(x[v]+"_"+b)==-1){x[v]+="_"+b;break}}}}var S=wt(l["!ref"]),j=[],T=[],C=[];for(v=0;v<=S.e.c-S.s.c;++v){var P="",M="",D=0,W=[];for(b=0;b<g.length;++b)g[b][v]!=null&&W.push(g[b][v]);if(W.length==0||x[v]==null){j[v]="?";continue}for(b=0;b<W.length;++b){switch(typeof W[b]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=W[b]instanceof Date?"D":"C";break;default:M="C"}D=Math.max(D,String(W[b]).length),P=P&&P!=M?"C":M}D>250&&(D=250),M=((y[v]||{}).DBF||{}).type,M=="C"&&y[v].DBF.len>D&&(D=y[v].DBF.len),P=="B"&&M=="N"&&(P="N",C[v]=y[v].DBF.dec,D=y[v].DBF.len),T[v]=P=="C"||M=="N"?D:i[P]||0,N+=T[v],j[v]=P}var F=h.next(32);for(F.write_shift(4,318902576),F.write_shift(4,g.length),F.write_shift(2,296+32*E),F.write_shift(2,N),v=0;v<4;++v)F.write_shift(4,0);for(F.write_shift(4,0|(+t[dP]||3)<<8),v=0,b=0;v<x.length;++v)if(x[v]!=null){var L=h.next(32),J=(x[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,J,"sbcs"),L.write_shift(1,j[v]=="?"?"C":j[v],"sbcs"),L.write_shift(4,b),L.write_shift(1,T[v]||i[j[v]]||0),L.write_shift(1,C[v]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),b+=T[v]||i[j[v]]||0}var se=h.next(264);for(se.write_shift(4,13),v=0;v<65;++v)se.write_shift(4,0);for(v=0;v<g.length;++v){var Z=h.next(N);for(Z.write_shift(1,0),b=0;b<x.length;++b)if(x[b]!=null)switch(j[b]){case"L":Z.write_shift(1,g[v][b]==null?63:g[v][b]?84:70);break;case"B":Z.write_shift(8,g[v][b]||0,"f");break;case"N":var he="0";for(typeof g[v][b]=="number"&&(he=g[v][b].toFixed(C[b]||0)),E=0;E<T[b]-he.length;++E)Z.write_shift(1,32);Z.write_shift(1,he,"sbcs");break;case"D":g[v][b]?(Z.write_shift(4,("0000"+g[v][b].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(g[v][b].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+g[v][b].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var le=String(g[v][b]!=null?g[v][b]:"").slice(0,T[b]);for(Z.write_shift(1,le,"sbcs"),E=0;E<T[b]-le.length;++E)Z.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),EO=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+dr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,g){var y=e[g];return typeof y=="number"?rj(y):y},n=function(x,g,y){var v=g.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return v==59?x:rj(v)};e["|"]=254;function a(x,g){switch(g.type){case"base64":return i(xa(x),g);case"binary":return i(x,g);case"buffer":return i(pt&&Buffer.isBuffer(x)?x.toString("binary"):io(x),g);case"array":return i(el(x),g)}throw new Error("Unrecognized type "+g.type)}function i(x,g){var y=x.split(/[\n\r]+/),v=-1,b=-1,E=0,N=0,S=[],j=[],T=null,C={},P=[],M=[],D=[],W=0,F;for(+g.codepage>=0&&ei(+g.codepage);E!==y.length;++E){W=0;var L=y[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),J=L.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),se=J[0],Z;if(L.length>0)switch(se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&j.push(L.slice(3).replace(/;;/g,";"));break;case"C":var he=!1,le=!1,de=!1,Q=!1,pe=-1,re=-1;for(N=1;N<J.length;++N)switch(J[N].charAt(0)){case"A":break;case"X":b=parseInt(J[N].slice(1))-1,le=!0;break;case"Y":for(v=parseInt(J[N].slice(1))-1,le||(b=0),F=S.length;F<=v;++F)S[F]=[];break;case"K":Z=J[N].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(ri(Z))?isNaN(Nc(Z).getDate())||(Z=qt(Z)):(Z=ri(Z),T!==null&&Mc(T)&&(Z=Am(Z))),he=!0;break;case"E":Q=!0;var O=oc(J[N].slice(1),{r:v,c:b});S[v][b]=[S[v][b],O];break;case"S":de=!0,S[v][b]=[S[v][b],"S5S"];break;case"G":break;case"R":pe=parseInt(J[N].slice(1))-1;break;case"C":re=parseInt(J[N].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+L)}if(he&&(S[v][b]&&S[v][b].length==2?S[v][b][0]=Z:S[v][b]=Z,T=null),de){if(Q)throw new Error("SYLK shared formula cannot have own formula");var V=pe>-1&&S[pe][re];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");S[v][b][1]=zO(V[1],{r:v-pe,c:b-re})}break;case"F":var H=0;for(N=1;N<J.length;++N)switch(J[N].charAt(0)){case"X":b=parseInt(J[N].slice(1))-1,++H;break;case"Y":for(v=parseInt(J[N].slice(1))-1,F=S.length;F<=v;++F)S[F]=[];break;case"M":W=parseInt(J[N].slice(1))/20;break;case"F":break;case"G":break;case"P":T=j[parseInt(J[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=J[N].slice(1).split(" "),F=parseInt(D[0],10);F<=parseInt(D[1],10);++F)W=parseInt(D[2],10),M[F-1]=W===0?{hidden:!0}:{wch:W},Ys(M[F-1]);break;case"C":b=parseInt(J[N].slice(1))-1,M[b]||(M[b]={});break;case"R":v=parseInt(J[N].slice(1))-1,P[v]||(P[v]={}),W>0?(P[v].hpt=W,P[v].hpx=_c(W)):W===0&&(P[v].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+L)}H<1&&(T=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+L)}}return P.length>0&&(C["!rows"]=P),M.length>0&&(C["!cols"]=M),g&&g.sheetRows&&(S=S.slice(0,g.sheetRows)),[S,C]}function s(x,g){var y=a(x,g),v=y[0],b=y[1],E=Lc(v,g);return dr(b).forEach(function(N){E[N]=b[N]}),E}function l(x,g){return so(s(x,g),g)}function f(x,g,y,v){var b="C;Y"+(y+1)+";X"+(v+1)+";K";switch(x.t){case"n":b+=x.v||0,x.f&&!x.F&&(b+=";E"+Jb(x.f,{r:y,c:v}));break;case"b":b+=x.v?"TRUE":"FALSE";break;case"e":b+=x.w||x.v;break;case"d":b+='"'+(x.w||x.v)+'"';break;case"s":b+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(x,g){g.forEach(function(y,v){var b="F;W"+(v+1)+" "+(v+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=bf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=wf(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&x.push(b)})}function h(x,g){g.forEach(function(y,v){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*Sf(y.hpx)+";"),b.length>2&&x.push(b+"R"+(v+1))})}function m(x,g){var y=["ID;PWXL;N;E"],v=[],b=wt(x["!ref"]),E,N=Array.isArray(x),S=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),x["!cols"]&&d(y,x["!cols"]),x["!rows"]&&h(y,x["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var j=b.s.r;j<=b.e.r;++j)for(var T=b.s.c;T<=b.e.c;++T){var C=ot({r:j,c:T});E=N?(x[j]||[])[T]:x[C],!(!E||E.v==null&&(!E.f||E.F))&&v.push(f(E,x,j,T))}return y.join(S)+S+v.join(S)+S+"E"+S}return{to_workbook:l,to_sheet:s,from_sheet:m}})(),_O=(function(){function e(i,s){switch(s.type){case"base64":return t(xa(i),s);case"binary":return t(i,s);case"buffer":return t(pt&&Buffer.isBuffer(i)?i.toString("binary"):io(i),s);case"array":return t(el(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var l=i.split(`
`),f=-1,d=-1,h=0,m=[];h!==l.length;++h){if(l[h].trim()==="BOT"){m[++f]=[],d=0;continue}if(!(f<0)){var x=l[h].trim().split(","),g=x[0],y=x[1];++h;for(var v=l[h]||"";(v.match(/["]/g)||[]).length&1&&h<l.length-1;)v+=`
`+l[++h];switch(v=v.trim(),+g){case-1:if(v==="BOT"){m[++f]=[],d=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?m[f][d]=!0:v==="FALSE"?m[f][d]=!1:isNaN(ri(y))?isNaN(Nc(y).getDate())?m[f][d]=y:m[f][d]=qt(y):m[f][d]=ri(y),++d;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),m[f][d++]=v!==""?v:null;break}if(v==="EOD")break}}return s&&s.sheetRows&&(m=m.slice(0,s.sheetRows)),m}function r(i,s){return Lc(e(i,s),s)}function n(i,s){return so(r(i,s),s)}var a=(function(){var i=function(f,d,h,m,x){f.push(d),f.push(h+","+m),f.push('"'+x.replace(/"/g,'""')+'"')},s=function(f,d,h,m){f.push(d+","+h),f.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var d=[],h=wt(f["!ref"]),m,x=Array.isArray(f);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,h.e.r-h.s.r+1,""),i(d,"TUPLES",0,h.e.c-h.s.c+1,""),i(d,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){s(d,-1,0,"BOT");for(var y=h.s.c;y<=h.e.c;++y){var v=ot({r:g,c:y});if(m=x?(f[g]||[])[y]:f[v],!m){s(d,1,0,"");continue}switch(m.t){case"n":var b=m.w;!b&&m.v!=null&&(b=m.v),b==null?m.f&&!m.F?s(d,1,0,"="+m.f):s(d,1,0,""):s(d,0,b,"V");break;case"b":s(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":s(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Ba(m.z||it[14],Ir(qt(m.v)))),s(d,0,m.w,"V");break;default:s(d,1,0,"")}}}s(d,-1,0,"EOD");var E=`\r
`,N=d.join(E);return N}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),kO=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,x){for(var g=m.split(`
`),y=-1,v=-1,b=0,E=[];b!==g.length;++b){var N=g[b].trim().split(":");if(N[0]==="cell"){var S=or(N[1]);if(E.length<=S.r)for(y=E.length;y<=S.r;++y)E[y]||(E[y]=[]);switch(y=S.r,v=S.c,N[2]){case"t":E[y][v]=e(N[3]);break;case"v":E[y][v]=+N[3];break;case"vtf":var j=N[N.length-1];case"vtc":N[3]==="nl"?E[y][v]=!!+N[4]:E[y][v]=+N[4],N[2]=="vtf"&&(E[y][v]=[E[y][v],j])}}}return x&&x.sheetRows&&(E=E.slice(0,x.sheetRows)),E}function n(m,x){return Lc(r(m,x),x)}function a(m,x){return so(n(m,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var x=[],g=[],y,v="",b=Zn(m["!ref"]),E=Array.isArray(m),N=b.s.r;N<=b.e.r;++N)for(var S=b.s.c;S<=b.e.c;++S)if(v=ot({r:N,c:S}),y=E?(m[N]||[])[S]:m[v],!(!y||y.v==null||y.t==="z")){switch(g=["cell",v,"t"],y.t){case"s":case"str":g.push(t(y.v));break;case"n":y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=t(y.f)):(g[2]="v",g[3]=y.v);break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var j=Ir(qt(y.v));g[2]="vtc",g[3]="nd",g[4]=""+j,g[5]=y.w||Ba(y.z||it[14],j);break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(m){return[i,s,l,s,d(m),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}})(),Ec=(function(){function e(h,m,x,g,y){y.raw?m[x][g]=h:h===""||(h==="TRUE"?m[x][g]=!0:h==="FALSE"?m[x][g]=!1:isNaN(ri(h))?isNaN(Nc(h).getDate())?m[x][g]=h:m[x][g]=qt(h):m[x][g]=ri(h))}function t(h,m){var x=m||{},g=[];if(!h||h.length===0)return g;for(var y=h.split(/[\r\n]/),v=y.length-1;v>=0&&y[v].length===0;)--v;for(var b=10,E=0,N=0;N<=v;++N)E=y[N].indexOf(" "),E==-1?E=y[N].length:E++,b=Math.max(b,E);for(N=0;N<=v;++N){g[N]=[];var S=0;for(e(y[N].slice(0,b).trim(),g,N,S,x),S=1;S<=(y[N].length-b)/10+1;++S)e(y[N].slice(b+(S-1)*10,b+S*10).trim(),g,N,S,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var m={},x=!1,g=0,y=0;g<h.length;++g)(y=h.charCodeAt(g))==34?x=!x:!x&&y in r&&(m[y]=(m[y]||0)+1);y=[];for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&y.push([m[g],g]);if(!y.length){m=n;for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&y.push([m[g],g])}return y.sort(function(v,b){return v[0]-b[0]||n[v[1]]-n[b[1]]}),r[y.pop()[1]]||44}function i(h,m){var x=m||{},g="",y=x.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=a(h.slice(0,1024)):x&&x.FS?g=x.FS:g=a(h.slice(0,1024));var b=0,E=0,N=0,S=0,j=0,T=g.charCodeAt(0),C=!1,P=0,M=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var D=x.dateNF!=null?QX(x.dateNF):null;function W(){var F=h.slice(S,j),L={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)L.t="z";else if(x.raw)L.t="s",L.v=F;else if(F.trim().length===0)L.t="s",L.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(L.t="s",L.v=F.slice(2,-1).replace(/""/g,'"')):jte(F)?(L.t="n",L.f=F.slice(1)):(L.t="s",L.v=F);else if(F=="TRUE")L.t="b",L.v=!0;else if(F=="FALSE")L.t="b",L.v=!1;else if(!isNaN(N=ri(F)))L.t="n",x.cellText!==!1&&(L.w=F),L.v=N;else if(!isNaN(Nc(F).getDate())||D&&F.match(D)){L.z=x.dateNF||it[14];var J=0;D&&F.match(D)&&(F=ZX(F,x.dateNF,F.match(D)||[]),J=1),x.cellDates?(L.t="d",L.v=qt(F,J)):(L.t="n",L.v=Ir(qt(F,J))),x.cellText!==!1&&(L.w=Ba(L.z,L.v instanceof Date?Ir(L.v):L.v)),x.cellNF||delete L.z}else L.t="s",L.v=F;if(L.t=="z"||(x.dense?(y[b]||(y[b]=[]),y[b][E]=L):y[ot({c:E,r:b})]=L),S=j+1,M=h.charCodeAt(S),v.e.c<E&&(v.e.c=E),v.e.r<b&&(v.e.r=b),P==T)++E;else if(E=0,++b,x.sheetRows&&x.sheetRows<=b)return!0}e:for(;j<h.length;++j)switch(P=h.charCodeAt(j)){case 34:M===34&&(C=!C);break;case T:case 10:case 13:if(!C&&W())break e;break}return j-S>0&&W(),y["!ref"]=ht(v),y}function s(h,m){return!(m&&m.PRN)||m.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,m):Lc(t(h,m),m)}function l(h,m){var x="",g=m.type=="string"?[0,0,0,0]:iw(h,m);switch(m.type){case"base64":x=xa(h);break;case"binary":x=h;break;case"buffer":m.codepage==65001?x=h.toString("utf8"):m.codepage&&typeof df<"u"||(x=pt&&Buffer.isBuffer(h)?h.toString("binary"):io(h));break;case"array":x=el(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+m.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=Rt(x.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?x=Rt(x):m.type=="binary"&&typeof df<"u",x.slice(0,19)=="socialcalc:version:"?kO.to_sheet(m.type=="string"?x:Rt(x),m):s(x,m)}function f(h,m){return so(l(h,m),m)}function d(h){for(var m=[],x=wt(h["!ref"]),g,y=Array.isArray(h),v=x.s.r;v<=x.e.r;++v){for(var b=[],E=x.s.c;E<=x.e.c;++E){var N=ot({r:v,c:E});if(g=y?(h[v]||[])[E]:h[N],!g||g.v==null){b.push("          ");continue}for(var S=(g.w||(ns(g),g.w)||"").slice(0,10);S.length<10;)S+=" ";b.push(S+(E===0?" ":""))}m.push(b.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:l,from_sheet:d}})();function hZ(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=EO.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Ec.to_workbook(e,t)}}var zo=(function(){function e(O,V,H){if(O){cn(O,O.l||0);for(var q=H.Enum||pe;O.l<O.length;){var K=O.read_shift(2),ie=q[K]||q[65535],B=O.read_shift(2),z=O.l+B,G=ie.f&&ie.f(O,B,H);if(O.l=z,V(G,ie,K))return}}}function t(O,V){switch(V.type){case"base64":return r(ua(xa(O)),V);case"binary":return r(ua(O),V);case"buffer":case"array":return r(O,V)}throw"Unsupported type "+V.type}function r(O,V){if(!O)return O;var H=V||{},q=H.dense?[]:{},K="Sheet1",ie="",B=0,z={},G=[],ce=[],I={s:{r:0,c:0},e:{r:0,c:0}},Ae=H.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)H.Enum=pe,e(O,function(Pe,lt,kt){switch(kt){case 0:H.vers=Pe,Pe>=4096&&(H.qpro=!0);break;case 6:I=Pe;break;case 204:Pe&&(ie=Pe);break;case 222:ie=Pe;break;case 15:case 51:H.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:kt==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=H.dateNF||it[14],H.cellDates&&(Pe[1].t="d",Pe[1].v=Am(Pe[1].v))),H.qpro&&Pe[3]>B&&(q["!ref"]=ht(I),z[K]=q,G.push(K),q=H.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},B=Pe[3],K=ie||"Sheet"+(B+1),ie="");var Yt=H.dense?(q[Pe[0].r]||[])[Pe[0].c]:q[ot(Pe[0])];if(Yt){Yt.t=Pe[1].t,Yt.v=Pe[1].v,Pe[1].z!=null&&(Yt.z=Pe[1].z),Pe[1].f!=null&&(Yt.f=Pe[1].f);break}H.dense?(q[Pe[0].r]||(q[Pe[0].r]=[]),q[Pe[0].r][Pe[0].c]=Pe[1]):q[ot(Pe[0])]=Pe[1];break}},H);else if(O[2]==26||O[2]==14)H.Enum=re,O[2]==14&&(H.qpro=!0,O.l=0),e(O,function(Pe,lt,kt){switch(kt){case 204:K=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>B&&(q["!ref"]=ht(I),z[K]=q,G.push(K),q=H.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},B=Pe[3],K="Sheet"+(B+1)),Ae>0&&Pe[0].r>=Ae)break;H.dense?(q[Pe[0].r]||(q[Pe[0].r]=[]),q[Pe[0].r][Pe[0].c]=Pe[1]):q[ot(Pe[0])]=Pe[1],I.e.c<Pe[0].c&&(I.e.c=Pe[0].c),I.e.r<Pe[0].r&&(I.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(ce[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:ce[Pe[0]]=Pe[1],Pe[0]==B&&(K=Pe[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(q["!ref"]=ht(I),z[ie||K]=q,G.push(ie||K),!ce.length)return{SheetNames:G,Sheets:z};for(var je={},Le=[],Ue=0;Ue<ce.length;++Ue)z[G[Ue]]?(Le.push(ce[Ue]||G[Ue]),je[ce[Ue]]=z[ce[Ue]]||z[G[Ue]]):(Le.push(ce[Ue]),je[ce[Ue]]={"!ref":"A1"});return{SheetNames:Le,Sheets:je}}function n(O,V){var H=V||{};if(+H.codepage>=0&&ei(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Jn(),K=wt(O["!ref"]),ie=Array.isArray(O),B=[];$e(q,0,i(1030)),$e(q,6,f(K));for(var z=Math.min(K.e.r,8191),G=K.s.r;G<=z;++G)for(var ce=vr(G),I=K.s.c;I<=K.e.c;++I){G===K.s.r&&(B[I]=sr(I));var Ae=B[I]+ce,je=ie?(O[G]||[])[I]:O[Ae];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?$e(q,13,g(G,I,je.v)):$e(q,14,v(G,I,je.v));else{var Le=ns(je);$e(q,15,m(G,I,Le.slice(0,239)))}}return $e(q,1),q.end()}function a(O,V){var H=V||{};if(+H.codepage>=0&&ei(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Jn();$e(q,0,s(O));for(var K=0,ie=0;K<O.SheetNames.length;++K)(O.Sheets[O.SheetNames[K]]||{})["!ref"]&&$e(q,27,Q(O.SheetNames[K],ie++));var B=0;for(K=0;K<O.SheetNames.length;++K){var z=O.Sheets[O.SheetNames[K]];if(!(!z||!z["!ref"])){for(var G=wt(z["!ref"]),ce=Array.isArray(z),I=[],Ae=Math.min(G.e.r,8191),je=G.s.r;je<=Ae;++je)for(var Le=vr(je),Ue=G.s.c;Ue<=G.e.c;++Ue){je===G.s.r&&(I[Ue]=sr(Ue));var Pe=I[Ue]+Le,lt=ce?(z[je]||[])[Ue]:z[Pe];if(!(!lt||lt.t=="z"))if(lt.t=="n")$e(q,23,W(je,Ue,B,lt.v));else{var kt=ns(lt);$e(q,22,P(je,Ue,B,kt.slice(0,239)))}}++B}}return $e(q,1),q.end()}function i(O){var V=Ee(2);return V.write_shift(2,O),V}function s(O){var V=Ee(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var H=0,q=0,K=0,ie=0;ie<O.SheetNames.length;++ie){var B=O.SheetNames[ie],z=O.Sheets[B];if(!(!z||!z["!ref"])){++K;var G=Zn(z["!ref"]);H<G.e.r&&(H=G.e.r),q<G.e.c&&(q=G.e.c)}}return H>8191&&(H=8191),V.write_shift(2,H),V.write_shift(1,K),V.write_shift(1,q),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function l(O,V,H){var q={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&H.qpro?(q.s.c=O.read_shift(1),O.l++,q.s.r=O.read_shift(2),q.e.c=O.read_shift(1),O.l++,q.e.r=O.read_shift(2),q):(q.s.c=O.read_shift(2),q.s.r=O.read_shift(2),V==12&&H.qpro&&(O.l+=2),q.e.c=O.read_shift(2),q.e.r=O.read_shift(2),V==12&&H.qpro&&(O.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function f(O){var V=Ee(8);return V.write_shift(2,O.s.c),V.write_shift(2,O.s.r),V.write_shift(2,O.e.c),V.write_shift(2,O.e.r),V}function d(O,V,H){var q=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(q[0].c=O.read_shift(1),q[3]=O.read_shift(1),q[0].r=O.read_shift(2),O.l+=2):(q[2]=O.read_shift(1),q[0].c=O.read_shift(2),q[0].r=O.read_shift(2)),q}function h(O,V,H){var q=O.l+V,K=d(O,V,H);if(K[1].t="s",H.vers==20768){O.l++;var ie=O.read_shift(1);return K[1].v=O.read_shift(ie,"utf8"),K}return H.qpro&&O.l++,K[1].v=O.read_shift(q-O.l,"cstr"),K}function m(O,V,H){var q=Ee(7+H.length);q.write_shift(1,255),q.write_shift(2,V),q.write_shift(2,O),q.write_shift(1,39);for(var K=0;K<q.length;++K){var ie=H.charCodeAt(K);q.write_shift(1,ie>=128?95:ie)}return q.write_shift(1,0),q}function x(O,V,H){var q=d(O,V,H);return q[1].v=O.read_shift(2,"i"),q}function g(O,V,H){var q=Ee(7);return q.write_shift(1,255),q.write_shift(2,V),q.write_shift(2,O),q.write_shift(2,H,"i"),q}function y(O,V,H){var q=d(O,V,H);return q[1].v=O.read_shift(8,"f"),q}function v(O,V,H){var q=Ee(13);return q.write_shift(1,255),q.write_shift(2,V),q.write_shift(2,O),q.write_shift(8,H,"f"),q}function b(O,V,H){var q=O.l+V,K=d(O,V,H);if(K[1].v=O.read_shift(8,"f"),H.qpro)O.l=q;else{var ie=O.read_shift(2);j(O.slice(O.l,O.l+ie),K),O.l+=ie}return K}function E(O,V,H){var q=V&32768;return V&=-32769,V=(q?O:0)+(V>=8192?V-16384:V),(q?"":"$")+(H?sr(V):vr(V))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(O,V){cn(O,0);for(var H=[],q=0,K="",ie="",B="",z="";O.l<O.length;){var G=O[O.l++];switch(G){case 0:H.push(O.read_shift(8,"f"));break;case 1:ie=E(V[0].c,O.read_shift(2),!0),K=E(V[0].r,O.read_shift(2),!1),H.push(ie+K);break;case 2:{var ce=E(V[0].c,O.read_shift(2),!0),I=E(V[0].r,O.read_shift(2),!1);ie=E(V[0].c,O.read_shift(2),!0),K=E(V[0].r,O.read_shift(2),!1),H.push(ce+I+":"+ie+K)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(O.read_shift(2));break;case 6:{for(var Ae="";G=O[O.l++];)Ae+=String.fromCharCode(G);H.push('"'+Ae.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:z=H.pop(),B=H.pop(),H.push(["AND","OR"][G-20]+"("+B+","+z+")");break;default:if(G<32&&S[G])z=H.pop(),B=H.pop(),H.push(B+S[G]+z);else if(N[G]){if(q=N[G][1],q==69&&(q=O[O.l++]),q>H.length){console.error("WK1 bad formula parse 0x"+G.toString(16)+":|"+H.join("|")+"|");return}var je=H.slice(-q);H.length-=q,H.push(N[G][0]+"("+je.join(",")+")")}else return G<=7?console.error("WK1 invalid opcode "+G.toString(16)):G<=24?console.error("WK1 unsupported op "+G.toString(16)):G<=30?console.error("WK1 invalid opcode "+G.toString(16)):G<=115?console.error("WK1 unsupported function opcode "+G.toString(16)):console.error("WK1 unrecognized opcode "+G.toString(16))}}H.length==1?V[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function T(O){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=O.read_shift(2),V[3]=O[O.l++],V[0].c=O[O.l++],V}function C(O,V){var H=T(O);return H[1].t="s",H[1].v=O.read_shift(V-4,"cstr"),H}function P(O,V,H,q){var K=Ee(6+q.length);K.write_shift(2,O),K.write_shift(1,H),K.write_shift(1,V),K.write_shift(1,39);for(var ie=0;ie<q.length;++ie){var B=q.charCodeAt(ie);K.write_shift(1,B>=128?95:B)}return K.write_shift(1,0),K}function M(O,V){var H=T(O);H[1].v=O.read_shift(2);var q=H[1].v>>1;if(H[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return H[1].v=q,H}function D(O,V){var H=T(O),q=O.read_shift(4),K=O.read_shift(4),ie=O.read_shift(2);if(ie==65535)return q===0&&K===3221225472?(H[1].t="e",H[1].v=15):q===0&&K===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var B=ie&32768;return ie=(ie&32767)-16446,H[1].v=(1-B*2)*(K*Math.pow(2,ie+32)+q*Math.pow(2,ie)),H}function W(O,V,H,q){var K=Ee(14);if(K.write_shift(2,O),K.write_shift(1,H),K.write_shift(1,V),q==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ie=0,B=0,z=0,G=0;return q<0&&(ie=1,q=-q),B=Math.log2(q)|0,q/=Math.pow(2,B-31),G=q>>>0,(G&2147483648)==0&&(q/=2,++B,G=q>>>0),q-=G,G|=2147483648,G>>>=0,q*=Math.pow(2,32),z=q>>>0,K.write_shift(4,z),K.write_shift(4,G),B+=16383+(ie?32768:0),K.write_shift(2,B),K}function F(O,V){var H=D(O);return O.l+=V-14,H}function L(O,V){var H=T(O),q=O.read_shift(4);return H[1].v=q>>6,H}function J(O,V){var H=T(O),q=O.read_shift(8,"f");return H[1].v=q,H}function se(O,V){var H=J(O);return O.l+=V-10,H}function Z(O,V){return O[O.l+V-1]==0?O.read_shift(V,"cstr"):""}function he(O,V){var H=O[O.l++];H>V-1&&(H=V-1);for(var q="";q.length<H;)q+=String.fromCharCode(O[O.l++]);return q}function le(O,V,H){if(!(!H.qpro||V<21)){var q=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var K=O.read_shift(V-21,"cstr");return[q,K]}}function de(O,V){for(var H={},q=O.l+V;O.l<q;){var K=O.read_shift(2);if(K==14e3){for(H[K]=[0,""],H[K][0]=O.read_shift(2);O[O.l];)H[K][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return H}function Q(O,V){var H=Ee(5+O.length);H.write_shift(2,14e3),H.write_shift(2,V);for(var q=0;q<O.length;++q){var K=O.charCodeAt(q);H[H.l++]=K>127?95:K}return H[H.l++]=0,H}var pe={0:{n:"BOF",f:Er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:he},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:de},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function mZ(e){var t={},r=e.match(jn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=ct(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Sb[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var pZ=(function(){var e=pf("t"),t=pf("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var l={t:"s",v:yt(s[1])},f=i.match(t);return f&&(l.s=mZ(f[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(l){return l.v})}})(),xZ=(function(){var t=/(\r\n|\n)/g;function r(a,i,s){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),s.push("</"+f+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),gZ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,vZ=/<(?:\w+:)?r>/,yZ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Gb(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=yt(Rt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Rt(e),r&&(n.h=Ob(n.t))):e.match(vZ)&&(n.r=Rt(e),n.t=yt(Rt((e.replace(yZ,"").match(gZ)||[]).join("").replace(jn,""))),r&&(n.h=xZ(pZ(n.r)))),n):{t:""}}var bZ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wZ=/<(?:\w+:)?(?:si|sstItem)>/g,SZ=/<\/(?:\w+:)?(?:si|sstItem)>/;function NZ(e,t){var r=[],n="";if(!e)return r;var a=e.match(bZ);if(a){n=a[2].replace(wZ,"").split(SZ);for(var i=0;i!=n.length;++i){var s=Gb(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=ct(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var EZ=/^\s|\s$|[\t\n\r]/;function jO(e,t){if(!t.bookSST)return"";var r=[br];r[r.length]=Be("sst",null,{xmlns:hl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(EZ)&&(i+=' xml:space="preserve"'),i+=">"+It(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function _Z(e){return[e.read_shift(4),e.read_shift(4)]}function kZ(e,t){var r=[],n=!1;return fs(e,function(i,s,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function jZ(e,t){return t||(t=Ee(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var CZ=LY;function AZ(e){var t=Jn();Ce(t,159,jZ(e));for(var r=0;r<e.length;++r)Ce(t,19,CZ(e[r]));return Ce(t,160),t.end()}function CO(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Xi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function TZ(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Xi(e,4),t.U=Xi(e,4),t.W=Xi(e,4),t}function PZ(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function OZ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(PZ(e));return t}function FZ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function DZ(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Xi(e,4),t.U=Xi(e,4),t.W=Xi(e,4),t}function IZ(e){var t=DZ(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function AO(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function TO(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function MZ(e){var t=Xi(e);switch(t.Minor){case 2:return[t.Minor,RZ(e)];case 3:return[t.Minor,LZ()];case 4:return[t.Minor,BZ(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function RZ(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=AO(e,r),a=TO(e,e.length-e.l);return{t:"Std",h:n,v:a}}function LZ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function BZ(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(jn,function(i){var s=ct(i);switch(_i(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=s[l]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function $Z(e,t){var r={},n=r.EncryptionVersionInfo=Xi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=AO(e,a),t-=a,r.EncryptionVerifier=TO(e,t),r}function UZ(e){var t={},r=t.EncryptionVersionInfo=Xi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Kb(e){var t=0,r,n=CO(e),a=n.length+1,i,s,l,f,d;for(r=Xs(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],l=(t&16384)===0?0:1,f=t<<1&32767,d=l|f,t=d^s;return t^52811}var PO=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,l){return n(s^l)},i=function(s){for(var l=t[s.length-1],f=104,d=s.length-1;d>=0;--d)for(var h=s[d],m=0;m!=7;++m)h&64&&(l^=r[f]),h*=2,--f;return l};return function(s){for(var l=CO(s),f=i(l),d=l.length,h=Xs(16),m=0;m!=16;++m)h[m]=0;var x,g,y;for((d&1)===1&&(x=f>>8,h[d]=a(e[0],x),--d,x=f&255,g=l[l.length-1],h[d]=a(g,x));d>0;)--d,x=f>>8,h[d]=a(l[d],x),--d,x=f&255,h[d]=a(l[d],x);for(d=15,y=15-l.length;y>0;)x=f>>8,h[d]=a(e[y],x),--d,--y,x=f&255,h[d]=a(l[d],x),--d,--y;return h}})(),zZ=function(e,t,r,n,a){a||(a=t),n||(n=PO(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},WZ=function(e){var t=0,r=PO(e);return function(n){var a=zZ("",n,t,r);return t=a[1],a[0]}};function HZ(e,t,r,n){var a={key:Er(e),verificationBytes:Er(e)};return r.password&&(a.verifier=Kb(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=WZ(r.password)),a}function VZ(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=UZ(e):n.Data=$Z(e,t),n}function GZ(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?VZ(e,t-2,n):HZ(e,r.biff>=8?t:t-2,r,n),n}var OO=(function(){function e(a,i){switch(i.type){case"base64":return t(xa(a),i);case"binary":return t(a,i);case"buffer":return t(pt&&Buffer.isBuffer(a)?a.toString("binary"):io(a),i);case"array":return t(el(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},l=s.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(h,m){Array.isArray(l)&&(l[m]=[]);for(var x=/\\\w+\b/g,g=0,y,v=-1;y=x.exec(h);){switch(y[0]){case"\\cell":var b=h.slice(g,x.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++v,b.length){var E={v:b,t:"s"};Array.isArray(l)?l[m][v]=E:l[ot({r:m,c:v})]=E}break}g=x.lastIndex}v>d.e.c&&(d.e.c=v)}),l["!ref"]=ht(d),l}function r(a,i){return so(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=wt(a["!ref"]),l,f=Array.isArray(a),d=s.s.r;d<=s.e.r;++d){i.push("\\trowd\\trautofit1");for(var h=s.s.c;h<=s.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=s.s.c;h<=s.e.c;++h){var m=ot({r:d,c:h});l=f?(a[d]||[])[h]:a[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(ns(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function KZ(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function yf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function qZ(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var l=0,f=0,d=a+i;switch(f=s/(d>1?2-d:d),a){case t:l=((r-n)/s+6)%6;break;case r:l=(n-t)/s+2;break;case n:l=(t-r)/s+4;break}return[l/6,f,d/2]}function XZ(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],l=6*t,f;if(r!==0)switch(l|0){case 0:case 6:f=a*l,s[0]+=a,s[1]+=f;break;case 1:f=a*(2-l),s[0]+=f,s[1]+=a;break;case 2:f=a*(l-2),s[1]+=a,s[2]+=f;break;case 3:f=a*(4-l),s[1]+=f,s[2]+=a;break;case 4:f=a*(l-4),s[2]+=a,s[0]+=f;break;case 5:f=a*(6-l),s[2]+=f,s[0]+=a;break}for(var d=0;d!=3;++d)s[d]=Math.round(s[d]*255);return s}function Rh(e,t){if(t===0)return e;var r=qZ(KZ(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),yf(XZ(r))}var FO=6,YZ=15,JZ=1,Sn=FO;function bf(e){return Math.floor((e+Math.round(128/Sn)/256)*Sn)}function wf(e){return Math.floor((e-5)/Sn*100+.5)/100}function Lh(e){return Math.round((e*Sn+5)/Sn*256)/256}function nv(e){return Lh(wf(bf(e)))}function qb(e){var t=Math.abs(e-nv(e)),r=Sn;if(t>.005)for(Sn=JZ;Sn<YZ;++Sn)Math.abs(e-nv(e))<=t&&(t=Math.abs(e-nv(e)),r=Sn);Sn=r}function Ys(e){e.width?(e.wpx=bf(e.width),e.wch=wf(e.wpx),e.MDW=Sn):e.wpx?(e.wch=wf(e.wpx),e.width=Lh(e.wch),e.MDW=Sn):typeof e.wch=="number"&&(e.width=Lh(e.wch),e.wpx=bf(e.width),e.MDW=Sn),e.customWidth&&delete e.customWidth}var QZ=96,DO=QZ;function Sf(e){return e*96/DO}function _c(e){return e*DO/96}var ZZ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function eee(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(jn)||[]).forEach(function(s){var l=ct(s);switch(_i(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Kt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Kt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function tee(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(jn)||[]).forEach(function(s){var l=ct(s);switch(_i(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function ree(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(jn)||[]).forEach(function(s){var l=ct(s);switch(_i(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Rt(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Kt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Kt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Kt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Kt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Kt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Kt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Kt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Sb[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Kt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var f=$o[a.color.index];a.color.index==81&&(f=$o[1]),f||(f=$o[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Rh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function nee(e,t,r){t.NumberFmt=[];for(var n=dr(it),a=0;a<n.length;++a)t.NumberFmt[n[a]]=it[n[a]];var i=e[0].match(jn);if(i)for(a=0;a<i.length;++a){var s=ct(i[a]);switch(_i(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=yt(Rt(s.formatCode)),f=parseInt(s.numFmtId,10);if(t.NumberFmt[f]=l,f>0){if(f>392){for(f=392;f>60&&t.NumberFmt[f]!=null;--f);t.NumberFmt[f]=l}qi(l,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function aee(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:n,formatCode:It(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var C0=["numFmtId","fillId","fontId","borderId","xfId"],A0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function iee(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(jn)||[]).forEach(function(i){var s=ct(i),l=0;switch(_i(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],l=0;l<C0.length;++l)n[C0[l]]&&(n[C0[l]]=parseInt(n[C0[l]],10));for(l=0;l<A0.length;++l)n[A0[l]]&&(n[A0[l]]=Kt(n[A0[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};s.vertical&&(f.vertical=s.vertical),s.horizontal&&(f.horizontal=s.horizontal),s.textRotation!=null&&(f.textRotation=s.textRotation),s.indent&&(f.indent=s.indent),s.wrapText&&(f.wrapText=Kt(s.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function see(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var oee=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,f,d){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&nee(m,h,d),(m=l.match(a))&&ree(m,h,f,d),(m=l.match(n))&&tee(m,h,f,d),(m=l.match(i))&&eee(m,h,f,d),(m=l.match(r))&&iee(m,h,d),h}})();function IO(e,t){var r=[br,Be("styleSheet",null,{xmlns:hl[0],"xmlns:vt":Fr.vt})],n;return e.SSF&&(n=aee(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=see(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function lee(e,t){var r=e.read_shift(2),n=_n(e);return[r,n]}function cee(e,t,r){r||(r=Ee(6+4*t.length)),r.write_shift(2,e),Xr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function uee(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=VY(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var l=e.read_shift(1);l>0&&(n.family=l);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=HY(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_n(e),n}function fee(e,t){t||(t=Ee(153)),t.write_shift(2,e.sz*20),GY(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Dh(e.color,t);var n=0;return n=2,t.write_shift(1,n),Xr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var dee=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],av,hee=kn;function Gj(e,t){t||(t=Ee(84)),av||(av=jm(dee));var r=av[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Dh({auto:1},t),Dh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function mee(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function MO(e,t,r){r||(r=Ee(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ou(e,t){return t||(t=Ee(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var pee=kn;function xee(e,t){return t||(t=Ee(51)),t.write_shift(1,0),Ou(null,t),Ou(null,t),Ou(null,t),Ou(null,t),Ou(null,t),t.length>t.l?t.slice(0,t.l):t}function gee(e,t){return t||(t=Ee(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Fh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function vee(e,t,r){var n=Ee(2052);return n.write_shift(4,e),Fh(t,n),Fh(r,n),n.length>n.l?n.slice(0,n.l):n}function yee(e,t,r){var n={};n.NumberFmt=[];for(var a in it)n.NumberFmt[a]=it[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return fs(e,function(f,d,h){switch(h){case 44:n.NumberFmt[f[0]]=f[1],qi(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(f.color.rgb=Rh(t.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(h),s=!0;break;case 38:i.pop(),s=!1;break;default:if(d.T>0)i.push(h);else if(d.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function bee(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Ce(e,615,ni(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ce(e,44,cee(a,t[a]))}),Ce(e,616))}}function wee(e){var t=1;Ce(e,611,ni(t)),Ce(e,43,fee({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(e,612)}function See(e){var t=2;Ce(e,603,ni(t)),Ce(e,45,Gj({patternType:"none"})),Ce(e,45,Gj({patternType:"gray125"})),Ce(e,604)}function Nee(e){var t=1;Ce(e,613,ni(t)),Ce(e,46,xee()),Ce(e,614)}function Eee(e){var t=1;Ce(e,626,ni(t)),Ce(e,47,MO({numFmtId:0},65535)),Ce(e,627)}function _ee(e,t){Ce(e,617,ni(t.length)),t.forEach(function(r){Ce(e,47,MO(r,0))}),Ce(e,618)}function kee(e){var t=1;Ce(e,619,ni(t)),Ce(e,48,gee({xfId:0,name:"Normal"})),Ce(e,620)}function jee(e){var t=0;Ce(e,505,ni(t)),Ce(e,506)}function Cee(e){var t=0;Ce(e,508,vee(t,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}function Aee(e,t){var r=Jn();return Ce(r,278),bee(r,e.SSF),wee(r),See(r),Nee(r),Eee(r),_ee(r,t.cellXfs),kee(r),jee(r),Cee(r),Ce(r,279),r.end()}var Tee=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Pee(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(jn)||[]).forEach(function(a){var i=ct(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[Tee.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Oee(){}function Fee(){}var Dee=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Iee=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Mee=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ree(e,t,r){t.themeElements={};var n;[["clrScheme",Dee,Pee],["fontScheme",Iee,Oee],["fmtScheme",Mee,Fee]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Lee=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function RO(e,t){(!e||e.length===0)&&(e=Xb());var r,n={};if(!(r=e.match(Lee)))throw new Error("themeElements not found in theme");return Ree(r[0],n,t),n.raw=e,n}function Xb(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[br];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Bee(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=AP(i,{type:"array"})}catch{return}var l=fa(s,"theme/theme/theme1.xml",!0);if(l)return RO(l,r)}}function $ee(e){return e.read_shift(4)}function Uee(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=zee(e,4);break;case 2:t.xclrValue=xO(e);break;case 3:t.xclrValue=$ee(e);break;case 4:e.l+=4;break}return e.l+=8,t}function zee(e,t){return kn(e,t)}function Wee(e,t){return kn(e,t)}function Hee(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Uee(e);break;case 6:n[1]=Wee(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Vee(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(Hee(e,r-e.l));return{ixfe:n,ext:i}}function Gee(e,t){t.forEach(function(r){r[0]})}function Kee(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:_n(e)}}function qee(e){var t=Ee(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Xr(e.name,t),t.slice(0,t.l)}function Xee(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Yee(e){var t=Ee(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Jee(e,t){var r=Ee(8+2*t.length);return r.write_shift(4,e),Xr(t,r),r.slice(0,r.l)}function Qee(e){return e.l+=4,e.read_shift(4)!=0}function Zee(e,t){var r=Ee(8);return r.write_shift(4,e),r.write_shift(4,1),r}function ete(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,l=2;return fs(e,function(f,d,h){switch(h){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=f?1:0;break;case 338:l=2;break;case 35:i.push(h),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!d.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function tte(){var e=Jn();return Ce(e,332),Ce(e,334,ni(1)),Ce(e,335,qee({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,Jee(1,"XLDAPR")),Ce(e,52),Ce(e,35,ni(514)),Ce(e,4096,ni(0)),Ce(e,4097,Fa(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,Zee(1)),Ce(e,51,Yee([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function rte(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(jn,function(l){var f=ct(l);switch(_i(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(s=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return l}),n}function LO(){var e=[br];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function nte(e){var t=[];if(!e)return t;var r=1;return(e.match(jn)||[]).forEach(function(n){var a=ct(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function ate(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ot(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function ite(e,t,r){var n=[];return fs(e,function(i,s,l){switch(l){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function ste(e,t,r,n){if(!e)return e;var a=n||{},i=!1;fs(e,function(l,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function ote(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ec=1024;function BO(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Be("xml",null,{"xmlns:v":oa.v,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:mv":oa.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ec<e*1e3;)ec+=1e3;return t.forEach(function(i){var s=or(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var f=l.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Be("v:fill",f,l),h={on:"t",obscured:"t"};++ec,a=a.concat(["<v:shape"+xf({id:"_x0000_s"+ec,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Be("v:shadow",null,h),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),fn("x:AutoFill","False"),fn("x:Row",String(s.r)),fn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Kj(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var l=or(s.ref);if(a?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[s.ref],!i){i={t:"z"},a?e[l.r][l.c]=i:e[s.ref]=i;var f=wt(e["!ref"]||"BDWGO1000001:A1");f.s.r>l.r&&(f.s.r=l.r),f.e.r<l.r&&(f.e.r=l.r),f.s.c>l.c&&(f.s.c=l.c),f.e.c<l.c&&(f.e.c=l.c);var d=ht(f);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var h={a:s.author,t:s.t,r:s.r,T:r};s.h&&(h.h=s.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(h.a==n[m].id){h.a=n[m].name||h.a;break}}i.c.push(h)})}function lte(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?comment[^>]*>/);if(l){var f=ct(l[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},h=or(f.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var m=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!m&&!!m[1]&&Gb(m[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=x.h),n.push(d)}}}}),n}function $O(e){var t=[br,Be("comments",null,{xmlns:hl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=It(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(It(f.a))),i.push(f.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(fn("t",It(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)s+=`Reply:
    `+i[l]+`
`;t.push(fn("t",It(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function cte(e,t){var r=[],n=!1,a={},i=0;return e.replace(jn,function(l,f){var d=ct(l);switch(_i(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+l.length;break;case"</text>":a.t=e.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function ute(e,t,r){var n=[br,Be("ThreadedComments",null,{xmlns:Fr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,l){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=f.id:f.parentId=i,s.ID=f.id,s.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Be("threadedComment",fn("text",s.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function fte(e,t){var r=[],n=!1;return e.replace(jn,function(i){var s=ct(i);switch(_i(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function dte(e){var t=[br,Be("personList",null,{xmlns:Fr.TCMNT,"xmlns:x":hl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function hte(e){var t={};t.iauthor=e.read_shift(4);var r=gl(e);return t.rfx=r.s,t.ref=ot(r.s),e.l+=16,t}function mte(e,t){return t==null&&(t=Ee(36)),t.write_shift(4,e[1].iauthor),Bc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var pte=_n;function xte(e){return Xr(e.slice(0,54))}function gte(e,t){var r=[],n=[],a={},i=!1;return fs(e,function(l,f,d){switch(d){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function vte(e){var t=Jn(),r=[];return Ce(t,628),Ce(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Ce(t,632,xte(a.a)))})}),Ce(t,631),Ce(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:or(n[0]),e:or(n[0])};Ce(t,635,mte([i,a])),a.t&&a.t.length>0&&Ce(t,637,$Y(a)),Ce(t,636),delete a.iauthor})}),Ce(t,634),Ce(t,629),t.end()}var yte="application/vnd.ms-office.vbaProject";function bte(e){var t=tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),tt.write(t)}function wte(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&tt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var UO=["xlsb","xlsm","xlam","biff8","xla"];function Ste(){return{"!type":"dialog"}}function Nte(){return{"!type":"dialog"}}function Ete(){return{"!type":"macro"}}function _te(){return{"!type":"macro"}}var oc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var l=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,h=s.length>0?parseInt(s,10)|0:0;return l?h+=t.c:--h,f?d+=t.r:--d,a+(l?"":"$")+sr(h)+(f?"":"$")+vr(d)}return function(a,i){return t=i,a.replace(e,r)}})(),Yb=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Jb=(function(){return function(t,r){return t.replace(Yb,function(n,a,i,s,l,f){var d=Rb(s)-(i?0:r.c),h=Mb(f)-(l?0:r.r),m=h==0?"":l?h+1:"["+h+"]",x=d==0?"":i?d+1:"["+d+"]";return a+"R"+m+"C"+x})}})();function zO(e,t){return e.replace(Yb,function(r,n,a,i,s,l){return n+(a=="$"?a+i:sr(Rb(i)+t.c))+(s=="$"?s+l:vr(Mb(l)+t.r))})}function kte(e,t,r){var n=Zn(t),a=n.s,i=or(r),s={r:i.r-a.r,c:i.c-a.c};return zO(e,s)}function jte(e){return e.length!=1}function qj(e){return e.replace(/_xlfn\./g,"")}function Sr(e){e.l+=1}function Js(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function WO(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return HO(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Js(e),l=Js(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function HO(e){var t=Js(e),r=Js(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Cte(e,t,r){if(r.biff<8)return HO(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Js(e),s=Js(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function VO(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Ate(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Js(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Ate(e){var t=Js(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Tte(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Pte(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Ote(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:l}}function Ote(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Fte(e,t,r){var n=(e[e.l++]&96)>>5,a=WO(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Dte(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=WO(e,i,r);return[n,a,s]}function Ite(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Mte(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Rte(e,t,r){var n=(e[e.l++]&96)>>5,a=Cte(e,t-1,r);return[n,a]}function Lte(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Xj(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Bte(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function $te(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ute(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function zte(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Wte(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function GO(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Hte(e){return e.read_shift(2),GO(e)}function Vte(e){return e.read_shift(2),GO(e)}function Gte(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=VO(e,0,r);return[n,a]}function Kte(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Pte(e,0,r);return[n,a]}function qte(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=VO(e,0,r);return[n,a,i]}function Xte(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Qre[a],XO[a],n]}function Yte(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Jte(e);return[a,(i[0]===0?XO:Jre)[i[1]]]}function Jte(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Qte(e,t,r){e.l+=r&&r.biff==2?3:4}function Zte(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function ere(e){return e.l++,ds[e.read_shift(1)]}function tre(e){return e.l++,e.read_shift(2)}function rre(e){return e.l++,e.read_shift(1)!==0}function nre(e){return e.l++,Nn(e)}function are(e,t,r){return e.l++,Kf(e,t-1,r)}function ire(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=xr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ds[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Nn(e);break;case 2:r[1]=vl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function sre(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?gl:Tm)(e));return a}function ore(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var l=0;l!=a;++l)s[i][l]=ire(e,r.biff);return s}function lre(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function cre(e,t,r){if(r.biff==5)return ure(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function ure(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function fre(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function dre(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function hre(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function mre(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var pre=kn,xre=kn,gre=kn;function Xf(e,t,r){return e.l+=2,[Tte(e)]}function Qb(e){return e.l+=6,[]}var vre=Xf,yre=Qb,bre=Qb,wre=Xf;function KO(e){return e.l+=2,[Er(e),e.read_shift(2)&1]}var Sre=Xf,Nre=KO,Ere=Qb,_re=Xf,kre=Xf,jre=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Cre(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=jre[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Are(e){return e.l+=2,[e.read_shift(4)]}function Tre(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Pre(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Ore(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Fre(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Dre(e){return e.l+=4,[0,0]}var Yj={1:{n:"PtgExp",f:Zte},2:{n:"PtgTbl",f:gre},3:{n:"PtgAdd",f:Sr},4:{n:"PtgSub",f:Sr},5:{n:"PtgMul",f:Sr},6:{n:"PtgDiv",f:Sr},7:{n:"PtgPower",f:Sr},8:{n:"PtgConcat",f:Sr},9:{n:"PtgLt",f:Sr},10:{n:"PtgLe",f:Sr},11:{n:"PtgEq",f:Sr},12:{n:"PtgGe",f:Sr},13:{n:"PtgGt",f:Sr},14:{n:"PtgNe",f:Sr},15:{n:"PtgIsect",f:Sr},16:{n:"PtgUnion",f:Sr},17:{n:"PtgRange",f:Sr},18:{n:"PtgUplus",f:Sr},19:{n:"PtgUminus",f:Sr},20:{n:"PtgPercent",f:Sr},21:{n:"PtgParen",f:Sr},22:{n:"PtgMissArg",f:Sr},23:{n:"PtgStr",f:are},26:{n:"PtgSheet",f:Tre},27:{n:"PtgEndSheet",f:Pre},28:{n:"PtgErr",f:ere},29:{n:"PtgBool",f:rre},30:{n:"PtgInt",f:tre},31:{n:"PtgNum",f:nre},32:{n:"PtgArray",f:Lte},33:{n:"PtgFunc",f:Xte},34:{n:"PtgFuncVar",f:Yte},35:{n:"PtgName",f:lre},36:{n:"PtgRef",f:Gte},37:{n:"PtgArea",f:Fte},38:{n:"PtgMemArea",f:fre},39:{n:"PtgMemErr",f:pre},40:{n:"PtgMemNoMem",f:xre},41:{n:"PtgMemFunc",f:dre},42:{n:"PtgRefErr",f:hre},43:{n:"PtgAreaErr",f:Ite},44:{n:"PtgRefN",f:Kte},45:{n:"PtgAreaN",f:Rte},46:{n:"PtgMemAreaN",f:Ore},47:{n:"PtgMemNoMemN",f:Fre},57:{n:"PtgNameX",f:cre},58:{n:"PtgRef3d",f:qte},59:{n:"PtgArea3d",f:Dte},60:{n:"PtgRefErr3d",f:mre},61:{n:"PtgAreaErr3d",f:Mte},255:{}},Ire={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Mre={1:{n:"PtgElfLel",f:KO},2:{n:"PtgElfRw",f:_re},3:{n:"PtgElfCol",f:vre},6:{n:"PtgElfRwV",f:kre},7:{n:"PtgElfColV",f:wre},10:{n:"PtgElfRadical",f:Sre},11:{n:"PtgElfRadicalS",f:Ere},13:{n:"PtgElfColS",f:yre},15:{n:"PtgElfColSV",f:bre},16:{n:"PtgElfRadicalLel",f:Nre},25:{n:"PtgList",f:Cre},29:{n:"PtgSxName",f:Are},255:{}},Rre={0:{n:"PtgAttrNoop",f:Dre},1:{n:"PtgAttrSemi",f:Wte},2:{n:"PtgAttrIf",f:Ute},4:{n:"PtgAttrChoose",f:Bte},8:{n:"PtgAttrGoto",f:$te},16:{n:"PtgAttrSum",f:Qte},32:{n:"PtgAttrBaxcel",f:Xj},33:{n:"PtgAttrBaxcel",f:Xj},64:{n:"PtgAttrSpace",f:Hte},65:{n:"PtgAttrSpaceSemi",f:Vte},128:{n:"PtgAttrIfError",f:zte},255:{}};function Yf(e,t,r,n){if(n.biff<8)return kn(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=ore(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=sre(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(kn(e,t)),i}function Jf(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Yj[i]||Yj[Ire[i]],(i===24||i===25)&&(a=(i===24?Mre:Rre)[e[e.l+1]]),!a||!a.f?kn(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Lre(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];s?s[0]===2?a.push('"'+s[1].replace(/"/g,'""')+'"'):a.push(s[1]):a.push("")}t.push(a.join(","))}return t.join(";")}var Bre={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $re(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function qO(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Jj(e,t,r){var n=qO(e,t,r);return n=="#REF"?n:$re(n,r)}function bn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},l=[],f,d,h,m=0,x=0,g,y="";if(!e[0]||!e[0][0])return"";for(var v=-1,b="",E=0,N=e[0].length;E<N;++E){var S=e[0][E];switch(S[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=l.pop(),d=l.pop(),v>=0){switch(e[0][v][1][0]){case 0:b=ur(" ",e[0][v][1][1]);break;case 1:b=ur("\r",e[0][v][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}d=d+b,v=-1}l.push(d+Bre[S[0]]+f);break;case"PtgIsect":f=l.pop(),d=l.pop(),l.push(d+" "+f);break;case"PtgUnion":f=l.pop(),d=l.pop(),l.push(d+","+f);break;case"PtgRange":f=l.pop(),d=l.pop(),l.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Vu(S[1][1],s,a),l.push(Gu(h,i));break;case"PtgRefN":h=r?Vu(S[1][1],r,a):S[1][1],l.push(Gu(h,i));break;case"PtgRef3d":m=S[1][1],h=Vu(S[1][2],s,a),y=Jj(n,m,a),l.push(y+"!"+Gu(h,i));break;case"PtgFunc":case"PtgFuncVar":var j=S[1][0],T=S[1][1];j||(j=0),j&=127;var C=j==0?[]:l.slice(-j);l.length-=j,T==="User"&&(T=C.shift()),l.push(T+"("+C.join(",")+")");break;case"PtgBool":l.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(S[1]);break;case"PtgNum":l.push(String(S[1]));break;case"PtgStr":l.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(S[1]);break;case"PtgAreaN":g=kj(S[1][1],r?{s:r}:s,a),l.push(ev(g,a));break;case"PtgArea":g=kj(S[1][1],s,a),l.push(ev(g,a));break;case"PtgArea3d":m=S[1][1],g=S[1][2],y=Jj(n,m,a),l.push(y+"!"+ev(g,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=S[1][2];var P=(n.names||[])[x-1]||(n[0]||[])[x],M=P?P.Name:"SH33TJSNAME"+String(x);M&&M.slice(0,6)=="_xlfn."&&!a.xlfn&&(M=M.slice(6)),l.push(M);break;case"PtgNameX":var D=S[1][1];x=S[1][2];var W;if(a.biff<=5)D<0&&(D=-D),n[D]&&(W=n[D][x]);else{var F="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][x]&&n[D][x].itab>0&&(F=n.SheetNames[n[D][x].itab-1]+"!"):F=n.SheetNames[x-1]+"!"),n[D]&&n[D][x])F+=n[D][x].Name;else if(n[0]&&n[0][x])F+=n[0][x].Name;else{var L=(qO(n,D,a)||"").split(";;");L[x-1]?F=L[x-1]:F+="SH33TJSERRX"}l.push(F);break}W||(W={Name:"SH33TJSERRY"}),l.push(W.Name);break;case"PtgParen":var J="(",se=")";if(v>=0){switch(b="",e[0][v][1][0]){case 2:J=ur(" ",e[0][v][1][1])+J;break;case 3:J=ur("\r",e[0][v][1][1])+J;break;case 4:se=ur(" ",e[0][v][1][1])+se;break;case 5:se=ur("\r",e[0][v][1][1])+se;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}l.push(J+l.pop()+se);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:S[1][1],r:S[1][0]};var Z={c:r.c,r:r.r};if(n.sharedf[ot(h)]){var he=n.sharedf[ot(h)];l.push(bn(he,s,Z,n,a))}else{var le=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){l.push(bn(d[1],s,Z,n,a)),le=!0;break}le||l.push(S[1])}break;case"PtgArray":l.push("{"+Lre(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&v>=0&&de.indexOf(e[0][E][0])==-1){S=e[0][v];var Q=!0;switch(S[1][0]){case 4:Q=!1;case 0:b=ur(" ",S[1][1]);break;case 5:Q=!1;case 1:b=ur("\r",S[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}l.push((Q?b:"")+l.pop()+(Q?"":b)),v=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function Ure(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],kn(e,t-2)];var l=Jf(e,s,r);return t!==s+a&&(i=Yf(e,t-s-a,l,r)),e.l=n,[l,i]}function zre(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],kn(e,t-2)];var l=Jf(e,s,r);return t!==s+a&&(i=Yf(e,t-s-a,l,r)),e.l=n,[l,i]}function Wre(e,t,r,n){var a=e.l+t,i=Jf(e,n,r),s;return a!==e.l&&(s=Yf(e,a-e.l,i,r)),[i,s]}function Hre(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=Jf(e,i,r);return i==65535?[[],kn(e,t-2)]:(t!==i+2&&(a=Yf(e,n-i-2,s,r)),[s,a])}function Vre(e){var t;if(Hi(e,e.l+6)!==65535)return[Nn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Gre(e){if(e==null){var t=Ee(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return tl(e);return tl(0)}function iv(e,t,r){var n=e.l+t,a=ki(e);r.biff==2&&++e.l;var i=Vre(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=zre(e,n-e.l,r);return{cell:a,val:i[0],formula:l,shared:s>>3&1,tt:i[1]}}function Kre(e,t,r,n,a){var i=nl(t,r,a),s=Gre(e.v),l=Ee(6),f=33;l.write_shift(2,f),l.write_shift(4,0);for(var d=Ee(e.bf.length),h=0;h<e.bf.length;++h)d[h]=e.bf[h];var m=Kr([i,s,l,d]);return m}function Pm(e,t,r){var n=e.read_shift(4),a=Jf(e,n,r),i=e.read_shift(4),s=i>0?Yf(e,i,a,r):null;return[a,s]}var qre=Pm,Om=Pm,Xre=Pm,Yre=Pm,Jre={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},XO={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Qre={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Qj(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Zre(e){var t="of:="+e.replace(Yb,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function sv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function ene(e){return e.replace(/\./,"!")}var qu={},lc={},Xu=typeof Map<"u";function Zb(e,t,r){var n=0,a=e.length;if(r){if(Xu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Xu?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Xu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Fm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Sn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=wf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Lh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Wo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function oo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){qi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function YO(e,t,r,n,a,i){try{n.cellNF&&(e.z=it[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=qt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(it[t]==null&&qi(JX[t]||"General",t),e.t==="e")e.w=e.w||ds[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=mf(e.v);else if(e.t==="d"){var s=Ir(e.v);(s|0)===s?e.w=s.toString(10):e.w=mf(s)}else{if(e.v===void 0)return"";e.w=Zo(e.v,lc)}else e.t==="d"?e.w=Ba(t,Ir(e.v),lc):e.w=Ba(t,e.v,lc)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Rh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Rh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function tne(e,t,r){if(e&&e["!ref"]){var n=wt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function rne(e,t){var r=wt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ht(r))}var nne=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,ane=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ine=/<(?:\w:)?hyperlink [^>]*>/mg,sne=/"(\w*:\w*)"/,one=/<(?:\w:)?col\b[^>]*[\/]?>/g,lne=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,cne=/<(?:\w:)?pageMargins[^>]*\/>/g,JO=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,une=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,fne=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function dne(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",m=e.match(ane);m?(d=e.slice(0,m.index),h=e.slice(m.index+m[0].length)):d=h=e;var x=d.match(JO);x?ew(x[0],l,a,r):(x=d.match(une))&&mne(x[0],x[1]||"",l,a,r);var g=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var y=d.slice(g,g+50).match(sne);y&&rne(l,y[1])}var v=d.match(fne);v&&v[1]&&jne(v[1],a);var b=[];if(t.cellStyles){var E=d.match(one);E&&Sne(b,E)}m&&Tne(m[1],l,t,f,i,s);var N=h.match(lne);N&&(l["!autofilter"]=Ene(N[0]));var S=[],j=h.match(nne);if(j)for(g=0;g!=j.length;++g)S[g]=wt(j[g].slice(j[g].indexOf('"')+1));var T=h.match(ine);T&&yne(l,T,n);var C=h.match(cne);if(C&&(l["!margins"]=bne(ct(C[0]))),!l["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(l["!ref"]=ht(f)),t.sheetRows>0&&l["!ref"]){var P=wt(l["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>f.e.r&&(P.e.r=f.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>f.e.c&&(P.e.c=f.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ht(P))}return b.length>0&&(l["!cols"]=b),S.length>0&&(l["!merges"]=S),l}function hne(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ht(e[r])+'"/>';return t+"</mergeCells>"}function ew(e,t,r,n){var a=ct(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=yt(Rt(a.codeName)))}function mne(e,t,r,n,a){ew(e.slice(0,e.indexOf(">")),r,n,a)}function pne(e,t,r,n,a){var i=!1,s={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[r];try{t.Workbook&&(f=t.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,s.codeName=vi(It(f))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+Be("outlinePr",null,d)}!i&&!l||(a[a.length]=Be("sheetPr",l,s))}var xne=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gne=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function vne(e){var t={sheet:1};return xne.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),gne.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Kb(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function yne(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=ct(Rt(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+yt(i.location))):(i.Target="#"+yt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=wt(i.ref),f=l.s.r;f<=l.e.r;++f)for(var d=l.s.c;d<=l.e.c;++d){var h=ot({c:d,r:f});n?(e[f]||(e[f]=[]),e[f][d]||(e[f][d]={t:"z",v:void 0}),e[f][d].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function bne(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function wne(e){return Wo(e),Be("pageMargins",null,e)}function Sne(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=ct(t[n],!0);a.hidden&&(a.hidden=Kt(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,qb(a.width)),Ys(a);i<=s;)e[i++]=Xt(a)}}function Nne(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Be("col",null,Fm(a,n)));return r[r.length]="</cols>",r.join("")}function Ene(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function _ne(e,t,r,n){var a=typeof e.ref=="string"?e.ref:ht(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Zn(a);s.s.r==s.e.r&&(s.e.r=Zn(t["!ref"]).e.r,a=ht(s));for(var l=0;l<i.length;++l){var f=i[l];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Be("autoFilter",null,{ref:a})}var kne=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function jne(e,t){t.Views||(t.Views=[{}]),(e.match(kne)||[]).forEach(function(r,n){var a=ct(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Kt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function Cne(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,a),{})}function Ane(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=ds[e.v];break;case"d":n&&n.cellDates?a=qt(e.v,-1).toISOString():(e=Xt(e),e.t="n",a=""+(e.v=Ir(qt(e.v)))),typeof e.z>"u"&&(e.z=it[14]);break;default:a=e.v;break}var l=fn("v",It(a)),f={r:t},d=oo(n.cellXfs,e,n);switch(d!==0&&(f.s=d),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=fn("v",""+Zb(n.Strings,e.v,n.revStrings)),f.t="s";break}f.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Be("f",It(e.f),h)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(f.cm=1),Be("c",l,f)}var Tne=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=pf("v"),s=pf("f");return function(f,d,h,m,x,g){for(var y=0,v="",b=[],E=[],N=0,S=0,j=0,T="",C,P,M=0,D=0,W,F,L=0,J=0,se=Array.isArray(g.CellXf),Z,he=[],le=[],de=Array.isArray(d),Q=[],pe={},re=!1,O=!!h.sheetStubs,V=f.split(t),H=0,q=V.length;H!=q;++H){v=V[H].trim();var K=v.length;if(K!==0){var ie=0;e:for(y=0;y<K;++y)switch(v[y]){case">":if(v[y-1]!="/"){++y;break e}if(h&&h.cellStyles){if(P=ct(v.slice(ie,y),!0),M=P.r!=null?parseInt(P.r,10):M+1,D=-1,h.sheetRows&&h.sheetRows<M)continue;pe={},re=!1,P.ht&&(re=!0,pe.hpt=parseFloat(P.ht),pe.hpx=_c(pe.hpt)),P.hidden=="1"&&(re=!0,pe.hidden=!0),P.outlineLevel!=null&&(re=!0,pe.level=+P.outlineLevel),re&&(Q[M-1]=pe)}break;case"<":ie=y;break}if(ie>=y)break;if(P=ct(v.slice(ie,y),!0),M=P.r!=null?parseInt(P.r,10):M+1,D=-1,!(h.sheetRows&&h.sheetRows<M)){m.s.r>M-1&&(m.s.r=M-1),m.e.r<M-1&&(m.e.r=M-1),h&&h.cellStyles&&(pe={},re=!1,P.ht&&(re=!0,pe.hpt=parseFloat(P.ht),pe.hpx=_c(pe.hpt)),P.hidden=="1"&&(re=!0,pe.hidden=!0),P.outlineLevel!=null&&(re=!0,pe.level=+P.outlineLevel),re&&(Q[M-1]=pe)),b=v.slice(y).split(e);for(var B=0;B!=b.length&&b[B].trim().charAt(0)=="<";++B);for(b=b.slice(B),y=0;y!=b.length;++y)if(v=b[y].trim(),v.length!==0){if(E=v.match(r),N=y,S=0,j=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,E!=null&&E.length===2){for(N=0,T=E[1],S=0;S!=T.length&&!((j=T.charCodeAt(S)-64)<1||j>26);++S)N=26*N+j;--N,D=N}else++D;for(S=0;S!=v.length&&v.charCodeAt(S)!==62;++S);if(++S,P=ct(v.slice(0,S),!0),P.r||(P.r=ot({r:M-1,c:D})),T=v.slice(S),C={t:""},(E=T.match(i))!=null&&E[1]!==""&&(C.v=yt(E[1])),h.cellFormula){if((E=T.match(s))!=null&&E[1]!==""){if(C.f=yt(Rt(E[1])).replace(/\r\n/g,`
`),h.xlfn||(C.f=qj(C.f)),E[0].indexOf('t="array"')>-1)C.F=(T.match(a)||[])[1],C.F.indexOf(":")>-1&&he.push([wt(C.F),C.F]);else if(E[0].indexOf('t="shared"')>-1){F=ct(E[0]);var z=yt(Rt(E[1]));h.xlfn||(z=qj(z)),le[parseInt(F.si,10)]=[F,z,P.r]}}else(E=T.match(/<f[^>]*\/>/))&&(F=ct(E[0]),le[F.si]&&(C.f=kte(le[F.si][1],le[F.si][2],P.r)));var G=or(P.r);for(S=0;S<he.length;++S)G.r>=he[S][0].s.r&&G.r<=he[S][0].e.r&&G.c>=he[S][0].s.c&&G.c<=he[S][0].e.c&&(C.F=he[S][1])}if(P.t==null&&C.v===void 0)if(C.f||C.F)C.v=0,C.t="n";else if(O)C.t="z";else continue;else C.t=P.t||"n";switch(m.s.c>D&&(m.s.c=D),m.e.c<D&&(m.e.c=D),C.t){case"n":if(C.v==""||C.v==null){if(!O)continue;C.t="z"}else C.v=parseFloat(C.v);break;case"s":if(typeof C.v>"u"){if(!O)continue;C.t="z"}else W=qu[parseInt(C.v,10)],C.v=W.t,C.r=W.r,h.cellHTML&&(C.h=W.h);break;case"str":C.t="s",C.v=C.v!=null?Rt(C.v):"",h.cellHTML&&(C.h=Ob(C.v));break;case"inlineStr":E=T.match(n),C.t="s",E!=null&&(W=Gb(E[1]))?(C.v=W.t,h.cellHTML&&(C.h=W.h)):C.v="";break;case"b":C.v=Kt(C.v);break;case"d":h.cellDates?C.v=qt(C.v,1):(C.v=Ir(qt(C.v,1)),C.t="n");break;case"e":(!h||h.cellText!==!1)&&(C.w=C.v),C.v=ZP[C.v];break}if(L=J=0,Z=null,se&&P.s!==void 0&&(Z=g.CellXf[P.s],Z!=null&&(Z.numFmtId!=null&&(L=Z.numFmtId),h.cellStyles&&Z.fillId!=null&&(J=Z.fillId))),YO(C,L,J,h,x,g),h.cellDates&&se&&C.t=="n"&&Mc(it[L])&&(C.t="d",C.v=Am(C.v)),P.cm&&h.xlmeta){var ce=(h.xlmeta.Cell||[])[+P.cm-1];ce&&ce.type=="XLDAPR"&&(C.D=!0)}if(de){var I=or(P.r);d[I.r]||(d[I.r]=[]),d[I.r][I.c]=C}else d[P.r]=C}}}}Q.length>0&&(d["!rows"]=Q)}})();function Pne(e,t,r,n){var a=[],i=[],s=wt(e["!ref"]),l="",f,d="",h=[],m=0,x=0,g=e["!rows"],y=Array.isArray(e),v={r:d},b,E=-1;for(x=s.s.c;x<=s.e.c;++x)h[x]=sr(x);for(m=s.s.r;m<=s.e.r;++m){for(i=[],d=vr(m),x=s.s.c;x<=s.e.c;++x){f=h[x]+d;var N=y?(e[m]||[])[x]:e[f];N!==void 0&&(l=Ane(N,f,e,t))!=null&&i.push(l)}(i.length>0||g&&g[m])&&(v={r:d},g&&g[m]&&(b=g[m],b.hidden&&(v.hidden=1),E=-1,b.hpx?E=Sf(b.hpx):b.hpt&&(E=b.hpt),E>-1&&(v.ht=E,v.customHeight=1),b.level&&(v.outlineLevel=b.level)),a[a.length]=Be("row",i.join(""),v))}if(g)for(;m<g.length;++m)g&&g[m]&&(v={r:m+1},b=g[m],b.hidden&&(v.hidden=1),E=-1,b.hpx?E=Sf(b.hpx):b.hpt&&(E=b.hpt),E>-1&&(v.ht=E,v.customHeight=1),b.level&&(v.outlineLevel=b.level),a[a.length]=Be("row","",v));return a.join("")}function QO(e,t,r,n){var a=[br,Be("worksheet",null,{xmlns:hl[0],"xmlns:r":Fr.r})],i=r.SheetNames[e],s=0,l="",f=r.Sheets[i];f==null&&(f={});var d=f["!ref"]||"A1",h=wt(d);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),d=ht(h)}n||(n={}),f["!comments"]=[];var m=[];pne(f,r,e,t,a),a[a.length]=Be("dimension",null,{ref:d}),a[a.length]=Cne(f,t,e,r),t.sheetFormat&&(a[a.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=Nne(f,f["!cols"])),a[s=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(l=Pne(f,t),l.length>0&&(a[a.length]=l)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),f["!protect"]&&(a[a.length]=vne(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=_ne(f["!autofilter"],f,r,e)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=hne(f["!merges"]));var x=-1,g,y=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(v){v[1].Target&&(g={ref:v[0]},v[1].Target.charAt(0)!="#"&&(y=Ot(n,-1,It(v[1].Target).replace(/#.*$/,""),gt.HLINK),g["r:id"]="rId"+y),(x=v[1].Target.indexOf("#"))>-1&&(g.location=It(v[1].Target.slice(x+1))),v[1].Tooltip&&(g.tooltip=It(v[1].Tooltip)),a[a.length]=Be("hyperlink",null,g))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=wne(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=fn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:d}))),m.length>0&&(y=Ot(n,-1,"../drawings/drawing"+(e+1)+".xml",gt.DRAW),a[a.length]=Be("drawing",null,{"r:id":"rId"+y}),f["!drawing"]=m),f["!comments"].length>0&&(y=Ot(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",gt.VML),a[a.length]=Be("legacyDrawing",null,{"r:id":"rId"+y}),f["!legacy"]=y),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function One(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Fne(e,t,r){var n=Ee(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Sf(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var l=0,f=n.l;n.l+=4;for(var d={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var m=-1,x=-1,g=h<<10;g<h+1<<10;++g){d.c=g;var y=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ot(d)];y&&(m<0&&(m=g),x=g)}m<0||(++l,n.write_shift(4,m),n.write_shift(4,x))}var v=n.l;return n.l=f,n.write_shift(4,l),n.l=v,n.length>n.l?n.slice(0,n.l):n}function Dne(e,t,r,n){var a=Fne(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Ce(e,0,a)}var Ine=gl,Mne=Bc;function Rne(){}function Lne(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=UY(e),r}function Bne(e,t,r){r==null&&(r=Ee(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Dh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),qP(e,r),r.slice(0,r.l)}function $ne(e){var t=za(e);return[t]}function Une(e,t,r){return r==null&&(r=Ee(8)),ml(t,r)}function zne(e){var t=pl(e);return[t]}function Wne(e,t,r){return r==null&&(r=Ee(4)),xl(t,r)}function Hne(e){var t=za(e),r=e.read_shift(1);return[t,r,"b"]}function Vne(e,t,r){return r==null&&(r=Ee(9)),ml(t,r),r.write_shift(1,e.v?1:0),r}function Gne(e){var t=pl(e),r=e.read_shift(1);return[t,r,"b"]}function Kne(e,t,r){return r==null&&(r=Ee(5)),xl(t,r),r.write_shift(1,e.v?1:0),r}function qne(e){var t=za(e),r=e.read_shift(1);return[t,r,"e"]}function Xne(e,t,r){return r==null&&(r=Ee(9)),ml(t,r),r.write_shift(1,e.v),r}function Yne(e){var t=pl(e),r=e.read_shift(1);return[t,r,"e"]}function Jne(e,t,r){return r==null&&(r=Ee(8)),xl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Qne(e){var t=za(e),r=e.read_shift(4);return[t,r,"s"]}function Zne(e,t,r){return r==null&&(r=Ee(12)),ml(t,r),r.write_shift(4,t.v),r}function eae(e){var t=pl(e),r=e.read_shift(4);return[t,r,"s"]}function tae(e,t,r){return r==null&&(r=Ee(8)),xl(t,r),r.write_shift(4,t.v),r}function rae(e){var t=za(e),r=Nn(e);return[t,r,"n"]}function nae(e,t,r){return r==null&&(r=Ee(16)),ml(t,r),tl(e.v,r),r}function ZO(e){var t=pl(e),r=Nn(e);return[t,r,"n"]}function aae(e,t,r){return r==null&&(r=Ee(12)),xl(t,r),tl(e.v,r),r}function iae(e){var t=za(e),r=Ub(e);return[t,r,"n"]}function sae(e,t,r){return r==null&&(r=Ee(12)),ml(t,r),XP(e.v,r),r}function oae(e){var t=pl(e),r=Ub(e);return[t,r,"n"]}function lae(e,t,r){return r==null&&(r=Ee(8)),xl(t,r),XP(e.v,r),r}function cae(e){var t=za(e),r=Lb(e);return[t,r,"is"]}function uae(e){var t=za(e),r=_n(e);return[t,r,"str"]}function fae(e,t,r){return r==null&&(r=Ee(12+4*e.v.length)),ml(t,r),Xr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function dae(e){var t=pl(e),r=_n(e);return[t,r,"str"]}function hae(e,t,r){return r==null&&(r=Ee(8+4*e.v.length)),xl(t,r),Xr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function mae(e,t,r){var n=e.l+t,a=za(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=Om(e,n-e.l,r);s[3]=bn(l,null,a,r.supbooks,r)}else e.l=n;return s}function pae(e,t,r){var n=e.l+t,a=za(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=Om(e,n-e.l,r);s[3]=bn(l,null,a,r.supbooks,r)}else e.l=n;return s}function xae(e,t,r){var n=e.l+t,a=za(e);a.r=r["!row"];var i=Nn(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=Om(e,n-e.l,r);s[3]=bn(l,null,a,r.supbooks,r)}else e.l=n;return s}function gae(e,t,r){var n=e.l+t,a=za(e);a.r=r["!row"];var i=_n(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=Om(e,n-e.l,r);s[3]=bn(l,null,a,r.supbooks,r)}else e.l=n;return s}var vae=gl,yae=Bc;function bae(e,t){return t==null&&(t=Ee(4)),t.write_shift(4,e),t}function wae(e,t){var r=e.l+t,n=gl(e),a=Bb(e),i=_n(e),s=_n(e),l=_n(e);e.l=r;var f={rfx:n,relId:a,loc:i,display:l};return s&&(f.Tooltip=s),f}function Sae(e,t){var r=Ee(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Bc({s:or(e[0]),e:or(e[0])},r),$b("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Xr(a||"",r),Xr(e[1].Tooltip||"",r),Xr("",r),r.slice(0,r.l)}function Nae(){}function Eae(e,t,r){var n=e.l+t,a=YP(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var l=qre(e,n-e.l,r);s[1]=l}else e.l=n;return s}function _ae(e,t,r){var n=e.l+t,a=gl(e),i=[a];if(r.cellFormula){var s=Yre(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function kae(e,t,r){r==null&&(r=Ee(18));var n=Fm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var e6=["left","right","top","bottom","header","footer"];function jae(e){var t={};return e6.forEach(function(r){t[r]=Nn(e)}),t}function Cae(e,t){return t==null&&(t=Ee(48)),Wo(e),e6.forEach(function(r){tl(e[r],t)}),t}function Aae(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Tae(e,t,r){r==null&&(r=Ee(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Pae(e){var t=Ee(24);return t.write_shift(4,4),t.write_shift(4,1),Bc(e,t),t}function Oae(e,t){return t==null&&(t=Ee(66)),t.write_shift(2,e.password?Kb(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Fae(){}function Dae(){}function Iae(e,t,r,n,a,i,s){if(!e)return e;var l=t||{};n||(n={"!id":{}});var f=l.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,x=!1,g,y,v,b,E,N,S,j,T,C=[];l.biff=12,l["!row"]=0;var P=0,M=!1,D=[],W={},F=l.supbooks||a.supbooks||[[]];if(F.sharedf=W,F.arrayf=D,F.SheetNames=a.SheetNames||a.Sheets.map(function(de){return de.name}),!l.supbooks&&(l.supbooks=F,a.Names))for(var L=0;L<a.Names.length;++L)F[0][L+1]=a.Names[L];var J=[],se=[],Z=!1;Nf[16]={n:"BrtShortReal",f:ZO};var he;if(fs(e,function(Q,pe,re){if(!x)switch(re){case 148:d=Q;break;case 0:g=Q,l.sheetRows&&l.sheetRows<=g.r&&(x=!0),j=vr(b=g.r),l["!row"]=g.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=_c(Q.hpt)),se[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:Q[2]},Q[2]){case"n":y.v=Q[1];break;case"s":S=qu[Q[1]],y.v=S.t,y.r=S.r;break;case"b":y.v=!!Q[1];break;case"e":y.v=Q[1],l.cellText!==!1&&(y.w=ds[y.v]);break;case"str":y.t="s",y.v=Q[1];break;case"is":y.t="s",y.v=Q[1].t;break}if((v=s.CellXf[Q[0].iStyleRef])&&YO(y,v.numFmtId,null,l,i,s),E=Q[0].c==-1?E+1:Q[0].c,l.dense?(f[b]||(f[b]=[]),f[b][E]=y):f[sr(E)+j]=y,l.cellFormula){for(M=!1,P=0;P<D.length;++P){var O=D[P];g.r>=O[0].s.r&&g.r<=O[0].e.r&&E>=O[0].s.c&&E<=O[0].e.c&&(y.F=ht(O[0]),M=!0)}!M&&Q.length>3&&(y.f=Q[3])}if(h.s.r>g.r&&(h.s.r=g.r),h.s.c>E&&(h.s.c=E),h.e.r<g.r&&(h.e.r=g.r),h.e.c<E&&(h.e.c=E),l.cellDates&&v&&y.t=="n"&&Mc(it[v.numFmtId])){var V=Io(y.v);V&&(y.t="d",y.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}he&&(he.type=="XLDAPR"&&(y.D=!0),he=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;y={t:"z",v:void 0},E=Q[0].c==-1?E+1:Q[0].c,l.dense?(f[b]||(f[b]=[]),f[b][E]=y):f[sr(E)+j]=y,h.s.r>g.r&&(h.s.r=g.r),h.s.c>E&&(h.s.c=E),h.e.r<g.r&&(h.e.r=g.r),h.e.c<E&&(h.e.c=E),he&&(he.type=="XLDAPR"&&(y.D=!0),he=void 0);break;case 176:C.push(Q);break;case 49:he=((l.xlmeta||{}).Cell||[])[Q-1];break;case 494:var H=n["!id"][Q.relId];for(H?(Q.Target=H.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=H):Q.relId==""&&(Q.Target="#"+Q.loc),b=Q.rfx.s.r;b<=Q.rfx.e.r;++b)for(E=Q.rfx.s.c;E<=Q.rfx.e.c;++E)l.dense?(f[b]||(f[b]=[]),f[b][E]||(f[b][E]={t:"z",v:void 0}),f[b][E].l=Q):(N=ot({c:E,r:b}),f[N]||(f[N]={t:"z",v:void 0}),f[N].l=Q);break;case 426:if(!l.cellFormula)break;D.push(Q),T=l.dense?f[b][E]:f[sr(E)+j],T.f=bn(Q[1],h,{r:g.r,c:E},F,l),T.F=ht(Q[0]);break;case 427:if(!l.cellFormula)break;W[ot(Q[0].s)]=Q[1],T=l.dense?f[b][E]:f[sr(E)+j],T.f=bn(Q[1],h,{r:g.r,c:E},F,l);break;case 60:if(!l.cellStyles)break;for(;Q.e>=Q.s;)J[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},Z||(Z=!0,qb(Q.w/256)),Ys(J[Q.e+1]);break;case 161:f["!autofilter"]={ref:ht(Q)};break;case 476:f["!margins"]=Q;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),Q.name&&(a.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(f["!outline"]={above:Q.above,left:Q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!pe.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+re.toString(16))}}},l),delete l.supbooks,delete l["!row"],!f["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=ht(d||h)),l.sheetRows&&f["!ref"]){var le=wt(f["!ref"]);l.sheetRows<=+le.e.r&&(le.e.r=l.sheetRows-1,le.e.r>h.e.r&&(le.e.r=h.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>h.e.c&&(le.e.c=h.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),f["!fullref"]=f["!ref"],f["!ref"]=ht(le))}return C.length>0&&(f["!merges"]=C),J.length>0&&(f["!cols"]=J),se.length>0&&(f["!rows"]=se),f}function Mae(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Xt(t),t.z=t.z||it[14],t.v=Ir(qt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var f={r,c:n};switch(f.s=oo(a.cellXfs,t,a),t.l&&i["!links"].push([ot(f),t.l]),t.c&&i["!comments"].push([ot(f),t.c]),t.t){case"s":case"str":return a.bookSST?(l=Zb(a.Strings,t.v,a.revStrings),f.t="s",f.v=l,s?Ce(e,18,tae(t,f)):Ce(e,7,Zne(t,f))):(f.t="str",s?Ce(e,17,hae(t,f)):Ce(e,6,fae(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Ce(e,13,lae(t,f)):Ce(e,2,sae(t,f)):s?Ce(e,16,aae(t,f)):Ce(e,5,nae(t,f)),!0;case"b":return f.t="b",s?Ce(e,15,Kne(t,f)):Ce(e,4,Vne(t,f)),!0;case"e":return f.t="e",s?Ce(e,14,Jne(t,f)):Ce(e,3,Xne(t,f)),!0}return s?Ce(e,12,Wne(t,f)):Ce(e,1,Une(t,f)),!0}function Rae(e,t,r,n){var a=wt(t["!ref"]||"A1"),i,s="",l=[];Ce(e,145);var f=Array.isArray(t),d=a.e.r;t["!rows"]&&(d=Math.max(a.e.r,t["!rows"].length-1));for(var h=a.s.r;h<=d;++h){s=vr(h),Dne(e,t,a,h);var m=!1;if(h<=a.e.r)for(var x=a.s.c;x<=a.e.c;++x){h===a.s.r&&(l[x]=sr(x)),i=l[x]+s;var g=f?(t[h]||[])[x]:t[i];if(!g){m=!1;continue}m=Mae(e,g,h,x,n,t,m)}}Ce(e,146)}function Lae(e,t){!t||!t["!merges"]||(Ce(e,177,bae(t["!merges"].length)),t["!merges"].forEach(function(r){Ce(e,176,yae(r))}),Ce(e,178))}function Bae(e,t){!t||!t["!cols"]||(Ce(e,390),t["!cols"].forEach(function(r,n){r&&Ce(e,60,kae(n,r))}),Ce(e,391))}function $ae(e,t){!t||!t["!ref"]||(Ce(e,648),Ce(e,649,Pae(wt(t["!ref"]))),Ce(e,650))}function Uae(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Ot(r,-1,n[1].Target.replace(/#.*$/,""),gt.HLINK);Ce(e,494,Sae(n,a))}}),delete t["!links"]}function zae(e,t,r,n){if(t["!comments"].length>0){var a=Ot(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",gt.VML);Ce(e,551,$b("rId"+a)),t["!legacy"]=a}}function Wae(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:ht(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=Zn(i);l.s.r==l.e.r&&(l.e.r=Zn(t["!ref"]).e.r,i=ht(l));for(var f=0;f<s.length;++f){var d=s[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ce(e,161,Bc(wt(i))),Ce(e,162)}}function Hae(e,t,r){Ce(e,133),Ce(e,137,Tae(t,r)),Ce(e,138),Ce(e,134)}function Vae(e,t){t["!protect"]&&Ce(e,535,Oae(t["!protect"]))}function Gae(e,t,r,n){var a=Jn(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var f=wt(s["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Ce(a,129),(r.vbaraw||s["!outline"])&&Ce(a,147,Bne(l,s["!outline"])),Ce(a,148,Mne(f)),Hae(a,s,r.Workbook),Bae(a,s),Rae(a,s,e,t),Vae(a,s),Wae(a,s,r,e),Lae(a,s),Uae(a,s,n),s["!margins"]&&Ce(a,476,Cae(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&$ae(a,s),zae(a,s,e,n),Ce(a,130),a.end()}function Kae(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=yt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function qae(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var l=0,f=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var x=Kae(m);h.s.r=h.s.c=0,h.e.c=l,d=sr(l),x[0].forEach(function(g,y){s[d+vr(y)]={t:"n",v:g,z:x[1]},f=y}),h.e.r<f&&(h.e.r=f),++l}),l>0&&(s["!ref"]=ht(h)),s}function Xae(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,l=e.match(JO);return l&&ew(l[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Yae(e,t){e.l+=10;var r=_n(e);return{name:r}}function Jae(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return fs(e,function(f,d,h){switch(h){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var tw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Qae=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Zae=[],eie=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Zj(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Kt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function e4(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Kt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function t6(e){e4(e.WBProps,tw),e4(e.CalcPr,eie),Zj(e.WBView,Qae),Zj(e.Sheets,Zae),lc.date1904=Kt(e.WBProps.date1904)}function tie(e){return!e.Workbook||!e.Workbook.WBProps?"false":Kt(e.Workbook.WBProps.date1904)?"true":"false"}var rie="][*?/\\".split("");function r6(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return rie.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function nie(e,t,r){e.forEach(function(n,a){r6(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function aie(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];nie(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)tne(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var iie=/<\w+:workbook/;function sie(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(jn,function(f,d){var h=ct(f);switch(_i(h[0])){case"<?xml":break;case"<workbook":f.match(iie)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":tw.forEach(function(m){if(h[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=Kt(h[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(h[m[0]],10);break;default:r.WBProps[m[0]]=h[m[0]]}}),h.codeName&&(r.WBProps.CodeName=Rt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=yt(Rt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Rt(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Kt(h.hidden||"0")&&(i.Hidden=!0),s=d+f.length;break;case"</definedName>":i.Ref=yt(Rt(e.slice(s,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return f}),hl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return t6(r),r}function n6(e){var t=[br];t[t.length]=Be("workbook",null,{xmlns:hl[0],"xmlns:r":Fr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(tw.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Be("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:It(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Be("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var f={name:l.Name};l.Comment&&(f.comment=l.Comment),l.Sheet!=null&&(f.localSheetId=""+l.Sheet),l.Hidden&&(f.hidden="1"),l.Ref&&(t[t.length]=Be("definedName",It(l.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function oie(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=c1(e),r.name=_n(e),r}function lie(e,t){return t||(t=Ee(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),$b(e.strRelID,t),Xr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function cie(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?_n(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function uie(e,t){t||(t=Ee(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),qP(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function fie(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function die(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=zY(e),s=Xre(e,0,r),l=Bb(e);e.l=n;var f={Name:i,Ptg:s};return a<268435455&&(f.Sheet=a),l&&(f.Comment=l),f}function hie(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Nf[16]={n:"BrtFRTArchID$",f:fie},fs(e,function(f,d,h){switch(h){case 156:s.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(t.SID=f.Sheet),f.Ref=bn(f.Ptg,null,null,s,t),delete t.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([h,f]):s[0]=[h,f],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(f),s.XTI=s.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),t6(r),r.Names=i,r.supbooks=s,r}function mie(e,t){Ce(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ce(e,156,lie(a))}Ce(e,144)}function pie(e,t){t||(t=Ee(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Xr("SheetJS",t),Xr(jh.version,t),Xr(jh.version,t),Xr("7262",t),t.length>t.l?t.slice(0,t.l):t}function xie(e,t){t||(t=Ee(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function gie(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Ce(e,135),Ce(e,158,xie(a)),Ce(e,136))}}function vie(e,t){var r=Jn();return Ce(r,131),Ce(r,128,pie()),Ce(r,153,uie(e.Workbook&&e.Workbook.WBProps||null)),gie(r,e),mie(r,e),Ce(r,132),r.end()}function yie(e,t,r){return t.slice(-4)===".bin"?hie(e,r):sie(e,r)}function bie(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?Iae(e,n,r,a,i,s,l):dne(e,n,r,a,i,s,l)}function wie(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?Jae(e,n,r,a,i):Xae(e,n,r,a,i)}function Sie(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?Ete():_te()}function Nie(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?Ste():Nte()}function Eie(e,t,r,n){return t.slice(-4)===".bin"?yee(e,r,n):oee(e,r,n)}function _ie(e,t,r){return RO(e,r)}function kie(e,t,r){return t.slice(-4)===".bin"?kZ(e,r):NZ(e,r)}function jie(e,t,r){return t.slice(-4)===".bin"?gte(e,r):lte(e,r)}function Cie(e,t,r){return t.slice(-4)===".bin"?ite(e):nte(e)}function Aie(e,t,r,n){return r.slice(-4)===".bin"?ste(e,t,r,n):void 0}function Tie(e,t,r){return t.slice(-4)===".bin"?ete(e,t,r):rte(e,t,r)}function Pie(e,t,r){return(t.slice(-4)===".bin"?vie:n6)(e)}function Oie(e,t,r,n,a){return(t.slice(-4)===".bin"?Gae:QO)(e,r,n,a)}function Fie(e,t,r){return(t.slice(-4)===".bin"?Aee:IO)(e,r)}function Die(e,t,r){return(t.slice(-4)===".bin"?AZ:jO)(e,r)}function Iie(e,t,r){return(t.slice(-4)===".bin"?vte:$O)(e)}function Mie(e){return(e.slice(-4)===".bin"?tte:LO)()}var a6=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,i6=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ya(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(a6),i,s,l,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(i6),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),n[l]=i[2].slice(1,i[2].length-1));return n}function Rie(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(a6),a,i,s,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(i6),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Yu;function Lie(e,t){var r=Yu[e]||yt(e);return r==="General"?Zo(t):Ba(r,t)}function Bie(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Kt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=qt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[yt(t)]=a}function $ie(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ds[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=mf(e.v):e.w=Zo(e.v):e.w=Lie(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Yu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Mc(n)){var a=Io(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function Uie(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=ZZ[n.Pattern]||n.Pattern)}e[t.ID]=t}function zie(e,t,r,n,a,i,s,l,f,d){var h="General",m=n.StyleID,x={};d=d||{};var g=[],y=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&s&&(m=s.StyleID);i[m]!==void 0&&(i[m].nf&&(h=i[m].nf),i[m].Interior&&g.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Kt(e);break;case"String":n.t="s",n.r=gj(yt(e)),n.v=e.indexOf("<")>-1?yt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(qt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=yt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=ZP[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=gj(t||e));break}if($ie(n,h,d),d.cellFormula!==!1)if(n.Formula){var v=yt(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=oc(v,a),delete n.Formula,n.ArrayRange=="RC"?n.F=oc("RC:RC",a):n.ArrayRange&&(n.F=oc(n.ArrayRange,a),f.push([wt(n.F),n.F]))}else for(y=0;y<f.length;++y)a.r>=f[y][0].s.r&&a.r<=f[y][0].e.r&&a.c>=f[y][0].s.c&&a.c<=f[y][0].e.c&&(n.F=f[y][1]);d.cellStyles&&(g.forEach(function(b){!x.patternType&&b.patternType&&(x.patternType=b.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Wie(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ov(e,t){var r=t||{};Rc();var n=Mu(Fb(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Rt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Xt(r);return s.type="string",Ec.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(lt){a.indexOf("<"+lt)>=0&&(i=!0)}),i)return Cse(n,r);Yu={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,f=[],d,h={},m=[],x=r.dense?[]:{},g="",y={},v={},b=Ya('<Data ss:Type="String">'),E=0,N=0,S=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},C={},P="",M=0,D=[],W={},F={},L=0,J=[],se=[],Z={},he=[],le,de=!1,Q=[],pe=[],re={},O=0,V=0,H={Sheets:[],WBProps:{date1904:!1}},q={};gf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";l=gf.exec(n);)switch(l[3]=(K=l[3]).toLowerCase()){case"data":if(K=="data"){if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&f.push([l[3],!0]);break}if(f[f.length-1][1])break;l[1]==="/"?zie(n.slice(E,l.index),P,b,f[f.length-1][0]=="comment"?Z:y,{c:N,r:S},T,he[N],v,Q,r):(P="",b=Ya(l[0]),E=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(se.length>0&&(y.c=se),(!r.sheetRows||r.sheetRows>S)&&y.v!==void 0&&(r.dense?(x[S]||(x[S]=[]),x[S][N]=y):x[sr(N)+vr(S)]=y),y.HRef&&(y.l={Target:yt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(O=N+(parseInt(y.MergeAcross,10)|0),V=S+(parseInt(y.MergeDown,10)|0),D.push({s:{c:N,r:S},e:{c:O,r:V}})),!r.sheetStubs)y.MergeAcross?N=O+1:++N;else if(y.MergeAcross||y.MergeDown){for(var ie=N;ie<=O;++ie)for(var B=S;B<=V;++B)(ie>N||B>S)&&(r.dense?(x[B]||(x[B]=[]),x[B][ie]={t:"z"}):x[sr(ie)+vr(B)]={t:"z"});N=O+1}else++N;else y=Rie(l[0]),y.Index&&(N=+y.Index-1),N<j.s.c&&(j.s.c=N),N>j.e.c&&(j.e.c=N),l[0].slice(-2)==="/>"&&++N,se=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(S<j.s.r&&(j.s.r=S),S>j.e.r&&(j.e.r=S),l[0].slice(-2)==="/>"&&(v=Ya(l[0]),v.Index&&(S=+v.Index-1)),N=0,++S):(v=Ya(l[0]),v.Index&&(S=+v.Index-1),re={},(v.AutoFitHeight=="0"||v.Height)&&(re.hpx=parseInt(v.Height,10),re.hpt=Sf(re.hpx),pe[S]=re),v.Hidden=="1"&&(re.hidden=!0,pe[S]=re));break;case"worksheet":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));m.push(g),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(x["!ref"]=ht(j),r.sheetRows&&r.sheetRows<=j.e.r&&(x["!fullref"]=x["!ref"],j.e.r=r.sheetRows-1,x["!ref"]=ht(j))),D.length&&(x["!merges"]=D),he.length>0&&(x["!cols"]=he),pe.length>0&&(x["!rows"]=pe),h[g]=x}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=N=0,f.push([l[3],!1]),d=Ya(l[0]),g=yt(d.Name),x=r.dense?[]:{},D=[],Q=[],pe=[],q={name:g,Hidden:0},H.Sheets.push(q);break;case"table":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;f.push([l[3],!1]),he=[],de=!1}break;case"style":l[1]==="/"?Uie(T,C,r):C=Ya(l[0]);break;case"numberformat":C.nf=yt(Ya(l[0]).Format||"General"),Yu[C.nf]&&(C.nf=Yu[C.nf]);for(var z=0;z!=392&&it[z]!=C.nf;++z);if(z==392){for(z=57;z!=392;++z)if(it[z]==null){qi(C.nf,z);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(le=Ya(l[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!de&&le.wpx>10){de=!0,Sn=FO;for(var G=0;G<he.length;++G)he[G]&&Ys(he[G])}de&&Ys(le),he[le.Index-1||he.length]=le;for(var ce=0;ce<+le.Span;++ce)he[he.length]=Xt(le);break;case"namedrange":if(l[1]==="/")break;H.Names||(H.Names=[]);var I=ct(l[0]),Ae={Name:I.Name,Ref:oc(I.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(Ae.Sheet=H.Sheets.length-1),H.Names.push(Ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?P+=n.slice(M,l.index):M=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;C.Interior=Ya(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?hJ(W,K,n.slice(L,l.index)):L=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else f.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));Wie(Z),se.push(Z)}else f.push([l[3],!1]),d=Ya(l[0]),Z={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var je=Ya(l[0]);x["!autofilter"]={ref:oc(je.Range).replace(/\$/g,"")},f.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&f.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&f.push([l[3],!0]);break;case"null":break;default:if(f.length==0&&l[3]=="document"||f.length==0&&l[3]=="uof")return i4(n,r);var Le=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Le=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Le=!1}break;case"excelworkbook":switch(l[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Le=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Le=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(L,l.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else L=l.index+l[0].length;break;case"header":x["!margins"]||Wo(x["!margins"]={},"xlml"),isNaN(+ct(l[0]).Margin)||(x["!margins"].header=+ct(l[0]).Margin);break;case"footer":x["!margins"]||Wo(x["!margins"]={},"xlml"),isNaN(+ct(l[0]).Margin)||(x["!margins"].footer=+ct(l[0]).Margin);break;case"pagemargins":var Ue=ct(l[0]);x["!margins"]||Wo(x["!margins"]={},"xlml"),isNaN(+Ue.Top)||(x["!margins"].top=+Ue.Top),isNaN(+Ue.Left)||(x["!margins"].left=+Ue.Left),isNaN(+Ue.Right)||(x["!margins"].right=+Ue.Right),isNaN(+Ue.Bottom)||(x["!margins"].bottom=+Ue.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Le=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Le=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Le=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Le=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Le=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Le=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Le=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Le=!1}break;case"smarttags":break;default:Le=!1;break}if(Le||l[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Bie(F,K,J,n.slice(L,l.index)):(J=l,L=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+f.join("|")}var Pe={};return!r.bookSheets&&!r.bookProps&&(Pe.Sheets=h),Pe.SheetNames=m,Pe.Workbook=H,Pe.SSF=Xt(it),Pe.Props=W,Pe.Custprops=F,Pe}function x1(e,t){switch(nw(t=t||{}),t.type||"base64"){case"base64":return ov(xa(e),t);case"binary":case"buffer":case"file":return ov(e,t);case"array":return ov(io(e),t)}}function Hie(e,t){var r=[];return e.Props&&r.push(mJ(e.Props,t)),e.Custprops&&r.push(pJ(e.Props,e.Custprops)),r.join("")}function Vie(){return""}function Gie(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Be("NumberFormat",null,{"ss:Format":It(it[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Be("Style",i.join(""),s))}),Be("Styles",r.join(""))}function s6(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Jb(e.Ref,{r:0,c:0})})}function Kie(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(s6(a)))}return Be("Names",r.join(""))}function qie(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var l=a[s];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(s6(l)))}return i.join("")}function Xie(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(fn("ProtectContents","True")),e["!protect"].objects&&a.push(fn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(fn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(fn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(fn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Be("WorksheetOptions",a.join(""),{xmlns:oa.x})}function Yie(e){return e.map(function(t){var r=gY(t.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":t.a})}).join("")}function Jie(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+It(Jb(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var f=or(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(f.r==s.r?"":"["+(f.r-s.r)+"]")+"C"+(f.c==s.c?"":"["+(f.c-s.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=It(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=It(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],h=0;h!=d.length;++h)d[h].s.c!=s.c||d[h].s.r!=s.r||(d[h].e.c>d[h].s.c&&(l["ss:MergeAcross"]=d[h].e.c-d[h].s.c),d[h].e.r>d[h].s.r&&(l["ss:MergeDown"]=d[h].e.r-d[h].s.r));var m="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",x=String(e.v);break;case"b":m="Boolean",x=e.v?"1":"0";break;case"e":m="Error",x=ds[e.v];break;case"d":m="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||it[14]);break;case"s":m="String",x=xY(e.v||"");break}var g=oo(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+g),l["ss:Index"]=s.c+1;var y=e.v!=null?x:"",v=e.t=="z"?"":'<Data ss:Type="'+m+'">'+y+"</Data>";return(e.c||[]).length>0&&(v+=Yie(e.c)),Be("Cell",v,l)}function Qie(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=_c(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Zie(e,t,r,n){if(!e["!ref"])return"";var a=wt(e["!ref"]),i=e["!merges"]||[],s=0,l=[];e["!cols"]&&e["!cols"].forEach(function(b,E){Ys(b);var N=!!b.width,S=Fm(E,b),j={"ss:Index":E+1};N&&(j["ss:Width"]=bf(S.width)),b.hidden&&(j["ss:Hidden"]="1"),l.push(Be("Column",null,j))});for(var f=Array.isArray(e),d=a.s.r;d<=a.e.r;++d){for(var h=[Qie(d,(e["!rows"]||[])[d])],m=a.s.c;m<=a.e.c;++m){var x=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>m)&&!(i[s].s.r>d)&&!(i[s].e.c<m)&&!(i[s].e.r<d)){(i[s].s.c!=m||i[s].s.r!=d)&&(x=!0);break}if(!x){var g={r:d,c:m},y=ot(g),v=f?(e[d]||[])[m]:e[y];h.push(Jie(v,y,e,t,r,n,g))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function ese(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?qie(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Zie(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Xie(i,t,e,r)),n.join("")}function tse(e,t){t||(t={}),e.SSF||(e.SSF=Xt(it)),e.SSF&&(Rc(),km(e.SSF),t.revssf=Cm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],oo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Hie(e,t)),r.push(Vie()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Be("Worksheet",ese(n,t,e),{"ss:Name":It(e.SheetNames[n])}));return r[2]=Gie(e,t),r[3]=Kie(e),br+Be("Workbook",r.join(""),{xmlns:oa.ss,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:ss":oa.ss,"xmlns:dt":oa.dt,"xmlns:html":oa.html})}function rse(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=KY(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=qY(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var nse=[60,1084,2066,2165,2175];function ase(e,t,r,n,a){var i=n,s=[],l=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}s.push(l),r.l+=i;for(var f=Hi(r,r.l),d=g1[f],h=0;d!=null&&nse.indexOf(f)>-1;)i=Hi(r,r.l+2),h=r.l+4,f==2066?h+=4:(f==2165||f==2175)&&(h+=12),l=r.slice(h,r.l+4+i),s.push(l),r.l+=4+i,d=g1[f=Hi(r,r.l)];var m=Kr(s);cn(m,0);var x=0;m.lens=[];for(var g=0;g<s.length;++g)m.lens.push(x),x+=s[g].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,a)}function fi(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=it[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ds[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=mf(e.v):e.w=Zo(e.v):e.w=Ba(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Mc(it[n]||String(n))){var a=Io(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function T0(e,t,r){return{v:e,ixfe:t,t:r}}function ise(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},l=null,f=[],d="",h={},m,x="",g,y,v,b,E={},N=[],S,j,T=[],C=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},D=function(ut){return ut<8?$o[ut]:ut<64&&C[ut-8]||$o[ut]},W=function(ut,Ct,oe){var ke=Ct.XF.data;if(!(!ke||!ke.patternType||!oe||!oe.cellStyles)){Ct.s={},Ct.s.patternType=ke.patternType;var Ge;(Ge=yf(D(ke.icvFore)))&&(Ct.s.fgColor={rgb:Ge}),(Ge=yf(D(ke.icvBack)))&&(Ct.s.bgColor={rgb:Ge})}},F=function(ut,Ct,oe){if(!(re>1)&&!(oe.sheetRows&&ut.r>=oe.sheetRows)){if(oe.cellStyles&&Ct.XF&&Ct.XF.data&&W(ut,Ct,oe),delete Ct.ixfe,delete Ct.XF,m=ut,x=ot(ut),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<s.s.r&&(s.s.r=ut.r),ut.c<s.s.c&&(s.s.c=ut.c),ut.r+1>s.e.r&&(s.e.r=ut.r+1),ut.c+1>s.e.c&&(s.e.c=ut.c+1),oe.cellFormula&&Ct.f){for(var ke=0;ke<N.length;++ke)if(!(N[ke][0].s.c>ut.c||N[ke][0].s.r>ut.r)&&!(N[ke][0].e.c<ut.c||N[ke][0].e.r<ut.r)){Ct.F=ht(N[ke][0]),(N[ke][0].s.c!=ut.c||N[ke][0].s.r!=ut.r)&&delete Ct.f,Ct.f&&(Ct.f=""+bn(N[ke][1],s,ut,Q,L));break}}oe.dense?(a[ut.r]||(a[ut.r]=[]),a[ut.r][ut.c]=Ct):a[x]=Ct}},L={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var J,se=[],Z=[],he=[],le=[],de=!1,Q=[];Q.SheetNames=L.snames,Q.sharedf=L.sharedf,Q.arrayf=L.arrayf,Q.names=[],Q.XTI=[];var pe=0,re=0,O=0,V=[],H=[],q;L.codepage=1200,ei(1200);for(var K=!1;e.l<e.length-1;){var ie=e.l,B=e.read_shift(2);if(B===0&&pe===10)break;var z=e.l===e.length?0:e.read_shift(2),G=g1[B];if(G&&G.f){if(t.bookSheets&&pe===133&&B!==133)break;if(pe=B,G.r===2||G.r==12){var ce=e.read_shift(2);if(z-=2,!L.enc&&ce!==B&&((ce&255)<<8|ce>>8)!==B)throw new Error("rt mismatch: "+ce+"!="+B);G.r==12&&(e.l+=10,z-=10)}var I={};if(B===10?I=G.f(e,z,L):I=ase(B,G,e,z,L),re==0&&[9,521,1033,2057].indexOf(pe)===-1)continue;switch(B){case 34:r.opts.Date1904=P.WBProps.date1904=I;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=I,!t.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=I;break;case 66:var Ae=Number(I);switch(Ae){case 21010:Ae=1200;break;case 32768:Ae=1e4;break;case 32769:Ae=1252;break}ei(L.codepage=Ae),K=!0;break;case 317:L.rrtabid=I;break;case 25:L.winlocked=I;break;case 439:r.opts.RefreshAll=I;break;case 12:r.opts.CalcCount=I;break;case 16:r.opts.CalcDelta=I;break;case 17:r.opts.CalcIter=I;break;case 13:r.opts.CalcMode=I;break;case 14:r.opts.CalcPrecision=I;break;case 95:r.opts.CalcSaveRecalc=I;break;case 15:L.CalcRefMode=I;break;case 2211:r.opts.FullCalc=I;break;case 129:I.fDialog&&(a["!type"]="dialog"),I.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),I.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:T.push(I);break;case 430:Q.push([I]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(I);break;case 24:case 536:q={Name:I.Name,Ref:bn(I.rgce,s,null,Q,L)},I.itab>0&&(q.Sheet=I.itab-1),Q.names.push(q),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(H[I.itab-1]={ref:ht(I.rgce[0][0][1][2])});break;case 22:L.ExternCount=I;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(I),Q.XTI=Q.XTI.concat(I);break;case 2196:if(L.biff<8)break;q!=null&&(q.Comment=I[1]);break;case 18:a["!protect"]=I;break;case 19:I!==0&&L.WTF&&console.error("Password verifier: "+I);break;case 133:i[I.pos]=I,L.snames.push(I.name);break;case 10:{if(--re)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=ht(s),t.sheetRows&&t.sheetRows<=s.e.r){var je=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=ht(s),s.e.r=je}s.e.r++,s.e.c++}se.length>0&&(a["!merges"]=se),Z.length>0&&(a["!objects"]=Z),he.length>0&&(a["!cols"]=he),le.length>0&&(a["!rows"]=le),P.Sheets.push(M)}d===""?h=a:n[d]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[B]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),L.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(L.biff=5,K=!0,ei(L.codepage=28591)),L.biff==8&&I.BIFFVer==0&&I.dt==16&&(L.biff=2),re++)break;if(a=t.dense?[]:{},L.biff<8&&!K&&(K=!0,ei(L.codepage=t.codepage||1252)),L.biff<5||I.BIFFVer==0&&I.dt==4096){d===""&&(d="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Le={pos:e.l-z,name:d};i[Le.pos]=Le,L.snames.push(d)}else d=(i[ie]||{name:""}).name;I.dt==32&&(a["!type"]="chart"),I.dt==64&&(a["!type"]="macro"),se=[],Z=[],L.arrayf=N=[],he=[],le=[],de=!1,M={Hidden:(i[ie]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[I.r]||[])[I.c]:a[ot({c:I.c,r:I.r})])&&++I.c,S={ixfe:I.ixfe,XF:T[I.ixfe]||{},v:I.val,t:"n"},O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F({c:I.c,r:I.r},S,t);break;case 5:case 517:S={ixfe:I.ixfe,XF:T[I.ixfe],v:I.val,t:I.t},O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F({c:I.c,r:I.r},S,t);break;case 638:S={ixfe:I.ixfe,XF:T[I.ixfe],v:I.rknum,t:"n"},O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F({c:I.c,r:I.r},S,t);break;case 189:for(var Ue=I.c;Ue<=I.C;++Ue){var Pe=I.rkrec[Ue-I.c][0];S={ixfe:Pe,XF:T[Pe],v:I.rkrec[Ue-I.c][1],t:"n"},O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F({c:Ue,r:I.r},S,t)}break;case 6:case 518:case 1030:{if(I.val=="String"){l=I;break}if(S=T0(I.val,I.cell.ixfe,I.tt),S.XF=T[S.ixfe],t.cellFormula){var lt=I.formula;if(lt&&lt[0]&&lt[0][0]&&lt[0][0][0]=="PtgExp"){var kt=lt[0][0][1][0],Yt=lt[0][0][1][1],jt=ot({r:kt,c:Yt});E[jt]?S.f=""+bn(I.formula,s,I.cell,Q,L):S.F=((t.dense?(a[kt]||[])[Yt]:a[jt])||{}).F}else S.f=""+bn(I.formula,s,I.cell,Q,L)}O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F(I.cell,S,t),l=I}break;case 7:case 519:if(l)l.val=I,S=T0(I,l.cell.ixfe,"s"),S.XF=T[S.ixfe],t.cellFormula&&(S.f=""+bn(l.formula,s,l.cell,Q,L)),O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F(l.cell,S,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(I);var Wa=ot(I[0].s);if(g=t.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[Wa],t.cellFormula&&g){if(!l||!Wa||!g)break;g.f=""+bn(I[1],s,I[0],Q,L),g.F=ht(I[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!l)break;E[ot(l.cell)]=I[0],g=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[ot(l.cell)],(g||{}).f=""+bn(I[0],s,m,Q,L)}}break;case 253:S=T0(f[I.isst].t,I.ixfe,"s"),f[I.isst].h&&(S.h=f[I.isst].h),S.XF=T[S.ixfe],O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F({c:I.c,r:I.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:I.ixfe,XF:T[I.ixfe],t:"z"},O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F({c:I.c,r:I.r},S,t));break;case 190:if(t.sheetStubs)for(var Ln=I.c;Ln<=I.C;++Ln){var Br=I.ixfe[Ln-I.c];S={ixfe:Br,XF:T[Br],t:"z"},O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F({c:Ln,r:I.r},S,t)}break;case 214:case 516:case 4:S=T0(I.val,I.ixfe,"s"),S.XF=T[S.ixfe],O>0&&(S.z=V[S.ixfe>>8&63]),fi(S,t,r.opts.Date1904),F({c:I.c,r:I.r},S,t);break;case 0:case 512:re===1&&(s=I);break;case 252:f=I;break;case 1054:if(L.biff==4){V[O++]=I[1];for(var tr=0;tr<O+163&&it[tr]!=I[1];++tr);tr>=163&&qi(I[1],O+163)}else qi(I[1],I[0]);break;case 30:{V[O++]=I;for(var Bn=0;Bn<O+163&&it[Bn]!=I;++Bn);Bn>=163&&qi(I,O+163)}break;case 229:se=se.concat(I);break;case 93:Z[I.cmo[0]]=L.lastobj=I;break;case 438:L.lastobj.TxO=I;break;case 127:L.lastobj.ImData=I;break;case 440:for(b=I[0].s.r;b<=I[0].e.r;++b)for(v=I[0].s.c;v<=I[0].e.c;++v)g=t.dense?(a[b]||[])[v]:a[ot({c:v,r:b})],g&&(g.l=I[1]);break;case 2048:for(b=I[0].s.r;b<=I[0].e.r;++b)for(v=I[0].s.c;v<=I[0].e.c;++v)g=t.dense?(a[b]||[])[v]:a[ot({c:v,r:b})],g&&g.l&&(g.l.Tooltip=I[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;g=t.dense?(a[I[0].r]||[])[I[0].c]:a[ot(I[0])];var en=Z[I[2]];g||(t.dense?(a[I[0].r]||(a[I[0].r]=[]),g=a[I[0].r][I[0].c]={t:"z"}):g=a[ot(I[0])]={t:"z"},s.e.r=Math.max(s.e.r,I[0].r),s.s.r=Math.min(s.s.r,I[0].r),s.e.c=Math.max(s.e.c,I[0].c),s.s.c=Math.min(s.s.c,I[0].c)),g.c||(g.c=[]),y={a:I[1],t:en.TxO.t},g.c.push(y)}break;case 2173:Gee(T[I.ixfe],I.ext);break;case 125:{if(!L.cellStyles)break;for(;I.e>=I.s;)he[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},de||(de=!0,qb(I.w/256)),Ys(he[I.e+1])}break;case 520:{var rr={};I.level!=null&&(le[I.r]=rr,rr.level=I.level),I.hidden&&(le[I.r]=rr,rr.hidden=!0),I.hpt&&(le[I.r]=rr,rr.hpt=I.hpt,rr.hpx=_c(I.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Wo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[B]]=I;break;case 161:a["!margins"]||Wo(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case 574:I.RTL&&(P.Views[0].RTL=!0);break;case 146:C=I;break;case 2198:J=I;break;case 140:j=I;break;case 442:d?M.CodeName=I||M.name:P.WBProps.CodeName=I||"ThisWorkbook";break}}else G||console.error("Missing Info for XLS Record 0x"+B.toString(16)),e.l+=z}return r.SheetNames=dr(i).sort(function(Cn,ut){return Number(Cn)-Number(ut)}).map(function(Cn){return i[Cn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&H.forEach(function(Cn,ut){r.Sheets[r.SheetNames[ut]]["!autofilter"]=Cn}),r.Strings=f,r.SSF=Xt(it),L.enc&&(r.Encryption=L.enc),J&&(r.Themes=J),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),Q.names.length>0&&(P.Names=Q.names),r.Workbook=P,r}var Ju={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function sse(e,t,r){var n=tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Ij(n,u1,Ju.DSI);for(var i in a)t[i]=a[i]}catch(d){if(r.WTF)throw d}var s=tt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var l=Ij(s,f1,Ju.SI);for(var f in l)t[f]==null&&(t[f]=l[f])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(iO(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function ose(e,t){var r=[],n=[],a=[],i=0,s,l=fj(u1,"n"),f=fj(f1,"n");if(e.Props)for(s=dr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(f,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=dr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(f,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var d=[];for(i=0;i<a.length;++i)dO.indexOf(a[i][0])>-1||aO.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&tt.utils.cfb_add(t,"/SummaryInformation",Mj(n,Ju.SI,f,f1)),(r.length||d.length)&&tt.utils.cfb_add(t,"/DocumentSummaryInformation",Mj(r,Ju.DSI,l,u1,d.length?d:null,Ju.UDI))}function o6(e,t){t||(t={}),nw(t),Eb(),t.codepage&&Nb(t.codepage);var r,n;if(e.FullPaths){if(tt.find(e,"/encryption"))throw new Error("File is password-protected");r=tt.find(e,"!CompObj"),n=tt.find(e,"/Workbook")||tt.find(e,"/Book")}else{switch(t.type){case"base64":e=ua(xa(e));break;case"binary":e=ua(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}cn(e,0),n={content:e}}var a,i;if(r&&rse(r),t.bookProps&&!t.bookSheets)a={};else{var s=pt?"buffer":"array";if(n&&n.content)a=ise(n.content,t);else if((i=tt.find(e,"PerfectOffice_MAIN"))&&i.content)a=zo.to_workbook(i.content,(t.type=s,t));else if((i=tt.find(e,"NativeContent_MAIN"))&&i.content)a=zo.to_workbook(i.content,(t.type=s,t));else throw(i=tt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=bte(e))}var l={};return e.FullPaths&&sse(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}function lse(e,t){var r=t||{},n=tt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,a,l6(e,r)),r.biff==8&&(e.Props||e.Custprops)&&ose(e,n),r.biff==8&&e.vbaraw&&wte(n,tt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Nf={0:{f:One},1:{f:$ne},2:{f:iae},3:{f:qne},4:{f:Hne},5:{f:rae},6:{f:uae},7:{f:Qne},8:{f:gae},9:{f:xae},10:{f:mae},11:{f:pae},12:{f:zne},13:{f:oae},14:{f:Yne},15:{f:Gne},16:{f:ZO},17:{f:dae},18:{f:eae},19:{f:Lb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:die},40:{},42:{},43:{f:uee},44:{f:lee},45:{f:hee},46:{f:pee},47:{f:mee},48:{},49:{f:IY},50:{},51:{f:Xee},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:NO},62:{f:cae},63:{f:ate},64:{f:Fae},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:kn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Aae},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Lne},148:{f:Ine,p:16},151:{f:Nae},152:{},153:{f:cie},154:{},155:{},156:{f:oie},157:{},158:{},159:{T:1,f:_Z},160:{T:-1},161:{T:1,f:gl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vae},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Kee},336:{T:-1},337:{f:Qee,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:c1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:SO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Eae},427:{f:_ae},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:jae},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Rne},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wae},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:c1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:pte},633:{T:1},634:{T:-1},635:{T:1,f:hte},636:{T:-1},637:{f:BY},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Yae},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Dae},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},g1={6:{f:iv},10:{f:Ds},12:{f:Er},13:{f:Er},14:{f:xr},15:{f:xr},16:{f:Nn},17:{f:xr},18:{f:xr},19:{f:Er},20:{f:zj},21:{f:zj},23:{f:SO},24:{f:Hj},25:{f:xr},26:{},27:{},28:{f:DQ},29:{},34:{f:xr},35:{f:Wj},38:{f:Nn},39:{f:Nn},40:{f:Nn},41:{f:Nn},42:{f:xr},43:{f:xr},47:{f:GZ},49:{f:oQ},51:{f:Er},60:{},61:{f:rQ},64:{f:xr},65:{f:sQ},66:{f:Er},77:{},80:{},81:{},82:{},85:{f:Er},89:{},90:{},91:{},92:{f:VJ},93:{f:RQ},94:{},95:{f:xr},96:{},97:{},99:{f:xr},125:{f:NO},128:{f:SQ},129:{f:KJ},130:{f:Er},131:{f:xr},132:{f:xr},133:{f:qJ},134:{},140:{f:VQ},141:{f:Er},144:{},146:{f:qQ},151:{},152:{},153:{},154:{},155:{},156:{f:Er},157:{},158:{},160:{f:tZ},161:{f:JQ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:vQ},190:{f:yQ},193:{f:Ds},197:{},198:{},199:{},200:{},201:{},202:{f:xr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Er},220:{},221:{f:xr},222:{},224:{f:wQ},225:{f:HJ},226:{f:Ds},227:{},229:{f:IQ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:YJ},253:{f:cQ},255:{f:QJ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:hO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:xr},353:{f:Ds},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:jQ},431:{f:xr},432:{},433:{},434:{},437:{},438:{f:$Q},439:{f:xr},440:{f:UQ},441:{},442:{f:qf},443:{},444:{f:Er},445:{},446:{},448:{f:Ds},449:{f:tQ,r:2},450:{f:Ds},512:{f:Bj},513:{f:eZ},515:{f:_Q},516:{f:fQ},517:{f:Uj},519:{f:rZ},520:{f:ZJ},523:{},545:{f:Vj},549:{f:Lj},566:{},574:{f:aQ},638:{f:gQ},659:{},1048:{},1054:{f:hQ},1084:{},1212:{f:PQ},2048:{f:WQ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:j0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ds},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:XQ,r:12},2173:{f:Vee,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:xr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:TQ,r:12},2197:{},2198:{f:Bee,r:12},2199:{},2200:{},2201:{},2202:{f:OQ,r:12},2203:{f:Ds},2204:{},2205:{},2206:{},2207:{},2211:{f:eQ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:QQ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:KQ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Bj},1:{},2:{f:oZ},3:{f:iZ},4:{f:aZ},5:{f:Uj},7:{f:cZ},8:{},9:{f:j0},11:{},22:{f:Er},30:{f:pQ},31:{},32:{},33:{f:Vj},36:{},37:{f:Lj},50:{f:uZ},62:{},52:{},67:{},68:{f:Er},69:{},86:{},126:{},127:{f:nZ},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:fZ},223:{},234:{},354:{},421:{},518:{f:iv},521:{f:j0},536:{f:Hj},547:{f:Wj},561:{},579:{},1030:{f:iv},1033:{f:j0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function $e(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Ib(r)&&e.push(r)}}function cse(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return $e(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],l=0,f=0,d=0;d+(s[l]||8224)<=8224;)d+=s[l]||8224,l++;var h=e.next(4);for(h.write_shift(2,i),h.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d;f<a;){for(h=e.next(4),h.write_shift(2,60),d=0;d+(s[l]||8224)<=8224;)d+=s[l]||8224,l++;h.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d}}}function Qf(e,t,r){return e||(e=Ee(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function use(e,t,r,n){var a=Ee(9);return Qf(a,e,t),mO(r,n||"b",a),a}function fse(e,t,r){var n=Ee(8+2*r.length);return Qf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function dse(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Ir(qt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?$e(e,2,lZ(r,n,a)):$e(e,3,sZ(r,n,a));return;case"b":case"e":$e(e,5,use(r,n,t.v,t.t));return;case"s":case"str":$e(e,4,fse(r,n,(t.v||"").slice(0,255)));return}$e(e,1,Qf(null,r,n))}function hse(e,t,r,n){var a=Array.isArray(t),i=wt(t["!ref"]||"A1"),s,l="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=ht(i)}for(var d=i.s.r;d<=i.e.r;++d){l=vr(d);for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(f[h]=sr(h)),s=f[h]+l;var m=a?(t[d]||[])[h]:t[s];m&&dse(e,m,d,h)}}}function mse(e,t){for(var r=t||{},n=Jn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return $e(n,r.biff==4?1033:r.biff==3?521:9,Vb(e,16,r)),hse(n,e.Sheets[e.SheetNames[a]],a,r),$e(n,10),n.end()}function pse(e,t,r){$e(e,49,lQ({sz:12,name:"Arial"},r))}function xse(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&$e(e,1054,mQ(a,t[a],r))})}function gse(e,t){var r=Ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),$e(e,2151,r),r=Ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),yO(wt(t["!ref"]||"A1"),r),r.write_shift(4,4),$e(e,2152,r)}function vse(e,t){for(var r=0;r<16;++r)$e(e,224,$j({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){$e(e,224,$j(n,0,t))})}function yse(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];$e(e,440,zQ(n)),n[1].Tooltip&&$e(e,2048,HQ(n))}delete t["!links"]}function bse(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&$e(e,125,YQ(Fm(a,n),a))})}}function wse(e,t,r,n,a){var i=16+oo(a.cellXfs,t,a);if(t.v==null&&!t.bf){$e(e,513,nl(r,n,i));return}if(t.bf)$e(e,6,Kre(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Ir(qt(t.v)):t.v;$e(e,515,kQ(r,n,s,i));break;case"b":case"e":$e(e,517,EQ(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var l=Zb(a.Strings,t.v,a.revStrings);$e(e,253,uQ(r,n,l,i))}else $e(e,516,dQ(r,n,(t.v||"").slice(0,255),i,a));break;default:$e(e,513,nl(r,n,i))}}function Sse(e,t,r){var n=Jn(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},l=(s.Sheets||[])[e]||{},f=Array.isArray(i),d=t.biff==8,h,m="",x=[],g=wt(i["!ref"]||"A1"),y=d?65536:16384;if(g.e.c>255||g.e.r>=y){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,y-1)}$e(n,2057,Vb(r,16,t)),$e(n,13,Fa(1)),$e(n,12,Fa(100)),$e(n,15,On(!0)),$e(n,17,On(!1)),$e(n,16,tl(.001)),$e(n,95,On(!0)),$e(n,42,On(!1)),$e(n,43,On(!1)),$e(n,130,Fa(1)),$e(n,128,NQ()),$e(n,131,On(!1)),$e(n,132,On(!1)),d&&bse(n,i["!cols"]),$e(n,512,xQ(g,t)),d&&(i["!links"]=[]);for(var v=g.s.r;v<=g.e.r;++v){m=vr(v);for(var b=g.s.c;b<=g.e.c;++b){v===g.s.r&&(x[b]=sr(b)),h=x[b]+m;var E=f?(i[v]||[])[b]:i[h];E&&(wse(n,E,v,b,t),d&&E.l&&i["!links"].push([h,E.l]))}}var N=l.CodeName||l.name||a;return d&&$e(n,574,iQ((s.Views||[])[0])),d&&(i["!merges"]||[]).length&&$e(n,229,MQ(i["!merges"])),d&&yse(n,i),$e(n,442,pO(N)),d&&gse(n,i),$e(n,10),n.end()}function Nse(e,t,r){var n=Jn(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},l=r.biff==8,f=r.biff==5;if($e(n,2057,Vb(e,5,r)),r.bookType=="xla"&&$e(n,135),$e(n,225,l?Fa(1200):null),$e(n,193,EJ(2)),f&&$e(n,191),f&&$e(n,192),$e(n,226),$e(n,92,GJ("SheetJS",r)),$e(n,66,Fa(l?1200:1252)),l&&$e(n,353,Fa(0)),l&&$e(n,448),$e(n,317,ZQ(e.SheetNames.length)),l&&e.vbaraw&&$e(n,211),l&&e.vbaraw){var d=s.CodeName||"ThisWorkbook";$e(n,442,pO(d))}$e(n,156,Fa(17)),$e(n,25,On(!1)),$e(n,18,On(!1)),$e(n,19,Fa(0)),l&&$e(n,431,On(!1)),l&&$e(n,444,Fa(0)),$e(n,61,nQ()),$e(n,64,On(!1)),$e(n,141,Fa(0)),$e(n,34,On(tie(e)=="true")),$e(n,14,On(!0)),l&&$e(n,439,On(!1)),$e(n,218,Fa(0)),pse(n,e,r),xse(n,e.SSF,r),vse(n,r),l&&$e(n,352,On(!1));var h=n.end(),m=Jn();l&&$e(m,140,GQ()),l&&r.Strings&&cse(m,252,JJ(r.Strings)),$e(m,10);var x=m.end(),g=Jn(),y=0,v=0;for(v=0;v<e.SheetNames.length;++v)y+=(l?12:11)+(l?2:1)*e.SheetNames[v].length;var b=h.length+y+x.length;for(v=0;v<e.SheetNames.length;++v){var E=i[v]||{};$e(g,133,XJ({pos:b,hs:E.Hidden||0,dt:0,name:e.SheetNames[v]},r)),b+=t[v].length}var N=g.end();if(y!=N.length)throw new Error("BS8 "+y+" != "+N.length);var S=[];return h.length&&S.push(h),N.length&&S.push(N),x.length&&S.push(x),Kr(S)}function Ese(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Xt(it)),e&&e.SSF&&(Rc(),km(e.SSF),r.revssf=Cm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,aw(r),r.cellXfs=[],oo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Sse(a,r,e);return n.unshift(Nse(e,n,r)),Kr(n)}function l6(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Zn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return Ese(e,t);case 4:case 3:case 2:return mse(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function t4(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,l=i&&i.index||e.length,f=lY(e.slice(s,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,m=0,x=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(s=0;s<f.length;++s){var v=f[s].trim(),b=v.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}h=0;continue}if(!(b!="<td"&&b!="<th")){var E=v.split(/<\/t[dh]>/i);for(l=0;l<E.length;++l){var N=E[l].trim();if(N.match(/<t[dh]/i)){for(var S=N,j=0;S.charAt(0)=="<"&&(j=S.indexOf(">"))>-1;)S=S.slice(j+1);for(var T=0;T<y.length;++T){var C=y[T];C.s.c==h&&C.s.r<d&&d<=C.e.r&&(h=C.e.c+1,T=-1)}var P=ct(N.slice(0,N.indexOf(">")));x=P.colspan?+P.colspan:1,((m=+P.rowspan)>1||x>1)&&y.push({s:{r:d,c:h},e:{r:d+(m||1)-1,c:h+x-1}});var M=P.t||P["data-t"]||"";if(!S.length){h+=x;continue}if(S=OP(S),g.s.r>d&&(g.s.r=d),g.e.r<d&&(g.e.r=d),g.s.c>h&&(g.s.c=h),g.e.c<h&&(g.e.c=h),!S.length){h+=x;continue}var D={t:"s",v:S};r.raw||!S.trim().length||M=="s"||(S==="TRUE"?D={t:"b",v:!0}:S==="FALSE"?D={t:"b",v:!1}:isNaN(ri(S))?isNaN(Nc(S).getDate())||(D={t:"d",v:qt(S)},r.cellDates||(D={t:"n",v:Ir(D.v)}),D.z=r.dateNF||it[14]):D={t:"n",v:ri(S)}),r.dense?(n[d]||(n[d]=[]),n[d][h]=D):n[ot({r:d,c:h})]=D,h+=x}}}}return n["!ref"]=ht(g),y.length&&(n["!merges"]=y),n}function _se(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var l=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>s)&&!(a[d].e.r<r||a[d].e.c<s)){if(a[d].s.r<r||a[d].s.c<s){l=-1;break}l=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(l<0)){var h=ot({r,c:s}),m=n.dense?(e[r]||[])[s]:e[h],x=m&&m.v!=null&&(m.h||Ob(m.w||(ns(m),m.w)||""))||"",g={};l>1&&(g.rowspan=l),f>1&&(g.colspan=f),n.editable?x='<span contenteditable="true">'+x+"</span>":m&&(g["data-t"]=m&&m.t||"z",m.v!=null&&(g["data-v"]=m.v),m.z!=null&&(g["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+m.l.Target+'">'+x+"</a>")),g.id=(n.id||"sjs")+"-"+h,i.push(Be("td",x,g))}}var y="<tr>";return y+i.join("")+"</tr>"}var kse='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',jse="</body></html>";function Cse(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return so(t4(r[0],t),t);var n=ow();return r.forEach(function(a,i){lw(n,t4(a,t),"Sheet"+(i+1))}),n}function Ase(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function c6(e,t){var r=t||{},n=r.header!=null?r.header:kse,a=r.footer!=null?r.footer:jse,i=[n],s=Zn(e["!ref"]);r.dense=Array.isArray(e),i.push(Ase(e,s,r));for(var l=s.s.r;l<=s.e.r;++l)i.push(_se(e,s,l,r));return i.push("</table>"+a),i.join("")}function u6(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?or(n.origin):n.origin;a=s.r,i=s.c}var l=t.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var h=Zn(e["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),a==-1&&(d.e.r=a=h.e.r+1)}var m=[],x=0,g=e["!rows"]||(e["!rows"]=[]),y=0,v=0,b=0,E=0,N=0,S=0;for(e["!cols"]||(e["!cols"]=[]);y<l.length&&v<f;++y){var j=l[y];if(r4(j)){if(n.display)continue;g[v]={hidden:!0}}var T=j.children;for(b=E=0;b<T.length;++b){var C=T[b];if(!(n.display&&r4(C))){var P=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):OP(C.innerHTML),M=C.getAttribute("data-z")||C.getAttribute("z");for(x=0;x<m.length;++x){var D=m[x];D.s.c==E+i&&D.s.r<v+a&&v+a<=D.e.r&&(E=D.e.c+1-i,x=-1)}S=+C.getAttribute("colspan")||1,((N=+C.getAttribute("rowspan")||1)>1||S>1)&&m.push({s:{r:v+a,c:E+i},e:{r:v+a+(N||1)-1,c:E+i+(S||1)-1}});var W={t:"s",v:P},F=C.getAttribute("data-t")||C.getAttribute("t")||"";P!=null&&(P.length==0?W.t=F||"z":n.raw||P.trim().length==0||F=="s"||(P==="TRUE"?W={t:"b",v:!0}:P==="FALSE"?W={t:"b",v:!1}:isNaN(ri(P))?isNaN(Nc(P).getDate())||(W={t:"d",v:qt(P)},n.cellDates||(W={t:"n",v:Ir(W.v)}),W.z=n.dateNF||it[14]):W={t:"n",v:ri(P)})),W.z===void 0&&M!=null&&(W.z=M);var L="",J=C.getElementsByTagName("A");if(J&&J.length)for(var se=0;se<J.length&&!(J[se].hasAttribute("href")&&(L=J[se].getAttribute("href"),L.charAt(0)!="#"));++se);L&&L.charAt(0)!="#"&&(W.l={Target:L}),n.dense?(e[v+a]||(e[v+a]=[]),e[v+a][E+i]=W):e[ot({c:E+i,r:v+a})]=W,d.e.c<E+i&&(d.e.c=E+i),E+=S}}++v}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,v-1+a),e["!ref"]=ht(d),v>=f&&(e["!fullref"]=ht((d.e.r=l.length-y+v-1+a,d))),e}function f6(e,t){var r=t||{},n=r.dense?[]:{};return u6(n,e,t)}function Tse(e,t){return so(f6(e,t),t)}function r4(e){var t="",r=Pse(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Pse(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Ose(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=yt(t.replace(/<[^>]*>/g,""));return[r]}var n4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function d6(e,t){var r=t||{},n=Fb(e),a=[],i,s,l={name:""},f="",d=0,h,m,x={},g=[],y=r.dense?[]:{},v,b,E={value:""},N="",S=0,j=[],T=-1,C=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,D={},W=[],F={},L=0,J=0,se=[],Z=1,he=1,le=[],de={Names:[]},Q={},pe=["",""],re=[],O={},V="",H=0,q=!1,K=!1,ie=0;for(gf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=gf.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?y["!ref"]=ht(P):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(y["!fullref"]=y["!ref"],P.e.r=r.sheetRows-1,y["!ref"]=ht(P)),W.length&&(y["!merges"]=W),se.length&&(y["!rows"]=se),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),g.push(h.name),x[h.name]=y,K=!1):v[0].charAt(v[0].length-2)!=="/"&&(h=ct(v[0],!1),T=C=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,y=r.dense?[]:{},W=[],se=[],K=!0);break;case"table-row-group":v[1]==="/"?--M:++M;break;case"table-row":case"":if(v[1]==="/"){T+=Z,Z=1;break}if(m=ct(v[0],!1),m.?T=m.-1:T==-1&&(T=0),Z=+m["number-rows-repeated"]||1,Z<10)for(ie=0;ie<Z;++ie)M>0&&(se[T+ie]={level:M});C=-1;break;case"covered-table-cell":v[1]!=="/"&&++C,r.sheetStubs&&(r.dense?(y[T]||(y[T]=[]),y[T][C]={t:"z"}):y[ot({r:T,c:C})]={t:"z"}),N="",j=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++C,E=ct(v[0],!1),he=parseInt(E["number-columns-repeated"]||"1",10),b={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(b.f=Qj(yt(E.formula))),(E.||E["value-type"])=="string"&&(b.t="s",b.v=yt(E["string-value"]||""),r.dense?(y[T]||(y[T]=[]),y[T][C]=b):y[ot({r:T,c:C})]=b),C+=he-1;else if(v[1]!=="/"){++C,N="",S=0,j=[],he=1;var B=Z?T+Z-1:T;if(C>P.e.c&&(P.e.c=C),C<P.s.c&&(P.s.c=C),T<P.s.r&&(P.s.r=T),B>P.e.r&&(P.e.r=B),E=ct(v[0],!1),re=[],O={},b={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=yt(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(L=parseInt(E["number-matrix-rows-spanned"],10)||0,J=parseInt(E["number-matrix-columns-spanned"],10)||0,F={s:{r:T,c:C},e:{r:T+L-1,c:C+J-1}},b.F=ht(F),le.push([F,b.F])),E.formula)b.f=Qj(E.formula);else for(ie=0;ie<le.length;++ie)T>=le[ie][0].s.r&&T<=le[ie][0].e.r&&C>=le[ie][0].s.c&&C<=le[ie][0].e.c&&(b.F=le[ie][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(L=parseInt(E["number-rows-spanned"],10)||0,J=parseInt(E["number-columns-spanned"],10)||0,F={s:{r:T,c:C},e:{r:T+L-1,c:C+J-1}},W.push(F)),E["number-columns-repeated"]&&(he=parseInt(E["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=Kt(E["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(E.value);break;case"percentage":b.t="n",b.v=parseFloat(E.value);break;case"currency":b.t="n",b.v=parseFloat(E.value);break;case"date":b.t="d",b.v=qt(E["date-value"]),r.cellDates||(b.t="n",b.v=Ir(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=iY(E["time-value"])/86400,r.cellDates&&(b.t="d",b.v=Am(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(E.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",E["string-value"]!=null&&(N=yt(E["string-value"]),j=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(q=!1,b.t==="s"&&(b.v=N||"",j.length&&(b.R=j),q=S==0),Q.Target&&(b.l=Q),re.length>0&&(b.c=re,re=[]),N&&r.cellText!==!1&&(b.w=N),q&&(b.t="z",delete b.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var z=0;z<Z;++z){if(he=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(y[T+z]||(y[T+z]=[]),y[T+z][C]=z==0?b:Xt(b);--he>0;)y[T+z][C+he]=Xt(b);else for(y[ot({r:T+z,c:C})]=b;--he>0;)y[ot({r:T+z,c:C+he})]=Xt(b);P.e.c<=C&&(P.e.c=C)}he=parseInt(E["number-columns-repeated"]||"1",10),C+=he-1,he=0,b={},N="",j=[]}Q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((i=a.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((i=a.pop())[0]!==v[3])throw"Bad state: "+i;O.t=N,j.length&&(O.R=j),O.a=V,re.push(O)}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!1]);V="",H=0,N="",S=0,j=[];break;case"creator":v[1]==="/"?V=n.slice(H,v.index):H=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((i=a.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!1]);N="",S=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(D[l.name]=f,(i=a.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&(f="",l=ct(v[0],!1),a.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=ct(v[0],!1),f+=n4[v[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=ct(v[0],!1),f+=n4[v[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,v.index);break}else d=v.index+v[0].length;break;case"named-range":s=ct(v[0],!1),pe=sv(s["cell-range-address"]);var G={Name:s.name,Ref:pe[0]+"!"+pe[1]};K&&(G.Sheet=g.length),de.Names.push(G);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(v[1]==="/"&&(!E||!E["string-value"])){var ce=Ose(n.slice(S,v.index));N=(N.length>0?N+`
`:"")+ce[0]}else ct(v[0],!1),S=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{pe=sv(ct(v[0])["target-range-address"]),x[pe[0]]["!autofilter"]={ref:pe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(Q=ct(v[0],!1),!Q.href)break;Q.Target=yt(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(pe=sv(Q.Target.slice(1)),Q.Target="#"+pe[0]+"!"+pe[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var I={Sheets:x,SheetNames:g,Workbook:de};return r.bookSheets&&delete I.Sheets,I}function a4(e,t){t=t||{},Oa(e,"META-INF/manifest.xml")&&iJ(Nr(e,"META-INF/manifest.xml"),t);var r=fa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=d6(Rt(r),t);return Oa(e,"meta.xml")&&(n.Props=rO(Nr(e,"meta.xml"))),n}function i4(e,t){return d6(e,t)}var Fse=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+xf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return br+t}})(),s4=(function(){var e=function(i){return It(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,l){var f=[];f.push('      <table:table table:name="'+It(s.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,h=0,m=Zn(i["!ref"]||"A1"),x=i["!merges"]||[],g=0,y=Array.isArray(i);if(i["!cols"])for(h=0;h<=m.e.c;++h)f.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var v="",b=i["!rows"]||[];for(d=0;d<m.s.r;++d)v=b[d]?' table:style-name="ro'+b[d].ods+'"':"",f.push("        <table:table-row"+v+`></table:table-row>
`);for(;d<=m.e.r;++d){for(v=b[d]?' table:style-name="ro'+b[d].ods+'"':"",f.push("        <table:table-row"+v+`>
`),h=0;h<m.s.c;++h)f.push(t);for(;h<=m.e.c;++h){var E=!1,N={},S="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>h)&&!(x[g].s.r>d)&&!(x[g].e.c<h)&&!(x[g].e.r<d)){(x[g].s.c!=h||x[g].s.r!=d)&&(E=!0),N["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,N["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(E){f.push(r);continue}var j=ot({r:d,c:h}),T=y?(i[d]||[])[h]:i[j];if(T&&T.f&&(N["table:formula"]=It(Zre(T.f)),T.F&&T.F.slice(0,j.length)==j)){var C=Zn(T.F);N["table:number-matrix-columns-spanned"]=C.e.c-C.s.c+1,N["table:number-matrix-rows-spanned"]=C.e.r-C.s.r+1}if(!T){f.push(t);continue}switch(T.t){case"b":S=T.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=T.v?"true":"false";break;case"n":S=T.w||String(T.v||0),N["office:value-type"]="float",N["office:value"]=T.v||0;break;case"s":case"str":S=T.v==null?"":T.v,N["office:value-type"]="string";break;case"d":S=T.w||qt(T.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=qt(T.v).toISOString(),N["table:style-name"]="ce1";break;default:f.push(t);continue}var P=e(S);if(T.l&&T.l.Target){var M=T.l.Target;M=M.charAt(0)=="#"?"#"+ene(M.slice(1)):M,M.charAt(0)!="#"&&!M.match(/^\w+:/)&&(M="../"+M),P=Be("text:a",P,{"xlink:href":M.replace(/&/g,"&amp;")})}f.push("          "+Be("table:table-cell",Be("text:p",P,{}),N)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var h=0;h<d["!cols"].length;++h)if(d["!cols"][h]){var m=d["!cols"][h];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Ys(m),m.ods=l;var x=d["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++l}}});var f=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var h=0;h<d["!rows"].length;++h)if(d["!rows"][h]){d["!rows"][h].ods=f;var m=d["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,l){var f=[br],d=xf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=xf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(f.push("<office:document"+d+h+`>
`),f.push(tO().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,s),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var m=0;m!=s.SheetNames.length;++m)f.push(n(s.Sheets[s.SheetNames[m]],s,m));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),l.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function h6(e,t){if(t.bookType=="fods")return s4(e,t);var r=Ab(),n="",a=[],i=[];return n="mimetype",mt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",mt(r,n,s4(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",mt(r,n,Fse(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",mt(r,n,br+tO()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",mt(r,n,lJ(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",mt(r,n,sJ(a)),r}function al(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function v1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Rt(io(e))}function Dse(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ua(vi(e))}function Ise(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Qs(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function o4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Mse(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Rse(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Ef(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Tt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function fr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Nt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Ef(e,r),i=a&7;a=Math.floor(a/8);var s=0,l;if(a==0)break;switch(i){case 0:{for(var f=r[0];e[r[0]++]>=128;);l=e.slice(f,r[0])}break;case 5:s=4,l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Ef(e,r),l=e.slice(r[0],r[0]+s),r[0]+=s;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:l,type:i};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function an(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Tt(n*8+a.type)),a.type==2&&t.push(Tt(a.data.length)),t.push(a.data))})}),Qs(t)}function rw(e,t){return e?.map(function(r){return t(r.data)})||[]}function Ta(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Ef(e,n),i=Nt(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:fr(i[1][0].data),messages:[]};i[2].forEach(function(l){var f=Nt(l.data),d=fr(f[3][0].data);s.messages.push({meta:f,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(s.merge=fr(i[3][0].data)>>>0>0),r.push(s)}return r}function Gl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Tt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Tt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:Tt(s.data.length)}],n[2].push({data:an(s.meta),type:2})});var i=an(n);t.push(Tt(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Qs(t)}function Lse(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ef(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var l=s-59;s=t[r[0]],l>1&&(s|=t[r[0]+1]<<8),l>2&&(s|=t[r[0]+2]<<16),l>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=l}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var f=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,f=(t[r[0]++]&224)<<3,f|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(f=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(f=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Qs(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var h=Qs(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Pa(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Lse(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Qs(t)}function Kl(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Tt(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Qs(t)}function Bse(e,t,r,n){var a=al(e),i=a.getUint32(4,!0),s=(n>1?12:8)+o4(i&(n>1?3470:398))*4,l=-1,f=-1,d=NaN,h=new Date(2001,0,1);i&512&&(l=a.getUint32(s,!0),s+=4),s+=o4(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(s,!0),s+=4),i&32&&(d=a.getFloat64(s,!0),s+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[f]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(f>-1)m={t:"s",v:t[f]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function $se(e,t,r){var n=al(e),a=n.getUint32(8,!0),i=12,s=-1,l=-1,f=NaN,d=NaN,h=new Date(2001,0,1);a&1&&(f=Mse(e,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(l=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(s>-1)m={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function lv(e,t){var r=new Uint8Array(32),n=al(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Rse(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function cv(e,t){var r=new Uint8Array(32),n=al(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Use(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Bse(e,t,r,e[0]);case 5:return $se(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function vn(e){var t=Nt(e);return Ef(t[1][0].data)}function l4(e,t){var r=Nt(t.data),n=fr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var l=Nt(s.data),f=fr(l[1][0].data)>>>0;switch(n){case 1:i[f]=v1(l[3][0].data);break;case 8:{var d=e[vn(l[9][0].data)][0],h=Nt(d.data),m=e[vn(h[1][0].data)][0],x=fr(m.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var g=Nt(m.data);i[f]=g[3].map(function(y){return v1(y.data)}).join("")}break}}),i}function zse(e,t){var r,n,a,i,s,l,f,d,h,m,x,g,y,v,b=Nt(e),E=fr(b[1][0].data)>>>0,N=fr(b[2][0].data)>>>0,S=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&fr(b[8][0].data)>0||!1,j,T;if((i=(a=b[7])==null?void 0:a[0])!=null&&i.data&&t!=0)j=(l=(s=b[7])==null?void 0:s[0])==null?void 0:l.data,T=(d=(f=b[6])==null?void 0:f[0])==null?void 0:d.data;else if((m=(h=b[4])==null?void 0:h[0])!=null&&m.data&&t!=1)j=(g=(x=b[4])==null?void 0:x[0])==null?void 0:g.data,T=(v=(y=b[3])==null?void 0:y[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var C=S?4:1,P=al(j),M=[],D=0;D<j.length/2;++D){var W=P.getUint16(D*2,!0);W<65535&&M.push([D,W])}if(M.length!=N)throw"Expected ".concat(N," cells, found ").concat(M.length);var F=[];for(D=0;D<M.length-1;++D)F[M[D][0]]=T.subarray(M[D][1]*C,M[D+1][1]*C);return M.length>=1&&(F[M[M.length-1][0]]=T.subarray(M[M.length-1][1]*C)),{R:E,cells:F}}function Wse(e,t){var r,n=Nt(t.data),a=(r=n?.[7])!=null&&r[0]?fr(n[7][0].data)>>>0>0?1:0:-1,i=rw(n[5],function(s){return zse(s,a)});return{nrows:fr(n[4][0].data)>>>0,data:i.reduce(function(s,l){return s[l.R]||(s[l.R]=[]),l.cells.forEach(function(f,d){if(s[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));s[l.R][d]=f}),s},[])}}function Hse(e,t,r){var n,a=Nt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(fr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(fr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=ht(i);var s=Nt(a[4][0].data),l=l4(e,e[vn(s[4][0].data)][0]),f=(n=s[17])!=null&&n[0]?l4(e,e[vn(s[17][0].data)][0]):[],d=Nt(s[3][0].data),h=0;d[1].forEach(function(m){var x=Nt(m.data),g=e[vn(x[2][0].data)][0],y=fr(g.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var v=Wse(e,g);v.data.forEach(function(b,E){b.forEach(function(N,S){var j=ot({r:h+E,c:S}),T=Use(N,l,f);T&&(r[j]=T)})}),h+=v.nrows})}function Vse(e,t){var r=Nt(t.data),n={"!ref":"A1"},a=e[vn(r[2][0].data)],i=fr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Hse(e,a[0],n),n}function Gse(e,t){var r,n=Nt(t.data),a={name:(r=n[1])!=null&&r[0]?v1(n[1][0].data):"",sheets:[]},i=rw(n[2],vn);return i.forEach(function(s){e[s].forEach(function(l){var f=fr(l.meta[1][0].data);f==6e3&&a.sheets.push(Vse(e,l))})}),a}function Kse(e,t){var r=ow(),n=Nt(t.data),a=rw(n[1],vn);if(a.forEach(function(i){e[i].forEach(function(s){var l=fr(s.meta[1][0].data);if(l==2){var f=Gse(e,s);f.sheets.forEach(function(d,h){lw(r,d,h==0?f.name:f.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function uv(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=Pa(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var h;try{h=Ta(d)}catch(m){return console.log("## "+(m.message||m))}h.forEach(function(m){i[m.id]=m.messages,s.push(m.id)})}}),!s.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||s.forEach(function(f){i[f].forEach(function(d){var h=fr(d.meta[1][0].data)>>>0;if(h==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Kse(i,l)}function qse(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&fr(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var f=0,d=al(e[7][0].data),h=0,m=[],x=al(e[4][0].data),g=0,y=[],v=0;v<t.length;++v){if(t[v]==null){d.setUint16(v*2,65535,!0),x.setUint16(v*2,65535);continue}d.setUint16(v*2,h,!0),x.setUint16(v*2,g,!0);var b,E;switch(typeof t[v]){case"string":b=lv({t:"s",v:t[v]},r),E=cv({t:"s",v:t[v]},r);break;case"number":b=lv({t:"n",v:t[v]},r),E=cv({t:"n",v:t[v]},r);break;case"boolean":b=lv({t:"b",v:t[v]},r),E=cv({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}m.push(b),h+=b.length,y.push(E),g+=E.length,++f}for(e[2][0].data=Tt(f);v<e[7][0].data.length/2;++v)d.setUint16(v*2,65535,!0),x.setUint16(v*2,65535,!0);return e[6][0].data=Qs(m),e[3][0].data=Qs(y),f}function Xse(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Zn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(ht(n)));var i=Bh(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(V){return V.forEach(function(H){typeof H=="string"&&s.push(H)})});var l={},f=[],d=tt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(V,H){return[V,d.FullPaths[H]]}).forEach(function(V){var H=V[0],q=V[1];if(H.type==2&&H.name.match(/\.iwa/)){var K=H.content,ie=Pa(K),B=Ta(ie);B.forEach(function(z){f.push(z.id),l[z.id]={deps:[],location:q,type:fr(z.messages[0].meta[1][0].data)}})}}),f.sort(function(V,H){return V-H});var h=f.filter(function(V){return V>1}).map(function(V){return[V,Tt(V)]});d.FileIndex.map(function(V,H){return[V,d.FullPaths[H]]}).forEach(function(V){var H=V[0];if(V[1],!!H.name.match(/\.iwa/)){var q=Ta(Pa(H.content));q.forEach(function(K){K.messages.forEach(function(ie){h.forEach(function(B){K.messages.some(function(z){return fr(z.meta[1][0].data)!=11006&&Ise(z.data,B[1])})&&l[B[0]].deps.push(K.id)})})})}});for(var m=tt.find(d,l[1].location),x=Ta(Pa(m.content)),g,y=0;y<x.length;++y){var v=x[y];v.id==1&&(g=v)}var b=vn(Nt(g.messages[0].data)[1][0].data);for(m=tt.find(d,l[b].location),x=Ta(Pa(m.content)),y=0;y<x.length;++y)v=x[y],v.id==b&&(g=v);for(b=vn(Nt(g.messages[0].data)[2][0].data),m=tt.find(d,l[b].location),x=Ta(Pa(m.content)),y=0;y<x.length;++y)v=x[y],v.id==b&&(g=v);for(b=vn(Nt(g.messages[0].data)[2][0].data),m=tt.find(d,l[b].location),x=Ta(Pa(m.content)),y=0;y<x.length;++y)v=x[y],v.id==b&&(g=v);var E=Nt(g.messages[0].data);{E[6][0].data=Tt(n.e.r+1),E[7][0].data=Tt(n.e.c+1);var N=vn(E[46][0].data),S=tt.find(d,l[N].location),j=Ta(Pa(S.content));{for(var T=0;T<j.length&&j[T].id!=N;++T);if(j[T].id!=N)throw"Bad ColumnRowUIDMapArchive";var C=Nt(j[T].messages[0].data);C[1]=[],C[2]=[],C[3]=[];for(var P=0;P<=n.e.c;++P){var M=[];M[1]=M[2]=[{type:0,data:Tt(P+420690)}],C[1].push({type:2,data:an(M)}),C[2].push({type:0,data:Tt(P)}),C[3].push({type:0,data:Tt(P)})}C[4]=[],C[5]=[],C[6]=[];for(var D=0;D<=n.e.r;++D)M=[],M[1]=M[2]=[{type:0,data:Tt(D+726270)}],C[4].push({type:2,data:an(M)}),C[5].push({type:0,data:Tt(D)}),C[6].push({type:0,data:Tt(D)});j[T].messages[0].data=an(C)}S.content=Kl(Gl(j)),S.size=S.content.length,delete E[46];var W=Nt(E[4][0].data);{W[7][0].data=Tt(n.e.r+1);var F=Nt(W[1][0].data),L=vn(F[2][0].data);S=tt.find(d,l[L].location),j=Ta(Pa(S.content));{if(j[0].id!=L)throw"Bad HeaderStorageBucket";var J=Nt(j[0].messages[0].data);for(D=0;D<i.length;++D){var se=Nt(J[2][0].data);se[1][0].data=Tt(D),se[4][0].data=Tt(i[D].length),J[2][D]={type:J[2][0].type,data:an(se)}}j[0].messages[0].data=an(J)}S.content=Kl(Gl(j)),S.size=S.content.length;var Z=vn(W[2][0].data);S=tt.find(d,l[Z].location),j=Ta(Pa(S.content));{if(j[0].id!=Z)throw"Bad HeaderStorageBucket";for(J=Nt(j[0].messages[0].data),P=0;P<=n.e.c;++P)se=Nt(J[2][0].data),se[1][0].data=Tt(P),se[4][0].data=Tt(n.e.r+1),J[2][P]={type:J[2][0].type,data:an(se)};j[0].messages[0].data=an(J)}S.content=Kl(Gl(j)),S.size=S.content.length;var he=vn(W[4][0].data);(function(){for(var V=tt.find(d,l[he].location),H=Ta(Pa(V.content)),q,K=0;K<H.length;++K){var ie=H[K];ie.id==he&&(q=ie)}var B=Nt(q.messages[0].data);{B[3]=[];var z=[];s.forEach(function(I,Ae){z[1]=[{type:0,data:Tt(Ae)}],z[2]=[{type:0,data:Tt(1)}],z[3]=[{type:2,data:Dse(I)}],B[3].push({type:2,data:an(z)})})}q.messages[0].data=an(B);var G=Gl(H),ce=Kl(G);V.content=ce,V.size=V.content.length})();var le=Nt(W[3][0].data);{var de=le[1][0];delete le[2];var Q=Nt(de.data);{var pe=vn(Q[2][0].data);(function(){for(var V=tt.find(d,l[pe].location),H=Ta(Pa(V.content)),q,K=0;K<H.length;++K){var ie=H[K];ie.id==pe&&(q=ie)}var B=Nt(q.messages[0].data);{delete B[6],delete le[7];var z=new Uint8Array(B[5][0].data);B[5]=[];for(var G=0,ce=0;ce<=n.e.r;++ce){var I=Nt(z);G+=qse(I,i[ce],s),I[1][0].data=Tt(ce),B[5].push({data:an(I),type:2})}B[1]=[{type:0,data:Tt(n.e.c+1)}],B[2]=[{type:0,data:Tt(n.e.r+1)}],B[3]=[{type:0,data:Tt(G)}],B[4]=[{type:0,data:Tt(n.e.r+1)}]}q.messages[0].data=an(B);var Ae=Gl(H),je=Kl(Ae);V.content=je,V.size=V.content.length})()}de.data=an(Q)}W[3][0].data=an(le)}E[4][0].data=an(W)}g.messages[0].data=an(E);var re=Gl(x),O=Kl(re);return m.content=O,m.size=m.content.length,d}function m6(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function nw(e){m6([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function aw(e){m6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Yse(e){return gt.WS.indexOf(e)>-1?"sheet":e==gt.CS?"chart":e==gt.DS?"dialog":e==gt.MS?"macro":e&&e.length?e:"sheet"}function Jse(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Yse(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Qse(e,t,r,n,a,i,s,l,f,d,h,m){try{i[n]=Ku(fa(e,r,!0),t);var x=Nr(e,t),g;switch(l){case"sheet":g=bie(x,t,a,f,i[n],d,h,m);break;case"chart":if(g=wie(x,t,a,f,i[n],d,h,m),!g||!g["!drawel"])break;var y=Lu(g["!drawel"].Target,t),v=vf(y),b=ote(fa(e,y,!0),Ku(fa(e,v,!0),y)),E=Lu(b,y),N=vf(E);g=qae(fa(e,E,!0),E,f,Ku(fa(e,N,!0),E),d,g);break;case"macro":g=Sie(x,t,a,f,i[n],d,h,m);break;case"dialog":g=Nie(x,t,a,f,i[n],d,h,m);break;default:throw new Error("Unrecognized sheet type "+l)}s[n]=g;var S=[];i&&i[n]&&dr(i[n]).forEach(function(j){var T="";if(i[n][j].Type==gt.CMNT){T=Lu(i[n][j].Target,t);var C=jie(Nr(e,T,!0),T,f);if(!C||!C.length)return;Kj(g,C,!1)}i[n][j].Type==gt.TCMNT&&(T=Lu(i[n][j].Target,t),S=S.concat(cte(Nr(e,T,!0),f)))}),S&&S.length&&Kj(g,S,!0,f.people||[])}catch(j){if(f.WTF)throw j}}function ja(e){return e.charAt(0)=="/"?e.slice(1):e}function Zse(e,t){if(Rc(),t=t||{},nw(t),Oa(e,"META-INF/manifest.xml")||Oa(e,"objectdata.xml"))return a4(e,t);if(Oa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof uv<"u"){if(e.FileIndex)return uv(e);var r=tt.utils.cfb_new();return mj(e).forEach(function(se){mt(r,se,uY(e,se))}),uv(r)}throw new Error("Unsupported NUMBERS file")}if(!Oa(e,"[Content_Types].xml"))throw Oa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Oa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=mj(e),a=nJ(fa(e,"[Content_Types].xml")),i=!1,s,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",Nr(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!Nr(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},d={};if(!t.bookSheets&&!t.bookProps){if(qu=[],a.sst)try{qu=kie(Nr(e,ja(a.sst)),a.sst,t)}catch(se){if(t.WTF)throw se}t.cellStyles&&a.themes.length&&(f=_ie(fa(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(d=Eie(Nr(e,ja(a.style)),a.style,f,t))}a.links.map(function(se){try{var Z=Ku(fa(e,vf(ja(se))),se);return Aie(Nr(e,ja(se)),Z,se,t)}catch{}});var h=yie(Nr(e,ja(a.workbooks[0])),a.workbooks[0],t),m={},x="";a.coreprops.length&&(x=Nr(e,ja(a.coreprops[0]),!0),x&&(m=rO(x)),a.extprops.length!==0&&(x=Nr(e,ja(a.extprops[0]),!0),x&&uJ(x,m,t)));var g={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(x=fa(e,ja(a.custprops[0]),!0),x&&(g=dJ(x,t)));var y={};if((t.bookSheets||t.bookProps)&&(h.Sheets?s=h.Sheets.map(function(Z){return Z.name}):m.Worksheets&&m.SheetNames.length>0&&(s=m.SheetNames),t.bookProps&&(y.Props=m,y.Custprops=g),t.bookSheets&&typeof s<"u"&&(y.SheetNames=s),t.bookSheets?y.SheetNames:t.bookProps))return y;s={};var v={};t.bookDeps&&a.calcchain&&(v=Cie(Nr(e,ja(a.calcchain)),a.calcchain));var b=0,E={},N,S;{var j=h.Sheets;m.Worksheets=j.length,m.SheetNames=[];for(var T=0;T!=j.length;++T)m.SheetNames[T]=j[T].name}var C=i?"bin":"xml",P=a.workbooks[0].lastIndexOf("/"),M=(a.workbooks[0].slice(0,P+1)+"_rels/"+a.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");Oa(e,M)||(M="xl/_rels/workbook."+C+".rels");var D=Ku(fa(e,M,!0),M.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Tie(Nr(e,ja(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=fte(Nr(e,ja(a.people[0])),t)),D&&(D=Jse(D,h.Sheets));var W=Nr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=m.Worksheets;++b){var F="sheet";if(D&&D[b]?(N="xl/"+D[b][1].replace(/[\/]?xl\//,""),Oa(e,N)||(N=D[b][1]),Oa(e,N)||(N=M.replace(/_rels\/.*$/,"")+D[b][1]),F=D[b][2]):(N="xl/worksheets/sheet"+(b+1-W)+"."+C,N=N.replace(/sheet0\./,"sheet.")),S=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(m.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,J=0;J!=t.sheets.length;++J)typeof t.sheets[J]=="number"&&t.sheets[J]==b&&(L=1),typeof t.sheets[J]=="string"&&t.sheets[J].toLowerCase()==m.SheetNames[b].toLowerCase()&&(L=1);if(!L)continue e}}Qse(e,N,S,m.SheetNames[b],b,E,s,F,t,h,f,d)}return y={Directory:a,Workbook:h,Props:m,Custprops:g,Deps:v,Sheets:s,SheetNames:m.SheetNames,Strings:qu,Styles:d,Themes:f,SSF:Xt(it)},t&&t.bookFiles&&(e.files?(y.keys=n,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(se,Z){se=se.replace(/^Root Entry[\/]/,""),y.keys.push(se),y.files[se]=e.FileIndex[Z]}))),t&&t.bookVBA&&(a.vba.length>0?y.vbaraw=Nr(e,ja(a.vba[0]),!0):a.defaults&&a.defaults.bin===yte&&(y.vbaraw=Nr(e,"xl/vbaProject.bin",!0))),y}function eoe(e,t){var r=t||{},n="Workbook",a=tt.find(e,n);try{if(n="/!DataSpaces/Version",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(TZ(a.content),n="/!DataSpaces/DataSpaceMap",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=OZ(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=FZ(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);IZ(a.content)}catch{}if(n="/EncryptionInfo",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=MZ(a.content);if(n="/EncryptedPackage",a=tt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function toe(e,t){return t.bookType=="ods"?h6(e,t):t.bookType=="numbers"?Xse(e,t):t.bookType=="xlsb"?roe(e,t):noe(e,t)}function roe(e,t){ec=1024,e&&!e.SSF&&(e.SSF=Xt(it)),e&&e.SSF&&(Rc(),km(e.SSF),t.revssf=Cm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=UO.indexOf(t.bookType)>-1,a=Wb();aw(t=t||{});var i=Ab(),s="",l=0;if(t.cellXfs=[],oo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",mt(i,s,nO(e.Props,t)),a.coreprops.push(s),Ot(t.rels,2,s,gt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}for(e.Props.Worksheets=e.Props.SheetNames.length,mt(i,s,sO(e.Props)),a.extprops.push(s),Ot(t.rels,3,s,gt.EXT_PROPS),e.Custprops!==e.Props&&dr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",mt(i,s,oO(e.Custprops)),a.custprops.push(s),Ot(t.rels,4,s,gt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],x=(m||{})["!type"]||"sheet";if(s="xl/worksheets/sheet"+l+"."+r,mt(i,s,Oie(l-1,s,t,e,h)),a.sheets.push(s),Ot(t.wbrels,-1,"worksheets/sheet"+l+"."+r,gt.WS[0]),m){var g=m["!comments"],y=!1,v="";g&&g.length>0&&(v="xl/comments"+l+"."+r,mt(i,v,Iie(g,v)),a.comments.push(v),Ot(h,-1,"../comments"+l+"."+r,gt.CMNT),y=!0),m["!legacy"]&&y&&mt(i,"xl/drawings/vmlDrawing"+l+".vml",BO(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&mt(i,vf(s),sc(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,mt(i,s,Die(t.Strings,s,t)),a.strs.push(s),Ot(t.wbrels,-1,"sharedStrings."+r,gt.SST)),s="xl/workbook."+r,mt(i,s,Pie(e,s)),a.workbooks.push(s),Ot(t.rels,1,s,gt.WB),s="xl/theme/theme1.xml",mt(i,s,Xb(e.Themes,t)),a.themes.push(s),Ot(t.wbrels,-1,"theme/theme1.xml",gt.THEME),s="xl/styles."+r,mt(i,s,Fie(e,s,t)),a.styles.push(s),Ot(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",mt(i,s,e.vbaraw),a.vba.push(s),Ot(t.wbrels,-1,"vbaProject.bin",gt.VBA)),s="xl/metadata."+r,mt(i,s,Mie(s)),a.metadata.push(s),Ot(t.wbrels,-1,"metadata."+r,gt.XLMETA),mt(i,"[Content_Types].xml",eO(a,t)),mt(i,"_rels/.rels",sc(t.rels)),mt(i,"xl/_rels/workbook."+r+".rels",sc(t.wbrels)),delete t.revssf,delete t.ssf,i}function noe(e,t){ec=1024,e&&!e.SSF&&(e.SSF=Xt(it)),e&&e.SSF&&(Rc(),km(e.SSF),t.revssf=Cm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=UO.indexOf(t.bookType)>-1,a=Wb();aw(t=t||{});var i=Ab(),s="",l=0;if(t.cellXfs=[],oo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",mt(i,s,nO(e.Props,t)),a.coreprops.push(s),Ot(t.rels,2,s,gt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,mt(i,s,sO(e.Props)),a.extprops.push(s),Ot(t.rels,3,s,gt.EXT_PROPS),e.Custprops!==e.Props&&dr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",mt(i,s,oO(e.Custprops)),a.custprops.push(s),Ot(t.rels,4,s,gt.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],g=(x||{})["!type"]||"sheet";if(s="xl/worksheets/sheet"+l+"."+r,mt(i,s,QO(l-1,t,e,m)),a.sheets.push(s),Ot(t.wbrels,-1,"worksheets/sheet"+l+"."+r,gt.WS[0]),x){var y=x["!comments"],v=!1,b="";if(y&&y.length>0){var E=!1;y.forEach(function(N){N[1].forEach(function(S){S.T==!0&&(E=!0)})}),E&&(b="xl/threadedComments/threadedComment"+l+"."+r,mt(i,b,ute(y,h,t)),a.threadedcomments.push(b),Ot(m,-1,"../threadedComments/threadedComment"+l+"."+r,gt.TCMNT)),b="xl/comments"+l+"."+r,mt(i,b,$O(y)),a.comments.push(b),Ot(m,-1,"../comments"+l+"."+r,gt.CMNT),v=!0}x["!legacy"]&&v&&mt(i,"xl/drawings/vmlDrawing"+l+".vml",BO(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&mt(i,vf(s),sc(m))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,mt(i,s,jO(t.Strings,t)),a.strs.push(s),Ot(t.wbrels,-1,"sharedStrings."+r,gt.SST)),s="xl/workbook."+r,mt(i,s,n6(e)),a.workbooks.push(s),Ot(t.rels,1,s,gt.WB),s="xl/theme/theme1.xml",mt(i,s,Xb(e.Themes,t)),a.themes.push(s),Ot(t.wbrels,-1,"theme/theme1.xml",gt.THEME),s="xl/styles."+r,mt(i,s,IO(e,t)),a.styles.push(s),Ot(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",mt(i,s,e.vbaraw),a.vba.push(s),Ot(t.wbrels,-1,"vbaProject.bin",gt.VBA)),s="xl/metadata."+r,mt(i,s,LO()),a.metadata.push(s),Ot(t.wbrels,-1,"metadata."+r,gt.XLMETA),h.length>1&&(s="xl/persons/person.xml",mt(i,s,dte(h)),a.people.push(s),Ot(t.wbrels,-1,"persons/person.xml",gt.PEOPLE)),mt(i,"[Content_Types].xml",eO(a,t)),mt(i,"_rels/.rels",sc(t.rels)),mt(i,"xl/_rels/workbook."+r+".rels",sc(t.wbrels)),delete t.revssf,delete t.ssf,i}function iw(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=xa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function aoe(e,t){return tt.find(e,"EncryptedPackage")?eoe(e,t):o6(e,t)}function ioe(e,t){var r,n=e,a=t||{};return a.type||(a.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),r=AP(n,a),Zse(r,a)}function p6(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return x1(e.slice(r),t);default:break e}return Ec.to_workbook(e,t)}function soe(e,t){var r="",n=iw(e,t);switch(t.type){case"base64":r=xa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=el(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Rt(r)),t.type="binary",p6(r,t)}function ooe(e,t){var r=e;return t.type=="base64"&&(r=xa(r)),r=df.utils.decode(1200,r.slice(2),"str"),t.type="binary",p6(r,t)}function loe(e){return e.match(/[^\x00-\x7F]/)?vi(e):e}function fv(e,t,r,n){return n?(r.type="string",Ec.to_workbook(e,r)):Ec.to_workbook(t,r)}function il(e,t){Eb();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return il(new Uint8Array(e),(r=Xt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lc={},r.dateNF&&(lc.dateNF=r.dateNF),r.type||(r.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=pt?"buffer":"binary",n=rY(e),typeof Uint8Array<"u"&&!pt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=loe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),l=new Uint8Array(s);if(l.foo="bar",!l.foo)return r=Xt(r),r.type="array",il(_b(n),r)}switch((a=iw(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return aoe(tt.read(n,r),r);break;case 9:if(a[1]<=8)return o6(n,r);break;case 60:return x1(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return hZ(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return _O.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?ioe(n,r):fv(e,n,r,i);case 239:return a[3]===60?x1(n,r):fv(e,n,r,i);case 255:if(a[1]===254)return ooe(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return zo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return zo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return p1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return OO.to_workbook(n,r);break;case 10:case 13:case 32:return soe(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return dZ.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?p1.to_workbook(n,r):fv(e,n,r,i)}function x6(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Vf(t.file,tt.write(e,{type:pt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return tt.write(e,t)}function coe(e,t){var r=Xt(t||{}),n=toe(e,r);return uoe(n,r)}function uoe(e,t){var r={},n=pt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?tt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(_m(a))}return t.password&&typeof encrypt_agile<"u"?x6(encrypt_agile(a,t.password),t):t.type==="file"?Vf(t.file,a):t.type=="string"?Rt(a):a}function foe(e,t){var r=t||{},n=lse(e,r);return x6(n,r)}function mi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return hf(vi(n));case"binary":return vi(n);case"string":return e;case"file":return Vf(t.file,n,"utf8");case"buffer":return pt?us(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):mi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function doe(e,t){switch(t.type){case"base64":return hf(e);case"binary":return e;case"string":return e;case"file":return Vf(t.file,e,"binary");case"buffer":return pt?us(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function P0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?hf(r):t.type=="string"?Rt(r):r;case"file":return Vf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function g6(e,t){Eb(),aie(e);var r=Xt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=g6(e,r);return r.type="array",_m(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return mi(tse(e,r),r);case"slk":case"sylk":return mi(EO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return mi(c6(e.Sheets[e.SheetNames[a]],r),r);case"txt":return doe(v6(e.Sheets[e.SheetNames[a]],r),r);case"csv":return mi(sw(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return mi(_O.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return P0(p1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return mi(Ec.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return mi(OO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return mi(kO.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return mi(h6(e,r),r);case"wk1":return P0(zo.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return P0(zo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),P0(l6(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),foe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return coe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function hoe(e,t,r,n,a,i,s,l){var f=vr(r),d=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!s||e[r])for(var g=t.s.c;g<=t.e.c;++g){var y=s?e[r][g]:e[n[g]+f];if(y===void 0||y.t===void 0){if(d===void 0)continue;i[g]!=null&&(x[i[g]]=d);continue}var v=y.v;switch(y.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[g]!=null){if(v==null)if(y.t=="e"&&v===null)x[i[g]]=null;else if(d!==void 0)x[i[g]]=d;else if(h&&v===null)x[i[g]]=null;else continue;else x[i[g]]=h&&(y.t!=="n"||y.t==="n"&&l.rawNumbers!==!1)?v:ns(y,v,l);v!=null&&(m=!1)}}return{row:x,isempty:m}}function Bh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,l="",f={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},h=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof h){case"string":f=wt(h);break;case"number":f=wt(e["!ref"]),f.s.r=h;break;default:f=h}n>0&&(a=0);var m=vr(f.s.r),x=[],g=[],y=0,v=0,b=Array.isArray(e),E=f.s.r,N=0,S={};b&&!e[E]&&(e[E]=[]);var j=d.skipHidden&&e["!cols"]||[],T=d.skipHidden&&e["!rows"]||[];for(N=f.s.c;N<=f.e.c;++N)if(!(j[N]||{}).hidden)switch(x[N]=sr(N),r=b?e[E][N]:e[x[N]+m],n){case 1:i[N]=N-f.s.c;break;case 2:i[N]=x[N];break;case 3:i[N]=d.header[N-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=s=ns(r,null,d),v=S[s]||0,!v)S[s]=1;else{do l=s+"_"+v++;while(S[l]);S[s]=v,S[l]=1}i[N]=l}for(E=f.s.r+a;E<=f.e.r;++E)if(!(T[E]||{}).hidden){var C=hoe(e,f,E,x,n,i,b,d);(C.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(g[y++]=C.row)}return g.length=y,g}var c4=/"/g;function moe(e,t,r,n,a,i,s,l){for(var f=!0,d=[],h="",m=vr(r),x=t.s.c;x<=t.e.c;++x)if(n[x]){var g=l.dense?(e[r]||[])[x]:e[n[x]+m];if(g==null)h="";else if(g.v!=null){f=!1,h=""+(l.rawNumbers&&g.t=="n"?g.v:ns(g,null,l));for(var y=0,v=0;y!==h.length;++y)if((v=h.charCodeAt(y))===a||v===i||v===34||l.forceQuotes){h='"'+h.replace(c4,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(f=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(c4,'""')+'"')):h="";d.push(h)}return l.blankrows===!1&&f?null:d.join(s)}function sw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=wt(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,f=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),h="",m=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(x[y]||{}).hidden||(m[y]=sr(y));for(var v=0,b=a.s.r;b<=a.e.r;++b)(g[b]||{}).hidden||(h=moe(e,a,b,m,s,f,i,n),h!=null&&(n.strip&&(h=h.replace(d,"")),(h||n.blankrows!==!1)&&r.push((v++?l:"")+h)));return delete n.dense,r.join("")}function v6(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=sw(e,t);return r}function poe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=wt(e["!ref"]),i="",s=[],l,f=[],d=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)s[l]=sr(l);for(var h=a.s.r;h<=a.e.r;++h)for(i=vr(h),l=a.s.c;l<=a.e.c;++l)if(t=s[l]+i,r=d?(e[h]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=t+"="+n}return f}function y6(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?or(n.origin):n.origin;s=f.r,l=f.c}var d,h={s:{c:0,r:0},e:{c:l,r:s+t.length-1+a}};if(i["!ref"]){var m=wt(i["!ref"]);h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),s==-1&&(s=m.e.r+1,h.e.r=s+t.length-1+a)}else s==-1&&(s=0,h.e.r=t.length-1+a);var x=n.header||[],g=0;t.forEach(function(v,b){dr(v).forEach(function(E){(g=x.indexOf(E))==-1&&(x[g=x.length]=E);var N=v[E],S="z",j="",T=ot({c:l+g,r:s+b+a});d=_f(i,T),N&&typeof N=="object"&&!(N instanceof Date)?i[T]=N:(typeof N=="number"?S="n":typeof N=="boolean"?S="b":typeof N=="string"?S="s":N instanceof Date?(S="d",n.cellDates||(S="n",N=Ir(N)),j=n.dateNF||it[14]):N===null&&n.nullError&&(S="e",N=0),d?(d.t=S,d.v=N,delete d.w,delete d.R,j&&(d.z=j)):i[T]=d={t:S,v:N},j&&(d.z=j))})}),h.e.c=Math.max(h.e.c,l+x.length-1);var y=vr(s);if(a)for(g=0;g<x.length;++g)i[sr(g+l)+y]={t:"s",v:x[g]};return i["!ref"]=ht(h),i}function xoe(e,t){return y6(null,e,t)}function _f(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=or(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?_f(e,ot(t)):_f(e,ot({r:t,c:r||0}))}function goe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function ow(){return{SheetNames:[],Sheets:{}}}function lw(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(r6(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function voe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=goe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function yoe(e,t){return e.z=t,e}function b6(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function boe(e,t,r){return b6(e,"#"+t,r)}function woe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Soe(e,t,r,n){for(var a=typeof t!="string"?t:wt(t),i=typeof t=="string"?t:ht(t),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var f=_f(e,s,l);f.t="n",f.F=i,delete f.v,s==a.s.r&&l==a.s.c&&(f.f=r,n&&(f.D=!0))}return e}var bi={encode_col:sr,encode_row:vr,encode_cell:ot,encode_range:ht,decode_col:Rb,decode_row:Mb,split_cell:DY,decode_cell:or,decode_range:Zn,format_cell:ns,sheet_add_aoa:KP,sheet_add_json:y6,sheet_add_dom:u6,aoa_to_sheet:Lc,json_to_sheet:xoe,table_to_sheet:f6,table_to_book:Tse,sheet_to_csv:sw,sheet_to_txt:v6,sheet_to_json:Bh,sheet_to_html:c6,sheet_to_formulae:poe,sheet_to_row_object_array:Bh,sheet_get_cell:_f,book_new:ow,book_append_sheet:lw,book_set_sheet_visibility:voe,cell_set_number_format:yoe,cell_set_hyperlink:b6,cell_set_internal_link:boe,cell_add_comment:woe,sheet_set_array_formula:Soe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function cw(e){const t=fe.getById("eleves",e);if(!t)throw new Error("lve introuvable");const r=fe.getById("classes",t.classeId),n=fe.getAll("ecole")[0],a=r?.niveau,i=r?.anneeScolaire||t.anneeEntree||n?.anneeScolaireActive;if(!a||!i)return[];const s=fe.getAll("fraisScolaires").find(l=>l.niveau===a&&l.anneeScolaire===i);return!s||!(s.echeances&&s.echeances.length)?[]:(s.echeances||[]).map((l,f)=>({echeanceId:l.id||`${s.niveau}-${f+1}`,date:l.date,montant:Number(l.montant||0),paid:0,remaining:Number(l.montant||0),modalite:l.modalite,dueDate:l.date}))}function Noe(e,t,r,n={}){let a=cw(e);const i=typeof(n&&n.modalite)<"u"?Number(n.modalite):null;if(i!==null){const h=[],m=[];for(const x of a)Number(x.modalite)===i?h.push(x):m.push(x);a=[...h,...m]}let s=Math.max(0,Number(t));const l=[];for(const h of a){if(s<=0)break;if(h.remaining<=0)continue;const m=Math.min(h.remaining,s);h.paid+=m,h.remaining-=m,s-=m,l.push({echeanceId:h.echeanceId,montant:m})}const f={eleveId:e,montant:t,datePaiement:r,createdAt:new Date().toISOString(),allocations:l,avance:s,...n},d=fe.create("paiements",f);if(s>0){const h={eleveId:e,montant:s,date:new Date().toISOString(),createdAt:new Date().toISOString()};fe.create("credits",h)}return{paiement:d,allocations:l,avance:s}}const uw={computeScheduleForEleve:cw,processPayment:Noe};function di(e){return e?e.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().replace(/[^a-z0-9 ]+/g,"").replace(/\s+/g," ").trim():""}function Eoe(e,t){if(e===t)return 0;const r=e.length,n=t.length;if(r===0)return n;if(n===0)return r;const a=new Array(n+1).fill(0),i=new Array(n+1).fill(0);for(let s=0;s<=n;s++)a[s]=s;for(let s=0;s<r;s++){i[0]=s+1;for(let l=0;l<n;l++){const f=e[s]===t[l]?0:1;i[l+1]=Math.min(i[l]+1,a[l+1]+1,a[l]+f)}for(let l=0;l<=n;l++)a[l]=i[l]}return i[n]}function w6(e,t,r,n){const a=di(t||""),i=di(r||"");if(!a)return null;const s=x=>{const g=fe.getById("classes",x.classeId)||{};return di(`${g.niveau||""} ${g.section||""}`.trim())};let l=e.find(x=>{const g=di(Bt(x)),y=di(O0(x)),v=s(x);return(!i||v.includes(i)||i.includes(v))&&(g===a||y===a)});if(l)return l;let f=e.find(x=>{const g=di(Bt(x)),y=di(O0(x));return g===a||y===a});if(f)return f;const d=a.split(" ").filter(Boolean),h=[];for(const x of e){const g=di(Bt(x)),y=di(O0(x)),v=s(x),b=!!i&&(v.includes(i)||i.includes(v)),E=g.split(" ").filter(Boolean),N=d.filter(C=>E.includes(C)).length,S=g.includes(a)||a.includes(g)||y.includes(a)||a.includes(y);let j=0;try{const C=[String(x.telephone||""),String(x.pereTuteur||""),String(x.mereTutrice||"")].join(" "),P=(n||"").replace(/\D/g,"");P&&P.length>=6&&C.replace(/\D/g,"").includes(P)&&(j=5)}catch{}let T=N*2+(S?3:0)+j+(b?4:0);N>=Math.max(1,Math.floor(d.length*.6))&&(T+=2),h.push({e:x,score:T,classMatch:b})}if(h.sort((x,g)=>g.score-x.score),h.length>0&&h[0].score>3)return h[0].e;let m={};for(const x of e){const g=di(Bt(x)),y=Eoe(a,g);(m.d===void 0||y<m.d)&&(m={e:x,d:y})}if(m.e&&m.d!==void 0){const x=Math.max(1,a.length);if(m.d<=Math.max(1,Math.floor(x*.3)))return m.e}return null}async function _oe(e,t){return new Promise((r,n)=>{const a=new FileReader;a.onload=i=>{try{const s=i.target?.result,l=il(s,{type:typeof s=="string"?"binary":"array"}),f=l.SheetNames[0],d=l.Sheets[f],h=bi.sheet_to_json(d,{header:1});if(!h||h.length===0){n("Fichier Excel vide ou illisible");return}const m=h[0].map(N=>String(N||"").trim()),x=h.slice(1);if(!t){r({columns:m,preview:x.slice(0,5)});return}const g=t.matricule?m.findIndex(N=>N===t.matricule):-1,y=t.nom?m.findIndex(N=>N===t.nom):-1,v=t.prenoms?m.findIndex(N=>N===t.prenoms):-1,b=t.nomPrenoms?m.findIndex(N=>N===t.nomPrenoms):-1,E=x.map(N=>{let S="",j="";if(b!==-1){const C=String(N[b]||"").trim().split(" ");S=C[0]||"",j=C.slice(1).join(" ")}else S=y!==-1?String(N[y]||"").trim():"",j=v!==-1?String(N[v]||"").trim():"";return{id:"",matricule:g!==-1?String(N[g]||"").trim():"",nom:S,prenoms:j,sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:"",anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:"",adresse:"",photo:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}});r(E)}catch(s){n(s instanceof Error?s.message:String(s))}},a.onerror=()=>n("Erreur lecture du fichier"),a.readAsArrayBuffer(e)})}async function koe(e){const t=[["Matricule","Nom & Prnoms","Moyenne"],...e.map(i=>[i.matricule,`${i.nom} ${i.prenoms}`,""])],r=bi.aoa_to_sheet(t),n=bi.book_new();return bi.book_append_sheet(n,r,"lves"),g6(n,{bookType:"xlsx",type:"array"})}async function joe(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const i=a.target?.result,s=il(i,{type:typeof i=="string"?"binary":"array"}),l=s.SheetNames[0],f=s.Sheets[l],d=bi.sheet_to_json(f,{header:1});if(!d||d.length===0){r("Fichier Excel vide ou illisible");return}const h=d[0].map(C=>String(C||"").trim()),m=d.slice(1),x=h.findIndex(C=>/nom/i.test(C)&&/pr/i.test(C)||/nom\s*&\s*pr/i.test(C)),g=h.findIndex(C=>/classe/i.test(C)),y=h.findIndex(C=>/contact|tel/i.test(C)),v=["inscription","octobre","novembre","dcembre","decembre","janvier","fvrier","fevrier","mars","avril","mai","juin","juillet","aot","aout","septembre"],b=[];let S=h.map(C=>String(C||"").toLowerCase()).some(C=>C.includes("inscription"))?2:1;h.forEach((C,P)=>{const M=String(C||"").toLowerCase();v.some(D=>M.includes(D))&&(M.includes("inscription")?b.push({idx:P,name:String(C),modalite:1}):(b.push({idx:P,name:String(C),modalite:S}),S++))});const j=[],T=[];for(let C=0;C<m.length;C++){const P=m[C],M=String(P[x]||"").trim(),D=String(P[g]||"").trim(),W=y>=0?String(P[y]||"").trim():"",F=fe.getAll("eleves");let L=w6(F,M,D,W);if(!L){T.push({row:C+2,name:M,classe:D,contact:W});continue}for(const J of b){const se=P[J.idx];if(!se&&se!==0)continue;const Z=String(se).replace(/[^0-9]/g,"");if(!Z)continue;const he=Number(Z);if(!he||isNaN(he)||he<=0)continue;let de=new Date().toISOString();const Q=String(J.name||"").toLowerCase(),pe={janvier:1,fevrier:2,fvrier:2,mars:3,avril:4,mai:5,juin:6,juillet:7,aot:8,aout:8,septembre:9,octobre:10,novembre:11,dcembre:12,decembre:12};for(const O in pe)if(Q.includes(O)){const V=new Date().getFullYear(),H=pe[O];de=new Date(V,H-1,1).toISOString();break}const re=J.modalite||null;try{uw.processPayment(L.id,he,de,{source:"import",note:`Import ${J.name}`,modalite:re,pereTelephone:W}),j.push({row:C+2,eleveId:L.id,eleveName:Bt(L),month:J.name,modalite:re,montant:he})}catch{T.push({row:C+2,name:M,classe:D,contact:W})}}}t({applied:j,unresolved:T})}catch(i){r(i instanceof Error?i.message:String(i))}},n.onerror=()=>r("Erreur lecture du fichier"),n.readAsArrayBuffer(e)})}async function Coe(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const i=a.target?.result,s=il(i,{type:typeof i=="string"?"binary":"array"}),l=s.SheetNames[0],f=s.Sheets[l],d=bi.sheet_to_json(f,{header:1});if(!d||d.length===0)return t({proposals:[],unresolved:[]});const h=d[0].map(C=>String(C||"").trim()),m=d.slice(1),x=h.findIndex(C=>/nom/i.test(C)&&/pr/i.test(C)||/nom\s*&\s*pr/i.test(C)),g=h.findIndex(C=>/classe/i.test(C)),y=h.findIndex(C=>/contact|tel/i.test(C)),v=["inscription","octobre","novembre","dcembre","decembre","janvier","fvrier","fevrier","mars","avril","mai","juin","juillet","aot","aout","septembre"],b=[];let S=h.map(C=>String(C||"").toLowerCase()).some(C=>C.includes("inscription"))?2:1;h.forEach((C,P)=>{const M=String(C||"").toLowerCase();v.some(D=>M.includes(D))&&(M.includes("inscription")?b.push({idx:P,name:String(C),modalite:1}):(b.push({idx:P,name:String(C),modalite:S}),S++))});const j=[],T=[];for(let C=0;C<m.length;C++){const P=m[C],M=String(P[x]||"").trim(),D=String(P[g]||"").trim(),W=y>=0?String(P[y]||"").trim():"",F=fe.getAll("eleves"),L=w6(F,M,D,W);for(const J of b){const se=P[J.idx];if(!se&&se!==0)continue;const Z=String(se).replace(/[^0-9]/g,"");if(!Z)continue;const he=Number(Z);!he||isNaN(he)||he<=0||j.push({row:C+2,name:M,classe:D,contact:W,month:J.name,montant:he,modalite:J.modalite,match:L?{id:L.id,name:Bt(L)}:null})}L||T.push({row:C+2,name:M,classe:D,contact:W})}t({proposals:j,unresolved:T})}catch(i){r(i instanceof Error?i.message:String(i))}},n.onerror=()=>r("Erreur lecture du fichier"),n.readAsArrayBuffer(e)})}async function Aoe(e){const t=[],r=[];for(const n of e){if(!n.match||!n.match.id){r.push(n);continue}let i=new Date().toISOString();const s=String(n.month||"").toLowerCase(),l={janvier:1,fevrier:2,fvrier:2,mars:3,avril:4,mai:5,juin:6,juillet:7,aot:8,aout:8,septembre:9,octobre:10,novembre:11,dcembre:12,decembre:12};for(const f in l)if(s.includes(f)){const d=new Date().getFullYear(),h=l[f];i=new Date(d,h-1,1).toISOString();break}try{const f={source:"import",note:`Import ${n.month}`};typeof n.modalite<"u"&&(f.modalite=n.modalite),n.contact&&(f.pereTelephone=n.contact),uw.processPayment(n.match.id,n.montant,i,f),t.push({row:n.row,eleveId:n.match.id,month:n.month,montant:n.montant})}catch{r.push(n)}}return{applied:t,unresolved:r}}function Toe(e){const t=String(e||"").trim();if(!t)return{niveau:"",section:""};const r=t.match(/^([A-Z]+\s*\d*)\s*([A-Z]?)$/i);if(r){const a=r[1].replace(/\s+/g,"").toUpperCase(),i=r[2]||"A";return{niveau:a,section:i.toUpperCase()}}const n=t.split(/\s+/);if(n.length>=2){const a=n[n.length-1];return{niveau:n.slice(0,-1).join("").toUpperCase(),section:a.toUpperCase()}}return{niveau:t.toUpperCase(),section:"A"}}function Poe(e,t,r){const a=fe.getAll("classes").find(s=>s.niveau===e&&s.section===t&&s.anneeScolaire===r);return a?a.id:fe.create("classes",{niveau:e,section:t,anneeScolaire:r,enseignantPrincipal:"",effectifMax:40,salle:"",matieres:[]}).id}function Ooe(e){return e?String(e).replace(/[^\d+]/g,"").trim():""}function Foe(e,t,r,n){if(t<0)return!1;const a=String(e[t]||"").toLowerCase().trim();if((a.includes("sold")||a.includes("solde"))&&r>=0&&n>=0){const i=Number(String(e[r]||"0").replace(/[^0-9]/g,""))||0,s=Number(String(e[n]||"0").replace(/[^0-9]/g,""))||0;if(i>0&&s>0&&i<s*.5)return!0}return!1}function Ri(e,t){const r=e.map(n=>n.toLowerCase().trim().replace(/\s+/g," "));for(let n=0;n<r.length;n++)for(const a of t)if(r[n]===a.toLowerCase())return{index:n,confidence:100,matchedHeader:e[n]};for(let n=0;n<r.length;n++)for(const a of t){const i=a.toLowerCase();if(r[n].includes(i)||i.includes(r[n]))return{index:n,confidence:80,matchedHeader:e[n]}}for(let n=0;n<r.length;n++){const a=r[n].split(/[\s&]+/);for(const i of t){const s=i.toLowerCase().split(/[\s&]+/);if(s.filter(f=>a.some(d=>d.includes(f)||f.includes(d))).length>=Math.ceil(s.length*.6))return{index:n,confidence:60,matchedHeader:e[n]}}}return{index:-1,confidence:0,matchedHeader:""}}async function $h(e,t){return new Promise((r,n)=>{const a=new FileReader;a.onload=i=>{try{const s=i.target?.result,l=il(s,{type:typeof s=="string"?"binary":"array",cellDates:!0,cellNF:!1,cellText:!1}),f=l.SheetNames;console.log(" Feuilles disponibles:",f);const d=t||l.SheetNames[0];console.log(" Feuille slectionne:",d);const h=l.Sheets[d],m=bi.decode_range(h["!ref"]||"A1");console.log(" Plage du fichier:",h["!ref"],"Range:",m);const x=[];for(let re=m.s.c;re<=m.e.c;re++){const O=bi.encode_cell({r:m.s.r,c:re}),V=h[O];V&&V.v!==void 0&&V.v!==null?x.push(String(V.v).trim()):x.push(`Colonne ${re+1}`)}console.log(" En-ttes extraits (mthode directe):",x),console.log(" Nombre total de colonnes:",x.length);const g=bi.sheet_to_json(h,{header:1,defval:"",raw:!1,range:m.s.r});if(!g||g.length===0){n("Fichier Excel vide ou illisible");return}console.log(" Premire ligne via sheet_to_json:",g[0]),console.log(" Comparaison - Direct:",x.length,"vs JSON:",g[0]?.length);const y=g.slice(1,6),v=["nom & prnoms","nom & prenoms","nom et prnoms","nom et prenoms","nom&prnoms","nom&prenoms","noms & prnoms","nom prenom","nom prenoms","nom complet","full name","eleve","lve"],b=["nom","noms","name","lastname","surname"],E=["prnom","prenom","prnoms","prenoms","firstname","given name"],N=["classe","class","niveau","grade"],S=["contact","tel","tlphone","telephone","phone","portable","mobile"],j=["protg","protege","protg ?","protege ?","protected"],T=["statut","status","tat","etat"],C=["total pay","total paye","montant pay","montant paye","paid"],P=["montant d","montant du","montant  payer","scolarit","scolarite","amount due"],M=Ri(x,v),D=Ri(x,b),W=Ri(x,E),F=Ri(x,N),L=Ri(x,S),J=Ri(x,j),se=Ri(x,T),Z=Ri(x,C),he=Ri(x,P),le={classe:F.index};M.index>=0&&M.confidence>=60?le.nomPrenomsCombined=M.index:D.index>=0&&W.index>=0?(le.nom=D.index,le.prenoms=W.index):D.index>=0&&(le.nomPrenomsCombined=D.index),L.index>=0&&(le.contact=L.index),J.index>=0&&(le.protege=J.index),se.index>=0&&(le.statut=se.index),Z.index>=0&&(le.totalPaye=Z.index),he.index>=0&&(le.montantDu=he.index);const de=M.confidence>0?M.confidence:D.confidence>0&&W.confidence>0?Math.min(D.confidence,W.confidence):D.confidence,Q=Math.round((de+F.confidence)/2),pe=[{column:"Nom & Prnoms (combin)",detectedIndex:M.index,detectedName:M.matchedHeader,confidence:M.confidence},{column:"Nom (spar)",detectedIndex:D.index,detectedName:D.matchedHeader,confidence:D.confidence},{column:"Prnoms (spar)",detectedIndex:W.index,detectedName:W.matchedHeader,confidence:W.confidence},{column:"Classe",detectedIndex:F.index,detectedName:F.matchedHeader,confidence:F.confidence},{column:"Contact",detectedIndex:L.index,detectedName:L.matchedHeader,confidence:L.confidence},{column:"Protg ?",detectedIndex:J.index,detectedName:J.matchedHeader,confidence:J.confidence}].filter(re=>re.detectedIndex>=0);r({headers:x,detectedMapping:le,confidence:{nom:de,classe:F.confidence,overall:Q},preview:y,suggestions:pe,sheets:f,selectedSheet:d})}catch(s){n(s instanceof Error?s.message:String(s))}},a.onerror=()=>n("Erreur lecture du fichier"),a.readAsArrayBuffer(e)})}async function S6(e,t){return new Promise(async(r,n)=>{if(!t)try{const i=await $h(e);if(console.log(" Analyse du fichier Excel:",i),i.confidence.overall<80){r({needsValidation:!0,analysis:i});return}t=i.detectedMapping,console.log(" Mapping automatique utilis:",t)}catch(i){n(i instanceof Error?i.message:String(i));return}const a=new FileReader;a.onload=i=>{try{const s=i.target?.result,l=il(s,{type:typeof s=="string"?"binary":"array"}),f=l.SheetNames[0],d=l.Sheets[f],h=bi.sheet_to_json(d,{header:1});if(!h||h.length===0){n("Fichier Excel vide ou illisible");return}const m=h[0].map(se=>String(se||"").trim()),x=h.slice(1);if(!t){n("Mapping des colonnes non disponible");return}const g=t.nomPrenomsCombined??-1,y=t.nom??-1,v=t.prenoms??-1,b=t.classe,E=t.contact??-1,N=t.protege??-1,S=t.statut??-1,j=t.totalPaye??-1,T=t.montantDu??-1;console.log(" Colonnes utilises:",{nameIdx:g,nomIdx:y,prenomsIdx:v,classeIdx:b,contactIdx:E,protegeIdx:N,statutIdx:S,totalPayeIdx:j,montantScolariteIdx:T});const C=["inscription","octobre","novembre","dcembre","decembre","janvier","fvrier","fevrier","mars","avril","mai","juin","juillet","aot","aout","septembre"],P=[];let W=m.map(se=>se.toLowerCase().trim()).some(se=>se.includes("inscription"))?2:1;if(m.forEach((se,Z)=>{const he=String(se||"").toLowerCase();C.some(le=>he.includes(le))&&(he.includes("inscription")?P.push({idx:Z,name:String(se),modalite:1}):(P.push({idx:Z,name:String(se),modalite:W}),W++))}),console.log(" Colonnes de paiements dtectes:",P),g<0&&y<0){n('Colonne "Nom" ou "Nom & Prnoms" non trouve dans le fichier. Colonnes disponibles: '+m.join(", "));return}if(b<0){n('Colonne "Classe" non trouve dans le fichier. Colonnes disponibles: '+m.join(", "));return}const L=fe.getAll("ecole")[0]?.anneeScolaireActive||`${new Date().getFullYear()}-${new Date().getFullYear()+1}`,J={elevesCreated:[],classesCreated:[],paiementsApplied:[],errors:[]};for(let se=0;se<x.length;se++){const Z=x[se];try{let he="",le="",de="";if(g>=0){de=String(Z[g]||"").trim();const G=de.split(" ");he=G[0]||"",le=G.slice(1).join(" ")||""}else if(y>=0&&v>=0)he=String(Z[y]||"").trim(),le=String(Z[v]||"").trim(),de=`${he} ${le}`.trim();else if(y>=0){de=String(Z[y]||"").trim();const G=de.split(" ");he=G[0]||"",le=G.slice(1).join(" ")||""}const Q=String(Z[b]||"").trim(),pe=E>=0?String(Z[E]||"").trim():"";if(!he||!Q)continue;if(!he){J.errors.push({row:se+2,error:"Nom invalide",name:de});continue}console.log(` Traitement ligne ${se+2}: ${he} ${le} - ${Q}`);const{niveau:re,section:O}=Toe(Q);if(!re){J.errors.push({row:se+2,error:"Classe invalide",name:de});continue}const V=Poe(re,O,L);!fe.getAll("classes").some(G=>G.id===V&&G.createdAt!==G.updatedAt)&&J.classesCreated.push({niveau:re,section:O});let q=!1;if(N>=0){const G=String(Z[N]||"").toLowerCase().trim();q=G==="oui"||G==="yes"||G==="o"}else q=Foe(Z,S,j,T);const K=Ooe(pe),ie=fe.create("eleves",{nom:he.toUpperCase(),prenoms:le,matricule:fe.generateMatricule(),sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:V,anneeEntree:L.split("-")[0],statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:K,adresse:"",photo:"",protege:q});J.elevesCreated.push({nom:ie.nom,prenoms:ie.prenoms,classe:`${re} ${O}`,matricule:ie.matricule,protege:q});let B=0;const z=[];for(const G of P){const ce=Z[G.idx];if(!ce&&ce!==0)continue;const I=String(ce).replace(/[^0-9]/g,"");if(!I)continue;const Ae=Number(I);if(!Ae||isNaN(Ae)||Ae<=0||q&&G.modalite!==1)continue;let Le=new Date().toISOString();const Ue=String(G.name||"").toLowerCase(),Pe={janvier:1,fevrier:2,fvrier:2,mars:3,avril:4,mai:5,juin:6,juillet:7,aot:8,aout:8,septembre:9,octobre:10,novembre:11,dcembre:12,decembre:12};for(const lt in Pe)if(Ue.includes(lt)){const kt=parseInt(L.split("-")[0]),Yt=Pe[lt],jt=Yt>=9?kt:kt+1;Le=new Date(jt,Yt-1,1).toISOString();break}try{const lt={source:"import",note:`Import ${G.name}`,modalite:G.modalite,pereTelephone:K,typeFrais:G.modalite===1?"inscription":"scolarite",modePaiement:"Espces",numeroRecu:`IMP-${ie.matricule}-${G.modalite}`,operateur:"Systme"};uw.processPayment(ie.id,Ae,Le,lt),B+=Ae,z.push(`${G.name}: ${Ae} FCFA`)}catch(lt){J.errors.push({row:se+2,error:`Erreur paiement ${G.name}: ${lt instanceof Error?lt.message:String(lt)}`,name:de})}}B>0&&J.paiementsApplied.push({eleveName:`${ie.nom} ${ie.prenoms}`,totalAmount:B,details:z.join(", ")})}catch(he){J.errors.push({row:se+2,error:he instanceof Error?he.message:String(he),name:Z[g]?String(Z[g]):"Inconnu"})}}r(J)}catch(s){n(s instanceof Error?s.message:String(s))}},a.onerror=()=>n("Erreur lecture du fichier"),a.readAsArrayBuffer(e)})}const Fu=Object.freeze(Object.defineProperty({__proto__:null,analyzeExcelStructure:$h,applyPaiementsDepuisProposals:Aoe,exporterElevesEnExcel:koe,importerElevesDepuisExcel:_oe,importerElevesEtPaiementsComplet:S6,importerPaiementsDepuisExcel:joe,previewImporterPaiementsDepuisExcel:Coe},Symbol.toStringTag,{value:"Module"}));function Doe(){const[e,t]=k.useState(null),[r,n]=k.useState(!1),[a,i]=k.useState(null),[s,l]=k.useState(""),[f,d]=k.useState(null),[h,m]=k.useState(!1),[x,g]=k.useState(null),[y,v]=k.useState(""),b=async T=>{const C=T.target.files?.[0];if(C){t(C),i(null),l(""),d(null),m(!1),g(null),v(""),n(!0);try{const P=await $h(C);d(P),v(P.selectedSheet),console.log(" Analyse automatique:",P),P.confidence.overall<80&&(m(!0),g(P.detectedMapping))}catch(P){l(P instanceof Error?P.message:String(P))}finally{n(!1)}}},E=async T=>{if(e){v(T),n(!0),l("");try{const C=await $h(e,T);d(C),g(C.detectedMapping),console.log(" Analyse de la feuille:",T,C),C.confidence.overall<80?m(!0):m(!1)}catch(C){l(C instanceof Error?C.message:String(C))}finally{n(!1)}}},N=async()=>{if(!e){l("Veuillez slectionner un fichier");return}n(!0),l(""),i(null);try{const T=await S6(e,x||void 0);if(T.needsValidation){d(T.analysis),m(!0),g(T.analysis.detectedMapping),n(!1);return}i(T),T.elevesCreated.length>0&&setTimeout(()=>{window.dispatchEvent(new CustomEvent("dataChanged"))},1e3)}catch(T){l(T instanceof Error?T.message:String(T))}finally{n(!1)}},S=(T,C)=>{g(P=>({...P,[T]:C>=0?C:void 0}))},j=()=>{m(!1)};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Importation Complte (lves + Paiements)"}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:" Format du fichier Excel requis:"}),o.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 ml-4",children:[o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Nom & Prnoms"}),": Nom complet de l'lve"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Classe"}),": Classe de l'lve (ex: CP1 A, CE2 B)"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Contact"}),": Numro de tlphone du parent (pre par dfaut)"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Colonnes de mois"}),": Inscription, Octobre, Novembre, Dcembre, etc."]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Statut"}),": Pour dtecter les lves protgs (optionnel)"]})]})]}),o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[o.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:" Fonctionnalits intelligentes:"}),o.jsxs("ul",{className:"text-sm text-green-800 space-y-1 ml-4",children:[o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Cration automatique des classes"}),' base sur la colonne "Classe"']}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Dtection des lves protgs"})," (ne paient que l'inscription)"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Allocation intelligente des paiements"})," sur les chances"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Gestion des paiements excdentaires"})," (report automatique)"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"Importation des contacts parents"})," (insensible  la casse)"]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slectionner le fichier Excel"}),o.jsx("div",{className:"flex items-center space-x-4",children:o.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:b,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})}),e&&o.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Fichier slectionn: ",o.jsx("strong",{children:e.name})]})]}),f&&f.sheets.length>1&&o.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-purple-900 mb-2",children:" Slection de la feuille"}),o.jsx("p",{className:"text-sm text-purple-800 mb-3",children:"Votre fichier contient plusieurs feuilles. Slectionnez celle qui contient les donnes  importer :"}),o.jsx("select",{value:y,onChange:T=>E(T.target.value),className:"w-full border border-purple-300 rounded-md px-3 py-2 text-sm bg-white",children:f.sheets.map((T,C)=>o.jsx("option",{value:T,children:T},C))})]}),f&&!h&&o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:" Colonnes dtectes automatiquement"}),o.jsx("div",{className:"text-sm text-green-800 space-y-1",children:f.suggestions.map((T,C)=>o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("span",{children:[T.column,":"]}),o.jsxs("span",{className:"font-medium",children:[T.detectedName," (",T.confidence,"% confiance)"]})]},C))}),o.jsxs("button",{onClick:()=>m(!0),className:"mt-3 text-sm text-green-700 hover:text-green-900 underline flex items-center space-x-1",children:[o.jsx($0,{className:"w-4 h-4"}),o.jsx("span",{children:"Modifier le mapping"})]})]}),h&&f&&x&&o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[o.jsxs("h4",{className:"font-semibold text-yellow-900 mb-3 flex items-center space-x-2",children:[o.jsx($0,{className:"w-5 h-5"}),o.jsx("span",{children:"Configuration du mapping des colonnes"})]}),o.jsx("p",{className:"text-sm text-yellow-800 mb-4",children:"Slectionnez les colonnes correspondantes dans votre fichier Excel :"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom & Prnoms (combin) - Optionnel si colonnes spares"}),o.jsxs("select",{value:x.nomPrenomsCombined??-1,onChange:T=>S("nomPrenomsCombined",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,C)=>o.jsx("option",{value:C,children:T},C))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom (spar) - Optionnel si colonne combine"}),o.jsxs("select",{value:x.nom??-1,onChange:T=>S("nom",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,C)=>o.jsx("option",{value:C,children:T},C))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prnoms (spar) - Optionnel si colonne combine"}),o.jsxs("select",{value:x.prenoms??-1,onChange:T=>S("prenoms",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,C)=>o.jsx("option",{value:C,children:T},C))]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Classe ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("select",{value:x.classe,onChange:T=>S("classe",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:f.headers.map((T,C)=>o.jsx("option",{value:C,children:T},C))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact / Tlphone - Optionnel"}),o.jsxs("select",{value:x.contact??-1,onChange:T=>S("contact",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,C)=>o.jsx("option",{value:C,children:T},C))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Protg ? - Optionnel"}),o.jsxs("select",{value:x.protege??-1,onChange:T=>S("protege",parseInt(T.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:-1,children:"-- Non utilis --"}),f.headers.map((T,C)=>o.jsx("option",{value:C,children:T},C))]})]})]}),o.jsx("button",{onClick:j,className:"mt-4 w-full bg-yellow-600 text-white py-2 px-4 rounded-lg hover:bg-yellow-700 transition-colors",children:"Confirmer le mapping"})]}),o.jsx("button",{onClick:N,disabled:!e||r||h,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2 transition-colors",children:r?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),o.jsx("span",{children:"Analyse en cours..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Hs,{className:"w-5 h-5"}),o.jsx("span",{children:"Lancer l'importation"})]})})]}),s&&o.jsxs("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[o.jsx(Uh,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-red-900",children:"Erreur d'importation"}),o.jsx("p",{className:"text-sm text-red-800 mt-1",children:s})]})]})]}),a&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center space-x-2",children:[o.jsx(In,{className:"w-6 h-6 text-green-600"}),o.jsx("span",{children:"Rsum de l'importation"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Qi,{className:"w-8 h-8 text-blue-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-blue-900",children:a.elevesCreated.length}),o.jsx("p",{className:"text-sm text-blue-700",children:"lves imports"})]})]})}),o.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Yi,{className:"w-8 h-8 text-green-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-green-900",children:a.classesCreated.length}),o.jsx("p",{className:"text-sm text-green-700",children:"Classes cres"})]})]})}),o.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ji,{className:"w-8 h-8 text-purple-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-purple-900",children:a.paiementsApplied.length}),o.jsx("p",{className:"text-sm text-purple-700",children:"Paiements traits"})]})]})})]})]}),a.classesCreated.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Classes cres automatiquement"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:a.classesCreated.map((T,C)=>o.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:[T.niveau," ",T.section]},C))})]}),a.elevesCreated.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"lves imports"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Matricule"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nom & Prnoms"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Classe"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.elevesCreated.map((T,C)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:T.matricule}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[T.nom," ",T.prenoms]}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:T.classe}),o.jsx("td",{className:"px-4 py-3 text-sm",children:T.protege?o.jsx("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs font-medium",children:"Protg"}):o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:"Normal"})})]},C))})]})})]}),a.paiementsApplied.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Paiements traits"}),o.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:a.paiementsApplied.map((T,C)=>o.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:T.eleveName}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:T.details})]}),o.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold",children:[T.totalAmount.toLocaleString()," FCFA"]})]})},C))})]}),a.errors.length>0&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsxs("h4",{className:"font-semibold text-red-800 mb-3 flex items-center space-x-2",children:[o.jsx(uc,{className:"w-5 h-5"}),o.jsxs("span",{children:["Erreurs rencontres (",a.errors.length,")"]})]}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.errors.map((T,C)=>o.jsx("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200",children:o.jsxs("p",{className:"text-sm text-red-900",children:[o.jsxs("strong",{children:["Ligne ",T.row]}),T.name&&o.jsxs("span",{children:[" - ",T.name]}),": ",T.error]})},C))})]})]})]})}function Ioe(){const{showToast:e}=Jr(),[t,r]=k.useState(null),[n,a]=k.useState(0),i=k.useMemo(()=>{const d=[],h=fe.getAll("classes");h.forEach(N=>{(!N.niveau||N.niveau.trim()==="")&&d.push({id:`classe_niveau_${N.id}`,type:"classe_sans_niveau",severity:"error",title:`Classe "${N.nom}" sans niveau`,description:`La classe ${N.nom} (${N.section}) n'a pas de niveau dfini. Cela empche la configuration des frais scolaires.`,affectedItem:N,fixable:!1})});const m=fe.getAll("eleves"),x=new Set(h.map(N=>N.id));m.forEach(N=>{(!N.classeId||!x.has(N.classeId))&&d.push({id:`eleve_classe_${N.id}`,type:"eleve_sans_classe",severity:"error",title:`lve "${N.nom} ${N.prenoms}" sans classe valide`,description:`L'lve n'est pas assign  une classe existante. Matricule: ${N.matricule}`,affectedItem:N,fixable:!1})});const g=fe.getAll("fraisScolaires"),y=new Set(g.map(N=>N.niveau));new Set(h.map(N=>N.niveau).filter(Boolean)).forEach(N=>{y.has(N)||d.push({id:`frais_niveau_${N}`,type:"montant_manquant",severity:"warning",title:`Aucun frais configur pour le niveau "${N}"`,description:`Le niveau ${N} n'a pas de configuration de frais scolaires. Les lves de ce niveau ne pourront pas effectuer de paiements.`,affectedItem:{niveau:N},fixable:!0})});const b=fe.getAll("matieres"),E=new Set;return h.forEach(N=>{N.matieres&&Array.isArray(N.matieres)&&N.matieres.forEach(S=>{const j=typeof S=="string"?S:S?.id;j&&E.add(j)})}),b.forEach(N=>{E.has(N.id)||d.push({id:`matiere_orpheline_${N.id}`,type:"matiere_non_liee",severity:"warning",title:`Matire "${N.nom}" non utilise`,description:`La matire "${N.nom}" n'est assigne  aucune classe.`,affectedItem:N,fixable:!1})}),d},[n]),s=async d=>{r(d.id);try{if(d.type==="montant_manquant"){const h=d.affectedItem.niveau,m={id:`frais_${Date.now()}`,niveau:h,anneeScolaire:new Date().getFullYear().toString(),inscription:35e3,scolarite:9e4,nombreVersements:9,montantParVersement:1e4};fe.create("fraisScolaires",m),e(`Configuration de frais cre pour le niveau ${h}`,"success")}else e("Cette correction ncessite une intervention manuelle","info");a(h=>h+1)}catch(h){console.error("Erreur lors de la correction:",h),e("Erreur lors de la correction","error")}finally{r(null)}},l=i.filter(d=>d.severity==="error").length,f=i.filter(d=>d.severity==="warning").length;return o.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Intgrit des Donnes"}),o.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Vrification automatique des problmes de cohrence des donnes"})]}),o.jsxs("button",{onClick:()=>a(d=>d+1),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[o.jsx(N1,{className:"w-4 h-4 mr-2"}),"Actualiser"]})]}),o.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(In,{className:"w-8 h-8 text-green-600 mr-3"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-green-900",children:i.length===0?"":`${i.length} problmes`}),o.jsx("div",{className:"text-sm text-green-700",children:i.length===0?"Aucun problme dtect":"Problmes trouvs"})]})]})}),o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(uc,{className:"w-8 h-8 text-red-600 mr-3"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-red-900",children:l}),o.jsx("div",{className:"text-sm text-red-700",children:"Erreurs critiques"})]})]})}),o.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(wi,{className:"w-8 h-8 text-orange-600 mr-3"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-orange-900",children:f}),o.jsx("div",{className:"text-sm text-orange-700",children:"Avertissements"})]})]})})]})]}),i.length===0?o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[o.jsx(In,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Aucun problme dtect"}),o.jsx("p",{className:"text-gray-600",children:"Toutes les donnes sont cohrentes et correctement configures."})]}):o.jsx("div",{className:"space-y-4",children:i.map(d=>o.jsx("div",{className:bt("bg-white rounded-lg shadow-sm p-6 border-l-4",d.severity==="error"?"border-red-500":"border-orange-500"),children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-start flex-1",children:[d.severity==="error"?o.jsx(uc,{className:"w-6 h-6 text-red-600 mr-3 flex-shrink-0 mt-0.5"}):o.jsx(wi,{className:"w-6 h-6 text-orange-600 mr-3 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d.title}),o.jsx("p",{className:"mt-1 text-sm text-gray-600",children:d.description}),d.fixable&&o.jsxs("div",{className:"mt-2 text-sm text-gray-500 flex items-center",children:[o.jsx(F5,{className:"w-4 h-4 mr-1"}),"Correction automatique disponible"]})]})]}),o.jsx("div",{className:"ml-4 flex-shrink-0",children:d.fixable?o.jsx("button",{onClick:()=>s(d),disabled:t===d.id,className:bt("px-4 py-2 rounded-md text-sm font-medium",t===d.id?"bg-gray-300 text-gray-600 cursor-wait":"bg-blue-600 text-white hover:bg-blue-700"),children:t===d.id?"Correction...":"Corriger"}):o.jsx("span",{className:"px-4 py-2 text-sm text-gray-500 italic",children:"Correction manuelle requise"})})]})},d.id))})]})}const Moe={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},Roe=(e,t,r)=>{let n;const a=Moe[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",String(t)),r?.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},Loe={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},Boe={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},$oe={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Uoe={date:ac({formats:Loe,defaultWidth:"full"}),time:ac({formats:Boe,defaultWidth:"full"}),dateTime:ac({formats:$oe,defaultWidth:"full"})},zoe={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},Woe=(e,t,r,n)=>zoe[e],Hoe={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},Voe={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},Goe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},Koe={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},qoe={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},Xoe=(e,t)=>{const r=Number(e),n=t?.unit;if(r===0)return"0";const a=["year","week","hour","minute","second"];let i;return r===1?i=n&&a.includes(n)?"re":"er":i="me",r+i},Yoe=["MMM","MMMM"],Joe={preprocessor:(e,t)=>e.getDate()===1||!t.some(n=>n.isToken&&Yoe.includes(n.value))?t:t.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:Xoe,era:pi({values:Hoe,defaultWidth:"wide"}),quarter:pi({values:Voe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:pi({values:Goe,defaultWidth:"wide"}),day:pi({values:Koe,defaultWidth:"wide"}),dayPeriod:pi({values:qoe,defaultWidth:"wide"})},Qoe=/^(\d+)(ime|re|me|er|e)?/i,Zoe=/\d+/i,ele={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},tle={any:[/^av/i,/^ap/i]},rle={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},nle={any:[/1/i,/2/i,/3/i,/4/i]},ale={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},ile={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},sle={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},ole={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},lle={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},cle={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},ule={ordinalNumber:oP({matchPattern:Qoe,parsePattern:Zoe,valueCallback:e=>parseInt(e)}),era:xi({matchPatterns:ele,defaultMatchWidth:"wide",parsePatterns:tle,defaultParseWidth:"any"}),quarter:xi({matchPatterns:rle,defaultMatchWidth:"wide",parsePatterns:nle,defaultParseWidth:"any",valueCallback:e=>e+1}),month:xi({matchPatterns:ale,defaultMatchWidth:"wide",parsePatterns:ile,defaultParseWidth:"any"}),day:xi({matchPatterns:sle,defaultMatchWidth:"wide",parsePatterns:ole,defaultParseWidth:"any"}),dayPeriod:xi({matchPatterns:lle,defaultMatchWidth:"any",parsePatterns:cle,defaultParseWidth:"any"})},y1={code:"fr",formatDistance:Roe,formatLong:Uoe,formatRelative:Woe,localize:Joe,match:ule,options:{weekStartsOn:1,firstWeekContainsDate:4}},dv="klasnet_audit_logs",fle=1e3;class cc{static log(t){const r=this.getLogs(),n={...t,id:`log_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now()};r.unshift(n);const a=r.slice(0,fle);localStorage.setItem(dv,JSON.stringify(a)),window.dispatchEvent(new CustomEvent("audit-log-updated"))}static getLogs(){try{const t=localStorage.getItem(dv);return t?JSON.parse(t):[]}catch(t){return console.error("Erreur lecture logs audit:",t),[]}}static clearLogs(){localStorage.removeItem(dv),window.dispatchEvent(new CustomEvent("audit-log-updated"))}static exportLogs(){const t=this.getLogs();return JSON.stringify(t,null,2)}}function dle(){const[e,t]=k.useState(""),[r,n]=k.useState("all"),[a,i]=k.useState("all"),[s,l]=k.useState(()=>cc.getLogs());on.useEffect(()=>{const g=()=>{l(cc.getLogs())};return window.addEventListener("audit-log-updated",g),()=>window.removeEventListener("audit-log-updated",g)},[]);const f=k.useMemo(()=>s.filter(g=>{if(r!=="all"&&g.type!==r||a!=="all"&&g.status!==a)return!1;if(e){const y=e.toLowerCase();return g.action.toLowerCase().includes(y)||g.user.toLowerCase().includes(y)||JSON.stringify(g.details).toLowerCase().includes(y)}return!0}),[s,e,r,a]),d=()=>{const g=cc.exportLogs(),y=new Blob([g],{type:"application/json"}),v=URL.createObjectURL(y),b=document.createElement("a");b.href=v,b.download=`audit-logs-${Kn(new Date,"yyyy-MM-dd-HHmm")}.json`,b.click(),URL.revokeObjectURL(v)},h=g=>({import:"Import",export:"Export",payment:"Paiement",note:"Note",delete:"Suppression",update:"Modification",create:"Cration"})[g]||g,m=g=>({import:"bg-blue-100 text-blue-800",export:"bg-green-100 text-green-800",payment:"bg-purple-100 text-purple-800",note:"bg-indigo-100 text-indigo-800",delete:"bg-red-100 text-red-800",update:"bg-orange-100 text-orange-800",create:"bg-teal-100 text-teal-800"})[g]||"bg-gray-100 text-gray-800",x=g=>({success:"text-green-600",error:"text-red-600",warning:"text-orange-600"})[g]||"text-gray-600";return o.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Journal d'Audit"}),o.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Historique de toutes les oprations effectues dans l'application"})]}),o.jsxs("button",{onClick:d,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[o.jsx(w1,{className:"w-4 h-4 mr-2"}),"Exporter"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(sl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher...",value:e,onChange:g=>t(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(L0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsxs("select",{value:r,onChange:g=>n(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 appearance-none",children:[o.jsx("option",{value:"all",children:"Tous les types"}),o.jsx("option",{value:"import",children:"Import"}),o.jsx("option",{value:"export",children:"Export"}),o.jsx("option",{value:"payment",children:"Paiement"}),o.jsx("option",{value:"note",children:"Note"}),o.jsx("option",{value:"create",children:"Cration"}),o.jsx("option",{value:"update",children:"Modification"}),o.jsx("option",{value:"delete",children:"Suppression"})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(L0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsxs("select",{value:a,onChange:g=>i(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 appearance-none",children:[o.jsx("option",{value:"all",children:"Tous les statuts"}),o.jsx("option",{value:"success",children:"Succs"}),o.jsx("option",{value:"error",children:"Erreur"}),o.jsx("option",{value:"warning",children:"Avertissement"})]})]})]}),o.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[f.length," entre(s) sur ",s.length," au total"]})]}),f.length===0?o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[o.jsx(R0,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Aucune entre trouve"}),o.jsx("p",{className:"text-gray-600",children:e||r!=="all"||a!=="all"?"Essayez de modifier vos filtres":"Les oprations seront enregistres ici"})]}):o.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:o.jsx("div",{className:"divide-y divide-gray-200",children:f.map(g=>o.jsx("div",{className:"p-4 hover:bg-gray-50",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("span",{className:bt("px-2 py-1 text-xs font-medium rounded-full",m(g.type)),children:h(g.type)}),o.jsxs("span",{className:bt("text-sm font-medium",x(g.status)),children:[g.status==="success"&&" Succs",g.status==="error"&&" Erreur",g.status==="warning"&&" Avertissement"]})]}),o.jsx("p",{className:"text-sm text-gray-900 font-medium",children:g.action}),Object.keys(g.details).length>0&&o.jsxs("details",{className:"mt-2",children:[o.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer hover:text-gray-700",children:"Voir les dtails"}),o.jsx("pre",{className:"mt-2 p-2 bg-gray-50 rounded text-xs overflow-x-auto",children:JSON.stringify(g.details,null,2)})]})]}),o.jsxs("div",{className:"ml-4 text-right flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-1",children:[o.jsx(zs,{className:"w-3 h-3 mr-1"}),Kn(new Date(g.timestamp),"dd MMM yyyy",{locale:y1})]}),o.jsx("div",{className:"text-xs text-gray-500",children:Kn(new Date(g.timestamp),"HH:mm:ss")}),o.jsx("div",{className:"text-xs text-gray-600 mt-1",children:g.user})]})]})},g.id))})})]})}const hle=[{id:"ecole",title:"Configuration cole",description:"Nom, logo, coordonnes de l'tablissement",icon:d4},{id:"frais",title:"Configuration Frais",description:"Modalits et chances de paiement par niveau",icon:Ji},{id:"compositions",title:"Configuration Compositions",description:"Priodes d'valuation et coefficients",icon:Yi},{id:"impression",title:"Configuration Impression",description:"Enttes, logos et mise en page des documents",icon:R0},{id:"import",title:"Importation Complte",description:"Importer lves, classes et paiements depuis Excel",icon:Hs},{id:"integrity",title:"Intgrit des Donnes",description:"Vrifier et corriger les problmes de donnes",icon:In},{id:"audit",title:"Journal d'Audit",description:"Historique des oprations et traabilit",icon:E5},{id:"backup",title:"Sauvegarde & Restauration",description:"Export, import et gestion des donnes",icon:S5},{id:"historique",title:"Historique des Actions",description:"Journal des modifications et oprations",icon:_5},{id:"licence",title:"Gestion des Licences",description:"Activation et statut de la licence logicielle",icon:v4},{id:"passage",title:"Passage d'anne scolaire",description:"Clturer l'anne en cours et prparer la nouvelle",icon:tc}];function mle(){const[e,t]=k.useState("menu"),r=()=>{switch(e){case"ecole":return o.jsx(S4,{});case"frais":return o.jsx(xX,{});case"compositions":return o.jsx(gX,{});case"impression":return o.jsx(vX,{});case"import":return o.jsx(Doe,{});case"integrity":return o.jsx(Ioe,{});case"audit":return o.jsx(dle,{});case"backup":return o.jsx(yX,{});case"historique":return o.jsx(bX,{});case"licence":return o.jsx(wX,{});case"passage":return o.jsx(NX,{});default:return o.jsx("div",{className:"p-4 sm:p-6 bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-6 sm:mb-8",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Configuration Systme"}),o.jsx("p",{className:"text-sm sm:text-base text-gray-600 mt-2",children:"Paramtres gnraux de votre cole"})]})}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:hle.map(n=>{const a=n.icon;return o.jsxs("button",{onClick:()=>t(n.id),className:"group bg-white rounded-lg border border-gray-200 p-4 sm:p-6 hover:border-gray-300 hover:shadow-sm transition-all text-left",children:[o.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gray-100 rounded-lg flex items-center justify-center mb-3 sm:mb-4 group-hover:bg-gray-200 transition-colors",children:o.jsx(a,{className:"h-5 w-5 sm:h-6 sm:w-6 text-gray-600"})}),o.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:n.title}),o.jsx("p",{className:"text-sm text-gray-600 mb-3 sm:mb-4 line-clamp-2",children:n.description}),o.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-gray-500 group-hover:text-gray-700 transition-colors",children:[o.jsx("span",{children:"Configurer"}),o.jsx("svg",{className:"ml-2 h-3 w-3 sm:h-4 sm:w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},n.id)})}),o.jsxs("div",{className:"mt-6 sm:mt-8 bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[o.jsxs("div",{className:"mb-4 sm:mb-6",children:[o.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Informations Systme"}),o.jsx("p",{className:"text-sm text-gray-600",children:"tat actuel de votre configuration"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"text-center p-4 sm:p-6 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:fe.getAll("eleves").length}),o.jsx("p",{className:"text-sm sm:text-base text-gray-600 font-medium",children:"lves"})]}),o.jsxs("div",{className:"text-center p-4 sm:p-6 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:fe.getAll("classes").length}),o.jsx("p",{className:"text-sm sm:text-base text-gray-600 font-medium",children:"Classes"})]}),o.jsxs("div",{className:"text-center p-4 sm:p-6 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:fe.getAll("matieres").length}),o.jsx("p",{className:"text-sm sm:text-base text-gray-600 font-medium",children:"Matires"})]})]})]})]})})}};return e!=="menu"?o.jsx("div",{className:"bg-gray-50 min-h-screen",children:o.jsxs("div",{className:"p-4 sm:p-6",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("button",{onClick:()=>t("menu"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors group",children:[o.jsx(M0,{className:"h-4 w-4 group-hover:-translate-x-1 transition-transform"}),o.jsx("span",{className:"font-medium",children:"Retour  la configuration"})]})}),r()]})}):o.jsx("div",{children:r()})}function ple({onCancel:e,onSubmit:t}){const r=fe.getAll("classes"),[n,a]=k.useState(""),[i,s]=k.useState(""),[l,f]=k.useState(!1),[d,h]=k.useState(""),[m,x]=k.useState("scolarite"),[g,y]=k.useState("auto"),[v,b]=k.useState("espece"),[E,N]=k.useState(""),{showToast:S}=Jr(),[j,T]=k.useState(!1),C=k.useRef({selectedClasse:n,eleveId:i,montant:d,type:m,modalite:g,mode:v,note:E}),P=k.useMemo(()=>{try{return JSON.stringify({selectedClasse:n,eleveId:i,montant:d,type:m,modalite:g,mode:v,note:E})!==JSON.stringify(C.current||{})}catch{return!1}},[n,i,d,m,g,v,E]),M=Nm(P),D="payment:draft",{load:W,clear:F}=Em(D,{selectedClasse:n,eleveId:i,montant:d,type:m,modalite:g,mode:v,note:E});useEffect(()=>{try{const Z=W();Z&&(a(Z.selectedClasse||""),s(Z.eleveId||""),h(Z.montant||""),x(Z.type||"scolarite"),y(Z.modalite||"auto"),b(Z.mode||"espece"),N(Z.note||""),C.current=Z)}catch{}},[]);const L=()=>"REC"+Date.now().toString().slice(-8),J=Z=>{s(Z);const he=fe.getById("eleves",Z);f(!!he?.protege);try{const de=cw(Z).find(Q=>Q.remaining>0);if(de){const Q=String(de.echeanceId).split("-"),pe=Q[Q.length-1],re=Number(pe);Number.isFinite(re)&&re>=1&&re<=7&&y(re)}}catch(le){console.debug("compute schedule failed",le)}},se=Z=>{a(Z);const he=fe.getAll("eleves").filter(le=>!Z||le.classeId===Z);he.length?J(he[0].id):s("")};return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 flex flex-col max-h-[90vh]",children:[o.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-100",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Nouveau Paiement"}),o.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-md transition-colors",onClick:()=>P&&M?M.openPrompt():e(),"aria-label":"Fermer",children:""})]}),o.jsxs("div",{className:"overflow-y-auto px-4 py-3 space-y-3 flex-1",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Classe"}),o.jsxs("select",{value:n,onChange:Z=>se(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"-- Toutes les classes --"}),r.map(Z=>o.jsxs("option",{value:Z.id,children:[Z.niveau," ",Z.section]},Z.id))]}),o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 mt-4",children:"lve"}),o.jsxs("select",{value:i,onChange:Z=>J(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",children:[o.jsx("option",{value:"",children:"-- Slectionner lve --"}),fe.getAll("eleves").filter(Z=>!n||Z.classeId===n).map(Z=>o.jsxs("option",{value:Z.id,children:[Z.nom," ",Z.prenoms," (",Z.matricule,")"]},Z.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant (FCFA)"}),o.jsx("input",{type:"number",value:d,onChange:Z=>h(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors text-lg font-bold",placeholder:"0"}),l&&o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"lve protg: montant libre, mais seule l'inscription sera prise en compte."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de frais"}),o.jsx("select",{value:m,onChange:Z=>x(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",disabled:l,children:l?o.jsx("option",{value:"inscription",children:"Inscription"}):o.jsxs(o.Fragment,{children:[o.jsx("option",{value:"scolarite",children:"Scolarit"}),o.jsx("option",{value:"inscription",children:"Inscription"}),o.jsx("option",{value:"cantine",children:"Cantine"}),o.jsx("option",{value:"transport",children:"Transport"}),o.jsx("option",{value:"fournitures",children:"Fournitures"})]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modalit de versement"}),o.jsx("select",{value:String(g),onChange:Z=>y(Z.target.value==="auto"?"auto":Number(Z.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors",disabled:l,children:l?o.jsx("option",{value:1,children:"1 - Inscription"}):o.jsxs(o.Fragment,{children:[o.jsx("option",{value:"auto",children:"Auto"}),o.jsx("option",{value:1,children:"1 - Inscription"}),o.jsx("option",{value:2,children:"2 - Versement 1"}),o.jsx("option",{value:3,children:"3 - Versement 2"}),o.jsx("option",{value:4,children:"4 - Versement 3"}),o.jsx("option",{value:5,children:"5 - Versement 4"}),o.jsx("option",{value:6,children:"6 - Versement 5"}),o.jsx("option",{value:7,children:"7 - Versement 6"})]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mode de paiement"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{value:"espece",label:"Espces"},{value:"mobile",label:"Mobile Money"},{value:"cheque",label:"Chque"},{value:"virement",label:"Virement"}].map(Z=>o.jsxs("label",{className:`flex items-center justify-center p-2 border rounded-md cursor-pointer transition-all ${v===Z.value?"border-gray-900 bg-gray-50 text-gray-900":"border-gray-300 hover:border-gray-400"}`,children:[o.jsx("input",{type:"radio",name:"mode",value:Z.value,checked:v===Z.value,onChange:he=>b(he.target.value),className:"sr-only"}),o.jsx("span",{className:"font-medium text-sm",children:Z.label})]},Z.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note ou commentaire (optionnel)"}),o.jsx("textarea",{value:E,onChange:Z=>N(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-colors resize-none",rows:3,placeholder:"Commentaire sur ce paiement..."})]})]}),o.jsxs("div",{className:"px-4 py-3 border-t bg-white flex flex-col sm:flex-row justify-end gap-2 lg:gap-4",children:[o.jsx(Ft,{variant:"secondary",className:"w-full sm:w-auto",onClick:()=>P&&M?M.openPrompt():e(),disabled:j,children:"Annuler"}),o.jsxs(Ft,{variant:"primary",className:"w-full sm:w-auto",onClick:async()=>{if(!i){S("Slectionnez un lve","error");return}const Z=Number(d||0);if(!Z||Z<=0){S("Montant invalide","error");return}T(!0);const he=L();try{const le={mode:v,note:E,numeroRecu:he,type:m,modalite:g};try{const{getCurrentUser:Q}=await yn(async()=>{const{getCurrentUser:re}=await Promise.resolve().then(()=>GS);return{getCurrentUser:re}},void 0,import.meta.url),pe=Q();pe&&(le.utilisateur=Bt(pe))}catch(Q){console.debug("getCurrentUser failed",Q)}const de=ff.processPaymentIntelligent(i,Z,new Date().toISOString(),le);try{const Q=(await yn(async()=>{const{getCurrentUser:re}=await Promise.resolve().then(()=>GS);return{getCurrentUser:re}},void 0,import.meta.url)).getCurrentUser(),pe=de&&de.paiement&&de.paiement.id?String(de.paiement.id):void 0;fe.addHistorique({type:"paiement",cible:"Paiement",cibleId:pe,description:`Paiement de ${Z} FCFA pour lve ${i} (reu ${le.numeroRecu})`,utilisateur:Q?`${Q.prenoms} ${Q.nom}`:"Inconnu"})}catch(Q){console.debug("historique skip:",Q)}try{const Q=fe.getById("eleves",i),pe=Q?Bt(Q):"",re=`
                      <html><head><title>Reu ${le.numeroRecu}</title></head><body>
                        <h2>Reu de paiement</h2>
                        <div>Reu: ${le.numeroRecu}</div>
                        <div>lve: ${pe} (${Q?.matricule||""})</div>
                        <div>Montant: ${Z} FCFA</div>
                        <div>Mode: ${le.mode}</div>
                        <div>Date: ${new Date().toLocaleString()}</div>
                      </body></html>`,O=window.open("","_blank","width=600,height=800");O&&(O.document.write(re),O.document.close(),setTimeout(()=>{try{O.print()}catch(V){console.debug("print failed",V)}},300))}catch(Q){console.debug("preview failed",Q)}try{t(i,Z,m,g,de.paiement)}catch(Q){console.debug("onSubmit handler error",Q)}S("Paiement enregistr","success");try{F()}catch{}e()}catch(le){console.error(le);const de=le&&le.message?le.message:"Erreur lors de l'enregistrement du paiement";S(de,"error")}finally{T(!1)}},disabled:j,children:[j?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 lg:h-5 lg:w-5 border-b-2 border-white"}):o.jsx("span",{children:"Enregistrer"}),o.jsx("span",{children:j?"Enregistrement...":"Paiement"})]})]})]}),M&&o.jsx(kf,{open:M.showPrompt,title:"Quitter sans sauvegarder ?",description:"Vous avez des modifications non sauvegardes. Voulez-vous quitter sans enregistrer ?",onConfirm:()=>{try{F()}catch{}const Z=window;try{Z.__preventReDispatch=!0}catch{}try{M.allowNavigation?M.allowNavigation():e()}finally{setTimeout(()=>{try{Z.__preventReDispatch=!1}catch{}},80)}},onCancel:()=>M.closePrompt&&M.closePrompt()})]})}function xle(e,t="Aperu convocations"){const r=document.getElementById(e);if(r)try{const n=r.innerHTML,i=new DOMParser().parseFromString(n,"text/html");i.querySelectorAll(".no-print, button").forEach(h=>h.remove());const s=i.body.innerHTML,f=`<!doctype html><html><head><meta charset="utf-8"/><title>${t}</title>
      <style>
        @page { size: A4 portrait; margin: 12mm; }
        :root { --page-height: 297mm; --print-margin: 12mm; }
        html,body { height: 100%; }
        body { font-family: 'Times New Roman', Times, serif; color: #111827; padding: 0; margin: 0; background: #ffffff; }
        .receipt-wrapper { width: 210mm; margin: 0 auto; padding: 0; box-sizing: border-box; }
        .convocations-wrapper { display: block; box-sizing: border-box; }
  .convocation { box-sizing: border-box; height: 65mm; padding: 6mm; overflow: visible; position: relative; }
        .convocation + .convocation { border-top: 1px dashed #444; margin-top: 4mm; padding-top: 4mm; }
        .convocation + .convocation::before { content: '\\2702'; position: absolute; top: -9mm; left: 50%; transform: translateX(-50%); background: white; padding: 0 3px; color: #444; font-size: 10px; }
  .convocation { break-inside: avoid; }
  /* ensure important / deadline markers render even when global CSS isn't loaded */
  .print-important { color: #b91c1c !important; font-weight: 800 !important; }
  .print-deadline { color: #7f1d1d !important; font-weight: 700 !important; font-size: 1.0rem !important; display: block; margin-top: 6px; }
        .convocation:nth-child(4n) { page-break-after: always; }
      </style>
    </head><body><div class="receipt-wrapper print-four-per-page">${s}</div></body></html>`,d=window.open("","_blank");if(!d)return;d.document.open(),d.document.write(f),d.document.close(),d.focus(),setTimeout(()=>{try{d.print()}catch{}},300)}catch{const a=document.getElementById(e);if(!a)return;const i=window.open("","_blank");if(!i)return;i.document.open(),i.document.write("<html><head><title>"+t+"</title></head><body>"+a.innerHTML+"</body></html>"),i.document.close(),i.print()}}function hv(e,t="Aperu"){const r=document.getElementById(e);if(!r)return;if(r.getAttribute("data-print-mode")==="convocations"||r.classList.contains("print-four-per-page"))return xle(e,t);const a=!!r.getAttribute&&!!r.getAttribute("data-print-two-up");return uP(e,t,a)}function N6(e,t=300){const[r,n]=k.useState(e);return k.useEffect(()=>{const a=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(a)}},[e,t]),r}function gle(){const[e,t]=on.useState(0),[r,n]=on.useState(!1),[a,i]=on.useState(""),[s,l]=on.useState("scolarite"),[f,d]=on.useState(!1),h=fe.getAll("eleves"),m=fe.getAll("paiements"),x=fe.getAll("fraisScolaires"),g=fe.getAll("classes"),[y,v]=k.useState(""),[b,E]=k.useState(""),N=N6(b,300),S=k.useMemo(()=>{let O=h;if(y&&(O=O.filter(V=>V.classeId===y)),N){const V=N.toLowerCase();O=O.filter(H=>H.nom.toLowerCase().includes(V)||H.prenoms.toLowerCase().includes(V)||H.matricule.toLowerCase().includes(V))}return O},[h,y,N]),[j,T]=k.useState(null),[C,P]=k.useState(1),[M,D]=k.useState(!1),[W,F]=k.useState([]),{showToast:L}=Jr();on.useEffect(()=>{const O=V=>{const H=V;H?.detail?.page==="finances"&&T(H.detail.eleveId||null)};return window.addEventListener("navigate",O),()=>window.removeEventListener("navigate",O)},[]);const J=k.useMemo(()=>{const O=new Map;return m.forEach(V=>{const H=O.get(V.eleveId)||[];O.set(V.eleveId,[...H,V])}),O},[m]),se=k.useMemo(()=>{const O=new Map;return x.forEach(V=>{O.set(`${V.niveau}_${V.anneeScolaire}`,V)}),O},[x]),Z=(O,V)=>(J.get(O)??[]).reduce((q,K)=>q+(K.montant||0),0),he=O=>Z(O);function le(O){const V=g.find(q=>q.id===O.classeId);return V&&se.get(`${V.niveau}_${V.anneeScolaire}`)||null}function de(O,V){const H=J.get(O)??[];if(Number(V)===1){const ie=H.filter(z=>z.typeFrais==="inscription").reduce((z,G)=>z+(G.montant||0),0),B=H.filter(z=>z.typeFrais==="scolarite"&&Number(z.versementIndex)===1).reduce((z,G)=>z+(G.montant||0),0);return ie+B||0}return H.filter(ie=>ie.typeFrais==="scolarite").filter(ie=>Number(ie.versementIndex)===Number(V)).reduce((ie,B)=>ie+(B.montant||0),0)||0}function Q(O,V){const H=h.find(G=>G.id===O);if(!H)return;const q=le(H);if(!q||!q.echeances||q.echeances.length===0){const G="REC"+Date.now().toString().slice(-8);fe.create("paiements",{eleveId:O,montant:V,typeFrais:"scolarite",datePaiement:new Date().toISOString(),numeroRecu:G,modePaiement:"Espces",createdAt:new Date().toISOString()});const ce=Ja();cc.log({type:"payment",action:`Paiement de ${V} FCFA enregistr pour ${H.nom} ${H.prenoms}`,user:ce?`${ce.prenoms} ${ce.nom}`:"Inconnu",details:{eleveId:O,montant:V,type:"scolarite",numeroRecu:G},status:"success"});return}let K=Number(V||0);const ie=(q.echeances||[]).slice().sort((G,ce)=>(G.modalite||0)-(ce.modalite||0)),B=[];for(const G of ie){if(K<=0)break;const ce=Number(G.modalite||0),I=Number(G.montant||0),Ae=de(O,ce)||0,je=Math.max(0,I-Ae);if(je<=0)continue;const Le=Math.min(K,je),Ue="REC"+Date.now().toString().slice(-8)+"-"+ce;ce===1?fe.create("paiements",{eleveId:O,montant:Le,typeFrais:"inscription",datePaiement:new Date().toISOString(),numeroRecu:Ue,modePaiement:"Espces",createdAt:new Date().toISOString()}):fe.create("paiements",{eleveId:O,montant:Le,typeFrais:"scolarite",versementIndex:ce,datePaiement:new Date().toISOString(),numeroRecu:Ue,modePaiement:"Espces",createdAt:new Date().toISOString()}),B.push({modalite:ce,montant:Le,numero:Ue}),K-=Le}if(K>0){const G="REC"+Date.now().toString().slice(-8)+"-SUR";fe.create("paiements",{eleveId:O,montant:K,typeFrais:"scolarite",datePaiement:new Date().toISOString(),numeroRecu:G,modePaiement:"Espces",createdAt:new Date().toISOString()}),B.push({type:"surplus",montant:K,numero:G})}const z=Ja();cc.log({type:"payment",action:`Paiement de ${V} FCFA allou automatiquement pour ${H.nom} ${H.prenoms}`,user:z?`${z.prenoms} ${z.nom}`:"Inconnu",details:{eleveId:O,montantTotal:V,allocations:B},status:"success"})}function pe(O){const H=(J.get(O)??[]).filter(ie=>Number(ie.montant||0)===0);if(!H.length){L("Aucun paiement  0 FCFA trouv","info");return}H.forEach(ie=>{try{fe.delete("paiements",ie.id)}catch{}});const q=h.find(ie=>ie.id===O),K=Ja();cc.log({type:"delete",action:`${H.length} paiement(s)  0 FCFA supprim(s) pour ${q?.nom} ${q?.prenoms}`,user:K?`${K.prenoms} ${K.nom}`:"Inconnu",details:{eleveId:O,count:H.length},status:"success"}),L(`${H.length} paiement(s)  0 FCFA supprim(s)`,"success"),t(ie=>ie+1)}function re(O,V){P(O),i(String(V)),l("scolarite"),L(`Modalit ${O} slectionne (${V.toLocaleString("fr-FR")} FCFA)`,"info")}return o.jsxs("div",{children:[o.jsx("span",{className:"hidden",children:e}),o.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("button",{className:"px-3 py-1 bg-teal-600 text-white rounded",onClick:()=>{F([]),D(!0)},children:"Aperu reus"}),o.jsx("button",{className:"ml-3 px-3 py-1 bg-green-600 text-white rounded",onClick:()=>n(!0),children:"Nouveau paiement"}),o.jsx("button",{className:"ml-3 bg-yellow-600 text-white px-4 py-2 rounded",onClick:async()=>{try{const O=`convocations-print-${Date.now()}`,V=document.createElement("div");V.id=O,document.body.appendChild(V);const H=[];for(const ie of S){const B=le(ie);if(!B||!(B.echeances||[]).length)continue;const z=[];let G=0;for(const ce of B.echeances||[]){const I=Number(ce.modalite||0),Ae=Number(ce.montant||0),je=de(ie.id,I),Le=Math.max(0,Ae-je);Le>0&&(z.push({modalite:I,attendu:Ae,paye:je,reste:Le,date:ce.date}),G+=Le)}z.length&&H.push({ele:ie,echeances:z,totalDue:G})}if(!H.length){L("Aucune convocation  imprimer","info"),V.remove();return}const[{default:q}]=await Promise.all([yn(()=>import("./Convocation-D61rmYGB.js"),[],import.meta.url)]),{createRoot:K}=await yn(async()=>{const{createRoot:ie}=await Promise.resolve().then(()=>yx);return{createRoot:ie}},void 0,import.meta.url);H.forEach(ie=>{const B=document.createElement("div");V.appendChild(B);const z=K(B),G=g.find(ce=>ce.id===ie.ele.classeId);z.render(on.createElement(q,{eleve:ie.ele,echeances:ie.echeances,totalDue:ie.totalDue,classe:G,anneeScolaire:G?.anneeScolaire||""}))}),setTimeout(()=>{hv(O,"Convocations de paiement"),setTimeout(()=>{const ie=document.getElementById(O);ie&&ie.remove()},2e3)},200)}catch(O){L("Erreur lors de la gnration des convocations","error"),console.error(O)}},children:"Imprimer convocations"})]}),o.jsx("h2",{className:"text-xl font-bold mb-4",children:"Gestion des Finances"})]}),o.jsxs("div",{className:"flex space-x-4 mb-4",children:[o.jsxs("select",{value:y,onChange:O=>v(O.target.value),className:"border rounded px-2 py-1",children:[o.jsx("option",{value:"",children:"Toutes les classes"}),g.map(O=>o.jsxs("option",{value:O.id,children:[O.niveau," ",O.section]},O.id))]}),o.jsx("input",{type:"text",placeholder:"Recherche lve...",value:b,onChange:O=>E(O.target.value),className:"border rounded px-2 py-1"})]}),j&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 max-w-2xl w-full",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold",children:["Gestion financire - ",h.find(O=>O.id===j)?.nom]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{className:"text-sm px-2 py-1 bg-gray-100 rounded",onClick:()=>pe(j),children:"Nettoyer 0 FCFA"}),o.jsx("button",{className:"text-gray-500",onClick:()=>T(null),children:""})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm",children:"Statut"}),o.jsxs("select",{value:h.find(O=>O.id===j)?.statutInscription||"non-inscrit",onChange:O=>{const V=O.target.value,H=h.find(q=>q.id===j);if(H){if(fe.update("eleves",H.id,{...H,statutInscription:V}),V==="inscrit"){const q=g.find(B=>B.id===H.classeId),K=x.find(B=>B.niveau===q?.niveau&&B.anneeScolaire===q?.anneeScolaire),ie=K&&K.fraisInscription||0;if(ie>0){const B=m.find(z=>z.eleveId===H.id&&(z.typeFrais==="inscription"||z.typeFrais==="inscription"));B?B&&Number(B.montant||0)===0&&fe.update("paiements",B.id,{...B,montant:ie,updatedAt:new Date().toISOString()}):fe.create("paiements",{eleveId:H.id,montant:ie,typeFrais:"inscription",numeroRecu:"REC"+Date.now().toString().slice(-8),datePaiement:new Date().toISOString(),modePaiement:"Espces",createdAt:new Date().toISOString()})}t(B=>B+1)}L("Statut mis  jour","success"),t(q=>q+1)}},className:"border rounded px-2 py-1 w-full",children:[o.jsx("option",{value:"non-inscrit",children:"Non-inscrit"}),o.jsx("option",{value:"inscrit",children:"Inscrit"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm",children:"Enregistrer un versement"}),o.jsxs("div",{className:"mt-2 flex gap-2",children:[o.jsx("input",{placeholder:"Montant",type:"number",value:a,onChange:O=>i(O.target.value),className:"border px-2 py-1 rounded w-1/2"}),o.jsxs("select",{value:s,onChange:O=>l(O.target.value),className:"border px-2 py-1 rounded w-1/2",children:[o.jsx("option",{value:"scolarite",children:"Scolarit (V)"}),o.jsx("option",{value:"inscription",children:"Inscription"}),o.jsx("option",{value:"cantine",children:"Cantine"})]})]}),o.jsxs("div",{className:"mt-2 flex gap-2 items-center",children:[o.jsx("div",{className:"text-sm",children:"Modalit:"}),o.jsxs("select",{value:C,onChange:O=>P(O.target.value==="auto"?"auto":Number(O.target.value)),className:"border px-2 py-1 rounded w-40",children:[o.jsx("option",{value:"auto",children:"Auto"}),o.jsx("option",{value:1,children:"1 - V1"}),o.jsx("option",{value:2,children:"2 - V2"}),o.jsx("option",{value:3,children:"3 - V3"}),o.jsx("option",{value:4,children:"4 - V4"}),o.jsx("option",{value:5,children:"5 - V5"}),o.jsx("option",{value:6,children:"6 - V6"}),o.jsx("option",{value:7,children:"7 - V7"})]})]}),o.jsx("div",{className:"mt-2 flex gap-2",children:o.jsx("button",{className:"px-3 py-1 bg-teal-600 text-white rounded",onClick:()=>{const O=Number(a||0),V=s||"scolarite";if(!O||!j){L("Montant invalide","error");return}const H="REC"+Date.now().toString().slice(-8),q={eleveId:j,montant:O,typeFrais:V,datePaiement:new Date().toISOString(),numeroRecu:H,modePaiement:"Espces",createdAt:new Date().toISOString()};if(V==="scolarite")if(C==="auto")O>0?Q(j,O):L("Montant invalide pour allocation automatique","error");else if(O>0){const K=Number(C);if(K===1){const ie={...q,typeFrais:"inscription"};fe.create("paiements",ie)}else q.versementIndex=K,fe.create("paiements",q)}else L("Montant invalide","error");else O>0?fe.create("paiements",q):L("Montant invalide","error");L("Versement enregistr","success"),i(""),l("scolarite"),t(K=>K+1)},children:"Enregistrer"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm",children:"Imprimer reus"}),o.jsx("div",{className:"mt-2",children:o.jsx("button",{className:"px-3 py-1 bg-teal-600 text-white rounded",onClick:async()=>{if(!j)return;const O=m.filter(B=>B.eleveId===j);if(!O.length){L("Aucun paiement pour cet lve","info");return}const V=`print-area-eleve-${j}-${Date.now()}`,H=document.createElement("div");H.id=V,document.body.appendChild(H);const[{createRoot:q},{default:K}]=await Promise.all([yn(()=>Promise.resolve().then(()=>yx),void 0,import.meta.url),yn(()=>import("./RecuPaiement-BvNnKqp-.js"),[],import.meta.url)]),ie=h.find(B=>B.id===j);O.forEach((B,z)=>{const G=document.createElement("div");G.id=`${V}-${z}`,H.appendChild(G),q(G).render(on.createElement(K,{eleve:{nom:ie.nom,prenoms:ie.prenoms,matricule:ie.matricule,classe:g.find(I=>I.id===ie.classeId)?.niveau||""},montantRegle:B.montant||0,date:B.datePaiement||new Date().toISOString(),mode:B.modePaiement||"Espces",cumulReglement:he(j),resteAPayer:0,anneeScolaire:g.find(I=>I.id===ie.classeId)?.anneeScolaire||"",operateur:Ja()?`${Ja().prenoms} ${Ja().nom}`:"Inconnu",numeroRecu:B.numeroRecu||"REC"+Date.now().toString().slice(-8),printMode:!0}))}),setTimeout(()=>{hv(V,`Reus ${j}`),setTimeout(()=>{const B=document.getElementById(V);B&&B.remove()},2e3)},150)},children:"Aperu reus"})})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"font-semibold",children:"Historique des paiements"}),o.jsx("div",{className:"max-h-48 overflow-auto mt-2",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"border px-2 py-1",children:"Date"}),o.jsx("th",{className:"border px-2 py-1",children:"Montant"}),o.jsx("th",{className:"border px-2 py-1",children:"Type"}),o.jsx("th",{className:"border px-2 py-1",children:"Reu"})]})}),o.jsx("tbody",{children:m.filter(O=>O.eleveId===j).map(O=>o.jsxs("tr",{children:[o.jsx("td",{className:"border px-2 py-1",children:new Date(O.datePaiement||O.date||"").toLocaleDateString("fr-FR")}),o.jsxs("td",{className:"border px-2 py-1",children:[O.montant," FCFA"]}),o.jsx("td",{className:"border px-2 py-1",children:O.typeFrais}),o.jsx("td",{className:"border px-2 py-1",children:O.numeroRecu||"-"})]},O.id))})]})})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"font-semibold",children:"chances & Statut"}),o.jsx("div",{className:"max-h-40 overflow-auto mt-2",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"border px-2 py-1",children:"Modalit"}),o.jsx("th",{className:"border px-2 py-1",children:"Date"}),o.jsx("th",{className:"border px-2 py-1",children:"Attendu"}),o.jsx("th",{className:"border px-2 py-1",children:"Pay"}),o.jsx("th",{className:"border px-2 py-1",children:"Reste"})]})}),o.jsx("tbody",{children:(()=>{const O=h.find(H=>H.id===j);if(!O)return null;const V=le(O);return!V||!(V.echeances||[]).length?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"text-gray-500 text-center py-2",children:"Aucune chance configure"})}):(V.echeances||[]).map(H=>{const q=Number(H.modalite||0),K=Number(H.montant||0),ie=de(j,q),B=Math.max(0,K-ie),z=B===0?"paid":ie>0?"partial":"unpaid",G=z==="paid"?"bg-green-100 text-green-800":z==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-700";return o.jsxs("tr",{children:[o.jsx("td",{className:"border px-2 py-1",children:q}),o.jsx("td",{className:"border px-2 py-1",children:H.date}),o.jsxs("td",{className:"border px-2 py-1",children:[K.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("td",{className:"border px-2 py-1",children:[ie.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("td",{className:"border px-2 py-1 flex items-center justify-between",children:[o.jsxs("span",{children:[B.toLocaleString("fr-FR")," FCFA"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${G}`,children:z==="paid"?"Pay":z==="partial"?"Partiel":"Non pay"}),o.jsx("button",{className:"text-sm px-2 py-1 bg-blue-600 text-white rounded",onClick:()=>re(q,B),children:"Rgler"})]})]})]},q)})})()})]})})]})]})}),M&&j&&o.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black bg-opacity-40",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full p-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Slectionner les reus  imprimer"}),o.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Choisissez une ou plusieurs oprations (cocher). Vous pouvez imprimer sparment ou combiner les paiements slectionns en un seul reu."}),o.jsx("div",{className:"max-h-64 overflow-auto border rounded p-2 mb-4",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsxs("th",{className:"px-2 py-1",children:[" ",o.jsx("input",{type:"checkbox",onChange:O=>{const V=m.filter(H=>H.eleveId===j).map(H=>H.id);F(O.target.checked?V:[])},checked:W.length>0&&W.length===m.filter(O=>O.eleveId===j).length})]}),o.jsx("th",{className:"px-2 py-1",children:"Date"}),o.jsx("th",{className:"px-2 py-1",children:"Montant"}),o.jsx("th",{className:"px-2 py-1",children:"Type"}),o.jsx("th",{className:"px-2 py-1",children:"Reu"})]})}),o.jsx("tbody",{children:m.filter(O=>O.eleveId===j).map(O=>{const V=O.id;return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-2 py-1 text-center",children:o.jsx("input",{type:"checkbox",checked:W.includes(V),onChange:H=>{F(q=>H.target.checked?[...q,V]:q.filter(K=>K!==V))}})}),o.jsx("td",{className:"px-2 py-1",children:new Date(O.datePaiement||O.date||"").toLocaleDateString("fr")}),o.jsxs("td",{className:"px-2 py-1",children:[O.montant," FCFA"]}),o.jsx("td",{className:"px-2 py-1",children:O.typeFrais}),o.jsx("td",{className:"px-2 py-1",children:O.numeroRecu||"-"})]},V)})})]})}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{className:"px-3 py-1 bg-gray-300 rounded",onClick:()=>{D(!1),F([])},children:"Annuler"}),o.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded",onClick:async()=>{if(!j)return;const O=m.filter(z=>W.includes(z.id));if(O.length===0){L("Slectionnez au moins une opration","error");return}const V=`print-area-eleve-${j}-${Date.now()}`,H=document.createElement("div");H.id=V,document.body.appendChild(H);const[{createRoot:q},{default:K},{default:ie}]=await Promise.all([yn(()=>Promise.resolve().then(()=>yx),void 0,import.meta.url),yn(()=>import("./RecuPaiement-BvNnKqp-.js"),[],import.meta.url),yn(()=>import("./CombinedRecu-BRmbxc1_.js"),__vite__mapDeps([0,1]),import.meta.url)]),B=h.find(z=>z.id===j);if(W.length===1){const z=O[0],G=document.createElement("div");H.appendChild(G),q(G).render(on.createElement(K,{eleve:{nom:B.nom,prenoms:B.prenoms,matricule:B.matricule,classe:g.find(I=>I.id===B.classeId)?.niveau||""},montantRegle:z.montant||0,date:z.datePaiement||new Date().toISOString(),mode:z.modePaiement||"Espces",cumulReglement:he(j),resteAPayer:0,anneeScolaire:g.find(I=>I.id===B.classeId)?.anneeScolaire||"",operateur:Ja()?`${Ja().prenoms} ${Ja().nom}`:"Inconnu",numeroRecu:z.numeroRecu||"REC"+Date.now().toString().slice(-8),printMode:!0}))}else{const z=document.createElement("div");H.appendChild(z),q(z).render(on.createElement(ie,{eleve:B,paiements:O,classe:g.find(ce=>ce.id===B.classeId),anneeScolaire:g.find(ce=>ce.id===B.classeId)?.anneeScolaire||""}))}D(!1),setTimeout(()=>{hv(V,`Reus ${j}`),setTimeout(()=>{const z=document.getElementById(V);z&&z.remove()},2e3)},200)},children:"Imprimer slection"})]})]})}),r&&o.jsx(ple,{onCancel:()=>n(!1),onSubmit:(O,V,H,q)=>{if(H==="scolarite"&&q==="auto")Q(O,V);else{const K="REC"+Date.now().toString().slice(-8),ie={eleveId:O,montant:V,typeFrais:H,datePaiement:new Date().toISOString(),numeroRecu:K,modePaiement:"Espces",createdAt:new Date().toISOString()};H==="scolarite"&&q!=="auto"&&(ie.versementIndex=q),H==="inscription"&&(ie.typeFrais="inscription"),fe.create("paiements",ie)}n(!1),t(K=>K+1)}}),o.jsx("div",{id:"print-area",className:"hidden print:block bg-white p-4 mb-4 print-compact",children:o.jsx(Hf,{type:"recu",libelle:"Relev des paiements"})})]})}function vle(){const[e,t]=k.useState(""),[r,n]=k.useState("all"),[a,i]=k.useState("all"),[s,l]=k.useState(""),[f,d]=k.useState(""),[h,m]=k.useState("nom"),[x,g]=k.useState("asc"),y=N6(e,300),v=fe.getAll("eleves").filter(F=>F.statut==="Actif"),b=fe.getAll("paiements"),E=fe.getAll("fraisScolaires"),N=fe.getAll("classes"),S=k.useMemo(()=>{const F=new Map;return E.forEach(L=>{F.set(L.niveau,L)}),F},[E]),j=k.useMemo(()=>{const F=new Map;return b.forEach(L=>{const J=F.get(L.eleveId)??[];F.set(L.eleveId,[...J,L])}),F},[b]),T=k.useMemo(()=>v.map(F=>{const L=N.find(O=>O.id===F.classeId)||null,J=L?S.get(L.niveau):null;let se=0;J&&(F.protege?se=J.inscription||0:se=(J.inscription||0)+(J.scolariteComplete||0));const Z=j.get(F.id)??[];let he=Z;(s||f)&&(he=Z.filter(O=>{const V=new Date(O.datePaiement),H=s?new Date(s):new Date("1900-01-01"),q=f?new Date(f):new Date("2100-12-31");return V>=H&&V<=q}));const le=he.reduce((O,V)=>O+V.montant,0),de=Math.max(0,se-le),Q=se>0?le/se*100:0;let pe="Impay";Q>=100?pe="Pay":Q>0&&(pe="Partiel");const re=he.length>0?he.sort((O,V)=>new Date(V.datePaiement).getTime()-new Date(O.datePaiement).getTime())[0]:null;return{eleve:F,classe:L,montantAttendu:se,montantPaye:le,montantRestant:de,pourcentagePaye:Q,statut:pe,paiements:he,dernierPaiement:re}}),[v,N,S,j,s,f]),C=k.useMemo(()=>{let F=T;if(y){const L=y.toLowerCase();F=F.filter(J=>J.eleve.nom.toLowerCase().includes(L)||J.eleve.prenoms.toLowerCase().includes(L)||J.eleve.matricule.toLowerCase().includes(L)||(J.classe?.niveau+" "+J.classe?.section).toLowerCase().includes(L))}return r!=="all"&&(F=F.filter(L=>L.eleve.classeId===r)),a!=="all"&&(F=F.filter(L=>L.statut===a)),F.sort((L,J)=>{let se=0;switch(h){case"nom":se=L.eleve.nom.localeCompare(J.eleve.nom);break;case"montantPaye":se=L.montantPaye-J.montantPaye;break;case"montantRestant":se=L.montantRestant-J.montantRestant;break;case"classe":const Z=L.classe?`${L.classe.niveau} ${L.classe.section}`:"",he=J.classe?`${J.classe.niveau} ${J.classe.section}`:"";se=Z.localeCompare(he);break}return x==="asc"?se:-se}),F},[T,y,r,a,h,x]),P=k.useMemo(()=>{const F=C.length,L=C.filter(de=>de.statut==="Pay").length,J=C.filter(de=>de.statut==="Partiel").length,se=C.filter(de=>de.statut==="Impay").length,Z=C.reduce((de,Q)=>de+Q.montantAttendu,0),he=C.reduce((de,Q)=>de+Q.montantPaye,0),le=Z>0?he/Z*100:0;return{totalEleves:F,elevesPayes:L,elevesPartiels:J,elevesImpayes:se,montantAttendu:Z,montantPercu:he,tauxRecouvrement:le}},[C]),M=()=>{const F=window.open("","_blank");if(!F)return;const L=fe.getAll("ecole")[0],J=Kn(new Date,"dd/MM/yyyy HH:mm",{locale:y1}),se=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Fiche de Recouvrement - ${J}</title>
          <style>
            @media print {
              @page { margin: 1cm; size: A4 landscape; }
            }
            body { 
              font-family: Arial, sans-serif; 
              font-size: 10pt;
              margin: 0;
              padding: 20px;
            }
            .header {
              text-align: center;
              margin-bottom: 30px;
              border-bottom: 2px solid #333;
              padding-bottom: 15px;
            }
            .header h1 { margin: 5px 0; font-size: 18pt; }
            .header h2 { margin: 5px 0; font-size: 14pt; color: #666; }
            .header p { margin: 3px 0; font-size: 9pt; }
            .stats {
              display: grid;
              grid-template-columns: repeat(4, 1fr);
              gap: 10px;
              margin-bottom: 20px;
            }
            .stat-card {
              border: 1px solid #ddd;
              padding: 10px;
              border-radius: 4px;
              text-align: center;
            }
            .stat-card .label { font-size: 9pt; color: #666; margin-bottom: 5px; }
            .stat-card .value { font-size: 14pt; font-weight: bold; }
            table {
              width: 100%;
              border-collapse: collapse;
              margin-top: 10px;
            }
            th, td {
              border: 1px solid #ddd;
              padding: 6px;
              text-align: left;
              font-size: 9pt;
            }
            th {
              background-color: #f5f5f5;
              font-weight: bold;
            }
            .status-paye { color: #10b981; font-weight: bold; }
            .status-partiel { color: #f59e0b; font-weight: bold; }
            .status-impaye { color: #ef4444; font-weight: bold; }
            .footer {
              margin-top: 30px;
              text-align: center;
              font-size: 8pt;
              color: #666;
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>${L?.nom||"cole"}</h1>
            <h2>FICHE DE RECOUVREMENT DES PAIEMENTS</h2>
            <p>Date de gnration: ${J}</p>
            ${s||f?`<p>Priode: ${s?Kn(new Date(s),"dd/MM/yyyy"):"Dbut"} - ${f?Kn(new Date(f),"dd/MM/yyyy"):"Fin"}</p>`:""}
          </div>

          <div class="stats">
            <div class="stat-card">
              <div class="label">Total lves</div>
              <div class="value">${P.totalEleves}</div>
            </div>
            <div class="stat-card">
              <div class="label">Montant Attendu</div>
              <div class="value">${P.montantAttendu.toLocaleString("fr-FR")} FCFA</div>
            </div>
            <div class="stat-card">
              <div class="label">Montant Peru</div>
              <div class="value">${P.montantPercu.toLocaleString("fr-FR")} FCFA</div>
            </div>
            <div class="stat-card">
              <div class="label">Taux Recouvrement</div>
              <div class="value">${P.tauxRecouvrement.toFixed(1)}%</div>
            </div>
          </div>

          <table>
            <thead>
              <tr>
                <th>N</th>
                <th>Matricule</th>
                <th>Nom & Prnoms</th>
                <th>Classe</th>
                <th>Montant Attendu</th>
                <th>Montant Pay</th>
                <th>Reste  Payer</th>
                <th>%</th>
                <th>Statut</th>
                <th>Dernier Paiement</th>
              </tr>
            </thead>
            <tbody>
              ${C.map((Z,he)=>`
                <tr>
                  <td>${he+1}</td>
                  <td>${Z.eleve.matricule}</td>
                  <td>${Z.eleve.nom} ${Z.eleve.prenoms}</td>
                  <td>${Z.classe?`${Z.classe.niveau} ${Z.classe.section}`:"-"}</td>
                  <td>${Z.montantAttendu.toLocaleString("fr-FR")}</td>
                  <td>${Z.montantPaye.toLocaleString("fr-FR")}</td>
                  <td>${Z.montantRestant.toLocaleString("fr-FR")}</td>
                  <td>${Z.pourcentagePaye.toFixed(0)}%</td>
                  <td class="status-${Z.statut.toLowerCase()}">${Z.statut}</td>
                  <td>${Z.dernierPaiement?Kn(new Date(Z.dernierPaiement.datePaiement),"dd/MM/yyyy"):"-"}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>

          <div class="footer">
            <p>Document gnr automatiquement par KlasNet - ${L?.nom||""}</p>
            <p>Imprim le ${J}</p>
          </div>

          <script>
            window.onload = () => {
              window.print();
              setTimeout(() => window.close(), 100);
            };
          <\/script>
        </body>
      </html>
    `;F.document.write(se),F.document.close()},D=()=>{const F=fe.getAll("ecole")[0],L=Kn(new Date,"dd/MM/yyyy HH:mm");let J=`Fiche de Recouvrement - ${F?.nom||"cole"}
`;J+=`Date de gnration: ${L}
`,(s||f)&&(J+=`Priode: ${s?Kn(new Date(s),"dd/MM/yyyy"):"Dbut"} - ${f?Kn(new Date(f),"dd/MM/yyyy"):"Fin"}
`),J+=`
`,J+=`STATISTIQUES GLOBALES
`,J+=`Total lves,${P.totalEleves}
`,J+=`Pays,${P.elevesPayes}
`,J+=`Partiels,${P.elevesPartiels}
`,J+=`Impays,${P.elevesImpayes}
`,J+=`Montant Attendu,${P.montantAttendu}
`,J+=`Montant Peru,${P.montantPercu}
`,J+=`Taux Recouvrement,${P.tauxRecouvrement.toFixed(2)}%
`,J+=`
`,J+=`DTAIL PAR LVE
`,J+=`N,Matricule,Nom,Prnoms,Classe,Montant Attendu,Montant Pay,Reste  Payer,Pourcentage,Statut,Dernier Paiement,Nb Paiements
`,C.forEach((le,de)=>{J+=`${de+1},`,J+=`${le.eleve.matricule},`,J+=`${le.eleve.nom},`,J+=`${le.eleve.prenoms},`,J+=`${le.classe?`${le.classe.niveau} ${le.classe.section}`:"-"},`,J+=`${le.montantAttendu},`,J+=`${le.montantPaye},`,J+=`${le.montantRestant},`,J+=`${le.pourcentagePaye.toFixed(2)}%,`,J+=`${le.statut},`,J+=`${le.dernierPaiement?Kn(new Date(le.dernierPaiement.datePaiement),"dd/MM/yyyy"):"-"},`,J+=`${le.paiements.length}
`});const se=new Blob([J],{type:"text/csv;charset=utf-8;"}),Z=document.createElement("a"),he=URL.createObjectURL(se);Z.setAttribute("href",he),Z.setAttribute("download",`recouvrement_${Kn(new Date,"yyyy-MM-dd_HHmm")}.csv`),Z.style.visibility="hidden",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)},W=F=>{h===F?g(x==="asc"?"desc":"asc"):(m(F),g("asc"))};return o.jsx(dl,{title:"Fiches de Recouvrement",subtitle:"Suivi dtaill des paiements et du recouvrement",icon:R0,children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 sm:p-6 border border-blue-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx(Qi,{className:"h-8 w-8 text-blue-600"}),o.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-blue-900",children:P.totalEleves})]}),o.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Total lves"}),o.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:[P.elevesPayes," pays  ",P.elevesPartiels," partiels  ",P.elevesImpayes," impays"]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 sm:p-6 border border-green-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx(In,{className:"h-8 w-8 text-green-600"}),o.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-green-900",children:P.elevesPayes})]}),o.jsx("p",{className:"text-sm text-green-700 font-medium",children:"lves Pays"}),o.jsxs("div",{className:"mt-2 text-xs text-green-600",children:[P.totalEleves>0?(P.elevesPayes/P.totalEleves*100).toFixed(1):0,"% du total"]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 sm:p-6 border border-purple-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx(Ji,{className:"h-8 w-8 text-purple-600"}),o.jsx("span",{className:"text-lg sm:text-xl font-bold text-purple-900",children:P.montantPercu.toLocaleString("fr-FR")})]}),o.jsx("p",{className:"text-sm text-purple-700 font-medium",children:"Montant Peru (FCFA)"}),o.jsxs("div",{className:"mt-2 text-xs text-purple-600",children:["sur ",P.montantAttendu.toLocaleString("fr-FR")," attendu"]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 rounded-lg p-4 sm:p-6 border border-amber-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx(fc,{className:"h-8 w-8 text-amber-600"}),o.jsxs("span",{className:"text-2xl sm:text-3xl font-bold text-amber-900",children:[P.tauxRecouvrement.toFixed(1),"%"]})]}),o.jsx("p",{className:"text-sm text-amber-700 font-medium",children:"Taux de Recouvrement"}),o.jsx("div",{className:"mt-2 h-2 bg-amber-200 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-amber-600 transition-all duration-500",style:{width:`${Math.min(100,P.tauxRecouvrement)}%`}})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-4",children:[o.jsxs("div",{className:"relative sm:col-span-2",children:[o.jsx(sl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Rechercher un lve...",value:e,onChange:F=>t(F.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),o.jsxs("select",{value:r,onChange:F=>n(F.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[o.jsx("option",{value:"all",children:"Toutes les classes"}),N.map(F=>o.jsxs("option",{value:F.id,children:[F.niveau," ",F.section]},F.id))]}),o.jsxs("select",{value:a,onChange:F=>i(F.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[o.jsx("option",{value:"all",children:"Tous les statuts"}),o.jsx("option",{value:"Pay",children:" Pay"}),o.jsx("option",{value:"Partiel",children:" Partiel"}),o.jsx("option",{value:"Impay",children:" Impay"})]}),o.jsxs("select",{value:h,onChange:F=>m(F.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[o.jsx("option",{value:"nom",children:"Trier par nom"}),o.jsx("option",{value:"classe",children:"Trier par classe"}),o.jsx("option",{value:"montantPaye",children:"Trier par montant pay"}),o.jsx("option",{value:"montantRestant",children:"Trier par reste"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[o.jsx(zs,{className:"inline h-4 w-4 mr-1"}),"Date dbut"]}),o.jsx("input",{type:"date",value:s,onChange:F=>l(F.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[o.jsx(zs,{className:"inline h-4 w-4 mr-1"}),"Date fin"]}),o.jsx("input",{type:"date",value:f,onChange:F=>d(F.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-3",children:[o.jsxs("button",{onClick:M,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[o.jsx(x4,{className:"h-4 w-4"}),o.jsx("span",{children:"Imprimer"})]}),o.jsxs("button",{onClick:D,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[o.jsx(w1,{className:"h-4 w-4"}),o.jsx("span",{children:"Exporter Excel"})]}),(s||f||r!=="all"||a!=="all"||e)&&o.jsxs("button",{onClick:()=>{l(""),d(""),n("all"),i("all"),t("")},className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[o.jsx(L0,{className:"h-4 w-4"}),o.jsx("span",{children:"Rinitialiser"})]})]})]}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"N"}),o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>W("nom"),children:["lve ",h==="nom"&&(x==="asc"?"":"")]}),o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors hidden lg:table-cell",onClick:()=>W("classe"),children:["Classe ",h==="classe"&&(x==="asc"?"":"")]}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell",children:"Attendu"}),o.jsxs("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>W("montantPaye"),children:["Pay ",h==="montantPaye"&&(x==="asc"?"":"")]}),o.jsxs("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors hidden md:table-cell",onClick:()=>W("montantRestant"),children:["Reste ",h==="montantRestant"&&(x==="asc"?"":"")]}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider hidden xl:table-cell",children:"Dernier Paiement"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:C.length===0?o.jsx("tr",{children:o.jsxs("td",{colSpan:8,className:"px-4 py-12 text-center text-gray-500",children:[o.jsx(R0,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),o.jsx("p",{className:"text-lg font-medium",children:"Aucun lve trouv"}),o.jsx("p",{className:"text-sm mt-1",children:"Essayez de modifier vos filtres"})]})}):C.map((F,L)=>o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:L+1}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[F.eleve.nom," ",F.eleve.prenoms]}),o.jsx("div",{className:"text-xs text-gray-500",children:F.eleve.matricule})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 hidden lg:table-cell",children:F.classe?`${F.classe.niveau} ${F.classe.section}`:"-"}),o.jsx("td",{className:"px-4 py-3 text-right text-sm font-medium text-gray-900 hidden md:table-cell",children:F.montantAttendu.toLocaleString("fr-FR")}),o.jsx("td",{className:"px-4 py-3 text-right text-sm font-semibold text-green-600",children:F.montantPaye.toLocaleString("fr-FR")}),o.jsx("td",{className:"px-4 py-3 text-right text-sm font-medium text-red-600 hidden md:table-cell",children:F.montantRestant.toLocaleString("fr-FR")}),o.jsxs("td",{className:"px-4 py-3 text-center",children:[F.statut==="Pay"&&o.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[o.jsx(In,{className:"h-3 w-3 mr-1"}),"Pay"]}),F.statut==="Partiel"&&o.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:[o.jsx(uc,{className:"h-3 w-3 mr-1"}),"Partiel"]}),F.statut==="Impay"&&o.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[o.jsx(Uh,{className:"h-3 w-3 mr-1"}),"Impay"]})]}),o.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600 hidden xl:table-cell",children:F.dernierPaiement?Kn(new Date(F.dernierPaiement.datePaiement),"dd/MM/yyyy",{locale:y1}):"-"})]},F.eleve.id))})]})})}),o.jsx("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-4 text-sm text-gray-600",children:o.jsxs("p",{children:[o.jsx("strong",{children:C.length})," lve(s) affich(s) sur ",o.jsx("strong",{children:T.length})," au total"]})})]})})}function yle(){const[e,t]=k.useState([]),[r,n]=k.useState(!1),[a,i]=k.useState({date:new Date().toISOString().slice(0,10),type:"Entree",category:"",amount:0,note:""}),[s,l]=k.useState("all"),[f,d]=k.useState(""),[h,m]=k.useState(""),[x,g]=k.useState(""),[y,v]=k.useState("");k.useEffect(()=>{const B=new Date;if(s==="all")m(""),g("");else if(s==="today"){const z=B.toISOString().slice(0,10);m(z),g(z)}else if(s==="month"){const z=new Date(B.getFullYear(),B.getMonth(),1).toISOString().slice(0,10),G=new Date(B.getFullYear(),B.getMonth()+1,0).toISOString().slice(0,10);m(z),g(G)}else if(s==="year"){const z=new Date(B.getFullYear(),0,1).toISOString().slice(0,10),G=new Date(B.getFullYear(),11,31).toISOString().slice(0,10);m(z),g(G)}},[s]);const[b,E]=k.useState(1),[N,S]=k.useState(20),[j,T]=k.useState("date"),[C,P]=k.useState("desc"),[M,D]=k.useState(null),[W,F]=k.useState(!1),[L,J]=k.useState([]),se=()=>t(fe.getAll("compta")||[]);k.useEffect(()=>{se();const B=()=>{se(),n(z=>!z)};return window.addEventListener("dataChanged",B),()=>window.removeEventListener("dataChanged",B)},[]);const Z=()=>i({date:new Date().toISOString().slice(0,10),type:"Entree",category:"",amount:0,note:""}),he=()=>{try{const B={date:a.date||new Date().toISOString(),type:a.type||"Entree",category:a.category||"Gnral",amount:Number(a.amount)||0,note:a.note||"",createdAt:new Date().toISOString()};fe.create("compta",B),Z(),se()}catch(B){console.error(B),alert("Erreur en crant l'criture")}},le=B=>{if(confirm("Supprimer cette criture ?"))try{fe.delete("compta",B),se()}catch(z){console.error(z),alert("Erreur lors de la suppression")}},de=k.useMemo(()=>{const z=(fe.getAll("paiements")||[]).filter(G=>!G.canceled).reduce((G,ce)=>{const I=ce.datePaiement||ce.date||ce.createdAt||new Date().toISOString();let Ae="";try{Ae=new Date(I).toISOString().slice(0,10)}catch{Ae=""}const je=Number(ce.montant||0);return e.some(Ue=>{if(Ue.type!=="Entree")return!1;let Pe="";try{Pe=new Date(Ue.date).toISOString().slice(0,10)}catch{Pe=""}return Pe&&Ae&&Pe===Ae&&Number(Ue.amount||0)===je})||G.push({id:`pai_${ce.id}`,date:I,type:"Entree",category:ce.numeroRecu?`Paiement ${ce.numeroRecu}`:"Paiement",amount:je,note:ce.notes||""}),G},[]);return[...e,...z]},[e,r]),Q=k.useMemo(()=>{const B=de.filter(ce=>!(f&&ce.category!==f||h&&ce.date<h||x&&ce.date>x)),z=B.filter(ce=>ce.type==="Entree").reduce((ce,I)=>ce+Number(I.amount||0),0),G=B.filter(ce=>ce.type==="Sortie").reduce((ce,I)=>ce+Number(I.amount||0),0);return{entrees:z,sorties:G,solde:z-G,count:B.length}},[de,f,h,x]),pe=k.useMemo(()=>{const B=new Date,z=B.toISOString().slice(0,10),G=B.toISOString().slice(0,7),ce=B.getFullYear(),I=Ue=>{try{return new Date(Ue.date).toISOString().slice(0,10)===z}catch{return!1}},Ae=Ue=>{try{return new Date(Ue.date).toISOString().slice(0,7)===G}catch{return!1}},je=Ue=>{try{return new Date(Ue.date).getFullYear()===ce}catch{return!1}},Le=(Ue,Pe)=>Ue.filter(lt=>lt.type===Pe).reduce((lt,kt)=>lt+Number(kt.amount||0),0);return{today:{entrees:Le(de.filter(I),"Entree"),sorties:Le(de.filter(I),"Sortie")},month:{entrees:Le(de.filter(Ae),"Entree"),sorties:Le(de.filter(Ae),"Sortie")},year:{entrees:Le(de.filter(je),"Entree"),sorties:Le(de.filter(je),"Sortie")},countMonth:de.filter(Ae).length}},[de]),re=k.useMemo(()=>{const B=de.filter(I=>I.type==="Entree").reduce((I,Ae)=>I+Number(Ae.amount||0),0),z=de.filter(I=>I.type==="Sortie").reduce((I,Ae)=>I+Number(Ae.amount||0),0);let G=0;try{const I=fe.getAll("eleves"),Ae=fe.getAll("paiements"),je=fe.getAll("classes");G=I.map(Ue=>{try{return ff.getSituationEcheances(Ue.id)}catch{return null}}).filter(Boolean).reduce((Ue,Pe)=>{const lt=Number(Pe.totalRestant||0);return Ue+(lt>0?lt:0)},0)}catch{G=0}const ce=B-z;return{totalRecettes:B,impayes:G,totalSorties:z,solde:ce}},[e,r]),O=k.useMemo(()=>{let B=de.filter(z=>!(f&&z.category!==f||h&&z.date<h||x&&z.date>x||y&&!z.category.toLowerCase().includes(y.toLowerCase())&&!z.note?.toLowerCase().includes(y.toLowerCase())));return B=B.sort((z,G)=>{let ce,I;switch(j){case"date":ce=new Date(z.date).getTime(),I=new Date(G.date).getTime();break;case"category":ce=z.category.toLowerCase(),I=G.category.toLowerCase();break;case"amount":ce=z.amount,I=G.amount;break;default:ce=z.date,I=G.date}return C==="asc"?ce<I?-1:ce>I?1:0:ce>I?-1:ce<I?1:0}),B},[de,f,h,x,y,j,C]),V=Math.max(1,Math.ceil(O.length/N)),H=O.slice((b-1)*N,(b-1)*N+N),q=B=>{const z=e.find(G=>G.id===B)||null;D(z),F(!0)},K=B=>{if(M)try{fe.update("compta",M.id,{...M,...B}),F(!1),D(null)}catch(z){console.error(z),alert("Erreur lors de la mise  jour")}},ie=()=>{if(O.length===0){alert("Aucune criture  imprimer avec les filtres actuels");return}const B=O.filter(je=>je.type==="Entree").reduce((je,Le)=>je+Number(Le.amount||0),0),z=O.filter(je=>je.type==="Sortie").reduce((je,Le)=>je+Number(Le.amount||0),0),G=O.map(je=>`
      <tr>
        <td style="border: 1px solid #333; padding: 8px; text-align: left; background-color: #f9f9f9;">${new Date(je.date).toLocaleDateString("fr-FR")}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: left; background-color: #f9f9f9;">${je.category}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; background-color: #e6ffe6;">${je.type==="Entree"?Number(je.amount).toLocaleString("fr-FR"):""}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; background-color: #ffe6e6;">${je.type==="Sortie"?Number(je.amount).toLocaleString("fr-FR"):""}</td>
      </tr>
    `).join(`
`),ce=`
      <tr style="font-weight: bold; background-color: #ddd;">
        <td colspan="2" style="border: 1px solid #333; padding: 8px; text-align: center; font-weight: bold;">TOTAUX</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; font-weight: bold; background-color: #e6ffe6;">${B.toLocaleString("fr-FR")}</td>
        <td style="border: 1px solid #333; padding: 8px; text-align: right; font-weight: bold; background-color: #ffe6e6;">${z.toLocaleString("fr-FR")}</td>
      </tr>
    `,I=`
      <html>
        <head>
          <title>Journal Comptable</title>
          <style>
            body {
              font-family: 'Times New Roman', Times, serif;
              font-size: 12px;
              color: #000;
              padding: 15mm;
              line-height: 1.4;
            }
            h2 {
              text-align: center;
              margin-bottom: 30px;
              font-size: 18px;
              font-weight: bold;
              text-decoration: underline;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              margin-bottom: 20px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            th {
              border: 2px solid #333;
              padding: 10px;
              text-align: center;
              background-color: #4a5568;
              color: white;
              font-weight: bold;
              font-size: 13px;
            }
            td {
              border: 1px solid #333;
              padding: 8px;
            }
            .signature {
              text-align: right;
              margin-top: 50px;
              font-weight: bold;
              font-size: 14px;
            }
            @media print {
              body { margin: 0; }
              .signature { page-break-inside: avoid; }
            }
          </style>
        </head>
        <body>
          <h2>Journal Comptable</h2>
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Libell</th>
                <th>Dbit</th>
                <th>Crdit</th>
              </tr>
            </thead>
            <tbody>
              ${G}
              ${ce}
            </tbody>
          </table>
          <div class="signature">Signature</div>
        </body>
      </html>
    `,Ae=window.open("","_blank","width=800,height=600");if(!Ae){alert("Impossible d'ouvrir la fentre d'impression");return}Ae.document.open(),Ae.document.write(I),Ae.document.close(),Ae.focus(),setTimeout(()=>{Ae.print(),Ae.onafterprint=()=>Ae.close()},500)};return o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-extrabold",children:"Comptabilit"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Journal des entres et sorties  aperu rapide"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Total Recettes"}),o.jsxs("div",{className:"text-2xl font-extrabold text-gray-900",children:[re.totalRecettes.toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Impays"}),o.jsxs("div",{className:"text-2xl font-extrabold text-red-600",children:[re.impayes.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-xs text-gray-400",children:"Reste  encaisser"})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Sorties"}),o.jsxs("div",{className:"text-2xl font-extrabold text-red-600",children:[re.totalSorties.toLocaleString("fr-FR")," FCFA"]})]}),o.jsxs("div",{className:"text-right px-4 border-l",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Solde"}),o.jsxs("div",{className:"text-2xl font-extrabold text-indigo-700",children:[re.solde.toLocaleString("fr-FR")," FCFA"]})]})]})]}),o.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-green-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-green-100 rounded-md",children:o.jsx(fc,{className:"text-green-700",size:20})}),o.jsx("div",{children:o.jsx("div",{className:"text-xs text-gray-500",children:"Aujourd'hui"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm font-bold",children:[o.jsx("div",{className:"text-green-700",children:"Entres"}),o.jsxs("div",{className:"text-right text-green-700",children:[pe.today.entrees.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-red-600",children:"Sorties"}),o.jsxs("div",{className:"text-right text-red-600",children:[pe.today.sorties.toLocaleString("fr-FR")," FCFA"]})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-blue-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-blue-100 rounded-md",children:o.jsx(zs,{className:"text-blue-600",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500",children:"Ce mois"}),o.jsxs("div",{className:"text-xs text-gray-400",children:[pe.countMonth," critures"]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm font-bold",children:[o.jsx("div",{className:"text-green-700",children:"Entres"}),o.jsxs("div",{className:"text-right text-green-700",children:[pe.month.entrees.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-red-600",children:"Sorties"}),o.jsxs("div",{className:"text-right text-red-600",children:[pe.month.sorties.toLocaleString("fr-FR")," FCFA"]})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-white p-4 rounded shadow flex flex-col justify-between border-l-4 border-indigo-500",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-indigo-100 rounded-md",children:o.jsx(j5,{className:"text-indigo-700",size:20})}),o.jsx("div",{children:o.jsx("div",{className:"text-xs text-gray-500",children:"Cette anne"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm font-bold",children:[o.jsx("div",{className:"text-green-700",children:"Entres"}),o.jsxs("div",{className:"text-right text-green-700",children:[pe.year.entrees.toLocaleString("fr-FR")," FCFA"]}),o.jsx("div",{className:"text-red-600",children:"Sorties"}),o.jsxs("div",{className:"text-right text-red-600",children:[pe.year.sorties.toLocaleString("fr-FR")," FCFA"]})]})]})]}),o.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[o.jsx("div",{className:"text-sm text-gray-600",children:(()=>{let B="Filtre actif : Aucun";return s==="today"?B="Filtre actif : Aujourd'hui":s==="month"?B="Filtre actif : Ce mois":s==="year"?B="Filtre actif : Cette anne":s==="custom"&&(B=`Filtre actif : ${h||"..."}  ${x||"..."}`),o.jsx("span",{className:"text-sm text-gray-500",children:B})})()}),o.jsxs("div",{className:"flex items-center space-x-3 text-sm text-gray-600",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"inline-block w-3 h-3 bg-green-600 rounded-full"})," ",o.jsx("span",{children:"Entres"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"inline-block w-3 h-3 bg-red-600 rounded-full"})," ",o.jsx("span",{children:"Sorties"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ji,{className:"text-gray-400",size:14}),o.jsx("span",{className:"text-xs",children:"Montants en FCFA"})]})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Priode"}),o.jsxs("select",{value:s,onChange:B=>l(B.target.value),className:"p-2 border rounded",children:[o.jsx("option",{value:"all",children:"Toutes"}),o.jsx("option",{value:"today",children:"Aujourd'hui"}),o.jsx("option",{value:"month",children:"Ce mois"}),o.jsx("option",{value:"year",children:"Cette anne"}),o.jsx("option",{value:"custom",children:"Personnalise"})]}),s==="custom"&&o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"date",value:h,onChange:B=>m(B.target.value),className:"p-2 border rounded"}),o.jsx("input",{type:"date",value:x,onChange:B=>g(B.target.value),className:"p-2 border rounded"})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Catgorie"}),o.jsx("input",{placeholder:"Catgorie",value:f,onChange:B=>d(B.target.value),className:"p-2 border rounded"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Rechercher"}),o.jsx("input",{placeholder:"Catgorie ou note",value:y,onChange:B=>v(B.target.value),className:"p-2 border rounded"})]}),o.jsx("button",{onClick:()=>{m(""),g(""),d(""),v(""),l("all"),E(1)},className:"ml-2 px-2 py-1 bg-gray-100 border rounded text-sm",children:"Effacer tous les filtres"})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs("button",{onClick:ie,className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm shadow hover:bg-indigo-700 flex items-center space-x-2",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"inline-block",children:[o.jsx("path",{d:"M6 9V2h12v7",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("rect",{x:"6",y:"13",width:"12",height:"9",rx:"1",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("span",{children:"Imprimer"})]})})]}),o.jsxs("div",{className:"bg-white p-4 rounded shadow mb-6",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("h3",{className:"text-sm font-semibold mb-4",children:"Analyse des Finances"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Rpartition Gnrale"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(Uu,{children:o.jsxs(I0,{children:[o.jsxs(Wu,{data:[{name:"Entres",value:Q.entrees,color:"#10b981"},{name:"Sorties",value:Q.sorties,color:"#ef4444"}],cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:5,dataKey:"value",children:[o.jsx(Wi,{fill:"#10b981"}),o.jsx(Wi,{fill:"#ef4444"})]}),o.jsx(Bu,{formatter:B=>`${Number(B).toLocaleString("fr-FR")} FCFA`}),o.jsx(nm,{})]})})})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Entres par Catgorie"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(Uu,{children:o.jsxs(I0,{children:[o.jsx(Wu,{data:(()=>{const B={};de.filter(G=>G.type==="Entree").forEach(G=>{const ce=G.category||"Autre";B[ce]=(B[ce]||0)+Number(G.amount||0)});const z=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16"];return Object.keys(B).map((G,ce)=>({name:G.length>15?G.substring(0,15)+"...":G,value:B[G],color:z[ce%z.length]}))})(),cx:"50%",cy:"50%",innerRadius:30,outerRadius:80,paddingAngle:2,dataKey:"value",children:(()=>{const B={};de.filter(G=>G.type==="Entree").forEach(G=>{const ce=G.category||"Autre";B[ce]=(B[ce]||0)+Number(G.amount||0)});const z=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16"];return Object.keys(B).map((G,ce)=>o.jsx(Wi,{fill:z[ce%z.length]},`cell-${ce}`))})()}),o.jsx(Bu,{formatter:B=>`${Number(B).toLocaleString("fr-FR")} FCFA`})]})})})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Sorties par Catgorie"}),o.jsx("div",{style:{width:"100%",height:200},children:o.jsx(Uu,{children:o.jsxs(I0,{children:[o.jsx(Wu,{data:(()=>{const B={};de.filter(G=>G.type==="Sortie").forEach(G=>{const ce=G.category||"Autre";B[ce]=(B[ce]||0)+Number(G.amount||0)});const z=["#ef4444","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#3b82f6","#10b981"];return Object.keys(B).map((G,ce)=>({name:G.length>15?G.substring(0,15)+"...":G,value:B[G],color:z[ce%z.length]}))})(),cx:"50%",cy:"50%",innerRadius:30,outerRadius:80,paddingAngle:2,dataKey:"value",children:(()=>{const B={};de.filter(G=>G.type==="Sortie").forEach(G=>{const ce=G.category||"Autre";B[ce]=(B[ce]||0)+Number(G.amount||0)});const z=["#ef4444","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#3b82f6","#10b981"];return Object.keys(B).map((G,ce)=>o.jsx(Wi,{fill:z[ce%z.length]},`cell-${ce}`))})()}),o.jsx(Bu,{formatter:B=>`${Number(B).toLocaleString("fr-FR")} FCFA`})]})})})]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:Q.entrees.toLocaleString("fr-FR")}),o.jsx("div",{className:"text-xs text-gray-500",children:"Total Entres (FCFA)"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-red-600",children:Q.sorties.toLocaleString("fr-FR")}),o.jsx("div",{className:"text-xs text-gray-500",children:"Total Sorties (FCFA)"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:`text-2xl font-bold ${Q.solde>=0?"text-green-600":"text-red-600"}`,children:Q.solde.toLocaleString("fr-FR")}),o.jsx("div",{className:"text-xs text-gray-500",children:"Solde (FCFA)"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Q.count}),o.jsx("div",{className:"text-xs text-gray-500",children:"Nombre d'critures"})]})]}),O.length===0&&o.jsx("div",{className:"p-6 text-center text-sm text-gray-500",children:"Aucune criture pour la priode slectionne  ajoutez une criture ou changez les filtres."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Date"}),o.jsx("input",{type:"date",value:a.date?.slice(0,10),onChange:B=>i(z=>({...z,date:B.target.value})),className:"mt-1 p-2 border rounded w-full"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Type"}),o.jsxs("select",{value:a.type,onChange:B=>i(z=>({...z,type:B.target.value})),className:"mt-1 p-2 border rounded w-full",children:[o.jsx("option",{value:"Entree",children:"Entre"}),o.jsx("option",{value:"Sortie",children:"Sortie"})]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Catgorie"}),o.jsx("input",{value:a.category,onChange:B=>i(z=>({...z,category:B.target.value})),className:"mt-1 p-2 border rounded w-full"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Montant"}),o.jsx("input",{type:"number",value:a.amount,onChange:B=>i(z=>({...z,amount:Number(B.target.value)})),className:"mt-1 p-2 border rounded w-full"})]}),o.jsxs("div",{className:"md:col-span-6 flex space-x-2",children:[o.jsx("input",{placeholder:"Note (optionnel)",value:a.note,onChange:B=>i(z=>({...z,note:B.target.value})),className:"mt-1 p-2 border rounded w-full"}),o.jsx("button",{onClick:he,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Ajouter"})]})]})]}),o.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[O.length===0?o.jsx("div",{className:"text-center p-8",children:o.jsx("p",{className:"text-gray-500",children:"Aucune criture"})}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>{T("date"),P(j==="date"&&C==="desc"?"asc":"desc")},children:["Date ",j==="date"&&(C==="desc"?"":"")]}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700",children:"Type"}),o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>{T("category"),P(j==="category"&&C==="desc"?"asc":"desc")},children:["Catgorie ",j==="category"&&(C==="desc"?"":"")]}),o.jsxs("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>{T("amount"),P(j==="amount"&&C==="desc"?"asc":"desc")},children:["Montant ",j==="amount"&&(C==="desc"?"":"")]}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700",children:"Note"}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(B=>o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:new Date(B.date).toLocaleDateString("fr-FR")}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:B.type}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:B.category?o.jsx("span",{className:`inline-block px-2 py-0.5 text-xs font-medium rounded ${String(B.category).toLowerCase().includes("inscription")?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:B.category}):o.jsx("span",{className:"text-gray-400",children:""})}),o.jsx("td",{className:"px-4 py-3 text-sm text-right font-bold",children:o.jsxs("span",{className:B.type==="Entree"?"text-green-700":"text-red-600",children:[B.type==="Entree"?"+":"-",Number(B.amount).toLocaleString("fr-FR")," FCFA"]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:B.note||""}),o.jsx("td",{className:"px-4 py-3 text-sm text-center space-x-1",children:String(B.id||"").startsWith("pai_")?o.jsxs(o.Fragment,{children:[o.jsx("button",{disabled:!0,title:"Cette ligne provient d'un paiement; modifiez-le depuis l'cran Paiements",className:"px-2 py-1 bg-yellow-300 text-white rounded text-xs opacity-60 cursor-not-allowed",children:"diter"}),o.jsx("button",{disabled:!0,title:"Cette ligne provient d'un paiement; suppression non autorise depuis la comptabilit",className:"px-2 py-1 bg-red-300 text-white rounded text-xs opacity-60 cursor-not-allowed",children:"Supprimer"})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>q(B.id),className:"px-2 py-1 bg-yellow-500 text-white rounded text-xs hover:brightness-95",children:"diter"}),o.jsx("button",{onClick:()=>le(B.id),className:"px-2 py-1 bg-red-600 text-white rounded text-xs hover:brightness-95",children:"Supprimer"})]})})]},B.id))})]})}),o.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",b," / ",V,"  ",O.length," rsultats"]}),o.jsxs("div",{className:"space-x-2",children:[o.jsx("button",{disabled:b<=1,onClick:()=>E(B=>Math.max(1,B-1)),className:"px-2 py-1 border rounded",children:"Prc"}),o.jsx("button",{disabled:b>=V,onClick:()=>E(B=>Math.min(V,B+1)),className:"px-2 py-1 border rounded",children:"Suiv"}),o.jsxs("select",{value:N,onChange:B=>{S(Number(B.target.value)),E(1)},className:"border p-1 rounded",children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:20,children:"20"}),o.jsx("option",{value:50,children:"50"})]})]})]}),W&&M&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded shadow p-4 w-full max-w-md",children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"diter criture"}),o.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[o.jsx("label",{className:"text-xs",children:"Date"}),o.jsx("input",{type:"date",value:M.date?.slice(0,10),onChange:B=>D(z=>z&&{...z,date:B.target.value}),className:"p-2 border rounded"}),o.jsx("label",{className:"text-xs",children:"Type"}),o.jsxs("select",{value:M.type,onChange:B=>D(z=>z&&{...z,type:B.target.value}),className:"p-2 border rounded",children:[o.jsx("option",{value:"Entree",children:"Entre"}),o.jsx("option",{value:"Sortie",children:"Sortie"})]}),o.jsx("label",{className:"text-xs",children:"Catgorie"}),o.jsx("input",{value:M.category,onChange:B=>D(z=>z&&{...z,category:B.target.value}),className:"p-2 border rounded"}),o.jsx("label",{className:"text-xs",children:"Montant"}),o.jsx("input",{type:"number",value:String(M.amount||0),onChange:B=>D(z=>z&&{...z,amount:Number(B.target.value)}),className:"p-2 border rounded"}),o.jsx("label",{className:"text-xs",children:"Note"}),o.jsx("input",{value:M.note||"",onChange:B=>D(z=>z&&{...z,note:B.target.value}),className:"p-2 border rounded"})]}),o.jsxs("div",{className:"mt-3 flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>{F(!1),D(null)},className:"px-3 py-1 border rounded",children:"Annuler"}),o.jsx("button",{onClick:()=>K(M),className:"px-3 py-1 bg-green-600 text-white rounded",children:"Enregistrer"})]})]})}),o.jsx("div",{id:"print-area",style:{position:"absolute",left:"-9999px",top:"0",width:"0",height:"0",overflow:"hidden"}})]})]})}const ql=[{title:"Bienvenue sur KlasNet !",description:`Bienvenue dans votre application de gestion scolaire KlasNet. Ce guide va vous accompagner pas  pas pour dcouvrir chaque fonctionnalit. Prenez le temps de lire chaque tape, puis cliquez sur 'Suivant'.

Note : Vous pouvez relancer ce guide  tout moment en cliquant sur le bouton 'Guide' en haut  droite.`,icon:o.jsx(k5,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Tableau de bord",description:`Le tableau de bord est la page d'accueil. Il affiche en temps rel :
- Le nombre total d'lves et d'lves actifs
- Les recettes totales et celles du mois
- Les paiements complts et en attente
- Des graphiques pour visualiser l'volution des finances

En bas, retrouvez les 'Actions Rapides' pour accder directement aux fonctions principales.

Exemple : Cliquez sur 'Nouvel lve' pour inscrire un nouvel lve en un seul clic.`,icon:o.jsx(fc,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Gestion des lves",description:`Dans le menu 'lves', vous pouvez :
- Voir la liste de tous les lves
- Ajouter un nouvel lve (bouton 'Nouvel lve')
- Modifier ou supprimer un lve existant

Note : Utilisez la barre de recherche pour retrouver rapidement un lve par nom, prnom ou matricule.

Exemple : Pour inscrire un nouvel lve, cliquez sur 'Nouvel lve', remplissez le formulaire puis validez.`,icon:o.jsx(Qi,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Finances et paiements",description:`Dans la section 'Finances', vous pouvez :
- Enregistrer un paiement pour un lve
- Consulter l'historique des paiements
- Voir la situation financire de chaque lve (solde, montant d, etc.)

Exemple : Pour enregistrer un paiement, cliquez sur 'Nouveau Paiement', slectionnez l'lve concern et saisissez le montant.`,icon:o.jsx(Ji,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Saisie des notes",description:`Dans la section 'Notes', vous pouvez :
- Saisir les notes des lves pour chaque matire et priode
- Consulter les moyennes et les rsultats

Note : Saisissez rgulirement les notes pour suivre la progression des lves et gnrer les bulletins facilement.`,icon:o.jsx(Yi,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Configuration",description:`Dans 'Configuration', personnalisez votre application :
- Dfinissez l'anne scolaire active
- Ajoutez ou modifiez les frais scolaires
- Grez les compositions et les paramtres de l'cole

Exemple : Pour changer d'anne scolaire, saisissez la nouvelle anne puis cliquez sur 'Changer'.

Note : Vrifiez toujours que l'anne scolaire active est correcte avant de saisir de nouvelles donnes.`,icon:o.jsx($0,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Recherche rapide",description:`La barre de recherche (en haut de chaque page) vous permet de retrouver rapidement :
- Un lve
- Une classe
- Un enseignant
- Une opration financire

Tapez simplement un mot-cl (nom, prnom, etc.) et les rsultats s'affichent instantanment.`,icon:o.jsx(sl,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Historique et alertes",description:`KlasNet vous informe en temps rel :
- Alertes sur les paiements en retard
- Notifications pour les actions  effectuer (ex : lves sans notes)
- Historique des modifications (ajout, suppression, paiement, etc.)

Note : Consultez rgulirement l'historique pour suivre l'activit de l'cole et anticiper les besoins.`,icon:o.jsx(wi,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Import/Export Excel",description:`Gagnez du temps grce  l'importation et l'exportation des listes d'lves au format Excel.

- Importez facilement une liste d'lves depuis un fichier Excel.
- Prvisualisez les donnes avant de valider l'importation.
- Slectionnez la classe d'affectation et vrifiez les colonnes importantes (Matricule, Nom, Prnoms).
- Exportez la liste actuelle pour la partager ou l'archiver.

Note : Vrifiez toujours l'aperu avant de valider pour viter les erreurs de saisie.`,icon:o.jsx(Hs,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})},{title:"Prt  commencer",description:`Vous tes prt  utiliser KlasNet.

N'hsitez pas  explorer chaque menu,  utiliser la recherche et  consulter ce guide en cas de besoin.

Bonne gestion avec KlasNet.`,icon:o.jsx(In,{className:"h-8 w-8 text-gray-600 mx-auto mb-3"})}];function ble({onClose:e}){const[t,r]=k.useState(0);k.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]);const n=a=>{r(a)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 max-w-lg w-full mx-4 relative",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Guide d'utilisation"}),o.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-lg transition-colors",onClick:e,children:o.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{className:"flex items-center mt-4 space-x-1",children:ql.map((a,i)=>o.jsx("button",{className:`flex-1 h-2 rounded-full transition-all duration-300 ${i<=t?"bg-gray-900":"bg-gray-200"}`,onClick:()=>n(i),"aria-label":`Aller  l'tape ${i+1}`},i))})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"text-center mb-6",children:[ql[t].icon,o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:ql[t].title})]}),o.jsx("div",{className:"text-gray-700 text-sm leading-relaxed whitespace-pre-line mb-8 min-h-[120px]",children:ql[t].description})]}),o.jsx("div",{className:"p-6 border-t border-gray-200",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",onClick:()=>r(a=>Math.max(0,a-1)),disabled:t===0,children:[o.jsx(M0,{className:"h-4 w-4"}),o.jsx("span",{children:"Prcdent"})]}),o.jsxs("span",{className:"text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:[t+1," / ",ql.length]}),t<ql.length-1?o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",onClick:()=>r(a=>a+1),children:[o.jsx("span",{children:"Suivant"}),o.jsx(y5,{className:"h-4 w-4"})]}):o.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",onClick:e,children:[o.jsx(In,{className:"h-4 w-4"}),o.jsx("span",{children:"Terminer"})]})]})})]})})}function wle({user:e}){const[t,r]=k.useState(e?.avatar||null),[n,a]=k.useState(!1),[i,s]=k.useState(!1),[l,f]=k.useState(e?.prenoms||""),[d,h]=k.useState(e?.nom||""),[m,x]=k.useState(e?.role||""),{showToast:g}=Jr(),[y,v]=k.useState(null),[b,E]=k.useState({});if(!e)return o.jsx("div",{className:"p-6",children:"Aucun utilisateur connect."});const N=async T=>{const C=T.target.files?.[0];if(!C)return;const P=new FileReader;P.onload=()=>r(String(P.result)),P.readAsDataURL(C),v(C.name)},S=async()=>{if(!(!e?.id||!t)){a(!0);try{fe.update("utilisateurs",e.id,{avatar:t});try{g("Avatar enregistr","success")}catch{}}finally{a(!1)}}},j=async()=>{if(!e?.id)return;const T={};if((!l||l.trim().length===0)&&(T.prenom="Prnoms requis."),(!d||d.trim().length===0)&&(T.nom="Nom requis."),E(T),!(Object.keys(T).length>0)){a(!0);try{fe.update("utilisateurs",e.id,{prenoms:l,nom:d,role:m});try{g("Profil mis  jour","success")}catch{}}finally{a(!1),s(!1)}}};return o.jsxs("div",{className:"p-6 max-w-2xl mx-auto bg-white rounded-lg shadow",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Profil utilisateur"}),o.jsxs("div",{className:"flex items-start space-x-6",children:[o.jsxs("div",{className:"w-36",children:[o.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-100 overflow-hidden shadow",children:t?o.jsx("img",{src:t,alt:"avatar",className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:"A"})}),o.jsxs("div",{className:"mt-2 flex flex-col space-y-2",children:[o.jsxs("label",{className:"inline-flex items-center px-3 py-2 bg-white border rounded cursor-pointer text-sm",children:[o.jsx("input",{type:"file",accept:"image/*",onChange:N,className:"hidden"}),"Choisir un fichier"]}),y&&o.jsx("div",{className:"text-xs text-gray-500",children:y}),t&&o.jsx("div",{children:o.jsx("button",{onClick:S,disabled:n,className:"px-3 py-1 bg-teal-600 text-white rounded",children:n?"Enregistrement...":"Enregistrer avatar"})})]})]}),o.jsx("div",{className:"flex-1",children:o.jsx("div",{className:"space-y-2",children:i?o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Prnoms"}),o.jsx("input",{value:l,onChange:T=>f(T.target.value),className:"mt-1 block w-full border rounded px-2 py-1"}),b.prenom&&o.jsx("div",{className:"text-xs text-red-600 mt-1",children:b.prenom})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nom"}),o.jsx("input",{value:d,onChange:T=>h(T.target.value),className:"mt-1 block w-full border rounded px-2 py-1"}),b.nom&&o.jsx("div",{className:"text-xs text-red-600 mt-1",children:b.nom})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Rle"}),o.jsxs("select",{value:m,onChange:T=>x(T.target.value),className:"mt-1 block w-full border rounded px-2 py-1",children:[o.jsx("option",{value:"Secrtaire",children:"Secrtaire"}),o.jsx("option",{value:"Enseignant",children:"Enseignant"}),o.jsx("option",{value:"Admin",children:"Admin"})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:j,disabled:n,className:"px-3 py-1 bg-teal-600 text-white rounded",children:n?"Enregistrement...":"Enregistrer"}),o.jsx("button",{onClick:()=>{s(!1),E({})},className:"px-3 py-1 border rounded",children:"Annuler"})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Nom"}),o.jsx("div",{className:"font-semibold",children:Bt(e)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Rle"}),o.jsx("div",{className:"text-sm",children:e.role})]}),o.jsx("div",{className:"mt-3",children:o.jsx("button",{onClick:()=>s(!0),className:"px-3 py-1 bg-slate-600 text-white rounded",children:"Modifier le profil"})})]})})})]})]})}function Sle(){const e=Ls.getCurrentUser(),[t,r]=k.useState(""),[n,a]=k.useState(""),[i,s]=k.useState(""),[l,f]=k.useState(null),[d,h]=k.useState(""),[m,x]=k.useState(""),[g,y]=k.useState(!1),[v,b]=k.useState(!1),E=N=>{if(N.preventDefault(),!e)return f("Aucun utilisateur connect.");if(!n||n!==i)return f("Les nouveaux mots de passe ne correspondent pas.");const S=Ls.changePassword(e.nomUtilisateur,n,t||void 0);f(S?"Mot de passe mis  jour.":"chec : l'ancien mot de passe est incorrect ou une erreur est survenue."),S&&(r(""),a(""),s(""))};return o.jsxs("div",{className:"p-6 max-w-2xl mx-auto bg-white rounded-lg shadow",children:[o.jsx("h2",{className:"text-lg font-bold mb-4",children:"Paramtres du compte"}),o.jsxs("form",{onSubmit:E,className:"space-y-4 text-sm text-gray-700",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nom d'utilisateur"}),o.jsx("div",{className:"font-semibold",children:e?.nomUtilisateur||""})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Ancien mot de passe"}),o.jsx("input",{type:"password",value:t,onChange:N=>r(N.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nouveau mot de passe"}),o.jsx("input",{type:"password",value:n,onChange:N=>a(N.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Confirmer nouveau mot de passe"}),o.jsx("input",{type:"password",value:i,onChange:N=>s(N.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsx("div",{children:o.jsx("button",{type:"submit",className:"px-3 py-1 bg-teal-600 text-white rounded",children:"Enregistrer"})}),l&&o.jsx("div",{className:"text-sm text-gray-600",children:l})]}),o.jsxs("div",{className:"mt-6 p-4 border-t pt-4",children:[o.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Changer le nom d'utilisateur"}),o.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Nouveau nom d'utilisateur"}),o.jsx("input",{value:d,onChange:N=>h(N.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-500",children:"Mot de passe (vrification)"}),o.jsx("input",{type:"password",value:m,onChange:N=>x(N.target.value),className:"mt-1 block w-full border rounded px-2 py-1"})]}),o.jsx("div",{children:o.jsx("button",{onClick:()=>{if(f(null),!e)return f("Aucun utilisateur connect.");if(!d)return f("Entrez un nouveau nom d'utilisateur.");if(!/^[a-z0-9_.-]{3,30}$/i.test(d))return f("Nom utilisateur invalide  utilisez 3  30 caractres (lettres, chiffres, _, . ou -).");y(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded",children:"Renommer le compte"})})]})]}),g&&o.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center",children:o.jsxs("div",{className:"bg-white p-6 rounded shadow max-w-md w-full",children:[o.jsx("h4",{className:"font-semibold mb-3",children:"Confirmer le renommage"}),o.jsxs("p",{className:"text-sm text-gray-700 mb-4",children:["Vous allez changer le nom d'utilisateur de ",o.jsx("strong",{children:e?.nomUtilisateur})," en ",o.jsx("strong",{children:d}),". Continuer ?"]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>y(!1),className:"px-3 py-1 border rounded",children:"Annuler"}),o.jsx("button",{disabled:v,onClick:async()=>{if(f(null),!e)return f("Aucun utilisateur connect.");b(!0);try{if(Ls.changeUsername(e.nomUtilisateur,d,m||void 0)){f("Nom d'utilisateur mis  jour. L'application va se recharger."),y(!1);try{Ls.logout()}catch{}setTimeout(()=>{window.location.reload()},400)}else f("chec : nom existant ou mot de passe incorrect."),y(!1)}finally{b(!1)}},className:"px-3 py-1 bg-red-600 text-white rounded",children:"Confirmer"})]})]})})]})}function Nle(){if(fe.getAll("matieres").length>0)return;const e=new Date().toISOString(),t=new Date().getFullYear()+"-"+(new Date().getFullYear()+1),r=[{nom:"Mathmatiques",abreviation:"MATH",coefficient:4,type:"Fondamentale",baremeParNiveau:{CE1:{min:0,max:50},CE2:{min:0,max:50},CM1:{min:0,max:50},CM2:{min:0,max:50},CP1:{min:0,max:20},CP2:{min:0,max:20}}},{nom:"veil au Milieu",abreviation:"AEM",coefficient:4,type:"veil",baremeParNiveau:{CE1:{min:0,max:50},CE2:{min:0,max:50},CM1:{min:0,max:50},CM2:{min:0,max:50},CP1:{min:0,max:20},CP2:{min:0,max:20}}},{nom:"Exploitation de Texte",abreviation:"EXP TEXTE",coefficient:4,type:"Fondamentale",baremeParNiveau:{CE1:{min:0,max:50},CE2:{min:0,max:50},CM1:{min:0,max:50},CM2:{min:0,max:50},CP1:{min:0,max:20},CP2:{min:0,max:20}}},{nom:"Orthographe",abreviation:"ORTH",coefficient:2,type:"Fondamentale",baremeParNiveau:{CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20},CP1:{min:0,max:20},CP2:{min:0,max:20}}}],n=[{nom:"veil Scientifique",abreviation:"SCIENCES",coefficient:2,type:"veil",baremeParNiveau:{CP1:{min:0,max:20},CP2:{min:0,max:20},CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20}}}],a=[{nom:"ducation Artistique",abreviation:"ARTS",coefficient:1,type:"Expression",baremeParNiveau:{CP1:{min:0,max:20},CP2:{min:0,max:20},CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20}}},{nom:"ducation Physique",abreviation:"EPS",coefficient:1,type:"Expression",baremeParNiveau:{CP1:{min:0,max:20},CP2:{min:0,max:20},CE1:{min:0,max:20},CE2:{min:0,max:20},CM1:{min:0,max:20},CM2:{min:0,max:20}}}],i=[...r,...n,...a],s=[];i.forEach(m=>{const x=fe.create("matieres",{...m,obligatoire:m.type==="Fondamentale",classeIds:[],createdAt:e,updatedAt:e});s.push(x)}),[{nom:"1re Composition",coefficient:1,ordre:1},{nom:"2me Composition",coefficient:1,ordre:2},{nom:"3me Composition",coefficient:1,ordre:3},{nom:"Composition de fin d'anne",coefficient:2,ordre:4}].forEach(m=>{fe.create("compositions",m)}),["Petite Section","Moyenne Section","Grande Section","CP1","CP2","CE1","CE2","CM1","CM2"].forEach(m=>{["A","B"].forEach(x=>{if(["Petite Section","Moyenne Section","Grande Section"].includes(m)&&x==="B")return;const g=fe.create("classes",{niveau:m,section:x,anneeScolaire:t,enseignantPrincipal:"",effectifMax:35,salle:`Salle ${m} ${x}`,matieres:s.filter(y=>m.includes("Section")?["Fondamentale","Expression"].includes(y.type):!0)});s.forEach(y=>{g.matieres.some(v=>v.id===y.id)&&fe.update("matieres",y.id,{classeIds:[...y.classeIds||[],g.id]})})})}),[{nom:"KOUASSI",prenoms:"Marie",sexe:"F",telephone:"+225 07 XX XX XX XX",adresse:"Abidjan, Cocody",specialite:"Institutrice",diplome:"CEAP",dateEmbauche:"2020-09-01",statut:"Actif",salaire:15e4,photo:"",classesPrincipales:[],matieresEnseignees:[]},{nom:"TRAORE",prenoms:"Amadou",sexe:"M",telephone:"+225 05 XX XX XX XX",adresse:"Abidjan, Yopougon",specialite:"Professeur des coles",diplome:"Licence Pdagogie",dateEmbauche:"2019-09-01",statut:"Actif",salaire:18e4,photo:"",classesPrincipales:[],matieresEnseignees:[]}].forEach(m=>{fe.create("enseignants",m)});const h=fe.getAll("ecole")[0];if(h){const m=fe.getAll("compositions");fe.update("ecole",h.id,{compositions:m})}console.log("Donnes par dfaut initialises avec succs")}function Ele(){const[e,t]=k.useState(()=>Ls.getCurrentUser()),[r,n]=k.useState("dashboard"),[a,i]=k.useState(null),[s,l]=k.useState(!1),[f,d]=k.useState(!1);on.useEffect(()=>{if(e)try{Nle(),fP()}catch(M){console.error("Erreur lors de l'initialisation des donnes par dfaut:",M)}},[e]),on.useEffect(()=>{const M=()=>{try{_1()}catch{}};return window.addEventListener("beforeunload",M),()=>window.removeEventListener("beforeunload",M)},[]),on.useEffect(()=>{const M=D=>{try{const W=window;if(W&&W.__discardModalOpen){try{console.debug("[App] navigate ignored because discard modal open")}catch{}return}let F=!1;if(W.__unsavedGuards&&typeof W.__unsavedGuards.forEach=="function"&&W.__unsavedGuards.forEach(se=>{try{se()&&(F=!0)}catch{}}),F){if(D&&typeof D.stopImmediatePropagation=="function")try{D.stopImmediatePropagation()}catch{}W.__autosaveHandlers&&typeof W.__autosaveHandlers.forEach=="function"&&W.__autosaveHandlers.forEach(se=>{try{se()}catch{}}),W.__pendingNavigation=D.detail,N(D.detail),b(!0);return}const{page:L,action:J}=D.detail||{};L&&(n(L),J==="new"?(i(null),l(!0)):(l(!1),i(null)))}catch(W){console.debug("navigate guard check failed",W)}};return window.addEventListener("navigate",M),()=>window.removeEventListener("navigate",M)},[]);const h=M=>{n(M),i(null),l(!1)},m=M=>{i(M),l(!0)},x=()=>{i(null),l(!0)},g=()=>{l(!1),i(null)},y=()=>{l(!1),i(null)},[v,b]=on.useState(!1),[E,N]=on.useState(null),S=async()=>{const M=window;try{M.__preventReDispatch=!0}catch{}try{M.__forceNavigationInProgress=!0}catch{}try{const D=Array.from(M.__unsavedAllowHandlers||[]);for(const F of D)try{await F()}catch(L){console.debug("allow handler failed",L)}try{window.dispatchEvent(new CustomEvent("unsaved:allow"))}catch{}b(!1);const W=E||M.__pendingNavigation||null;N(null);try{typeof window<"u"&&(M.__pendingNavigation=null)}catch{}if(W&&W.page){const{page:F,action:L}=W;n(F),L==="new"&&(i(null),l(!0))}}catch(D){console.error("confirmGlobalDiscard failed",D),b(!1),N(null)}finally{setTimeout(()=>{try{M.__forceNavigationInProgress=!1}catch{}try{M.__preventReDispatch=!1}catch{}try{M.__unsavedGuards=new Set}catch{}},60)}},j=()=>{b(!1),N(null);try{const M=window;M.__pendingNavigation=null}catch{}},T=M=>{t(M)},C=()=>{try{Ls.logout()}catch{}t(null),n("dashboard")},P=()=>{if(s)switch(r){case"eleves":return o.jsx(aX,{eleve:a,onSave:g,onCancel:y});case"enseignants":return o.jsx(sX,{enseignant:a,onSave:g,onCancel:y});case"classes":return o.jsx(lX,{classe:a,onSave:g,onCancel:y});case"matieres":return o.jsx(uX,{matiere:a,onSave:g,onCancel:y});default:return o.jsx(Jg,{})}switch(r){case"dashboard":return o.jsx(Jg,{});case"profil":return o.jsx(wle,{user:e});case"parametres":return o.jsx(Sle,{});case"finances":return o.jsx(gle,{});case"recouvrement":return o.jsx(vle,{});case"comptabilite":return o.jsx(yle,{});case"eleves":return o.jsx(rX,{onEleveSelect:m,onNewEleve:x});case"enseignants":return o.jsx(iX,{onEnseignantSelect:m,onNewEnseignant:x});case"classes":return o.jsx(oX,{onClasseSelect:m,onNewClasse:x});case"matieres":return o.jsx(cX,{onMatiereSelect:m,onNewMatiere:x});case"notes":return o.jsx(fX,{});case"config":return o.jsx(mle,{});default:return o.jsx(Jg,{})}};return o.jsx(M5,{children:e?o.jsx(R5,{children:o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx(B5,{currentUser:e,onLogout:C,onNavigate:h,currentPage:r,onShowGuide:()=>d(!0)}),o.jsx("main",{children:P()}),v&&o.jsx(kf,{open:v,title:"Quitter sans sauvegarder ?",description:"Certaines pages ont des modifications non sauvegardes. Voulez-vous quitter et perdre ces modifications ?",onConfirm:S,onCancel:j}),f&&o.jsx(ble,{onClose:()=>d(!1)})]})}):o.jsx(L5,{onLogin:T})})}b1.createRoot(document.getElementById("root")).render(o.jsx(k.StrictMode,{children:o.jsx(Ele,{})}));export{Ft as B,w1 as D,x4 as P,Ja as a,uP as b,_le as c,fe as d,ff as e,Bt as f,b4 as g,Ei as h,o as j,xle as o};
